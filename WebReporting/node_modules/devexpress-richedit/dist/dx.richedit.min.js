/**
* DevExpress WebRichEdit (dx.richedit.min.js)
* Version: 24.2.5
* Copyright (c) 2012 - 2025 Developer Express Inc. ALL RIGHTS RESERVED
* License: https://www.devexpress.com/Support/EULAs
*/
/*! For license information please see dx.richedit.min.js.LICENSE.txt */
(function(){"use strict";var __webpack_modules__={9279:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Browser=void 0;var r=function(){function e(){}return e.IdentUserAgent=function(t,r){void 0===r&&(r=!1);var i=["Mozilla","IE","Firefox","Netscape","Safari","Chrome","Opera","Opera10","Edge"],n="IE",o="Win",a={Safari:2,Chrome:.1,Mozilla:1.9,Netscape:8,Firefox:2,Opera:9,IE:6,Edge:12};if(t&&0!==t.length){t=t.toLowerCase(),e.indentPlatformMajorVersion(t);try{for(var s={Windows:"Win",Macintosh:"Mac","Mac OS":"Mac",Mac_PowerPC:"Mac","cpu os":"MacMobile","cpu iphone os":"MacMobile",Android:"Android","!Windows Phone":"WinPhone","!WPDesktop":"WinPhone","!ZuneWP":"WinPhone"},l="(?:/|\\s*)?",d="(\\d+)(?:\\.((?:\\d+?[1-9])|\\d)0*?)?",c="(?:"+d+")?",h={Safari:"applewebkit(?:.*?(?:version/"+d+"[\\.\\w\\d]*?(?:\\s+mobile/\\S*)?\\s+safari))?",Chrome:"(?:chrome|crios)(?!frame)"+l+c,Mozilla:"mozilla(?:.*rv:"+c+".*Gecko)?",Netscape:"(?:netscape|navigator)\\d*/?\\s*"+c,Firefox:"firefox"+l+c,Opera:"(?:opera|\\sopr)"+l+c,Opera10:"opera.*\\s*version"+l+c,IE:"msie\\s*"+c,Edge:"edge"+l+c},u=null,p=-1,g=0;g<i.length;g++){var m=i[g],f=new RegExp(h[m],"i").exec(t);if(f&&f.index>=0){if("IE"===u&&p>=11&&"Safari"===m)continue;"Opera10"===(u=m)&&(u="Opera");var b="trident"+l+c;p=e.GetBrowserVersion(t,f,b,e.getIECompatibleVersionString()),"Mozilla"===u&&p>=11&&(u="IE")}}u||(u=n);var C=-1!==p;C||(p=a[u]);var S=null,I=Number.MAX_VALUE;for(var P in s)if(Object.prototype.hasOwnProperty.call(s,P)){var w="!"===P.substr(0,1),y=t.indexOf((w?P.substr(1):P).toLowerCase());y>=0&&(y<I||w)&&(I=w?0:y,S=s[P])}var x=t.toUpperCase().match("SM-[A-Z]"),T=x&&x.length>0;"WinPhone"===S&&p<9&&(p=Math.floor(e.getVersionFromTrident(t,"trident"+l+c))),!r&&"IE"===u&&p>7&&document.documentMode<p&&(p=document.documentMode),"WinPhone"===S&&(p=Math.max(9,p)),S||(S=o),S!==s["cpu os"]||C||(p=4),e.fillUserAgentInfo(i,u,p,S,T)}catch(t){e.fillUserAgentInfo(i,n,a[n],o)}}else e.fillUserAgentInfo(i,n,a[n],o)},e.GetBrowserVersion=function(t,r,i,n){var o=e.getVersionFromMatches(r);if(n){var a=e.getVersionFromTrident(t,i);if("edge"===n||parseInt(n)===a)return a}return o},e.getIECompatibleVersionString=function(){if(document.compatible)for(var e=0;e<document.compatible.length;e++)if("IE"===document.compatible[e].userAgent&&document.compatible[e].version)return document.compatible[e].version.toLowerCase();return""},e.isTouchEnabled=function(){return e.hasTouchStart()||e.hasMaxTouchPoints()||e.hasMsMaxTouchPoints()},e.hasTouchStart=function(){return"ontouchstart"in window},e.hasMaxTouchPoints=function(){return navigator.maxTouchPoints>0},e.hasMsMaxTouchPoints=function(){return navigator.msMaxTouchPoints>0},e.hasNavigator=function(){return"undefined"!=typeof navigator},e.fillUserAgentInfo=function(t,r,i,n,o){void 0===o&&(o=!1);for(var a=0;a<t.length;a++){var s=t[a];e[s]=s===r}e.Version=Math.floor(10*i)/10,e.MajorVersion=Math.floor(e.Version),e.WindowsPlatform="Win"===n||"WinPhone"===n,e.MacOSMobilePlatform="MacMobile"===n||"Mac"===n&&e.isTouchEnabled(),e.MacOSPlatform="Mac"===n&&!e.MacOSMobilePlatform,e.AndroidMobilePlatform="Android"===n,e.WindowsPhonePlatform="WinPhone"===n,e.WebKitFamily=e.Safari||e.Chrome||e.Opera&&e.MajorVersion>=15,e.NetscapeFamily=e.Netscape||e.Mozilla||e.Firefox,e.WebKitTouchUI=e.MacOSMobilePlatform||e.AndroidMobilePlatform;var l=e.IE&&e.MajorVersion>9&&e.WindowsPlatform&&e.UserAgent.toLowerCase().indexOf("touch")>=0;if(e.MSTouchUI=l||e.Edge&&!!window.navigator.maxTouchPoints,e.TouchUI=e.WebKitTouchUI||e.MSTouchUI,e.MobileUI=e.WebKitTouchUI||e.WindowsPhonePlatform,e.AndroidDefaultBrowser=e.AndroidMobilePlatform&&!e.Chrome,e.AndroidChromeBrowser=e.AndroidMobilePlatform&&e.Chrome,o&&(e.SamsungAndroidDevice=o),e.MSTouchUI){var d=e.UserAgent.toLowerCase().indexOf("arm;")>-1;e.VirtualKeyboardSupported=d||e.WindowsPhonePlatform}else e.VirtualKeyboardSupported=e.WebKitTouchUI;e.fillDocumentElementBrowserTypeClassNames(t)},e.indentPlatformMajorVersion=function(t){var r=/(?:(?:windows nt|macintosh|mac os|cpu os|cpu iphone os|android|windows phone|linux) )(\d+)(?:[-0-9_.])*/.exec(t);r&&(e.PlaformMajorVersion=r[1])},e.getVersionFromMatches=function(e){var t=-1,r="";return e&&(e[1]&&(r+=e[1],e[2]&&(r+="."+e[2])),""!==r&&(t=parseFloat(r),isNaN(t)&&(t=-1))),t},e.getVersionFromTrident=function(t,r){var i=new RegExp(r,"i").exec(t);return e.getVersionFromMatches(i)+4},e.fillDocumentElementBrowserTypeClassNames=function(t){for(var r="",i=t.concat(["WindowsPlatform","MacOSPlatform","MacOSMobilePlatform","AndroidMobilePlatform","WindowsPhonePlatform","WebKitFamily","WebKitTouchUI","MSTouchUI","TouchUI","AndroidDefaultBrowser"]),n=0;n<i.length;n++){var o=i[n];e[o]&&(r+="dx"+o+" ")}r+="dxBrowserVersion-"+e.MajorVersion,"undefined"!=typeof document&&document&&document.documentElement&&(""!==document.documentElement.className&&(r=" "+r),document.documentElement.className+=r,e.Info=r)},e.getUserAgent=function(){return e.hasNavigator()&&navigator.userAgent?navigator.userAgent.toLowerCase():""},e.UserAgent=e.getUserAgent(),e._foo=e.IdentUserAgent(e.UserAgent),e}();t.Browser=r},1772:function(e,t){t.m1=t.IS=void 0;var r=function(){function e(){this.suspendUpdateCount=0,this.occurredEvents=0}return e.prototype.beginUpdate=function(){0===this.suspendUpdateCount&&this.onUpdateLocked(),this.suspendUpdateCount<0?this.suspendUpdateCount--:this.suspendUpdateCount++},e.prototype.endUpdate=function(){if(this.suspendUpdateCount<0?this.suspendUpdateCount++:this.suspendUpdateCount>0&&this.suspendUpdateCount--,!this.isUpdateLocked()){var e=this.occurredEvents;this.occurredEvents=0,this.onUpdateUnlocked(e)}},e.prototype.suspendUpdate=function(){if(this.suspendUpdateCount>0){this.suspendUpdateCount*=-1;var e=this.occurredEvents;this.occurredEvents=0,this.onUpdateUnlocked(e)}},e.prototype.continueUpdate=function(){this.suspendUpdateCount<0&&(this.suspendUpdateCount*=-1)},e.prototype.isUpdateLocked=function(){return this.suspendUpdateCount>0},e.prototype.onUpdateLocked=function(){},e.prototype.registerOccurredEvent=function(e){this.occurredEvents|=e},e.prototype.resetOccurredEvents=function(){this.occurredEvents=0},e.prototype.isLocked=function(){return 0!==this.suspendUpdateCount},e}();t.IS=r;var i=function(){function e(){}return e.prototype.beginUpdate=function(){},e.prototype.endUpdate=function(){},e}();t.m1=i},677:function(e,t){t.T=void 0;var r=function(){function e(e,t){void 0===t&&(t=2e3),this.maxChunkSize=t,this.chunks=[],this._textLength=0,this.pushText(e),this.resetToStart()}return Object.defineProperty(e.prototype,"currChar",{get:function(){return this.chunk[this.posInChunk]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPos",{get:function(){return this._currPos},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textLength",{get:function(){return this._textLength},enumerable:!1,configurable:!0}),e.prototype.resetToStart=function(){this.setChunk(0),this.posInChunk=-1,this._currPos=-1},e.prototype.resetToEnd=function(){this.setChunk(this.chunks.length-1),this.posInChunk=this.chunkLength-1,this._currPos=this._textLength},e.prototype.addText=function(e){this.pushText(e),-1===this._currPos?(this.chunk=this.chunks[0],this.chunkLength=this.chunk.length):this.setPositionTo(this._currPos)},e.prototype.getText=function(){return this.chunks.join("")},e.prototype.moveToNextChar=function(){return this.posInChunk++,this._currPos++,this.posInChunk<this.chunkLength||(this.setChunk(this.chunkIndex+1)?(this.posInChunk=0,!0):(this.posInChunk=this.chunkLength,this._currPos=this._textLength,!1))},e.prototype.moveToPrevChar=function(){return this.posInChunk--,this._currPos--,this.posInChunk>=0||(this.setChunk(this.chunkIndex-1)?(this.posInChunk=this.chunkLength-1,!0):(this.posInChunk=-1,this._currPos=-1,!1))},e.prototype.setPositionTo=function(e){var t=e;this.chunkIndex=0;for(var r=0;;r++){if(!this.setChunk(r))return this.posInChunk=this.chunkLength,void(this._currPos=this._textLength);if(!(t>this.chunkLength))return this.posInChunk=t,void(this._currPos=e);t-=this.chunk.length}},e.prototype.setChunk=function(e){var t=this.chunk;return this.chunk=this.chunks[e],this.chunk?(this.chunkIndex=e,this.chunkLength=this.chunk.length,!0):(this.chunk=t,!1)},e.prototype.pushText=function(e){if(e.length){for(var t=0;t<e.length;){if(0===t){var r=this.chunks.pop();if(r){if(r.length<this.maxChunkSize){var i=this.maxChunkSize-r.length;this.chunks.push(r+e.substr(t,i)),t+=i;continue}this.chunks.push(r)}}this.chunks.push(e.substr(t,this.maxChunkSize)),t+=this.maxChunkSize}this._textLength+=e.length}},e}();t.T=r},6218:function(e,t){t.R=void 0;var r=function(){function e(e){this.action=e,this.reset()}return Object.defineProperty(e.prototype,"actionExecuted",{get:function(){return null===this.actionTimeoutId},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.actionTimeout=void 0,this.actionTimeoutId=void 0,this.actionStartTime=void 0},e.prototype.start=function(e){var t=this;this.actionTimeout=e,this.actionTimeoutId=setTimeout((function(){return t.executeAction()}),this.actionTimeout),this.actionStartTime=Date.now()},e.prototype.executeIfTimerExpired=function(){Date.now()-this.actionStartTime>this.actionTimeout&&this.executeAction()},e.prototype.executeAction=function(){this.actionExecuted||(this.action(),this.stop())},e.prototype.stop=function(){clearTimeout(this.actionTimeoutId),this.actionTimeoutId=null},e}();t.R=r},6136:function(e,t,r){t.$=void 0;var i=r(1632),n=function(e,t,r,i){void 0===i&&(i=!0),this.element=e,this.eventName=t,this.handler=r,this.options=i},o=function(){function e(){this.handlers=[]}return e.prototype.addListener=function(e,t,r,i){void 0===i&&(i=!0),this.handlers.push(new n(e,t,r,i)),e.addEventListener(t,r,i)},e.prototype.addListenerToWindow=function(e,t,r){void 0===r&&(r=!0),this.handlers.push(new n(window,e,t,r)),window.addEventListener(e,t,r)},e.prototype.addListenerToDocument=function(e,t,r){void 0===r&&(r=!0),i.TouchUtils.onEventAttachingToDocument(e,t)&&(this.handlers.push(new n(document,e,t,r)),document.addEventListener(e,t,r))},e.prototype.removeAllListeners=function(){this.handlers.forEach((function(e){return e.element.removeEventListener(e.eventName,e.handler,e.options)})),this.handlers=[]},e}();t.$=o},7820:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Flag=void 0;var r=function(){function e(e){void 0===e&&(e=0),this.value=e}return e.prototype.get=function(e){return(this.value&e)===e},e.prototype.set=function(e,t){return(this.value&e)===e!==t&&(t?this.value|=e:this.value^=e),this},e.prototype.add=function(e){this.value|=e},e.prototype.anyOf=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,i=e;r<i.length;r++){var n=i[r];if((this.value&n)===n)return!0}return!1},e.prototype.getValue=function(){return this.value},e.prototype.clone=function(){return new e(this.value)},e}();t.Flag=r},7496:function(e,t){t.m7=void 0;var r=function(){function e(){}return e.prototype.set=function(e,t){return this[e]=t,this},e}();t.m7=r},6799:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedMinMax=t.ExtendedMax=t.ExtendedMin=t.MinMaxNumber=t.MinMax=void 0;var i=r(2020),n=function(e,t){this.minElement=e,this.maxElement=t};t.MinMax=n;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this.maxElement-this.minElement},enumerable:!1,configurable:!0}),t}(n);t.MinMaxNumber=o;var a=function(e,t){this.minElement=e,this.minValue=t};t.ExtendedMin=a;var s=function(e,t){this.maxElement=e,this.maxValue=t};t.ExtendedMax=s;var l=function(e){function t(t,r,i,n){var o=e.call(this,t,i)||this;return o.minValue=r,o.maxValue=n,o}return i.__extends(t,e),t}(n);t.ExtendedMinMax=l},9094:function(e,t){t.K=void 0;var r=function(){function e(){this.list=[],this._count=0,this.last=void 0}return e.prototype.push=function(e){this.list.push(e),this.last=e,this._count++},e.prototype.pop=function(){this._count--;var e=this.list.pop();return this.last=this.list[this.list.length-1],e},e.prototype.peek=function(){return this.last},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),e.prototype.getPrevious=function(){return this.list[this._count-2]},e}();t.K=r},9291:function(e,t){t.u=void 0;var r=function(){function e(){}return e.hundredthsOfMillimeterToTwipsRound=function(e){return Math.round(1440*e/2540)},e.documentsToTwips=function(e){return 24*e/5},e.pixelsToTwips=function(t){return Math.round(e.pixelsToTwipsF(t))},e.pixelsToTwipsCustomDpi=function(t,r){return Math.round(e.pixelsToTwipsFCustomDpi(t,r))},e.inchesToTwips=function(t){return Math.round(e.inchesToTwipsF(t))},e.pointsToTwips=function(t){return Math.round(e.pointsToTwipsF(t))},e.picasToTwips=function(t){return Math.round(1440*t/e.PICAS_PER_INCH)},e.centimetersToTwips=function(t){return Math.round(e.centimetersToTwipsF(t))},e.pixelsToTwipsF=function(t){return 1440*t/e.DPI},e.pixelsToTwipsFCustomDpi=function(e,t){return 1440*e/t},e.inchesToTwipsF=function(e){return 1440*e},e.pointsToTwipsF=function(e){return 20*e},e.centimetersToTwipsF=function(t){return 1440*t/e.CENTIMETERS_PER_INCH},e.twipsToDegrees=function(e){return e/6e4},e.twipsToRadians=function(e){return e/6e4*Math.PI/180},e.degreesToTwips=function(e){return 6e4*e},e.radiansToTwips=function(e){return 6e4*e/Math.PI*180},e.radiansToDegrees=function(e){return e/Math.PI*180},e.twipsToFD=function(e){return Math.round(2048*e/1875)},e.fdToTwips=function(e){return Math.round(1875*e/2048)},e.emuToTwips=function(e){return e/635},e.twipsToPixels=function(t){return Math.round(e.twipsToPixelsF(t))},e.inchesToPixels=function(t){return Math.round(e.DPI*t)},e.centimeterToPixel=function(e){return Math.round(this.centimeterToPixelF(e))},e.centimeterToPixelF=function(t){return t*e.DPI/e.CENTIMETERS_PER_INCH},e.millimetersToPixel=function(t){return Math.round(t/(e.CENTIMETERS_PER_INCH/e.DPI)/10)},e.pointsToPixels=function(t){return Math.round(t*e.DPI/72)},e.pointsToPixelsF=function(t){return t*e.DPI/72},e.twipsToPixelsF=function(t){return t*e.DPI/1440},e.pixelsToPoints=function(t){return Math.round(72*t/e.DPI)},e.pixelsToPointsF=function(t){return 72*t/e.DPI},e.twipsToPoints=function(e){return Math.round(this.twipsToPointsF(e))},e.twipsToPointsF=function(e){return e/20},e.twipsToInches=function(e){return e/1440},e.pixelsToInches=function(t){return t/e.DPI},e.twipsToCentimeters=function(t){return t*e.CENTIMETERS_PER_INCH/1440},e.pixelToCentimeters=function(t){return t*e.CENTIMETERS_PER_INCH/e.DPI},e.twipsToHundredthsOfMillimeter=function(e){return Math.round(127*e/72)},e.pixelsToHundredthsOfMillimeter=function(t){return Math.round(2540*t/e.DPI)},e.hundredthsOfMillimeterToTwips=function(e){return 15*e/127},e.twipsToEmu=function(e){return 635*e},e.twipsToDegree=function(e){return e/6e4},e.DPI=96,e.CENTIMETERS_PER_INCH=2.54,e.PICAS_PER_INCH=6,e}();t.u=r},8785:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Int32Constants=t.Constants=void 0;var r=function(){function e(){}return e.MIN_SAFE_INTEGER=-(Math.pow(2,53)-1),e.MAX_SAFE_INTEGER=Math.pow(2,53)-1,e.MAX_BYTE=Math.pow(2,8)-1,e}();t.Constants=r;var i=function(){function e(){}return e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647,e}();t.Int32Constants=i},7774:function(e,t){t.D=void 0;var r=function(){function e(){}return e.internalExceptionTemplate=function(t){return e.InternalException+" "+t},e.NotImplemented="The method is not implemented.",e.InternalException="Internal exception.",e.ValueCannotBeNull="Value cannot be null.",e}();t.D=r},8889:function(e,t,r){t.J=void 0;var i=r(2020),n=function(){function e(e){this.AMPMKeyword="am/pm",this.options=e}return e.prototype.format=function(e,t){this.date=e,this.formatString=t,this.result="";for(var r=0,i=this.formatString.length;r<i;)r+=this.formatNext(r);return this.result},e.prototype.formatNext=function(e){var t=this.formatString[e],r=this.tryCreateFormattingItem(t);return r?this.processAsFormattingItem(e,r):this.isKeyword(this.AMPMKeyword,e)?this.processAsAMPMKeyword():"'"===t?this.processAsEmbedText(e):this.processAsSingleCharacter(e)},e.prototype.isKeyword=function(e,t){if(e.length>this.formatString.length-t)return!1;var r=this.formatString.substr(t,e.length);return e.toLowerCase()===r.toLowerCase()},e.prototype.processAsAMPMKeyword=function(){var e=this.date.getHours()-12>=0?this.options.pm:this.options.am;return this.result+=e,this.AMPMKeyword.length},e.prototype.processAsEmbedText=function(e){var t=e+1;if(t>=this.formatString.length-1)return 1;var r=this.getCharacterSequenceLength(this.formatString[e],t,this.charsAreNotEqual);return r+t===this.formatString.length?(this.result+="'",1):(this.result+=this.formatString.substr(t,r),r+2)},e.prototype.processAsSingleCharacter=function(e){return this.result+=this.formatString[e],1},e.prototype.processAsFormattingItem=function(e,t){var r=this.getCharacterSequenceLength(this.formatString[e],e,this.charsAreEqual),i=t.getAvailablePatternLength(r),n=t.format(this.date,i);return this.result+=n,Math.min(r,i)},e.prototype.getCharacterSequenceLength=function(e,t,r){for(var i=this.formatString.length,n=t+1;n<i&&r(e,this.formatString[n]);)n++;return n-t},e.prototype.tryCreateFormattingItem=function(e){switch(e){case"h":return new d(this.options);case"H":return new l(this.options);case"m":return new c(this.options);case"S":case"s":return new h(this.options);case"Y":case"y":return new g(this.options);case"M":return new p(this.options);case"D":case"d":return new u(this.options)}return null},e.prototype.charsAreEqual=function(e,t){return e===t},e.prototype.charsAreNotEqual=function(e,t){return e!==t},e}();t.J=n;var o=function(){function e(e){this.options=e}return e.prototype.getAvailablePatternLength=function(e){for(var t=this.patternsLength.length,r=0;r<t;r++)if(this.patternsLength[r]>=e)return this.patternsLength[r];return this.patternsLength[t-1]},e}(),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.patternsLength=[1,2],t}return i.__extends(t,e),t.prototype.formatCore=function(e,t){var r=""+e;return 2===t&&1===r.length?"0"+r:r},t}(o),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.patternsLength=[1,2,3,4],t}return i.__extends(t,e),t.prototype.format=function(e,t){return t<=2?this.formatCore(this.getNumericValue(e),t):3===t?this.getAbbreviatedName(e):this.getFullName(e)},t}(a),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.format=function(e,t){return this.formatCore(e.getHours(),t)},t}(a),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.format=function(e,t){var r=e.getHours()%12;return 0===r&&(r=12),this.formatCore(r,t)},t}(a),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.format=function(e,t){return this.formatCore(e.getMinutes(),t)},t}(a),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.format=function(e,t){return this.formatCore(e.getSeconds(),t)},t}(a),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.getAbbreviatedName=function(e){return this.options.abbrDayNames[this.getDayOfWeek(e)]},t.prototype.getFullName=function(e){return this.options.dayNames[this.getDayOfWeek(e)]},t.prototype.getNumericValue=function(e){return e.getDate()},t.prototype.getDayOfWeek=function(e){return e.getDay()},t}(s),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.getAbbreviatedName=function(e){return this.options.abbrMonthNames[e.getMonth()]},t.prototype.getFullName=function(e){return this.options.monthNames[e.getMonth()]},t.prototype.getNumericValue=function(e){return e.getMonth()+1},t}(s),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.patternsLength=[2,4],t}return i.__extends(t,e),t.prototype.format=function(e,t){var r=e.getFullYear();if(2===t&&r>99){var i=""+r%100;return 1===i.length?"0"+i:i}return""+r},t}(o)},8786:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DateUtils=void 0;var r=function(){function e(){}return e.fixTimezoneGap=function(e,t){var r=t.getHours()-e.getHours();if(0!==r){var i=1===r||-23===r?-1:1,n=new Date(t.getTime()+36e5*i);t.getHours()-n.getHours()===r&&(i>0||n.getDate()===t.getDate())&&t.setTime(n.getTime())}},e.expandTwoDigitYear=function(e,t){return(e+=1900)+99<t.twoDigitYearMax&&(e+=100),e},e.toUtcTime=function(t){var r=new Date;return r.setTime(t.valueOf()+e.getTimeZoneOffset(t)),r},e.getTimeZoneOffset=function(e){var t=e.getUTCFullYear(),r=new Date(t,e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return t<100&&r.setFullYear(t),r.valueOf()-e.valueOf()},e}();t.DateUtils=r},5308:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DateFormatter=void 0;var i=r(2866),n=r(49),o=r(8786),a=function(){function e(e){this.date=new Date(2e3,0,1),this.mask="",this.specifiers={},this.spPositions=[],this.parserKeys=[],this.savedYear=-1,this.isYearParsed=!1,this.parsedMonth=-1,this.knownSpecifiers=["d","M","y","H","h","m","s","f","F","g","t"],this.replacers={d:this.replaceDay,M:this.replaceMonth,y:this.replaceYear,H:this.replaceHours23,h:this.replaceHours12,m:this.replaceMinutes,s:this.replaceSeconds,F:this.replaceMsTrimmed,f:this.replaceMs,g:this.replaceEra,t:this.replaceAmPm},this.parsers={d:this.parseDay,M:this.parseMonth,y:this.parseYear,H:this.parseHours,h:this.parseHours,m:this.parseMinutes,s:this.parseSeconds,F:this.parseMs,f:this.parseMs,g:this.parseEra,t:this.parseAmPm},this.options=e}return e.prototype.setFormatString=function(e){2===e.length&&"%"===e.charAt(0)&&(e=e.charAt(1));var t=!!e&&-1!==e.indexOf(this.options.ds);this.specifiers={},this.spPositions=[],this.mask="";for(var r=0,i=0,n=!1,o=!1,a="",s="",l=0;;l++){var d=e.charAt(l);if(""===d){a.length>0&&this.registerSpecifier(i,a,t);break}"\\"!==d||o?(o||"'"!==d&&'"'!==d?(n||("/"===d?d=this.options.ds:":"===d?d=this.options.ts:this.isKnownSpecifier(d)&&(0===s.length&&(s=d),d===s?a+=d:(a.length>0&&this.registerSpecifier(i,a,t),a=d,i=l-r))),this.mask+=d):(n=!n,r++),o=!1):(o=!0,r++),s=d}this.spPositions.reverse()},e.prototype.format=function(e){this.date=e;for(var t=this.mask,r=0,i=this.spPositions;r<i.length;r++){var n=i[r],o=this.specifiers[n],a=o.substr(0,1);this.replacers[a]&&(t=t.substr(0,n)+this.replacers[a].call(this,o.length)+t.substr(n+o.length))}return t},e.prototype.parse=function(e,t){var r=new Date;this.savedYear=r.getFullYear(),this.isYearParsed=!1,this.parsedMonth=-1,this.date=new Date(2e3,0,r.getDate()),this.strToParse=e,this.catchNumbers(e),this.hasAmPm=!1;for(var i=0,n=this.spPositions;i<n.length;i++){var o=n[i],a=this.specifiers[o],s=a.substr(0,1);if(this.parsers[s]&&(t&&this.parserKeys.push(s),!this.parsers[s].call(this,a.length)))return!1}return!(this.hasAmPm&&!this.fixHours())&&(this.isYearParsed||this.date.setFullYear(this.savedYear),this.parsedMonth<0&&(this.parsedMonth=r.getMonth()),this.applyMonth(),this.date)},e.prototype.hasYear=function(){return this.hasParserKey("y")},e.prototype.hasMonth=function(){return this.hasParserKey("M")},e.prototype.hasDay=function(){return this.hasParserKey("d")},e.prototype.hasHours=function(){return this.hasParserKey("h")||this.hasParserKey("H")},e.prototype.hasMinutes=function(){return this.hasParserKey("m")},e.prototype.hasSeconds=function(){return this.hasParserKey("s")},e.prototype.hasMilliseconds=function(){return this.hasParserKey("f")||this.hasParserKey("F")},e.prototype.hasParserKey=function(e){return-1!==this.parserKeys.indexOf(e)},e.expandPredefinedFormat=function(e,t){switch(e){case"d":return t.shortDate;case"D":return t.longDate;case"t":return t.shortTime;case"T":return t.longTime;case"g":return t.shortDate+" "+t.shortTime;case"f":return t.longDate+" "+t.shortTime;case"G":return t.shortDate+" "+t.longTime;case"F":case"U":return t.longDate+" "+t.longTime;case"M":case"m":return t.monthDay;case"Y":case"y":return t.yearMonth;case"O":case"o":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss.fffffff";case"R":case"r":return"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'";case"s":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss";case"u":return"yyyy'-'MM'-'dd HH':'mm':'ss'Z'"}return e},e.prototype.applyMonth=function(){for(var e,t=this.date.getDate();(e=new Date).setTime(this.date.getTime()),e.setMonth(this.parsedMonth),e.getMonth()!==this.parsedMonth;)--t,this.date.setDate(t);o.DateUtils.fixTimezoneGap(this.date,e),this.date=e},e.prototype.registerSpecifier=function(e,t,r){if(this.options.ds.length>1&&this.mask&&!r){var i=this.mask.split(this.options.ds);i&&(i.length>0&&""===i[i.length-1]&&i.pop(),e+=(i.length-1)*(this.options.ds.length-1))}this.spPositions.push(e),this.specifiers[e]=t},e.prototype.replaceDay=function(e){if(e<3){var t=this.date.getDate().toString();return 2===e?this.padLeft(t,2):t}return 3===e?this.options.abbrDayNames[this.date.getDay()]:this.options.dayNames[this.date.getDay()]},e.prototype.replaceMonth=function(e){var t=1+this.date.getMonth();switch(e){case 1:return t.toString();case 2:return this.padLeft(t.toString(),2);case 3:return this.options.abbrMonthNames[t-1];default:for(var r in this.specifiers)if(Object.prototype.hasOwnProperty.call(this.specifiers,r)){var i=this.specifiers[r];if("d"===i||"dd"===i)return this.options.genMonthNames[t-1]}return this.options.monthNames[t-1]}},e.prototype.replaceYear=function(e){var t=this.date.getFullYear();return e<=2&&(t%=100),this.padLeft(t.toString(),e)},e.prototype.replaceHours23=function(e){var t=this.date.getHours().toString();return e>1?this.padLeft(t,2):t},e.prototype.replaceHours12=function(e){var t=this.date.getHours()%12;0===t&&(t=12);var r=t.toString();return e>1?this.padLeft(r,2):r},e.prototype.replaceMinutes=function(e){var t=this.date.getMinutes().toString();return e>1?this.padLeft(t,2):t},e.prototype.replaceSeconds=function(e){var t=this.date.getSeconds().toString();return e>1?this.padLeft(t,2):t},e.prototype.replaceMsTrimmed=function(e){return this.formatMs(e,!0)},e.prototype.replaceMs=function(e){return this.formatMs(e,!1)},e.prototype.replaceEra=function(e){return"A.D."},e.prototype.replaceAmPm=function(e){var t=this.date.getHours()<12?this.options.am:this.options.pm;return e<2?t.charAt(0):t},e.prototype.catchNumbers=function(e){var t=this;this.parseNumbers=[];for(var r,n=/\d+/g;r=n.exec(e);)this.parseNumbers.push(this.parseDecInt(r[0]));var o=0,a=new Date;i.StringMapUtils.forEach(this.specifiers,(function(e){if("string"==typeof e&&t.isNumericSpecifier(e)&&(o++,t.parseNumbers.length<o)){var r=0;"y"===e.charAt(0)&&(r=a.getFullYear()),t.parseNumbers.push(r)}}));var s=this.parseNumbers.length-o;s>0&&this.parseNumbers.splice(o,s),this.currentParseNumber=this.parseNumbers.length-1},e.prototype.popParseNumber=function(){return this.parseNumbers[this.currentParseNumber--]},e.prototype.findAbbrMonth=function(){return this.findMonthCore(this.options.abbrMonthNames)},e.prototype.findFullMonth=function(){return this.findMonthCore(this.options.genMonthNames)},e.prototype.findMonthCore=function(e){for(var t=this.strToParse.toLowerCase(),r=0;r<e.length;r++){var i=e[r].toLowerCase();if(i.length>0&&t.indexOf(i)>-1)return this.strToParse=this.strToParse.replace(new RegExp(i,"gi"),n.StringUtils.repeat(" ",i.length)),1+r}return!1},e.prototype.parseDay=function(e){if(e<3){var t=this.popParseNumber();if(t<1||t>31)return!1;this.date.setDate(t)}return!0},e.prototype.parseMonth=function(e){var t;switch(e){case 1:case 2:t=this.popParseNumber();break;case 3:t=this.findAbbrMonth();break;default:t=this.findFullMonth()}return!(!1===t||t<1||t>12)&&(this.parsedMonth=t-1,!0)},e.prototype.parseYear=function(e){var t=this.popParseNumber();return!(t>9999)&&(t<100&&(t=o.DateUtils.expandTwoDigitYear(t,this.options)),this.date.setFullYear(t),this.isYearParsed=!0,!0)},e.prototype.parseHours=function(e){var t=this.popParseNumber();return!(t>23)&&(this.date.setHours(t),!0)},e.prototype.parseMinutes=function(e){var t=this.parseMinSecCore();return-1!==t&&(this.date.setMinutes(t),!0)},e.prototype.parseSeconds=function(e){var t=this.parseMinSecCore();return-1!==t&&(this.date.setSeconds(t),!0)},e.prototype.parseMs=function(e){e>3&&(e=3);for(var t=1,r=0;r<e;r++)t*=10;t-=1;for(var i=this.popParseNumber();i>t;)i/=10;return this.date.setMilliseconds(Math.round(i)),!0},e.prototype.parseEra=function(e){return!0},e.prototype.parseAmPm=function(e){return this.hasAmPm=this.options.am.length>0&&this.options.pm.length>0,!0},e.prototype.parseDecInt=function(e){return parseInt(e,10)},e.prototype.padLeft=function(e,t){for(;e.length<t;)e="0"+e;return e},e.prototype.formatMs=function(e,t){var r=Math.floor(this.date.getMilliseconds()*Math.pow(10,e-3)),i=this.padLeft(r.toString(),e);if(t){for(var n=i.length-1,o=!1;"0"===i.charAt(n);)o=!0,n--;o&&(i=i.substring(0,n+1))}return i},e.prototype.parseMinSecCore=function(){var e=this.popParseNumber();return e>59?-1:e},e.prototype.fixHours=function(){var e=this.getAmPmState(this.strToParse,!1);if(!e)return!0;var t=this.date.getHours();switch(e){case"P":if(t>12)return!1;t<12&&this.date.setHours(12+t);break;case"A":12===t&&this.date.setHours(0)}return!0},e.prototype.getAmPmState=function(e,t){var r=this.options.am.charAt(0).toLowerCase(),i=this.options.pm.charAt(0).toLowerCase(),n=new RegExp(r,"gi").exec(e),o=new RegExp(i,"gi").exec(e),a=n?n.length:0,s=o?o.length:0,l=a>0;return l!==s>0&&a<2&&s<2?l?"A":"P":t?null:(e=e.replace(new RegExp(this.getDayMonthNameReplacePattern(),"gi"),""),this.getAmPmState(e,!0))},e.prototype.getDayMonthNameReplacePattern=function(){return this.dayMonthNameReplacePattern?this.dayMonthNameReplacePattern:this.createDayMonthNameReplacePattern()},e.prototype.createDayMonthNameReplacePattern=function(){var e=[];return e.push("(?:"),e.push(this.createReplacePattern(this.options.monthNames)),e.push(this.createReplacePattern(this.options.genMonthNames)),e.push(this.createReplacePattern(this.options.abbrMonthNames)),e.push(this.createReplacePattern(this.options.abbrDayNames)),e.push(this.createReplacePattern(this.options.dayNames)),e.push(")"),e.join("")},e.prototype.createReplacePattern=function(e){return e&&e.length>0?"\\b"+e.join("\\b|\\b")+"\\b":""},e.prototype.isNumericSpecifier=function(e){var t=e.charAt(0);return!("g"===t||"t"===t||("M"===t||"d"===t)&&e.length>2)},e.prototype.isKnownSpecifier=function(e){return e=e.charAt(0),-1!==this.knownSpecifiers.indexOf(e)},e}();t.DateFormatter=a},1768:function(e,t,r){t.$=void 0;var i=r(2020),n=r(5308),o=r(2004),a=r(5418),s=function(){function e(e){this.options=e,this.dateFormatter=new n.DateFormatter(e),this.numberFormatter=new o.NumberFormatter(e),this.stringFormatter=new a.StringFormatter(this.dateFormatter,this.numberFormatter)}return e.prototype.formatString=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(t=this.stringFormatter).format.apply(t,i.__spreadArray([e],r))},e.prototype.formatDate=function(e,t){return this.dateFormatter.setFormatString(e),this.dateFormatter.format(t)},e.prototype.formatNumber=function(e,t){return this.numberFormatter.format(e,t)},e}();t.$=s},2004:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NumberFormatter=void 0;var r=function(){function e(e){this.positive=!0,this.digits=[],this.pointPos=0,this.spec="",this.prec=-1,this.upper=!0,this.custom=!1,this.options=e}return e.prototype.format=function(e,t){if(isNaN(t))return this.options.numNan;if(!isFinite(t))return t>0?this.options.numPosInf:this.options.numNegInf;if(this.fillFormatInfo(e),"X"===this.spec)return this.formatHex(t);switch(this.fillDigitInfo(t),this.spec){case"C":return this.formatCurrency();case"D":return this.formatDecimal();case"E":return this.formatExp();case"F":return this.formatFixed();case"G":return this.formatGeneral();case"N":return this.formatNumber();case"P":return this.formatPercent();default:return this.custom?this.formatCustom(e):"?"}},e.prototype.formatCurrency=function(){this.prec<0&&(this.prec=this.options.currPrec),this.round(this.prec);var e=[];if(this.positive)switch(this.options.currPosPattern){case 0:e.push(this.options.currency);break;case 2:e.push(this.options.currency," ")}else switch(this.options.currNegPattern){case 0:e.push("(",this.options.currency);break;case 1:e.push("-",this.options.currency);break;case 2:e.push(this.options.currency,"-");break;case 3:e.push(this.options.currency);break;case 4:case 15:e.push("(");break;case 5:case 8:e.push("-");break;case 9:e.push("-",this.options.currency," ");break;case 11:e.push(this.options.currency," ");break;case 12:e.push(this.options.currency," -");break;case 14:e.push("(",this.options.currency," ")}if(this.appendGroupedInteger(e,this.options.currGroups,this.options.currGroupSeparator),this.prec>0&&(e.push(this.options.currDecimalPoint),this.appendDigits(e,this.pointPos,this.pointPos+this.prec)),this.positive)switch(this.options.currPosPattern){case 1:e.push(this.options.currency);break;case 3:e.push(" ",this.options.currency)}else switch(this.options.currNegPattern){case 0:case 14:e.push(")");break;case 3:case 11:e.push("-");break;case 4:e.push(this.options.currency,")");break;case 5:e.push(this.options.currency);break;case 6:e.push("-",this.options.currency);break;case 7:e.push(this.options.currency,"-");break;case 8:e.push(" ",this.options.currency);break;case 10:e.push(" ",this.options.currency,"-");break;case 13:e.push("- ",this.options.currency);break;case 15:e.push(" ",this.options.currency,")")}return e.join("")},e.prototype.formatDecimal=function(){if(this.prec<this.pointPos&&(this.prec=this.pointPos),this.prec<1)return"0";var e=[];return this.positive||e.push("-"),this.appendDigits(e,this.pointPos-this.prec,this.pointPos),e.join("")},e.prototype.formatExp=function(){return this.prec<0&&(this.prec=6),this.round(1-this.pointPos+this.prec),this.formatExpCore(3)},e.prototype.formatExpCore=function(e){var t=[];this.positive||t.push("-"),this.appendDigits(t,0,1),this.prec>0&&(t.push(this.options.numDecimalPoint),this.appendDigits(t,1,1+this.prec)),t.push(this.upper?"E":"e");var r=this.pointPos-1;r>=0?t.push("+"):(t.push("-"),r=-r);for(var i=String(r),n=i.length;n<e;n++)t.push(0);return t.push(i),t.join("")},e.prototype.formatFixed=function(){this.prec<0&&(this.prec=this.options.numPrec),this.round(this.prec);var e=[];return this.positive||e.push("-"),this.pointPos<1?e.push(0):this.appendDigits(e,0,this.pointPos),this.prec>0&&(e.push(this.options.numDecimalPoint),this.appendDigits(e,this.pointPos,this.pointPos+this.prec)),e.join("")},e.prototype.formatGeneral=function(){var e,t=this.pointPos<this.digits.length;return this.prec<0?(e=t,this.prec=t?15:10):(e=!0,this.prec<1&&(this.prec=t?15:10),this.round(this.prec-this.pointPos)),e&&(this.pointPos>this.prec||this.pointPos<=-4)?(this.prec=this.digits.length-1,this.formatExpCore(2)):(this.prec=Math.min(this.prec,Math.max(1,this.digits.length))-this.pointPos,this.formatFixed())},e.prototype.formatNumber=function(){this.prec<0&&(this.prec=this.options.numPrec),this.round(this.prec);var e=[];if(!this.positive)switch(this.options.numNegPattern){case 0:e.push("(");break;case 1:e.push("-");break;case 2:e.push("- ")}if(this.appendGroupedInteger(e,this.options.numGroups,this.options.numGroupSeparator),this.prec>0&&(e.push(this.options.numDecimalPoint),this.appendDigits(e,this.pointPos,this.pointPos+this.prec)),!this.positive)switch(this.options.numNegPattern){case 0:e.push(")");break;case 3:e.push("-");break;case 4:e.push(" -")}return e.join("")},e.prototype.formatPercent=function(){this.prec<0&&(this.prec=this.options.numPrec),this.digits.length>0&&(this.pointPos+=2),this.round(this.prec);var e=[];switch(this.positive||e.push("-"),2===this.options.percentPattern&&e.push("%"),this.appendGroupedInteger(e,this.options.numGroups,this.options.numGroupSeparator),this.prec>0&&(e.push(this.options.numDecimalPoint),this.appendDigits(e,this.pointPos,this.pointPos+this.prec)),this.options.percentPattern){case 0:e.push(" %");break;case 1:e.push("%")}return e.join("")},e.prototype.formatHex=function(e){var t=e.toString(16);if(t.indexOf("(")>-1)return t;if(t=this.upper?t.toUpperCase():t.toLowerCase(),this.prec<=t.length)return t;for(var r=[],i=t.length;i<this.prec;i++)r.push(0);return r.push(t),r.join("")},e.prototype.formatCustom=function(t){var r=e.getCustomFormatSections(t),i=this.selectCustomFormatSection(r);if(""===i)return this.positive?"":"-";var n=e.parseCustomFormatSection(i),o=this.createCustomFormatLists(n);r.length>2&&i!==r[2]&&(""===o.i.concat(o.f).join("").split("0").join("")&&(i=r[2],n=e.parseCustomFormatSection(i),o=this.createCustomFormatLists(n)));return this.formatCustomCore(i,n,o)},e.getCustomFormatSections=function(e){for(var t=[],r=!1,i="",n=0,o=0,a=0;a<e.length;a++){var s=e.charAt(a);if(r||""!==i||";"!==s)r?r=!1:s===i?i=""===i?s:"":"\\"===s?r=!0:"'"!==s&&'"'!==s||(i=s),++n;else if(t.push(e.substr(o,n)),n=0,o=a+1,t.length>2)break}return n>0&&t.push(e.substr(o,n)),t.length<1&&t.push(e),t},e.prototype.selectCustomFormatSection=function(e){return!this.positive&&e.length>1&&""!==e[1]?(this.positive=!0,e[1]):this.digits.length<1&&e.length>2&&""!==e[2]?e[2]:e[0]},e.createCustomFormatInfo=function(){return{pointPos:-1,grouping:!1,exp:!1,expShowPlus:!1,percent:!1,scaling:0,intDigits:0,fracDigits:0,expDigits:0,intSharps:0,fracSharps:0,expSharps:0}},e.parseCustomFormatSection=function(t){for(var r="",i="i",n=!0,o=e.createCustomFormatInfo(),a=0,s=0;s<t.length;s++){var l=t.charAt(s);if(l!==r){if(""===r)if("e"!==i||"0"===l||"#"===l)switch(l){case"\\":s++;continue;case"'":case'"':r=l;continue;case"#":case"0":if("#"===l)switch(i){case"i":n&&o.intSharps++;break;case"f":o.fracSharps++;break;case"e":o.expSharps++}else switch(n=!1,i){case"f":o.fracSharps=0;break;case"e":o.expSharps=0}switch(i){case"i":o.intDigits++,a>0&&(o.grouping=!0),a=0;break;case"f":o.fracDigits++;break;case"e":o.expDigits++}break;case"e":case"E":if(o.exp)break;if(o.exp=!0,i="e",s<t.length-1){var d=t.charAt(1+s);"+"===d||"-"===d?("+"===d&&(o.expShowPlus=!0),s++):"0"!==d&&"#"!==d&&(o.exp=!1,o.pointPos<0&&(i="i"))}break;case".":i="f",o.pointPos<0&&(o.pointPos=s);break;case"%":o.percent=!0;break;case",":"i"===i&&o.intDigits>0&&a++}else i=o.pointPos<0?"i":"f",s--}else r=""}return o.expDigits<1?o.exp=!1:o.intSharps=0,o.fracDigits<1&&(o.pointPos=-1),o.scaling=3*a,o},e.prototype.createCustomFormatLists=function(e){var t=[],r=[],i=[];this.digits.length>0&&(e.percent&&(this.pointPos+=2),this.pointPos-=e.scaling);var n=!0;if(e.exp&&(e.intDigits>0||e.fracDigits>0)){var o=0;this.digits.length>0&&(this.round(e.intDigits+e.fracDigits-this.pointPos),o-=this.pointPos-e.intDigits,this.pointPos=e.intDigits),n=o<=0,i=String(o<0?-o:o).split("")}else this.round(e.fracDigits);if(this.digits.length<1||this.pointPos<1?t=[0]:this.appendDigits(t,0,this.pointPos),this.appendDigits(r,this.pointPos,this.digits.length),e.exp){for(;t.length<e.intDigits;)t.unshift(0);for(;i.length<e.expDigits-e.expSharps;)i.unshift(0);n&&e.expShowPlus?i.unshift("+"):n||i.unshift("-")}else{for(;t.length<e.intDigits-e.intSharps;)t.unshift(0);if(e.intSharps>=e.intDigits){for(var a=!0,s=0;s<t.length;s++)if(0!==t[s]){a=!1;break}a&&(t=[])}}for(;r.length<e.fracDigits-e.fracSharps;)r.push(0);return{i:t,f:r,e:i}},e.prototype.formatCustomCore=function(e,t,r){var i=0,n=0,o=0,a=0,s=0;if(t.grouping&&this.options.numGroups.length>0){i=r.i.length;for(var l=0;l<this.options.numGroups.length;l++)n+this.options.numGroups[l]<=i&&(n+=this.options.numGroups[l],o=l);var d=i>n?i-n:0;if(0===(s=this.options.numGroups[o])){for(;o>=0&&0===this.options.numGroups[o];)o--;s=d>0?d:this.options.numGroups[o]}0===d?a=s:(o+=Math.floor(d/s),0===(a=d%s)?a=s:o++)}else t.grouping=!1;var c=[],h="i",u=0,p=0,g=0,m="";for(l=0;l<e.length;l++){var f=e.charAt(l);if(f!==m)if(""===m)switch(f){case"\\":++l<e.length&&c.push(e.charAt(l));continue;case"'":case'"':m=f;continue;case"#":case"0":if("i"===h){if(u++,"0"===f||t.intDigits-u<r.i.length+p)for(;t.intDigits-u+p<r.i.length;)c.push(r.i[p].toString()),p++,t.grouping&&--i>0&&0==--a&&(c.push(this.options.numGroupSeparator),--o<this.options.numGroups.length&&o>=0&&(s=this.options.numGroups[o]),a=s)}else"f"===h&&g<r.f.length&&(c.push(r.f[g].toString()),g++);break;case"e":case"E":if(null==r.e||!t.exp){c.push(f);break}for(var b=l+1;b<e.length&&(b===l+1&&("+"===e.charAt(b)||"-"===e.charAt(b))||"0"===e.charAt(b)||"#"===e.charAt(b));b++);l=b-1,h=t.pointPos<0?"i":"f",c.push(f),c=c.concat(r.e),r.e=null;break;case".":t.pointPos===l&&r.f.length>0&&c.push(this.options.numDecimalPoint),h="f";break;case",":break;default:c.push(f)}else c.push(f);else m=""}return this.positive||c.unshift("-"),c.join("")},e.prototype.fillDigitInfo=function(e){if(this.positive=!0,e<0&&(e=-e,this.positive=!1),this.digits=[],this.pointPos=0,0!==e&&isFinite(e)&&!isNaN(e)){var t=String(e).split("e"),r=t[0];t.length>1&&(this.pointPos=Number(t[1]));for(var i=!1,n=0,o=0;o<r.length;o++){var a=r.charAt(o);"."===a?i=!0:(i&&n++,("0"!==a||this.digits.length>0)&&this.digits.push(Number(a)))}this.pointPos+=this.digits.length-n}else this.pointPos=1},e.prototype.fillFormatInfo=function(e){var t;if(this.upper=!0,this.custom=!1,this.prec=-1,(t=null==e||e.length<1?"G":e.charAt(0))>="a"&&t<="z"&&(t=t.toUpperCase(),this.upper=!1),t>="A"&&t<="Z"){if(null!=e&&e.length>1){var r=Number(e.substr(1));isNaN(r)?this.custom=!0:this.prec=r}}else this.custom=!0;this.spec=this.custom?"0":t},e.prototype.round=function(e){var t=this.digits.length-this.pointPos-e;if(!(t<=0)){var r=this.pointPos+e;if(r<0)return this.digits=[],void(this.pointPos=0);var i=this.digits[r];if(i>4)for(var n=0;n<t;n++){var o=r-1-n;if(o<0&&(this.digits.unshift(0),this.pointPos++,r++,o++),(i=this.digits[o])<9){this.digits[o]=1+i;break}this.digits[o]=0,t++}for(n=r-1;n>=0&&!(this.digits[n]>0);n--)r--;this.digits.splice(r,this.digits.length-r)}},e.prototype.appendGroupedInteger=function(e,t,r){if(this.pointPos<1)e.push(0);else{for(var i=0,n=0,o=0;o<t.length&&i+t[o]<=this.pointPos;o++)i+=t[o],n=o;if(t.length>0&&i>0){var a=void 0,s=t[n],l=this.pointPos>i?this.pointPos-i:0;if(0===s){for(;n>=0&&0===t[n];)n--;s=l>0?l:t[n]}0===l?a=s:(n+=Math.floor(l/s),0===(a=l%s)?a=s:n++);for(o=0;;){if(this.pointPos-o<=a||0===a){this.appendDigits(e,o,this.pointPos);break}this.appendDigits(e,o,o+a),e.push(r),o+=a,--n<t.length&&n>=0&&(s=t[n]),a=s}}else this.appendDigits(e,0,this.pointPos)}},e.prototype.appendDigits=function(e,t,r){for(var i=t;i<r;i++)i<0||i>=this.digits.length?e.push(0):e.push(this.digits[i])},e}();t.NumberFormatter=r},5418:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.StringFormatter=void 0;var i=r(5308),n=r(8786),o=function(){function e(e,t){this.activeDateFormat=null,this.dateFormatter=e,this.numberFormatter=t}return e.prototype.format=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var o=[],a=0,s=0;a<e.length;){var l=e.charAt(a);if(a++,"{"===l){if(o.push(e.substr(s,a-s-1)),"{"===e.charAt(a)){s=a,a++;continue}var d=this.parseSpec(e,a);a=d.pos;var c=t[d.index],h=void 0;if(null==c)h="";else if("number"==typeof c)h=this.numberFormatter.format(d.format,c);else if(c instanceof Date)d.format!==this.activeDateFormat&&(this.activeDateFormat=d.format,""===d.format&&(d.format="G"),1===d.format.length&&(d.format=i.DateFormatter.expandPredefinedFormat(d.format,this.dateFormatter.options)),this.dateFormatter.setFormatString(d.format)),"U"===this.activeDateFormat&&(c=n.DateUtils.toUtcTime(c)),h=this.dateFormatter.format(c);else if(h=String(c),""!==d.format&&h.length>0){var u=Number(h.replace(",","."));isNaN(u)||(h=this.numberFormatter.format(d.format,u))}var p=d.width-h.length;if(p>0){d.left&&o.push(h);for(var g=0;g<p;g++)o.push(" ");d.left||o.push(h)}else o.push(h);s=a}else if("}"===l&&a<e.length&&"}"===e.charAt(a))o.push(e.substr(s,a-s-1)),s=a,a++;else if("}"===l)return""}return s<e.length&&o.push(e.substr(s)),o.join("")},e.prototype.parseSpec=function(e,t){var r,i,n={index:-1,left:!1,width:0,format:"",pos:0};for(r=t;!((i=e.charAt(t))<"0"||i>"9");)t++;if(t>r&&(n.index=Number(e.substr(r,t-r))),","===e.charAt(t)){for(t++;" "===(i=e.charAt(t))||"\t"===i;)t++;for(n.left="-"===e.charAt(t),n.left&&t++,r=t;!((i=e.charAt(t))<"0"||i>"9");)t++;t>r&&(n.width=Number(e.substr(r,t-r)))}if(":"===e.charAt(t)){for(r=++t;"}"!==e.charAt(t);)t++;n.format=e.substr(r,t-r)}return t++,n.pos=t,n},e}();t.StringFormatter=o},3604:function(e,t,r){t.m=void 0;var i=r(2020),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.empty=function(){return new t(0,0,0,0)},t.prototype.clone=function(){return new t(this.left,this.right,this.top,this.bottom)},t}(r(4125).Offsets);t.m=n},5596:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Metrics=void 0;var r=function(){function e(){}return e.euclideanDistance=function(e,t){var r=e.x-t.x,i=e.y-t.y;return Math.sqrt(r*r+i*i)},e.manhattanDistance=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},e}();t.Metrics=r},4125:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Offsets=void 0;var r=function(){function e(e,t,r,i){this.left=e,this.right=t,this.top=r,this.bottom=i}return e.empty=function(){return new e(0,0,0,0)},Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.left+this.right},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.top+this.bottom},enumerable:!1,configurable:!0}),e.fromNumber=function(t){return new e(t,t,t,t)},e.fromOffsets=function(t){return new e(t.left,t.right,t.top,t.bottom)},e.fromSide=function(t,r){return new e(t,t,r,r)},e.prototype.normalize=function(){return this.left=Math.max(0,this.left),this.right=Math.max(0,this.right),this.top=Math.max(0,this.top),this.bottom=Math.max(0,this.bottom),this},e.prototype.toString=function(){return JSON.stringify(this)},e.prototype.isEmpty=function(){return 0===this.left&&0===this.right&&0===this.top&&0===this.bottom},e.prototype.offset=function(e){return this.left+=e.left,this.right+=e.right,this.top+=e.top,this.bottom+=e.bottom,this},e.prototype.multiply=function(e,t,r,i){switch(arguments.length){case 1:return this.left*=e,this.right*=e,this.top*=e,this.bottom*=e,this;case 2:return this.left*=e,this.right*=e,this.top*=t,this.bottom*=t,this;case 4:return this.left*=e,this.right*=t,this.top*=r,this.bottom*=i,this}return this},e.prototype.clone=function(){return new e(this.left,this.right,this.top,this.bottom)},e.prototype.copyFrom=function(e){this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom},e.prototype.equals=function(e){return this.top===e.top&&this.bottom===e.bottom&&this.right===e.right&&this.left===e.left},e.prototype.applyConverter=function(e){return this.left=e(this.left),this.right=e(this.right),this.top=e(this.top),this.bottom=e(this.bottom),this},e}();t.Offsets=r},8900:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Point=void 0;var r=function(){function e(e,t){this.x=e,this.y=t}return e.zero=function(){return new e(0,0)},e.fromNumber=function(t){return new e(t,t)},e.prototype.isZero=function(){return 0===this.x&&0===this.y},e.prototype.toString=function(){return JSON.stringify(this)},e.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e){return this.x===e.x&&this.y===e.y},e.prototype.offset=function(e,t){return this.x+=e,this.y+=t,this},e.prototype.offsetByPoint=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.multiply=function(e,t){return this.x*=e,this.y*=t,this},e.prototype.negative=function(){return this.x*=-1,this.y*=-1,this},e.prototype.applyConverter=function(e){return this.x=e(this.x),this.y=e(this.y),this},e.plus=function(t,r){return new e(t.x+r.x,t.y+r.y)},e.minus=function(t,r){return new e(t.x-r.x,t.y-r.y)},e.xComparer=function(e,t){return e.x-t.x},e.yComparer=function(e,t){return e.y-t.y},e.equals=function(e,t){return e.x===t.x&&e.y===t.y},e}();t.Point=r},9210:function(e,t,r){t.VW=t.mg=void 0;var i,n=r(2020),o=r(8900),a=r(9716),s=r(1335),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),Object.defineProperty(t.prototype,"numEdges",{get:function(){return this.points.length},enumerable:!1,configurable:!0}),t.fromRectangle=function(e){var r=e.x+e.width,i=e.y+e.height;return new t([new o.Point(e.x,e.y),new o.Point(r,e.y),new o.Point(r,i),new o.Point(e.x,i)])},t.prototype.getEdge=function(e){return new s.Segment(this.points[e],this.points[(e+1)%this.numEdges])},t.collision=function(e,t){for(var r=e.numEdges,n=t.numEdges,o=!1,s=0;s<r+n;s++){var l=s<r?e.getEdge(s):t.getEdge(s-r),d=a.Vector.fromSegment(l),c=new a.Vector(-d.y,d.x).normalize(),h=e.projection(c),u=t.projection(c),p=h.minValue<u.minValue?u.minValue-h.maxValue:h.minValue-u.maxValue;if(p>0)return i.None;p<0&&(o=!0)}return o?i.Intersect:i.Contact},t}(r(2313).PolygonalChain);t.mg=l,function(e){e[e.None=0]="None",e[e.Intersect=1]="Intersect",e[e.Contact=2]="Contact"}(i=t.VW||(t.VW={}))},2313:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PolygonalChain=void 0;var i=r(2940),n=r(8900),o=r(8011),a=r(1335),s=r(9716),l=function(){function e(e){this.points=[],this.points=e}return e.prototype.getSegment=function(e){return new a.Segment(this.points[e],this.points[e+1])},Object.defineProperty(e.prototype,"bounds",{get:function(){var e=i.ListUtils.minMaxExtended(this.points,(function(e){return e.y})),t=i.ListUtils.minMaxExtended(this.points,(function(e){return e.x}));return new o.Rectangle(t.minValue,e.minValue,t.maxValue-t.minValue,e.maxValue-e.minValue)},enumerable:!1,configurable:!0}),e.prototype.rotateAround=function(e,t,r,i){void 0===r&&(r=!1),void 0===i&&(i=!0);var o=new n.Point(e.x,e.y);this.changeCoordinateCenterTo(o);for(var a=Math.sin(t),s=Math.cos(t),l=(r?1:0)^(i?1:0)?-1:1,d=0,c=this.points;d<c.length;d++){var h=c[d],u=h.clone();h.x=u.x*s+l*u.y*a,h.y=-l*u.x*a+u.y*s}return this.changeCoordinateCenterTo(o.multiply(-1,-1)),this},e.prototype.changeCoordinateCenterTo=function(e){var t=new n.Point(e.x,e.y).multiply(-1,-1);return i.ListUtils.forEach(this.points,(function(e){return e.offsetByPoint(t)})),this},e.prototype.projection=function(e){return i.ListUtils.minMaxExtended(this.points,(function(t){return s.Vector.scalarProduct(t,e)}))},e}();t.PolygonalChain=l},8011:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleDeviation=t.HitTestDeviation=t.Rectangle=void 0;var i,n=r(7820),o=r(1104),a=r(8860),s=r(8900),l=r(6353),d=function(){function e(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return e.center(this)},enumerable:!1,configurable:!0}),e.prototype.createRectangle=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.createSize=function(){return new l.Size(this.width,this.height)},e.prototype.createPosition=function(){return new s.Point(this.x,this.y)},e.prototype.createVerticalInterval=function(){return new a.FixedInterval(this.y,this.height)},e.prototype.createHorizontalInterval=function(){return new a.FixedInterval(this.x,this.width)},e.fromGeometry=function(t,r){return new e(t.x,t.y,r.width,r.height)},e.fromPoints=function(t,r){return new e(Math.min(t.x,r.x),Math.min(t.y,r.y),Math.abs(t.x-r.x),Math.abs(t.y-r.y))},e.fromPositions=function(t,r,i,n){return new e(Math.min(t,i),Math.min(r,n),Math.abs(i-t),Math.abs(n-r))},e.fromCenter=function(t,r){return new e(t.x-r,t.y-r,2*r,2*r)},e.prototype.isCollapsed=function(){return 0===this.width||0===this.height},e.prototype.isEmpty=function(){return 0===this.x&&0===this.y&&0===this.width&&0===this.height},e.prototype.toString=function(){return JSON.stringify(this)},e.prototype.setPosition=function(e){return this.x=e.x,this.y=e.y,this},e.prototype.setSize=function(e){return this.width=e.width,this.height=e.height,this},e.prototype.setGeomerty=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},e.prototype.moveRectangle=function(e,t){return this.x+=e,this.y+=t,this},e.prototype.moveRectangleByPoint=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.resize=function(e,t){return this.width+=e,this.height+=t,this},e.prototype.nonNegativeSize=function(){return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this},e.prototype.multiply=function(e,t){return this.x*=e,this.y*=t,this.width*=e,this.height*=t,this},e.prototype.equals=function(t){return e.equals(this,t)},e.prototype.clone=function(){var t=new e(0,0,0,0);return t.copyFrom(this),t},e.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height},e.prototype.containsPoint=function(t){return e.containsPoint(this,t)},e.prototype.containsRectangle=function(e){return this.x<=e.x&&this.right>=e.right&&this.y<=e.y&&this.bottom>=e.bottom},e.prototype.inflate=function(e,t){return void 0===t&&(t=e),this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this},e.prototype.applyOffsetsInside=function(e){return this.x+=e.left,this.y+=e.top,this.width-=e.left+e.right,this.height-=e.top+e.bottom,this},e.prototype.applyNormalizedOffsetsInside=function(e){var t=Math.max(0,e.left),r=t+Math.max(0,e.right);0!==r&&(r<=this.width?(this.x+=t,this.width-=r):(this.x+=this.width*(t/r),this.width=0));var i=Math.max(0,e.top),n=i+Math.max(0,e.bottom);return 0!==n&&(n<=this.height?(this.y+=i,this.height-=n):(this.y+=this.height*(i/n),this.height=0)),this},e.prototype.applyOffsetsOutside=function(e){return this.x-=e.left,this.y-=e.top,this.width+=e.left+e.right,this.height+=e.top+e.bottom,this},e.prototype.applyConverter=function(e){return this.x=e(this.x),this.y=e(this.y),this.width=e(this.width),this.height=e(this.height),this},e.getHorizIntersection=function(e,t){return o.IntervalAlgorithms.getIntersection(new a.FixedInterval(e.x,e.width),new a.FixedInterval(t.x,t.width))},e.getVertIntersection=function(e,t){return o.IntervalAlgorithms.getIntersection(new a.FixedInterval(e.y,e.height),new a.FixedInterval(t.y,t.height))},e.getIntersection=function(t,r){var i=o.IntervalAlgorithms.getIntersection(new a.FixedInterval(t.x,t.width),new a.FixedInterval(r.x,r.width));if(!i)return null;var n=o.IntervalAlgorithms.getIntersection(new a.FixedInterval(t.y,t.height),new a.FixedInterval(r.y,r.height));return n?new e(i.start,n.start,i.length,n.length):null},e.getHorNonCollapsedIntersection=function(t,r){var i=e.getHorizIntersection(t,r);return i&&!i.isCollapsed()?i:null},e.getVertNonCollapsedIntersection=function(t,r){var i=e.getVertIntersection(t,r);return i&&!i.isCollapsed()?i:null},e.getNonCollapsedIntersection=function(t,r){var i=e.getIntersection(t,r);return i&&!i.isCollapsed()?i:null},e.areIntersected=function(e,t){return!(e.x>t.x+t.width||t.x>e.x+e.width||e.y>t.y+t.height||t.y>e.y+e.height)},e.union=function(t,r){var i=Math.max(t.x+t.width,r.x+r.width),n=Math.max(t.y+t.height,r.y+r.height),o=Math.min(t.x,r.x),a=Math.min(t.y,r.y);return new e(o,a,i-o,n-a)},e.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},e.center=function(e){return new s.Point(e.x+e.width/2,e.y+e.height/2)},e.containsPoint=function(e,t){var r=e.x+e.width,i=e.y+e.height;return t.y>=e.y&&i>=t.y&&t.x>=e.x&&r>=t.x},e}();t.Rectangle=d,function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Bottom=2]="Bottom",e[e.Left=4]="Left",e[e.Right=8]="Right"}(i=t.HitTestDeviation||(t.HitTestDeviation={}));var c=function(){function e(e,t){this.initRectangle=e,this.initPoint=t,this.deviation=new n.Flag(i.None)}return e.prototype.calcDeviation=function(){return this.initPoint.x<this.initRectangle.x?this.deviation.set(i.Left,!0):this.initPoint.x>this.initRectangle.right&&this.deviation.set(i.Right,!0),this.initPoint.y<this.initRectangle.y?this.deviation.set(i.Top,!0):this.initPoint.y>this.initRectangle.bottom&&this.deviation.set(i.Bottom,!0),this},e.prototype.calcAdditionalParams=function(){return this.insidePoint=this.initPoint.clone(),this.offsetToInside=new s.Point(0,0),this.deviation.get(i.Left)?(this.insidePoint.x=this.initRectangle.x,this.offsetToInside.x=this.insidePoint.x-this.initPoint.x):this.deviation.get(i.Right)&&(this.insidePoint.x=this.initRectangle.right,this.offsetToInside.x=this.initPoint.x-this.insidePoint.x),this.deviation.get(i.Top)?(this.insidePoint.y=this.initRectangle.y,this.offsetToInside.y=this.insidePoint.y-this.initPoint.y):this.deviation.get(i.Bottom)&&(this.insidePoint.y=this.initRectangle.bottom,this.offsetToInside.y=this.initPoint.y-this.insidePoint.y),this},e}();t.RectangleDeviation=c},1335:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Segment=void 0;var i=r(8679),n=r(5596),o=r(8900),a=r(8011),s=function(){function e(e,t){this.startPoint=e,this.endPoint=t}return Object.defineProperty(e.prototype,"length",{get:function(){return n.Metrics.euclideanDistance(this.startPoint,this.endPoint)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"xLength",{get:function(){return Math.abs(this.endPoint.x-this.startPoint.x)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yLength",{get:function(){return Math.abs(this.endPoint.y-this.startPoint.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return new o.Point(this.startPoint.x+(this.endPoint.x-this.startPoint.x)/2,this.startPoint.y+(this.endPoint.y-this.startPoint.y)/2)},enumerable:!1,configurable:!0}),e.prototype.isIntersected=function(e){return this.startPoint.equals(e.startPoint)||this.endPoint.equals(e.startPoint)||this.startPoint.equals(e.endPoint)||this.endPoint.equals(e.endPoint)||this.intersectCore(e)&&e.intersectCore(this)},e.prototype.containsPoint=function(e,t){return void 0===t&&(t=1e-7),this.startPoint.equals(e)||this.endPoint.equals(e)||i.MathUtils.numberCloseTo(this.length,n.Metrics.euclideanDistance(this.startPoint,e)+n.Metrics.euclideanDistance(this.endPoint,e),t)},e.prototype.isIntersectedByRect=function(t){if(a.Rectangle.containsPoint(t,this.startPoint)||a.Rectangle.containsPoint(t,this.endPoint))return!0;var r=t.x,i=t.x+t.width,n=t.y,s=t.y+t.height;return this.isIntersected(new e(new o.Point(r,n),new o.Point(r,s)))||this.isIntersected(new e(new o.Point(i,n),new o.Point(i,s)))||this.isIntersected(new e(new o.Point(r,n),new o.Point(i,n)))||this.isIntersected(new e(new o.Point(r,s),new o.Point(i,s)))},e.prototype.intersectCore=function(e){if(this.startPoint.x===this.endPoint.x){if(this.startPoint.x-e.endPoint.x!=0)return(this.startPoint.x-e.startPoint.x)/(this.startPoint.x-e.endPoint.x)<=0;if(e.endPoint.y-this.endPoint.y!=0)return(e.endPoint.y-this.startPoint.y)/(e.endPoint.y-this.endPoint.y)<=0}if(this.startPoint.y===this.endPoint.y){if(this.startPoint.y-e.endPoint.y!=0)return(this.startPoint.y-e.startPoint.y)/(this.startPoint.y-e.endPoint.y)<=0;if(e.endPoint.x-this.endPoint.x!=0)return(e.endPoint.x-this.startPoint.x)/(e.endPoint.x-this.endPoint.x)<=0}var t=(this.endPoint.y-this.startPoint.y)/(this.endPoint.x-this.startPoint.x),r=this.startPoint.y+(e.startPoint.x-this.startPoint.x)*t,i=this.startPoint.y+(e.endPoint.x-this.startPoint.x)*t,n=e.startPoint.y-r,o=e.endPoint.y-i;return 0===n&&0===o?(this.startPoint.y-r)/(this.endPoint.y-r)<=0||(this.startPoint.y-i)/(this.endPoint.y-i)<=0:0===n||0===o||n/o<0},e}();t.Segment=s},6353:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Size=void 0;var r=function(){function e(e,t){this.width=e,this.height=t}return e.empty=function(){return new e(0,0)},e.fromNumber=function(t){return new e(t,t)},e.initByCommonAction=function(t){var r=function(e){return e.width},i=function(e){return e.height};return new e(t(r,i),t(i,r))},e.prototype.isEmpty=function(){return 0===this.width&&0===this.height},e.prototype.toString=function(){return JSON.stringify(this)},e.prototype.nonNegativeSize=function(){return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this},e.prototype.offset=function(e,t){return this.width=this.width+e,this.height=this.height+t,this},e.prototype.multiply=function(e,t){return this.width*=e,this.height*=t,this},e.prototype.equals=function(e){return this.width===e.width&&this.height===e.height},e.prototype.clone=function(){return new e(this.width,this.height)},e.prototype.copyFrom=function(e){this.width=e.width,this.height=e.height},e.prototype.applyConverter=function(e){return this.width=e(this.width),this.height=e(this.height),this},e.equals=function(e,t){return e.width===t.width&&e.height===t.height},e}();t.Size=r},9716:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Vector=void 0;var r=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return Object.defineProperty(e.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!1,configurable:!0}),e.fromPoints=function(t,r){return new e(r.x-t.x,r.y-t.y)},e.fromSegment=function(t){return new e(t.endPoint.x-t.startPoint.x,t.endPoint.y-t.startPoint.y)},e.prototype.normalize=function(){var e=this.length;return 0!==e&&(this.x/=e,this.y/=e),this},e.prototype.negative=function(){return this.x*=-1,this.y*=-1,this},Object.defineProperty(e,"axisX",{get:function(){return new e(1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"axisY",{get:function(){return new e(0,1)},enumerable:!1,configurable:!0}),e.angleBetween=function(t,r){var i=e.scalarProduct(t,r)/(t.length*r.length);return Math.acos(i)},e.scalarProduct=function(e,t){return e.x*t.x+e.y*t.y},e}();t.Vector=r},1104:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IntervalAlgorithms=void 0;var i=r(2940),n=r(2400),o=r(8860),a=r(6102),s=function(){function e(){}return e.oneConstainsOtherArraysOfInterval=function(e,t){for(var r=i.ListUtils.deepCopy(t),n=r.pop();n;){if(!i.ListUtils.unsafeAnyOf(e,(function(e){return e.containsInterval(n)})))return!1;n=r.pop()}return!0},e.getIntersection=function(t,r){return e.getIntersectionTemplate(t,r,t)},e.getIntersectionTemplate=function(e,t,r){var i=Math.max(e.start,t.start),n=Math.min(e.end,t.end);return i>n?null:r.makeByStartEnd(i,n)},e.getIntersectionNonNullLength=function(t,r){return e.getIntersectionNonNullLengthTemplate(t,r,t)},e.getIntersectionNonNullLengthTemplate=function(t,r,i){var n=e.getIntersectionTemplate(t,r,i);return n&&n.length?n:null},e.getIntersectionsTwoArraysOfInterval=function(t,r){return e.getIntersectionsTwoArraysOfIntervalTemplate(t,r,t[0])},e.getIntersectionsTwoArraysOfIntervalTemplate=function(t,r,i){for(var n=[],o=t.length,a=r.length,s=0,l=0,d=t[s],c=r[l],h=null;s<o&&l<a;){var u=e.getIntersectionTemplate(d,c,i);u&&(h&&h.end===u.start?h.length+=u.length:(h=u,n.push(h))),d.end<c.end?d=t[++s]:c=r[++l]}return n},e.getAffectedObjects=function(t,r,i,o){return void 0===i&&(i=function(e){return n.SearchUtils.normedInterpolationIndexOf(t,(function(e){return e.interval.start}),e)}),void 0===o&&(o=function(e,t,r){return e.start===r&&0===t}),e.getAffectedObjectsTemplate(t,r,r[0],i,o)},e.getAffectedObjectsTemplate=function(t,r,i,o,s){void 0===o&&(o=function(e){return n.SearchUtils.normedInterpolationIndexOf(t,(function(e){return e.interval.start}),e)}),void 0===s&&(s=function(e,t,r){return e.start===r&&0===t});for(var l=new a.SparseIntervalsCollector(i),d=0,c=r;d<c.length;d++)for(var h=c[d],u=Math.max(0,o(h.start,t)),p=void 0;p=t[u];u++){var g=p.interval;if(g.start>h.end)break;var m=e.getIntersectionTemplate(g,h,i);m&&(m.length||s(g,h.length,m.start))&&l.add(u)}return l.getIntervals()},e.handleAffectedObjects=function(t,r,i,a){void 0===a&&(a=function(e){return n.SearchUtils.normedInterpolationIndexOf(t,(function(e){return e.interval.start}),e)});for(var s=new o.FixedInterval(0,0),l=0,d=r;l<d.length;l++)for(var c=d[l],h=Math.max(0,a(c.start,t)),u=void 0;u=t[h];h++){var p=u.interval;if(p.start>c.end)break;var g=e.getIntersectionTemplate(p,c,s);g&&i(u,h,c,g)}},e.getMergedIntervals=function(t,r){return e.getMergedIntervalsTemplate(t,r,t[0])},e.getMergedIntervalsTemplate=function(e,t,r){if(e.length<2)return e.length>0?[r.makeByStartLength(e[0].start,e[0].length)]:[];for(var i=t?[].concat(e).sort((function(e,t){return e.start-t.start})):e,n=[],o=0,a=void 0;a=i[o];){var s=a.start,l=a.end;for(++o;void 0!==(a=i[o])&&a.start<=l;o++)a.end>l&&(l=a.end);n.push(r.makeByStartEnd(s,l))}return n},e.reflectIntervals=function(t,r){return e.reflectIntervalsTemplate(t,r,r)},e.reflectIntervalsTemplate=function(t,r,n){if(!t.length)return[n.makeByStartLength(r.start,r.length)];var o=i.ListUtils.last(t).end,a=i.ListUtils.reducedMap(t,(function(i,o){return e.getIntersectionNonNullLengthTemplate(n.makeByStartEnd(t[o-1].end,i.start),r,n)}),1);return r.start<t[0].start&&a.unshift(n.makeByStartEnd(r.start,t[0].start)),r.end>o&&a.push(n.makeByStartEnd(o,r.end)),a},e.reflectionOfPointOnInterval=function(e,t,r){return(e-t.start)/t.length*r.length+r.start},e}();t.IntervalAlgorithms=s},7093:function(e,t,r){t.e=void 0;var i=r(2020),n=function(e){function t(t,r){var i=e.call(this)||this;return i.start=t,i.end=r,i}return i.__extends(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this.end-this.start},set:function(e){this.end=this.start+e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return(this.start+this.end)/2},enumerable:!1,configurable:!0}),t.normalized=function(e,r){return e>r?new t(r,e):new t(e,r)},t.prototype.copyFrom=function(e){this.start=e.start,this.end=e.end},t.prototype.equals=function(e){return e&&this.start===e.start&&this.end===e.end},t.prototype.clone=function(){return new t(this.start,this.length)},t.prototype.makeByStartEnd=function(e,r){return new t(e,r)},t.prototype.makeByStartLength=function(e,r){return new t(e,e+r)},t.prototype.makeByLengthEnd=function(e,r){return new t(r-e,r)},t.makeByConstInterval=function(e){return new t(e.start,e.end)},t.prototype.expand=function(e){return this.start=Math.min(e.start,this.start),this.end=Math.max(e.end,this.end),this},t}(r(8678).MutableInterval);t.e=n},7814:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConstInterval=void 0;var r=function(){function e(){}return Object.defineProperty(e.prototype,"center",{get:function(){return this.start+this.length/2},enumerable:!1,configurable:!0}),e.prototype.isNormalized=function(){return this.end>=this.start},e.prototype.isCollapsed=function(){return 0===this.length},e.prototype.equals=function(e){return this.start===e.start&&this.end===e.end},e.isCollapsed=function(e){return!e[1]&&e[0].isCollapsed()},e.prototype.containsInterval=function(e){return this.start<=e.start&&this.end>=e.end},e.prototype.containsIntervalWithoutEnd=function(e){return this.start<=e.start&&this.end>e.end},e.prototype.contains=function(e){return this.start<=e&&e<this.end},e.prototype.containsWithIntervalEnd=function(e){return this.start<=e&&e<=this.end},e.prototype.containsWithoutIntervalEndAndStart=function(e){return this.start<e&&e<this.end},e}();t.ConstInterval=r},8860:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.FixedInterval=void 0;var i=r(2020),n=function(e){function t(t,r){var i=e.call(this)||this;return i.start=t,i.length=r,i}return i.__extends(t,e),Object.defineProperty(t.prototype,"end",{get:function(){return this.start+this.length},set:function(e){this.length=e-this.start},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return this.start+this.length/2},enumerable:!1,configurable:!0}),t.prototype.copyFrom=function(e){this.start=e.start,this.length=e.length},t.prototype.equals=function(e){return e&&this.start===e.start&&this.length===e.length},t.prototype.clone=function(){return new t(this.start,this.length)},t.prototype.makeByStartEnd=function(e,r){return new t(e,r-e)},t.prototype.makeByStartLength=function(e,r){return new t(e,r)},t.prototype.makeByLengthEnd=function(e,r){return new t(r-e,e)},t.fromPositions=function(e,r){return new t(e,r-e)},t.makeByConstInterval=function(e){return new t(e.start,e.length)},t.prototype.expand=function(e){var t=Math.max(e.end,this.end);return this.start=Math.min(e.start,this.start),this.end=t,this},t}(r(8678).MutableInterval);t.FixedInterval=n},8678:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.MutableInterval=void 0;var i=r(2020),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.normalizeLength=function(){return this.length<0&&(this.length=0),this},t}(r(7814).ConstInterval);t.MutableInterval=n},6102:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SparseIntervalsCollector=void 0;var i=r(448),n=function(){function e(e){this.intervals=[],this.template=e}return e.prototype.add=function(e){this.curr&&this.curr.end===e?this.curr.length++:(this.curr=this.template.makeByStartLength(e,1),this.intervals.push(this.curr))},e.prototype.getIntervals=function(){return new i.SparseIntervals(this.intervals)},e}();t.SparseIntervalsCollector=n},448:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SparseIntervals=void 0;var i=r(8094),n=r(510),o=function(){function e(e){void 0===e&&(e=[]),this.list=e,this._count=0,this._numIntervals=0;for(var t=0,r=e;t<r.length;t++){var i=r[t];this._count+=i.length,this._numIntervals++}}return Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numIntervals",{get:function(){return this._numIntervals},enumerable:!1,configurable:!0}),e.prototype.getInterval=function(e){return this.list[e]},e.prototype.getNativeIterator=function(){return new i.SparseIntervalsIterator(this)},e.prototype.getObjectsIterator=function(e){return new n.SparseObjectsIterator(this,e)},e}();t.SparseIntervals=o},8094:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SparseIntervalsIterator=void 0;var r=function(){function e(e){this.sparseIntervals=e,this.intervalIndex=-1}return Object.defineProperty(e.prototype,"isStarted",{get:function(){return!!this.curr},enumerable:!1,configurable:!0}),e.prototype.moveNext=function(){return this.curr&&this.posInInterval+1<this.curr.length?(this.posInInterval++,this.index++,this.initObject(),!0):this.intervalIndex+1<this.sparseIntervals.numIntervals&&(this.intervalIndex++,this.curr=this.sparseIntervals.getInterval(this.intervalIndex),this.curr.length?(this.posInInterval=0,this.index=this.curr.start,this.initObject(),!0):this.moveNext())},e.prototype.movePrev=function(){return this.curr&&this.posInInterval-1>=this.curr.start?(this.posInInterval--,this.index--,this.initObject(),!0):(this.isStarted||(this.intervalIndex=this.sparseIntervals.numIntervals),this.intervalIndex-1>=0&&(this.intervalIndex--,this.curr=this.sparseIntervals.getInterval(this.intervalIndex),this.posInInterval=Math.max(this.curr.length-1,this.curr.start),this.index=this.curr.start,this.initObject(),!0))},e.prototype.initObject=function(){},e}();t.SparseIntervalsIterator=r},1215:function(e,t,r){t.g=void 0;var i=r(3578),n=function(){function e(e,t){this.intervals=[],this.valMap={},this.cmp=e,this.template=t}return e.prototype.add=function(e,t){this.curr&&this.curr.end===e&&0===this.cmp(this.currVal,t)?this.curr.length++:(this.curr=this.template.makeByStartLength(e,1),this.intervals.push(this.curr),this.currVal=t,this.valMap[e]=t)},e.prototype.getIterator=function(){return new i.SparseIntervalsMapIterator(this.intervals,this.valMap)},e}();t.g=n},3578:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SparseIntervalsMapIterator=void 0;var i=r(448),n=function(){function e(e,t){this.sparseIntervals=new i.SparseIntervals(e),this.valMap=t,this.intervalIndex=-1}return Object.defineProperty(e.prototype,"numIntervals",{get:function(){return this.sparseIntervals.numIntervals},enumerable:!1,configurable:!0}),e.prototype.moveToNextPosition=function(){return this.interval&&this.posInInterval+1<this.interval.length?(this.posInInterval++,this.position++,!0):this.moveToNextInterval()},e.prototype.moveToNextInterval=function(){return this.intervalIndex+1<this.sparseIntervals.numIntervals&&(this.intervalIndex++,this.interval=this.sparseIntervals.getInterval(this.intervalIndex),this.posInInterval=0,this.position=this.interval.start,this.object=this.valMap[this.position],!0)},e}();t.SparseIntervalsMapIterator=n},510:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SparseObjectsIterator=void 0;var i=r(2020),n=function(e){function t(t,r){var i=e.call(this,t)||this;return i.objects=r,i}return i.__extends(t,e),t.prototype.initObject=function(){this.obj=this.objects[this.index]},t}(r(8094).SparseIntervalsIterator);t.SparseObjectsIterator=n},1695:function(e,t,r){t.E=void 0;var i=r(9279),n=r(6907),o=r(5438),a=function(){function e(e,t){this.helperFrame=null,this.helperFrameName=null,this.container=e,this.frameClassName=t}return e.prototype.dispose=function(){this.removeHelperFrame()},e.prototype.showPrintDialog=function(e){if(i.Browser.Edge||o.PdfPluginHelper.isInstalled())this.getHelperFrame().document.location=e;else{var t=window.open(e,"print","height="+window.innerHeight+",width="+window.innerWidth+",tabbar=no");t&&(t.focus(),setTimeout((function(){t.print()}),100))}},e.prototype.getHelperFrame=function(){return i.Browser.Firefox&&this.removeHelperFrame(),this.helperFrame||this.createHelperFrame(),this.helperFrame},e.prototype.removeHelperFrame=function(){if(this.helperFrame){n.DomUtils.hideNode(this.helperFrame);try{delete window.frames[this.helperFrameName]}catch(e){}this.helperFrame=null,this.helperFrameName=null}},e.prototype.createHelperFrame=function(){var e=document.createElement("iframe"),t=i.Browser.Safari?"1px":"0px";e.style.width=t,e.style.height=t,e.name=this.getNewName(),e.className=this.frameClassName,(i.Browser.Chrome&&i.Browser.Version>=77||i.Browser.Edge||i.Browser.Safari)&&e.addEventListener("load",(function(){var t,r,n;"application/pdf"===(null===(t=e.contentDocument)||void 0===t?void 0:t.contentType)&&(i.Browser.Edge?null===(r=e.contentWindow)||void 0===r||r.document.execCommand("print",!1,void 0):i.Browser.Safari?setTimeout((function(){var t;null===(t=e.contentWindow)||void 0===t||t.print()}),1e3):null===(n=e.contentWindow)||void 0===n||n.print())})),this.container.appendChild(e),this.helperFrame=window.frames[e.name],this.helperFrameName=e.name},e.prototype.getNewName=function(){for(var e=0;;e++){var t="dxreHelperFrame"+e;if(!window.frames[t])return t}},e}();t.E=a},5438:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PdfPluginHelper=void 0;var i=r(9279),n=function(){function e(){}return e.isInstalled=function(){return!!e.getPdfPlugin()},e.getPdfPlugin=function(){return e.plugin||(e.plugin=i.Browser.IE?e.getActiveXObject("AcroPDF.PDF")||e.getActiveXObject("PDF.PdfCtrl"):e.getNavigatorPlugin("Adobe Acrobat")||e.getNavigatorPlugin("Chrome PDF Viewer")||e.getNavigatorPlugin("WebKit built-in PDF")||e.getNavigatorPlugin("Chromium PDF Viewer")),e.plugin},e.getActiveXObject=function(e){try{return new ActiveXObject(e)}catch(e){return null}},e.getNavigatorPlugin=function(e){var t=navigator.plugins;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=t[r];if(i.name===e)return i}return null},e.getVersion=function(){try{var t=e.getPdfPlugin();if(i.Browser.IE){var r=t.GetVersions().split(",")[0].split("=");return parseFloat(r[1])}return t.version?parseInt(t.version):t.name}catch(e){return null}},e}();t.PdfPluginHelper=n},2217:function(e,t,r){t.F=void 0;var i=r(9279),n=function(){function e(){}return e.setElementAttribute=function(e,t,r){e.setAttribute&&(i.Browser.IE&&i.Browser.MajorVersion>=11&&"src"===t.toLowerCase()&&e.setAttribute(t,""),e.setAttribute(t,r))},e.setStyleAttribute=function(e,t,r){e.setProperty&&e.setProperty(t,r,"")},e.getElementAttribute=function(e,t){return e.getAttribute(t)},e.getStyleAttribute=function(e,t){if(e.getPropertyValue){if(i.Browser.Firefox)try{return e.getPropertyValue(t)}catch(r){return e[t]}return e.getPropertyValue(t)}return null},e.removeElementAttribute=function(e,t){e.removeAttribute&&e.removeAttribute(t)},e.removeStyleAttribute=function(e,t){e.removeProperty&&e.removeProperty(t)},e.changeElementStyleAttribute=function(t,r,i){e.saveStyleAttributeInElement(t,r),e.setStyleAttribute(t.style,r,i)},e.restoreElementStyleAttribute=function(t,r){var i="dxwu_saved"+r,n=t.style;if(e.isExistsAttributeInElement(t,i)){var o=e.getElementAttribute(t,i);return o===e.emptyObject||null===o?e.removeStyleAttribute(n,r):e.setStyleAttribute(n,r,o),e.removeElementAttribute(t,i),!0}return!1},e.saveStyleAttributeInElement=function(t,r){var i="dxwu_saved"+r,n=t.style;if(!e.isExistsAttributeInElement(t,i)){var o=e.getStyleAttribute(n,r);e.setElementAttribute(t,i,e.isAttributeExists(o)?o:e.emptyObject)}},e.isExistsAttributeInElement=function(t,r){var i=e.getElementAttribute(t,r);return e.isAttributeExists(i)},e.isAttributeExists=function(e){return null!==e&&""!==e},e.emptyObject="DxEmptyValue",e}();t.F=n},6477:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Base64Utils=void 0;var i=r(2674),n=r(4633),o=function(){function e(){}return e.normalizeToDataUrl=function(t,r){return e.checkPrependDataUrl(t)||(t=e.prependByDataUrl(t,r)),t},e.prependByDataUrl=function(e,t){return"data:"+t+";base64,"+e},e.checkPrependDataUrl=function(t){return e.dataUrl.test(t)},e.deleteDataUrlPrefix=function(t){return t.replace(e.dataUrl,"")},e.getUint8Array=function(e){for(var t=(e=atob(e)).length,r=new Uint8Array(t);t--;)r[t]=e.charCodeAt(t);return r},e.fromArrayBuffer=function(e){for(var t=[],r=new Uint8Array(e),i=r.byteLength,n=0;n<i;n++)t.push(String.fromCharCode(r[n]));return window.btoa(t.join(""))},e.getFileFromBase64=function(t,r,n){void 0===r&&(r="");var o=e.getUint8Array(t);return i.FileUtils.createFile([o],r,n)},e.getMimeTypeAsString=function(t){var r=t.match(e.dataUrl);return r?r[1]:null},e.getKnownMimeType=function(t){var r=t.match(e.dataUrl);return r?n.MimeTypeUtils.stringTypeToType(r[1]):n.DxMimeType.Unknown},e.fromBlobAsArrayBuffer=function(t,r){var i=new FileReader;i.onloadend=function(){return r(e.fromArrayBuffer(i.result))},i.readAsArrayBuffer(t)},e.fromBlobAsDataUrl=function(e,t){var r=new FileReader;r.onloadend=function(){return t(r.result)},r.readAsDataURL(e)},e.dataUrl=/^data:(.*?)(;(.*?))??(;base64)?,/,e}();t.Base64Utils=o},13:function(e,t,r){t.i=void 0;var i=r(49),n=function(){function e(){}return e.getAlpha=function(e){return e>>24&255},e.getRed=function(e){return e>>16&255},e.getGreen=function(e){return e>>8&255},e.getBlue=function(e){return 255&e},e.redPartToString=function(t){var r=e.getRed(t).toString(16);return r.length>1?r:"0"+r},e.greenPartToString=function(t){var r=e.getGreen(t).toString(16);return r.length>1?r:"0"+r},e.bluePartToString=function(t){var r=e.getBlue(t).toString(16);return r.length>1?r:"0"+r},e.fromArgbNumber=function(e,t,r,i){return e<<24|t<<16|r<<8|i},e.fromRgbaString=function(e,t){void 0===t&&(t=255);var r=e.replace(/ +/g,"").match(/(rgba?)|(\d+(\.\d+)?%?)|(\.\d+)/g);if(r&&r.length>3){for(var i=[],n=1,o=void 0;o=r[n];n++){var a=-1!==o.indexOf("%")?Math.round(2.55*parseFloat(o)):parseInt(o);if(a<0||a>255)return null;i.push(a)}if(0===e.indexOf("rgba")){if(isNaN(i[3])||i[3]<0||i[3]>1)return null;i[3]<=1&&(i[3]=Math.round(255*i[3]))}else if(i[3])return null;return(255&i[0])<<16|(255&i[1])<<8|255&i[2]|(255&(i.length>3?i[3]:t))<<24}return null},e.fromHashString=function(t,r){return void 0===r&&(r=255),e.isHashColorString(t)?("#"===t.charAt(0)&&(t=t.substr(1)),3===t.length&&(t=i.StringUtils.repeat(t.charAt(0),2)+i.StringUtils.repeat(t.charAt(1),2)+i.StringUtils.repeat(t.charAt(2),2)),parseInt(t,16)|r<<24):null},e.fromColorName=function(t,r){void 0===r&&(r=255);var i=e.colorNames[t.toLowerCase()];return i?e.fromHashString(i,r):null},e.fromString=function(t,r){void 0===r&&(r=255);var i=e.fromRgbaString(t,r);if(null!==i)return i;var n=e.fromHashString(t,r);return null!==n?n:e.fromColorName(t,r)},e.colorToHash=function(t){return"#"+e.redPartToString(t)+e.greenPartToString(t)+e.bluePartToString(t)},e.stringToHash=function(e){var t=this.fromString(e);return null!==t?this.colorToHash(t):null},e.isHashColorString=function(e){return/^#?([0-9a-f]{6})$/i.test(e)||/^#?([0-9a-f]{3})$/i.test(e)},e.isKnownColorName=function(t){return!!e.colorNames[t.toLowerCase()]},e.isGray=function(t){var r=e.getRed(t);return r===e.getGreen(t)&&r===e.getBlue(t)},e.DARK_COLOR=-16777216,e.LIGHT_COLOR=-1,e.colorNames={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#00ff00",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",windowtext:"#000000"},e}();t.i=n},2491:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.numberToStringHex=t.numberToStringBin=t.isOdd=t.isEven=t.isNonNullString=t.isString=t.isNumber=t.boolToString=t.boolToInt=t.isDefined=void 0;var i=r(49);t.isDefined=function(e){return null!=e},t.boolToInt=function(e){return e?1:0},t.boolToString=function(e){return e?"1":"0"},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isNonNullString=function(e){return!!e},t.isEven=function(e){return e%2!=0},t.isOdd=function(e){return e%2==0},t.numberToStringBin=function(e,t){return void 0===t&&(t=0),i.StringUtils.padLeft(e.toString(2),t,"0")},t.numberToStringHex=function(e,t){return void 0===t&&(t=0),i.StringUtils.padLeft(e.toString(16),t,"0")}},4170:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Equals=t.Comparers=void 0;var r=function(){function e(){}return e.number=function(e,t){return e-t},e.string=function(e,t){return e===t?0:e>t?1:-1},e.stringIgnoreCase=function(e,t){return(e=e.toLowerCase())===(t=t.toLowerCase())?0:e>t?1:-1},e}();t.Comparers=r;var i=function(){function e(){}return e.simpleType=function(e,t){return e===t},e.object=function(e,t){return e&&t&&(e===t||e.equals(t))},e}();t.Equals=i},8475:function(e,t,r){t.F=void 0;var i=r(9279),n=function(){function e(){}return e.isBrowserSupportExtendedClientBuffer=function(){return i.Browser.WebKitFamily||i.Browser.Firefox&&i.Browser.MajorVersion>=50||i.Browser.Edge&&i.Browser.MajorVersion>=14},e.getPlainTextItem=function(t){return e.getTransferItemByType(t,"text/plain")},e.getRtfTextItem=function(t){return e.getTransferItemByType(t,"text/rtf")},e.getImageItem=function(e){for(var t=e.length;t--;)if(e[t].type.indexOf("image")>=0)return e[t].getAsFile();return null},e.getTransferItemByType=function(e,t){if(this.isBrowserSupportExtendedClientBuffer())for(var r=e.length;r--;){var i=e[r];if(i.type.indexOf(t)>=0)return i}return null},e}();t.F=n},6907:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DomUtils=void 0;var i=r(9279),n=r(2491),o=r(8679),a=r(49),s=function(){function e(){}return e.clearInnerHtml=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},e.setStylePosition=function(e,t){e.left=o.MathUtils.round(t.x,3)+"px",e.top=o.MathUtils.round(t.y,3)+"px"},e.setStyleSize=function(e,t){e.width=o.MathUtils.round(t.width,3)+"px",e.height=o.MathUtils.round(t.height,3)+"px"},e.setStyleSizeAndPosition=function(t,r){e.setStylePosition(t,r),e.setStyleSize(t,r)},e.hideNode=function(e){if(e){var t=e.parentNode;t&&t.removeChild(e)}},e.isHTMLElementNode=function(e){return e.nodeType===Node.ELEMENT_NODE},e.isTextNode=function(e){return e.nodeType===Node.TEXT_NODE},e.isElementNode=function(e){return e.nodeType===Node.ELEMENT_NODE},e.isHTMLTableRowElement=function(e){return"TR"===e.tagName},e.isItParent=function(e,t){if(!e||!t)return!1;for(;t;){if(t===e)return!0;if("BODY"===t.tagName)return!1;t=t.parentNode}return!1},e.getParentByTagName=function(e,t){for(t=t.toUpperCase();e;){if("BODY"===e.tagName)return null;if(e.tagName===t)return e;e=e.parentNode}return null},e.getDocumentScrollTop=function(){var t=i.Browser.IE&&"hidden"===e.getCurrentStyle(document.body).overflow&&document.body.scrollTop>0;return i.Browser.WebKitFamily||i.Browser.Edge||t?i.Browser.MacOSMobilePlatform?window.pageYOffset:i.Browser.WebKitFamily&&document.documentElement.scrollTop||document.body.scrollTop:document.documentElement.scrollTop},e.getDocumentScrollLeft=function(){var t=i.Browser.IE&&"hidden"===e.getCurrentStyle(document.body).overflow&&document.body.scrollLeft>0;return i.Browser.Edge||t?document.body?document.body.scrollLeft:document.documentElement.scrollLeft:i.Browser.WebKitFamily?document.documentElement.scrollLeft||document.body.scrollLeft:document.documentElement.scrollLeft},e.getCurrentStyle=function(e){if(e.currentStyle)return e.currentStyle;if(document.defaultView&&document.defaultView.getComputedStyle){var t=document.defaultView.getComputedStyle(e,null);if(!t&&i.Browser.Firefox&&window.frameElement){for(var r=[],o=window.frameElement;!(t=document.defaultView.getComputedStyle(e,null));)r.push([o,o.style.display]),o.style.setProperty("display","block","important"),o="BODY"===o.tagName?o.ownerDocument.defaultView.frameElement:o.parentNode;t=function(e){if("object"!=typeof e||!n.isDefined(e))return e;var t={};for(var r in e)t[r]=e[r];return t}(t);for(var a=void 0,s=0;a=r[s];s++)a[0].style.display=a[1];document.body.offsetWidth}return t}return window.getComputedStyle(e,null)},e.setFocus=function(e){function t(){try{e.focus(),i.Browser.IE&&document.activeElement!==e&&e.focus()}catch(e){}}i.Browser.MacOSMobilePlatform?t():setTimeout((function(){t()}),100)},e.hasClassName=function(e,t){try{var r=t.split(" "),i=e.classList;if(i){for(var n=r.length-1;n>=0;n--)if(!i.contains(r[n]))return!1}else{var o=e.getAttribute&&e.getAttribute("class");if(!o)return!1;var a=o.split(" ");for(n=r.length-1;n>=0;n--)if(a.indexOf(r[n])<0)return!1}return!0}catch(e){return!1}},e.addClassName=function(t,r){if(!e.hasClassName(t,r)){var i=t.getAttribute&&t.getAttribute("class");t.setAttribute("class",""===i?r:i+" "+r)}},e.removeClassName=function(e,t){var r=" "+(e.getAttribute&&e.getAttribute("class"))+" ",i=r.replace(" "+t+" "," ");r.length!==i.length&&e.setAttribute("class",a.StringUtils.trim(i))},e.toggleClassName=function(t,r,i){void 0===i?e.hasClassName(t,r)?e.removeClassName(t,r):e.addClassName(t,r):i?e.addClassName(t,r):e.removeClassName(t,r)},e.pxToInt=function(e){return l(e,parseInt)},e.pxToFloat=function(e){return l(e,parseFloat)},e.getAbsolutePositionY=function(t){function r(t){return Math.round(t.getBoundingClientRect().top+e.getDocumentScrollTop())}return t?i.Browser.IE?function(t){return i.Browser.IE&&null===t.parentNode?0:t.getBoundingClientRect().top+e.getDocumentScrollTop()}(t):i.Browser.Firefox&&i.Browser.Version>=3?r(t):i.Browser.NetscapeFamily&&(!i.Browser.Firefox||i.Browser.Version<3)?function(t){for(var r=d(t,!1),n=!0;null!=t;){if(r+=t.offsetTop,n||null==t.offsetParent||(r-=t.scrollTop),!n&&i.Browser.Firefox){var o=e.getCurrentStyle(t);"DIV"===t.tagName&&"visible"!==o.overflow&&(r+=e.pxToInt(o.borderTopWidth))}n=!1,t=t.offsetParent}return r}(t):i.Browser.WebKitFamily||i.Browser.Edge?r(t):function(e){for(var t=0,r=!0;null!=e;)t+=e.offsetTop,r||null==e.offsetParent||(t-=e.scrollTop),r=!1,e=e.offsetParent;return t}(t):0},e.getAbsolutePositionX=function(t){function r(t){return Math.round(t.getBoundingClientRect().left+e.getDocumentScrollLeft())}return t?i.Browser.IE?function(t){return i.Browser.IE&&null===t.parentNode?0:t.getBoundingClientRect().left+e.getDocumentScrollLeft()}(t):i.Browser.Firefox&&i.Browser.Version>=3?r(t):i.Browser.Opera&&i.Browser.Version<=12?function(e){for(var t=!0,r=d(e,!0);null!=e;)r+=e.offsetLeft,t||(r-=e.scrollLeft),e=e.offsetParent,t=!1;return r+=document.body.scrollLeft}(t):i.Browser.NetscapeFamily&&(!i.Browser.Firefox||i.Browser.Version<3)?function(t){for(var r=d(t,!0),n=!0;null!=t;){if(r+=t.offsetLeft,n||null==t.offsetParent||(r-=t.scrollLeft),!n&&i.Browser.Firefox){var o=e.getCurrentStyle(t);"DIV"===t.tagName&&"visible"!==o.overflow&&(r+=e.pxToInt(o.borderLeftWidth))}n=!1,t=t.offsetParent}return r}(t):i.Browser.WebKitFamily||i.Browser.Edge?r(t):function(e){for(var t=0,r=!0;null!=e;)t+=e.offsetLeft,r||null==e.offsetParent||(t-=e.scrollLeft),r=!1,e=e.offsetParent;return t}(t):0},e.isInteractiveControl=function(e){return["A","INPUT","SELECT","OPTION","TEXTAREA","BUTTON","IFRAME"].indexOf(e.tagName)>-1},e.getClearClientHeight=function(t){return t.offsetHeight-(e.getTopBottomPaddings(t)+e.getVerticalBordersWidth(t))},e.getTopBottomPaddings=function(t,r){var i=r||e.getCurrentStyle(t);return e.pxToInt(i.paddingTop)+e.pxToInt(i.paddingBottom)},e.getVerticalBordersWidth=function(t,r){n.isDefined(r)||(r=i.Browser.IE&&9!==i.Browser.MajorVersion&&window.getComputedStyle?window.getComputedStyle(t):e.getCurrentStyle(t));var o=0;return"none"!==r.borderTopStyle&&(o+=e.pxToFloat(r.borderTopWidth)),"none"!==r.borderBottomStyle&&(o+=e.pxToFloat(r.borderBottomWidth)),o},e.getNodes=function(e,t){for(var r=e.all||e.getElementsByTagName("*"),i=[],n=0;n<r.length;n++){var o=r[n];t(o)&&i.push(o)}return i},e.getChildNodes=function(e,t){for(var r=e.childNodes,i=[],n=0;n<r.length;n++){var o=r[n];t(o)&&i.push(o)}return i},e.getNodesByClassName=function(t,r){if(t.querySelectorAll){var i=t.querySelectorAll("."+r),n=[];return i.forEach((function(e){return n.push(e)})),n}return e.getNodes(t,(function(t){return e.hasClassName(t,r)}))},e.getChildNodesByClassName=function(t,r){return t.querySelectorAll?function(e,t){for(var r=[],i=0;i<e.length;i++){var n=e[i];t(n)&&r.push(n)}return r}(t.querySelectorAll("."+r),(function(e){return e.parentNode===t})):e.getChildNodes(t,(function(t){return!!e.isElementNode(t)&&(n.isNonNullString(t.className)&&e.hasClassName(t,t.className))}))},e.getVerticalScrollBarWidth=function(){if(void 0===e.verticalScrollBarWidth){var t=document.createElement("DIV");t.style.cssText="position: absolute; top: 0px; left: 0px; visibility: hidden; width: 200px; height: 150px; overflow: hidden; box-sizing: content-box",document.body.appendChild(t);var r=document.createElement("P");t.appendChild(r),r.style.cssText="width: 100%; height: 200px;";var i=r.offsetWidth;t.style.overflow="scroll";var n=r.offsetWidth;i===n&&(n=t.clientWidth),e.verticalScrollBarWidth=i-n,document.body.removeChild(t)}return e.verticalScrollBarWidth},e.getHorizontalBordersWidth=function(t,r){n.isDefined(r)||(r=i.Browser.IE&&window.getComputedStyle?window.getComputedStyle(t):e.getCurrentStyle(t));var o=0;return"none"!==r.borderLeftStyle&&(o+=e.pxToFloat(r.borderLeftWidth)),"none"!==r.borderRightStyle&&(o+=e.pxToFloat(r.borderRightWidth)),o},e.getFontFamiliesFromCssString=function(e){return e.split(",").map((function(e){return a.StringUtils.trim(e.replace(/'|"/gi,""))}))},e.getInnerText=function(t){if(i.Browser.Safari&&i.Browser.MajorVersion<=5){null===e.html2PlainTextFilter&&(e.html2PlainTextFilter=document.createElement("DIV"),e.html2PlainTextFilter.style.width="0",e.html2PlainTextFilter.style.height="0",e.html2PlainTextFilter.style.overflow="visible",e.html2PlainTextFilter.style.display="none",document.body.appendChild(e.html2PlainTextFilter));var r=e.html2PlainTextFilter;r.innerHTML=t.innerHTML,r.style.display="";var n=r.innerText;return r.style.display="none",n}return i.Browser.NetscapeFamily||i.Browser.WebKitFamily||i.Browser.IE&&i.Browser.Version>=9||i.Browser.Edge?t.textContent:t.innerText},e.html2PlainTextFilter=null,e.verticalScrollBarWidth=void 0,e}();function l(e,t){var r=0;if(n.isDefined(e)&&""!==e)try{var i=e.indexOf("px");i>-1&&(r=t(e.substr(0,i)))}catch(e){}return r}function d(e,t){for(var r=0,i=!0;null!=e&&"BODY"!==e.tagName;){var n=s.getCurrentStyle(e);if("absolute"===n.position)break;i||"DIV"!==e.tagName||""!==n.position&&"static"!==n.position||(r-=t?e.scrollLeft:e.scrollTop),e=e.parentNode,i=!1}return r}t.DomUtils=s},9712:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EncodeUtils=void 0;var r=function(){function e(){}return e.encodeHtml=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},e.decodeHtml=function(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},e.prepareTextForRequest=function(e){return e.replace(/%/g,"%25").replace(/&/g,"%26amp;").replace(/\+/g,"%2B").replace(/</g,"%26lt;").replace(/>/g,"%26gt;").replace(/"/g,"%26quot;")},e.prepareTextForCallBackRequest=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e.decodeViaTextArea=function(e){var t=document.createElement("TEXTAREA");return t.innerHTML=e,t.value},e}();t.EncodeUtils=r},310:function(e,t){t.Y=void 0;var r=function(){function e(){}return e.forEach=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=parseInt(r);isNaN(i)||t(i)}},e.isAnyOf=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var i=0,n=t;i<n.length;i++){if(e===n[i])return!0}return!1},e}();t.Y=r},3714:function(e,t,r){t.g=void 0;var i=r(9279),n=r(2491),o=r(6907),a=r(1632),s=function(){function e(){}return e.preventEvent=function(e){e.cancelable&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},e.getEventSource=function(t){return n.isDefined(t)?e.getEventSourceCore(t):null},e.getEventSourceByPosition=function(t){if(!n.isDefined(t))return null;if(!document.elementFromPoint)return e.getEventSourceCore(t);var r=e.getEventX(t)-(e.clientEventRequiresDocScrollCorrection()?o.DomUtils.getDocumentScrollLeft():0),i=e.getEventY(t)-(e.clientEventRequiresDocScrollCorrection()?o.DomUtils.getDocumentScrollTop():0);return void 0===r||void 0===i?e.getEventSourceCore(t):document.elementFromPoint(r,i)},e.getEventSourceCore=function(e){return e.srcElement?e.srcElement:e.target},e.getMouseWheelEventName=function(){return i.Browser.Safari?"mousewheel":i.Browser.NetscapeFamily&&i.Browser.MajorVersion<17?"DOMMouseScroll":"wheel"},e.isLeftButtonPressed=function(t){return!!a.TouchUtils.isTouchEvent(t)||!!(t=i.Browser.IE&&n.isDefined(event)?event:t)&&(i.Browser.IE&&i.Browser.Version<11?!!i.Browser.MSTouchUI||t.button%2==1:i.Browser.WebKitFamily?"pointermove"===t.type||"pointerenter"===t.type||"pointerleave"===t.type?1===t.buttons:1===t.which:i.Browser.NetscapeFamily||i.Browser.Edge||i.Browser.IE&&i.Browser.Version>=11?e.isMoveEventName(t.type)?1===t.buttons:1===t.which:!i.Browser.Opera||0===t.button)},e.isMoveEventName=function(t){return t===a.TouchUtils.touchMouseMoveEventName||t===e.getMoveEventName()},e.getMoveEventName=function(){return window.PointerEvent?"pointermove":i.Browser.TouchUI?"touchmove":"mousemove"},e.preventEventAndBubble=function(t){e.preventEvent(t),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0},e.clientEventRequiresDocScrollCorrection=function(){var e=i.Browser.Safari&&i.Browser.Version<3,t=i.Browser.MacOSMobilePlatform&&i.Browser.Version<5.1;return i.Browser.AndroidDefaultBrowser||i.Browser.AndroidChromeBrowser||!(e||t)},e.getEventX=function(t){return a.TouchUtils.isTouchEvent(t)?a.TouchUtils.getEventX(t):t.clientX+(e.clientEventRequiresDocScrollCorrection()?o.DomUtils.getDocumentScrollLeft():0)},e.getEventY=function(t){return a.TouchUtils.isTouchEvent(t)?a.TouchUtils.getEventY(t):t.clientY+(e.clientEventRequiresDocScrollCorrection()?o.DomUtils.getDocumentScrollTop():0)},e.cancelBubble=function(e){e.cancelBubble=!0},e.getWheelDelta=function(e){var t;return t=i.Browser.NetscapeFamily&&i.Browser.MajorVersion<17?-e.detail:i.Browser.Safari?e.wheelDelta:-e.deltaY,i.Browser.Opera&&i.Browser.Version<9&&(t=-t),t},e}();t.g=s},2674:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.FileUtils=void 0;var i=r(9279),n=r(6477),o=r(2491),a=function(){function e(){}return e.loadJavascriptFile=function(e,t){var r,i=document.getElementsByTagName("head")[0];if(!i){i=document.createElement("head");var n=document.getElementsByTagName("body")[0];null===(r=n.parentNode)||void 0===r||r.insertBefore(i,n)}var o=document.createElement("script");return o.onload=t,o.src=e,i.appendChild(o),{htmlScriptElement:o}},e.startDownloadFileLocal=function(e,t){if(e instanceof ArrayBuffer&&(e=n.Base64Utils.fromArrayBuffer(e)),o.isString(e)&&(e=n.Base64Utils.getFileFromBase64(e)),window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,t);else{var r=document.createElement("a"),i=URL.createObjectURL(e);r.href=i,r.download=t,document.body.appendChild(r),r.click(),setTimeout((function(){document.body.removeChild(r),window.URL.revokeObjectURL(i)}),0)}},e.createFile=function(e,t,r){var n;if(i.Browser.IE||i.Browser.Edge&&i.Browser.MajorVersion<86){var o=new Blob(e,r);return o.lastModifiedDate=null!==(n=null==r?void 0:r.lastModified)&&void 0!==n?n:Date.now(),o.name=t,o}return new File(e,t,r)},e.isFile=function(e){return i.Browser.IE||i.Browser.Edge&&i.Browser.MajorVersion<86?e instanceof File||e instanceof Blob&&o.isDefined(e.name):e instanceof File},e}();t.FileUtils=a},4004:function(e,t){function r(e){document.fonts.add(e)}t.mx=t.mw=t.lX=void 0,t.lX=function(){return document.fonts&&document.fonts.ready&&document.fonts.ready.then},t.mw=function(e){document.fonts.ready.then(e)},t.mx=function(e,t,i,n){new window.FontFace(e,t,i).load().then((function(e){r(e),n(null)})).catch((function(e){return n(e)}))}},2153:function(e,t,r){t.VD=t.tx=t.LN=void 0;var i,n,o=r(9279),a=r(9712),s=r(49),l=function(){function e(){}return e.getKeyModifiers=function(e){var t=0;return e.altKey&&(t|=i.Alt),e.ctrlKey&&(t|=i.Ctrl),e.shiftKey&&(t|=i.Shift),e.metaKey&&(t|=i.Meta),t},e.getShortcutCode=function(e,t,r,n,o){var a=e;return a|=t?i.Ctrl:0,a|=r?i.Shift:0,a|=n?i.Alt:0,a|=o?i.Meta:0},e.getShortcutCodeByEvent=function(t){return e.getShortcutCode(e.getEventKeyCode(t),t.ctrlKey,t.shiftKey,t.altKey,!!o.Browser.MacOSPlatform&&t.metaKey)},e.getEventKeyCode=function(e){return o.Browser.NetscapeFamily||o.Browser.Opera?e.which:e.keyCode},e.parseShortcutString=function(t){if(!t)return 0;var r=!1,i=!1,o=!1,l=!1,d=null,c=t.toString().split("+");if(c.length>0)for(var h=0;h<c.length;h++){var u=s.StringUtils.trim(c[h].toUpperCase());switch(u){case"CONTROL":case"CONTROLKEY":case"CTRL":r=!0;break;case"SHIFT":case"SHIFTKEY":i=!0;break;case"ALT":o=!0;break;case"CMD":l=!0;break;case"F1":d=n.F1;break;case"F2":d=n.F2;break;case"F3":d=n.F3;break;case"F4":d=n.F4;break;case"F5":d=n.F5;break;case"F6":d=n.F6;break;case"F7":d=n.F7;break;case"F8":d=n.F8;break;case"F9":d=n.F9;break;case"F10":d=n.F10;break;case"F11":d=n.F11;break;case"F12":d=n.F12;break;case"RETURN":case"ENTER":d=n.Enter;break;case"HOME":d=n.Home;break;case"END":d=n.End;break;case"LEFT":d=n.Left;break;case"RIGHT":d=n.Right;break;case"UP":d=n.Up;break;case"DOWN":d=n.Down;break;case"PAGEUP":d=n.PageUp;break;case"PAGEDOWN":d=n.PageDown;break;case"SPACE":d=n.Space;break;case"TAB":d=n.Tab;break;case"BACKSPACE":case"BACK":d=n.Backspace;break;case"CONTEXT":d=n.ContextMenu;break;case"ESCAPE":case"ESC":d=n.Esc;break;case"DELETE":case"DEL":d=n.Delete;break;case"INSERT":case"INS":d=n.Insert;break;case"PLUS":d="+".charCodeAt(0);break;default:d=u.charCodeAt(0)}}else alert(a.EncodeUtils.decodeViaTextArea("Invalid shortcut"));return e.getShortcutCode(d,r,i,o,l)},e}();t.LN=l,function(e){e[e.None=0]="None",e[e.Ctrl=65536]="Ctrl",e[e.Shift=262144]="Shift",e[e.Alt=1048576]="Alt",e[e.Meta=16777216]="Meta"}(i=t.tx||(t.tx={})),function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Pause=19]="Pause",e[e.CapsLock=20]="CapsLock",e[e.Esc=27]="Esc",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Key_0=48]="Key_0",e[e.Key_1=49]="Key_1",e[e.Key_2=50]="Key_2",e[e.Key_3=51]="Key_3",e[e.Key_4=52]="Key_4",e[e.Key_5=53]="Key_5",e[e.Key_6=54]="Key_6",e[e.Key_7=55]="Key_7",e[e.Key_8=56]="Key_8",e[e.Key_9=57]="Key_9",e[e.Key_a=65]="Key_a",e[e.Key_b=66]="Key_b",e[e.Key_c=67]="Key_c",e[e.Key_d=68]="Key_d",e[e.Key_e=69]="Key_e",e[e.Key_f=70]="Key_f",e[e.Key_g=71]="Key_g",e[e.Key_h=72]="Key_h",e[e.Key_i=73]="Key_i",e[e.Key_j=74]="Key_j",e[e.Key_k=75]="Key_k",e[e.Key_l=76]="Key_l",e[e.Key_m=77]="Key_m",e[e.Key_n=78]="Key_n",e[e.Key_o=79]="Key_o",e[e.Key_p=80]="Key_p",e[e.Key_q=81]="Key_q",e[e.Key_r=82]="Key_r",e[e.Key_s=83]="Key_s",e[e.Key_t=84]="Key_t",e[e.Key_u=85]="Key_u",e[e.Key_v=86]="Key_v",e[e.Key_w=87]="Key_w",e[e.Key_x=88]="Key_x",e[e.Key_y=89]="Key_y",e[e.Key_z=90]="Key_z",e[e.Windows=91]="Windows",e[e.ContextMenu=93]="ContextMenu",e[e.Numpad_0=96]="Numpad_0",e[e.Numpad_1=97]="Numpad_1",e[e.Numpad_2=98]="Numpad_2",e[e.Numpad_3=99]="Numpad_3",e[e.Numpad_4=100]="Numpad_4",e[e.Numpad_5=101]="Numpad_5",e[e.Numpad_6=102]="Numpad_6",e[e.Numpad_7=103]="Numpad_7",e[e.Numpad_8=104]="Numpad_8",e[e.Numpad_9=105]="Numpad_9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.Decimal=110]="Decimal",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.Semicolon=186]="Semicolon",e[e.Equals=187]="Equals",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.ForwardSlash=191]="ForwardSlash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBracket=221]="CloseBracket",e[e.SingleQuote=222]="SingleQuote"}(n=t.VD||(t.VD={}))},2940:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ListUtils=void 0;var i=r(6799),n=r(4170),o=function(){function e(){}return e.remove=function(e,t){var r=e.indexOf(t,0);r>=0&&e.splice(r,1)},e.removeBy=function(e,t){for(var r=e.length,i=0;i<r;i++)if(t(e[i],i))return e.splice(i,1)[0];return null},e.shallowCopy=function(e){return e.slice()},e.deepCopy=function(t){return e.map(t,(function(e){return e.clone()}))},e.initByValue=function(e,t){for(var r=[];e>0;e--)r.push(t);return r},e.initByCallback=function(e,t){for(var r=[],i=0;i<e;i++)r.push(t(i));return r},e.forEachOnInterval=function(e,t){for(var r=e.end,i=e.start;i<r;i++)t(i)},e.reverseForEachOnInterval=function(e,t){for(var r=e.start,i=e.end-1;i>=r;i--)t(i)},e.reducedMap=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=[],o=r;o<i;o++){var a=t(e[o],o);null!==a&&n.push(a)}return n},e.filter=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=[],o=r;o<i;o++){var a=e[o];t(a,o)&&n.push(a)}return n},e.map=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=[],o=r;o<i;o++)n.push(t(e[o],o));return n},e.indexBy=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=r;n<i;n++)if(t(e[n],n))return n;return-1},e.reverseIndexBy=function(e,t,r,i){void 0===r&&(r=e.length-1),void 0===i&&(i=0);for(var n=r;n>=i;n--)if(t(e[n],n))return n;return-1},e.elementBy=function(t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=t.length);var o=e.indexBy(t,r,i,n);return o<0?null:t[o]},e.reverseElementBy=function(t,r,i,n){void 0===i&&(i=t.length-1),void 0===n&&(n=0);var o=e.reverseIndexBy(t,r,i,n);return o<0?null:t[o]},e.last=function(e){return e[e.length-1]},e.setLast=function(e,t){return e[e.length-1]=t},e.incLast=function(e){return++e[e.length-1]},e.decLast=function(e){return--e[e.length-1]},e.equals=function(t,r){return t.length===r.length&&e.allOf2(t,r,(function(e,t){return e.equals(t)}))},e.equalsByReference=function(e,t){var r=e.length;if(r!==e.length)return!1;for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0},e.unique=function(t,r,i,n){void 0===i&&(i=r),void 0===n&&(n=function(){});var o=t.length;if(0===o)return[];var a=(t=t.sort(r))[0],s=e.reducedMap(t,(function(e){return 0!==i(a,e)?(a=e,e):(n(e),null)}),1,o);return s.unshift(t[0]),s},e.uniqueNumber=function(e){e=e.sort(n.Comparers.number);for(var t=Number.NaN,r=e.length-1;r>=0;r--)t===e[r]?e.splice(r,1):t=e[r];return e},e.forEach=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=r;n<i;n++)t(e[n],n)},e.forEach2=function(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);for(var o=i;o<n;o++)r(e[o],t[o],o)},e.reverseForEach=function(e,t,r,i){void 0===r&&(r=e.length-1),void 0===i&&(i=0);for(var n=r;n>=i;n--)t(e[n],n)},e.reverseIndexOf=function(e,t,r,i){void 0===r&&(r=e.length-1),void 0===i&&(i=0);for(var n=r;n>=i;n--)if(e[n]===t)return n;return-1},e.accumulate=function(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);for(var o=t,a=i;a<n;a++)o=r(o,e[a],a);return o},e.accumulateNumber=function(e,t,r,i,n){void 0===r&&(r=0),void 0===i&&(i=0),void 0===n&&(n=e.length);for(var o=r,a=i;a<n;a++)o+=t(e[a],a,o);return o},e.anyOf=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=r;n<i;n++)if(t(e[n],n))return!0;return!1},e.unsafeAnyOf=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=r;n<i;n++){var o=t(e[n],n);if(o)return o}return null},e.reverseAnyOf=function(e,t,r,i){void 0===r&&(r=e.length-1),void 0===i&&(i=0);for(var n=r;n>=i;n--)if(t(e[n],n))return!0;return!1},e.unsafeReverseAnyOf=function(e,t,r,i){void 0===r&&(r=e.length-1),void 0===i&&(i=0);for(var n=r;n>=i;n--){var o=t(e[n],n);if(o)return o}return null},e.anyOf2=function(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);for(var o=i;o<n;o++)if(r(e[o],t[o],o))return!0;return!1},e.allOf=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=e.length);for(var n=r;n<i;n++)if(!t(e[n],n))return!1;return!0},e.allOf2=function(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length);for(var o=i;o<n;o++)if(!r(e[o],t[o],o))return!1;return!0},e.allOfOnInterval=function(e,t){for(var r=e.end,i=e.start;i<r;i++)if(!t(i))return!1;return!0},e.addListOnTail=function(e,t){for(var r=0,i=void 0;i=t[r];r++)e.push(i);return e},e.joinLists=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return e.accumulate(r,[],(function(r,i){return e.addListOnTail(r,t(i)),r}))},e.push=function(e,t){return e.push(t),e},e.countIf=function(t,r){return e.accumulateNumber(t,(function(e,t){return r(e,t)?1:0}))},e.clear=function(e){e.splice(0)},e.merge=function(e,t,r,i,n,o){if(void 0===n&&(n=0),void 0===o&&(o=e.length),e=e.slice(n,o),o-n<2)return e;for(var a=(e=e.sort(t))[n],s=[a],l=n+1;l<o;l++){var d=e[l];r(a,d)?i(a,d):(a=d,s.push(a))}return s},e.min=function(t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=t.length);var o=e.minExtended(t,r,i,n);return o?o.minElement:null},e.max=function(t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=t.length);var o=e.maxExtended(t,r,i,n);return o?o.maxElement:null},e.minMax=function(t,r,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);var a=e.minMaxExtended(t,r,n,o);return a?new i.MinMax(a.minElement,a.maxElement):null},e.minExtended=function(e,t,r,n){if(void 0===r&&(r=0),void 0===n&&(n=e.length),0===e.length)return null;for(var o=e[r],a=t(o),s=r+1;s<n;s++){var l=e[s],d=t(l);d<a&&(a=d,o=l)}return new i.ExtendedMin(o,a)},e.maxExtended=function(e,t,r,n){if(void 0===r&&(r=0),void 0===n&&(n=e.length),0===e.length)return null;for(var o=e[r],a=t(o),s=r+1;s<n;s++){var l=e[s],d=t(l);d>a&&(a=d,o=l)}return new i.ExtendedMax(o,a)},e.minMaxExtended=function(e,t,r,n){if(void 0===r&&(r=0),void 0===n&&(n=e.length),0===e.length)return null;for(var o=e[r],a=o,s=t(o),l=s,d=r+1;d<n;d++){var c=e[d],h=t(c);h<s?(s=h,o=c):h>l&&(l=h,a=c)}return new i.ExtendedMinMax(o,s,a,l)},e.minByCmp=function(e,t,r,i){if(void 0===r&&(r=0),void 0===i&&(i=e.length),0===e.length)return null;for(var n=e[r],o=r+1;o<i;o++){var a=e[o];t(a,n)<0&&(n=a)}return n},e.maxByCmp=function(e,t,r,i){if(void 0===r&&(r=0),void 0===i&&(i=e.length),0===e.length)return null;for(var n=e[r],o=r+1;o<i;o++){var a=e[o];t(a,n)>0&&(n=a)}return n},e.minMaxByCmp=function(e,t,r,n){if(void 0===r&&(r=0),void 0===n&&(n=e.length),0===e.length)return null;for(var o=e[r],a=o,s=r+1;s<n;s++){var l=e[s],d=t(l,o);d>0?a=l:d<0&&(o=l)}return new i.MinMax(o,a)},e}();t.ListUtils=o},1167:function(e,t,r){t.j=void 0;var i=r(8785),n=r(6799),o=function(){function e(){}return e.forEach=function(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(e[r],parseInt(r))},e.map=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t(e[i],parseInt(i)));return r},e.reducedMap=function(e,t){var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=t(e[i],parseInt(i));null!==n&&(r[i]=n)}return r},e.clear=function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&delete e[t]},e.shallowCopy=function(t){return e.map(t,(function(e){return e}))},e.deepCopy=function(t){return e.map(t,(function(e){return e.clone()}))},e.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},e.accumulate=function(e,t,r){var i=t;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i=r(i,e[n],parseInt(n)));return i},e.keyBy=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=parseInt(r);if(t(e[r],i))return i}return null},e.elementBy=function(t,r){var i=e.keyBy(t,r);return null===i?null:t[i]},e.containsBy=function(t,r){return null!==e.keyBy(t,r)},e.toList=function(t){return e.toListBy(t,(function(e){return e}))},e.toListBy=function(e,t,r){void 0===r&&(r=i.Constants.MAX_SAFE_INTEGER);var n=[];for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&(n.push(t(e[o],parseInt(o))),! --r))break;return n},e.anyOf=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=t(e[r],parseInt(r));if(null!==i)return i}return null},e.unsafeAnyOf=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=t(e[r],parseInt(r));if(i)return i}return null},e.allOf=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&!t(e[r],parseInt(r)))return!1;return!0},e.mapLength=function(e){var t=0;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t},e.min=function(t,r){var i=e.minExtended(t,r);return null===i?null:i.minElement},e.max=function(t,r){var i=e.maxExtended(t,r);return null===i?null:i.maxElement},e.minMax=function(t,r){var i=e.minMaxExtended(t,r);return null===i?null:new n.MinMax(i.minElement,i.maxElement)},e.minExtended=function(e,t){var r,o=i.Constants.MAX_SAFE_INTEGER;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a],l=t(s,parseInt(a));l<o&&(r=s,o=l)}return void 0===r?null:new n.ExtendedMin(r,o)},e.maxExtended=function(e,t){var r,o=i.Constants.MIN_SAFE_INTEGER;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a],l=t(s,parseInt(a));l>o&&(r=s,o=l)}return void 0===r?null:new n.ExtendedMax(r,o)},e.minMaxExtended=function(e,t){var r,o,a=i.Constants.MAX_SAFE_INTEGER,s=i.Constants.MIN_SAFE_INTEGER;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var d=e[l],c=t(d,parseInt(l));c<a?(r=d,a=c):c>s&&(o=d,s=c)}return void 0===r?null:new n.ExtendedMinMax(r,a,o,s)},e.maxByCmp=function(e,t){var r;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i))if(void 0!==r){var n=e[i];t(n,r)>0&&(r=n)}else r=e[i];return void 0===r?null:r},e.minByCmp=function(e,t){var r;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i))if(void 0!==r){var n=e[i];t(n,r)<0&&(r=n)}else r=e[i];return void 0===r?null:r},e}();t.j=o},2866:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.StringMapUtils=void 0;var i=r(6799),n=r(8785),o=function(){function e(){}return e.forEach=function(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(e[r],r)},e.map=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t(e[i],i));return r},e.reducedMap=function(e,t){var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=t(e[i],i);null!==n&&(r[i]=n)}return r},e.clear=function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&delete e[t]},e.shallowCopy=function(t){return e.map(t,(function(e){return e}))},e.deepCopy=function(t){return e.map(t,(function(e){return e.clone()}))},e.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},e.accumulate=function(e,t,r){var i=t;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i=r(i,e[n],n));return i},e.keyBy=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r],r))return r;return null},e.elementBy=function(t,r){var i=e.keyBy(t,r);return null===i?null:t[i]},e.containsBy=function(t,r){return null!==e.keyBy(t,r)},e.toList=function(t){return e.toListBy(t,(function(e){return e}))},e.toListBy=function(e,t,r){void 0===r&&(r=n.Constants.MAX_SAFE_INTEGER);var i=[];for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&(i.push(t(e[o],o)),! --r))break;return i},e.anyOf=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=t(e[r],r);if(null!==i)return i}return null},e.unsafeAnyOf=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var i=t(e[r],r);if(i)return i}return null},e.allOf=function(e,t){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&!t(e[r],r))return!1;return!0},e.mapLength=function(e){var t=0;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t},e.min=function(t,r){var i=e.minExtended(t,r);return null===i?null:i.minElement},e.max=function(t,r){var i=e.maxExtended(t,r);return null===i?null:i.maxElement},e.minMax=function(t,r){var n=e.minMaxExtended(t,r);return null===n?null:new i.MinMax(n.minElement,n.maxElement)},e.minExtended=function(e,t){var r,o=n.Constants.MAX_SAFE_INTEGER;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a],l=t(s,a);l<o&&(r=s,o=l)}return void 0===r?null:new i.ExtendedMin(r,o)},e.maxExtended=function(e,t){var r,o=n.Constants.MIN_SAFE_INTEGER;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=e[a],l=t(s,a);l>o&&(r=s,o=l)}return void 0===r?null:new i.ExtendedMax(r,o)},e.minMaxExtended=function(e,t){var r,o,a=n.Constants.MAX_SAFE_INTEGER,s=n.Constants.MIN_SAFE_INTEGER;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var d=e[l],c=t(d,l);c<a?(r=d,a=c):c>s&&(o=d,s=c)}return void 0===r?null:new i.ExtendedMinMax(r,a,o,s)},e.maxByCmp=function(e,t){var r;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i))if(void 0!==r){var n=e[i];t(n,r)>0&&(r=n)}else r=e[i];return void 0===r?null:r},e.minByCmp=function(e,t){var r;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i))if(void 0!==r){var n=e[i];t(n,r)<0&&(r=n)}else r=e[i];return void 0===r?null:r},e}();t.StringMapUtils=o},8679:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.MathUtils=void 0;var i=r(2940),n=function(){function e(){}return e.round=function(t,r){void 0===r&&(r=0);var i=e.powFactor[r];return Math.round(t*i)/i},e.numberCloseTo=function(e,t,r){return void 0===r&&(r=1e-5),Math.abs(e-t)<r},e.restrictValue=function(e,t,r){return r<t&&(r=t),e>r?r:e<t?t:e},e.getRandomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.generateGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},e.powFactor=i.ListUtils.initByCallback(20,(function(e){return Math.pow(10,e)})),e.somePrimes=[1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003],e}();t.MathUtils=n},4633:function(e,t){var r,i,n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.MimeTypeUtils=t.DxMimeType=t.ImageWebpMimeType=t.ImageWbmpMimeType=t.ImageIcoMimeType=t.ImageTiffMimeType=t.ImageSvgMimeType=t.ImagePjpegMimeType=t.ImageJpegMimeType=t.ImageGifMimeType=t.ImagePngMimeType=t.DocmMimeType=t.HtmlMimeType=t.PlainTextMimeType=t.RtfMimeType=t.OpenXmlMimeType=void 0,t.OpenXmlMimeType="application/vnd.openxmlformats-officedocument.wordprocessingml.document",t.RtfMimeType="application/rtf",t.PlainTextMimeType="text/plain",t.HtmlMimeType="text/html",t.DocmMimeType="application/vnd.ms-word.document.macroEnabled.12",t.ImagePngMimeType="image/png",t.ImageGifMimeType="image/gif",t.ImageJpegMimeType="image/jpeg",t.ImagePjpegMimeType="image/pjpeg",t.ImageSvgMimeType="image/svg+xml",t.ImageTiffMimeType="image/tiff",t.ImageIcoMimeType="image/vnd.microsoft.icon",t.ImageWbmpMimeType="image/vnd.wap.wbmp",t.ImageWebpMimeType="image/webp",function(e){e[e.Unknown=0]="Unknown",e[e.OpenXml=1]="OpenXml",e[e.Rtf=2]="Rtf",e[e.PlainText=3]="PlainText",e[e.Docm=4]="Docm",e[e.Png=5]="Png",e[e.Gif=6]="Gif",e[e.Jpeg=7]="Jpeg",e[e.Pjpeg=8]="Pjpeg",e[e.Svg=9]="Svg",e[e.Tiff=10]="Tiff",e[e.Ico=11]="Ico",e[e.Wbmp=12]="Wbmp",e[e.Webp=13]="Webp",e[e.Html=14]="Html"}(o=t.DxMimeType||(t.DxMimeType={}));var a=function(){function e(){}return e.stringTypeToExtension=function(t){var r=e.stringTypeToTypeMap[t];return void 0===r?"":e.typeToExtensionMap[r]},e.typeToExtension=function(t){var r=e.typeToExtensionMap[t];return null!=r?r:""},e.extensionToType=function(t){"."!==(t=t.toLowerCase())[0]&&(t+=".");var r=e.extensionToTypeMap[t];return null!=r?r:o.Unknown},e.typeToStringType=function(t){var r=e.typeToStringTypeMap[t];return null!=r?r:""},e.stringTypeToType=function(t){var r=e.stringTypeToTypeMap[t];return void 0===r?o.Unknown:r},e.stringTypeToTypeMap=((r={})[t.OpenXmlMimeType]=o.OpenXml,r[t.RtfMimeType]=o.Rtf,r[t.PlainTextMimeType]=o.PlainText,r[t.DocmMimeType]=o.Docm,r[t.HtmlMimeType]=o.Html,r[t.ImagePngMimeType]=o.Png,r[t.ImageGifMimeType]=o.Gif,r[t.ImageJpegMimeType]=o.Jpeg,r[t.ImagePjpegMimeType]=o.Pjpeg,r[t.ImageSvgMimeType]=o.Svg,r[t.ImageTiffMimeType]=o.Tiff,r[t.ImageIcoMimeType]=o.Ico,r[t.ImageWbmpMimeType]=o.Wbmp,r[t.ImageWebpMimeType]=o.Webp,r),e.typeToStringTypeMap=((i={})[o.Unknown]=void 0,i[o.OpenXml]=t.OpenXmlMimeType,i[o.Rtf]=t.RtfMimeType,i[o.PlainText]=t.PlainTextMimeType,i[o.Docm]=t.DocmMimeType,i[o.Html]=t.HtmlMimeType,i[o.Png]=t.ImagePngMimeType,i[o.Gif]=t.ImageGifMimeType,i[o.Jpeg]=t.ImageJpegMimeType,i[o.Pjpeg]=t.ImagePjpegMimeType,i[o.Svg]=t.ImageSvgMimeType,i[o.Tiff]=t.ImageTiffMimeType,i[o.Ico]=t.ImageIcoMimeType,i[o.Wbmp]=t.ImageWbmpMimeType,i[o.Webp]=t.ImageWebpMimeType,i),e.typeToExtensionMap=((n={})[o.Unknown]=void 0,n[o.OpenXml]=".docx",n[o.Rtf]=".rtf",n[o.PlainText]=".txt",n[o.Docm]=".docm",n[o.Html]=".html",n[o.Png]=".png",n[o.Gif]=".gif",n[o.Jpeg]=".jpeg",n[o.Pjpeg]=".pjpeg",n[o.Svg]=".svg",n[o.Tiff]=".tiff",n[o.Ico]=".ico",n[o.Wbmp]=".wbmp",n[o.Webp]=".webp",n),e.extensionToTypeMap={".docx":o.OpenXml,".rtf":o.Rtf,".txt":o.PlainText,".docm":o.Docm,".html":o.Html,".htm":o.Html,".png":o.Png,".gif":o.Gif,".jpeg":o.Jpeg,".pjpeg":o.Pjpeg,".svg":o.Svg,".tiff":o.Tiff,".ico":o.Ico,".wbmp":o.Wbmp,".webp":o.Webp},e}();t.MimeTypeUtils=a},499:function(e,t,r){t.y=void 0;var i=r(9279),n=function(){function e(){}return e.preventContextMenu=function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),i.Browser.WebKitFamily&&(e.returnValue=!1)},e}();t.y=n},2400:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SearchUtils=void 0;var r=function(){function e(){}return e.binaryIndexOf=function(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=-2);var n=0===r;for(-2===i&&(i=e.length-1);r<=i;){var o=r+(i-r>>1),a=t(e[o]);if(a<0)r=o+1;else{if(!(a>0))return o;i=o-1}}return n?~r:-1},e.normedBinaryIndexOf=function(t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=-2);var o=e.binaryIndexOf(t,r,i,n);return e.binaryIndexNormalizator(o)},e.binaryIndexNormalizator=function(e){return e<0?~e-1:e},e.normedInterpolationIndexOf=function(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=-2),-2===n&&(n=e.length-1);var o=e[Math.min(i,n)];if(void 0===o||r<t(o))return-1;for(var a=t(e[i]),s=t(e[n]);;){if(!(r>a&&r<s))return r===a?i:n;var l=i+Math.floor((r-a)*(n-i)/(s-a)),d=t(e[l]);if(r>d){if(r<(a=t(e[i=l+1])))return l}else{if(!(r<d))return l;s=t(e[n=l-1])}}},e}();t.SearchUtils=r},49:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StringUtils=void 0;var r=function(){function e(){}return e.isAlpha=function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"},e.isDigit=function(e){return e>="0"&&e<="9"},e.stringHashCode=function(e){var t=0;if(0===e.length)return t;for(var r=e.length,i=0;i<r;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t},e.endsAt=function(e,t){var r=e.length-1,i=t.length-1,n=r-i;if(n<0)return!1;for(;r>=n;r--,i--)if(e[r]!==t[i])return!1;return!0},e.startsAt=function(e,t){return e.substr(0,t.length)===t},e.stringInLowerCase=function(e){return e.toLowerCase()===e},e.stringInUpperCase=function(e){return e.toUpperCase()===e},e.atLeastOneSymbolInUpperCase=function(t){for(var r=0,i=void 0;i=t[r];r++)if(e.stringInUpperCase(i)&&!e.stringInLowerCase(i))return!0;return!1},e.getSymbolFromEnd=function(e,t){return e[e.length-t]},e.trim=function(t,r){if(void 0===r)return e.trimInternal(t,!0,!0);var i=r.join("");return t.replace(new RegExp("(^["+i+"]*)|(["+i+"]*$)","g"),"")},e.trimStart=function(t,r){if(void 0===r)return e.trimInternal(t,!0,!1);var i=r.join("");return t.replace(new RegExp("^["+i+"]*","g"),"")},e.trimEnd=function(t,r){if(void 0===r)return e.trimInternal(t,!1,!0);var i=r.join("");return t.replace(new RegExp("["+i+"]*$","g"),"")},e.getDecimalSeparator=function(){return 1.1.toLocaleString().substr(1,1)},e.repeat=function(e,t){return new Array(t<=0?0:t+1).join(e)},e.isNullOrEmpty=function(e){return!e||!e.length},e.padLeft=function(t,r,i){return e.repeat(i,Math.max(0,r-t.length))+t},e.trimInternal=function(e,t,r){var i=e.length;if(!i)return e;if(i<764833){var n=e;return t&&(n=n.replace(/^\s+/,"")),r&&(n=n.replace(/\s+$/,"")),n}var o=0;if(r)for(;i>0&&/\s/.test(e[i-1]);)i--;if(t&&i>0)for(;o<i&&/\s/.test(e[o]);)o++;return e.substring(o,i)},e}();t.StringUtils=r},1632:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TouchUtils=void 0;var i=r(9279),n=r(2491),o=function(){function e(){}return e.onEventAttachingToDocument=function(t,r){return!i.Browser.MacOSMobilePlatform||!e.isTouchEventName(t)||(e.documentTouchHandlers[t]||(e.documentTouchHandlers[t]=[]),e.documentTouchHandlers[t].push(r),e.documentEventAttachingAllowed)},e.isTouchEventName=function(e){return i.Browser.WebKitTouchUI&&(e.indexOf("touch")>-1||e.indexOf("gesture")>-1)},e.isTouchEvent=function(e){return i.Browser.WebKitTouchUI&&n.isDefined(e.changedTouches)},e.getEventX=function(e){return i.Browser.IE?e.pageX:e.changedTouches[0].pageX},e.getEventY=function(e){return i.Browser.IE?e.pageY:e.changedTouches[0].pageY},e.touchMouseDownEventName=i.Browser.WebKitTouchUI?"touchstart":i.Browser.Edge&&i.Browser.MSTouchUI&&window.PointerEvent?"pointerdown":"mousedown",e.touchMouseUpEventName=i.Browser.WebKitTouchUI?"touchend":i.Browser.Edge&&i.Browser.MSTouchUI&&window.PointerEvent?"pointerup":"mouseup",e.touchMouseMoveEventName=i.Browser.WebKitTouchUI?"touchmove":i.Browser.Edge&&i.Browser.MSTouchUI&&window.PointerEvent?"pointermove":"mousemove",e.msTouchDraggableClassName="dxMSTouchDraggable",e.documentTouchHandlers={},e.documentEventAttachingAllowed=!0,e}();t.TouchUtils=o},6795:function(__unused_webpack_module,exports,__webpack_require__){var __webpack_unused_export__;__webpack_unused_export__={value:!0},exports.R=void 0;var browser_1=__webpack_require__(9279),common_1=__webpack_require__(2491),string_1=__webpack_require__(49),javascriptPrefix="javascript:",Url=function(){function Url(){}return Url.containsClientScript=function(e){return-1!==e.toLowerCase().indexOf(javascriptPrefix)},Url.navigate=function(url,target){if(!string_1.StringUtils.isNullOrEmpty(url))if(Url.containsClientScript(url))eval(url.substr(javascriptPrefix.length));else try{common_1.isNonNullString(target)?Url.navigateTo(url,target):location.href=url}catch(e){}},Url.navigateTo=function(e,t){var r=t.toLowerCase();if("_top"===r)top.location.href=e;else if("_self"===r)location.href=e;else if("_search"===r)Url.openInNewWindow(e);else if("_media"===r)Url.openInNewWindow(e);else if("_parent"===r)window.parent.location.href=e;else if("_blank"===r)Url.openInNewWindow(e);else{var i=Url.getFrame(top.frames,t);null!==i?i.location.href=e:Url.openInNewWindow(e)}},Url.openInNewWindow=function(e){if(browser_1.Browser.Safari)Url.openInNewWindowViaIframe(e);else{var t=window.open();t&&(t.opener=null,t.location.assign(e))}},Url.openInNewWindowViaIframe=function(e){var t=document.createElement("iframe");t.style.display="none",document.body.appendChild(t);var r=t.contentDocument||t.contentWindow.document,i='"'+e+'"',n=r.createElement("script");n.type="text/javascript",n.text="window.parent = null; window.top = null;window.frameElement = null;var child = window.open("+i+");child.opener = null",r.body.appendChild(n),document.body.removeChild(t)},Url.getFrame=function(e,t){if(e[t])return e[t];for(var r=0;r<e.length;r++)try{var i=e[r];if(i.name===t)return i;if(null!==(i=Url.getFrame(i.frames,t)))return i}catch(e){}return null},Url}();exports.R=Url},2020:function(e,t,r){r.r(t),r.d(t,{__assign:function(){return o},__asyncDelegator:function(){return P},__asyncGenerator:function(){return I},__asyncValues:function(){return w},__await:function(){return S},__awaiter:function(){return c},__classPrivateFieldGet:function(){return M},__classPrivateFieldSet:function(){return E},__createBinding:function(){return u},__decorate:function(){return s},__exportStar:function(){return p},__extends:function(){return n},__generator:function(){return h},__importDefault:function(){return v},__importStar:function(){return T},__makeTemplateObject:function(){return y},__metadata:function(){return d},__param:function(){return l},__read:function(){return m},__rest:function(){return a},__spread:function(){return f},__spreadArray:function(){return C},__spreadArrays:function(){return b},__values:function(){return g}});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},o.apply(this,arguments)};function a(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}function s(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function l(e,t){return function(r,i){t(r,i,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))}function h(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var u=Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||u(t,e,r)}function g(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,n++)i[n]=o[a];return i}function C(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function I(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof S?Promise.resolve(r.value.v).then(l,d):c(o[0][2],r)}catch(e){c(o[0][3],e)}var r}function l(e){s("next",e)}function d(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function P(e){var t,r;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:S(e[i](t)),done:"return"===i}:n?n(t):t}:n}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=g(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){(function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)})(i,n,(t=e[r](t)).done,t.value)}))}}}function y(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&u(t,e,r);return x(t,e),t}function v(e){return e&&e.__esModule?e:{default:e}}function M(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function E(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}},5929:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{EW:function(){return createUrlValidationOptions},Ev:function(){return splitByLines},Fw:function(){return searchTreeItem},jE:function(){return UrlUtils},tm:function(){return convertToFunction},xj:function(){return rotatePoint}});var _devexpress_utils_lib_geometry_point__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(8900),_devexpress_utils_lib_utils_list__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2940);function rotatePoint(e,t,r){const i=r.x+(e.x-r.x)*Math.cos(t)-(e.y-r.y)*Math.sin(t),n=r.y+(e.y-r.y)*Math.cos(t)+(e.x-r.x)*Math.sin(t);return new _devexpress_utils_lib_geometry_point__WEBPACK_IMPORTED_MODULE_0__.Point(i,n)}class SearchTreeItemResult{constructor(e,t,r){this.parentList=e,this.itemIndex=t,this.item=r}}function searchTreeItem(e,t){return _devexpress_utils_lib_utils_list__WEBPACK_IMPORTED_MODULE_1__.ListUtils.unsafeAnyOf(e,((r,i)=>{if(t(r))return new SearchTreeItemResult(e,i,r);if(r.items){const e=searchTreeItem(r.items,t);if(e)return e}return null}))}function convertToFunction(func){const type=typeof func;if("function"==type)return func;if("string"==type){let funcName=func.trim();if(/^\b\w+?\b$/.test(funcName)&&/^[^0-9]/.test(funcName))try{const handler=eval(funcName);if("function"==typeof handler)return handler}catch(e){}let text=funcName;0!=text.indexOf("function")&&(text=`function(s, e){${text}}`);let result=null;try{result=eval(`(${text})`)}catch(e){return console.error(`Parse error: ${func}`),null}return result}return null}function splitByLines(e){return e?e.split(/\r\n|\r|\n/):[""]}function createUrlValidationOptions(e){return{allowedSchemes:e.richOptions.fields.allowedHyperlinkUriSchemes}}const defaultAllowedProtocols=["http","https","mailto","tel"],disallowedProtocols=["javascript","data"];class UrlUtils{static isValid(e,t){var r;const i=this.convertToAbsolute(e);if(!i)return!1;const n=i.protocol.slice(0,-1);if(disallowedProtocols.includes(n))return!1;return(null!==(r=null==t?void 0:t.allowedSchemes)&&void 0!==r?r:defaultAllowedProtocols).includes(n)}static isRelative(e){try{return new URL(e),!1}catch(e){return!0}}static convertToAbsolute(e){const t=window.location.href;try{return new URL(e,t)}catch(e){return null}}static splitUrlByAnchor(e){const t=e.indexOf("#");return t<0?[e,""]:[e.substring(0,t),e.substring(t+1)]}}UrlUtils.EmptyPage="about:blank"}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};!function(){var e={};__webpack_require__.r(e),__webpack_require__.d(e,{ActiveSubDocumentChangedEvent:function(){return DY},AutoCorrectEvent:function(){return WY},AutoCorrectEventArgs:function(){return nQ},CalculateDocumentVariableAsyncEvent:function(){return YY},CalculateDocumentVariableEvent:function(){return OY},CalculateDocumentVariableEventArgs:function(){return $U},CharacterPropertiesChangedEvent:function(){return HY},CommandStateChangedEvent:function(){return $Y},CommandStateChangedEventArgs:function(){return uQ},ContentChangedEventArgs:function(){return tQ},ContentInsertedEvent:function(){return _Y},ContentRemovedEvent:function(){return UY},ContentRemovedEventArgs:function(){return rQ},ContextMenuShowingEvent:function(){return JY},ContextMenuShowingEventArgs:function(){return pQ},CustomCommandExecutedEvent:function(){return GY},CustomCommandExecutedEventArgs:function(){return lQ},DocumentChangedEvent:function(){return MY},DocumentFormattedEvent:function(){return EY},DocumentFormattedEventArgs:function(){return dQ},DocumentLinkType:function(){return sY},DocumentLoadedEvent:function(){return vY},Event:function(){return wY},EventArgs:function(){return qU},GotFocusEvent:function(){return FY},HorizontalRulerVisibleChangedEvent:function(){return XY},HorizontalRulerVisibleChangedEventArgs:function(){return sQ},HyperlinkClickEvent:function(){return LY},HyperlinkClickEventArgs:function(){return QY},KeyDownEvent:function(){return NY},KeyUpEvent:function(){return kY},KeyboardEventArgs:function(){return eQ},LostFocusEvent:function(){return RY},ParagraphPropertiesChangedEvent:function(){return VY},ParagraphPropertiesChangedEventArgs:function(){return iQ},PdfExportedEvent:function(){return qY},PdfExportedEventArgs:function(){return hQ},PdfExportingEvent:function(){return KY},PdfExportingEventArgs:function(){return cQ},PointerDownEvent:function(){return BY},PointerEventArgs:function(){return ZY},PointerUpEvent:function(){return AY},RichEditEvent:function(){return xY},SavedEvent:function(){return jY},SavedEventArgs:function(){return aQ},SavingEvent:function(){return zY},SavingEventArgs:function(){return oQ},SelectionChangedEvent:function(){return TY}});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{default:function(){return cte}});var r={};__webpack_require__.r(r),__webpack_require__.d(r,{default:function(){return are}});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{AuthenticationOptions:function(){return Pre},Bookmark:function(){return OE},BookmarkBase:function(){return DU},BookmarkCollectionBase:function(){return FU},BorderLineStyle:function(){return rE},CharacterProperties:function(){return Im},CharacterPropertiesScript:function(){return xg},Characters:function(){return zre},ContextMenuCommandId:function(){return aY},ContextMenuItem:function(){return gY},DocumentFormat:function(){return aH},DocumentProcessor:function(){return Bre},DocumentProcessorBase:function(){return CH},Events:function(){return cre},Field:function(){return uU},FieldName:function(){return DF},FileTabCommandId:function(){return $J},FloatingImage:function(){return eU},FloatingObjectHorizontalAlignment:function(){return PF},FloatingObjectHorizontalAnchorElement:function(){return wF},FloatingObjectHorizontalPositionType:function(){return bF},FloatingObjectVerticalAlignment:function(){return yF},FloatingObjectVerticalAnchorElement:function(){return xF},FloatingObjectVerticalPositionType:function(){return CF},FloatingObjectsFormatTabCommandId:function(){return oY},Font:function(){return CU},HeaderAndFooterTabCommandId:function(){return rY},HeaderFooterType:function(){return MF},HomeTabCommandId:function(){return JJ},HorizontalAbsolutePosition:function(){return G_},HorizontalAlignedPosition:function(){return X_},HorizontalRelativePosition:function(){return K_},Hyperlink:function(){return pU},HyperlinkInfo:function(){return gU},Image:function(){return j_},ImageIterator:function(){return tU},Images:function(){return sU},InlineImage:function(){return rU},InsertTabCommandId:function(){return YJ},Interval:function(){return xb},KeyCode:function(){return BF},List:function(){return aD},ListLevelFormat:function(){return JM},ListLevelNumberAlignment:function(){return $M},ListLevelSettings:function(){return oD},ListType:function(){return qM},LoadingPanel:function(){return OU},MailMergeOptions:function(){return wre},MailMergeTabCommandId:function(){return eY},Margins:function(){return HD},MergeMode:function(){return Jre},Paddings:function(){return xre},PageLayoutTabCommandId:function(){return QJ},PaperSize:function(){return TF},Paragraph:function(){return sD},ParagraphAlignment:function(){return YM},ParagraphFirstLineIndent:function(){return ZM},ParagraphLineSpacingType:function(){return QM},ParagraphProperties:function(){return lD},PrintMode:function(){return Yre},RangePermission:function(){return bD},RangePermissionOptions:function(){return yre},ReferencesTabCommandId:function(){return ZJ},RichEdit:function(){return cie},RichEditDocumentBase:function(){return yU},Section:function(){return lU},SectionBreakType:function(){return EF},ShortcutOptions:function(){return NU},Size:function(){return UD},SpellCheckerOptions:function(){return vre},SubDocument:function(){return cU},SubDocumentBase:function(){return RU},SubDocumentCollectionBase:function(){return LU},SubDocumentType:function(){return vF},Table:function(){return $D},TableBorder:function(){return _D},TableBorders:function(){return kD},TableBordersBase:function(){return ND},TableCell:function(){return WD},TableCellBorders:function(){return OD},TableContentHorizontalAlignment:function(){return oE},TableContentVerticalAlignment:function(){return aE},TableDesignTabCommandId:function(){return iY},TableLayoutTabCommandId:function(){return nY},TableRow:function(){return XD},TableRowHeightType:function(){return nE},TableStyleOptions:function(){return KD},TableWidthType:function(){return iE},UpdateFieldsOptions:function(){return fU},Utils:function(){return ZQ},VerticalAbsolutePosition:function(){return $_},VerticalAlignedPosition:function(){return q_},VerticalRelativePosition:function(){return J_},ViewTabCommandId:function(){return tY},ViewType:function(){return $re},WrapSide:function(){return IF},WrapType:function(){return SF}});var n,o,a,s,l,d,c,h,u,p={};__webpack_require__.r(p),__webpack_require__.d(p,{FileTabItemId:function(){return Qre},FloatingObjectsFormatTabItemId:function(){return lie},HeaderAndFooterTabItemId:function(){return oie},HomeTabItemId:function(){return Zre},InsertTabItemId:function(){return eie},MailMergeTabItemId:function(){return iie},PageLayoutTabItemId:function(){return tie},ReferencesTabItemId:function(){return rie},Ribbon:function(){return iZ},RibbonButtonItem:function(){return qQ},RibbonColorBoxItem:function(){return $Q},RibbonContextTab:function(){return UJ},RibbonItemBase:function(){return OJ},RibbonItemType:function(){return nJ},RibbonMenuItem:function(){return JQ},RibbonNumberBoxItem:function(){return YQ},RibbonSelectBoxItem:function(){return tZ},RibbonSubMenuItem:function(){return rZ},RibbonTab:function(){return _J},RibbonTabType:function(){return oJ},RichEditUnit:function(){return KM},TableDesignTabItemId:function(){return aie},TableLayoutTabItemId:function(){return sie},ViewTabItemId:function(){return nie},create:function(){return uie},createOptions:function(){return hie}}),function(e){e[e.False=0]="False",e[e.True=1]="True",e[e.SaveInProgress=2]="SaveInProgress"}(n||(n={})),function(e){e[e.NoErrors=0]="NoErrors",e[e.ModelIsChanged=1]="ModelIsChanged",e[e.InnerException=2]="InnerException",e[e.AuthException=3]="AuthException",e[e.CantSaveToAlreadyOpenedFile=4]="CantSaveToAlreadyOpenedFile",e[e.CantSaveDocument=5]="CantSaveDocument",e[e.CantOpenDocument=6]="CantOpenDocument",e[e.CalculateDocumentVariableException=7]="CalculateDocumentVariableException",e[e.PathTooLongException=8]="PathTooLongException",e[e.CantSaveToEmptyPath=9]="CantSaveToEmptyPath",e[e.InsertContentFromServerException=10]="InsertContentFromServerException",e[e.LoadPictureException=11]="LoadPictureException",e[e.SessionHasExpired=12]="SessionHasExpired"}(o||(o={})),function(e){e[e.CommandType=0]="CommandType",e[e.IncId=1]="IncId",e[e.ServerParams=2]="ServerParams",e[e.EditIncId=3]="EditIncId",e[e.SubDocumentId=5]="SubDocumentId",e[e.Caches=6]="Caches",e[e.IsNewWorkSession=7]="IsNewWorkSession"}(a||(a={})),function(e){e[e.State=0]="State",e[e.Property=1]="Property"}(s||(s={})),function(e){e[e.IsNewDocument=0]="IsNewDocument",e[e.SessionGuid=1]="SessionGuid",e[e.FileName=2]="FileName",e[e.LastExecutedEditCommandId=3]="LastExecutedEditCommandId",e[e.SubDocumentsCounter=5]="SubDocumentsCounter",e[e.IsModified=6]="IsModified",e[e.InvalidDocument=7]="InvalidDocument",e[e.Document=8]="Document",e[e.Caches=9]="Caches",e[e.Options=10]="Options",e[e.HistoryId=11]="HistoryId",e[e.Src=12]="Src",e[e.FolderPath=13]="FolderPath",e[e.DocumentFormat=14]="DocumentFormat",e[e.FirstRecordIndex=15]="FirstRecordIndex",e[e.LastRecordIndex=16]="LastRecordIndex",e[e.MergeMode=17]="MergeMode",e[e.DocumentHasSource=18]="DocumentHasSource"}(l||(l={})),function(e){e[e.ErrorCode=0]="ErrorCode",e[e.CommandsResults=1]="CommandsResults"}(d||(d={})),function(e){e[e.CharacterPropertiesCache=0]="CharacterPropertiesCache",e[e.ParagraphPropertiesCache=1]="ParagraphPropertiesCache",e[e.ListLevelPropertiesCache=2]="ListLevelPropertiesCache",e[e.TableRowPropertiesCache=3]="TableRowPropertiesCache",e[e.TableCellPropertiesCache=4]="TableCellPropertiesCache",e[e.SubDocuments=5]="SubDocuments",e[e.FontInfoCache=6]="FontInfoCache",e[e.ColorModelInfoCache=7]="ColorModelInfoCache",e[e.ShadingInfoCache=8]="ShadingInfoCache"}(c||(c={})),function(e){e[e.Position=0]="Position",e[e.Length=1]="Length",e[e.SubDocumentId=2]="SubDocumentId",e[e.ResultRtf=3]="ResultRtf",e[e.Id=4]="Id"}(h||(h={})),function(e){e[e.RtfText=0]="RtfText",e[e.Result=1]="Result",e[e.Id=2]="Id"}(u||(u={}));var g=__webpack_require__(9291),m=__webpack_require__(1768),f=__webpack_require__(2940),b=__webpack_require__(1167),C=__webpack_require__(2400),S=__webpack_require__(2491),I=__webpack_require__(310),P=__webpack_require__(8679),w=__webpack_require__(13);class y{static getPredefinedColor(e){return w.i.fromHashString(e,0)}static anyToColor(e,t){if((0,S.isNumber)(e)&&!isNaN(e))return e;if("string"==typeof e){var r=parseInt(e);return isNaN(r)||e!=r?w.i.fromHashString(e):r}return t}static getActualForeColor(e,t){e==y.AUTOMATIC_COLOR&&(e=t==y.AUTOMATIC_COLOR||t==y.NO_COLOR||y.calculateLumaY(t)>=y.DEFAULT_BOUNDARY_LUMA?w.i.DARK_COLOR:w.i.LIGHT_COLOR);return y.getCssString(e,!0)}static getCssString(e,t){return e==y.AUTOMATIC_COLOR?w.i.colorToHash(t?w.i.DARK_COLOR:w.i.LIGHT_COLOR):y.getCssStringInternal(e)}static getHashString(e){return w.i.colorToHash(e)}static IsDarkColor(e){return y.calculateLumaY(e)<y.DEFAULT_BOUNDARY_LUMA}static getCssStringInternal(e){switch(w.i.getAlpha(e)){case 0:return"transparent";case 255:return w.i.colorToHash(e);default:return"rgba("+w.i.getRed(e)+","+w.i.getGreen(e)+","+w.i.getBlue(e)+","+y.getOpacity(e)+")"}}static getOpacity(e){return w.i.getAlpha(e)/255}static isEmptyBgColor(e){return e===this.AUTOMATIC_COLOR||e===this.NO_COLOR}static calculateLumaY(e){return y.DEFAULT_BOUNDARY_LUMA_RED*w.i.getRed(e)+y.DEFAULT_BOUNDARY_LUMA_GREEN*w.i.getGreen(e)+y.DEFAULT_BOUNDARY_LUMA_BLUE*w.i.getBlue(e)}}y.DEFAULT_BOUNDARY_LUMA=3982098.432,y.DEFAULT_BOUNDARY_LUMA_RED=19595.264,y.DEFAULT_BOUNDARY_LUMA_BLUE=7471.104,y.DEFAULT_BOUNDARY_LUMA_GREEN=38469.632,y.BLACK_COLOR=-16777216,y.AUTOMATIC_COLOR=0,y.NO_COLOR=16777215;var x,T,v,M,E,D,F,R=__webpack_require__(7774);!function(e){e[e.Name=0]="Name",e[e.ScriptMultiplier=1]="ScriptMultiplier",e[e.CssString=2]="CssString",e[e.CanBeSet=3]="CanBeSet",e[e.SubScriptOffset=4]="SubScriptOffset",e[e.FontFamily=5]="FontFamily"}(x||(x={})),function(e){e[e.ColorType=0]="ColorType",e[e.Auto=1]="Auto",e[e.ThemeColorIndex=2]="ThemeColorIndex",e[e.Tint=3]="Tint",e[e.Rgb=4]="Rgb",e[e.ColorIndex=5]="ColorIndex"}(T||(T={})),function(e){e[e.FontInfoIndex=0]="FontInfoIndex",e[e.Size=1]="Size",e[e.Bold=2]="Bold",e[e.Italic=3]="Italic",e[e.StrikeoutType=4]="StrikeoutType",e[e.UnderlineType=5]="UnderlineType",e[e.AllCaps=6]="AllCaps",e[e.StrikeoutWordsOnly=7]="StrikeoutWordsOnly",e[e.UnderlineWordsOnly=8]="UnderlineWordsOnly",e[e.Script=9]="Script",e[e.Hidden=10]="Hidden",e[e.LangInfo=11]="LangInfo",e[e.NoProof=12]="NoProof",e[e.UseValue=13]="UseValue",e[e.FontName=14]="FontName",e[e.CompositeFontInfo=15]="CompositeFontInfo",e[e.TextColor=16]="TextColor",e[e.ShadingInfo=17]="ShadingInfo",e[e.HighlightColor=18]="HighlightColor",e[e.UnderlineColor=19]="UnderlineColor",e[e.StrikeoutColor=20]="StrikeoutColor",e[e.TextColorIndex=21]="TextColorIndex",e[e.ShadingInfoIndex=22]="ShadingInfoIndex",e[e.HighlightColorIndex=23]="HighlightColorIndex",e[e.UnderlineColorIndex=24]="UnderlineColorIndex",e[e.StrikeoutColorIndex=25]="StrikeoutColorIndex",e[e.SmallCaps=26]="SmallCaps"}(v||(v={})),function(e){e[e.Latin=0]="Latin",e[e.Bidi=1]="Bidi",e[e.EastAsia=2]="EastAsia"}(M||(M={})),function(e){e[e.asciiFontName=0]="asciiFontName",e[e.hightAnsiFontName=1]="hightAnsiFontName",e[e.complexScriptFontName=2]="complexScriptFontName",e[e.eastAsiaFontName=3]="eastAsiaFontName",e[e.asciiThemeFont=4]="asciiThemeFont",e[e.hightAnsiThemeFont=5]="hightAnsiThemeFont",e[e.complexScriptThemeFont=6]="complexScriptThemeFont",e[e.eastAsiaThemeFont=7]="eastAsiaThemeFont",e[e.hintFont=8]="hintFont"}(E||(E={})),function(e){e[e.Text=0]="Text",e[e.RunType=1]="RunType",e[e.Length=2]="Length",e[e.Position=3]="Position",e[e.CharacterStyleName=4]="CharacterStyleName",e[e.CharacterPropertiesIndex=5]="CharacterPropertiesIndex",e[e.CharacterProperties=6]="CharacterProperties"}(D||(D={})),function(e){e[e.FontInfo=0]="FontInfo",e[e.FontInfoIndex=1]="FontInfoIndex"}(F||(F={}));var L,B=__webpack_require__(2866);!function(e){e[e.Main=1]="Main",e[e.RowFormatter=2]="RowFormatter",e[e.LayoutFormatter=3]="LayoutFormatter",e[e.LayoutFormatterNotifier=4]="LayoutFormatterNotifier",e[e.LayoutFormatterInvalidator=5]="LayoutFormatterInvalidator",e[e.CanvasManager=6]="CanvasManager",e[e.DocumentRenderer=7]="DocumentRenderer",e[e.SelectionRenderer=8]="SelectionRenderer",e[e.SelectionFormatter=9]="SelectionFormatter",e[e.DiplayPageInfo=10]="DiplayPageInfo",e[e.DiplayTableBoundsInfo=11]="DiplayTableBoundsInfo",e[e.DiplayLayoutBoundsInfo=12]="DiplayLayoutBoundsInfo",e[e.RestartManager=13]="RestartManager",e[e.BoxWrapHolder=14]="BoxWrapHolder",e[e.PositionSaver=15]="PositionSaver",e[e.EventManager=16]="EventManager",e[e.TableFormatter=17]="TableFormatter",e[e.HtmlImporter=18]="HtmlImporter",e[e.SimpleViewRenderer=19]="SimpleViewRenderer",e[e.DocxImporter=20]="DocxImporter"}(L||(L={}));class A{constructor(e,t){this.enabled=e,this.logSource=t,this.name=L[t]}getName(){return this.name}isEnabled(e){return this.enabled}setEnabled(e){this.enabled=e}handle(e,t){return!1}}class N{constructor(){this.logSourceParams={},I.Y.forEach(L,(e=>{this.handle(e)}))}handle(e){this.logSourceParams[e]=new A(!1,e)}}class k{constructor(){this._paramsHolder=new N,this._isEnabled=!1,this.isDebug=!1,this.splitBy=", ",this.SOLID_BLOCK=String.fromCharCode(9608),this.DOUBLE_SOLID_BLOCK=this.SOLID_BLOCK+this.SOLID_BLOCK,this.TRIPLE_SOLID_BLOCK=this.DOUBLE_SOLID_BLOCK+this.SOLID_BLOCK}static getInstance(){return k.instance?k.instance:k.instance=new k}set paramsHolder(e){this._paramsHolder=e}get paramsHolder(){return this._paramsHolder}get logSourceParams(){return this._paramsHolder.logSourceParams}get isEnabled(){return this._isEnabled}disableAll(){this.isEnabled=!1,b.j.forEach(this.logSourceParams,(e=>e.setEnabled(!1)))}print(e,t,r){if(!this._isEnabled)return!1;const i=this.logSourceParams[e];i?i.isEnabled(t)&&!i.handle(t,r)&&console.log(`${this.SOLID_BLOCK} ${i.getName()} ${t} ${"function"==typeof r?r():r}`):console.log(`Log.print ${L[e]} not defined`)}flip(e,t,r){return(...i)=>(i.splice(r,1,i.splice(t,1,i[r])[0]),e.apply(e,i))}w(e,t,r=[]){return(...i)=>{const n=r.concat(0==i.length?void 0:i);return n.length>=e?t.apply(t,r.concat(i)):this.w(e,t,n)}}join(e,t){return t.join(e)}map(e,t){return f.ListUtils.map(t,e)}mask(e,t,r=Number.MAX_VALUE){let i=[],n=!1;return B.StringMapUtils.forEach(e,((o,a)=>{const s=parseInt(a);isNaN(s)||(s&t)!=s||(r!=s?i.push(e[a]):n=!0)})),n&&!i.length&&i.push(e[r]),i.join(this.splitBy)}set isEnabled(e){this._isEnabled=e}}const O=k.getInstance();class _{}_.ThousandthOfPercentage=1e5,_.MinCoordinate=-27273042329600,_.MaxCoordinate=27273042316900,_.OnePositiveFixedAngle=6e4,_.MaxPositiveFixedAngle=216e5,_.MaxFixedAngle=54e5,_.MaxFOVAngle=108e5,_.MaxOutlineWidth=20116800,_.MaxPositiveCoordinate32=51206400,_.MinTextIndentLevel=-2,_.MaxTextIndentLevel=8,_.MaxTextSpacingPercent=132e5,_.MaxTextSpacingPoints=158400,_.MaxStartAtNumValue=32767,_.MinTextBulletSizePercent=25e3,_.MaxTextBulletSizePercent=4e5,_.MinTextBulletSizePoints=100,_.MaxTextBulletSizePoints=4e5,_.MaxWidthInPoints=1584,_.EmusInPoint=12700;class U{static isTransparentOrEmpty(e){return null==e||e===U.empty||e===U.transparent}static isTransparentOrEmptyorNoColor(e){return e==y.NO_COLOR||U.isTransparentOrEmpty(e)}static isTransparentColor(e){return 0==w.i.getAlpha(e)}static isEmpty(e){return null==e||null==e}static isSemitransparentColor(e){const t=w.i.getAlpha(e);return t>0&&t<255}static fromArgb(e,t){return e<<24|w.i.getRed(t)<<16|w.i.getGreen(t)<<8|w.i.getBlue(t)}static fromRgb(e,t,r){return 255<<24|e<<16|t<<8|r}static fromName(e){const t=w.i.colorNames[e.toLowerCase()];return t?w.i.fromHashString(t):y.AUTOMATIC_COLOR}static blend(e,t){if(w.i.getAlpha(e)>=255)return e;const r=w.i.getAlpha(e)/255,i=1-r;return U.fromRgb(Math.floor(w.i.getRed(e)*r+w.i.getRed(t)*i),Math.floor(w.i.getGreen(e)*r+w.i.getGreen(t)*i),Math.floor(w.i.getBlue(e)*r+w.i.getBlue(t)*i))}static calculateNearestColor(e,t){const r=H.fromColorRGB(t);return e.length?f.ListUtils.min(e,(e=>{const t=H.fromColorRGB(e);let i=Math.abs(t.floatHue-r.floatHue);return i>1&&(i=1-i),Math.pow(i,2)+Math.pow(t.floatSaturation-r.floatSaturation,2)+Math.pow(t.luminance-r.luminance,2)})):U.empty}}U.empty=y.getPredefinedColor("#000000"),U.transparent=w.i.fromHashString("#FFFFFF",0),U.white=w.i.fromHashString(w.i.colorNames.white,255);class H{constructor(e,t,r){if(O.isEnabled&&!(e<=1&&e>=0&&t<=1&&t>=0&&r<=1&&r>=0))throw new Error(R.D.InternalException);this._hue=e,this._saturation=t,this._luminance=r}calculateHash(){return P.MathUtils.somePrimes[0]*this._hue^P.MathUtils.somePrimes[0]*this._luminance^P.MathUtils.somePrimes[0]*this._saturation}static makeFromHSL(e,t,r){return new H(e/H.MaxAngle,t/H.MaxThousandthOfPercentage,r/H.MaxThousandthOfPercentage)}static rgbToHsl(e,t,r){e/=255,t/=255,r/=255;var i,n,o=Math.max(e,t,r),a=Math.min(e,t,r),s=(o+a)/2;if(o==a)i=n=0;else{var l=o-a;switch(n=s>.5?l/(2-o-a):l/(o+a),o){case e:i=(t-r)/l+(t<r?6:0);break;case t:i=(r-e)/l+2;break;case r:i=(e-t)/l+4}i/=6}return[i,n,s]}static fromColorRGB(e){const t=w.i.getRed(e)/255,r=w.i.getGreen(e)/255,i=w.i.getBlue(e)/255,n=Math.max(t,r,i),o=Math.min(t,r,i);let a,s;const l=(n+o)/2;if(n==o)s=0,a=4/6;else{const e=n-o;switch(s=l>.5?e/(2-n-o):e/(n+o),n){case t:a=(r-i)/e+(r<i?6:0);break;case r:a=(i-t)/e+2;break;case i:a=(t-r)/e+4}a/=6}return new H(a,s,l)}static calculateColorRGB(e,t){return e==U.empty||0==t?e:H.fromColorRGB(e).applyTint(t).toRgb()}toRgb(){const e=this._luminance<.5?this._luminance*(1+this._saturation):this._luminance+this._saturation-this._luminance*this._saturation,t=2*this._luminance-e,r=f.ListUtils.map([this._hue+1/3,this._hue,this._hue-1/3],(r=>(r<0&&(r+=1),r>1&&(r-=1),r=6*r<1?t+6*(e-t)*r:6*r>=1&&6*r<3?e:6*r>=3&&6*r<4?t+(e-t)*(4-6*r):t,this.toIntValue(r))));return U.fromRgb(r[0],r[1],r[2])}get hue(){return this.getIntValue(this._hue,H.MaxAngle)}set hue(e){this._hue=this.getFloatValue(this.getValidValue(e),H.MaxAngle)}get saturation(){return this.getIntValue(this._saturation,H.MaxThousandthOfPercentage)}set saturation(e){this._saturation=this.getFloatValue(this.getValidValue(e),H.MaxThousandthOfPercentage)}get luminance(){return this.getIntValue(this._luminance,H.MaxThousandthOfPercentage)}set luminance(e){this._luminance=this.getFloatValue(this.getValidValue(e),H.MaxThousandthOfPercentage)}get floatHue(){return this._hue}set floatHue(e){this._hue=this.getValidValue(e)}get floatSaturation(){return this._saturation}set floatSaturation(e){this._saturation=this.getValidValue(e)}get floatLuminance(){return this._luminance}set floatLuminance(e){this._luminance=this.getValidValue(e)}getComplementColor(){return this._hue+=this._hue>.5?-.5:.5,this}applyHue(e){return this.floatHue=e/H.MaxAngle,this}applyHueMod(e){return this._hue=this._hue*e/H.MaxThousandthOfPercentage,this.fixHue(),this}applyHueOffset(e){return this._hue+=e/H.MaxAngle,this.fixHue(),this}applySaturation(e){return this.floatSaturation=e/H.MaxThousandthOfPercentage,this}applySaturationMod(e){return this._saturation=this._saturation*e/H.MaxThousandthOfPercentage,this}applySaturationOffset(e){return this._saturation+=e/H.MaxThousandthOfPercentage,this}applyLuminance(e){return this.floatLuminance=e/H.MaxThousandthOfPercentage,this}applyLuminanceMod(e){return this._luminance=this._luminance*e/H.MaxThousandthOfPercentage,this}applyLuminanceOffset(e){return this._luminance+=e/H.MaxThousandthOfPercentage,this}fixHue(){this._hue>1&&(this._hue-=Math.floor(this._hue))}toIntValue(e){return this.fixIntValue(Math.round(255*e))}fixIntValue(e){return P.MathUtils.restrictValue(e,0,255)}getIntValue(e,t){return Math.round(e*t)}getFloatValue(e,t){return e/t}getValidValue(e){return P.MathUtils.restrictValue(e,0,1)}applyTint(e){return e<0?this._luminance*=1+e:e>0&&(this._luminance=this._luminance*(1-e)+e),this}equals(e){return e&&this._hue==e._hue&&this._saturation==e._saturation&&this._luminance==e._luminance}}var V,W,z,j,X,G,K,q,$,J,Y,Q,Z,ee,te,re,ie,ne,oe,ae,se,le,de;H.MaxAngle=_.MaxPositiveFixedAngle,H.MaxThousandthOfPercentage=_.ThousandthOfPercentage,H.defaultValue=new H(0,0,0),function(e){e[e.Rgb=0]="Rgb",e[e.Theme=1]="Theme",e[e.Index=2]="Index",e[e.Auto=3]="Auto"}(V||(V={}));class ce{}ce.None=-1,ce.Light1=0,ce.Dark1=1,ce.Light2=2,ce.Dark2=3,ce.Accent1=4,ce.Accent2=5,ce.Accent3=6,ce.Accent4=7,ce.Accent5=8,ce.Accent6=9,ce.Hyperlink=10,ce.FollowedHyperlink=11,function(e){e[e.Rgb=0]="Rgb",e[e.System=1]="System",e[e.Scheme=2]="Scheme",e[e.Preset=3]="Preset",e[e.ScRgb=4]="ScRgb",e[e.Hsl=5]="Hsl"}(W||(W={})),function(e){e[e.None=-1]="None",e[e.Light1=0]="Light1",e[e.Dark1=1]="Dark1",e[e.Light2=2]="Light2",e[e.Dark2=3]="Dark2",e[e.Accent1=4]="Accent1",e[e.Accent2=5]="Accent2",e[e.Accent3=6]="Accent3",e[e.Accent4=7]="Accent4",e[e.Accent5=8]="Accent5",e[e.Accent6=9]="Accent6",e[e.Hyperlink=10]="Hyperlink",e[e.FollowedHyperlink=11]="FollowedHyperlink",e[e.Background1=12]="Background1",e[e.Background2=13]="Background2",e[e.Text1=14]="Text1",e[e.Text2=15]="Text2"}(z||(z={}));class he{static get nullColor(){return he.makeByColor(y.AUTOMATIC_COLOR)}static makeByThemeColorIndex(e,t=0,r=z.None){const i=new he;return i.themeColorIndex=e,i.tint=t,i.themeValue=r,i}static makeByColor(e,t=0){const r=new he;return r.rgb=e,r.tint=t,r}static makeByColorIndex(e,t=0){const r=new he;return r.colorIndex=e,r.tint=t,r}static makeByColorHash(e,t=0){let r=y.getPredefinedColor(e);return r===y.AUTOMATIC_COLOR&&(r=y.BLACK_COLOR),he.makeByColor(r,t)}get colorType(){return this._colorType}get rgb(){return this._rgb}set rgb(e){this.setColorType(V.Rgb),this._rgb!=e&&(this._rgb=e)}get themeColorIndex(){return this._themeColorIndex}set themeColorIndex(e){this.setColorType(V.Theme),this._themeColorIndex!=e&&(this._themeColorIndex=e)}get themeValue(){return this._themeValue}set themeValue(e){this.setColorType(V.Theme),this._themeValue!=e&&(this._themeValue=e)}get colorIndex(){return this._colorIndex}set colorIndex(e){this.setColorType(V.Index),this._colorIndex!=e&&(this._colorIndex=e)}get tint(){return this._tint}set tint(e){if(Math.abs(e)>1)throw new Error(R.D.InternalException);this._tint=e}get isEmpty(){return this.colorType==V.Rgb&&U.isTransparentOrEmpty(this.rgb)}constructor(){this._themeColorIndex=ce.None,this._themeValue=z.None,this._colorIndex=he.defaultColorIndex,this.restoreDefaultValues()}restoreDefaultValues(){this._themeColorIndex=ce.None,this._themeValue=z.None,this._colorIndex=he.defaultColorIndex,this._rgb=U.empty,this._colorType=V.Rgb,this._tint=0}setColorType(e){this._colorType!=e&&(this.restoreDefaultValues(),this._colorType=e)}static makeAuto(){const e=new he;return e.setColorType(V.Auto),e}toRgb(e){let t=U.empty;switch(this.colorType){case V.Index:this.colorIndex!=he.defaultColorIndex&&(t=e.palette.getColorByIndex(this.colorIndex),0==w.i.getAlpha(t)&&(t=U.fromArgb(255,t)));break;case V.Theme:this.themeColorIndex!=ce.None&&(t=e.officeTheme.colors.getColorByThemeColorIndex(e,this.themeColorIndex));break;case V.Rgb:t=this.rgb}return H.calculateColorRGB(t,this.tint)}clone(){const e=new he;return e.copyFrom(this),e}copyFrom(e){this._themeColorIndex=e.themeColorIndex,this._themeValue=e.themeValue,this._colorIndex=e.colorIndex,this._rgb=e.rgb,this._colorType=e.colorType,this.tint=e.tint}equals(e){return e&&this._colorType==e.colorType&&this.rgb==e.rgb&&this.themeColorIndex==e.themeColorIndex&&this.colorIndex==e.colorIndex&&this.tint==e.tint&&this.themeValue==e.themeValue}static equalsBinary(e,t){return e&&t&&(e===t||e._colorType==t._colorType&&e._rgb==t._rgb&&e._colorIndex==t._colorIndex&&e._themeColorIndex==t._themeColorIndex&&e._tint==t._tint&&e._themeValue==t._themeValue)}calculateHash(){let e=P.MathUtils.somePrimes[0]*this._colorType;return void 0!==this._rgb&&(e^=P.MathUtils.somePrimes[1]*this._rgb),void 0!==this._tint&&(e^=P.MathUtils.somePrimes[2]*this._tint),void 0!==this._colorIndex&&(e^=P.MathUtils.somePrimes[3]*this._colorIndex),void 0!==this._themeColorIndex&&(e^=P.MathUtils.somePrimes[4]*this._themeColorIndex),e}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}toJSON(){const e={};return e[T.ColorType]=this.colorType,e[T.Tint]=this.tint,e[T.ColorIndex]=this.colorIndex,e[T.ThemeColorIndex]=this.themeColorIndex,e[T.Rgb]=this.rgb,e}toDebugString(){return`type: ${V[this.colorType]}, rgb ${this.rgb}, themeColorIndex: ${this.themeColorIndex}, themeValue: ${this.themeValue}`}}he.defaultColorIndex=-1,he.empty=new he,he.auto=he.makeAuto(),he.autoColor=he.makeByColor(y.AUTOMATIC_COLOR),he.noColor=he.makeByColor(y.NO_COLOR),function(e){e[e.Style=0]="Style",e[e.Color=1]="Color",e[e.ColorIndex=2]="ColorIndex",e[e.Width=3]="Width",e[e.Offset=4]="Offset",e[e.Frame=5]="Frame",e[e.Shadow=6]="Shadow"}(j||(j={})),function(e){e[e.ShadingPattern=0]="ShadingPattern",e[e.BackColor=1]="BackColor",e[e.ForeColor=2]="ForeColor",e[e.ForeColorIndex=3]="ForeColorIndex",e[e.BackColorIndex=4]="BackColorIndex"}(X||(X={})),function(e){e[e.Color=0]="Color"}(G||(G={})),function(e){e[e.ColorType=0]="ColorType",e[e.Rgb=1]="Rgb",e[e.System=2]="System",e[e.Scheme=3]="Scheme",e[e.Preset=4]="Preset",e[e.Hsl=5]="Hsl",e[e.ScRgb=6]="ScRgb"}(K||(K={})),function(e){e[e.Hue=0]="Hue",e[e.Saturation=1]="Saturation",e[e.Luminance=2]="Luminance"}(q||(q={})),function(e){e[e.ScR=0]="ScR",e[e.ScG=1]="ScG",e[e.ScB=2]="ScB"}($||($={})),function(e){e[e.ForwardDirection=0]="ForwardDirection",e[e.KeepX=1]="KeepX",e[e.EndOfLine=2]="EndOfLine",e[e.Intervals=3]="Intervals"}(J||(J={})),function(e){e[e.Start=0]="Start",e[e.Length=1]="Length"}(Y||(Y={})),function(e){e[e.StartPosition=0]="StartPosition",e[e.EndPosition=1]="EndPosition",e[e.TextToCheck=2]="TextToCheck",e[e.SpellingErrors=3]="SpellingErrors",e[e.IntervalsToCheck=4]="IntervalsToCheck",e[e.CheckedIntervals=5]="CheckedIntervals",e[e.SubDocumentId=6]="SubDocumentId",e[e.AddedWord=7]="AddedWord",e[e.CustomDictionaryGuid=8]="CustomDictionaryGuid",e[e.ErrorType=9]="ErrorType",e[e.Suggestions=10]="Suggestions",e[e.ErrorWord=11]="ErrorWord",e[e.ErrorStart=12]="ErrorStart",e[e.ErrorLength=13]="ErrorLength"}(Q||(Q={})),function(e){e[e.Width=0]="Width",e[e.Height=1]="Height"}(Z||(Z={})),function(e){e[e.Id=0]="Id"}(ee||(ee={})),function(e){e[e.UserRequestId=0]="UserRequestId",e[e.Id=1]="Id",e[e.Model=2]="Model",e[e.SimpleText=3]="SimpleText"}(te||(te={}));class ue{static convertFromJSON(e){switch(e[T.ColorType]){case V.Auto:return he.auto;case V.Index:return he.makeByColorIndex(e[T.ColorIndex],e[T.Tint]);case V.Rgb:return he.makeByColor(e[T.Rgb],e[T.Tint]);case V.Theme:return he.makeByThemeColorIndex(e[T.ThemeColorIndex],e[T.Tint])}}static convertToJSON(e){return e.toJSON()}}class pe{static convertFromJSON(e,t){let r=t.getItemByJsonKey(e[X.BackColorIndex]);r||(r=ue.convertFromJSON(e[X.BackColor]));let i=t.getItemByJsonKey(e[X.ForeColorIndex]);return i||(i=ue.convertFromJSON(e[X.ForeColor])),new fe(e[X.ShadingPattern],r,i)}static convertToJSON(e){const t={};return t[X.ShadingPattern]=e.shadingPattern,t[X.BackColor]=ue.convertToJSON(e.backColor),t[X.ForeColor]=ue.convertToJSON(e.foreColor),t}}!function(e){e[e.Clear=0]="Clear",e[e.DiagCross=1]="DiagCross",e[e.DiagStripe=2]="DiagStripe",e[e.HorzCross=3]="HorzCross",e[e.HorzStripe=4]="HorzStripe",e[e.Nil=5]="Nil",e[e.Pct5=6]="Pct5",e[e.Pct10=7]="Pct10",e[e.Pct12=8]="Pct12",e[e.Pct15=9]="Pct15",e[e.Pct20=10]="Pct20",e[e.Pct25=11]="Pct25",e[e.Pct30=12]="Pct30",e[e.Pct35=13]="Pct35",e[e.Pct37=14]="Pct37",e[e.Pct40=15]="Pct40",e[e.Pct45=16]="Pct45",e[e.Pct50=17]="Pct50",e[e.Pct55=18]="Pct55",e[e.Pct60=19]="Pct60",e[e.Pct62=20]="Pct62",e[e.Pct65=21]="Pct65",e[e.Pct70=22]="Pct70",e[e.Pct75=23]="Pct75",e[e.Pct80=24]="Pct80",e[e.Pct85=25]="Pct85",e[e.Pct87=26]="Pct87",e[e.Pct90=27]="Pct90",e[e.Pct95=28]="Pct95",e[e.ReverseDiagStripe=29]="ReverseDiagStripe",e[e.Solid=30]="Solid",e[e.ThinDiagCross=31]="ThinDiagCross",e[e.ThinDiagStripe=32]="ThinDiagStripe",e[e.ThinHorzCross=33]="ThinHorzCross",e[e.ThinHorzStripe=34]="ThinHorzStripe",e[e.ThinReverseDiagStripe=35]="ThinReverseDiagStripe",e[e.ThinVertStripe=36]="ThinVertStripe",e[e.VertStripe=37]="VertStripe",e[e.Pct2=38]="Pct2",e[e.Pct7=39]="Pct7",e[e.Pct17=40]="Pct17",e[e.Pct22=41]="Pct22",e[e.Pct27=42]="Pct27",e[e.Pct32=43]="Pct32",e[e.Pct42=44]="Pct42",e[e.Pct47=45]="Pct47",e[e.Pct52=46]="Pct52",e[e.Pct57=47]="Pct57",e[e.Pct67=48]="Pct67",e[e.Pct72=49]="Pct72",e[e.Pct77=50]="Pct77",e[e.Pct82=51]="Pct82",e[e.Pct92=52]="Pct92",e[e.Pct97=53]="Pct97"}(re||(re={}));class ge{constructor(e,t){this.shadingPatternValue=e,this.shadingPattern=t}}class me{static initStatics(){me.infos=[new ge(0,re.Clear),new ge(25,re.Pct2),new ge(50,re.Pct5),new ge(75,re.Pct7),new ge(100,re.Pct10),new ge(125,re.Pct12),new ge(150,re.Pct15),new ge(175,re.Pct17),new ge(200,re.Pct20),new ge(225,re.Pct22),new ge(250,re.Pct25),new ge(275,re.Pct27),new ge(300,re.Pct30),new ge(325,re.Pct32),new ge(350,re.Pct35),new ge(375,re.Pct37),new ge(400,re.Pct40),new ge(425,re.Pct42),new ge(450,re.Pct45),new ge(475,re.Pct47),new ge(500,re.Pct50),new ge(525,re.Pct52),new ge(550,re.Pct55),new ge(575,re.Pct57),new ge(600,re.Pct60),new ge(625,re.Pct62),new ge(650,re.Pct65),new ge(675,re.Pct67),new ge(700,re.Pct70),new ge(725,re.Pct72),new ge(750,re.Pct75),new ge(775,re.Pct77),new ge(800,re.Pct80),new ge(825,re.Pct82),new ge(850,re.Pct85),new ge(875,re.Pct87),new ge(900,re.Pct90),new ge(925,re.Pct92),new ge(950,re.Pct95),new ge(975,re.Pct97),new ge(1e3,re.Solid)],me.shadingPatterns={},me.patternMultipliers={};for(let e of me.infos)me.shadingPatterns[e.shadingPatternValue]=e.shadingPattern,me.patternMultipliers[e.shadingPattern]=e.shadingPatternValue;return me.infos}static calculateShadingPattern(e){const t=me.shadingPatterns[e];return void 0===t?re.Clear:t}static getShadingPattern(e){return me.infos[e].shadingPattern}static calculateShadingPatternValue(e){const t=me.patternMultipliers[e];return void 0===t?-1:t}static getActualBackColor(e,t,r){if(r==re.Clear||r==re.Nil)return e;const i=U.white;if((U.isTransparentOrEmpty(e)||e==i)&&U.isTransparentOrEmpty(t)){const e=me.patternMultipliers[r];if(void 0!==e){const t=255*(1e3-e)/1e3;return U.fromRgb(t,t,t)}}return r==re.Solid||U.isTransparentOrEmpty(e)?t:e}static getActualBackColorByMultiplier(e,t,r){const i=U.white;if((U.isTransparentOrEmpty(e)||e==i)&&U.isTransparentOrEmpty(t)){const e=255*(1e3-r)/1e3;return U.fromRgb(e,e,e)}return 1e3==r?e:t}}me.infos=me.initStatics();class fe{static get noColor(){return fe.createByColor(he.noColor)}static get auto(){return fe.createByColor(he.auto)}static get nullColor(){return fe.createByColor(he.makeByColor(0))}constructor(e,t,r){this.shadingPattern=e,this.backColor=t,this.foreColor=r}static createByColor(e){return new fe(re.Clear,e,he.nullColor)}static createByFullData(e,t,r,i){return new fe(t,e.getItem(he.makeByColor(r)),e.getItem(he.makeByColor(i)))}getActualColor(e){const t=this.backColor.toRgb(e),r=this.foreColor.toRgb(e);return me.getActualBackColor(t,r,this.shadingPattern)}equals(e){return e&&this.shadingPattern==e.shadingPattern&&this.backColor.equals(e.backColor)&&this.foreColor.equals(e.foreColor)}static equalsBinary(e,t){return e&&t&&(e===t||e.shadingPattern==t.shadingPattern&&e.backColor.equals(t.backColor)&&e.foreColor.equals(t.foreColor))}clone(){return new fe(this.shadingPattern,this.backColor,this.foreColor)}calculateHash(){return P.MathUtils.somePrimes[0]*this.shadingPattern^P.MathUtils.somePrimes[1]*this.backColor.getHashCode()^P.MathUtils.somePrimes[2]*this.foreColor.getHashCode()}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}toJSON(){return pe.convertToJSON(this)}}!function(e){e[e.UseNone=0]="UseNone",e[e.UseFontName=1]="UseFontName",e[e.UseDoubleFontSize=2]="UseDoubleFontSize",e[e.UseFontBold=4]="UseFontBold",e[e.UseFontItalic=8]="UseFontItalic",e[e.UseFontStrikeoutType=16]="UseFontStrikeoutType",e[e.UseFontUnderlineType=32]="UseFontUnderlineType",e[e.UseAllCaps=64]="UseAllCaps",e[e.UseForeColorIndex=128]="UseForeColorIndex",e[e.UseShadingInfoIndex=256]="UseShadingInfoIndex",e[e.UseUnderlineColorIndex=512]="UseUnderlineColorIndex",e[e.UseStrikeoutColorIndex=1024]="UseStrikeoutColorIndex",e[e.UseUnderlineWordsOnly=2048]="UseUnderlineWordsOnly",e[e.UseStrikeoutWordsOnly=4096]="UseStrikeoutWordsOnly",e[e.UseScript=8192]="UseScript",e[e.UseHidden=16384]="UseHidden",e[e.UseLangInfo=32768]="UseLangInfo",e[e.UseNoProof=65536]="UseNoProof",e[e.UseFontInfo=131072]="UseFontInfo",e[e.UseHighlightColorIndex=262144]="UseHighlightColorIndex",e[e.UseRightToLeft=524288]="UseRightToLeft",e[e.UseCompositeFontInfo=1048576]="UseCompositeFontInfo",e[e.UseSmallCaps=8589934592]="UseSmallCaps",e[e.UseAll=9007199254740991]="UseAll"}(ie||(ie={})),function(e){e[e.Normal=0]="Normal",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(ne||(ne={})),function(e){e[e.None=0]="None",e[e.MajorEastAsia=1]="MajorEastAsia",e[e.MajorBidi=2]="MajorBidi",e[e.MajorAscii=3]="MajorAscii",e[e.MajorHAnsi=4]="MajorHAnsi",e[e.MinorEastAsia=5]="MinorEastAsia",e[e.MinorBidi=6]="MinorBidi",e[e.MinorAscii=7]="MinorAscii",e[e.MinorHAnsi=8]="MinorHAnsi"}(oe||(oe={})),function(e){e[e.Default=0]="Default",e[e.Cs=1]="Cs",e[e.EastAsia=2]="EastAsia",e[e.None=3]="None"}(ae||(ae={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double"}(se||(se={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Dotted=2]="Dotted",e[e.Dashed=3]="Dashed",e[e.DashDotted=4]="DashDotted",e[e.DashDotDotted=5]="DashDotDotted",e[e.Double=6]="Double",e[e.HeavyWave=7]="HeavyWave",e[e.LongDashed=8]="LongDashed",e[e.ThickSingle=9]="ThickSingle",e[e.ThickDotted=10]="ThickDotted",e[e.ThickDashed=11]="ThickDashed",e[e.ThickDashDotted=12]="ThickDashDotted",e[e.ThickDashDotDotted=13]="ThickDashDotDotted",e[e.ThickLongDashed=14]="ThickLongDashed",e[e.DoubleWave=15]="DoubleWave",e[e.Wave=16]="Wave",e[e.DashSmallGap=17]="DashSmallGap"}(le||(le={}));class be{constructor(){this.asciiFontName="",this.hightAnsiFontName="",this.complexScriptFontName="",this.eastAsiaFontName="",this.asciiThemeFont=oe.None,this.hightAnsiThemeFont=oe.None,this.complexScriptThemeFont=oe.None,this.eastAsiaThemeFont=oe.None,this.hintFont=ae.Default}equals(e){return e&&this.asciiFontName==this.asciiFontName&&this.hightAnsiFontName==this.hightAnsiFontName&&this.complexScriptFontName==this.complexScriptFontName&&this.eastAsiaFontName==this.eastAsiaFontName&&this.asciiThemeFont==this.asciiThemeFont&&this.hightAnsiThemeFont==this.hightAnsiThemeFont&&this.complexScriptThemeFont==this.complexScriptThemeFont&&this.eastAsiaThemeFont==this.eastAsiaThemeFont&&this.hintFont==this.hintFont}clone(){const e=new be;return e.asciiFontName=this.asciiFontName,e.hightAnsiFontName=this.hightAnsiFontName,e.complexScriptFontName=this.complexScriptFontName,e.eastAsiaFontName=this.eastAsiaFontName,e.asciiThemeFont=this.asciiThemeFont,e.hightAnsiThemeFont=this.hightAnsiThemeFont,e.complexScriptThemeFont=this.complexScriptThemeFont,e.eastAsiaThemeFont=this.eastAsiaThemeFont,e.hintFont=this.hintFont,e}}class Ce{constructor(e,t,r){this.bidi=e||"",this.eastAsia=t||"",this.latin=r||""}copyFrom(e){this.bidi=e.bidi,this.eastAsia=e.eastAsia,this.latin=e.latin}equals(e){return e&&this.bidi==e.bidi&&this.eastAsia==e.eastAsia&&this.latin==e.latin}static equalsBinary(e,t){return e&&t&&e.bidi==t.bidi&&e.eastAsia==t.eastAsia&&e.latin==t.latin}clone(){var e=new Ce(null,null,null);return e.copyFrom(this),e}isEmpty(){return""==this.bidi&&""==this.eastAsia&&""==this.latin}}class Se{constructor(e,t,r,i){this.textColor=e,this.foregroundColor=t,this.strikeoutColor=r,this.underlineColor=i}equals(e){return e&&this.textColor==e.textColor&&this.foregroundColor==e.foregroundColor&&this.strikeoutColor==e.strikeoutColor&&this.underlineColor==e.underlineColor}clone(){return new Se(this.textColor,this.foregroundColor,this.strikeoutColor,this.underlineColor)}}class Ie{constructor(){this.measurerSizes=Object.create(null),this.fontSize=11,this.fontBold=!1,this.fontItalic=!1,this.fontInfo=null,this.script=ne.Normal,this.fontStrikeoutType=se.None,this.fontUnderlineType=le.None,this.allCaps=!1,this.smallCaps=!1,this.underlineWordsOnly=!1,this.strikeoutWordsOnly=!1,this.noProof=!1,this.hidden=!1,this.langInfo=new Ce,this.compositeFontInfo=new be,this.textColor=he.nullColor,this.shadingInfo=fe.nullColor,this.highlightColor=he.nullColor,this.strikeoutColor=he.nullColor,this.underlineColor=he.nullColor}calculateHash(){return this.fontSize^P.MathUtils.somePrimes[0]*(0,S.boolToInt)(this.fontBold)^P.MathUtils.somePrimes[1]*(0,S.boolToInt)(this.fontItalic)^P.MathUtils.somePrimes[2]*this.shadingInfo.getHashCode()^P.MathUtils.somePrimes[3]*this.textColor.getHashCode()^P.MathUtils.somePrimes[4]*this.highlightColor.getHashCode()}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}equals(e){return!!e&&(this.fontBold==e.fontBold&&this.fontItalic==e.fontItalic&&this.fontInfo&&e.fontInfo&&this.fontInfo.equals(e.fontInfo)&&this.fontSize==e.fontSize&&this.script==e.script&&this.fontStrikeoutType==e.fontStrikeoutType&&this.fontUnderlineType==e.fontUnderlineType&&this.allCaps==e.allCaps&&this.smallCaps==e.smallCaps&&this.underlineWordsOnly==e.underlineWordsOnly&&this.strikeoutWordsOnly==e.strikeoutWordsOnly&&this.noProof==e.noProof&&this.hidden==e.hidden&&this.shadingInfo.equals(e.shadingInfo)&&this.textColor.equals(e.textColor)&&this.highlightColor.equals(e.highlightColor)&&this.strikeoutColor.equals(e.strikeoutColor)&&this.underlineColor.equals(e.underlineColor)&&this.langInfo&&e.langInfo&&this.langInfo.equals(e.langInfo)&&this.compositeFontInfo&&this.compositeFontInfo.equals(e.compositeFontInfo))}clone(){var e=new Ie;return e.copyFrom(this),e}copyFrom(e){this.fontInfo=e.fontInfo,this.fontSize=e.fontSize,this.fontBold=e.fontBold,this.fontItalic=e.fontItalic,this.script=e.script,this.fontStrikeoutType=e.fontStrikeoutType,this.fontUnderlineType=e.fontUnderlineType,this.allCaps=e.allCaps,this.smallCaps=e.smallCaps,this.underlineWordsOnly=e.underlineWordsOnly,this.strikeoutWordsOnly=e.strikeoutWordsOnly,this.noProof=e.noProof,this.hidden=e.hidden,this.shadingInfo=e.shadingInfo?e.shadingInfo.clone():new fe(re.Clear,he.noColor,he.noColor),this.textColor=e.textColor?e.textColor.clone():he.noColor,this.highlightColor=e.highlightColor?e.highlightColor.clone():he.noColor,this.strikeoutColor=e.strikeoutColor?e.strikeoutColor.clone():he.noColor,this.underlineColor=e.underlineColor?e.underlineColor.clone():he.noColor,this.langInfo=e.langInfo?e.langInfo.clone():new Ce,this.compositeFontInfo=e.compositeFontInfo?e.compositeFontInfo.clone():new be,this.clearSizes()}getSize(e){return this.measurerSizes[e]}setSize(e,t){this.measurerSizes[e]=t}clearSizes(){this.measurerSizes=Object.create(null)}linkMeasurerSizes(e){this.measurerSizes=e.measurerSizes}getLayoutColorInfo(e){return new Se(this.textColor.toRgb(e),Ie.getActualBackgroundColor(this,e),this.strikeoutColor.toRgb(e),this.underlineColor.toRgb(e))}static getActualBackgroundColor(e,t){const r=e.shadingInfo.getActualColor(t),i=e.highlightColor.toRgb(t);return I.Y.isAnyOf(i,y.NO_COLOR,y.AUTOMATIC_COLOR)?r:i}}class Pe extends Ie{constructor(){super(...arguments),this.useValue=0,this.useValueExt=0}calculateHash(){return super.calculateHash()+P.MathUtils.somePrimes[15]*this.useValue+P.MathUtils.somePrimes[16]*this.useValueExt}getUseValue(e){return e>=Pe.denominator?!!(this.useValueExt&this.getHighPartUseValue(e)):!!(this.useValue&this.getLowPartUseValue(e))}setUseValue(e,t){t?(this.useValue|=this.getLowPartUseValue(e),this.useValueExt|=this.getHighPartUseValue(e)):(this.useValue&=~this.getLowPartUseValue(e),this.useValueExt&=~this.getHighPartUseValue(e))}setUseValueFull(e){this.useValue=this.getLowPartUseValue(e),this.useValueExt=this.getHighPartUseValue(e)}getLowPartUseValue(e){return 0|e}getHighPartUseValue(e){return e<Pe.denominator?0:(Math.trunc||(Math.trunc=function(e){return e=+e,isFinite(e)?e-e%1||(e<0?-0:0===e?e:0):e}),Math.trunc(e/Pe.denominator))}getUseValueFull(){return this.useValue+this.useValueExt*Pe.denominator}resetAllUse(){this.setUseValue(ie.UseAll,!1)}setAllUse(){this.setUseValue(ie.UseAll,!0)}clone(){var e=new Pe;return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.useValue=e.useValue,this.useValueExt=e.useValueExt}equals(e){return super.equals(e)&&this.useValue==e.useValue&&this.useValueExt==e.useValueExt}static createDefault(e){const t=e.defaultCharacterProperties.clone();return t.useValue=0,t.useValueExt=0,t}setValue(e,t){e.setProp(this,t),this.setUseValue(e.maskValue(),!0)}}Pe.denominator=4294967296;class we{get count(){return this.numElements}constructor(){this.clear()}clear(){this.hashtable={},this.numElements=0}getItem(e){const t=this.addItemInternal(this.hashtable,e);return null!==t?t:(this.processNewItem(e),this.numElements++,e)}forEach(e){b.j.forEach(this.hashtable,(t=>f.ListUtils.forEach(t,e)))}findItemByPredicate(e){return b.j.anyOf(this.hashtable,(t=>f.ListUtils.elementBy(t,(t=>e(t)))))}processNewItem(e){}isExist(e){const t=e.getHashCode();let r=this.hashtable[t];if(r)for(let t,i=0;t=r[i];i++)if(t===e||t.equals(e))return!0;return!1}DEBUG_MAX_CELL_LENGTH(){return b.j.max(this.hashtable,(e=>e.length)).length}removeItems(e){const t={};let r=0;b.j.forEach(this.hashtable,(i=>i.forEach((i=>{e(i)||(this.addItemInternal(t,i),r++)})))),this.hashtable=t,this.numElements=r}addItemInternal(e,t){const r=t.getHashCode();let i=e[r];if(i){for(let e,r=0;e=i[r];r++)if(e===t||e.equals(t))return e}else e[r]=i=[];return i.push(t),null}}class ye extends we{constructor(){super()}clearTemporaryCache(){this.tempCacheForMerge={}}clear(){super.clear(),this.clearTemporaryCache()}merge(e,t){b.j.forEach(e,((e,r)=>this.addItemForMerge(t(e),r)))}getItemByJsonKey(e){return this.tempCacheForMerge[e]}addItemForMerge(e,t){return this.tempCacheForMerge[t]=this.getItem(e)}convertToJSON(e){const t=[];return b.j.forEach(this.hashtable,(r=>f.ListUtils.forEach(r,(r=>t.push(e(r)))))),t}indexOf(e){throw new Error(R.D.NotImplemented)}copyFrom(e){this.hashtable=b.j.map(e.hashtable,(e=>f.ListUtils.deepCopy(e))),this.tempCacheForMerge=b.j.deepCopy(e.tempCacheForMerge),this.numElements=e.numElements}}class xe extends ye{constructor(){super(),this.getItem(he.empty)}copyFrom(e){super.copyFrom(e)}clone(){const e=new xe;return e.copyFrom(this),e}}xe.defaultItem=he.empty,function(e){e[e.Nil=-1]="Nil",e[e.None=0]="None",e[e.Single=1]="Single",e[e.Thick=2]="Thick",e[e.Double=3]="Double",e[e.Dotted=4]="Dotted",e[e.Dashed=5]="Dashed",e[e.DotDash=6]="DotDash",e[e.DotDotDash=7]="DotDotDash",e[e.Triple=8]="Triple",e[e.ThinThickSmallGap=9]="ThinThickSmallGap",e[e.ThickThinSmallGap=10]="ThickThinSmallGap",e[e.ThinThickThinSmallGap=11]="ThinThickThinSmallGap",e[e.ThinThickMediumGap=12]="ThinThickMediumGap",e[e.ThickThinMediumGap=13]="ThickThinMediumGap",e[e.ThinThickThinMediumGap=14]="ThinThickThinMediumGap",e[e.ThinThickLargeGap=15]="ThinThickLargeGap",e[e.ThickThinLargeGap=16]="ThickThinLargeGap",e[e.ThinThickThinLargeGap=17]="ThinThickThinLargeGap",e[e.Wave=18]="Wave",e[e.DoubleWave=19]="DoubleWave",e[e.DashSmallGap=20]="DashSmallGap",e[e.DashDotStroked=21]="DashDotStroked",e[e.ThreeDEmboss=22]="ThreeDEmboss",e[e.ThreeDEngrave=23]="ThreeDEngrave",e[e.Outset=24]="Outset",e[e.Inset=25]="Inset",e[e.Apples=26]="Apples",e[e.ArchedScallops=27]="ArchedScallops",e[e.BabyPacifier=28]="BabyPacifier",e[e.BabyRattle=29]="BabyRattle",e[e.Balloons3Colors=30]="Balloons3Colors",e[e.BalloonsHotAir=31]="BalloonsHotAir",e[e.BasicBlackDashes=32]="BasicBlackDashes",e[e.BasicBlackDots=33]="BasicBlackDots",e[e.BasicBlackSquares=34]="BasicBlackSquares",e[e.BasicThinLines=35]="BasicThinLines",e[e.BasicWhiteDashes=36]="BasicWhiteDashes",e[e.BasicWhiteDots=37]="BasicWhiteDots",e[e.BasicWhiteSquares=38]="BasicWhiteSquares",e[e.BasicWideInline=39]="BasicWideInline",e[e.BasicWideMidline=40]="BasicWideMidline",e[e.BasicWideOutline=41]="BasicWideOutline",e[e.Bats=42]="Bats",e[e.Birds=43]="Birds",e[e.BirdsFlight=44]="BirdsFlight",e[e.Cabins=45]="Cabins",e[e.CakeSlice=46]="CakeSlice",e[e.CandyCorn=47]="CandyCorn",e[e.CelticKnotwork=48]="CelticKnotwork",e[e.CertificateBanner=49]="CertificateBanner",e[e.ChainLink=50]="ChainLink",e[e.ChampagneBottle=51]="ChampagneBottle",e[e.CheckedBarBlack=52]="CheckedBarBlack",e[e.CheckedBarColor=53]="CheckedBarColor",e[e.Checkered=54]="Checkered",e[e.ChristmasTree=55]="ChristmasTree",e[e.CirclesLines=56]="CirclesLines",e[e.CirclesRectangles=57]="CirclesRectangles",e[e.ClassicalWave=58]="ClassicalWave",e[e.Clocks=59]="Clocks",e[e.Compass=60]="Compass",e[e.Confetti=61]="Confetti",e[e.ConfettiGrays=62]="ConfettiGrays",e[e.ConfettiOutline=63]="ConfettiOutline",e[e.ConfettiStreamers=64]="ConfettiStreamers",e[e.ConfettiWhite=65]="ConfettiWhite",e[e.CornerTriangles=66]="CornerTriangles",e[e.CouponCutoutDashes=67]="CouponCutoutDashes",e[e.CouponCutoutDots=68]="CouponCutoutDots",e[e.CrazyMaze=69]="CrazyMaze",e[e.CreaturesButterfly=70]="CreaturesButterfly",e[e.CreaturesFish=71]="CreaturesFish",e[e.CreaturesInsects=72]="CreaturesInsects",e[e.CreaturesLadyBug=73]="CreaturesLadyBug",e[e.CrossStitch=74]="CrossStitch",e[e.Cup=75]="Cup",e[e.DecoArch=76]="DecoArch",e[e.DecoArchColor=77]="DecoArchColor",e[e.DecoBlocks=78]="DecoBlocks",e[e.DiamondsGray=79]="DiamondsGray",e[e.DoubleD=80]="DoubleD",e[e.DoubleDiamonds=81]="DoubleDiamonds",e[e.Earth1=82]="Earth1",e[e.Earth2=83]="Earth2",e[e.EclipsingSquares1=84]="EclipsingSquares1",e[e.EclipsingSquares2=85]="EclipsingSquares2",e[e.EggsBlack=86]="EggsBlack",e[e.Fans=87]="Fans",e[e.Film=88]="Film",e[e.Firecrackers=89]="Firecrackers",e[e.FlowersBlockPrint=90]="FlowersBlockPrint",e[e.FlowersDaisies=91]="FlowersDaisies",e[e.FlowersModern1=92]="FlowersModern1",e[e.FlowersModern2=93]="FlowersModern2",e[e.FlowersPansy=94]="FlowersPansy",e[e.FlowersRedRose=95]="FlowersRedRose",e[e.FlowersRoses=96]="FlowersRoses",e[e.FlowersTeacup=97]="FlowersTeacup",e[e.FlowersTiny=98]="FlowersTiny",e[e.Gems=99]="Gems",e[e.GingerbreadMan=100]="GingerbreadMan",e[e.Gradient=101]="Gradient",e[e.Handmade1=102]="Handmade1",e[e.Handmade2=103]="Handmade2",e[e.HeartBalloon=104]="HeartBalloon",e[e.HeartGray=105]="HeartGray",e[e.Hearts=106]="Hearts",e[e.HeebieJeebies=107]="HeebieJeebies",e[e.Holly=108]="Holly",e[e.HouseFunky=109]="HouseFunky",e[e.Hypnotic=110]="Hypnotic",e[e.IceCreamCones=111]="IceCreamCones",e[e.LightBulb=112]="LightBulb",e[e.Lightning1=113]="Lightning1",e[e.Lightning2=114]="Lightning2",e[e.MapleLeaf=115]="MapleLeaf",e[e.MapleMuffins=116]="MapleMuffins",e[e.MapPins=117]="MapPins",e[e.Marquee=118]="Marquee",e[e.MarqueeToothed=119]="MarqueeToothed",e[e.Moons=120]="Moons",e[e.Mosaic=121]="Mosaic",e[e.MusicNotes=122]="MusicNotes",e[e.Northwest=123]="Northwest",e[e.Ovals=124]="Ovals",e[e.Packages=125]="Packages",e[e.PalmsBlack=126]="PalmsBlack",e[e.PalmsColor=127]="PalmsColor",e[e.PaperClips=128]="PaperClips",e[e.Papyrus=129]="Papyrus",e[e.PartyFavor=130]="PartyFavor",e[e.PartyGlass=131]="PartyGlass",e[e.Pencils=132]="Pencils",e[e.People=133]="People",e[e.PeopleHats=134]="PeopleHats",e[e.PeopleWaving=135]="PeopleWaving",e[e.Poinsettias=136]="Poinsettias",e[e.PostageStamp=137]="PostageStamp",e[e.Pumpkin1=138]="Pumpkin1",e[e.PushPinNote1=139]="PushPinNote1",e[e.PushPinNote2=140]="PushPinNote2",e[e.Pyramids=141]="Pyramids",e[e.PyramidsAbove=142]="PyramidsAbove",e[e.Quadrants=143]="Quadrants",e[e.Rings=144]="Rings",e[e.Safari=145]="Safari",e[e.Sawtooth=146]="Sawtooth",e[e.SawtoothGray=147]="SawtoothGray",e[e.ScaredCat=148]="ScaredCat",e[e.Seattle=149]="Seattle",e[e.ShadowedSquares=150]="ShadowedSquares",e[e.SharksTeeth=151]="SharksTeeth",e[e.ShorebirdTracks=152]="ShorebirdTracks",e[e.Skyrocket=153]="Skyrocket",e[e.SnowflakeFancy=154]="SnowflakeFancy",e[e.Snowflakes=155]="Snowflakes",e[e.Sombrero=156]="Sombrero",e[e.Southwest=157]="Southwest",e[e.Stars=158]="Stars",e[e.Stars3d=159]="Stars3d",e[e.StarsBlack=160]="StarsBlack",e[e.StarsShadowed=161]="StarsShadowed",e[e.StarsTop=162]="StarsTop",e[e.Sun=163]="Sun",e[e.Swirligig=164]="Swirligig",e[e.TornPaper=165]="TornPaper",e[e.TornPaperBlack=166]="TornPaperBlack",e[e.Trees=167]="Trees",e[e.TriangleParty=168]="TriangleParty",e[e.Triangles=169]="Triangles",e[e.Tribal1=170]="Tribal1",e[e.Tribal2=171]="Tribal2",e[e.Tribal3=172]="Tribal3",e[e.Tribal4=173]="Tribal4",e[e.Tribal5=174]="Tribal5",e[e.Tribal6=175]="Tribal6",e[e.TwistedLines1=176]="TwistedLines1",e[e.TwistedLines2=177]="TwistedLines2",e[e.Vine=178]="Vine",e[e.Waveline=179]="Waveline",e[e.WeavingAngles=180]="WeavingAngles",e[e.WeavingBraid=181]="WeavingBraid",e[e.WeavingRibbon=182]="WeavingRibbon",e[e.WeavingStrips=183]="WeavingStrips",e[e.WhiteFlowers=184]="WhiteFlowers",e[e.Woodwork=185]="Woodwork",e[e.XIllusions=186]="XIllusions",e[e.ZanyTriangles=187]="ZanyTriangles",e[e.ZigZag=188]="ZigZag",e[e.ZigZagStitch=189]="ZigZagStitch",e[e.Disabled=2147483647]="Disabled"}(de||(de={}));class Te{static getEmpty(){return Te.empty.clone()}constructor(e,t,r){this.style=e,this.width=t,this.color=r}clone(){return new Te(this.style,this.width,this.color)}equals(e){return e&&this.style==e.style&&this.width==e.width&&this.color==e.color}}Te.empty=new Te(de.None,0,y.AUTOMATIC_COLOR);class ve extends Te{}class Me{constructor(){this.style=de.None,this.color=xe.defaultItem,this.width=0,this.offset=0,this.frame=!1,this.shadow=!1}getHashCode(){return P.MathUtils.somePrimes[0]*this.style^P.MathUtils.somePrimes[1]*this.color.getHashCode()^P.MathUtils.somePrimes[2]*this.width}getBorderBase(e){return new Te(this.style,this.width,this.color.toRgb(e))}getLayoutBorder(e){return new ve(this.style,this.width,this.color.toRgb(e))}equals(e){return e&&this.style==e.style&&this.color.equals(e.color)&&this.width==e.width&&this.offset==e.offset&&this.frame==e.frame&&this.shadow==e.shadow}static equalsBinary(e,t){return e&&t&&e.style==t.style&&e.color.equals(t.color)&&e.width==t.width&&e.offset==t.offset&&e.frame==t.frame&&e.shadow==t.shadow}copyFrom(e){this.style=e.style,this.color=e.color.clone(),this.width=e.width,this.offset=e.offset,this.frame=e.frame,this.shadow=e.shadow}clone(){var e=new Me;return e.copyFrom(this),e}}var Ee,De,Fe,Re,Le,Be,Ae,Ne,ke,Oe,_e,Ue,He,Ve,We,ze,je,Xe,Ge,Ke,qe,$e,Je,Ye,Qe=__webpack_require__(4170);class Ze{canBeMerged(){return!1}constructor(e){this.uniqueId=-1,this.modelManipulator=e}changeModified(){return!0}}class et extends Ze{canBeMerged(){return!0}constructor(){super(null),this.historyItems=[]}changeModified(){for(var e,t=0;e=this.historyItems[t];t++)if(e.changeModified())return!0;return!1}redo(){for(var e,t=0;e=this.historyItems[t];t++)e.redo()}undo(){for(var e,t=this.historyItems.length-1;e=this.historyItems[t];t--)e.undo()}add(e){if(null==e)throw new Error(R.D.ValueCannotBeNull);this.historyItems.push(e)}}class tt extends Ze{get boundSubDocument(){return this.subDocInterval.subDocument}get interval(){return this.subDocInterval.interval}constructor(e,t){super(e),this.subDocInterval=t}}class rt extends tt{constructor(e,t,r){super(e,t),this.newValue=r}redo(){this.oldState=this.modelManipulator.paragraphProperties.useValue.setValue(this.boundSubDocument,this.interval,this.newValue)}undo(){this.modelManipulator.paragraphProperties.useValue.restoreValue(this.boundSubDocument,this.oldState)}}class it extends tt{constructor(e,t,r){super(e,t),this.tabInfo=r}}class nt extends it{redo(){this.oldState=this.modelManipulator.tab.insertTabToParagraph(this.boundSubDocument,this.interval,this.tabInfo)}undo(){this.modelManipulator.tab.restoreInsertedTabToParagraph(this.boundSubDocument,this.oldState)}}class ot extends it{redo(){this.oldState=this.modelManipulator.tab.deleteTabAtParagraph(this.boundSubDocument,this.interval,this.tabInfo)}undo(){this.modelManipulator.tab.restoreDeletedTabAtParagraph(this.boundSubDocument,this.oldState)}}class at extends tt{constructor(e,t,r,i){super(e,t),this.newValue=r,this.newUse=i}redo(){this.oldState=this.getPropertiesManipulator().setValue(this.boundSubDocument,this.interval,this.newValue,this.newUse)}undo(){this.getPropertiesManipulator().restoreValue(this.boundSubDocument,this.oldState)}getPropertiesManipulator(){throw new Error(R.D.NotImplemented)}}class st extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.align}}class lt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.contextualSpacing}}class dt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.rightToLeft}}class ct extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.afterAutoSpacing}}class ht extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.shadingInfo}}class ut extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.beforeAutoSpacing}}class pt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.firstLineIndent}}class gt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.firstLineIndentType}}class mt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.keepLinesTogether}}class ft extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.leftIndent}}class bt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.lineSpacing}}class Ct extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.lineSpacingType}}class St extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.outlineLevel}}class It extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.pageBreakBefore}}class Pt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.rightIndent}}class wt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.spacingAfter}}class yt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.spacingBefore}}class xt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.suppressHyphenation}}class Tt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.suppressLineNumbers}}class vt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.widowOrphanControl}}class Mt extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.divId}}class Et extends at{getPropertiesManipulator(){return this.modelManipulator.paragraphProperties.keepWithNext}}class Dt extends Ze{constructor(e,t,r,i,n,o,a,s){super(e),this.subDocument=t,this.paragraphIndex=r,this.style=n,this.numberingListIndex=o,this.listLevelIndex=a,this.paragraphProperties=i,this.tabs=s.clone()}redo(){let e=this.subDocument.paragraphs[this.paragraphIndex];this.oldParagraphProperties=e.maskedParagraphProperties,this.oldStyle=e.paragraphStyle,this.oldNumberingListIndex=e.numberingListIndex,this.oldListLevelIndex=e.listLevelIndex,this.oldTabs=e.tabs.clone(),this.modelManipulator.paragraphProperties.changeAllProperties(this.subDocument,this.paragraphIndex,this.paragraphProperties,this.style,this.tabs,this.numberingListIndex,this.listLevelIndex)}undo(){this.modelManipulator.paragraphProperties.changeAllProperties(this.subDocument,this.paragraphIndex,this.oldParagraphProperties,this.oldStyle,this.oldTabs,this.oldNumberingListIndex,this.oldListLevelIndex)}}!function(e){e[e.Alignment=0]="Alignment",e[e.FirstLineIndent=1]="FirstLineIndent",e[e.FirstLineIndentType=2]="FirstLineIndentType",e[e.LeftIndent=3]="LeftIndent",e[e.LineSpacing=4]="LineSpacing",e[e.LineSpacingType=5]="LineSpacingType",e[e.RightIndent=6]="RightIndent",e[e.SpacingBefore=7]="SpacingBefore",e[e.SpacingAfter=8]="SpacingAfter",e[e.SuppressHyphenation=9]="SuppressHyphenation",e[e.SuppressLineNumbers=10]="SuppressLineNumbers",e[e.ContextualSpacing=11]="ContextualSpacing",e[e.PageBreakBefore=12]="PageBreakBefore",e[e.BeforeAutoSpacing=13]="BeforeAutoSpacing",e[e.AfterAutoSpacing=14]="AfterAutoSpacing",e[e.KeepWithNext=15]="KeepWithNext",e[e.KeepLinesTogether=16]="KeepLinesTogether",e[e.WidowOrphanControl=17]="WidowOrphanControl",e[e.OutlineLevel=18]="OutlineLevel",e[e.ShadingInfo=19]="ShadingInfo",e[e.ShadingInfoIndex=20]="ShadingInfoIndex",e[e.LeftBorder=21]="LeftBorder",e[e.RightBorder=22]="RightBorder",e[e.TopBorder=23]="TopBorder",e[e.BottomBorder=24]="BottomBorder",e[e.DivId=25]="DivId",e[e.RightToLeft=26]="RightToLeft",e[e.BetweenBorder=27]="BetweenBorder",e[e.UseValue=28]="UseValue"}(Ee||(Ee={})),function(e){e[e.MaskedParagraphPropertiesIndex=0]="MaskedParagraphPropertiesIndex",e[e.ParagraphStyleIndex=1]="ParagraphStyleIndex",e[e.LogPosition=2]="LogPosition",e[e.Length=3]="Length",e[e.Tabs=4]="Tabs",e[e.ListIndex=5]="ListIndex",e[e.ListLevelIndex=6]="ListLevelIndex"}(De||(De={})),function(e){e[e.Position=0]="Position",e[e.GetPropertiesFromNext=1]="GetPropertiesFromNext"}(Fe||(Fe={})),function(e){e[e.Position=0]="Position",e[e.NumberingListIndex=1]="NumberingListIndex",e[e.ListLevelIndex=2]="ListLevelIndex",e[e.StyleName=3]="StyleName",e[e.ParagraphProperties=4]="ParagraphProperties",e[e.ParagraphPropertiesIndex=5]="ParagraphPropertiesIndex",e[e.TabsProperties=6]="TabsProperties"}(Re||(Re={})),function(e){e[e.ParagraphIndex=0]="ParagraphIndex",e[e.ParagraphProperties=1]="ParagraphProperties",e[e.NumberingListIndex=2]="NumberingListIndex",e[e.ListLevelIndex=3]="ListLevelIndex",e[e.TabsProperties=4]="TabsProperties",e[e.StyleName=5]="StyleName"}(Le||(Le={}));!function(e){e[e.UseNone=0]="UseNone",e[e.UseAlignment=1]="UseAlignment",e[e.UseLeftIndent=2]="UseLeftIndent",e[e.UseRightIndent=4]="UseRightIndent",e[e.UseSpacingBefore=8]="UseSpacingBefore",e[e.UseSpacingAfter=16]="UseSpacingAfter",e[e.UseLineSpacing=32]="UseLineSpacing",e[e.UseFirstLineIndent=64]="UseFirstLineIndent",e[e.UseSuppressHyphenation=128]="UseSuppressHyphenation",e[e.UseSuppressLineNumbers=256]="UseSuppressLineNumbers",e[e.UseContextualSpacing=512]="UseContextualSpacing",e[e.UsePageBreakBefore=1024]="UsePageBreakBefore",e[e.UseBeforeAutoSpacing=2048]="UseBeforeAutoSpacing",e[e.UseAfterAutoSpacing=4096]="UseAfterAutoSpacing",e[e.UseKeepWithNext=8192]="UseKeepWithNext",e[e.UseKeepLinesTogether=16384]="UseKeepLinesTogether",e[e.UseWidowOrphanControl=32768]="UseWidowOrphanControl",e[e.UseOutlineLevel=65536]="UseOutlineLevel",e[e.UseShadingInfoIndex=131072]="UseShadingInfoIndex",e[e.UseLeftBorder=262144]="UseLeftBorder",e[e.UseRightBorder=524288]="UseRightBorder",e[e.UseTopBorder=1048576]="UseTopBorder",e[e.UseBottomBorder=2097152]="UseBottomBorder",e[e.UseDivId=4194304]="UseDivId",e[e.UseBorders=20709376]="UseBorders",e[e.UseRightToLeft=8388608]="UseRightToLeft",e[e.UseBetweenBorder=16777216]="UseBetweenBorder",e[e.UseAll=2147483647]="UseAll"}(Be||(Be={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify",e[e.JustifyMedium=4]="JustifyMedium",e[e.JustifyHigh=5]="JustifyHigh",e[e.JustifyLow=6]="JustifyLow",e[e.Distribute=7]="Distribute",e[e.ThaiDistribute=8]="ThaiDistribute"}(Ae||(Ae={})),function(e){e[e.Single=0]="Single",e[e.Sesquialteral=1]="Sesquialteral",e[e.Double=2]="Double",e[e.Multiple=3]="Multiple",e[e.Exactly=4]="Exactly",e[e.AtLeast=5]="AtLeast"}(Ne||(Ne={})),function(e){e[e.None=0]="None",e[e.Indented=1]="Indented",e[e.Hanging=2]="Hanging"}(ke||(ke={}));class Ft{}Ft.firstLineIndent=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=0}setProp(e,t){e.firstLineIndent=t}getProp(e){return e.firstLineIndent}maskValue(){return Be.UseFirstLineIndent}getHistoryItemConstructor(){return pt}getJSONProperty(){return Ee.FirstLineIndent}},Ft.widowOrphanControl=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!0}setProp(e,t){e.widowOrphanControl=t}getProp(e){return e.widowOrphanControl}maskValue(){return Be.UseWidowOrphanControl}getHistoryItemConstructor(){return vt}getJSONProperty(){return Ee.WidowOrphanControl}},Ft.firstLineIndentType=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=ke.None}setProp(e,t){e.firstLineIndentType=t}getProp(e){return e.firstLineIndentType}maskValue(){return Be.UseFirstLineIndent}getHistoryItemConstructor(){return gt}getJSONProperty(){return Ee.FirstLineIndentType}},Ft.afterAutoSpacing=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.afterAutoSpacing=t}getProp(e){return e.afterAutoSpacing}maskValue(){return Be.UseAfterAutoSpacing}getHistoryItemConstructor(){return ct}getJSONProperty(){return Ee.AfterAutoSpacing}},Ft.outlineLevel=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=0}setProp(e,t){e.outlineLevel=t}getProp(e){return e.outlineLevel}maskValue(){return Be.UseOutlineLevel}getHistoryItemConstructor(){return St}getJSONProperty(){return Ee.OutlineLevel}},Ft.beforeAutoSpacing=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.beforeAutoSpacing=t}getProp(e){return e.beforeAutoSpacing}maskValue(){return Be.UseBeforeAutoSpacing}getHistoryItemConstructor(){return ut}getJSONProperty(){return Ee.BeforeAutoSpacing}},Ft.pageBreakBefore=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.pageBreakBefore=t}getProp(e){return e.pageBreakBefore}maskValue(){return Be.UsePageBreakBefore}getHistoryItemConstructor(){return It}getJSONProperty(){return Ee.PageBreakBefore}},Ft.rightIndent=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=0}setProp(e,t){e.rightIndent=t}getProp(e){return e.rightIndent}maskValue(){return Be.UseRightIndent}getHistoryItemConstructor(){return Pt}getJSONProperty(){return Ee.RightIndent}},Ft.suppressHyphenation=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.suppressHyphenation=t}getProp(e){return e.suppressHyphenation}maskValue(){return Be.UseSuppressHyphenation}getHistoryItemConstructor(){return xt}getJSONProperty(){return Ee.SuppressHyphenation}},Ft.lineSpacing=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=0}setProp(e,t){e.lineSpacing=t}getProp(e){return e.lineSpacing}maskValue(){return Be.UseLineSpacing}getHistoryItemConstructor(){return bt}getJSONProperty(){return Ee.LineSpacing}},Ft.suppressLineNumbers=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.suppressLineNumbers=t}getProp(e){return e.suppressLineNumbers}maskValue(){return Be.UseSuppressLineNumbers}getHistoryItemConstructor(){return Tt}getJSONProperty(){return Ee.SuppressLineNumbers}},Ft.keepLinesTogether=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.keepLinesTogether=t}getProp(e){return e.keepLinesTogether}maskValue(){return Be.UseKeepLinesTogether}getHistoryItemConstructor(){return mt}getJSONProperty(){return Ee.KeepLinesTogether}},Ft.keepWithNext=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.keepWithNext=t}getProp(e){return e.keepWithNext}maskValue(){return Be.UseKeepWithNext}getHistoryItemConstructor(){return Et}getJSONProperty(){return Ee.KeepWithNext}},Ft.shadingInfo=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=fe.noColor}setProp(e,t){e.shadingInfo=t}getProp(e){return e.shadingInfo}maskValue(){return Be.UseShadingInfoIndex}getHistoryItemConstructor(){return ht}getJSONProperty(){return Ee.ShadingInfo}},Ft.leftIndent=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=0}setProp(e,t){e.leftIndent=t}getProp(e){return e.leftIndent}maskValue(){return Be.UseLeftIndent}getHistoryItemConstructor(){return ft}getJSONProperty(){return Ee.LeftIndent}},Ft.lineSpacingType=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=Ne.Single}setProp(e,t){e.lineSpacingType=t}getProp(e){return e.lineSpacingType}maskValue(){return Be.UseLineSpacing}getHistoryItemConstructor(){return Ct}getJSONProperty(){return Ee.LineSpacingType}},Ft.alignment=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=Ae.Left}setProp(e,t){e.alignment=t}getProp(e){return e.alignment}maskValue(){return Be.UseAlignment}getHistoryItemConstructor(){return st}getJSONProperty(){return Ee.Alignment}},Ft.contextualSpacing=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.contextualSpacing=t}getProp(e){return e.contextualSpacing}maskValue(){return Be.UseContextualSpacing}getHistoryItemConstructor(){return lt}getJSONProperty(){return Ee.ContextualSpacing}},Ft.spacingBefore=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=0}setProp(e,t){e.spacingBefore=t}getProp(e){return e.spacingBefore}maskValue(){return Be.UseSpacingBefore}getHistoryItemConstructor(){return yt}getJSONProperty(){return Ee.SpacingBefore}},Ft.spacingAfter=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=0}setProp(e,t){e.spacingAfter=t}getProp(e){return e.spacingAfter}maskValue(){return Be.UseSpacingAfter}getHistoryItemConstructor(){return wt}getJSONProperty(){return Ee.SpacingAfter}},Ft.rightToLeft=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.rightToLeft=t}getProp(e){return e.rightToLeft}maskValue(){return Be.UseRightToLeft}getHistoryItemConstructor(){return dt}getJSONProperty(){return Ee.RightToLeft}},Ft.leftBorder=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=new Me}setProp(e,t){e.leftBorder=t}getProp(e){return e.leftBorder}maskValue(){return Be.UseLeftBorder}getHistoryItemConstructor(){throw Error(R.D.NotImplemented)}getJSONProperty(){throw Error(R.D.NotImplemented)}},Ft.rightBorder=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=new Me}setProp(e,t){e.rightBorder=t}getProp(e){return e.rightBorder}maskValue(){return Be.UseRightBorder}getHistoryItemConstructor(){throw Error(R.D.NotImplemented)}getJSONProperty(){throw Error(R.D.NotImplemented)}},Ft.topBorder=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=new Me}setProp(e,t){e.topBorder=t}getProp(e){return e.topBorder}maskValue(){return Be.UseTopBorder}getHistoryItemConstructor(){throw Error(R.D.NotImplemented)}getJSONProperty(){throw Error(R.D.NotImplemented)}},Ft.bottomBorder=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=new Me}setProp(e,t){e.bottomBorder=t}getProp(e){return e.bottomBorder}maskValue(){return Be.UseBottomBorder}getHistoryItemConstructor(){throw Error(R.D.NotImplemented)}getJSONProperty(){throw Error(R.D.NotImplemented)}},Ft.betweenBorder=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=new Me}setProp(e,t){e.betweenBorder=t}getProp(e){return e.betweenBorder}maskValue(){return Be.UseBetweenBorder}getHistoryItemConstructor(){throw Error(R.D.NotImplemented)}getJSONProperty(){throw Error(R.D.NotImplemented)}},Ft.divId=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=0}setProp(e,t){e.divId=t}getProp(e){return e.divId}maskValue(){return Be.UseDivId}getHistoryItemConstructor(){return Mt}getJSONProperty(){return Ee.DivId}},Ft.ALL_FIELDS=[Ft.firstLineIndent,Ft.widowOrphanControl,Ft.firstLineIndentType,Ft.afterAutoSpacing,Ft.outlineLevel,Ft.beforeAutoSpacing,Ft.pageBreakBefore,Ft.rightIndent,Ft.suppressHyphenation,Ft.lineSpacing,Ft.suppressLineNumbers,Ft.keepLinesTogether,Ft.keepWithNext,Ft.shadingInfo,Ft.leftIndent,Ft.lineSpacingType,Ft.alignment,Ft.contextualSpacing,Ft.spacingBefore,Ft.spacingAfter,Ft.rightToLeft,Ft.leftBorder,Ft.rightBorder,Ft.topBorder,Ft.bottomBorder,Ft.betweenBorder,Ft.divId];class Rt{constructor(){this.firstLineIndent=0,this.widowOrphanControl=!0,this.firstLineIndentType=ke.None,this.afterAutoSpacing=!1,this.outlineLevel=0,this.beforeAutoSpacing=!1,this.pageBreakBefore=!1,this.rightIndent=0,this.suppressHyphenation=!1,this.lineSpacing=0,this.suppressLineNumbers=!1,this.keepLinesTogether=!1,this.keepWithNext=!1,this.shadingInfo=fe.nullColor,this.rightToLeft=!1,this.leftIndent=0,this.lineSpacingType=Ne.Single,this.alignment=Ae.Left,this.contextualSpacing=!1,this.spacingBefore=0,this.spacingAfter=0,this.leftBorder=new Me,this.rightBorder=new Me,this.topBorder=new Me,this.bottomBorder=new Me,this.betweenBorder=new Me,this.divId=0}calculateHash(){return P.MathUtils.somePrimes[0]*this.leftIndent^P.MathUtils.somePrimes[1]*this.rightIndent^P.MathUtils.somePrimes[2]*this.firstLineIndent^P.MathUtils.somePrimes[3]*this.spacingBefore^P.MathUtils.somePrimes[4]*this.spacingAfter}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}copyFrom(e){this.alignment=e.alignment,this.leftIndent=e.leftIndent,this.rightIndent=e.rightIndent,this.spacingBefore=e.spacingBefore,this.spacingAfter=e.spacingAfter,this.lineSpacing=e.lineSpacing,this.firstLineIndent=e.firstLineIndent,this.suppressHyphenation=e.suppressHyphenation,this.suppressLineNumbers=e.suppressLineNumbers,this.contextualSpacing=e.contextualSpacing,this.pageBreakBefore=e.pageBreakBefore,this.beforeAutoSpacing=e.beforeAutoSpacing,this.afterAutoSpacing=e.afterAutoSpacing,this.keepWithNext=e.keepWithNext,this.keepLinesTogether=e.keepLinesTogether,this.widowOrphanControl=e.widowOrphanControl,this.outlineLevel=e.outlineLevel,this.firstLineIndentType=e.firstLineIndentType,this.lineSpacingType=e.lineSpacingType,this.rightToLeft=e.rightToLeft,this.shadingInfo=e.shadingInfo?e.shadingInfo.clone():e.shadingInfo,e.leftBorder?this.leftBorder.copyFrom(e.leftBorder):this.leftBorder=e.leftBorder,e.rightBorder?this.rightBorder.copyFrom(e.rightBorder):this.rightBorder=e.rightBorder,e.topBorder?this.topBorder.copyFrom(e.topBorder):this.topBorder=e.topBorder,e.bottomBorder?this.bottomBorder.copyFrom(e.bottomBorder):this.bottomBorder=e.bottomBorder,e.betweenBorder?this.betweenBorder.copyFrom(e.betweenBorder):this.betweenBorder=e.betweenBorder,this.divId=e.divId}clone(){var e=new Rt;return e.copyFrom(this),e}equals(e){return!!e&&(this.firstLineIndent==e.firstLineIndent&&this.firstLineIndentType==e.firstLineIndentType&&this.afterAutoSpacing==e.afterAutoSpacing&&this.outlineLevel==e.outlineLevel&&this.beforeAutoSpacing==e.beforeAutoSpacing&&this.pageBreakBefore==e.pageBreakBefore&&this.rightIndent==e.rightIndent&&this.suppressHyphenation==e.suppressHyphenation&&this.lineSpacing==e.lineSpacing&&this.suppressLineNumbers==e.suppressLineNumbers&&this.keepLinesTogether==e.keepLinesTogether&&this.keepWithNext==e.keepWithNext&&this.shadingInfo.equals(e.shadingInfo)&&this.leftIndent==e.leftIndent&&this.lineSpacingType==e.lineSpacingType&&this.alignment==e.alignment&&this.contextualSpacing==e.contextualSpacing&&this.rightToLeft==e.rightToLeft&&this.spacingBefore==e.spacingBefore&&this.spacingAfter==e.spacingAfter&&this.leftBorder.equals(e.leftBorder)&&this.rightBorder.equals(e.rightBorder)&&this.topBorder.equals(e.topBorder)&&this.bottomBorder.equals(e.bottomBorder)&&this.betweenBorder.equals(e.betweenBorder)&&this.divId==e.divId)}getLeftIndentForFirstRow(){let e=this.leftIndent;switch(this.firstLineIndentType){case ke.None:case ke.Indented:e+=this.firstLineIndent;break;case ke.Hanging:e-=this.firstLineIndent}return e}getLeftIndentForOtherRow(){return this.leftIndent}getLeftIndentForParagraphFrame(){let e=this.leftIndent;return this.firstLineIndentType==ke.Hanging&&(e-=this.firstLineIndent),g.u.twipsToPixelsF(e)}}class Lt extends Rt{constructor(){super(...arguments),this.useValue=Be.UseNone}getUseValue(e){return!!(this.useValue&e)}calculateHash(){return super.calculateHash()+P.MathUtils.somePrimes[15]*this.useValue}setUseValue(e,t){t?this.useValue|=e:this.useValue&=~e}copyFrom(e){super.copyFrom(e),this.useValue=e.useValue}equals(e){return super.equals(e)&&this.useValue==e.useValue}clone(){var e=new Lt;return e.copyFrom(this),e}static createDefault(e){var t=e.defaultParagraphProperties.clone();return t.useValue=Be.UseNone,t}setValue(e,t){e.setProp(this,t),this.setUseValue(e.maskValue(),!0)}}class Bt{init(e,t){return this.value=e,this.type=t,this}clone(){return(new Bt).init(this.value,this.type)}static create(e,t){return(new Bt).init(e,t)}static createSingle(){return(new Bt).init(1,Ne.Single)}static createSesquialteral(){return(new Bt).init(1.5,Ne.Sesquialteral)}static createDouble(){return(new Bt).init(2,Ne.Double)}static createMultiple(e){return(new Bt).init(e,Ne.Multiple)}static createExactly(e){return(new Bt).init(e,Ne.Exactly)}static createAtLeast(e){return(new Bt).init(e,Ne.AtLeast)}}class At extends tt{constructor(e,t,r){super(e,t),this.newValue=r}redo(){this.oldState=this.modelManipulator.characterProperties.useValue.setValue(this.boundSubDocument,this.interval,this.newValue)}undo(){this.modelManipulator.characterProperties.useValue.restoreValue(this.boundSubDocument,this.oldState)}}class Nt extends tt{constructor(e,t,r){super(e,t),this.newValue=r}redo(){this.oldState=this.modelManipulator.characterProperties.setValue(this.boundSubDocument,this.interval,this.newValue)}undo(){this.modelManipulator.characterProperties.restoreValue(this.boundSubDocument,this.oldState)}}class kt extends tt{constructor(e,t,r,i){super(e,t),this.newValue=r,this.newUse=i}redo(){this.oldState=this.getPropertiesManipulator().setValue(this.boundSubDocument,this.interval,this.newValue,this.newUse)}undo(){this.getPropertiesManipulator().restoreValue(this.boundSubDocument,this.oldState)}getPropertiesManipulator(){throw new Error(R.D.NotImplemented)}}class Ot extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontBold}}class _t extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontCaps}}class Ut extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontSmallCaps}}class Ht extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontUnderlineType}}class Vt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.textColor}}class Wt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.shadingInfo}}class zt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontHidden}}class jt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontItalic}}class Xt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontName}}class Gt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.script}}class Kt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontSize}}class qt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontStrikeoutType}}class $t extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontStrikeoutWordsOnly}}class Jt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontStrikeoutColor}}class Yt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontUnderlineColor}}class Qt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontHighlightColor}}class Zt extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontUnderlineWordsOnly}}class er extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.fontNoProof}}class tr extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.langInfo}}class rr extends kt{getPropertiesManipulator(){return this.modelManipulator.characterProperties.compositeFontInfo}}class ir{}ir.allCaps=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.allCaps=t}getProp(e){return e.allCaps}maskValue(){return ie.UseAllCaps}getHistoryItemConstructor(){return _t}getJSONProperty(){return v.AllCaps}},ir.size=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=11}setProp(e,t){e.fontSize=t}getProp(e){return e.fontSize}maskValue(){return ie.UseDoubleFontSize}getHistoryItemConstructor(){return Kt}getJSONProperty(){return v.Size}},ir.bold=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.fontBold=t}getProp(e){return e.fontBold}maskValue(){return ie.UseFontBold}getHistoryItemConstructor(){return Ot}getJSONProperty(){return v.Bold}},ir.italic=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.fontItalic=t}getProp(e){return e.fontItalic}maskValue(){return ie.UseFontItalic}getHistoryItemConstructor(){return jt}getJSONProperty(){return v.Italic}},ir.fontInfo=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=void 0}setProp(e,t){e.fontInfo=t}getProp(e){return e.fontInfo}maskValue(){return ie.UseFontName}getHistoryItemConstructor(){return Xt}getJSONProperty(){return v.FontName}},ir.script=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=ne.Normal}setProp(e,t){e.script=t}getProp(e){return e.script}maskValue(){return ie.UseScript}getHistoryItemConstructor(){return Gt}getJSONProperty(){return v.Script}},ir.strikeoutType=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=se.None}setProp(e,t){e.fontStrikeoutType=t}getProp(e){return e.fontStrikeoutType}maskValue(){return ie.UseFontStrikeoutType}getHistoryItemConstructor(){return qt}getJSONProperty(){return v.StrikeoutType}},ir.underlineType=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=le.None}setProp(e,t){e.fontUnderlineType=t}getProp(e){return e.fontUnderlineType}maskValue(){return ie.UseFontUnderlineType}getHistoryItemConstructor(){return Ht}getJSONProperty(){return v.UnderlineType}},ir.underlineWordsOnly=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.underlineWordsOnly=t}getProp(e){return e.underlineWordsOnly}maskValue(){return ie.UseUnderlineWordsOnly}getHistoryItemConstructor(){return Zt}getJSONProperty(){return v.UnderlineWordsOnly}},ir.strikeoutWordsOnly=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.strikeoutWordsOnly=t}getProp(e){return e.strikeoutWordsOnly}maskValue(){return ie.UseStrikeoutWordsOnly}getHistoryItemConstructor(){return $t}getJSONProperty(){return v.StrikeoutWordsOnly}},ir.noProof=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.noProof=t}getProp(e){return e.noProof}maskValue(){return ie.UseNoProof}getHistoryItemConstructor(){return er}getJSONProperty(){return v.NoProof}},ir.hidden=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.hidden=t}getProp(e){return e.hidden}maskValue(){return ie.UseHidden}getHistoryItemConstructor(){return zt}getJSONProperty(){return v.Hidden}},ir.langInfo=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=new Ce}setProp(e,t){e.langInfo=t}getProp(e){return e.langInfo}maskValue(){return ie.UseLangInfo}getHistoryItemConstructor(){return tr}getJSONProperty(){return v.LangInfo}},ir.compositeFontInfo=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=new be}setProp(e,t){e.compositeFontInfo=t}getProp(e){return e.compositeFontInfo}maskValue(){return ie.UseCompositeFontInfo}getHistoryItemConstructor(){return rr}getJSONProperty(){return v.CompositeFontInfo}},ir.textColor=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=he.autoColor}setProp(e,t){e.textColor=t}getProp(e){return e.textColor}maskValue(){return ie.UseForeColorIndex}getHistoryItemConstructor(){return Vt}getJSONProperty(){return v.TextColor}},ir.shadingInfo=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=fe.noColor}setProp(e,t){e.shadingInfo=t}getProp(e){return e.shadingInfo}maskValue(){return ie.UseShadingInfoIndex}getHistoryItemConstructor(){return Wt}getJSONProperty(){return v.ShadingInfo}},ir.highlightColor=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=he.noColor}setProp(e,t){e.highlightColor=t}getProp(e){return e.highlightColor}maskValue(){return ie.UseHighlightColorIndex}getHistoryItemConstructor(){return Qt}getJSONProperty(){return v.HighlightColor}},ir.strikeoutColor=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=he.noColor}setProp(e,t){e.strikeoutColor=t}getProp(e){return e.strikeoutColor}maskValue(){return ie.UseStrikeoutColorIndex}getHistoryItemConstructor(){return Jt}getJSONProperty(){return v.StrikeoutColor}},ir.underlineColor=new class{constructor(){this.binaryEquals=Qe.Equals.object,this.defaultValue=he.noColor}setProp(e,t){e.underlineColor=t}getProp(e){return e.underlineColor}maskValue(){return ie.UseUnderlineColorIndex}getHistoryItemConstructor(){return Yt}getJSONProperty(){return v.UnderlineColor}},ir.smallCaps=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.smallCaps=t}getProp(e){return e.smallCaps}maskValue(){return ie.UseSmallCaps}getHistoryItemConstructor(){return Ut}getJSONProperty(){return v.SmallCaps}},ir.ALL_FIELDS=[ir.allCaps,ir.size,ir.bold,ir.italic,ir.fontInfo,ir.script,ir.strikeoutType,ir.underlineType,ir.underlineWordsOnly,ir.strikeoutWordsOnly,ir.noProof,ir.hidden,ir.langInfo,ir.compositeFontInfo,ir.textColor,ir.shadingInfo,ir.highlightColor,ir.strikeoutColor,ir.underlineColor,ir.smallCaps],ir.whatNeedSetWhenCreateHyperlinkField=[ir.size,ir.bold,ir.italic,ir.fontInfo,ir.script,ir.strikeoutType,ir.allCaps,ir.underlineWordsOnly,ir.strikeoutWordsOnly,ir.noProof,ir.hidden,ir.shadingInfo,ir.strikeoutColor,ir.underlineColor,ir.langInfo,ir.smallCaps];class nr{getHashCode(){return P.MathUtils.somePrimes[10]*this.top.getHashCode()^P.MathUtils.somePrimes[11]*this.right.getHashCode()^P.MathUtils.somePrimes[12]*this.bottom.getHashCode()^P.MathUtils.somePrimes[13]*this.left.getHashCode()}equals(e){return!!e&&(this.bottom.equals(e.bottom)&&this.left.equals(e.left)&&this.right.equals(e.right)&&this.top.equals(e.top))}copyFrom(e){this.bottom=e.bottom.clone(),this.left=e.left.clone(),this.right=e.right.clone(),this.top=e.top.clone()}}class or extends nr{equals(e){return super.equals(e)&&this.topLeftDiagonal.equals(e.topLeftDiagonal)&&this.topRightDiagonal.equals(e.topRightDiagonal)}copyFrom(e){super.copyFrom(e),this.topLeftDiagonal=e.topLeftDiagonal.clone(),this.topRightDiagonal=e.topRightDiagonal.clone()}clone(){var e=new or;return e.copyFrom(this),e}static create(e,t,r,i,n,o){let a=new or;return a.top=e,a.right=t,a.bottom=r,a.left=i,a.topLeftDiagonal=n,a.topRightDiagonal=o,a}}class ar{equals(e){return!!e&&(this.top.equals(e.top)&&this.right.equals(e.right)&&this.left.equals(e.left)&&this.bottom.equals(e.bottom))}copyFrom(e){this.top=e.top.clone(),this.right=e.right.clone(),this.left=e.left.clone(),this.bottom=e.bottom.clone()}clone(){var e=new ar;return e.copyFrom(this),e}static create(e,t,r,i){let n=new ar;return n.top=e,n.right=t,n.bottom=r,n.left=i,n}}!function(e){e[e.Fixed=0]="Fixed",e[e.Autofit=1]="Autofit"}(Oe||(Oe={})),function(e){e[e.None=0]="None",e[e.ApplyFirstRow=32]="ApplyFirstRow",e[e.ApplyLastRow=64]="ApplyLastRow",e[e.ApplyFirstColumn=128]="ApplyFirstColumn",e[e.ApplyLastColumn=256]="ApplyLastColumn",e[e.DoNotApplyRowBanding=512]="DoNotApplyRowBanding",e[e.DoNotApplyColumnBanding=1024]="DoNotApplyColumnBanding"}(_e||(_e={})),function(e){e[e.None=0]="None",e[e.Center=1]="Center",e[e.Inside=2]="Inside",e[e.Left=3]="Left",e[e.Outside=4]="Outside",e[e.Right=5]="Right"}(Ue||(Ue={})),function(e){e[e.None=0]="None",e[e.Bottom=1]="Bottom",e[e.Center=2]="Center",e[e.Inline=3]="Inline",e[e.Inside=4]="Inside",e[e.Outside=5]="Outside",e[e.Top=6]="Top"}(He||(He={})),function(e){e[e.Margin=0]="Margin",e[e.Page=1]="Page",e[e.Column=2]="Column"}(Ve||(Ve={})),function(e){e[e.Margin=0]="Margin",e[e.Page=1]="Page",e[e.Paragraph=2]="Paragraph"}(We||(We={})),function(e){e[e.Never=0]="Never",e[e.Around=1]="Around"}(ze||(ze={})),function(e){e[e.Both=0]="Both",e[e.Center=1]="Center",e[e.Distribute=2]="Distribute",e[e.Left=3]="Left",e[e.NumTab=4]="NumTab",e[e.Right=5]="Right"}(je||(je={})),function(e){e[e.None=0]="None",e[e.Continue=1]="Continue",e[e.Restart=2]="Restart"}(Xe||(Xe={})),function(e){e[e.LeftToRightTopToBottom=0]="LeftToRightTopToBottom",e[e.TopToBottomRightToLeft=1]="TopToBottomRightToLeft",e[e.TopToBottomLeftToRightRotated=2]="TopToBottomLeftToRightRotated",e[e.BottomToTopLeftToRight=3]="BottomToTopLeftToRight",e[e.LeftToRightTopToBottomRotated=4]="LeftToRightTopToBottomRotated",e[e.TopToBottomRightToLeftRotated=5]="TopToBottomRightToLeftRotated"}(Ge||(Ge={})),function(e){e[e.Top=0]="Top",e[e.Both=1]="Both",e[e.Center=2]="Center",e[e.Bottom=3]="Bottom"}(Ke||(Ke={})),function(e){e[e.WholeTable=4096]="WholeTable",e[e.FirstRow=2048]="FirstRow",e[e.LastRow=1024]="LastRow",e[e.FirstColumn=512]="FirstColumn",e[e.LastColumn=256]="LastColumn",e[e.OddColumnBanding=128]="OddColumnBanding",e[e.EvenColumnBanding=64]="EvenColumnBanding",e[e.OddRowBanding=32]="OddRowBanding",e[e.EvenRowBanding=16]="EvenRowBanding",e[e.TopRightCell=8]="TopRightCell",e[e.TopLeftCell=4]="TopLeftCell",e[e.BottomRightCell=2]="BottomRightCell",e[e.BottomLeftCell=1]="BottomLeftCell"}(qe||(qe={}));class sr{getHashCode(){return P.MathUtils.somePrimes[0]*this.value^P.MathUtils.somePrimes[1]*this.type}equals(e){return!!e&&(this.value==e.value&&this.type==e.type)}copyFrom(e){this.value=e.value,this.type=e.type}}class lr extends sr{static createDefault(){return(new lr).init(0,Je.Nil)}static create(e,t){return(new lr).init(e,t)}init(e,t){return this.value=Math.floor(e),this.type=t,this}clone(){return(new lr).init(this.value,this.type)}asNumberNoPercentType(e){switch(this.type){case Je.Nil:case Je.Auto:return 0;case Je.ModelUnits:return e(this.value);case Je.FiftiethsOfPercent:return 0}}asNumber(e,t){switch(this.type){case Je.Nil:case Je.Auto:return 0;case Je.ModelUnits:return t(this.value);case Je.FiftiethsOfPercent:return e*this.value/lr.MAX_PERCENT_WIDTH}}divide(e){e>1&&(this.value=Math.floor(this.value/e))}}lr.MAX_PERCENT_WIDTH=5e3,lr.MULTIPLIER_FOR_PERCENTS=50;class dr extends sr{init(e,t){return this.value=Math.floor(e),this.type=t,this}clone(){return(new dr).init(this.value,this.type)}static create(e,t){return(new dr).init(e,t)}static createDefault(){return(new dr).init(0,$e.Auto)}}!function(e){e[e.Minimum=0]="Minimum",e[e.Auto=1]="Auto",e[e.Exact=2]="Exact"}($e||($e={})),function(e){e[e.Nil=0]="Nil",e[e.Auto=1]="Auto",e[e.FiftiethsOfPercent=2]="FiftiethsOfPercent",e[e.ModelUnits=3]="ModelUnits"}(Je||(Je={}));class cr{constructor(){this.mask=Ye.UseNone,this.cellMargins=ar.create(lr.createDefault(),lr.createDefault(),lr.createDefault(),lr.createDefault()),this.borders=or.create(new Me,new Me,new Me,new Me,new Me,new Me),this.hideCellMark=!1,this.noWrap=!1,this.fitText=!1,this.textDirection=Ge.LeftToRightTopToBottom,this.verticalAlignment=Ke.Top,this.shadingInfo=fe.noColor}calculateHash(){return P.MathUtils.somePrimes[0]*this.mask^P.MathUtils.somePrimes[1]*this.borders.getHashCode()^P.MathUtils.somePrimes[2]*this.verticalAlignment^P.MathUtils.somePrimes[3]*this.shadingInfo.getHashCode()}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}equals(e){return!!e&&(this.mask==e.mask&&this.cellMargins.equals(e.cellMargins)&&this.borders.equals(e.borders)&&this.hideCellMark==e.hideCellMark&&this.noWrap==e.noWrap&&this.fitText==e.fitText&&this.textDirection==e.textDirection&&this.verticalAlignment==e.verticalAlignment&&this.shadingInfo.equals(e.shadingInfo))}clone(){var e=new cr;return e.copyFrom(this),e}copyFrom(e){this.mask=e.mask,this.cellMargins=e.cellMargins.clone(),this.borders=e.borders.clone(),this.hideCellMark=e.hideCellMark,this.noWrap=e.noWrap,this.fitText=e.fitText,this.textDirection=e.textDirection,this.verticalAlignment=e.verticalAlignment,e.shadingInfo&&(this.shadingInfo=e.shadingInfo.clone())}setUseValue(e,t){t?this.mask|=e:this.mask&=~e}getUseValue(e){return!!(this.mask&e)}setValue(e,t){e.setProp(this,t),this.setUseValue(e.maskValue(),!0)}}!function(e){e[e.UseNone=0]="UseNone",e[e.UseHideCellMark=2]="UseHideCellMark",e[e.UseNoWrap=4]="UseNoWrap",e[e.UseFitText=8]="UseFitText",e[e.UseLeftMargin=16]="UseLeftMargin",e[e.UseRightMargin=32]="UseRightMargin",e[e.UseTopMargin=64]="UseTopMargin",e[e.UseBottomMargin=128]="UseBottomMargin",e[e.UseTextDirection=256]="UseTextDirection",e[e.UseVerticalAlignment=512]="UseVerticalAlignment",e[e.UseCellConditionalFormatting=2048]="UseCellConditionalFormatting",e[e.UseLeftBorder=4096]="UseLeftBorder",e[e.UseRightBorder=8192]="UseRightBorder",e[e.UseTopBorder=16384]="UseTopBorder",e[e.UseBottomBorder=32768]="UseBottomBorder",e[e.UseTopLeftDiagonalBorder=262144]="UseTopLeftDiagonalBorder",e[e.UseTopRightDiagonalBorder=524288]="UseTopRightDiagonalBorder",e[e.UseShadingInfoIndex=1048576]="UseShadingInfoIndex",e[e.UseAll=2147483647]="UseAll"}(Ye||(Ye={}));class hr{}hr.topBorder=new class{setProp(e,t){e.borders.top=t}getProp(e){return e.borders.top}maskValue(){return Ye.UseTopBorder}},hr.rightBorder=new class{setProp(e,t){e.borders.right=t}getProp(e){return e.borders.right}maskValue(){return Ye.UseRightBorder}},hr.bottomBorder=new class{setProp(e,t){e.borders.bottom=t}getProp(e){return e.borders.bottom}maskValue(){return Ye.UseBottomBorder}},hr.leftBorder=new class{setProp(e,t){e.borders.left=t}getProp(e){return e.borders.left}maskValue(){return Ye.UseLeftBorder}},hr.topLeftDiagonalBorder=new class{setProp(e,t){e.borders.topLeftDiagonal=t}getProp(e){return e.borders.topLeftDiagonal}maskValue(){return Ye.UseTopLeftDiagonalBorder}},hr.topRightDiagonalBorder=new class{setProp(e,t){e.borders.topRightDiagonal=t}getProp(e){return e.borders.topRightDiagonal}maskValue(){return Ye.UseTopRightDiagonalBorder}},hr.topMargin=new class{setProp(e,t){e.cellMargins.top=t}getProp(e){return e.cellMargins.top}maskValue(){return Ye.UseTopMargin}},hr.rightMargin=new class{setProp(e,t){e.cellMargins.right=t}getProp(e){return e.cellMargins.right}maskValue(){return Ye.UseRightMargin}},hr.bottomMargin=new class{setProp(e,t){e.cellMargins.bottom=t}getProp(e){return e.cellMargins.bottom}maskValue(){return Ye.UseBottomMargin}},hr.leftMargin=new class{setProp(e,t){e.cellMargins.left=t}getProp(e){return e.cellMargins.left}maskValue(){return Ye.UseLeftMargin}},hr.fitText=new class{setProp(e,t){e.fitText=t}getProp(e){return e.fitText}maskValue(){return Ye.UseFitText}},hr.hideCellMark=new class{setProp(e,t){e.hideCellMark=t}getProp(e){return e.hideCellMark}maskValue(){return Ye.UseHideCellMark}},hr.noWrap=new class{setProp(e,t){e.noWrap=t}getProp(e){return e.noWrap}maskValue(){return Ye.UseNoWrap}},hr.shadingInfo=new class{setProp(e,t){e.shadingInfo=t}getProp(e){return e.shadingInfo}maskValue(){return Ye.UseShadingInfoIndex}},hr.textDirection=new class{setProp(e,t){e.textDirection=t}getProp(e){return e.textDirection}maskValue(){return Ye.UseTextDirection}},hr.vertivalAlignment=new class{setProp(e,t){e.verticalAlignment=t}getProp(e){return e.verticalAlignment}maskValue(){return Ye.UseVerticalAlignment}},hr.ALL_FIELDS=[hr.topBorder,hr.rightBorder,hr.bottomBorder,hr.leftBorder,hr.topLeftDiagonalBorder,hr.topRightDiagonalBorder,hr.topMargin,hr.rightMargin,hr.bottomMargin,hr.leftMargin,hr.fitText,hr.hideCellMark,hr.noWrap,hr.shadingInfo,hr.textDirection,hr.vertivalAlignment];var ur,pr=__webpack_require__(7820);class gr extends nr{getHashCode(){return super.getHashCode()^P.MathUtils.somePrimes[14]*this.insideHorizontal.getHashCode()^P.MathUtils.somePrimes[15]*this.insideVertical.getHashCode()}equals(e){return super.equals(e)&&this.insideHorizontal.equals(e.insideHorizontal)&&this.insideVertical.equals(e.insideVertical)}copyFrom(e){super.copyFrom(e),this.insideHorizontal=e.insideHorizontal.clone(),this.insideVertical=e.insideVertical.clone()}clone(){var e=new gr;return e.copyFrom(this),e}static create(e,t,r,i,n,o){let a=new gr;return a.top=e,a.right=t,a.bottom=r,a.left=i,a.insideHorizontal=n,a.insideVertical=o,a}}class mr{constructor(){this.mask=0,this.cellMargins=ar.create(lr.createDefault(),lr.createDefault(),lr.createDefault(),lr.createDefault()),this.cellSpacing=lr.createDefault(),this.indent=lr.createDefault(),this.borders=gr.create(new Me,new Me,new Me,new Me,new Me,new Me),this.tableStyleColumnBandSize=1,this.tableStyleRowBandSize=1,this.avoidDoubleBorders=!1,this.layoutType=Oe.Autofit,this.shadingInfo=fe.noColor,this.tableRowAlignment=je.Left,this.isTableOverlap=!0,this.bottomFromText=0,this.leftFromText=0,this.topFromText=0,this.rightFromText=0,this.tableHorizontalPosition=0,this.tableVerticalPosition=0,this.horizontalAlignMode=Ue.None,this.verticalAlignMode=He.None,this.horizontalAnchorType=Ve.Page,this.verticalAnchorType=We.Page,this.textWrapping=ze.Never}calculateHash(){return P.MathUtils.somePrimes[0]*this.mask^P.MathUtils.somePrimes[1]*this.borders.getHashCode()^P.MathUtils.somePrimes[2]*this.indent.getHashCode()^P.MathUtils.somePrimes[3]*this.tableRowAlignment^P.MathUtils.somePrimes[4]*this.shadingInfo.getHashCode()}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}equals(e){return!!e&&(this.mask==e.mask&&this.cellMargins.equals(e.cellMargins)&&this.cellSpacing.equals(e.cellSpacing)&&this.indent.equals(e.indent)&&this.borders.equals(e.borders)&&this.tableStyleColumnBandSize==e.tableStyleColumnBandSize&&this.tableStyleRowBandSize==e.tableStyleRowBandSize&&this.isTableOverlap==e.isTableOverlap&&this.avoidDoubleBorders==e.avoidDoubleBorders&&this.layoutType==e.layoutType&&this.shadingInfo.equals(e.shadingInfo)&&this.tableRowAlignment==e.tableRowAlignment&&this.bottomFromText==e.bottomFromText&&this.leftFromText==e.leftFromText&&this.topFromText==e.topFromText&&this.rightFromText==e.rightFromText&&this.tableHorizontalPosition==e.tableHorizontalPosition&&this.tableVerticalPosition==e.tableVerticalPosition&&this.horizontalAlignMode==e.horizontalAlignMode&&this.verticalAlignMode==e.verticalAlignMode&&this.horizontalAnchorType==e.horizontalAnchorType&&this.verticalAnchorType==e.verticalAnchorType&&this.textWrapping==e.textWrapping)}clone(){var e=new mr;return e.copyFrom(this),e}copyFrom(e){this.mask=e.mask,this.cellMargins=e.cellMargins.clone(),this.cellSpacing=e.cellSpacing.clone(),this.indent=e.indent.clone(),this.borders=e.borders.clone(),this.tableStyleColumnBandSize=e.tableStyleColumnBandSize,this.tableStyleRowBandSize=e.tableStyleRowBandSize,this.isTableOverlap=e.isTableOverlap,this.avoidDoubleBorders=e.avoidDoubleBorders,this.layoutType=e.layoutType,e.shadingInfo&&(this.shadingInfo=e.shadingInfo.clone()),this.tableRowAlignment=e.tableRowAlignment,this.bottomFromText=e.bottomFromText,this.leftFromText=e.leftFromText,this.topFromText=e.topFromText,this.rightFromText=e.rightFromText,this.tableHorizontalPosition=e.tableHorizontalPosition,this.tableVerticalPosition=e.tableVerticalPosition,this.horizontalAlignMode=e.horizontalAlignMode,this.verticalAlignMode=e.verticalAlignMode,this.horizontalAnchorType=e.horizontalAnchorType,this.verticalAnchorType=e.verticalAnchorType,this.textWrapping=e.textWrapping}setUseValue(e,t){t?this.mask|=e:this.mask&=~e}getUseValue(e){return!!(this.mask&e)}setValue(e,t){e.setProp(this,t),this.setUseValue(e.maskValue(),!0)}}!function(e){e[e.UseNone=0]="UseNone",e[e.UseLeftMargin=1]="UseLeftMargin",e[e.UseRightMargin=2]="UseRightMargin",e[e.UseTopMargin=4]="UseTopMargin",e[e.UseBottomMargin=8]="UseBottomMargin",e[e.UseCellSpacing=16]="UseCellSpacing",e[e.UseTableIndent=32]="UseTableIndent",e[e.UseTableLayout=64]="UseTableLayout",e[e.UseTableStyleColBandSize=512]="UseTableStyleColBandSize",e[e.UseTableStyleRowBandSize=1024]="UseTableStyleRowBandSize",e[e.UseIsTableOverlap=2048]="UseIsTableOverlap",e[e.UseFloatingPosition=4096]="UseFloatingPosition",e[e.UseLeftBorder=8192]="UseLeftBorder",e[e.UseRightBorder=16384]="UseRightBorder",e[e.UseTopBorder=32768]="UseTopBorder",e[e.UseBottomBorder=65536]="UseBottomBorder",e[e.UseInsideHorizontalBorder=131072]="UseInsideHorizontalBorder",e[e.UseInsideVerticalBorder=262144]="UseInsideVerticalBorder",e[e.UseShadingInfoIndex=524288]="UseShadingInfoIndex",e[e.UseTableAlignment=1048576]="UseTableAlignment",e[e.UseAvoidDoubleBorders=2097152]="UseAvoidDoubleBorders",e[e.UseRightToLeft=4194304]="UseRightToLeft",e[e.UseAll=2147483647]="UseAll"}(ur||(ur={}));class fr{}fr.avoidDoubleBorders=new class{setProp(e,t){e.avoidDoubleBorders=t}getProp(e){return e.avoidDoubleBorders}maskValue(){return ur.UseAvoidDoubleBorders}},fr.topBorder=new class{setProp(e,t){e.borders.top=t}getProp(e){return e.borders.top}maskValue(){return ur.UseTopBorder}},fr.rightBorder=new class{setProp(e,t){e.borders.right=t}getProp(e){return e.borders.right}maskValue(){return ur.UseRightBorder}},fr.bottomBorder=new class{setProp(e,t){e.borders.bottom=t}getProp(e){return e.borders.bottom}maskValue(){return ur.UseBottomBorder}},fr.leftBorder=new class{setProp(e,t){e.borders.left=t}getProp(e){return e.borders.left}maskValue(){return ur.UseLeftBorder}},fr.insideHorizontalBorder=new class{setProp(e,t){e.borders.insideHorizontal=t}getProp(e){return e.borders.insideHorizontal}maskValue(){return ur.UseInsideHorizontalBorder}},fr.insideVerticalBorder=new class{setProp(e,t){e.borders.insideVertical=t}getProp(e){return e.borders.insideVertical}maskValue(){return ur.UseInsideVerticalBorder}},fr.topMargin=new class{setProp(e,t){e.cellMargins.top=t}getProp(e){return e.cellMargins.top}maskValue(){return ur.UseTopMargin}},fr.rightMargin=new class{setProp(e,t){e.cellMargins.right=t}getProp(e){return e.cellMargins.right}maskValue(){return ur.UseRightMargin}},fr.bottomMargin=new class{setProp(e,t){e.cellMargins.bottom=t}getProp(e){return e.cellMargins.bottom}maskValue(){return ur.UseBottomMargin}},fr.leftMargin=new class{setProp(e,t){e.cellMargins.left=t}getProp(e){return e.cellMargins.left}maskValue(){return ur.UseLeftMargin}},fr.cellSpacing=new class{setProp(e,t){e.cellSpacing=t}getProp(e){return e.cellSpacing}maskValue(){return ur.UseCellSpacing}},fr.indent=new class{setProp(e,t){e.indent=t}getProp(e){return e.indent}maskValue(){return ur.UseTableIndent}},fr.layoutType=new class{setProp(e,t){e.layoutType=t}getProp(e){return e.layoutType}maskValue(){return ur.UseTableLayout}},fr.shadingInfo=new class{setProp(e,t){e.shadingInfo=t}getProp(e){return e.shadingInfo}maskValue(){return ur.UseShadingInfoIndex}},fr.rowAlignment=new class{setProp(e,t){e.tableRowAlignment=t}getProp(e){return e.tableRowAlignment}maskValue(){return ur.UseTableAlignment}},fr.styleColumnBandSize=new class{setProp(e,t){e.tableStyleColumnBandSize=t}getProp(e){return e.tableStyleColumnBandSize}maskValue(){return ur.UseTableStyleColBandSize}},fr.styleRowBandSize=new class{setProp(e,t){e.tableStyleRowBandSize=t}getProp(e){return e.tableStyleRowBandSize}maskValue(){return ur.UseTableStyleRowBandSize}},fr.ALL_FIELDS=[fr.avoidDoubleBorders,fr.topBorder,fr.rightBorder,fr.bottomBorder,fr.leftBorder,fr.insideHorizontalBorder,fr.insideVerticalBorder,fr.topMargin,fr.rightMargin,fr.bottomMargin,fr.leftMargin,fr.cellSpacing,fr.indent,fr.layoutType,fr.shadingInfo,fr.rowAlignment,fr.styleColumnBandSize,fr.styleRowBandSize];class br{getProperty(e,t,r,i){if(this.getPropertyInternal(e))return this.result;if(this.processTablePropertiesException())return this.result;for(;t;){const e=this.getCondTableStyleFormattingListForThisContainer();for(let i of e)if(r&i){const e=t.conditionalStyles[i];if(e&&this.getPropertyInternal(this.getContainerFromConditionalStyle(e)))return this.result}const i=this.getContainerFromConditionalStyle(t.baseConditionalStyle);if(i&&this.getPropertyInternal(i))return this.result;t=t.parent}return this.actionBeforeDefaultValue()?this.result:this.getPropertyFromContainer(i)}processTablePropertiesException(){if(!this.tablePropertiesException)return!1;const e=this.getNotMergedProperty();return!!e.isFound&&(this.result=e.result,!0)}getPropertyInternal(e){return!!this.canUseValue(e)&&(this.result=this.getPropertyFromContainer(e),!0)}actionBeforeDefaultValue(){return!1}}class Cr{constructor(e,t){this.isFound=e,this.result=t}}class Sr extends br{getContainerFromConditionalStyle(e){return e.tableProperties}canUseValue(e){return!!(e.mask&this.getPropertyMask())}getCondTableStyleFormattingListForThisContainer(){return Sr.conditionalTableStyleFormattingPriority}getTableNotMergedProperty(e){return this.canUseValue(e)?new Cr(!0,this.getPropertyFromContainer(e)):new Cr(!1,null)}getNotMergedProperty(){return this.getTableNotMergedProperty(this.tablePropertiesException)}}Sr.conditionalTableStyleFormattingPriority=[qe.WholeTable];class Ir extends Sr{getPropertyFromContainer(e){return e.indent}getPropertyMask(){return ur.UseTableIndent}}class Pr extends Sr{getPropertyFromContainer(e){return e.cellSpacing}getPropertyMask(){return ur.UseCellSpacing}}class wr extends Sr{constructor(e){super(),this.isTableOuterBorder=e}getPropertiesMaskCore(e){if(this.isTableOuterBorder)return e;const t=new pr.Flag(e);return(t.get(ur.UseLeftBorder)||t.get(ur.UseRightBorder))&&t.set(ur.UseInsideVerticalBorder,!0),(t.get(ur.UseTopBorder)||t.get(ur.UseBottomBorder))&&t.set(ur.UseInsideHorizontalBorder,!0),t.set(ur.UseLeftBorder,!1),t.set(ur.UseRightBorder,!1),t.set(ur.UseTopBorder,!1),t.set(ur.UseBottomBorder,!1),t.getValue()}}class yr extends wr{constructor(e=!0){super(e)}getPropertyFromContainer(e){return e.borders.left}getPropertyMask(){return super.getPropertiesMaskCore(ur.UseLeftBorder)}}class xr extends wr{constructor(e=!0){super(e)}getPropertyFromContainer(e){return e.borders.right}getPropertyMask(){return super.getPropertiesMaskCore(ur.UseRightBorder)}}class Tr extends wr{constructor(e=!0){super(e)}getPropertyFromContainer(e){return e.borders.top}getPropertyMask(){return super.getPropertiesMaskCore(ur.UseTopBorder)}}class vr extends wr{constructor(e=!0){super(e)}getPropertyFromContainer(e){return e.borders.bottom}getPropertyMask(){return super.getPropertiesMaskCore(ur.UseBottomBorder)}}class Mr extends Sr{getPropertyFromContainer(e){return e.borders.insideVertical}getPropertyMask(){return ur.UseInsideVerticalBorder}}class Er extends Sr{getPropertyFromContainer(e){return e.borders.insideHorizontal}getPropertyMask(){return ur.UseInsideHorizontalBorder}}class Dr extends Sr{getPropertyFromContainer(e){return e.cellMargins.left}getPropertyMask(){return ur.UseLeftMargin}}class Fr extends Sr{getPropertyFromContainer(e){return e.cellMargins.right}getPropertyMask(){return ur.UseRightMargin}}class Rr extends Sr{getPropertyFromContainer(e){return e.cellMargins.top}getPropertyMask(){return ur.UseTopMargin}}class Lr extends Sr{getPropertyFromContainer(e){return e.cellMargins.bottom}getPropertyMask(){return ur.UseBottomMargin}}class Br extends Sr{getPropertyFromContainer(e){return e.layoutType}getPropertyMask(){return ur.UseTableLayout}}class Ar extends Sr{getPropertyFromContainer(e){return e.shadingInfo}getPropertyMask(){return ur.UseShadingInfoIndex}}class Nr extends Sr{getPropertyFromContainer(e){return e.tableStyleColumnBandSize}getPropertyMask(){return ur.UseTableStyleColBandSize}}class kr extends Sr{getPropertyFromContainer(e){return e.tableStyleRowBandSize}getPropertyMask(){return ur.UseTableStyleRowBandSize}}class Or extends Sr{getPropertyFromContainer(e){return e.tableRowAlignment}getPropertyMask(){return ur.UseTableAlignment}actionBeforeDefaultValue(){return this.result=je.Left,!0}}class _r extends br{getContainerFromConditionalStyle(e){return e.tableCellProperties}canUseValue(e){return!!(e.mask&this.getPropertyMask())}getCondTableStyleFormattingListForThisContainer(){return _r.conditionalTableStyleFormattingPriority}getNotMergedProperty(){return new Cr(!1,null)}}_r.conditionalTableStyleFormattingPriority=[qe.TopLeftCell,qe.TopRightCell,qe.BottomLeftCell,qe.BottomRightCell,qe.FirstRow,qe.LastRow,qe.FirstColumn,qe.LastColumn,qe.EvenColumnBanding,qe.OddColumnBanding,qe.EvenRowBanding,qe.OddRowBanding,qe.WholeTable];class Ur extends _r{constructor(e,t,r){super(),this.table=e,this.model=t,this.tablePropertiesException=r}actionBeforeDefaultValue(){return this.result=this.getMarginMerger().getProperty(this.table.properties,this.table.style,qe.WholeTable,this.model.defaultTableProperties),!0}getNotMergedProperty(){return this.getMarginMerger().getTableNotMergedProperty(this.tablePropertiesException)}}class Hr extends Ur{getPropertyMask(){return Ye.UseLeftMargin}getPropertyFromContainer(e){return e.cellMargins.left}getMarginMerger(){return new Dr}}class Vr extends Ur{getPropertyMask(){return Ye.UseRightMargin}getPropertyFromContainer(e){return e.cellMargins.right}getMarginMerger(){return new Fr}}class Wr extends Ur{getPropertyMask(){return Ye.UseTopMargin}getPropertyFromContainer(e){return e.cellMargins.top}getMarginMerger(){return new Rr}}class zr extends Ur{getPropertyMask(){return Ye.UseBottomMargin}getPropertyFromContainer(e){return e.cellMargins.bottom}getMarginMerger(){return new Lr}}class jr extends _r{constructor(e){super(),this.tablePropertiesException=e}actionBeforeDefaultValue(){return this.result=null,!0}}class Xr extends jr{constructor(e,t){super(e),this.isOutsideBorder=t}getPropertyFromContainer(e){return e.borders.left}getPropertyMask(){return Ye.UseLeftBorder}getNotMergedProperty(){return(new(this.isOutsideBorder?yr:Mr)).getTableNotMergedProperty(this.tablePropertiesException)}}class Gr extends jr{constructor(e,t){super(e),this.isOutsideBorder=t}getPropertyFromContainer(e){return e.borders.right}getPropertyMask(){return Ye.UseRightBorder}getNotMergedProperty(){return(new(this.isOutsideBorder?xr:Mr)).getTableNotMergedProperty(this.tablePropertiesException)}}class Kr extends jr{constructor(e,t){super(e),this.isOutsideBorder=t}getPropertyFromContainer(e){return e.borders.top}getPropertyMask(){return Ye.UseTopBorder}getNotMergedProperty(){return(new(this.isOutsideBorder?Tr:Er)).getTableNotMergedProperty(this.tablePropertiesException)}}class qr extends jr{constructor(e,t){super(e),this.isOutsideBorder=t}getPropertyFromContainer(e){return e.borders.bottom}getPropertyMask(){return Ye.UseBottomBorder}getNotMergedProperty(){return(new(this.isOutsideBorder?vr:Er)).getTableNotMergedProperty(this.tablePropertiesException)}}class $r extends jr{getPropertyFromContainer(e){return e.borders.topLeftDiagonal}getPropertyMask(){return Ye.UseTopLeftDiagonalBorder}}class Jr extends jr{getPropertyFromContainer(e){return e.borders.topRightDiagonal}getPropertyMask(){return Ye.UseTopRightDiagonalBorder}}class Yr extends _r{getPropertyFromContainer(e){return e.noWrap}getPropertyMask(){return Ye.UseNoWrap}}class Qr extends _r{getPropertyFromContainer(e){return e.shadingInfo}getPropertyMask(){return Ye.UseShadingInfoIndex}}class Zr extends _r{getPropertyFromContainer(e){return e.verticalAlignment}getPropertyMask(){return Ye.UseVerticalAlignment}}class ei extends br{getContainerFromConditionalStyle(e){return e.maskedCharacterProperties}canUseValue(e){return!!e.getUseValue(this.getPropertyMask())}getCondTableStyleFormattingListForThisContainer(){return _r.conditionalTableStyleFormattingPriority}actionBeforeDefaultValue(){return this.result=null,!0}getNotMergedProperty(){return new Cr(!1,null)}}class ti extends ei{getPropertyFromContainer(e){return e.hidden}getPropertyMask(){return ie.UseHidden}}class ri extends ei{getPropertyFromContainer(e){return e.script}getPropertyMask(){return ie.UseScript}}class ii extends ei{getPropertyFromContainer(e){return e.allCaps}getPropertyMask(){return ie.UseAllCaps}}class ni extends ei{getPropertyFromContainer(e){return e.smallCaps}getPropertyMask(){return ie.UseSmallCaps}}class oi extends ei{getPropertyFromContainer(e){return e.noProof}getPropertyMask(){return ie.UseNoProof}}class ai extends ei{getPropertyFromContainer(e){return e.fontBold}getPropertyMask(){return ie.UseFontBold}}class si extends ei{getPropertyFromContainer(e){return e.fontInfo}getPropertyMask(){return ie.UseFontName}}class li extends ei{getPropertyFromContainer(e){return e.shadingInfo}getPropertyMask(){return ie.UseShadingInfoIndex}}class di extends ei{getPropertyFromContainer(e){return e.textColor}getPropertyMask(){return ie.UseForeColorIndex}}class ci extends ei{getPropertyFromContainer(e){return e.fontSize}getPropertyMask(){return ie.UseDoubleFontSize}}class hi extends ei{getPropertyFromContainer(e){return e.fontItalic}getPropertyMask(){return ie.UseFontItalic}}class ui extends ei{getPropertyFromContainer(e){return e.highlightColor}getPropertyMask(){return ie.UseStrikeoutColorIndex}}class pi extends ei{getPropertyFromContainer(e){return e.strikeoutColor}getPropertyMask(){return ie.UseStrikeoutColorIndex}}class gi extends ei{getPropertyFromContainer(e){return e.underlineColor}getPropertyMask(){return ie.UseUnderlineColorIndex}}class mi extends ei{getPropertyFromContainer(e){return e.fontStrikeoutType}getPropertyMask(){return ie.UseFontStrikeoutType}}class fi extends ei{getPropertyFromContainer(e){return e.fontUnderlineType}getPropertyMask(){return ie.UseFontUnderlineType}}class bi extends ei{getPropertyFromContainer(e){return e.strikeoutWordsOnly}getPropertyMask(){return ie.UseStrikeoutWordsOnly}}class Ci extends ei{getPropertyFromContainer(e){return e.underlineWordsOnly}getPropertyMask(){return ie.UseUnderlineWordsOnly}}class Si{constructor(e,t){this.innerProperties=e,this.descriptors=t}mergeInternal(e,t,r){!this.innerProperties.getUseValue(t)&&e.getUseValue(t)&&(r(),this.innerProperties.setUseValue(t,!0))}mergeOnlyOwnInternal(e,t,r,i,n){!this.innerProperties.getUseValue(r)&&e.getUseValue(r)&&(t.getUseValue(r)&&n()||(i(),this.innerProperties.setUseValue(r,!0)))}mergeTableProperties(e,t){const r=e.maskValue();if(this.innerProperties.getUseValue(r))return;const i=t();null!==i&&(e.setProp(this.innerProperties,i),this.innerProperties.setUseValue(r,!0))}mergeAll(e){if(e){const t=this.innerProperties;for(let r of this.descriptors){const i=r.maskValue();!t.getUseValue(i)&&e.getUseValue(i)&&(r.setProp(t,r.getProp(e)),t.setUseValue(i,!0))}}}mergeOnlyOwnProperties(e,t){const r=this.innerProperties;for(let i of this.descriptors){const n=i.maskValue();if(!r.getUseValue(n)&&e.getUseValue(n)){if(t.getUseValue(n)&&i.binaryEquals(i.getProp(e),i.getProp(t)))continue;i.setProp(r,i.getProp(e)),r.setUseValue(n,!0)}}}}class Ii extends Si{constructor(){super(new Pe,ir.ALL_FIELDS)}mergeCharacterProperties(e){this.mergeAll(e)}mergeOnlyOwnCharacterProperties(e,t){this.mergeOnlyOwnProperties(e,t)}mergeMergedCharacterProperties(e){var t=new Pe;t.copyFrom(e),t.setAllUse(),this.mergeAll(t)}mergeCharacterStyle(e){for(var t=e;t;)this.mergeAll(t.maskedCharacterProperties),t=t.parent}mergeParagraphStyle(e){for(var t=e;t;)this.mergeAll(t.maskedCharacterProperties),t=t.parent}mergeTableStyles(e){const t=e.parentRow.parentTable.style,r=new Pe;r.resetAllUse(),this.mergeTableProperties(ir.hidden,(()=>(new ti).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.script,(()=>(new ri).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.allCaps,(()=>(new ii).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.smallCaps,(()=>(new ni).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.noProof,(()=>(new oi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.bold,(()=>(new ai).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.fontInfo,(()=>(new si).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.size,(()=>(new ci).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.italic,(()=>(new hi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.strikeoutType,(()=>(new mi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.underlineType,(()=>(new fi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.strikeoutWordsOnly,(()=>(new bi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.underlineWordsOnly,(()=>(new Ci).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.textColor,(()=>(new di).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.shadingInfo,(()=>(new li).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.highlightColor,(()=>(new ui).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.strikeoutColor,(()=>(new pi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(ir.underlineColor,(()=>(new gi).getProperty(r,t,e.conditionalFormatting,null)))}getMergedProperties(){const e=new Ie;return e.copyFrom(this.innerProperties),e}}class Pi extends br{getContainerFromConditionalStyle(e){return e.maskedParagraphProperties}canUseValue(e){return!!(e.useValue&this.getPropertyMask())}getCondTableStyleFormattingListForThisContainer(){return _r.conditionalTableStyleFormattingPriority}actionBeforeDefaultValue(){return this.result=null,!0}getNotMergedProperty(){return new Cr(!1,null)}}class wi extends Pi{getPropertyFromContainer(e){return e.alignment}getPropertyMask(){return Be.UseAlignment}}class yi extends Pi{getPropertyFromContainer(e){return e.shadingInfo}getPropertyMask(){return Be.UseShadingInfoIndex}}class xi extends Pi{getPropertyFromContainer(e){return e.leftIndent}getPropertyMask(){return Be.UseLeftIndent}}class Ti extends Pi{getPropertyFromContainer(e){return e.rightIndent}getPropertyMask(){return Be.UseRightIndent}}class vi extends Pi{getPropertyFromContainer(e){return e.topBorder}getPropertyMask(){return Be.UseTopBorder}}class Mi extends Pi{getPropertyFromContainer(e){return e.keepWithNext}getPropertyMask(){return Be.UseKeepWithNext}}class Ei extends Pi{getPropertyFromContainer(e){return e.outlineLevel}getPropertyMask(){return Be.UseOutlineLevel}}class Di extends Pi{getPropertyFromContainer(e){return e.spacingAfter}getPropertyMask(){return Be.UseSpacingAfter}}class Fi extends Pi{getPropertyFromContainer(e){return e.leftBorder}getPropertyMask(){return Be.UseLeftBorder}}class Ri extends Pi{getPropertyFromContainer(e){return e.spacingBefore}getPropertyMask(){return Be.UseSpacingBefore}}class Li extends Pi{getPropertyFromContainer(e){return e.rightBorder}getPropertyMask(){return Be.UseRightBorder}}class Bi extends Pi{getPropertyFromContainer(e){return e.bottomBorder}getPropertyMask(){return Be.UseBottomBorder}}class Ai extends Pi{getPropertyFromContainer(e){return e.betweenBorder}getPropertyMask(){return Be.UseBetweenBorder}}class Ni extends Pi{getPropertyFromContainer(e){return e.pageBreakBefore}getPropertyMask(){return Be.UsePageBreakBefore}}class ki extends Pi{getPropertyFromContainer(e){return e.afterAutoSpacing}getPropertyMask(){return Be.UseAfterAutoSpacing}}class Oi extends Pi{getPropertyFromContainer(e){return e.keepLinesTogether}getPropertyMask(){return Be.UseKeepLinesTogether}}class _i extends Pi{getPropertyFromContainer(e){return e.rightToLeft}getPropertyMask(){return Be.UseRightToLeft}}class Ui extends Pi{getPropertyFromContainer(e){return e.beforeAutoSpacing}getPropertyMask(){return Be.UseBeforeAutoSpacing}}class Hi extends Pi{getPropertyFromContainer(e){return e.contextualSpacing}getPropertyMask(){return Be.UseContextualSpacing}}class Vi extends Pi{getPropertyFromContainer(e){return e.widowOrphanControl}getPropertyMask(){return Be.UseWidowOrphanControl}}class Wi extends Pi{getPropertyFromContainer(e){return e.suppressHyphenation}getPropertyMask(){return Be.UseSuppressHyphenation}}class zi extends Pi{getPropertyFromContainer(e){return e.suppressLineNumbers}getPropertyMask(){return Be.UseSuppressLineNumbers}}class ji extends Pi{getPropertyFromContainer(e){return e.firstLineIndent}getPropertyMask(){return Be.UseFirstLineIndent}}class Xi extends Pi{getPropertyFromContainer(e){return e.firstLineIndentType}getPropertyMask(){return Be.UseFirstLineIndent}}class Gi extends Pi{getPropertyFromContainer(e){return e.lineSpacing}getPropertyMask(){return Be.UseLineSpacing}}class Ki extends Pi{getPropertyFromContainer(e){return e.lineSpacingType}getPropertyMask(){return Be.UseLineSpacing}}class qi extends Pi{getPropertyFromContainer(e){return e.divId}getPropertyMask(){return Be.UseDivId}}class $i extends Si{constructor(){super(new Lt,$i.fields)}mergeMaskedParagraphProperties(e){this.merge(e)}mergeOnlyOwnCharacterProperties(e,t){this.mergeOnlyOwnProperties(e,t),this.mergeOnlyOwnInternal(e,t,Be.UseFirstLineIndent,(()=>{this.innerProperties.firstLineIndent=e.firstLineIndent,this.innerProperties.firstLineIndentType=e.firstLineIndentType}),(()=>e.firstLineIndent==t.firstLineIndent&&e.firstLineIndentType==t.firstLineIndentType)),this.mergeOnlyOwnInternal(e,t,Be.UseLineSpacing,(()=>{this.innerProperties.lineSpacing=e.lineSpacing,this.innerProperties.lineSpacingType=e.lineSpacingType}),(()=>e.lineSpacing==t.lineSpacing&&e.lineSpacingType==t.lineSpacingType))}mergeParagraphStyle(e){let t=e;for(;t;)this.merge(t.maskedParagraphProperties),t=t.parent}mergeParagraphStyleConsiderNumbering(e,t){let r=e;for(;r;)this.merge(r.maskedParagraphProperties),r.isInList()&&this.merge(r.getListLevel(t).getParagraphProperties()),r=r.parent}mergeTableStyle(e){const t=e.parentRow.parentTable.style,r=new Lt;r.useValue=Be.UseNone,this.mergeTableProperties(Ft.alignment,(()=>(new wi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.shadingInfo,(()=>(new yi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.leftIndent,(()=>(new xi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.rightIndent,(()=>(new Ti).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.topBorder,(()=>(new vi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.keepWithNext,(()=>(new Mi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.outlineLevel,(()=>(new Ei).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.spacingAfter,(()=>(new Di).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.leftBorder,(()=>(new Fi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.spacingBefore,(()=>(new Ri).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.rightBorder,(()=>(new Li).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.bottomBorder,(()=>(new Bi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.betweenBorder,(()=>(new Ai).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.pageBreakBefore,(()=>(new Ni).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.afterAutoSpacing,(()=>(new ki).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.keepLinesTogether,(()=>(new Oi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.beforeAutoSpacing,(()=>(new Ui).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.contextualSpacing,(()=>(new Hi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.widowOrphanControl,(()=>(new Vi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.suppressHyphenation,(()=>(new Wi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.suppressLineNumbers,(()=>(new zi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.firstLineIndent,(()=>(new ji).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.firstLineIndentType,(()=>(new Xi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.lineSpacing,(()=>(new Gi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.lineSpacingType,(()=>(new Ki).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.divId,(()=>(new qi).getProperty(r,t,e.conditionalFormatting,null))),this.mergeTableProperties(Ft.rightToLeft,(()=>(new _i).getProperty(r,t,e.conditionalFormatting,null)))}getMergedProperties(){const e=new Rt;return e.copyFrom(this.innerProperties),e}merge(e){e&&(this.mergeAll(e),this.mergeInternal(e,Be.UseFirstLineIndent,(()=>{this.innerProperties.firstLineIndent=e.firstLineIndent,this.innerProperties.firstLineIndentType=e.firstLineIndentType})),this.mergeInternal(e,Be.UseLineSpacing,(()=>{this.innerProperties.lineSpacing=e.lineSpacing,this.innerProperties.lineSpacingType=e.lineSpacingType})))}}$i.fields=f.ListUtils.reducedMap(Ft.ALL_FIELDS,(e=>I.Y.isAnyOf(e.maskValue(),Be.UseFirstLineIndent,Be.UseLineSpacing)?null:e));class Ji{constructor(e,t,r,i){this.documentModel=e,this.setCharacterProperties(t),this.setParagraphProperties(r),this.setListLevelProperties(i)}getListLevelProperties(){return this.listLevelProperties}setListLevelProperties(e){this.listLevelProperties=this.documentModel.cache.listLevelPropertiesCache.getItem(e)}changeListLevelProperties(e){const t=this.listLevelProperties.clone();e(t),this.setListLevelProperties(t)}getCharacterProperties(){return this.maskedCharacterProperties}getParagraphProperties(){return this.maskedParagraphProperties}setParagraphProperties(e){this.maskedParagraphProperties=this.documentModel.cache.maskedParagraphPropertiesCache.getItem(e)}onParagraphPropertiesChanged(){this.resetParagraphMergedProperties()}resetParagraphMergedProperties(){this.mergedParagraphProperties=null}getParagraphMergedProperties(){if(!this.hasParagraphMergedProperies()){var e=new $i;e.mergeMaskedParagraphProperties(this.maskedParagraphProperties),e.mergeMaskedParagraphProperties(this.documentModel.defaultParagraphProperties),this.mergedParagraphProperties=e.getMergedProperties()}return this.mergedParagraphProperties}setParagraphMergedProperies(e){this.mergedParagraphProperties=this.documentModel.cache.mergedParagraphPropertiesCache.getItem(e)}hasParagraphMergedProperies(){return!!this.mergedParagraphProperties}setCharacterProperties(e){this.maskedCharacterProperties=this.documentModel.cache.maskedCharacterPropertiesCache.getItem(e)}onCharacterPropertiesChanged(){this.resetCharacterMergedProperties()}resetCharacterMergedProperties(){this.mergedCharacterProperties=null}getCharacterMergedProperties(){if(!this.hasCharacterMergedProperies()){var e=new Ii;e.mergeCharacterProperties(this.maskedCharacterProperties),e.mergeCharacterProperties(this.documentModel.defaultCharacterProperties),this.mergedCharacterProperties=e.getMergedProperties()}return this.mergedCharacterProperties}setCharacterMergedProperies(e){this.mergedCharacterProperties=this.documentModel.cache.mergedCharacterPropertiesCache.getItem(e)}hasCharacterMergedProperies(){return!!this.mergedCharacterProperties}equals(e){return e===this||!!e.getCharacterProperties().equals(this.getCharacterProperties())&&(!!e.getParagraphProperties().equals(this.getParagraphProperties())&&!!e.getListLevelProperties().equals(this.getListLevelProperties()))}externallyEquals(e){return e===this||e.getListLevelProperties().displayFormatString==this.getListLevelProperties().displayFormatString&&e.getListLevelProperties().format==this.getListLevelProperties().format&&e.getListLevelProperties().start==this.getListLevelProperties().start&&e.getCharacterProperties().fontBold==this.getCharacterProperties().fontBold&&e.getCharacterProperties().fontItalic==this.getCharacterProperties().fontItalic&&e.getCharacterProperties().fontSize==this.getCharacterProperties().fontSize&&e.getCharacterProperties().textColor.equals(this.getCharacterProperties().textColor)&&e.getCharacterProperties().fontInfo.equals(this.getCharacterProperties().fontInfo)}copyFrom(e){this.setListLevelProperties(e.getListLevelProperties()),this.setCharacterProperties(e.getCharacterProperties()),this.setParagraphProperties(e.getParagraphProperties()),this.onCharacterPropertiesChanged(),this.onParagraphPropertiesChanged()}}class Yi{constructor(e,t){this.overrideStart=!1,this.newStart=1,this.owner=e,this.level=t,this.documentModel=e.documentModel}getListLevelProperties(){return this.getOwnerLevel().getListLevelProperties()}setListLevelProperties(e){this.getOwnerLevel().setListLevelProperties(e)}getCharacterProperties(){return this.getOwnerLevel().getCharacterProperties()}getParagraphProperties(){return this.getOwnerLevel().getParagraphProperties()}setParagraphProperties(e){this.getOwnerLevel().setParagraphProperties(e)}onParagraphPropertiesChanged(){this.getOwnerLevel().onParagraphPropertiesChanged()}getParagraphMergedProperties(){return this.getOwnerLevel().getParagraphMergedProperties()}setParagraphMergedProperies(e){this.getOwnerLevel().setParagraphMergedProperies(e)}hasParagraphMergedProperies(){return this.getOwnerLevel().hasParagraphMergedProperies()}resetParagraphMergedProperties(){this.getOwnerLevel().resetParagraphMergedProperties()}setCharacterProperties(e){this.getOwnerLevel().setCharacterProperties(e)}onCharacterPropertiesChanged(){this.getOwnerLevel().onCharacterPropertiesChanged()}getCharacterMergedProperties(){return this.getOwnerLevel().getCharacterMergedProperties()}setCharacterMergedProperies(e){this.getOwnerLevel().setCharacterMergedProperies(e)}hasCharacterMergedProperies(){return this.getOwnerLevel().hasCharacterMergedProperies()}resetCharacterMergedProperties(){this.getOwnerLevel().resetCharacterMergedProperties()}getNewStart(){return this.newStart}setNewStart(e){this.newStart=e}getOwnerLevel(){return this.owner.getAbstractNumberingList().levels[this.level]}equals(e){return this.getOwnerLevel().equals(e.getOwnerLevel())}externallyEquals(e){return this.getOwnerLevel().externallyEquals(e.getOwnerLevel())}copyFrom(e){if(!(e instanceof Yi))throw new Error("Source level should have equal type");this.newStart=e.newStart,this.overrideStart=e.overrideStart}}class Qi extends Ji{constructor(){super(...arguments),this.overrideStart=!1}getNewStart(){return this.getListLevelProperties().start}setNewStart(e){var t=this.getListLevelProperties().clone();t.start=e,this.setListLevelProperties(t)}copyFrom(e){if(!(e instanceof Qi))throw new Error("Source level should have equal type");super.copyFrom(e),this.overrideStart=e.overrideStart}}var Zi,en,tn,rn=__webpack_require__(49),nn=__webpack_require__(1104),on=__webpack_require__(8860);class an{static getSelectedParagraphs(e,t){e=nn.IntervalAlgorithms.getMergedIntervals(e,!0);for(var r,i=[],n=0;r=e[n];n++)i=i.concat(t.getParagraphsByInterval(r));var o,a=[(i=i.sort((function(e,t){return e.startLogPosition.value<t.startLogPosition.value?-1:1})))[0]],s=a[0].startLogPosition.value;for(n=1;o=i[n];n++)o.startLogPosition.value!=s&&(a.push(o),s=o.startLogPosition.value);return{paragraphs:a,intervals:e}}static getIntervalsOfSelectedParagraphs(e,t){let r=[];const i=this.getSelectedParagraphs(e,t).paragraphs;return f.ListUtils.forEach(i,(e=>{r.push(on.FixedInterval.fromPositions(e.startLogPosition.value,e.getEndPosition()))})),r}static getCopyPasteGuid(e){return`re-rangecopy&${e.sguid}&${e.cguid}`}static getCopyPasteGuidLabel(e){return`id="${an.getCopyPasteGuid(e)}"`}static getNextPredefinedFontSize(e){var t=C.SearchUtils.normedInterpolationIndexOf(an.predefinedFontSizes,(e=>e),e);return void 0!==an.predefinedFontSizes[t+1]?an.predefinedFontSizes[t+1]:10*Math.floor(e/10)+10}static getPreviousPredefinedFontSize(e){var t=C.SearchUtils.binaryIndexOf(an.predefinedFontSizes,(t=>t-e));if(t>0)return an.predefinedFontSizes[t-1];if(t<0&&(t=~t),0===t)return Math.max(1,e-1);var r=an.predefinedFontSizes.length;if(t<r)return an.predefinedFontSizes[t-1];var i=e%10>0?10*Math.floor(e/10):10*Math.floor(e/10)-10;return i>=an.predefinedFontSizes[r-1]?i:an.predefinedFontSizes[r-1]}static replaceParagraphEndCharsWithLineBreak(e){return e.replace(/(\r\n)|(\n)|(\r)/g,an.specialCharacters.LineBreak)}}an.isLatinLetter=/\w/,an.isWhitespace=/\s/,an.isAlphanumeric=/^[\u00C0-\u1FFF\u2C00-\uD7FF\w]+$/,an.predefinedFontSizes=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],an.minFontSize=1,an.maxFontSize=600,an.specialCharacters=new class{constructor(){this.Dot=".",this.Colon=":",this.Underscore="_",this.EqualSign="=",this.MiddleDot="·",this.Dash="-",this.ParagraphMark=String.fromCharCode(13),this.SectionMark=String.fromCharCode(29),this.Hyphen="‐",this.TabMark=String.fromCharCode(9),this.NonBreakingSpace=" ",this.Space=" ",this.EmSpace=" ",this.EnSpace=" ",this.QmSpace=" ",this.LineBreak="\v",this.PageBreak="\f",this.ColumnBreak="",this.ObjectMark="￼",this.FloatingObjectMark="\b",this.NumberingListMark="￻",this.EmDash="—",this.EnDash="–",this.Bullet="•",this.LeftSingleQuote="‘",this.RightSingleQuote="’",this.LeftDoubleQuote="“",this.RightDoubleQuote="”",this.PilcrowSign="¶",this.CurrencySign="¤",this.CopyrightSymbol="©",this.TrademarkSymbol="™",this.OptionalHyphen="­",this.RegisteredTrademarkSymbol="®",this.Ellipsis="…",this.OpeningSingleQuotationMark="‘",this.ClosingSingleQuotationMark="’",this.OpeningDoubleQuotationMark="“",this.ClosingDoubleQuotationMark="”",this.SeparatorMark="|",this.MSWordBulletMark=String.fromCharCode(61623),this.HiddenLineBreak=String.fromCharCode(8626),this.HiddenParagraphMark=String.fromCharCode(182),this.HiddenSpace=String.fromCharCode(183),this.HiddenTabSpace=String.fromCharCode(8594),this.FieldCodeStartRun="{",this.FieldCodeEndRun="}",this.FieldResultEndRun=">",this.LayoutDependentText="#",this.ETX="",this.EOT=""}DEBUG_CONVERTER(e){let t=[];const r=e.length;for(let i=0;i<r;i++){const r=e[i];switch(r){case this.Bullet:t.push("[Bullet]");break;case this.TabMark:t.push("[TabMark]");break;case this.NonBreakingSpace:t.push("[NonBreakingSpace]");break;case this.Space:t.push("[Space]");break;case this.ParagraphMark:t.push("¶");break;default:t.push(r)}}return t.join("")}};class sn{constructor(){this.start=1,this.format=Zi.Decimal,this.alignment=en.Left,this.convertPreviousLevelNumberingToDecimal=!1,this.separator=an.specialCharacters.TabMark,this.suppressRestart=!1,this.suppressBulletResize=!1,this.displayFormatString="{0}.",this.relativeRestartLevel=0,this.templateCode=0,this.originalLeftIndent=0,this.legacy=!1,this.legacySpace=0,this.legacyIndent=0}calculateHash(){return P.MathUtils.somePrimes[0]*this.start^P.MathUtils.somePrimes[1]*this.format^P.MathUtils.somePrimes[2]*this.alignment^P.MathUtils.somePrimes[3]*rn.StringUtils.stringHashCode(this.separator)^P.MathUtils.somePrimes[4]*(0,S.boolToInt)(this.suppressRestart)^P.MathUtils.somePrimes[5]*this.originalLeftIndent^P.MathUtils.somePrimes[6]*this.templateCode^P.MathUtils.somePrimes[7]*rn.StringUtils.stringHashCode(this.displayFormatString)}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}equals(e){return this.alignment===e.alignment&&this.convertPreviousLevelNumberingToDecimal===e.convertPreviousLevelNumberingToDecimal&&this.displayFormatString===e.displayFormatString&&this.format===e.format&&this.legacy===e.legacy&&this.legacyIndent===e.legacyIndent&&this.legacySpace===e.legacySpace&&this.originalLeftIndent===e.originalLeftIndent&&this.relativeRestartLevel===e.relativeRestartLevel&&this.separator===e.separator&&this.start===e.start&&this.suppressBulletResize===e.suppressBulletResize&&this.suppressRestart===e.suppressRestart&&this.templateCode===e.templateCode}copyFrom(e){this.alignment=e.alignment,this.convertPreviousLevelNumberingToDecimal=e.convertPreviousLevelNumberingToDecimal,this.displayFormatString=e.displayFormatString,this.format=e.format,this.legacy=e.legacy,this.legacyIndent=e.legacyIndent,this.legacySpace=e.legacySpace,this.originalLeftIndent=e.originalLeftIndent,this.relativeRestartLevel=e.relativeRestartLevel,this.separator=e.separator,this.start=e.start,this.suppressBulletResize=e.suppressBulletResize,this.suppressRestart=e.suppressRestart,this.templateCode=e.templateCode}clone(){var e=new sn;return e.copyFrom(this),e}}!function(e){e[e.Decimal=0]="Decimal",e[e.AIUEOHiragana=1]="AIUEOHiragana",e[e.AIUEOFullWidthHiragana=2]="AIUEOFullWidthHiragana",e[e.ArabicAbjad=3]="ArabicAbjad",e[e.ArabicAlpha=4]="ArabicAlpha",e[e.Bullet=5]="Bullet",e[e.CardinalText=6]="CardinalText",e[e.Chicago=7]="Chicago",e[e.ChineseCounting=8]="ChineseCounting",e[e.ChineseCountingThousand=9]="ChineseCountingThousand",e[e.ChineseLegalSimplified=10]="ChineseLegalSimplified",e[e.Chosung=11]="Chosung",e[e.DecimalEnclosedCircle=12]="DecimalEnclosedCircle",e[e.DecimalEnclosedCircleChinese=13]="DecimalEnclosedCircleChinese",e[e.DecimalEnclosedFullstop=14]="DecimalEnclosedFullstop",e[e.DecimalEnclosedParentheses=15]="DecimalEnclosedParentheses",e[e.DecimalFullWidth=16]="DecimalFullWidth",e[e.DecimalFullWidth2=17]="DecimalFullWidth2",e[e.DecimalHalfWidth=18]="DecimalHalfWidth",e[e.DecimalZero=19]="DecimalZero",e[e.Ganada=20]="Ganada",e[e.Hebrew1=21]="Hebrew1",e[e.Hebrew2=22]="Hebrew2",e[e.Hex=23]="Hex",e[e.HindiConsonants=24]="HindiConsonants",e[e.HindiDescriptive=25]="HindiDescriptive",e[e.HindiNumbers=26]="HindiNumbers",e[e.HindiVowels=27]="HindiVowels",e[e.IdeographDigital=28]="IdeographDigital",e[e.IdeographEnclosedCircle=29]="IdeographEnclosedCircle",e[e.IdeographLegalTraditional=30]="IdeographLegalTraditional",e[e.IdeographTraditional=31]="IdeographTraditional",e[e.IdeographZodiac=32]="IdeographZodiac",e[e.IdeographZodiacTraditional=33]="IdeographZodiacTraditional",e[e.Iroha=34]="Iroha",e[e.IrohaFullWidth=35]="IrohaFullWidth",e[e.JapaneseCounting=36]="JapaneseCounting",e[e.JapaneseDigitalTenThousand=37]="JapaneseDigitalTenThousand",e[e.JapaneseLegal=38]="JapaneseLegal",e[e.KoreanCounting=39]="KoreanCounting",e[e.KoreanDigital=40]="KoreanDigital",e[e.KoreanDigital2=41]="KoreanDigital2",e[e.KoreanLegal=42]="KoreanLegal",e[e.LowerLetter=43]="LowerLetter",e[e.LowerRoman=44]="LowerRoman",e[e.None=45]="None",e[e.NumberInDash=46]="NumberInDash",e[e.Ordinal=47]="Ordinal",e[e.OrdinalText=48]="OrdinalText",e[e.RussianLower=49]="RussianLower",e[e.RussianUpper=50]="RussianUpper",e[e.TaiwaneseCounting=51]="TaiwaneseCounting",e[e.TaiwaneseCountingThousand=52]="TaiwaneseCountingThousand",e[e.TaiwaneseDigital=53]="TaiwaneseDigital",e[e.ThaiDescriptive=54]="ThaiDescriptive",e[e.ThaiLetters=55]="ThaiLetters",e[e.ThaiNumbers=56]="ThaiNumbers",e[e.UpperLetter=57]="UpperLetter",e[e.UpperRoman=58]="UpperRoman",e[e.VietnameseDescriptive=59]="VietnameseDescriptive"}(Zi||(Zi={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(en||(en={}));class ln{constructor(e,t){this.innerId=-1,this.levels=[],this.deleted=!1,this.documentModel=e,this.initLevels(t)}getId(){return-1===this.innerId&&(this.innerId=this.generateNewId()),this.innerId}resetId(){this.innerId=-1}initLevels(e){for(var t=0;t<e;t++){var r=this.createLevel(t);this.levels.push(r)}}getLevelType(e){return this.isBulletListLevel(this.levels[e])?tn.Bullet:this.isHybridList()?tn.Simple:tn.MultiLevel}getListType(){return this.isHybridList()?this.isBulletListLevel(this.levels[0])?tn.Bullet:tn.Simple:tn.MultiLevel}equals(e){for(var t,r=0;t=e.levels[r];r++)if(!t.equals(this.levels[r]))return!1;return!0}externallyEquals(e){if(this.getListType()!==e.getListType())return!1;for(var t=this.getListType()==tn.MultiLevel?ln.depth:1,r=0;r<t;r++)if(!this.levels[r].externallyEquals(e.levels[r]))return!1;return!0}copyFrom(e){this.innerId=e.innerId,this.deleted=e.deleted,this.copyLevelsFrom(e.levels)}isHybridList(){for(var e,t=0;e=this.levels[t];t++)if(0!==e.getListLevelProperties().templateCode)return!0;return!1}isBulletListLevel(e){return 1===e.getListLevelProperties().displayFormatString.length}}ln.depth=3,ln.NoNumberingListIndex=-2,ln.NumberingListNotSettedIndex=-1;class dn extends ln{constructor(e){super(e,9)}generateNewId(){return this.documentModel.abstractNumberingListsIdProvider.getNextId()}createLevel(e){const t=Pe.createDefault(this.documentModel),r=Lt.createDefault(this.documentModel);return new Ji(this.documentModel,t,r,new sn)}copyLevelsFrom(e){for(var t,r=0;t=this.levels[r];r++)t.copyFrom(e[r])}clone(e){const t=new dn(e);return t.copyFrom(this),t}}class cn extends ln{constructor(e,t){if(super(e,9),t<0||t>=e.abstractNumberingLists.length)throw new Error("abstractNumberingListIndex should be positive and less than length of the abstractNumberingLists array");this.abstractNumberingListIndex=t}getAbstractNumberingList(){return this.documentModel.abstractNumberingLists[this.abstractNumberingListIndex]}generateNewId(){return this.documentModel.numberingListsIdProvider.getNextId()}createLevel(e){return new Yi(this,e)}copyLevelsFrom(e){for(var t=0;t<this.levels.length;t++){var r=e[t];this.levels[t].constructor!==r.constructor&&(this.levels[t]=r instanceof Qi?new Qi(this.documentModel,r.getCharacterProperties(),r.getParagraphProperties(),r.getListLevelProperties()):new Yi(this,t)),this.levels[t].copyFrom(r)}}clone(e){const t=new cn(e,this.abstractNumberingListIndex);return t.copyFrom(this),t}}!function(e){e[e.MultiLevel=0]="MultiLevel",e[e.Simple=1]="Simple",e[e.Bullet=2]="Bullet"}(tn||(tn={}));class hn{constructor(e,t){this.props=e,this.style=t}}class un{constructor(e,t){this.numberingListIndex=e,this.listLevelIndex=t}static get default(){return new un(cn.NumberingListNotSettedIndex,-1)}clone(){return new un(this.numberingListIndex,this.listLevelIndex)}}class pn extends hn{}class gn extends hn{}class mn extends hn{constructor(e,t,r,i){super(e,t),this.listInfo=r,this.tabs=i}static get notSetted(){return new mn(void 0,void 0,void 0,void 0)}}var fn=__webpack_require__(6907),bn=__webpack_require__(4004),Cn=__webpack_require__(7093);class Sn{constructor(){this.style="normal",this.weight="normal",this.stretch="normal",this.unicodeRange="U+0-10FFFF",this.variant="normal",this.featureSettings="normal",this.variationSettings="normal",this.display="auto",this._cacheKey=null}static get getDefaultUnicodeRange(){return new Cn.e(0,1114111)}msWordItalic(){return/^\s*(italic|oblique(\s+\w*)?)\s*$/i.test(this.style)}msWordBold(){if("number"==typeof this.weight)return this.weight>=550;const e=parseInt(this.weight);return isNaN(e)?/^\s*(bold|bolder)\s*$/i.test(this.weight):e>=550}get cacheKey(){return this._cacheKey||(this._cacheKey=[this.style.toString()+this.weight.toString()+this.stretch.toString()+this.unicodeRange.toString()+this.variant.toString()+this.featureSettings.toString()+this.variationSettings.toString()+this.display.toString()].join("/")),this._cacheKey}parseUnicodeRanges(){const e=this.unicodeRange?f.ListUtils.reducedMap(this.unicodeRange.split(","),(e=>{const t=e.match(/U\+(\w*)(\?+)/i);let r=NaN,i=NaN;if(t){const e=t[2].length;r=parseInt(t[1]+rn.StringUtils.repeat("0",e),16),i=parseInt(t[1]+rn.StringUtils.repeat("F",e),16)}else{const t=e.match(/U\+(\w+)-?(\w*)/i);t&&(r=parseInt(t[1],16),i=t[2].length?parseInt(t[2],16):r)}return isNaN(r)||isNaN(i)?null:new Cn.e(r,i+1)})):[];return e.length?e.sort():[Sn.getDefaultUnicodeRange]}static create(e){const t=new Sn;return e?(null!==e.style&&void 0!==e.style&&(t.style=e.style),null!==e.weight&&void 0!==e.weight&&(t.weight=e.weight),null!==e.stretch&&void 0!==e.stretch&&(t.stretch=e.stretch),null!==e.unicodeRange&&void 0!==e.unicodeRange&&(t.unicodeRange=e.unicodeRange),null!==e.variant&&void 0!==e.variant&&(t.variant=e.variant),null!==e.featureSettings&&void 0!==e.featureSettings&&(t.featureSettings=e.featureSettings),null!==e.variationSettings&&void 0!==e.variationSettings&&(t.variationSettings=e.variationSettings),null!==e.display&&void 0!==e.display&&(t.display=e.display),t):t}clone(){const e=new Sn;return e.style=this.style,e.weight=this.weight,e.stretch=this.stretch,e.unicodeRange=this.unicodeRange,e.variant=this.variant,e.featureSettings=this.featureSettings,e.variationSettings=this.variationSettings,e.display=this.display,e}}const In={"Angsana New":"angsana.ttc","Angsana Newb":"angsana.ttc","Angsana Newi":"angsana.ttc","Angsana Newz":"angsana.ttc",Arial:"arial.ttf",Arialb:"arialbd.ttf",Ariali:"ariali.ttf",Arialz:"arialbi.ttf","Arial Unicode MS":"Arialuni.ttf","Arial Unicode MSb":"Arialuni.ttf","Arial Unicode MSi":"Arialuni.ttf","Arial Unicode MSz":"Arialuni.ttf","Arial Black":"ariblk.ttf","Arial Blackb":"ariblk.ttf","Arial Blacki":"AriBlkIt.ttf","Arial Blackz":"AriBlkIt.ttf",Batang:"batang.ttc",Batangb:"batang.ttc",Batangi:"batang.ttc",Batangz:"batang.ttc","Book Antiqua":"BKANT","Book Antiquab":"ANTQUAB","Book Antiquai":"ANTQUAI","Book Antiquaz":"ANTQUABI","Bookman Old Style":"bookos.ttf","Bookman Old Styleb":"bookos.ttf","Bookman Old Stylei":"bookos.ttf","Bookman Old Stylez":"bookos.ttf",Calibri:"Calibri.ttf",Calibrib:"Calibrib.ttf",Calibrii:"Calibrii.ttf",Calibriz:"Calibriz.ttf","Calibri Light":"Calibril.ttf","Calibri Lightb":"Calibril.ttf","Calibri Lighti":"Calibrili.ttf","Calibri Lightz":"Calibrili.ttf",Cambria:"cambria.ttc",Cambriab:"cambriab.ttf",Cambriai:"cambriai.ttf",Cambriaz:"cambriaz.ttf",Candara:"Candara.ttf",Candarab:"Candarab.ttf",Candarai:"Candarai.ttf",Candaraz:"Candaraz.ttf",Century:"CENTURY.ttf",Centuryb:"CENTURY.ttf",Centuryi:"CENTURY.ttf",Centuryz:"CENTURY.ttf","Century Gothic":"gothic.ttf","Century Gothicb":"gothic.ttf","Century Gothici":"gothic.ttf","Century Gothicz":"gothic.ttf","CC-Gothic":"gothic.ttf","CC-Gothicb":"gothic.ttf","CC-Gothici":"gothic.ttf","CC-Gothicz":"gothic.ttf","Century Schoolbook":"censcbk.ttf","Century Schoolbookb":"censcbk.ttf","Century Schoolbooki":"censcbk.ttf","Century Schoolbookz":"censcbk.ttf","Comic Sans MS":"comic.ttf","Comic Sans MSb":"comicbd.ttf","Comic Sans MSi":"comici.ttf","Comic Sans MSz":"comicz.ttf",Consolas:"Consola.ttf",Consolasb:"Consolab.ttf",Consolasi:"Consolai.ttf",Consolasz:"Consolaz.ttf",Constantia:"constan.ttf",Constantiab:"constanb.ttf",Constantiai:"constani.ttf",Constantiaz:"constanz.ttf",Corbel:"corbel.ttf",Corbelb:"corbelb.ttf",Corbeli:"corbeli.ttf",Corbelz:"corbelz.ttf","Cordia New":"cordia.ttf","Cordia Newb":"cordiab.ttf","Cordia Newi":"cordiai.ttf","Cordia Newz":"cordiaz.ttf","Courier New":"cour.ttf","Courier Newb":"courbd.ttf","Courier Newi":"courbi.ttf","Courier Newz":"couri.ttf",Courier:"cour.ttf",Courierb:"courbd.ttf",Courieri:"courbi.ttf",Courierz:"couri.ttf",DaunPenh:"daunpenh.ttf",DaunPenhb:"daunpenh.ttf",DaunPenhi:"daunpenh.ttf",DaunPenhz:"daunpenh.ttf",Dotum:"gulim.ttc",Dotumb:"gulim.ttc",Dotumi:"gulim.ttc",Dotumz:"gulim.ttc",FangSong:"simfang.ttf",FangSongb:"simfang.ttf",FangSongi:"simfang.ttf",FangSongz:"simfang.ttf","Franklin Gothic Book":"frabk.ttf","Franklin Gothic Bookb":"frabk.ttf","Franklin Gothic Booki":"frabk.ttf","Franklin Gothic Bookz":"frabk.ttf","Franklin Gothic Medium":"frabk.ttf","Franklin Gothic Mediumb":"frabk.ttf","Franklin Gothic Mediumi":"frabk.ttf","Franklin Gothic Mediumz":"frabk.ttf",Garamond:"GARA.TTF",Garamondb:"GARA.TTF",Garamondi:"GARA.TTF",Garamondz:"GARA.TTF",Gautami:"gautami.ttf",Gautamib:"Gautamib.ttf",Gautamii:"gautami.ttf",Gautamiz:"Gautamib.ttf",Georgia:"georgia.ttf",Georgiab:"georgiab.ttf",Georgiai:"georgiai.ttf",Georgiaz:"georgiaz.ttf","Gill Sans MT":"gil_____.ttf","Gill Sans MTb":"gil_____.ttf","Gill Sans MTi":"gil_____.ttf","Gill Sans MTz":"gil_____.ttf",Gulim:"gulim.ttc",Gulimb:"gulim.ttc",Gulimi:"gulim.ttc",Gulimz:"gulim.ttc",GungSuh:"batang.ttc",GungSuhb:"batang.ttc",GungSuhi:"batang.ttc",GungSuhz:"batang.ttc",Impact:"impact.ttf",Impactb:"impact.ttf",Impacti:"impact.ttf",Impactz:"impact.ttf","Iskoola Pota":"iskpota.ttf","Iskoola Potab":"iskpotab.ttf","Iskoola Potai":"iskpota.ttf","Iskoola Potaz":"iskpotab.ttf",KaiTi:"simkai.ttf",KaiTib:"simkai.ttf",KaiTii:"simkai.ttf",KaiTiz:"simkai.ttf",Kalinga:"kalinga.ttf",Kalingab:"kalingab.ttf",Kalingai:"kalinga.ttf",Kalingaz:"kalingab.ttf",Kartika:"kartika.ttf",Kartikab:"kartikab.ttf",Kartikai:"kartika.ttf",Kartikaz:"kartikab.ttf",Latha:"latha.ttf",Lathab:"Lathab.ttf",Lathai:"latha.ttf",Lathaz:"Lathab.ttf","Lucida Console":"lucon.ttf","Lucida Consoleb":"lucon.ttf","Lucida Consolei":"lucon.ttf","Lucida Consolez":"lucon.ttf","Lucida Sans":"lsansdi.ttf","Lucida Sansb":"lsansdi.ttf","Lucida Sansi":"lsansdi.ttf","Lucida Sansz":"lsansdi.ttf","Lucida Sans Unicode":"l_10646.ttf","Lucida Sans Unicodeb":"l_10646.ttf","Lucida Sans Unicodei":"l_10646.ttf","Lucida Sans Unicodez":"l_10646.ttf","Malgun Gothic":"malgun.ttf","Malgun Gothicb":"malgunbd.ttf","Malgun Gothici":"malgun.ttf","Malgun Gothicz":"malgunbd.ttf",Mangal:"Mangal.ttf",Mangalb:"MangalB.ttf",Mangali:"Mangal.ttf",Mangalz:"MangalB.ttf",Meiryo:"meiryo_00.ttf",Meiryob:"meiryob_00.ttf",Meiryoi:"meiryob_01.ttf",Meiryoz:"meiryo_01.ttf","Microsoft JhengHei":"msjh_00.ttf","Microsoft JhengHeib":"msjhbd_00.ttf","Microsoft JhengHeii":"msjh_00.ttf","Microsoft JhengHeiz":"msjhbd_00.ttf","Microsoft YaHei":"msyh_00.ttf","Microsoft YaHeib":"msyhbd_00.ttf","Microsoft YaHeii":"msyh_00.ttf","Microsoft YaHeiz":"msyhbd_00.ttf",MingLiU:"mingliu_00.ttf",MingLiUb:"mingliub_00.ttf",MingLiUi:"mingliu_00.ttf",MingLiUz:"mingliub_00.ttf",MingLiU_HKSCS:"mingliu_02.ttf",MingLiU_HKSCSb:"mingliub_02.ttf",MingLiU_HKSCSi:"mingliu_02.ttf",MingLiU_HKSCSz:"mingliub_02.ttf","MS Gothic":"msgothic.ttc","MS Gothicb":"msgothic.ttc","MS Gothici":"msgothic.ttc","MS Gothicz":"msgothic.ttc","MS Mincho":"msmincho.ttc","MS Minchob":"msmincho.ttc","MS Minchoi":"msmincho.ttc","MS Minchoz":"msmincho.ttc","MS PGothic":"msgothic_02.ttf","MS PGothicb":"msgothic_02.ttfc","MS PGothici":"msgothic_02.ttf","MS PGothicz":"msgothic_02.ttf","MS PMincho":"msmincho_01.ttf","MS PMinchob":"msmincho_01.ttfc","MS PMinchoi":"msmincho_01.ttf","MS PMinchoz":"msmincho_01.ttf",Nyala:"nyala.ttf",Nyalab:"nyala.ttf",Nyalai:"nyala.ttf",Nyalaz:"nyala.ttf","Palatino Linotype":"pala.ttf","Palatino Linotypeb":"palab.ttf","Palatino Linotypei":"palai.ttf","Palatino Linotypez":"palabi.ttf",PMingLiU:"mingliu_01.ttf",PMingLiUb:"mingliub_01.ttf",PMingLiUi:"mingliu_01.ttf",PMingLiUz:"mingliub_01.ttf","PMingLiU-ExtB":"mingliub_02.ttf","PMingLiU-ExtBb":"mingliub_02.ttf","PMingLiU-ExtBi":"mingliub_02.ttf","PMingLiU-ExtBz":"mingliub_02.ttf",Raavi:"raavi.ttf",Raavib:"raavib.ttf",Raavii:"raavi.ttf",Raaviz:"raavib.ttf",Rockwell:"rock.ttf",Rockwellb:"rockb.ttf",Rockwelli:"rocki.ttf",Rockwellz:"rockbi.ttf","Segoe UI":"segoeui.ttf","Segoe UIb":"segoeuib.ttf","Segoe UIi":"segoeuii.ttf","Segoe UIz":"segoeuiz.ttf",Shruti:"shruti.ttf",Shrutib:"shrutib.ttf",Shrutii:"shruti.ttf",Shrutiz:"shrutib.ttf",SimHei:"simhei.ttf",SimHeib:"simhei.ttf",SimHeii:"simhei.ttf",SimHeiz:"simhei.ttf",SimSun:"simsun_00.ttf",SimSunb:"simsunb.ttf",SimSuni:"simsun_00.ttf",SimSunz:"simsunb.ttf",Sylfaen:"sylfaen.ttf",Sylfaenb:"sylfaen.ttf",Sylfaeni:"sylfaen.ttf",Sylfaenz:"sylfaen.ttf",Tahoma:"tahoma.ttf",Tahomab:"tahomabd.ttf",Tahomai:"tahoma.ttf",Tahomaz:"tahomabd.ttf",Times:"times.ttf",Timesb:"timesbd.ttf",Timesi:"timesi.ttf",Timesz:"timesbi.ttf","Times New Roman":"times.ttf","Times New Romanb":"timesbd.ttf","Times New Romani":"timesi.ttf","Times New Romanz":"timesbi.ttf","Trebuchet MS":"trebuc.ttf","Trebuchet MSb":"trebucbd.ttf","Trebuchet MSi":"trebucit.ttf","Trebuchet MSz":"trebucbi.ttf",Tunga:"tunga.ttf",Tungab:"tungab.ttf",Tungai:"tunga.ttf",Tungaz:"tungab.ttf","TW Cen MT":"tcm_____.ttf","TW Cen MTb":"tcm_____.ttf","TW Cen MTi":"tcm_____.ttf","TW Cen MTz":"tcm_____.ttf",Verdana:"verdana.ttf",Verdanab:"verdanab.ttf",Verdanai:"verdanai.ttf",Verdanaz:"verdanaz.ttf",Vrinda:"vrinda.ttf",Vrindab:"vrindab.ttf",Vrindai:"vrinda.ttf",Vrindaz:"vrindab.ttf",Symbol:"symbol.ttf",Symbolb:"symbol.ttf",Symboli:"symbol.ttf",Symbolz:"symbol.ttf",Webdings:"Webdings.ttf",Webdingsb:"Webdings.ttf",Webdingsi:"Webdings.ttf",Webdingsz:"Webdings.ttf",Wingdings:"Wingding.ttf",Wingdingsb:"Wingding.ttf",Wingdingsi:"Wingding.ttf",Wingdingsz:"Wingding.ttf","Microsoft Sans Serif":"Micross.ttf","Microsoft Sans Serifb":"Micross.ttf","Microsoft Sans Serifi":"Micross.ttf","Microsoft Sans Serifz":"Micross.ttf","Microsoft JhengHei Light":"Msjhl.ttf","Microsoft JhengHei Lightb":"Msjhl.ttf","Microsoft JhengHei Lighti":"Msjhl.ttf","Microsoft JhengHei Lightz":"Msjhl.ttf"};var Pn,wn,yn,xn,Tn,vn;!function(e){e[e.Unloaded=0]="Unloaded",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error"}(Pn||(Pn={}));class Mn{get loaded(){return this.status==Pn.Loaded}get unicodeRanges(){return this._unicodeRanges||(this._unicodeRanges=this.descriptors.parseUnicodeRanges()),this._unicodeRanges}get controlFontType(){const e=new pr.Flag;return e.set(wn.Bold,this.descriptors.msWordBold()),e.set(wn.Italic,this.descriptors.msWordItalic()),e.getValue()}constructor(e,t,r){this.isFontCollection=!1,this.status=Pn.Unloaded,this.sourceUrls=[],this._unicodeRanges=null,this.fontFamily=e,this.descriptors=t,this.cacheKey=r||[this.fontFamily,this.descriptors.cacheKey].join("/")}applySource(e,t){this.data||(this.data=e),(0,bn.lX)()?(0,bn.mx)(this.fontFamily,e,this.descriptors,t):setTimeout(t,0)}clone(){const e=new Mn(this.fontFamily,this.descriptors.clone(),this.cacheKey);return e.status=this.status,e.data=this.data,e._unicodeRanges=this._unicodeRanges,e._unicodeRanges=this._unicodeRanges,e.sourceUrls=f.ListUtils.shallowCopy(this.sourceUrls),e.isFontCollection=this.isFontCollection,e}allSourceUrls(e){return f.ListUtils.addListOnTail(f.ListUtils.shallowCopy(this.sourceUrls),this.defaultUrls(e))}defaultUrls(e){const t=this.descriptors.msWordBold(),r=this.descriptors.msWordItalic(),i=t&&r?`${this.fontFamily}z`:`${this.fontFamily}${t?"b":""}${r?"i":""}`,n=[];let o=null;const a=In[i];a&&(o=e+a,n.push(o));const s=t=>{const r=`${e}${i}.${t}`;r!==o&&n.push(r)};return s("woff"),s("ttf"),s("ttc"),n}static createDefault(e,t){const r=new Sn;return t.get(wn.Bold)&&(r.weight="bold"),t.get(wn.Italic)&&(r.style="italic"),new Mn(e,r)}}!function(e){e[e.Regular=0]="Regular",e[e.Bold=1]="Bold",e[e.Italic=2]="Italic",e[e.BoldItalic=3]="BoldItalic"}(wn||(wn={}));class En{constructor(e){this.controlFontMap={[wn.Regular]:null,[wn.Bold]:null,[wn.Italic]:null,[wn.BoldItalic]:null},this.name=e,this.cssString=e,this.isLoad=!0}ensureAllControlFontsAssigned(e){const t=this.getFontFamilies()[0],r=r=>{if(!this.controlFontMap[r]){let i=e.findSimularFontByType(t,r);i||(i=e.addFont(Mn.createDefault(t,new pr.Flag(r)))),this.controlFontMap[r]=i.cacheKey}};r(wn.Regular),r(wn.Bold),r(wn.Italic),r(wn.BoldItalic)}getFontFamilies(){return fn.DomUtils.getFontFamiliesFromCssString(this.cssString)}static calculateHashByName(e){return rn.StringUtils.stringHashCode(e.toLowerCase())}calculateHash(){return En.calculateHashByName(this.name)}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}copyFrom(e){this.name=e.name,this.scriptMultiplier=e.scriptMultiplier,this.canBeSet=e.canBeSet,this.cssString=e.cssString,this.subScriptOffset=e.subScriptOffset,this.controlFontMap=b.j.shallowCopy(e.controlFontMap)}equals(e){return e&&this.name==e.name&&this.scriptMultiplier==e.scriptMultiplier}static equalsBinary(e,t){return e&&t&&e.name==t.name&&e.scriptMultiplier==t.scriptMultiplier}clone(){var e=new En(null);return e.copyFrom(this),e}getBaseLine(){return void 0===this.baseLine&&this.measure(),this.baseLine}getHeightFactor(){return void 0===this.heightFactor&&this.measure(),this.heightFactor}reset(){this.baseLine=void 0,this.heightFactor=void 0}getAscent(e){return this.getBaseLine()*e}getDescent(e){return e-this.getAscent(e)}measure(){const e=this.measurer.getFontMeasurerInfo(this);this.baseLine=e.baseLine,this.heightFactor=e.heightFactor}}class Dn{constructor(){this.cache={},this.list=[]}addFont(e){const t=this.cache[e.cacheKey];return t||(this.cache[e.cacheKey]=e,this.list.push(e),e)}getFontByKey(e){return this.cache[e]}getFont(e){return this.cache[e.cacheKey]}deleteFont(e){this.cache[e.cacheKey]&&(delete this.cache[e.cacheKey],f.ListUtils.removeBy(this.list,(t=>t.cacheKey==e.cacheKey)))}clone(){const e=new Dn;return e.list=f.ListUtils.deepCopy(this.list),e.cache=B.StringMapUtils.deepCopy(this.cache),e}findSimularFontByType(e,t){const r=new pr.Flag(t);return f.ListUtils.elementBy(this.list,(t=>t.fontFamily==e&&t.descriptors.msWordBold()==r.get(wn.Bold)&&t.descriptors.msWordItalic()==r.get(wn.Italic)))}}class Fn extends ye{static getRareCharProperty(e){if(!Fn._rareCharProperty){const t=new Ie;t.fontInfo=new En("Calibri"),t.fontInfo.measurer=e,t.fontSize=200,Fn._rareCharProperty=t}return Fn._rareCharProperty}resetSizes(){this.forEach((e=>{e.clearSizes(),e.fontInfo&&e.fontInfo.reset()}))}copyFrom(e){super.copyFrom(e)}clone(){const e=new Fn;return e.copyFrom(this),e}}class Rn{}Rn.control=w.i.fromArgbNumber(255,240,240,240),Rn.controlDark=w.i.fromArgbNumber(255,160,160,160),Rn.window=w.i.fromArgbNumber(255,255,255,255),Rn.activeBorder=w.i.fromArgbNumber(255,180,180,180),Rn.activeCaption=w.i.fromArgbNumber(255,153,180,209),Rn.activeCaptionText=w.i.fromArgbNumber(255,0,0,0),Rn.appWorkspace=w.i.fromArgbNumber(255,171,171,171),Rn.controlDarkDark=w.i.fromArgbNumber(255,105,105,105),Rn.controlLight=w.i.fromArgbNumber(255,227,227,227),Rn.controlLightLight=w.i.fromArgbNumber(255,255,255,255),Rn.controlText=w.i.fromArgbNumber(255,0,0,0),Rn.desktop=w.i.fromArgbNumber(255,0,0,0),Rn.grayText=w.i.fromArgbNumber(255,109,109,109),Rn.highlight=w.i.fromArgbNumber(255,0,120,215),Rn.highlightText=w.i.fromArgbNumber(255,255,255,255),Rn.hotTrack=w.i.fromArgbNumber(255,0,102,204),Rn.inactiveBorder=w.i.fromArgbNumber(255,244,247,252),Rn.inactiveCaption=w.i.fromArgbNumber(255,191,205,219),Rn.inactiveCaptionText=w.i.fromArgbNumber(255,0,0,0),Rn.info=w.i.fromArgbNumber(255,255,255,225),Rn.infoText=w.i.fromArgbNumber(255,0,0,0),Rn.menu=w.i.fromArgbNumber(255,240,240,240),Rn.menuText=w.i.fromArgbNumber(255,0,0,0),Rn.scrollBar=w.i.fromArgbNumber(255,200,200,200),Rn.windowFrame=w.i.fromArgbNumber(255,100,100,100),Rn.windowText=w.i.fromArgbNumber(255,0,0,0),Rn.gradientActiveCaption=w.i.fromArgbNumber(255,185,209,234),Rn.gradientInactiveCaption=w.i.fromArgbNumber(255,215,228,242),Rn.menuBar=w.i.fromArgbNumber(255,240,240,240),Rn.menuHighlight=w.i.fromArgbNumber(255,51,153,255);class Ln{constructor(e,t,r){this._scR=e,this._scG=t,this._scB=r}get scR(){return this._scR}set scR(e){this._scR=this.getValidValue(e)}get scG(){return this._scG}set scG(e){this._scG=this.getValidValue(e)}get scB(){return this._scB}set scB(e){this._scB=this.getValidValue(e)}calculateHash(){return P.MathUtils.somePrimes[0]*this._scR^P.MathUtils.somePrimes[1]*this._scG^P.MathUtils.somePrimes[2]*this._scB}toRgb(){let e=1*this._scR/_.ThousandthOfPercentage,t=1*this._scG/_.ThousandthOfPercentage,r=1*this._scB/_.ThousandthOfPercentage;const i=.055;return e=e<=.0031308?12.92*e:(1+i)*Math.pow(e,1/2.4)-i,t=t<=.0031308?12.92*t:(1+i)*Math.pow(t,1/2.4)-i,r=r<=.0031308?12.92*r:(1+i)*Math.pow(r,1/2.4)-i,e*=255,t*=255,r*=255,U.fromRgb(Math.round(e),Math.round(t),Math.round(r))}getValidValue(e){return e<0?0:e}equals(e){return e&&this._scR==e._scR&&this._scG==e._scG&&this._scB==e._scB}}Ln.defaultValue=new Ln(0,0,0),function(e){e[e.Accent1=0]="Accent1",e[e.Accent2=1]="Accent2",e[e.Accent3=2]="Accent3",e[e.Accent4=3]="Accent4",e[e.Accent5=4]="Accent5",e[e.Accent6=5]="Accent6",e[e.Background1=6]="Background1",e[e.Background2=7]="Background2",e[e.Dark1=8]="Dark1",e[e.Dark2=9]="Dark2",e[e.FollowedHyperlink=10]="FollowedHyperlink",e[e.Hyperlink=11]="Hyperlink",e[e.Light1=12]="Light1",e[e.Light2=13]="Light2",e[e.Style=14]="Style",e[e.Text1=15]="Text1",e[e.Text2=16]="Text2",e[e.Empty=17]="Empty"}(yn||(yn={})),function(e){e[e.Sc3dDkShadow=20]="Sc3dDkShadow",e[e.Sc3dLight=19]="Sc3dLight",e[e.ScActiveBorder=21]="ScActiveBorder",e[e.ScActiveCaption=6]="ScActiveCaption",e[e.ScAppWorkspace=24]="ScAppWorkspace",e[e.ScBackground=23]="ScBackground",e[e.ScBtnFace=0]="ScBtnFace",e[e.ScBtnHighlight=7]="ScBtnHighlight",e[e.ScBtnShadow=8]="ScBtnShadow",e[e.ScBtnText=9]="ScBtnText",e[e.ScCaptionText=5]="ScCaptionText",e[e.ScGradientActiveCaption=-2]="ScGradientActiveCaption",e[e.ScGradientInactiveCaption=-3]="ScGradientInactiveCaption",e[e.ScGrayText=10]="ScGrayText",e[e.ScHighlight=3]="ScHighlight",e[e.ScHighlightText=4]="ScHighlightText",e[e.ScHotLight=-4]="ScHotLight",e[e.ScInactiveBorder=22]="ScInactiveBorder",e[e.ScInactiveCaption=11]="ScInactiveCaption",e[e.ScInactiveCaptionText=12]="ScInactiveCaptionText",e[e.ScInfoBk=13]="ScInfoBk",e[e.ScInfoText=14]="ScInfoText",e[e.ScMenu=2]="ScMenu",e[e.ScMenuBar=-5]="ScMenuBar",e[e.ScMenuHighlight=-6]="ScMenuHighlight",e[e.ScMenuText=15]="ScMenuText",e[e.ScScrollBar=16]="ScScrollBar",e[e.ScWindow=17]="ScWindow",e[e.ScWindowFrame=18]="ScWindowFrame",e[e.ScWindowText=1]="ScWindowText",e[e.Empty=-1]="Empty"}(xn||(xn={})),function(e){e[e.None=0]="None",e[e.Minor=1]="Minor",e[e.Major=2]="Major"}(Tn||(Tn={})),function(e){e[e.None=0]="None",e[e.Subtle=1]="Subtle",e[e.Moderate=2]="Moderate",e[e.Intense=3]="Intense"}(vn||(vn={}));class Bn{constructor(){this.restoreDefaultValues()}calculateHash(){let e=P.MathUtils.somePrimes[10]*this._colorType;switch(this._colorType){case W.Hsl:e^=P.MathUtils.somePrimes[0]*this._hsl.calculateHash();break;case W.Preset:e^=P.MathUtils.somePrimes[1]*rn.StringUtils.stringHashCode(this._preset);break;case W.Rgb:e^=P.MathUtils.somePrimes[2]*this._rgb;break;case W.Scheme:e^=P.MathUtils.somePrimes[3]*this._schemeColor;break;case W.ScRgb:e^=P.MathUtils.somePrimes[4]*this._scRgb.calculateHash();break;case W.System:e^=P.MathUtils.somePrimes[5]*this._systemColor}return e}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}setColorType(e){this.restoreDefaultValues(),this._colorType=e}get colorType(){return this._colorType}get rgb(){return this._rgb}set rgb(e){this._colorType!=W.Rgb&&this.setColorType(W.Rgb),this._rgb!=e&&(this._rgb=e)}get systemColor(){return this._systemColor}set systemColor(e){this._colorType!=W.System&&this.setColorType(W.System),this._systemColor!=e&&(this._systemColor=e)}get schemeColor(){return this._schemeColor}set schemeColor(e){this._colorType!=W.Scheme&&this.setColorType(W.Scheme),this._schemeColor!=e&&(this._schemeColor=e)}get hsl(){return this._hsl}set hsl(e){this._colorType!=W.Hsl&&this.setColorType(W.Hsl),this._hsl.equals(e)||(this._hsl=e)}get preset(){return this._preset}set preset(e){this._colorType!=W.Preset&&this.setColorType(W.Preset),this._preset==e||rn.StringUtils.isNullOrEmpty(e)||(this._preset=e)}get scRgb(){return this._scRgb}set scRgb(e){this._colorType!=W.ScRgb&&this.setColorType(W.ScRgb),this._scRgb.equals(e)||(this._scRgb=e)}get isEmpty(){return U.isTransparentOrEmpty(this._rgb)&&this._colorType==W.Rgb}static createRGB(e){const t=new Bn;return t.rgb=U.fromArgb(255,e),t}static createARGB(e){var t=new Bn;return t.rgb=e,t}static createSystem(e){var t=new Bn;return t.systemColor=e,t}static createScheme(e){var t=new Bn;return t.schemeColor=e,t}static createPreset(e){var t=new Bn;return t.preset=e,t}static createScRgb(e){var t=new Bn;return t.scRgb=e,t}static createHSL(e){var t=new Bn;return t.hsl=e,t}static sRgbToRgb(e){return w.i.fromHashString(e)}toRgb(e,t=U.empty){switch(this._colorType){case W.System:return this.getRgbFromSystemColor();case W.Scheme:return this.getRgbFromSchemeColor(e,t);case W.Hsl:return this._hsl.toRgb();case W.Preset:return this.getRgbFromPreset();case W.ScRgb:return this._scRgb.toRgb();default:return this._rgb}}getRgbFromPreset(){var e;return null!==(e=w.i.fromColorName(this._preset))&&void 0!==e?e:U.empty}getRgbFromSystemColor(){return this._systemColor==xn.Empty?U.empty:Bn.systemColorTable[this._systemColor]}getRgbFromSchemeColor(e,t){return this._schemeColor==yn.Style?t:this._schemeColor==yn.Empty?U.empty:e.officeTheme.colors.getColorBySchemeColorValues(e,this._schemeColor)}restoreDefaultValues(){this._rgb=U.empty,this._schemeColor=yn.Empty,this._systemColor=xn.Empty,this._preset="",this._scRgb=Ln.defaultValue,this._hsl=H.defaultValue}clone(){var e=new Bn;return e.copyFrom(this),e}copyFrom(e){this._colorType=e._colorType,this._rgb=e._rgb,this._schemeColor=e._schemeColor,this._systemColor=e._systemColor,this._preset=e._preset,this._scRgb=e._scRgb,this._hsl=e._hsl}equals(e){return e&&this._colorType==e._colorType&&this._rgb==e._rgb&&this._schemeColor==e._schemeColor&&this._systemColor==e._systemColor&&this._preset==e._preset&&this._scRgb.equals(e._scRgb)&&this._hsl.equals(e._hsl)}}Bn.empty=new Bn,Bn.systemColorTable={[xn.Sc3dDkShadow]:Rn.controlDarkDark,[xn.Sc3dLight]:Rn.controlLightLight,[xn.ScActiveBorder]:Rn.activeBorder,[xn.ScActiveCaption]:Rn.activeCaption,[xn.ScAppWorkspace]:Rn.appWorkspace,[xn.ScBackground]:Rn.desktop,[xn.ScBtnFace]:Rn.control,[xn.ScBtnHighlight]:Rn.controlLight,[xn.ScBtnShadow]:Rn.controlDark,[xn.ScBtnText]:Rn.controlText,[xn.ScCaptionText]:Rn.activeCaptionText,[xn.ScGradientActiveCaption]:Rn.gradientActiveCaption,[xn.ScGradientInactiveCaption]:Rn.gradientInactiveCaption,[xn.ScGrayText]:Rn.grayText,[xn.ScHighlight]:Rn.highlight,[xn.ScHighlightText]:Rn.highlightText,[xn.ScHotLight]:Rn.hotTrack,[xn.ScInactiveBorder]:Rn.inactiveBorder,[xn.ScInactiveCaption]:Rn.inactiveCaption,[xn.ScInactiveCaptionText]:Rn.inactiveCaptionText,[xn.ScInfoBk]:Rn.info,[xn.ScInfoText]:Rn.infoText,[xn.ScMenu]:Rn.menu,[xn.ScMenuBar]:Rn.menuBar,[xn.ScMenuHighlight]:Rn.menuHighlight,[xn.ScMenuText]:Rn.menuText,[xn.ScScrollBar]:Rn.scrollBar,[xn.ScWindow]:Rn.window,[xn.ScWindowFrame]:Rn.windowFrame,[xn.ScWindowText]:Rn.windowText};class An extends ye{constructor(){super(),this.getItem(Bn.empty)}copyFrom(e){super.copyFrom(e)}clone(){const e=new An;return e.copyFrom(this),e}}An.defaultItem=new Bn;class Nn{static getCssRules(e,t,r,i,n){var o=Nn.getSizeSignificantRules(e,n);return o.push(this.getForeColorRule(t)),i||(e.fontStrikeoutType==se.None||!r&&e.strikeoutWordsOnly||o.push("text-decoration: line-through"),e.fontUnderlineType==le.None||!r&&e.underlineWordsOnly||o.push("text-decoration: underline")),o}static getForeColorRule(e){return e=e!==y.AUTOMATIC_COLOR?e:y.BLACK_COLOR,"color: "+y.getCssStringInternal(e)}static getSizeSignificantCssString(e){return Nn.getSizeSignificantRules(e).join(";")}static getSizeSignificantRules(e,t=!0){var r=[];e.allCaps?r.push("text-transform: uppercase"):e.smallCaps&&r.push("font-variant: small-caps"),r.push("font-family: "+Nn.buildFontFamilyRule(e.fontInfo.cssString)+(t?Nn.importantTag:"")),e.fontBold&&r.push("font-weight: bold"),e.fontItalic&&r.push("font-style: italic");var i=g.u.pointsToPixelsF(e.fontSize);return e.script==ne.Normal?r.push("font-size: "+P.MathUtils.round(i,3)+"px"+(t?Nn.importantTag:"")):r.push("font-size: "+P.MathUtils.round(i*e.fontInfo.scriptMultiplier,3)+"px"+(t?Nn.importantTag:"")),r}static buildFontFamilyRule(e){var t=e.replace(/"/g,"&quot;");return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")!=t&&(t=t.replace(/'/g,"&quot;")),t}}Nn.importantTag=" !important";class kn{getFontMeasurerInfo(e){this.beginMeasuring(e);const t=this.container.firstChild.offsetTop/this.container.lastChild.offsetHeight,r=this.container.lastChild.offsetHeight/kn.testSpanHeigth;return this.endMeasuring(),new On(t,r)}beginMeasuring(e){this.container||(this.container=document.createElement("div"),this.container.style.position="absolute",this.container.style.top="-10000px",this.container.style.left="-10000px",this.container.style.opacity="0",this.container.style.fontSize="0px",this.container.style.lineHeight="normal");var t=Nn.buildFontFamilyRule(e.cssString);this.container.innerHTML="";var r=document.createElement("span");return r.style.cssText="font-size:0; font-family: "+t+"; display: inline-block;",r.innerHTML="A",this.container.appendChild(r),(r=document.createElement("span")).style.cssText="font-size:"+kn.testSpanHeigth+"pt; font-family: "+t+"; display: inline-block;",r.innerHTML="A",this.container.appendChild(r),document.body.appendChild(this.container),this.container}endMeasuring(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}}kn.testSpanHeigth=288;class On{constructor(e,t){this.baseLine=e,this.heightFactor=t}}class _n extends ye{constructor(e){super(),e?this.fontMeasurer=e:(this.fontMeasurer=new kn,f.ListUtils.forEach(_n.defaultFonts,((e,t)=>this.addItemForMerge(e.clone(),t))))}static get defaultFontInfo(){return _n._defaultFontInfo||(_n._defaultFontInfo=f.ListUtils.elementBy(_n.defaultFonts,(e=>e.name==_n.defaultFontName))),_n._defaultFontInfo}processNewItem(e){e.measurer=this.fontMeasurer}getItemByName(e){const t=this.hashtable[En.calculateHashByName(e)];return t&&t[0]?t[0]:null}getFontNames(e=!1){const t=[];return this.forEach((e=>t.push(e.name))),e&&t.sort(),t}getAllFonts(){const e=[];return this.forEach((t=>e.push(t))),e}addFont(e,t){const r=_n.defaultFontInfo.clone();return r.name=e,t&&(r.cssString=_n.correctCssString(t)),this.addItemForMerge(r,this.count)}static correctCssString(e){if(-1!=e.indexOf(" ")){"'"!=e[0]&&'"'!=e[0]||(e=e.slice(1));const t=e[e.length-1];return"'"!=t&&'"'!=t||(e=e.substr(0,e.length-1)),`'${e}'`}return e}deleteFont(e){const t=En.calculateHashByName(e.name),r=this.hashtable[t];r&&r[0]&&delete this.hashtable[t]}static fillDefaultFonts(e){0==_n.defaultFonts.length&&(_n.defaultFonts=f.ListUtils.initByCallback(e.count,(t=>e.getItemByJsonKey(t))))}copyFrom(e){super.copyFrom(e),this.fontMeasurer=e.fontMeasurer}clone(){const e=new _n(null);return e.copyFrom(this),e}}_n.defaultFonts=[],_n.defaultFontName="Calibri",_n.fallbackFontName="Times New Roman";class Un extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new Un;return e.copyFrom(this),e}}class Hn extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new Hn;return e.copyFrom(this),e}}class Vn extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new Vn;return e.copyFrom(this),e}}class Wn extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new Wn;return e.copyFrom(this),e}}class zn{constructor(){this.packedValues=0,this.zoom=_.ThousandthOfPercentage}get cameraType(){return this.getUIntValue(zn.maskPresetCameraType,0)}set cameraType(e){this.setUIntValue(zn.maskPresetCameraType,0,e)}get lightRigDirection(){return this.getUIntValue(zn.maskLightRigDirection,6)}set lightRigDirection(e){this.setUIntValue(zn.maskLightRigDirection,6,e)}get lightRigPreset(){return this.getUIntValue(zn.maskLightRigPreset,10)}set lightRigPreset(e){this.setUIntValue(zn.maskLightRigPreset,10,e)}get hasCameraRotation(){return this.getBooleanValue(zn.maskHasCameraRotation)}set hasCameraRotation(e){this.setBooleanValue(zn.maskHasCameraRotation,e)}get hasLightRigRotation(){return this.getBooleanValue(zn.maskHasLightRigRotation)}set hasLightRigRotation(e){this.setBooleanValue(zn.maskHasLightRigRotation,e)}get isDefault(){return this.equals(zn.defaultInfo)}calculateHash(){return P.MathUtils.somePrimes[0]*this.packedValues^P.MathUtils.somePrimes[1]*this.fov^P.MathUtils.somePrimes[2]*this.zoom}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}getUIntValue(e,t){return(this.packedValues&e)>>t}setUIntValue(e,t,r){this.packedValues=~e,this.packedValues|=r<<t&e}setBooleanValue(e,t){this.packedValues=t?this.packedValues||e:this.packedValues&&~e}getBooleanValue(e){return!!(this.packedValues&e)}equals(e){return e&&this.packedValues==e.packedValues&&this.fov==e.fov&&this.zoom==e.zoom}clone(){const e=new zn;return e.packedValues=this.packedValues,e.fov=this.fov,e.zoom=this.zoom,e}}zn.defaultInfo=new zn,zn.maskPresetCameraType=63,zn.maskLightRigDirection=960,zn.maskLightRigPreset=31744,zn.maskHasCameraRotation=32768,zn.maskHasLightRigRotation=65536;class jn extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new jn;return e.copyFrom(this),e}}jn.defaultItem=new zn;class Xn{constructor(e=0,t=0,r=0){this.latitude=e,this.longitude=t,this.revolution=r}calculateHash(){return P.MathUtils.somePrimes[0]*this.latitude^P.MathUtils.somePrimes[1]*this.longitude^P.MathUtils.somePrimes[2]*this.revolution}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}equals(e){return e&&this.latitude==e.latitude&&this.longitude==e.longitude&&this.revolution==e.revolution}clone(){const e=new Xn;return e.latitude=this.latitude,e.longitude=this.longitude,e.revolution=this.revolution,e}}Xn.defaultInfo=new Xn;class Gn extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new Gn;return e.copyFrom(this),e}}Gn.defaultItem=new Xn;class Kn extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new Kn;return e.copyFrom(this),e}}class qn extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new qn;return e.copyFrom(this),e}}class $n extends ye{copyFrom(e){super.copyFrom(e)}clone(){const e=new $n;return e.copyFrom(this),e}}var Jn,Yn,Qn,Zn,eo,to,ro,io,no,oo,ao,so=__webpack_require__(6353),lo=__webpack_require__(6477);class co{static get emptyPictureSize(){return new so.Size(co.emptyPicDimension,co.emptyPicDimension)}get isLoaded(){return this._referenceInfo?this._referenceInfo._isLoaded:this._isLoaded}set isLoaded(e){this._isLoaded=e}get size(){return this._referenceInfo?this._referenceInfo._size:this._size}set size(e){this._size=e}get currId(){return void 0!==this.actualId?this.actualId:this.tmpId}get base64(){return this._referenceInfo?this._referenceInfo._base64:this._base64}set base64(e){this._base64=lo.Base64Utils.normalizeToDataUrl(e,"image/png")}get pdfCompatibleBase64(){var e;return null!==(e=this._convertedBase64)&&void 0!==e?e:this.base64}get referenceInfo(){return this._referenceInfo}set referenceInfo(e){this._referenceInfo=e,this._base64=void 0,this._size=void 0,this._isLoaded=void 0,this.file=void 0}constructor(e,t,r,i,n,o,a,s){this._base64=void 0!==e?lo.Base64Utils.normalizeToDataUrl(e,"image/png"):void 0,this.actualId=t,this.tmpId=r,this._referenceInfo=o,this._size=a||co.emptyPictureSize,this._isLoaded=void 0!==s&&s,this.imageUrl=i,this.file=n}equals(e){return(0,S.isDefined)(this._referenceInfo)&&this._referenceInfo===e._referenceInfo||this.actualId==e.actualId&&this.tmpId==e.tmpId&&this.base64===e.base64&&this.imageUrl===e.imageUrl&&this.file===e.file&&this.size.equals(e.size)}clone(){return new co(this._base64,this.actualId,this.tmpId,this.imageUrl,this.file,this._referenceInfo,this._size,this._isLoaded)}shouldMakeImagePdfCompatible(){return!(0,S.isDefined)(this._convertedBase64)&&!this.isPdfCompatible()}isPdfCompatible(){if((0,S.isDefined)(this._convertedBase64))return!0;if((0,S.isDefined)(this.base64)){const e=this.getImageHeader();if(255===e[0]&&216===e[1])return!0;if(137===e[0]&&"PNG"===this.toString(e,1,4))return!0}return!1}toString(e,t,r){return Array.from(e.slice(t,r)).map((e=>String.fromCharCode(e))).join("")}setPdfCompatibleBase64(e){this._convertedBase64=lo.Base64Utils.normalizeToDataUrl(e,"image/png")}getImageHeader(){const e=/^data:.+;base64,(.*)$/.exec(this.base64)[1].substring(0,8);return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}}co.emptyPicDimension=g.u.pixelsToTwips(32);class ho{get emptyImage(){return this.cache[this.emptyImageId]}constructor(){this.emptyImageId=0,this.lastTmpId=0,this.lastActualId=1,this.cache={};const e=g.u.pixelsToTwips(1);this.createUnloadedInfoByBase64(ho.transparentWhiteImage1_1,new so.Size(e,e)).isLoaded=!1}getPictureData(e){return this.cache[e]}createUnloadedInfoByUrl(e,t){const r=this.findInfoByUrl(e);return r||this.registerPictureData(new co(this.cache[this.emptyImageId].base64,void 0,this.lastTmpId--,e,void 0,void 0,this.origSizeCorrect(t)?t:void 0))}createUnloadedInfoByFile(e){return this.registerPictureData(new co(this.cache[this.emptyImageId].base64,void 0,this.lastTmpId--,void 0,e))}registerFromAnotherModel(e){e.isLoaded=!1,e.actualId=void 0,e.base64=this.cache[this.emptyImageId].base64,e.tmpId=this.lastTmpId--}createUnloadedInfoByBase64(e,t){const r=this.findInfoByBase64(e);if(r)return r;const i=this.origSizeCorrect(t);return this.registerPictureData(new co(e,void 0,this.lastTmpId--,void 0,void 0,void 0,i?t:void 0))}createLoadedInfo(e,t,r){const i=this.findInfoByBase64(e);return i?void 0===r||r===i.actualId?i:this.registerPictureData(new co(void 0,r,void 0,void 0,void 0,i,void 0)):(void 0===r&&(r=this.getNextActualId()),this.registerPictureData(new co(e,r,void 0,void 0,void 0,void 0,t,!!t)))}createUnloadedByBase64OrUrl(e,t){return lo.Base64Utils.checkPrependDataUrl(e)?this.createUnloadedInfoByBase64(e,t):this.createUnloadedInfoByUrl(e,t)}finalizeLoading(e,t){if(e.isLoaded=!0,e.size=t.size,e.actualId=t.actualId,void 0===e.actualId&&(e.actualId=this.getNextActualId()),this.registerPictureData(e),e.referenceInfo)return;const r=lo.Base64Utils.normalizeToDataUrl(t.base64,"image/png");b.j.containsBy(this.cache,(t=>{const i=t.base64==r&&t!==e&&t.isLoaded;return i&&(e.referenceInfo=t.referenceInfo?t.referenceInfo:t),i}))||(e.base64=r)}getNextActualId(){return this.lastActualId++}isDataRegistered(e){return!!this.cache[e.actualId]||!!this.cache[e.tmpId]}registerPictureData(e){let t=this.cache[e.actualId];return t||(t=this.cache[e.tmpId]),t||(t=e),void 0!==e.actualId&&(this.cache[e.actualId]=t),void 0!==e.tmpId&&(this.cache[e.tmpId]=t),t}loadAllPictures(e){b.j.forEach(this.cache,(t=>{this.emptyImageId!=t.actualId&&e.loader.load(t)}))}findInfoByBase64(e){return e=lo.Base64Utils.normalizeToDataUrl(e,"image/png"),b.j.elementBy(this.cache,(t=>t.base64==e))}findInfoByUrl(e){return b.j.elementBy(this.cache,(t=>t.imageUrl==e))}origSizeCorrect(e){return e&&!!e.width&&!!e.height}clone(){const e=new ho;return e.lastTmpId=this.lastTmpId,e.lastActualId=this.lastActualId,e.cache=b.j.deepCopy(this.cache),b.j.forEach(e.cache,(t=>{t.referenceInfo&&(t.referenceInfo=e.cache[t.currId])})),e}}ho.transparentWhiteImage1_1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAANSURBVBhXY/j///9/AAn7A/0FQ0XKAAAAAElFTkSuQmCC";class uo{constructor(){this.imageCache=new ho,this.controlFontsCache=new Dn,this.fontInfoCache=new _n(null),this.mergedCharacterPropertiesCache=new Fn,this.mergedParagraphPropertiesCache=new Wn,this.maskedCharacterPropertiesCache=new Hn,this.maskedParagraphPropertiesCache=new Vn,this.tableRowPropertiesCache=new $n,this.tableCellPropertiesCache=new qn,this.listLevelPropertiesCache=new Un,this.shadingInfoCache=new Kn,this.colorModelInfoCache=new xe,this.drawingColorModelInfoCache=new An,this.scene3DPropertiesInfoCache=new jn,this.scene3DRotationInfoCache=new Gn}clearTemporaryCaches(){this.fontInfoCache.clearTemporaryCache(),this.mergedCharacterPropertiesCache.clearTemporaryCache(),this.mergedParagraphPropertiesCache.clearTemporaryCache(),this.maskedCharacterPropertiesCache.clearTemporaryCache(),this.maskedParagraphPropertiesCache.clearTemporaryCache(),this.listLevelPropertiesCache.clearTemporaryCache(),this.tableRowPropertiesCache.clearTemporaryCache(),this.tableCellPropertiesCache.clearTemporaryCache(),this.shadingInfoCache.clearTemporaryCache(),this.colorModelInfoCache.clearTemporaryCache(),this.drawingColorModelInfoCache.clearTemporaryCache(),this.scene3DPropertiesInfoCache.clearTemporaryCache(),this.scene3DRotationInfoCache.clearTemporaryCache()}DEBUG_DISTRIBUTION_INFO(){const e=[];return e.push(`maskedCharacterPropertiesCache \t{elems:${this.maskedCharacterPropertiesCache.count}, maxLen:${this.maskedCharacterPropertiesCache.DEBUG_MAX_CELL_LENGTH()}`),e.push(`maskedParagraphPropertiesCache \t{elems:${this.maskedParagraphPropertiesCache.count}, maxLen:${this.maskedParagraphPropertiesCache.DEBUG_MAX_CELL_LENGTH()}`),e.push(`mergedCharacterPropertiesCache \t{elems:${this.mergedCharacterPropertiesCache.count}, maxLen:${this.mergedCharacterPropertiesCache.DEBUG_MAX_CELL_LENGTH()}`),e.push(`mergedParagraphPropertiesCache \t{elems:${this.mergedParagraphPropertiesCache.count}, maxLen:${this.mergedParagraphPropertiesCache.DEBUG_MAX_CELL_LENGTH()}`),e.push(`listLevelPropertiesCache \t{elems:${this.listLevelPropertiesCache.count}, maxLen:${this.listLevelPropertiesCache.DEBUG_MAX_CELL_LENGTH()}`),e.push(`tableRowPropertiesCache \t{elems:${this.tableRowPropertiesCache.count}, maxLen:${this.tableRowPropertiesCache.DEBUG_MAX_CELL_LENGTH()}`),e.push(`tableCellPropertiesCache \t{elems:${this.tableCellPropertiesCache.count}, maxLen:${this.tableCellPropertiesCache.DEBUG_MAX_CELL_LENGTH()}`),e.join("\n")}clone(){const e=new uo;return e.fontInfoCache=this.fontInfoCache.clone(),e.controlFontsCache=this.controlFontsCache.clone(),e.mergedCharacterPropertiesCache=this.mergedCharacterPropertiesCache.clone(),e.mergedParagraphPropertiesCache=this.mergedParagraphPropertiesCache.clone(),e.maskedCharacterPropertiesCache=this.maskedCharacterPropertiesCache.clone(),e.maskedParagraphPropertiesCache=this.maskedParagraphPropertiesCache.clone(),e.tableRowPropertiesCache=this.tableRowPropertiesCache.clone(),e.tableCellPropertiesCache=this.tableCellPropertiesCache.clone(),e.listLevelPropertiesCache=this.listLevelPropertiesCache.clone(),e.imageCache=this.imageCache.clone(),e.shadingInfoCache=this.shadingInfoCache.clone(),e.colorModelInfoCache=this.colorModelInfoCache.clone(),e.drawingColorModelInfoCache=this.drawingColorModelInfoCache.clone(),e.scene3DPropertiesInfoCache=this.scene3DPropertiesInfoCache.clone(),e.scene3DRotationInfoCache=this.scene3DRotationInfoCache.clone(),e}}class po extends Error{constructor(){super(),this.message="Undefined run"}}class go extends Error{constructor(){super(),this.message="Offset >= run.length"}}class mo{constructor(e,t,r){this.textBuffer="",this.textRuns=[],this.startLogPosition=e,this.textBuffer=t,this.isLast=r}getEndPosition(){return this.startLogPosition.value+this.textBuffer.length}getRunText(e){return this.textBuffer.substr(e.startOffset,e.getLength())}getTextInChunk(e,t){return this.textBuffer.substr(e,t)}splitRun(e,t){var r=this.textRuns[e];if(!r)throw new po;if(t>=r.getLength())throw new go;var i=r.createSimularity(r.startOffset+t,r.getLength()-t,r.paragraph,r.characterStyle,r.maskedCharacterProperties);r.setLength(t),this.textRuns.splice(e+1,0,i)}removeRun(e){const t=this.textRuns[e];if(!t)throw new po;e===this.textRuns.length-1?(this.textBuffer=this.textBuffer.slice(0,t.startOffset),this.textRuns.pop()):(this.textBuffer=[this.textBuffer.slice(0,t.startOffset),this.textBuffer.slice(t.startOffset+t.getLength())].join(""),this.textRuns=[...this.textRuns.slice(0,e),...this.textRuns.slice(e+1)])}clone(e){const t=new mo(e.positionManager.registerPosition(this.startLogPosition.value),this.textBuffer.slice(0),this.isLast);return t.textRuns=f.ListUtils.map(this.textRuns,(t=>t.cloneToNewSubDocument(e))),t}}class fo{constructor(){this.highlightRanges=!0,this.showBrackets=!0,this.rangeHighlightColor="rgb(150, 200, 150)",this.rangeHighlightBracketsColor="rgb(127, 127, 127)",this.authenticationEMail="",this.authenticationGroup="",this.authenticationUserName=""}copyFrom(e){this.highlightRanges=e.highlightRanges,this.showBrackets=e.showBrackets,this.rangeHighlightColor=e.rangeHighlightColor,this.rangeHighlightBracketsColor=e.rangeHighlightBracketsColor,this.authenticationEMail=e.authenticationEMail,this.authenticationGroup=e.authenticationGroup,this.authenticationUserName=e.authenticationUserName}clone(){const e=new fo;return e.copyFrom(this),e}}fo.defaultColors=["rgb(213, 213, 255)","rgb(255, 213, 255)","rgb(255, 230, 213)","rgb(213, 255, 254)","rgb(255, 254, 213)","rgb(233, 233, 233)","rgb(255, 213, 213)","rgb(213, 255, 213)"];class bo{constructor(){this.name="",this.innerCollection={}}tryGetDrawingColor(e){return this.innerCollection[e]}setDrawingColor(e,t){this.innerCollection[e]=t}get Light1(){return this.tryGetDrawingColor(ce.Light1)}set Light1(e){this.setDrawingColor(ce.Light1,e)}get Light2(){return this.tryGetDrawingColor(ce.Light2)}set Light2(e){this.setDrawingColor(ce.Light2,e)}get Dark1(){return this.tryGetDrawingColor(ce.Dark1)}set Dark1(e){this.setDrawingColor(ce.Dark1,e)}get Dark2(){return this.tryGetDrawingColor(ce.Dark2)}set Dark2(e){this.setDrawingColor(ce.Dark2,e)}get Accent1(){return this.tryGetDrawingColor(ce.Accent1)}set Accent1(e){this.setDrawingColor(ce.Accent1,e)}get Accent2(){return this.tryGetDrawingColor(ce.Accent2)}set Accent2(e){this.setDrawingColor(ce.Accent2,e)}get Accent3(){return this.tryGetDrawingColor(ce.Accent3)}set Accent3(e){this.setDrawingColor(ce.Accent3,e)}get Accent4(){return this.tryGetDrawingColor(ce.Accent4)}set Accent4(e){this.setDrawingColor(ce.Accent4,e)}get Accent5(){return this.tryGetDrawingColor(ce.Accent5)}set Accent5(e){this.setDrawingColor(ce.Accent5,e)}get Accent6(){return this.tryGetDrawingColor(ce.Accent6)}set Accent6(e){this.setDrawingColor(ce.Accent6,e)}get Hyperlink(){return this.tryGetDrawingColor(ce.Hyperlink)}set Hyperlink(e){this.setDrawingColor(ce.Hyperlink,e)}get FollowedHyperlink(){return this.tryGetDrawingColor(ce.FollowedHyperlink)}set FollowedHyperlink(e){this.setDrawingColor(ce.FollowedHyperlink,e)}isValidate(){return this.checkValidation()}getColorByThemeColorIndex(e,t){const r=this.tryGetDrawingColor(t);if(null==r)throw new Error(R.D.InternalException);return r.finalColor(e)}getColorBySchemeColorValues(e,t){return this.getColorByThemeColorIndex(e,bo.schemeColorValuesToThemeColorIndexTranslationTable[t])}copyFrom(e){this.clear(),this.name=e.name,this.innerCollection=b.j.map(e.innerCollection,(e=>e))}clear(){this.name="",b.j.clear(this.innerCollection)}checkValidation(){return null!=this.name&&12==b.j.mapLength(this.innerCollection)&&void 0!==this.innerCollection[ce.Dark1]&&void 0!==this.innerCollection[ce.Light1]&&void 0!==this.innerCollection[ce.Dark2]&&void 0!==this.innerCollection[ce.Light2]&&void 0!==this.innerCollection[ce.Accent1]&&void 0!==this.innerCollection[ce.Accent2]&&void 0!==this.innerCollection[ce.Accent3]&&void 0!==this.innerCollection[ce.Accent4]&&void 0!==this.innerCollection[ce.Accent5]&&void 0!==this.innerCollection[ce.Accent6]&&void 0!==this.innerCollection[ce.Hyperlink]&&void 0!==this.innerCollection[ce.FollowedHyperlink]}}bo.schemeColorValuesToThemeColorIndexTranslationTable={[yn.Background1]:ce.Light1,[yn.Background2]:ce.Light2,[yn.Text1]:ce.Dark1,[yn.Text2]:ce.Dark2,[yn.Light1]:ce.Light1,[yn.Light2]:ce.Light2,[yn.Dark1]:ce.Dark1,[yn.Dark2]:ce.Dark2,[yn.Accent1]:ce.Accent1,[yn.Accent2]:ce.Accent2,[yn.Accent3]:ce.Accent3,[yn.Accent4]:ce.Accent4,[yn.Accent5]:ce.Accent5,[yn.Accent6]:ce.Accent6,[yn.Hyperlink]:ce.Hyperlink,[yn.FollowedHyperlink]:ce.FollowedHyperlink},function(e){e[e.Sibling=0]="Sibling",e[e.Tree=1]="Tree"}(Jn||(Jn={})),function(e){e[e.Fill=0]="Fill",e[e.FollowsText=1]="FollowsText"}(Yn||(Yn={})),function(e){e[e.Automatic=0]="Automatic",e[e.None=1]="None",e[e.Solid=2]="Solid",e[e.Gradient=3]="Gradient",e[e.Group=4]="Group",e[e.Pattern=5]="Pattern",e[e.Picture=6]="Picture"}(Qn||(Qn={})),function(e){e[e.Automatic=0]="Automatic",e[e.Color=1]="Color",e[e.Size=2]="Size",e[e.Typeface=3]="Typeface",e[e.Common=4]="Common"}(Zn||(Zn={})),function(e){e[e.Automatic=0]="Automatic",e[e.Outline=1]="Outline",e[e.FollowsText=2]="FollowsText"}(eo||(eo={})),function(e){e[e.None=0]="None",e[e.LegacyObliqueTopLeft=1]="LegacyObliqueTopLeft",e[e.LegacyObliqueTop=2]="LegacyObliqueTop",e[e.LegacyObliqueTopRight=3]="LegacyObliqueTopRight",e[e.LegacyObliqueLeft=4]="LegacyObliqueLeft",e[e.LegacyObliqueFront=5]="LegacyObliqueFront",e[e.LegacyObliqueRight=6]="LegacyObliqueRight",e[e.LegacyObliqueBottomLeft=7]="LegacyObliqueBottomLeft",e[e.LegacyObliqueBottom=8]="LegacyObliqueBottom",e[e.LegacyObliqueBottomRight=9]="LegacyObliqueBottomRight",e[e.LegacyPerspectiveTopLeft=10]="LegacyPerspectiveTopLeft",e[e.LegacyPerspectiveTop=11]="LegacyPerspectiveTop",e[e.LegacyPerspectiveTopRight=12]="LegacyPerspectiveTopRight",e[e.LegacyPerspectiveLeft=13]="LegacyPerspectiveLeft",e[e.LegacyPerspectiveFront=14]="LegacyPerspectiveFront",e[e.LegacyPerspectiveRight=15]="LegacyPerspectiveRight",e[e.LegacyPerspectiveBottomLeft=16]="LegacyPerspectiveBottomLeft",e[e.LegacyPerspectiveBottom=17]="LegacyPerspectiveBottom",e[e.LegacyPerspectiveBottomRight=18]="LegacyPerspectiveBottomRight",e[e.OrthographicFront=19]="OrthographicFront",e[e.IsometricTopUp=20]="IsometricTopUp",e[e.IsometricTopDown=21]="IsometricTopDown",e[e.IsometricBottomUp=22]="IsometricBottomUp",e[e.IsometricBottomDown=23]="IsometricBottomDown",e[e.IsometricLeftUp=24]="IsometricLeftUp",e[e.IsometricLeftDown=25]="IsometricLeftDown",e[e.IsometricRightUp=26]="IsometricRightUp",e[e.IsometricRightDown=27]="IsometricRightDown",e[e.IsometricOffAxis1Left=28]="IsometricOffAxis1Left",e[e.IsometricOffAxis1Right=29]="IsometricOffAxis1Right",e[e.IsometricOffAxis1Top=30]="IsometricOffAxis1Top",e[e.IsometricOffAxis2Left=31]="IsometricOffAxis2Left",e[e.IsometricOffAxis2Right=32]="IsometricOffAxis2Right",e[e.IsometricOffAxis2Top=33]="IsometricOffAxis2Top",e[e.IsometricOffAxis3Left=34]="IsometricOffAxis3Left",e[e.IsometricOffAxis3Right=35]="IsometricOffAxis3Right",e[e.IsometricOffAxis3Bottom=36]="IsometricOffAxis3Bottom",e[e.IsometricOffAxis4Left=37]="IsometricOffAxis4Left",e[e.IsometricOffAxis4Right=38]="IsometricOffAxis4Right",e[e.IsometricOffAxis4Bottom=39]="IsometricOffAxis4Bottom",e[e.ObliqueTopLeft=40]="ObliqueTopLeft",e[e.ObliqueTop=41]="ObliqueTop",e[e.ObliqueTopRight=42]="ObliqueTopRight",e[e.ObliqueLeft=43]="ObliqueLeft",e[e.ObliqueRight=44]="ObliqueRight",e[e.ObliqueBottomLeft=45]="ObliqueBottomLeft",e[e.ObliqueBottom=46]="ObliqueBottom",e[e.ObliqueBottomRight=47]="ObliqueBottomRight",e[e.PerspectiveFront=48]="PerspectiveFront",e[e.PerspectiveLeft=49]="PerspectiveLeft",e[e.PerspectiveRight=50]="PerspectiveRight",e[e.PerspectiveAbove=51]="PerspectiveAbove",e[e.PerspectiveBelow=52]="PerspectiveBelow",e[e.PerspectiveAboveLeftFacing=53]="PerspectiveAboveLeftFacing",e[e.PerspectiveAboveRightFacing=54]="PerspectiveAboveRightFacing",e[e.PerspectiveContrastingLeftFacing=55]="PerspectiveContrastingLeftFacing",e[e.PerspectiveContrastingRightFacing=56]="PerspectiveContrastingRightFacing",e[e.PerspectiveHeroicLeftFacing=57]="PerspectiveHeroicLeftFacing",e[e.PerspectiveHeroicRightFacing=58]="PerspectiveHeroicRightFacing",e[e.PerspectiveHeroicExtremeLeftFacing=59]="PerspectiveHeroicExtremeLeftFacing",e[e.PerspectiveHeroicExtremeRightFacing=60]="PerspectiveHeroicExtremeRightFacing",e[e.PerspectiveRelaxed=61]="PerspectiveRelaxed",e[e.PerspectiveRelaxedModerately=62]="PerspectiveRelaxedModerately"}(to||(to={})),function(e){e[e.None=0]="None",e[e.Bottom=1]="Bottom",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight",e[e.Left=4]="Left",e[e.Right=5]="Right",e[e.Top=6]="Top",e[e.TopLeft=7]="TopLeft",e[e.TopRight=8]="TopRight"}(ro||(ro={})),function(e){e[e.None=0]="None",e[e.LegacyFlat1=1]="LegacyFlat1",e[e.LegacyFlat2=2]="LegacyFlat2",e[e.LegacyFlat3=3]="LegacyFlat3",e[e.LegacyFlat4=4]="LegacyFlat4",e[e.LegacyNormal1=5]="LegacyNormal1",e[e.LegacyNormal2=6]="LegacyNormal2",e[e.LegacyNormal3=7]="LegacyNormal3",e[e.LegacyNormal4=8]="LegacyNormal4",e[e.LegacyHarsh1=9]="LegacyHarsh1",e[e.LegacyHarsh2=10]="LegacyHarsh2",e[e.LegacyHarsh3=11]="LegacyHarsh3",e[e.LegacyHarsh4=12]="LegacyHarsh4",e[e.ThreePt=13]="ThreePt",e[e.Balanced=14]="Balanced",e[e.Soft=15]="Soft",e[e.Harsh=16]="Harsh",e[e.Flood=17]="Flood",e[e.Contrasting=18]="Contrasting",e[e.Morning=19]="Morning",e[e.Sunrise=20]="Sunrise",e[e.Sunset=21]="Sunset",e[e.Chilly=22]="Chilly",e[e.Freezing=23]="Freezing",e[e.Flat=24]="Flat",e[e.TwoPt=25]="TwoPt",e[e.Glow=26]="Glow",e[e.BrightRoom=27]="BrightRoom"}(io||(io={})),function(e){e[e.None=0]="None",e[e.LegacyMatte=1]="LegacyMatte",e[e.LegacyPlastic=2]="LegacyPlastic",e[e.LegacyMetal=3]="LegacyMetal",e[e.LegacyWireframe=4]="LegacyWireframe",e[e.Matte=5]="Matte",e[e.Plastic=6]="Plastic",e[e.Metal=7]="Metal",e[e.WarmMatte=8]="WarmMatte",e[e.TranslucentPowder=9]="TranslucentPowder",e[e.Powder=10]="Powder",e[e.DarkEdge=11]="DarkEdge",e[e.SoftEdge=12]="SoftEdge",e[e.Clear=13]="Clear",e[e.Flat=14]="Flat",e[e.SoftMetal=15]="SoftMetal"}(no||(no={})),function(e){e[e.Automatic=0]="Automatic",e[e.Shape3D=1]="Shape3D",e[e.FlatText=2]="FlatText"}(oo||(oo={})),function(e){e[e.None=0]="None",e[e.RelaxedInset=1]="RelaxedInset",e[e.Circle=2]="Circle",e[e.Slope=3]="Slope",e[e.Cross=4]="Cross",e[e.Angle=5]="Angle",e[e.SoftRound=6]="SoftRound",e[e.Convex=7]="Convex",e[e.CoolSlant=8]="CoolSlant",e[e.Divot=9]="Divot",e[e.Riblet=10]="Riblet",e[e.HardEdge=11]="HardEdge",e[e.ArtDeco=12]="ArtDeco"}(ao||(ao={}));class Co{constructor(){this.stringArray=["",""],this.byteArray=[Co.DefaultCharset,Co.DefaultPitchFamily]}get typeface(){return this.stringArray[Co.typefaceIndex]}set typeface(e){this.setStringArray(Co.typefaceIndex,e)}get panose(){return this.stringArray[Co.panoseIndex]}set panose(e){this.setStringArray(Co.panoseIndex,e)}get charset(){return this.byteArray[Co.charsetIndex]}set charset(e){this.setByteArray(Co.charsetIndex,e)}get pitchFamily(){return this.byteArray[Co.pitchFamilyIndex]}set pitchFamily(e){this.setByteArray(Co.pitchFamilyIndex,e)}get isDefault(){return rn.StringUtils.isNullOrEmpty(this.stringArray[Co.typefaceIndex])&&rn.StringUtils.isNullOrEmpty(this.stringArray[Co.panoseIndex])&&this.byteArray[Co.charsetIndex]==Co.DefaultCharset&&this.byteArray[Co.pitchFamilyIndex]==Co.DefaultPitchFamily}copyFrom(e){this.stringArray[Co.typefaceIndex]=e.stringArray[Co.typefaceIndex],this.stringArray[Co.panoseIndex]=e.stringArray[Co.panoseIndex],this.byteArray[Co.charsetIndex]=e.byteArray[Co.charsetIndex],this.byteArray[Co.pitchFamilyIndex]=e.byteArray[Co.pitchFamilyIndex]}clone(){var e=new Co;return e.copyFrom(this),e}equals(e){return e&&this.stringArray[Co.typefaceIndex]==e.stringArray[Co.typefaceIndex]&&this.stringArray[Co.panoseIndex]==e.stringArray[Co.panoseIndex]&&this.byteArray[Co.charsetIndex]==e.byteArray[Co.charsetIndex]&&this.byteArray[Co.pitchFamilyIndex]==e.byteArray[Co.pitchFamilyIndex]}clear(){this.typeface="",this.panose="",this.charset=Co.DefaultCharset,this.pitchFamily=Co.DefaultPitchFamily}get type(){return Zn.Typeface}setStringArray(e,t){this.stringArray[e]!=t&&(this.stringArray[e]=t)}setByteArray(e,t){this.byteArray[e]!=t&&(this.byteArray[e]=t)}}Co.DefaultCharset=1,Co.DefaultPitchFamily=0,Co.typefaceIndex=0,Co.panoseIndex=1,Co.charsetIndex=0,Co.pitchFamilyIndex=1;class So{constructor(){this.supplementalFonts={},this.isValid=!1,this.latin=new Co,this.eastAsian=new Co,this.complexScript=new Co}addSupplementalFont(e,t){rn.StringUtils.isNullOrEmpty(e)||void 0===!this.supplementalFonts[e]||(this.supplementalFonts[e]=t)}copyFrom(e){this.latin.copyFrom(e.latin),this.eastAsian.copyFrom(e.eastAsian),this.complexScript.copyFrom(e.complexScript),this.isValid=e.isValid,B.StringMapUtils.clear(this.supplementalFonts),B.StringMapUtils.forEach(e.supplementalFonts,((e,t)=>this.addSupplementalFont[t]=e))}getTypeface(e){const t=e.name,r=So.cultureNameToScriptTable[t];return void 0!==r&&void 0!==this.supplementalFonts[r]?this.supplementalFonts[r]:this.getDefaultTypeface()}clear(){this.latin.clear(),this.eastAsian.clear(),this.complexScript.clear(),B.StringMapUtils.clear(this.supplementalFonts),this.isValid=!1}getDefaultTypeface(){return this.latin.typeface}}So.cultureNameToScriptTable={"ar-LY":"Arab","ar-DZ":"Arab","ar-MA":"Arab","ar-TN":"Arab","ar-OM":"Arab","ar-YE":"Arab","ar-SY":"Arab","ar-JO":"Arab","ar-LB":"Arab","ar-KW":"Arab","ar-AE":"Arab","ar-BH":"Arab","ar-QA":"Arab","ar-SA":"Arab","ur-PK":"Arab","fa-IR":"Arab","ps-AF":"Arab","prs-AF":"Arab","ar-IQ":"Arab","ar-EG":"Arab","hy-AM":"Armn","bn-IN":"Beng","as-IN":"Beng","bn-BD":"Beng","iu-Cans-CA":"Cans","sr-Cyrl-BA":"Cyrl","bs-Cyrl-BA":"Cyrl","sr-Cyrl-RS":"Cyrl","sr-Cyrl-ME":"Cyrl","bg-BG":"Cyrl","ru-RU":"Cyrl","uk-UA":"Cyrl","be-BY":"Cyrl","tg-Cyrl-TJ":"Cyrl","mk-MK":"Cyrl","kk-KZ":"Cyrl","ky-KG":"Cyrl","tt-RU":"Cyrl","mn-MN":"Cyrl","ba-RU":"Cyrl","sah-RU":"Cyrl","az-Cyrl-AZ":"Cyrl","uz-Cyrl-UZ":"Cyrl","sr-Cyrl-CS":"Cyrl","hi-IN":"Deva","mr-IN":"Deva","sa-IN":"Deva","kok-IN":"Deva","ne-NP":"Deva","am-ET":"Ethi","ka-GE":"Geor","el-GR":"Grek","gu-IN":"Gujr","pa-IN":"Guru","ko-KR":"Hang","zh-SG":"Hans","zh-CN":"Hans","zh-MO":"Hant","zh-TW":"Hant","zh-HK":"Hant","he-IL":"Hebr","ja-JP":"Jpan","km-KH":"Khmr","kn-IN":"Knda","lo-LA":"Laoo","de-LU":"Latn","en-CA":"Latn","es-GT":"Latn","fr-CH":"Latn","hr-BA":"Latn","smj-NO":"Latn","de-LI":"Latn","en-NZ":"Latn","es-CR":"Latn","fr-LU":"Latn","bs-Latn-BA":"Latn","smj-SE":"Latn","en-IE":"Latn","es-PA":"Latn","fr-MC":"Latn","sr-Latn-BA":"Latn","sma-NO":"Latn","en-ZA":"Latn","es-DO":"Latn","sma-SE":"Latn","en-JM":"Latn","es-VE":"Latn","sms-FI":"Latn","en-029":"Latn","es-CO":"Latn","sr-Latn-RS":"Latn","smn-FI":"Latn","en-BZ":"Latn","es-PE":"Latn","en-TT":"Latn","es-AR":"Latn","sr-Latn-ME":"Latn","en-ZW":"Latn","es-EC":"Latn","en-PH":"Latn","es-CL":"Latn","es-UY":"Latn","es-PY":"Latn","en-IN":"Latn","es-BO":"Latn","ca-ES":"Latn","cs-CZ":"Latn","da-DK":"Latn","de-DE":"Latn","en-US":"Latn","es-ES":"Latn","fi-FI":"Latn","fr-FR":"Latn","hu-HU":"Latn","is-IS":"Latn","it-IT":"Latn","nl-NL":"Latn","nb-NO":"Latn","pl-PL":"Latn","pt-BR":"Latn","rm-CH":"Latn","ro-RO":"Latn","hr-HR":"Latn","sk-SK":"Latn","sq-AL":"Latn","sv-SE":"Latn","tr-TR":"Latn","id-ID":"Latn","sl-SI":"Latn","et-EE":"Latn","lv-LV":"Latn","lt-LT":"Latn","az-Latn-AZ":"Latn","eu-ES":"Latn","hsb-DE":"Latn","tn-ZA":"Latn","xh-ZA":"Latn","zu-ZA":"Latn","af-ZA":"Latn","fo-FO":"Latn","mt-MT":"Latn","se-NO":"Latn","ms-MY":"Latn","en-MY":"Latn","es-SV":"Latn","sw-KE":"Latn","tk-TM":"Latn","uz-Latn-UZ":"Latn","cy-GB":"Latn","gl-ES":"Latn","fy-NL":"Latn","fil-PH":"Latn","ha-Latn-NG":"Latn","yo-NG":"Latn","quz-BO":"Latn","nso-ZA":"Latn","lb-LU":"Latn","kl-GL":"Latn","ig-NG":"Latn","arn-CL":"Latn","moh-CA":"Latn","br-FR":"Latn","en-SG":"Latn","es-HN":"Latn","mi-NZ":"Latn","oc-FR":"Latn","co-FR":"Latn","gsw-FR":"Latn","qut-GT":"Latn","rw-RW":"Latn","wo-SN":"Latn","gd-GB":"Latn","es-NI":"Latn","es-PR":"Latn","es-US":"Latn","de-CH":"Latn","en-GB":"Latn","es-MX":"Latn","fr-BE":"Latn","it-CH":"Latn","nl-BE":"Latn","nn-NO":"Latn","pt-PT":"Latn","sr-Latn-CS":"Latn","sv-FI":"Latn","dsb-DE":"Latn","se-SE":"Latn","ga-IE":"Latn","ms-BN":"Latn","iu-Latn-CA":"Latn","tzm-Latn-DZ":"Latn","quz-EC":"Latn","de-AT":"Latn","en-AU":"Latn","fr-CA":"Latn","se-FI":"Latn","quz-PE":"Latn","ml-IN":"Mlym","mn-Mong-CN":"Mong","or-IN":"Orya","si-LK":"Sinh","syr-SY":"Syrc","ta-IN":"Taml","te-IN":"Telu","dv-MV":"Thaa","th-TH":"Thai","bo-CN":"Tibt","ug-CN":"Uigh","vi-VN":"Viet","ii-CN":"Yiii"};class Io{constructor(){this.name="",this.minorFont=new So,this.majorFont=new So}get isValidate(){return!rn.StringUtils.isNullOrEmpty(this.name)&&this.minorFont.isValid&&this.majorFont.isValid}getTypeface(e,t){return e==Tn.None?"":e==Tn.Minor?this.minorFont.getTypeface(t):this.majorFont.getTypeface(t)}copyFrom(e){this.name=e.name,this.majorFont.copyFrom(e.majorFont),this.minorFont.copyFrom(e.minorFont)}clear(){this.name="",this.majorFont.clear(),this.minorFont.clear()}}class Po{constructor(){this.backgroundFillStyleList=[],this.fillStyleList=[],this.lineStyleList=[],this.effectStyleList=[],this.name=""}get isValidate(){return this.checkValidation()}getOutlineByType(e){return this.getElementByType(e,this.lineStyleList)}getOutlineByIndex(e){return this.getElementByIndex(e,this.lineStyleList)}getFillByType(e){return this.getElementByType(e,this.fillStyleList)}getFillByIndex(e){return e<1e3?this.getElementByIndex(e,this.fillStyleList):this.getElementByIndex(e-1e3,this.backgroundFillStyleList)}getEffectStyle(e){return this.getElementByType(e,this.effectStyleList)}getElementByType(e,t){return e==vn.Subtle?t[0]:e==vn.Moderate?t[1]:e==vn.Intense?t[2]:null}getElementByIndex(e,t){const r=t.length;return e<1||0==r?null:t[Math.min(e,r)-1]}checkValidation(){return this.backgroundFillStyleList.length>=3&&this.fillStyleList.length>=3&&this.lineStyleList.length>=3&&this.effectStyleList.length>=3}copyFrom(e){this.clear(),this.name=e.name,this.backgroundFillStyleList=f.ListUtils.map(e.backgroundFillStyleList,(e=>e.clone())),this.fillStyleList=f.ListUtils.map(e.fillStyleList,(e=>e.clone())),this.lineStyleList=f.ListUtils.map(e.lineStyleList,(e=>e.clone())),this.effectStyleList=f.ListUtils.map(e.effectStyleList,(e=>e.clone()))}clear(){this.name="",f.ListUtils.clear(this.backgroundFillStyleList),f.ListUtils.clear(this.fillStyleList),f.ListUtils.clear(this.lineStyleList),f.ListUtils.clear(this.effectStyleList)}}class wo{constructor(){this.name="",this.colors=new bo,this.fontScheme=new Io,this.formatScheme=new Po}get isValidate(){return!rn.StringUtils.isNullOrEmpty(this.name)&&this.colors.isValidate&&this.fontScheme.isValidate&&this.formatScheme.isValidate}copyFrom(e){this.name=e.name,this.colors.copyFrom(e.colors),this.fontScheme.copyFrom(e.fontScheme),this.formatScheme.copyFrom(e.formatScheme)}clear(){this.name="",this.colors.clear(),this.fontScheme.clear(),this.formatScheme.clear()}clone(){var e=new wo;return e.copyFrom(this),e}}var yo,xo,To,vo,Mo,Eo,Do,Fo,Ro,Lo,Bo=__webpack_require__(8785);class Ao{constructor(e,t){this.distance=e,this.colorIndex=t}static comparator(e,t){return e.distance-t.distance}}class No{static RGB(e,t){return Math.sqrt(Math.pow((w.i.getRed(e)-w.i.getRed(t))/255,2)+Math.pow((w.i.getGreen(e)-w.i.getGreen(t))/255,2)+Math.pow((w.i.getBlue(e)-w.i.getBlue(t))/255,2))}static HSB(e,t){const r=H.fromColorRGB(e),i=H.fromColorRGB(t);let n=Math.abs(r.hue-i.hue);n>180&&(n=360-n),n/=57.3;return 3*Math.abs(r.luminance-i.luminance)+n+1.5*Math.abs(r.saturation-i.saturation)}}class ko{constructor(){this.reset()}getColorByIndex(e){const t=this.colorTable[e];if(void 0===t)throw new Error(R.D.InternalException);return t}setColor(e,t){const r=this.colorTable[e];if(void 0===r)throw new Error(R.D.InternalException);r!=t&&(this.isCustomIndexedColorTable=!0,this.colorTable[e]=t)}reset(){const e=Rn.scrollBar;this.colorTable={0:w.i.fromArgbNumber(0,0,0,0),1:w.i.fromArgbNumber(0,255,255,255),2:w.i.fromArgbNumber(0,255,0,0),3:w.i.fromArgbNumber(0,0,255,0),4:w.i.fromArgbNumber(0,0,0,255),5:w.i.fromArgbNumber(0,255,255,0),6:w.i.fromArgbNumber(0,255,0,255),7:w.i.fromArgbNumber(0,0,255,255),8:w.i.fromArgbNumber(0,0,0,0),9:w.i.fromArgbNumber(0,255,255,255),10:w.i.fromArgbNumber(0,255,0,0),11:w.i.fromArgbNumber(0,0,255,0),12:w.i.fromArgbNumber(0,0,0,255),13:w.i.fromArgbNumber(0,255,255,0),14:w.i.fromArgbNumber(0,255,0,255),15:w.i.fromArgbNumber(0,0,255,255),16:w.i.fromArgbNumber(0,128,0,0),17:w.i.fromArgbNumber(0,0,128,0),18:w.i.fromArgbNumber(0,0,0,128),19:w.i.fromArgbNumber(0,128,128,0),20:w.i.fromArgbNumber(0,128,0,128),21:w.i.fromArgbNumber(0,0,128,128),22:w.i.fromArgbNumber(0,192,192,192),23:w.i.fromArgbNumber(0,128,128,128),24:w.i.fromArgbNumber(0,153,153,255),25:w.i.fromArgbNumber(0,153,51,102),26:w.i.fromArgbNumber(0,255,255,204),27:w.i.fromArgbNumber(0,204,255,255),28:w.i.fromArgbNumber(0,102,0,102),29:w.i.fromArgbNumber(0,255,128,128),30:w.i.fromArgbNumber(0,0,102,204),31:w.i.fromArgbNumber(0,204,204,255),32:w.i.fromArgbNumber(0,0,0,128),33:w.i.fromArgbNumber(0,255,0,255),34:w.i.fromArgbNumber(0,255,255,0),35:w.i.fromArgbNumber(0,0,255,255),36:w.i.fromArgbNumber(0,128,0,128),37:w.i.fromArgbNumber(0,128,0,0),38:w.i.fromArgbNumber(0,0,128,128),39:w.i.fromArgbNumber(0,0,0,255),40:w.i.fromArgbNumber(0,0,204,255),41:w.i.fromArgbNumber(0,204,255,255),42:w.i.fromArgbNumber(0,204,255,204),43:w.i.fromArgbNumber(0,255,255,153),44:w.i.fromArgbNumber(0,153,204,255),45:w.i.fromArgbNumber(0,255,153,204),46:w.i.fromArgbNumber(0,204,153,255),47:w.i.fromArgbNumber(0,255,204,153),48:w.i.fromArgbNumber(0,51,102,255),49:w.i.fromArgbNumber(0,51,204,204),50:w.i.fromArgbNumber(0,153,204,0),51:w.i.fromArgbNumber(0,255,204,0),52:w.i.fromArgbNumber(0,255,153,0),53:w.i.fromArgbNumber(0,255,102,0),54:w.i.fromArgbNumber(0,102,102,153),55:w.i.fromArgbNumber(0,150,150,150),56:w.i.fromArgbNumber(0,0,51,102),57:w.i.fromArgbNumber(0,51,153,102),58:w.i.fromArgbNumber(0,0,51,0),59:w.i.fromArgbNumber(0,51,51,0),60:w.i.fromArgbNumber(0,153,51,0),61:w.i.fromArgbNumber(0,153,51,102),62:w.i.fromArgbNumber(0,51,51,153),63:w.i.fromArgbNumber(0,51,51,51),[ko.SystemWindowFrameColorIndex]:Rn.windowFrame,[ko.System3DFaceColorIndex]:Rn.control,[ko.System3DTextColorIndex]:Rn.controlText,[ko.System3DHighlightColorIndex]:Rn.controlLight,[ko.System3DShadowColorIndex]:Rn.controlDark,[ko.SystemHighlightColorIndex]:Rn.highlight,[ko.SystemControlTextColorIndex]:Rn.controlText,[ko.SystemControlScrollColorIndex]:e,[ko.SystemControlInverseColorIndex]:U.fromArgb(0,e),[ko.SystemControlBodyColorIndex]:Rn.window,[ko.SystemControlFrameColorIndex]:Rn.windowFrame,[ko.DefaultForegroundColorIndex]:Rn.windowText,[ko.DefaultBackgroundColorIndex]:Rn.window,[ko.DefaultChartForegroundColorIndex]:w.i.fromArgbNumber(0,0,0,0),[ko.DefaultChartBackgroundColorIndex]:w.i.fromArgbNumber(0,255,255,255),[ko.ChartNeutralColorIndex]:w.i.fromArgbNumber(0,0,0,0),[ko.ToolTipFillColorIndex]:Rn.info,[ko.ToolTipTextColorIndex]:Rn.infoText,[ko.FontAutomaticColorIndex]:U.empty}}get defaultForegroundColor(){return this.colorTable[ko.DefaultForegroundColorIndex]}set defaultForegroundColor(e){this.colorTable[ko.DefaultForegroundColorIndex]=e}get defaultBackgroundColor(){return this.colorTable[ko.DefaultBackgroundColorIndex]}set defaultBackgroundColor(e){this.colorTable[ko.DefaultBackgroundColorIndex]=e}get defaultChartForegroundColor(){return this.colorTable[ko.DefaultChartForegroundColorIndex]}set defaultChartForegroundColor(e){this.colorTable[ko.DefaultChartForegroundColorIndex]=e}get defaultChartBackgroundColor(){return this.colorTable[ko.DefaultChartBackgroundColorIndex]}set defaultChartBackgroundColor(e){this.colorTable[ko.DefaultChartBackgroundColorIndex]=e}get chartNeutralColor(){return this.colorTable[ko.ChartNeutralColorIndex]}get toolTipTextColor(){return this.colorTable[ko.ToolTipTextColorIndex]}set toolTipTextColor(e){this.colorTable[ko.ToolTipTextColorIndex]=e}get fontAutomaticColor(){return this.colorTable[ko.FontAutomaticColorIndex]}set fontAutomaticColor(e){this.colorTable[ko.FontAutomaticColorIndex]=e}isValidColorIndex(e){return void 0!==this.colorTable[e]}getColorIndex(e,t,r){return xe.defaultItem.equals(t)||t.colorType==V.Auto?r?ko.DefaultForegroundColorIndex:ko.DefaultBackgroundColorIndex:t.colorType==V.Index?this.isValidColorIndex(t.colorIndex)?t.colorIndex:r?ko.DefaultForegroundColorIndex:ko.DefaultBackgroundColorIndex:this.getPaletteNearestColorIndex(t.toRgb(e))}getFontColorIndex(e,t){return t.colorType==V.Auto?ko.FontAutomaticColorIndex:t.colorType==V.Index?this.isValidColorIndex(t.colorIndex)?t.colorIndex:ko.FontAutomaticColorIndex:this.getPaletteNearestColorIndex(t.toRgb(e))}getColorIndexByRgbColor(e){let t=this.getExactColorIndex(e,new Cn.e(0,ko.FontAutomaticColorIndex+1));return-1!=t||255==w.i.getAlpha(e)&&(e=U.fromArgb(0,e),t=this.getExactColorIndex(e,new Cn.e(0,ko.FontAutomaticColorIndex+1)),-1!=t)?t:ko.DefaultForegroundColorIndex}getExactColorIndex(e,t){const r=b.j.keyBy(this.colorTable,((r,i)=>t.contains(i)&&r==e));return null===r?-1:r}getNearestColorIndex(e){const t=this.getExactColorIndex(e,new Cn.e(0,64));return-1!=t?t:this.getNearestColorIndexCore(e,new Cn.e(0,64))}getPaletteNearestColorIndex(e){const t=this.getExactColorIndex(e,new Cn.e(8,63));return-1!=t?t:this.getNearestColorIndexCore(e,new Cn.e(8,64))}isCompatibleColors(e,t){return w.i.isGray(e)==w.i.isGray(t)}getColorDistance(e,t,r){return No.HSB(e,t)+No.RGB(e,t)*r}getNearestColorIndexCore(e,t){const r=[];b.j.forEach(this.colorTable,((i,n)=>{t.contains(n)&&this.isCompatibleColors(i,e)&&r.push(new Ao(this.getColorDistance(e,i,3),n))})),r.sort(Ao.comparator);r.length>5&&r.splice(5);let i=-1,n=Bo.Constants.MAX_SAFE_INTEGER;for(let t of r)if(-1==i)i=t.colorIndex,n=this.getColorDistance(e,this.colorTable[t.colorIndex],1.5);else{const r=this.getColorDistance(e,this.colorTable[t.colorIndex],1.5);r<n&&(i=t.colorIndex,n=r)}return i}clone(){const e=new ko;return e.isCustomIndexedColorTable=this.isCustomIndexedColorTable,e.colorTable=b.j.shallowCopy(this.colorTable),e}}ko.BuiltInColorsCount=8,ko.DefaultForegroundColorIndex=64,ko.DefaultBackgroundColorIndex=65,ko.SystemWindowFrameColorIndex=66,ko.System3DFaceColorIndex=67,ko.System3DTextColorIndex=68,ko.System3DHighlightColorIndex=69,ko.System3DShadowColorIndex=70,ko.SystemHighlightColorIndex=71,ko.SystemControlTextColorIndex=72,ko.SystemControlScrollColorIndex=73,ko.SystemControlInverseColorIndex=74,ko.SystemControlBodyColorIndex=75,ko.SystemControlFrameColorIndex=76,ko.DefaultChartForegroundColorIndex=77,ko.DefaultChartBackgroundColorIndex=78,ko.ChartNeutralColorIndex=79,ko.ToolTipFillColorIndex=80,ko.ToolTipTextColorIndex=81,ko.FontAutomaticColorIndex=32767;class Oo{constructor(e){this.rangePermissionColors={},this.rangePermissionColorIndex=0,this.colorModelInfoCache=e,this.officeTheme=new wo,this.palette=new ko}getRgbaFromModelColor(e){return e.toRgb(this)}getModelColorFromRgba(e){return this.colorModelInfoCache.getItem(he.makeByColor(e))}getColor(){this.rangePermissionColorIndex>=fo.defaultColors.length&&(this.rangePermissionColorIndex=0);const e=fo.defaultColors[this.rangePermissionColorIndex];return this.rangePermissionColorIndex++,e}clone(e){const t=new Oo(e);return t.officeTheme=this.officeTheme.clone(),t.palette=this.palette.clone(),t.rangePermissionColors=B.StringMapUtils.map(this.rangePermissionColors,(e=>""+e)),t}}!function(e){e[e.Main=0]="Main",e[e.Header=1]="Header",e[e.Footer=2]="Footer",e[e.TextBox=3]="TextBox",e[e.FootNote=4]="FootNote",e[e.EndNote=5]="EndNote"}(yo||(yo={})),function(e){e[e.DefaultTabWidth=0]="DefaultTabWidth",e[e.OddEvenPages=1]="OddEvenPages",e[e.PageColor=2]="PageColor"}(xo||(xo={})),function(e){e[e.DocumentProperties=0]="DocumentProperties",e[e.Styles=1]="Styles",e[e.Sections=2]="Sections",e[e.AbstractNumberingLists=3]="AbstractNumberingLists",e[e.NumberingLists=4]="NumberingLists",e[e.Headers=5]="Headers",e[e.Footers=6]="Footers",e[e.AbstractNumberingListTemplates=7]="AbstractNumberingListTemplates",e[e.Images=8]="Images",e[e.PaletteColors=9]="PaletteColors",e[e.OfficeThemeColors=10]="OfficeThemeColors",e[e.CompatibilitySettings=11]="CompatibilitySettings"}(To||(To={})),function(e){e[e.EnforceProtection=0]="EnforceProtection",e[e.ProtectionType=1]="ProtectionType",e[e.HashAlgorithmType=2]="HashAlgorithmType",e[e.HashIterationCount=3]="HashIterationCount",e[e.PasswordHash=4]="PasswordHash",e[e.PasswordPrefix=5]="PasswordPrefix",e[e.Word2003PasswordHash=6]="Word2003PasswordHash",e[e.OpenOfficePasswordHash=7]="OpenOfficePasswordHash"}(vo||(vo={})),function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.AllowComments=2]="AllowComments",e[e.TrackedChanges=3]="TrackedChanges"}(Mo||(Mo={})),function(e){e[e.DefaultTabWidth=0]="DefaultTabWidth",e[e.DifferentOddAndEvenPages=1]="DifferentOddAndEvenPages",e[e.DisplayBackgroundShape=2]="DisplayBackgroundShape",e[e.PageBackColor=3]="PageBackColor",e[e.DefaultCharacterProperties=4]="DefaultCharacterProperties",e[e.DefaultParagraphProperties=5]="DefaultParagraphProperties",e[e.DefaultTableProperties=6]="DefaultTableProperties",e[e.DefaultTableRowProperties=7]="DefaultTableRowProperties",e[e.DefaultTableCellProperties=8]="DefaultTableCellProperties",e[e.ProtectionProperties=9]="ProtectionProperties"}(Eo||(Eo={})),function(e){e[e.DontJustifyLinesEndingInSoftLineBreak=0]="DontJustifyLinesEndingInSoftLineBreak",e[e.CompatibilityMode=1]="CompatibilityMode"}(Do||(Do={}));class _o{static convertFromJSON(e,t,r,i){var n=new Pe;return n.fontSize=e[v.Size],n.fontBold=!!e[v.Bold],n.fontItalic=!!e[v.Italic],n.fontStrikeoutType=e[v.StrikeoutType],n.fontUnderlineType=e[v.UnderlineType],n.allCaps=!!e[v.AllCaps],n.smallCaps=!!e[v.SmallCaps],n.strikeoutWordsOnly=!!e[v.StrikeoutWordsOnly],n.underlineWordsOnly=!!e[v.UnderlineWordsOnly],n.script=e[v.Script],n.hidden=!!e[v.Hidden],n.noProof=!!e[v.NoProof],n.setUseValueFull(e[v.UseValue]),n.langInfo=Uo.convertFromJSON(e[v.LangInfo]),n.fontInfo=i instanceof _n?i.getItemByJsonKey(e[v.FontInfoIndex]):i(e[v.FontInfoIndex]),n.textColor=t.getItemByJsonKey(e[v.TextColorIndex]),n.shadingInfo=r.getItemByJsonKey(e[v.ShadingInfoIndex]),n.highlightColor=t.getItemByJsonKey(e[v.HighlightColorIndex]),n.underlineColor=t.getItemByJsonKey(e[v.UnderlineColorIndex]),n.strikeoutColor=t.getItemByJsonKey(e[v.StrikeoutColorIndex]),n}static convertToJSON(e){var t={};return t[v.FontName]=e.fontInfo.name,t[v.Size]=e.fontSize,t[v.Bold]=(0,S.boolToInt)(e.fontBold),t[v.Italic]=(0,S.boolToInt)(e.fontItalic),t[v.StrikeoutType]=e.fontStrikeoutType,t[v.UnderlineType]=e.fontUnderlineType,t[v.AllCaps]=(0,S.boolToInt)(e.allCaps),t[v.SmallCaps]=(0,S.boolToInt)(e.smallCaps),t[v.StrikeoutWordsOnly]=(0,S.boolToInt)(e.strikeoutWordsOnly),t[v.UnderlineWordsOnly]=(0,S.boolToInt)(e.underlineWordsOnly),t[v.TextColor]=ue.convertToJSON(e.textColor),t[v.ShadingInfo]=pe.convertToJSON(e.shadingInfo),t[v.HighlightColor]=ue.convertToJSON(e.highlightColor),t[v.UnderlineColor]=ue.convertToJSON(e.underlineColor),t[v.StrikeoutColor]=ue.convertToJSON(e.strikeoutColor),t[v.Script]=e.script,t[v.Hidden]=(0,S.boolToInt)(e.hidden),t[v.NoProof]=(0,S.boolToInt)(e.noProof),t[v.UseValue]=e.getUseValueFull(),t[v.LangInfo]=Uo.convertToJSON(e.langInfo),t}}class Uo{static convertFromJSON(e){const t=new Ce;return t.bidi=e[M.Bidi]||"",t.eastAsia=e[M.EastAsia]||"",t.latin=e[M.Latin]||"",t}static convertToJSON(e){const t={};return t[M.Bidi]=e?e.bidi:"",t[M.EastAsia]=e?e.eastAsia:"",t[M.Latin]=e?e.latin:"",t}}class Ho{static convertFromJSON(e,t){const r=new Me;return r.style=e[j.Style],r.color=t.getItemByJsonKey(e[j.ColorIndex]),r.color||(r.color=ue.convertFromJSON(e[j.Color])),r.width=e[j.Width],r.offset=e[j.Offset],r.frame=!!e[j.Frame],r.shadow=!!e[j.Shadow],r}static convertToJSON(e){const t={};return t[j.Style]=e.style,t[j.Color]=ue.convertToJSON(e.color),t[j.Width]=e.width,t[j.Offset]=e.offset,t[j.Frame]=(0,S.boolToInt)(e.frame),t[j.Shadow]=(0,S.boolToInt)(e.shadow),t}}class Vo{static convertFromJSON(e,t,r){var i=new Lt;return i.alignment=e[Ee.Alignment],i.firstLineIndent=e[Ee.FirstLineIndent],i.firstLineIndentType=e[Ee.FirstLineIndentType],i.leftIndent=e[Ee.LeftIndent],i.lineSpacing=e[Ee.LineSpacing],i.lineSpacingType=e[Ee.LineSpacingType],i.rightIndent=e[Ee.RightIndent],i.spacingBefore=e[Ee.SpacingBefore],i.spacingAfter=e[Ee.SpacingAfter],i.suppressHyphenation=!!e[Ee.SuppressHyphenation],i.suppressLineNumbers=!!e[Ee.SuppressLineNumbers],i.contextualSpacing=!!e[Ee.ContextualSpacing],i.pageBreakBefore=!!e[Ee.PageBreakBefore],i.beforeAutoSpacing=!!e[Ee.BeforeAutoSpacing],i.afterAutoSpacing=!!e[Ee.AfterAutoSpacing],i.keepWithNext=!!e[Ee.KeepWithNext],i.keepLinesTogether=!!e[Ee.KeepLinesTogether],i.widowOrphanControl=!!e[Ee.WidowOrphanControl],i.outlineLevel=e[Ee.OutlineLevel],i.shadingInfo=r.getItemByJsonKey(e[Ee.ShadingInfoIndex]),i.leftBorder=Ho.convertFromJSON(e[Ee.LeftBorder],t),i.rightBorder=Ho.convertFromJSON(e[Ee.RightBorder],t),i.topBorder=Ho.convertFromJSON(e[Ee.TopBorder],t),i.bottomBorder=Ho.convertFromJSON(e[Ee.BottomBorder],t),i.betweenBorder=Ho.convertFromJSON(e[Ee.BetweenBorder],t),i.divId=e[Ee.DivId],i.rightToLeft=e[Ee.RightToLeft],i.useValue=e[Ee.UseValue],i}static convertToJSON(e){var t={};return t[Ee.Alignment]=e.alignment,t[Ee.FirstLineIndent]=e.firstLineIndent,t[Ee.FirstLineIndentType]=e.firstLineIndentType,t[Ee.LeftIndent]=e.leftIndent,t[Ee.LineSpacing]=e.lineSpacing,t[Ee.LineSpacingType]=e.lineSpacingType,t[Ee.RightIndent]=e.rightIndent,t[Ee.SpacingBefore]=e.spacingBefore,t[Ee.SpacingAfter]=e.spacingAfter,t[Ee.SuppressHyphenation]=(0,S.boolToInt)(e.suppressHyphenation),t[Ee.SuppressLineNumbers]=(0,S.boolToInt)(e.suppressLineNumbers),t[Ee.ContextualSpacing]=(0,S.boolToInt)(e.contextualSpacing),t[Ee.PageBreakBefore]=(0,S.boolToInt)(e.pageBreakBefore),t[Ee.BeforeAutoSpacing]=(0,S.boolToInt)(e.beforeAutoSpacing),t[Ee.AfterAutoSpacing]=(0,S.boolToInt)(e.afterAutoSpacing),t[Ee.KeepWithNext]=(0,S.boolToInt)(e.keepWithNext),t[Ee.KeepLinesTogether]=(0,S.boolToInt)(e.keepLinesTogether),t[Ee.WidowOrphanControl]=(0,S.boolToInt)(e.widowOrphanControl),t[Ee.OutlineLevel]=e.outlineLevel,t[Ee.ShadingInfo]=pe.convertToJSON(e.shadingInfo),t[Ee.LeftBorder]=Ho.convertToJSON(e.leftBorder),t[Ee.RightBorder]=Ho.convertToJSON(e.rightBorder),t[Ee.TopBorder]=Ho.convertToJSON(e.topBorder),t[Ee.BottomBorder]=Ho.convertToJSON(e.bottomBorder),t[Ee.BetweenBorder]=Ho.convertToJSON(e.betweenBorder),t[Ee.DivId]=e.divId,t[Ee.RightToLeft]=(0,S.boolToInt)(e.rightToLeft),t[Ee.UseValue]=e.useValue,t}}class Wo{constructor(e){this.counters=[],this.usedListIndecies={},this.currentParagraphIndex=-1,this.list=e;for(var t,r=0;t=this.list.levels[r];r++)this.counters.push(t.getListLevelProperties().start-1)}calculateCounters(e){return this.currentParagraphIndex=-1,this.calculateNextCounters(e)}calculateNextCounters(e){if(e.subDocument.paragraphs[this.currentParagraphIndex]!==e)for(var t,r=e.getAbstractNumberingList(),i=this.currentParagraphIndex+1;(t=e.subDocument.paragraphs[i])&&(this.currentParagraphIndex++,this.shouldAdvanceListLevelCounters(t,r)&&this.advanceListLevelCounters(t,t.getListLevelIndex()),t!==e);i++);return this.getActualRangeCounters(e.getListLevelIndex())}getLastCounters(e){return this.getActualRangeCounters(e.getListLevelIndex())}shouldAdvanceListLevelCounters(e,t){return e.getAbstractNumberingList()===t}advanceListLevelCounters(e,t){var r=e.getNumberingListIndex(),i=e.subDocument.documentModel.numberingLists[r].levels[t];i.overrideStart&&!this.usedListIndecies[r]?(this.usedListIndecies[r]=!0,this.counters[t]=i.getNewStart()):this.counters[t]++,this.advanceSkippedLevelCounters(t),this.restartNextLevelCounters(t)}advanceSkippedLevelCounters(e){for(var t=0;t<e;t++){var r=this.list.levels[t];this.counters[t]==r.getListLevelProperties().start-1&&this.counters[t]++}}restartNextLevelCounters(e){var t=[];t[e]=!0;for(var r=this.counters.length,i=e+1;i<r;i++){var n=this.list.levels[i].getListLevelProperties();if(!n.suppressRestart){var o=i-n.relativeRestartLevel-1;o>=0&&o<r&&t[o]&&(this.counters[i]=n.start-1,t[i]=!0)}}}getActualRangeCounters(e){for(var t=[],r=0;r<=e;r++)t[r]=this.counters[r];return t}}class zo{constructor(e){this.documentModel=e,this.lastId=0}getMap(){if(!this.map){this.map={};for(var e,t=0;e=this.getLists()[t];t++)this.map[e.innerId]=!0}return this.map}getNextId(){const e=this.getMap();do{this.lastId++}while(e[this.lastId]);return e[this.lastId]=!0,this.lastId}}class jo extends zo{getLists(){return this.documentModel.numberingLists}clone(e){const t=new jo(e);return t.map=b.j.shallowCopy(this.map),t}}class Xo extends zo{getLists(){return this.documentModel.abstractNumberingLists}clone(e){const t=new Xo(e);return t.map=b.j.shallowCopy(this.map),t}}!function(e){e[e.None=0]="None",e[e.Md2=1]="Md2",e[e.Md4=2]="Md4",e[e.Md5=3]="Md5",e[e.Sha1=4]="Sha1",e[e.Mac=5]="Mac",e[e.Ripemd=6]="Ripemd",e[e.Ripemd160=7]="Ripemd160",e[e.HMac=9]="HMac",e[e.Sha256=12]="Sha256",e[e.Sha384=13]="Sha384",e[e.Sha512=14]="Sha512"}(Fo||(Fo={})),function(e){e[e.RsaFull=0]="RsaFull",e[e.RsaAES=1]="RsaAES"}(Ro||(Ro={}));class Go{constructor(){this.enforceProtection=!1}copyFrom(e){this.enforceProtection=e.enforceProtection,this.protectionType=e.protectionType,this.hashAlgorithmType=e.hashAlgorithmType,this.cryptProviderType=e.cryptProviderType,this.hashIterationCount=e.hashIterationCount,this.passwordHash=e.passwordHash?new Uint8Array(e.passwordHash):null,this.passwordPrefix=e.passwordPrefix?new Uint8Array(e.passwordPrefix):null,this.word2003PasswordHash=e.word2003PasswordHash?new Uint8Array(e.word2003PasswordHash):null,this.openOfficePasswordHash=e.openOfficePasswordHash?new Uint8Array(e.openOfficePasswordHash):null}clone(){const e=new Go;return e.copyFrom(this),e}}class Ko{constructor(){this.maxValue=Bo.Constants.MAX_SAFE_INTEGER,this.minValue=Bo.Constants.MIN_SAFE_INTEGER}convertNumber(e){if(e>=this.minValue&&e<=this.maxValue)return this.convertNumberCore(e);throw new Error("InvalidNumberConverterValue")}}class qo extends Ko{constructor(e){super(),this.simpleFormattersManager=e,this.type=Zi.Ordinal}}class $o extends qo{constructor(e){super(e),this.ending=["st","nd","rd","th"]}convertNumberCore(e){var t=e%100;if(t<21)switch(t){case 1:return this.simpleFormattersManager.formatString("{0}{1}",e,this.ending[0]);case 2:return this.simpleFormattersManager.formatString("{0}{1}",e,this.ending[1]);case 3:return this.simpleFormattersManager.formatString("{0}{1}",e,this.ending[2]);default:return this.simpleFormattersManager.formatString("{0}{1}",e,this.ending[3])}return(t=--e%10)<3?this.simpleFormattersManager.formatString("{0}{1}",e+1,this.ending[t%3]):this.simpleFormattersManager.formatString("{0}{1}",e+1,this.ending[3])}}class Jo extends qo{constructor(e){super(e)}convertNumberCore(e){return 1==e?this.simpleFormattersManager.formatString("{0}er",e):this.simpleFormattersManager.formatString("{0}e",e)}}class Yo extends qo{constructor(e){super(e)}convertNumberCore(e){return this.simpleFormattersManager.formatString("{0}.",e)}}class Qo extends qo{constructor(e){super(e)}convertNumberCore(e){return this.simpleFormattersManager.formatString("{0}°",e)}}class Zo extends qo{constructor(e){super(e)}convertNumberCore(e){return this.simpleFormattersManager.formatString("{0}.",e)}}class ea extends qo{constructor(e){super(e)}convertNumberCore(e){return this.simpleFormattersManager.formatString("{0}ο",e)}}class ta extends qo{constructor(e){super(e)}convertNumberCore(e){return this.simpleFormattersManager.formatString("{0}°",e)}}class ra extends qo{constructor(e){super(e)}convertNumberCore(e){return this.simpleFormattersManager.formatString("{0}º",e)}}class ia extends qo{constructor(e){super(e)}convertNumberCore(e){return this.simpleFormattersManager.formatString("{0}-й",e)}}class na extends qo{constructor(e){super(e)}convertNumberCore(e){return this.simpleFormattersManager.formatString("{0}-й",e)}}class oa extends qo{constructor(e){super(e)}convertNumberCore(e){return e%10==1||e%10==2?this.simpleFormattersManager.formatString("{0}:a",e):this.simpleFormattersManager.formatString("{0}:e",e)}}class aa extends Ko{constructor(){super(),this.type=Zi.Bullet}convertNumberCore(e){return"•"}}class sa extends Ko{constructor(e){super(),this.simpleFormattersManager=e,this.type=Zi.DecimalEnclosedParentheses}convertNumberCore(e){return this.simpleFormattersManager.formatString("({0})",e)}}class la extends Ko{constructor(){super(),this.type=Zi.Decimal}convertNumberCore(e){return e.toString()}}class da extends Ko{constructor(e){super(),this.simpleFormattersManager=e,this.type=Zi.DecimalZero}convertNumberCore(e){return e<10?this.simpleFormattersManager.formatString("0{0}",e):e.toString()}}class ca{constructor(e,t,r,i,n,o,a,s,l,d,c,h){this.separator=e,this.singlesNumeral=t,this.singles=r,this.teens=i,this.tenths=n,this.hundreds=o,this.thousands=a,this.million=s,this.billion=l,this.trillion=d,this.quadrillion=c,this.quintillion=h}}class ha extends ca{constructor(){super([" ","-"],["first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","zeroth"],["first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","zeroth"],["tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth"],["twentieth","thirtieth","fortieth","fiftieth","sixtieth","seventieth","eightieth","ninetieth"],["one hundredth","two hundredth","three hundredth","four hundredth","five hundredth","six hundredth","seven hundredth","eight hundredth","nine hundredth"],["thousandth"],["millionth"],["billionth"],["trillionth"],["quadrillionth"],["quintillionth"])}}class ua extends ca{constructor(){super([" ","-"],["one","two","three","four","five","six","seven","eight","nine","zero"],["one","two","three","four","five","six","seven","eight","nine","zero"],["ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],["twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],["one hundred","two hundred","three hundred","four hundred","five hundred","six hundred","seven hundred","eight hundred","nine hundred"],["thousand"],["million"],["billion"],["trillion"],["quadrillion"],["quintillion"])}}!function(e){e[e.Zero=0]="Zero",e[e.SingleNumeral=1]="SingleNumeral",e[e.Single=2]="Single",e[e.Teen=3]="Teen",e[e.Tenth=4]="Tenth",e[e.Hundred=5]="Hundred",e[e.Thousand=6]="Thousand",e[e.Million=7]="Million",e[e.Billion=8]="Billion",e[e.Trillion=9]="Trillion",e[e.Quadrillion=10]="Quadrillion",e[e.Quintillion=11]="Quintillion",e[e.Separator=12]="Separator"}(Lo||(Lo={}));class pa{constructor(e,t,r){this.provider=e,this.value=t,this.type=r}convertToString(){return this.getNumerics()[this.value]}getNumerics(){return[]}}class ga extends pa{constructor(e,t){super(e,t,Lo.Separator)}getNumerics(){return this.provider.separator}}class ma extends pa{constructor(e,t){super(e,t,Lo.Quintillion)}getNumerics(){return this.provider.quintillion}}class fa extends pa{constructor(e,t){super(e,t,Lo.Quadrillion)}getNumerics(){return this.provider.quadrillion}}class ba extends pa{constructor(e,t){super(e,t,Lo.Trillion)}getNumerics(){return this.provider.trillion}}class Ca extends pa{constructor(e,t){super(e,t,Lo.Billion)}getNumerics(){return this.provider.billion}}class Sa extends pa{constructor(e,t){super(e,t,Lo.Million)}getNumerics(){return this.provider.million}}class Ia extends pa{constructor(e,t){super(e,t,Lo.Million)}getNumerics(){return this.provider.thousands}}class Pa extends pa{constructor(e,t){super(e,t-1,Lo.Hundred)}getNumerics(){return this.provider.hundreds}}class wa extends pa{constructor(e,t){super(e,t-2,Lo.Tenth)}getNumerics(){return this.provider.tenths}}class ya extends pa{constructor(e,t){super(e,t,Lo.Teen)}getNumerics(){return this.provider.teens}}class xa extends pa{constructor(e,t){super(e,t-1,Lo.Single)}getNumerics(){return this.provider.singles}}class Ta extends pa{constructor(e){super(e,9,Lo.Zero)}getNumerics(){return this.provider.singles}}class va extends Ko{constructor(){super(),this.minValue=0}convertNumberCore(e){var t=this.generateDigits(e);return this.convertDigitsToString(t)}generateDigits(e){var t=[];return 0==(t=this.generateDigitsCore(t,e)).length&&this.addZero(t),t}generateDigitsCore(e,t){var r=t;return 0!=Math.floor(r/1e18)&&this.generateQuintillionDigits(e,Math.floor(r/1e18)),r%=1e18,0!=Math.floor(r/1e15)&&this.generateQuadrillionDigits(e,Math.floor(r/1e15)),r%=1e15,0!=Math.floor(r/1e12)&&this.generateTrillionDigits(e,Math.floor(r/1e12)),r%=1e12,0!=Math.floor(r/1e9)&&this.generateBillionDigits(e,Math.floor(r/1e9)),r%=1e9,0!=Math.floor(r/1e6)&&this.generateMillionDigits(e,Math.floor(r/1e6)),r%=1e6,0!=Math.floor(r/1e3)&&this.generateThousandDigits(e,Math.floor(r/1e3)),r%=1e3,0!=Math.floor(r/100)&&this.generateHundredDigits(e,Math.floor(r/100)),0==(r%=100)||(r>=20?this.generateTenthsDigits(e,r):r>=10?this.generateTeensDigits(e,r%10):this.generateSinglesDigits(e,r)),e}convertDigitsToString(e){for(var t="",r=0;r<e.length;r++)t+=e[r].convertToString();return t.length>0&&(t=t[0].toUpperCase()+t.substring(1)),t}addZero(e){e.push(new Ta(new ua))}generateQuintillionDigits(e,t){this.generateDigitsCore(e,t),e.length&&e.push(new ga(new ua,0)),e.push(new ma(new ua,0))}generateQuadrillionDigits(e,t){this.generateDigitsCore(e,t),e.length&&e.push(new ga(new ua,0)),e.push(new fa(new ua,0))}generateTrillionDigits(e,t){this.generateDigitsCore(e,t),e.length&&e.push(new ga(new ua,0)),e.push(new ba(new ua,0))}generateBillionDigits(e,t){this.generateDigitsCore(e,t),e.length&&e.push(new ga(new ua,0)),e.push(new Ca(new ua,0))}generateMillionDigits(e,t){this.generateDigitsCore(e,t),e.length&&e.push(new ga(new ua,0)),e.push(new Sa(new ua,0))}generateThousandDigits(e,t){this.generateDigitsCore(e,t),e.length&&e.push(new ga(new ua,0)),e.push(new Ia(new ua,0))}generateHundredDigits(e,t){e.length&&e.push(new ga(new ua,0)),e.push(new Pa(new ua,t))}generateTenthsDigits(e,t){e.length&&e.push(new ga(new ua,0)),e.push(new wa(new ua,Math.floor(t/10))),this.generateSinglesDigits(e,t%10)}generateTeensDigits(e,t){e.length&&e.push(new ga(new ua,0)),e.push(new ya(new ua,t))}generateSinglesDigits(e,t){0!=t&&(0!=e.length&&(e[e.length-1].type==Lo.Tenth?e.push(new ga(new ua,1)):e.push(new ga(new ua,0))),e.push(new xa(new ua,t)))}}class Ma extends va{constructor(){super(),this.type=Zi.CardinalText}}class Ea extends va{constructor(){super(),this.type=Zi.OrdinalText}generateDigits(e){var t=super.generateDigits(e);return t[t.length-1].provider=new ha,t}}class Da extends Ko{constructor(){super(),this.type=Zi.Hex}convertNumberCore(e){return e.toString(16)}}class Fa extends Ko{constructor(e){super(),this.minValue=0,this.maxValue=780,this.alphabet=e}convertNumberCore(e){if(0==e)return"";e--;var t=this.alphabet.length,r=Math.floor(e/t+1),i=this.alphabet[e%t];return Array(r+1).join(i)}}class Ra extends Fa{constructor(){super(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]),this.type=Zi.UpperLetter}}class La extends Fa{constructor(){super(["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]),this.type=Zi.LowerLetter}}class Ba extends Ko{constructor(e){super(),this.simpleFormattersManager=e,this.type=Zi.NumberInDash}convertNumberCore(e){return this.simpleFormattersManager.formatString("- {0} -",e)}}class Aa extends Ko{convertNumberCore(e){for(var t="",r=this.romans.length-1;r>=0;r--)for(;e>=this.arabics[r];)e-=this.arabics[r],t+=this.romans[r];return t}}class Na extends Aa{constructor(){super(),this.type=Zi.UpperRoman,this.arabics=[1,4,5,9,10,40,50,90,100,400,500,900,1e3],this.romans=["I","IV","V","IX","X","XL","L","XC","C","CD","D","CM","M"]}}class ka extends Aa{constructor(){super(),this.type=Zi.LowerRoman,this.arabics=[1,4,5,9,10,40,50,90,100,400,500,900,1e3],this.romans=["i","iv","v","ix","x","xl","l","xc","c","cd","d","cm","m"]}}class Oa{static createConverter(e,t,r="en"){switch(e){case Zi.UpperRoman:return new Na;case Zi.LowerRoman:return new ka;case Zi.Ordinal:return Oa.getOrdinalBasedNumberConverter(t,r);case Zi.OrdinalText:return new Ea;case Zi.CardinalText:return new Ma;case Zi.UpperLetter:return new Ra;case Zi.LowerLetter:return new La;case Zi.NumberInDash:return new Ba(t);case Zi.Bullet:return new aa;case Zi.DecimalZero:return new da(t);case Zi.DecimalEnclosedParentheses:return new sa(t);case Zi.Hex:return new Da;case Zi.Decimal:default:return new la}}static getOrdinalBasedNumberConverter(e,t){switch(t.substring(0,2).toLowerCase()){case"en":return new $o(e);case"fr":return new Jo(e);case"de":return new Yo(e);case"it":return new Qo(e);case"ru":return new na(e);case"sv":return new oa(e);case"tr":return new Zo(e);case"el":return new ea(e);case"es":return new ta(e);case"pt":return new ra(e);case"uk":return new ia(e)}return new la}static createConverterByTypeName(e,t){const r=e.toUpperCase(),i=e[0];switch(r){case"ALPHABETIC":return i.toUpperCase()==i?new Ra:new La;case"ROMAN":return i.toUpperCase()==i?new Na:new ka;case"ARABIC":default:return new la;case"ARABICDASH":return new Ba(t);case"CARDTEXT":return new Ma;case"CIRCLENUM":return new sa(t);case"HEX":return new Da;case"ORDINAL":return new $o(t);case"ORDTEXT":return new Ea}}}var _a,Ua,Ha,Va=__webpack_require__(8011);!function(e){e[e.StartAndEndOnOtherColumns=0]="StartAndEndOnOtherColumns",e[e.StartOnThisColumn=1]="StartOnThisColumn",e[e.EndOnThisColumn=2]="EndOnThisColumn"}(_a||(_a={}));class Wa extends Va.Rectangle{constructor(e,t,r,i){super(t.x,t.y,t.width,t.height),this.layoutRows=[],this.parentRow=e,this.layoutRows=[],this.cellGridIndex=r,this.boundFlags=new pr.Flag(_a.StartOnThisColumn|_a.EndOnThisColumn),this.internalTables={},this.avaliableContentWidth=i}isStartWithInternalTable(){return!!this.internalTables[0]}isEndWithInternalTable(){return!!this.internalTables[this.layoutRows.length]}getLastLayoutRowIncludingInternalTables(){const e=this.internalTables[this.layoutRows.length];return e?f.ListUtils.last(f.ListUtils.last(e.tableRows).rowCells).getLastLayoutRowIncludingInternalTables():f.ListUtils.last(this.layoutRows)}getFirstLayoutRowByModelPositionIncludingInternalTables(){const e=this.internalTables[0];return e?f.ListUtils.min(e.tableRows[0].rowCells,(e=>e.getFirstLayoutRowByModelPositionIncludingInternalTables().columnOffset)).getFirstLayoutRowByModelPositionIncludingInternalTables():this.layoutRows[0]}getEndPosition(){const e=this.internalTables[this.layoutRows.length];return e?f.ListUtils.last(f.ListUtils.last(e.tableRows).rowCells).getEndPosition():f.ListUtils.last(this.layoutRows).getEndPosition()}isEmpty(){return!this.layoutRows.length&&b.j.isEmpty(this.internalTables)}}class za{constructor(){this.mask=0,this.cellSpacing=lr.createDefault(),this.cantSplit=!1,this.hideCellMark=!1,this.header=!1,this.tableRowAlignment=je.Left,this.divId=0}calculateHash(){return P.MathUtils.somePrimes[0]*this.mask^P.MathUtils.somePrimes[1]*this.cellSpacing.getHashCode()}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}equals(e){return!!e&&(this.mask==e.mask&&this.cellSpacing.equals(e.cellSpacing)&&this.cantSplit==e.cantSplit&&this.hideCellMark==e.hideCellMark&&this.header==e.header&&this.tableRowAlignment==e.tableRowAlignment&&this.divId==e.divId)}clone(){var e=new za;return e.copyFrom(this),e}copyFrom(e){this.mask=e.mask,this.cellSpacing=e.cellSpacing.clone(),this.cantSplit=e.cantSplit,this.hideCellMark=e.hideCellMark,this.header=e.header,this.tableRowAlignment=e.tableRowAlignment,this.divId=e.divId}setUseValue(e,t){t?this.mask|=e:this.mask&=~e}getUseValue(e){return!!(this.mask&e)}setValue(e,t){e.setProp(this,t),this.setUseValue(e.maskValue(),!0)}}!function(e){e[e.UseNone=0]="UseNone",e[e.UseCantSplit=2]="UseCantSplit",e[e.UseHideCellMark=4]="UseHideCellMark",e[e.UseCellSpacing=128]="UseCellSpacing",e[e.UseTableRowAlignment=256]="UseTableRowAlignment",e[e.UseShadingInfoIndex=2048]="UseShadingInfoIndex",e[e.UseHeader=1024]="UseHeader",e[e.UseDivId=4096]="UseDivId",e[e.UseAll=2147483647]="UseAll"}(Ua||(Ua={}));class ja extends br{getContainerFromConditionalStyle(e){return e.tableRowProperties}canUseValue(e){return!!(e.mask&this.getPropertyMask())}getCondTableStyleFormattingListForThisContainer(){return ja.conditionalTableStyleFormattingPriority}getNotMergedProperty(){return new Cr(!1,null)}}ja.conditionalTableStyleFormattingPriority=[qe.FirstRow,qe.LastRow,qe.OddRowBanding,qe.EvenRowBanding,qe.WholeTable];class Xa extends ja{constructor(e,t,r){super(),this.tablePropertiesException=r,this.model=e,this.table=t}getPropertyFromContainer(e){return e.cellSpacing}getPropertyMask(){return Ua.UseCellSpacing}getNotMergedProperty(){return(new Pr).getTableNotMergedProperty(this.tablePropertiesException)}actionBeforeDefaultValue(){return this.result=(new Pr).getProperty(this.table.properties,this.table.style,qe.WholeTable,this.model.defaultTableProperties),!0}}class Ga extends ja{getPropertyFromContainer(e){return e.cantSplit}getPropertyMask(){return Ua.UseCantSplit}}class Ka extends ja{constructor(e){super(),this.tablePropertiesException=e}getPropertyFromContainer(e){return e.tableRowAlignment}getPropertyMask(){return Ua.UseTableRowAlignment}actionBeforeDefaultValue(){return this.result=null,!0}getNotMergedProperty(){return(new Or).getTableNotMergedProperty(this.tablePropertiesException)}}class qa extends ja{getPropertyFromContainer(e){return e.divId}getPropertyMask(){return Ua.UseDivId}actionBeforeDefaultValue(){return this.result=null,!0}}class $a{static getTableAlignment(e){const t=new Ka(e.rows[0].tablePropertiesException).getProperty(e.rows[0].properties,e.style,e.rows[0].conditionalFormatting,null);return null!=t&&f.ListUtils.allOf(e.rows,(r=>new Ka(r.tablePropertiesException).getProperty(r.properties,e.style,r.conditionalFormatting,null)==t))?t:(new Or).getProperty(e.properties,e.style,qe.WholeTable,null)}static applyHorizontalAlignment(e,t){const r=e.logicInfo.grid.table,i=this.getTableAlignment(r),n=e.x+t-e.right;let o;switch(null!=i?i:je.Left){case je.Right:o=n;break;case je.Center:o=Math.floor(n/2);break;case je.Left:default:o=0}o<=0||$a.moveAllTable(e,(e=>e.x+=o))}static applyCellsVerticalAlignment(e,t,r,i){const n=t.table,o=n.style;for(let s of r.tableRows)for(let r of s.rowCells){if(!r.boundFlags.get(_a.StartOnThisColumn)||!r.boundFlags.get(_a.EndOnThisColumn))continue;const l=t.tableCellGridInfos[s.rowIndex][r.cellGridIndex],d=l.getStartRowIndex(),c=l.getCellIndex(0),h=n.rows[d].cells[c],u=(new Zr).getProperty(h.properties,o,h.conditionalFormatting,e),p=i[d].topAndBottomMargins,g=r.bottom-p.bottomMargin-i[s.rowIndex].cellSpacing*(s.rowIndex==n.rows.length-1?2:1),m=r.layoutRows.length,f=r.internalTables[m],C=g-(f?f.bottom:r.layoutRows[m-1].bottom);var a;switch(u){case Ke.Bottom:a=C;break;case Ke.Center:a=Math.floor(C/2);break;case Ke.Top:default:a=0}if(!(a<=0)){for(let e of r.layoutRows)e.y+=a;b.j.forEach(r.internalTables,(e=>$a.moveAllTable(e,(e=>e.y+=a))))}}}static moveAllTable(e,t){t(e);for(let r of e.tableRows){t(r);for(let e of r.rowCells){t(e),b.j.forEach(e.internalTables,(e=>$a.moveAllTable(e,t)));for(let r of e.layoutRows)t(r)}}}}class Ja{constructor(e,t){this.rows=[],this.preferredWidth=lr.createDefault(),this.lookTypes=_e.None,this.properties=e,this.style=t}getTotalVirtualColumnsCount(){return f.ListUtils.maxExtended(this.rows,(e=>e.getTotalCellsInRowConsiderGrid())).maxValue}destructor(e){for(var t,r=0;t=this.rows[r];r++)t.destructor(e)}get interval(){return on.FixedInterval.fromPositions(this.getStartPosition(),this.getEndPosition())}getParentTable(){return this.parentCell?this.parentCell.parentRow.parentTable:null}getTopLevelParent(){let e=this;for(;e.parentCell;)e=e.getParentTable();return e}getStartPosition(){return this.rows[0].getStartPosition()}getEndPosition(){return this.rows[this.rows.length-1].getEndPosition()}getLastCell(){let e=this.rows[this.rows.length-1];return e.cells[e.cells.length-1]}getFirstCell(){return this.rows[0].cells[0]}getActualLeftBorder(e,t=!0){return this.getActualBorderCore(new yr(t),e)}getActualRightBorder(e,t=!0){return this.getActualBorderCore(new xr(t),e)}getActualBottomBorder(e,t=!0){return this.getActualBorderCore(new vr(t),e)}getActualTopBorder(e,t=!0){return this.getActualBorderCore(new Tr(t),e)}getActualHorizontalBorder(e){return this.getActualBorderCore(new Er,e)}getActualVerticalBorder(e){return this.getActualBorderCore(new Mr,e)}getActualBorders(e){const t=this.getActualTopBorder(e),r=this.getActualRightBorder(e),i=this.getActualBottomBorder(e),n=this.getActualLeftBorder(e),o=this.getActualHorizontalBorder(e),a=this.getActualVerticalBorder(e);return gr.create(t,r,i,n,o,a)}getActualBorderCore(e,t){return e.getProperty(this.properties,this.style,qe.WholeTable,t)}getActualLeftMargin(e){return this.getActualMarginCore(new Dr,e)}getActualRightMargin(e){return this.getActualMarginCore(new Fr,e)}getActualTopMargin(e){return this.getActualMarginCore(new Rr,e)}getActualBottomMargin(e){return this.getActualMarginCore(new Lr,e)}getActualMarginCore(e,t){return e.getProperty(this.properties,this.style,qe.WholeTable,t)}getActualMargins(e){const t=this.getActualTopMargin(e),r=this.getActualRightMargin(e),i=this.getActualBottomMargin(e),n=this.getActualLeftMargin(e);return ar.create(t,r,i,n)}getActualTableAlignment(){return $a.getTableAlignment(this)}getActualTableIndent(e){return this.getActualTableAlignment()!=je.Left?lr.createDefault():(new Ir).getProperty(this.properties,this.style,qe.WholeTable,e)}getActualTableLayout(e){return(new Br).getProperty(this.properties,this.style,qe.WholeTable,e)}getActualShadingInfo(e){return(new Ar).getProperty(this.properties,this.style,qe.WholeTable,e)}static comparer(e,t){const r=e.getStartPosition()-t.getStartPosition();return 0==r?e.nestedLevel-t.nestedLevel:r}static sort(e){e.sort(Ja.comparer);for(let t,r=0;t=e[r];r++)t.index=r}static advanceIndices(e,t,r){for(let i,n=t;i=e[n];n++)i.index+=r}static fillTableByLevels(e){const t=e.tablesByLevels;let r=t.length;for(let i,n=0;i=e.tables[n];n++)i.index=n,i.nestedLevel>=r&&(t.push([]),r++),t[i.nestedLevel].push(i)}static getTableCellByPosition(e,t){const r=Ja.getTableByPosition(e,t,!0);return r?Ja.getTableCellByPositionFromTable(r,t):null}static getTableCellByPositionFromTable(e,t){const r=C.SearchUtils.normedInterpolationIndexOf(e.rows,(e=>e.getStartPosition()),t),i=e.rows[r],n=C.SearchUtils.normedInterpolationIndexOf(i.cells,(e=>e.startParagraphPosition.value),t);return i.cells[n]}static getTableByPosition(e,t,r,i=C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.getStartPosition()),t)){if(i<0)return null;let n=e[i];for(;t>=n.getEndPosition();){if(0===n.nestedLevel)return null;n=n.getParentTable()}return Ja.correctBoundTable(e,n.index,t,r?e=>++e:e=>--e)}static correctBoundTable(e,t,r,i){let n=e[t],o=n.getStartPosition();t=i(t);for(let a;a=e[t];t=i(t)){const e=a.getStartPosition();if(o!=e||r>=a.getEndPosition())break;o=e,n=a}return n}static getFirstCellPositionInVerticalMergingGroup(e){if(e.cell.verticalMerging!=Xe.Continue)return e;const t=e.clone().init(),r=t.row.getCellColumnIndex(t.cellIndex);for(;t.moveToPrevRow();){let e=t.row.gridBefore;t.setCell(0);do{if(r<=e){if(t.cell.verticalMerging!=Xe.Continue||0==t.rowIndex)return t;break}e+=t.cell.columnSpan}while(t.moveToNextCell())}return null}clone(e){const t=new Ja(this.properties.clone(),e.documentModel.stylesManager.getTableStyleByName(this.style.styleName));t.index=this.index,t.nestedLevel=this.nestedLevel;const r=e.tablesByLevels[t.nestedLevel];return r?r.push(t):e.tablesByLevels.push([t]),this.parentCell&&(t.parentCell=Ja.getTableCellByPositionFromTable(e.tables[this.parentCell.parentRow.parentTable.index],this.parentCell.startParagraphPosition.value)),t.rows=f.ListUtils.map(this.rows,(r=>r.clone(e,t))),t.preferredWidth=this.preferredWidth.clone(),t.lookTypes=this.lookTypes,t}}class Ya{constructor(e,t){this.rowIndex=e,this.cellIndex=t}equals(e){return e&&this.cellIndex==e.cellIndex&&this.rowIndex==e.rowIndex}copyFrom(e){this.rowIndex=e.rowIndex,this.cellIndex=e.cellIndex}clone(){return new Ya(this.rowIndex,this.cellIndex)}}class Qa extends Ya{constructor(e,t,r){super(t,r),this.table=e}initIndexes(e,t){return this.rowIndex=e,this.cellIndex=t,this}init(){return this.row=this.table.rows[this.rowIndex],this.cell=this.row.cells[this.cellIndex],this}setRow(e){return this.rowIndex=e,this.row=this.table.rows[this.rowIndex],this}setCell(e){this.cellIndex=e,this.cell=this.row.cells[e]}static createAndInit(e,t,r){const i=new Qa(e,t,r);return i.init(),i}static indexOfCell(e,t){for(let r,i=0;r=e[i];i++)if(r.cell===t)return i;return-1}moveToPrevRow(){return!!this.rowIndex&&(this.rowIndex--,this.row=this.table.rows[this.rowIndex],!0)}moveToNextRow(){return this.rowIndex!=this.table.rows.length-1&&(this.rowIndex++,this.row=this.table.rows[this.rowIndex],this.cellIndex=-1,!0)}moveToNextCell(){return this.cellIndex!=this.row.cells.length-1&&(this.cellIndex++,this.cell=this.row.cells[this.cellIndex],!0)}copyFrom(e){super.copyFrom(e),this.table=e.table,this.row=e.row,this.cell=e.cell}clone(){const e=new Qa(this.table,this.rowIndex,this.cellIndex);return e.row=this.row,e.cell=this.cell,e}equals(e){return e&&this.table==e.table&&this.rowIndex==e.rowIndex&&this.cellIndex==e.cellIndex}}class Za{constructor(e,t,r,i,n,o,a,s){this.styleName=e,this.deleted=r,this.localizedName=t,this.hidden=i,this.semihidden=n,this.isDefault=o,this.base64EncodedImage=a||null,this.id=s}equalsByName(e){return this.styleName==e.styleName}}class es extends Za{constructor(e,t,r,i,n,o,a,s,l,d,c,h,u,p){super(e,t,r,i,n,o,u,p),this.linkedStyle=null,this.nextParagraphStyle=null,this.maskedCharacterProperties=a,this.maskedParagraphProperties=s,this.tabs=l,this.autoUpdate=d,this.numberingListIndex=c,this.listLevelIndex=h}getResultTabs(){var e;const t=null===(e=this.parent)||void 0===e?void 0:e.getResultTabs(),r=this.tabs.clone();return r.merge(t),r}getMergedParagraphProperties(){const e=new $i;return e.mergeParagraphStyle(this),e.getMergedProperties()}isInOwnList(){return this.numberingListIndex>=0}isInList(){return this.getNumberingListIndex()>=0}getListLevel(e){return this.getNumberingList(e).levels[this.getListLevelIndex()]}getNumberingList(e){return e.numberingLists[this.getNumberingListIndex()]}getNumberingListIndex(){return this.numberingListIndex>=0||this.numberingListIndex===cn.NoNumberingListIndex||!this.parent?this.numberingListIndex:this.parent.getNumberingListIndex()}getListLevelIndex(){var e,t;return this.listLevelIndex>=0?this.listLevelIndex:null!==(t=null===(e=this.parent)||void 0===e?void 0:e.getListLevelIndex())&&void 0!==t?t:0}clone(){const e=new es(this.styleName,this.localizedName,this.deleted,this.hidden,this.semihidden,this.isDefault,this.maskedCharacterProperties,this.maskedParagraphProperties,this.tabs.clone(),this.autoUpdate,this.numberingListIndex,this.listLevelIndex,this.base64EncodedImage,this.id);return e.parent=this.parent,e.linkedStyle=this.linkedStyle,e.nextParagraphStyle=this.nextParagraphStyle,e.primary=this.primary,e}}es.normalStyleName="Normal",es.headingStyleName="heading",es.tocStyleName="toc";class ts{constructor(){this.tabsInfo=[]}clone(){const e=new ts;for(let t of this.tabsInfo)e.tabsInfo.push(t.clone());return e}equals(e){for(var t,r=0;t=this.tabsInfo[r];r++)if(!t.equals(e.tabsInfo[r]))return!1;return!0}sort(){this.tabsInfo.sort(((e,t)=>e.position-t.position))}indexOf(e){return C.SearchUtils.binaryIndexOf(this.tabsInfo,(t=>t.position-e.position))}add(e){this.tabsInfo.push(e),this.sort()}deleteByIndex(e){this.tabsInfo.splice(e,1)}setTabs(e){this.tabsInfo=e.tabsInfo,this.tabsInfo.sort(((e,t)=>e.position-t.position))}merge(e){e&&(e.tabsInfo.filter((e=>!e.deleted)).forEach((e=>{this.tabsInfo.some((t=>e.position===t.position))||this.add(e.clone())})),this.sort())}}class rs{constructor(e,t,r,i,n){this.position=e,this.alignment=t,this.leader=r,this.isDefault=n,this.deleted=i}clone(){return new rs(this.position,this.alignment,this.leader,this.deleted,this.isDefault)}equals(e){return!!e&&(this.alignment==e.alignment&&this.leader==e.leader&&this.position==e.position&&this.deleted==e.deleted&&this.isDefault==e.isDefault)}}class is{}!function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Decimal=3]="Decimal",e[e.Numbering=4]="Numbering"}(Ha||(Ha={}));class ns{get isEmpty(){return this.length<=1}constructor(e,t,r,i,n,o=void 0){this.numberingListIndex=cn.NumberingListNotSettedIndex,this.listLevelIndex=-1,this.subDocument=e,this.startLogPosition=t,this.length=r,this.paragraphStyle=i,void 0===o?n?this.setParagraphProperties(n):this.maskedParagraphProperties=null:this.maskedParagraphProperties=this.subDocument.documentModel.cache.maskedParagraphPropertiesCache.getItemByJsonKey(o),this.mergedParagraphFormatting=null,this.tabs=new ts}getParagraphBundleFull(e){return new mn(e.cache.maskedParagraphPropertiesCache.getItem(this.maskedParagraphProperties),e.stylesManager.addParagraphStyle(this.paragraphStyle),new un(this.numberingListIndex,this.listLevelIndex),this.tabs.clone())}getTableCell(){const e=this.startLogPosition.value,t=this.subDocument.tables,r=Ja.getTableByPosition(t,e,!0);if(!r)return null;const i=C.SearchUtils.normedInterpolationIndexOf(r.rows,(e=>e.getStartPosition()),e),n=r.rows[i],o=C.SearchUtils.normedInterpolationIndexOf(n.cells,(e=>e.startParagraphPosition.value),e);return n.cells[o]}isInList(){return this.getNumberingListIndex()>=0}isInOwnList(){return this.numberingListIndex>=0}isInStyleList(){return this.paragraphStyle&&this.paragraphStyle.numberingListIndex>=0}getListLevelIndex(){return this.listLevelIndex>=0?this.listLevelIndex:this.paragraphStyle?this.paragraphStyle.getListLevelIndex():-1}getListLevel(){return this.getNumberingList().levels[this.getListLevelIndex()]}getNumberingListIndex(){return this.numberingListIndex>=0||this.numberingListIndex===cn.NoNumberingListIndex?this.numberingListIndex:this.paragraphStyle?this.paragraphStyle.getNumberingListIndex():-1}getNumberingList(){return this.subDocument.documentModel.numberingLists[this.getNumberingListIndex()]}getAbstractNumberingList(){var e=this.getNumberingList();return e?e.getAbstractNumberingList():null}getAbstractNumberingListIndex(){var e=this.getNumberingList();return e?e.abstractNumberingListIndex:-1}getNumberingListText(){var e=this.subDocument.documentModel.getRangeListCounters(this);return this.getNumberingListTextCore(e)}getNumberingListTextCore(e){var t=this.getNumberingList().levels,r=t[this.getListLevelIndex()].getListLevelProperties().displayFormatString;return this.formatNumberingListText(r,e,t)}getNumberingListSeparatorChar(){return this.getListLevel().getListLevelProperties().separator}getNumerationCharacterProperties(){var e=new Ii;e.mergeCharacterProperties(this.getNumberingList().levels[this.getListLevelIndex()].getCharacterProperties());const t=this.subDocument.getRunByPosition(this.getEndPosition()-1).getCharacterMergedProperties(),r=new Pe;return r.copyFrom(t),r.setUseValueFull(ie.UseAll^ie.UseFontUnderlineType),e.mergeCharacterProperties(r),this.subDocument.documentModel.cache.mergedCharacterPropertiesCache.getItem(e.getMergedProperties())}getNumerationLanguageId(){const e=this.getNumerationCharacterProperties();if(!(0,S.isDefined)(e.langInfo))return"en";const t=e.langInfo.latin;return(0,S.isDefined)(t)?t:"en"}formatNumberingListText(e,t,r){var i=new Array(t.length);const n=this.getNumerationLanguageId();for(var o=0;o<t.length;o++){var a=Oa.createConverter(r[o].getListLevelProperties().format,this.subDocument.documentModel.simpleFormattersManager,n);i[o]=a.convertNumber(t[o])}try{return this.subDocument.documentModel.simpleFormattersManager.formatString(e,...i)}catch(e){try{return i[0]}catch(e){return""}}}get interval(){return new on.FixedInterval(this.startLogPosition.value,this.length)}getEndPosition(){return this.startLogPosition.value+this.length}setParagraphProperties(e){this.maskedParagraphProperties=this.subDocument.documentModel.cache.maskedParagraphPropertiesCache.getItem(e)}onParagraphPropertiesChanged(){this.resetParagraphMergedProperties()}resetParagraphMergedProperties(){this.mergedParagraphFormatting=null}getParagraphMergedProperties(){if(!this.mergedParagraphFormatting){var e=new $i;e.mergeMaskedParagraphProperties(this.maskedParagraphProperties),this.isInOwnList()&&e.mergeMaskedParagraphProperties(this.getListLevel().getParagraphProperties()),this.numberingListIndex==dn.NoNumberingListIndex?e.mergeParagraphStyle(this.paragraphStyle):e.mergeParagraphStyleConsiderNumbering(this.paragraphStyle,this.subDocument.documentModel);const t=this.getTableCell();t&&e.mergeTableStyle(t),e.mergeMaskedParagraphProperties(this.subDocument.documentModel.defaultParagraphProperties),this.mergedParagraphFormatting=this.subDocument.documentModel.cache.mergedParagraphPropertiesCache.getItem(e.getMergedProperties())}return this.mergedParagraphFormatting}setParagraphMergedProperies(e){this.mergedParagraphFormatting=this.subDocument.documentModel.cache.mergedParagraphPropertiesCache.getItem(e)}hasParagraphMergedProperies(){return!!this.mergedParagraphFormatting}getTabs(){var e=new is;if(e.defaultTabStop=this.subDocument.documentModel.defaultTabWidth,e.positions=[],this.paragraphStyle)for(var t=this.paragraphStyle.getResultTabs().tabsInfo,r=0;r<t.length;r++)if(!t[r].deleted){var i=t[r].clone();(o=C.SearchUtils.binaryIndexOf(e.positions,(e=>e.position-t[r].position)))<0?e.positions.splice(~o,0,i):e.positions[o]=i}var n=this.tabs.tabsInfo;for(r=0;r<n.length;r++){var o;(o=C.SearchUtils.binaryIndexOf(e.positions,(e=>e.position-n[r].position)))<0?(o=~o,n[r].deleted||e.positions.splice(o,0,n[r].clone())):n[r].deleted?e.positions.splice(o,1):e.positions[o]=n[r].clone()}return e}clone(e){const t=new ns(e,e.positionManager.registerPosition(this.startLogPosition.value),this.length,e.documentModel.stylesManager.getParagraphStyleByName(this.paragraphStyle.styleName),this.maskedParagraphProperties);return t.tabs=this.tabs.clone(),t.numberingListIndex=this.numberingListIndex,t.listLevelIndex=this.listLevelIndex,t}copyFrom(e){this.paragraphStyle=e.paragraphStyle,this.setParagraphProperties(e.maskedParagraphProperties),e.hasParagraphMergedProperies()&&this.setParagraphMergedProperies(e.getParagraphMergedProperties()),this.numberingListIndex=e.numberingListIndex,this.listLevelIndex=e.listLevelIndex,this.tabs=e.tabs.clone()}}class os{static numberToBinary(e){return(e>>>0).toString(2)}static numberToHex(e){return(e>>>0).toString(16)}static convertToBinary(e){return rn.StringUtils.padLeft(os.numberToBinary(e),2,"0")}static convertToHexBinary(e){return rn.StringUtils.padLeft(os.numberToHex(e),8,"0")}}class as{constructor(){this._t=[-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]}computeHashCore(e){const t=this._t;for(let t=0;t<16;t++){const r=0+t,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}const r=this._hash,i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],d=e[6],c=e[7],h=e[8],u=e[9],p=e[10],g=e[11],m=e[12],f=e[13],b=e[14],C=e[15];let S=r[0],I=r[1],P=r[2],w=r[3];S=this.FF(S,I,P,w,i,7,t[0]),w=this.FF(w,S,I,P,n,12,t[1]),P=this.FF(P,w,S,I,o,17,t[2]),I=this.FF(I,P,w,S,a,22,t[3]),S=this.FF(S,I,P,w,s,7,t[4]),w=this.FF(w,S,I,P,l,12,t[5]),P=this.FF(P,w,S,I,d,17,t[6]),I=this.FF(I,P,w,S,c,22,t[7]),S=this.FF(S,I,P,w,h,7,t[8]),w=this.FF(w,S,I,P,u,12,t[9]),P=this.FF(P,w,S,I,p,17,t[10]),I=this.FF(I,P,w,S,g,22,t[11]),S=this.FF(S,I,P,w,m,7,t[12]),w=this.FF(w,S,I,P,f,12,t[13]),P=this.FF(P,w,S,I,b,17,t[14]),I=this.FF(I,P,w,S,C,22,t[15]),S=this.GG(S,I,P,w,n,5,t[16]),w=this.GG(w,S,I,P,d,9,t[17]),P=this.GG(P,w,S,I,g,14,t[18]),I=this.GG(I,P,w,S,i,20,t[19]),S=this.GG(S,I,P,w,l,5,t[20]),w=this.GG(w,S,I,P,p,9,t[21]),P=this.GG(P,w,S,I,C,14,t[22]),I=this.GG(I,P,w,S,s,20,t[23]),S=this.GG(S,I,P,w,u,5,t[24]),w=this.GG(w,S,I,P,b,9,t[25]),P=this.GG(P,w,S,I,a,14,t[26]),I=this.GG(I,P,w,S,h,20,t[27]),S=this.GG(S,I,P,w,f,5,t[28]),w=this.GG(w,S,I,P,o,9,t[29]),P=this.GG(P,w,S,I,c,14,t[30]),I=this.GG(I,P,w,S,m,20,t[31]),S=this.HH(S,I,P,w,l,4,t[32]),w=this.HH(w,S,I,P,h,11,t[33]),P=this.HH(P,w,S,I,g,16,t[34]),I=this.HH(I,P,w,S,b,23,t[35]),S=this.HH(S,I,P,w,n,4,t[36]),w=this.HH(w,S,I,P,s,11,t[37]),P=this.HH(P,w,S,I,c,16,t[38]),I=this.HH(I,P,w,S,p,23,t[39]),S=this.HH(S,I,P,w,f,4,t[40]),w=this.HH(w,S,I,P,i,11,t[41]),P=this.HH(P,w,S,I,a,16,t[42]),I=this.HH(I,P,w,S,d,23,t[43]),S=this.HH(S,I,P,w,u,4,t[44]),w=this.HH(w,S,I,P,m,11,t[45]),P=this.HH(P,w,S,I,C,16,t[46]),I=this.HH(I,P,w,S,o,23,t[47]),S=this.II(S,I,P,w,i,6,t[48]),w=this.II(w,S,I,P,c,10,t[49]),P=this.II(P,w,S,I,b,15,t[50]),I=this.II(I,P,w,S,l,21,t[51]),S=this.II(S,I,P,w,m,6,t[52]),w=this.II(w,S,I,P,a,10,t[53]),P=this.II(P,w,S,I,p,15,t[54]),I=this.II(I,P,w,S,n,21,t[55]),S=this.II(S,I,P,w,h,6,t[56]),w=this.II(w,S,I,P,C,10,t[57]),P=this.II(P,w,S,I,d,15,t[58]),I=this.II(I,P,w,S,f,21,t[59]),S=this.II(S,I,P,w,s,6,t[60]),w=this.II(w,S,I,P,g,10,t[61]),P=this.II(P,w,S,I,o,15,t[62]),I=this.II(I,P,w,S,u,21,t[63]),r[0]=r[0]+S|0,r[1]=r[1]+I|0,r[2]=r[2]+P|0,r[3]=r[3]+w|0}FF(e,t,r,i,n,o,a){const s=e+(t&r|~t&i)+n+a;return(s<<o|s>>>32-o)+t}GG(e,t,r,i,n,o,a){const s=e+(t&i|r&~i)+n+a;return(s<<o|s>>>32-o)+t}HH(e,t,r,i,n,o,a){const s=e+(t^r^i)+n+a;return(s<<o|s>>>32-o)+t}II(e,t,r,i,n,o,a){const s=e+(r^(t|~i))+n+a;return(s<<o|s>>>32-o)+t}resetCache(){this._hash=[1732584193,4023233417,2562383102,271733878]}computeHash(e){this.resetCache();const t=e,r=4*e.length*8,i=4*e.length*8;t[i>>>5]|=128<<24-i%32;const n=Math.floor(r/4294967296),o=r;t[15+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t[14+(i+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),this.computeHashCore(t);const a=this._hash;for(let e=0;e<4;e++){const t=a[e];a[e]=16711935&(t<<8|t>>>24)|4278255360&(t<<24|t>>>8)}return a}}class ss{constructor(){this._zl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],this._zr=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],this._sl=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],this._sr=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],this._hl=[0,1518500249,1859775393,2400959708,2840853838],this._hr=[1352829926,1548603684,1836072691,2053994217,0]}computeHashCore(e){for(let t=0;t<16;t++){const r=0+t,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}const t=this._hash,r=this._hl,i=this._hr,n=this._zl,o=this._zr,a=this._sl,s=this._sr;let l,d,c,h,u,p,g,m,f,b,C;p=l=t[0],g=d=t[1],m=c=t[2],f=h=t[3],b=u=t[4];for(let t=0;t<80;t+=1)C=l+e[0+n[t]]|0,C+=t<16?this.f1(d,c,h)+r[0]:t<32?this.f2(d,c,h)+r[1]:t<48?this.f3(d,c,h)+r[2]:t<64?this.f4(d,c,h)+r[3]:this.f5(d,c,h)+r[4],C|=0,C=this.rotl(C,a[t]),C=C+u|0,l=u,u=h,h=this.rotl(c,10),c=d,d=C,C=p+e[0+o[t]]|0,C+=t<16?this.f5(g,m,f)+i[0]:t<32?this.f4(g,m,f)+i[1]:t<48?this.f3(g,m,f)+i[2]:t<64?this.f2(g,m,f)+i[3]:this.f1(g,m,f)+i[4],C|=0,C=this.rotl(C,s[t]),C=C+b|0,p=b,b=f,f=this.rotl(m,10),m=g,g=C;C=t[1]+c+f|0,t[1]=t[2]+h+b|0,t[2]=t[3]+u+p|0,t[3]=t[4]+l+g|0,t[4]=t[0]+d+m|0,t[0]=C}f1(e,t,r){return e^t^r}f2(e,t,r){return e&t|~e&r}f3(e,t,r){return(e|~t)^r}f4(e,t,r){return e&r|t&~r}f5(e,t,r){return e^(t|~r)}rotl(e,t){return e<<t|e>>>32-t}resetCache(){this._hash=[1732584193,4023233417,2562383102,271733878,3285377520]}computeHash(e){this.resetCache();const t=e,r=4*e.length*8,i=4*e.length*8;t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);const n=this._hash;this.computeHashCore(t);for(let e=0;e<5;e++){const t=n[e];n[e]=16711935&(t<<8|t>>>24)|4278255360&(t<<24|t>>>8)}return this._hash}}class ls{computeHashCore(e){const t=this._hash;let r=[],i=t[0],n=t[1],o=t[2],a=t[3],s=t[4];for(let t=0;t<80;t++){if(t<16)r[t]=0|e[0+t];else{const e=r[t-3]^r[t-8]^r[t-14]^r[t-16];r[t]=e<<1|e>>>31}let l=(i<<5|i>>>27)+s+r[t];l+=t<20?1518500249+(n&o|~n&a):t<40?1859775393+(n^o^a):t<60?(n&o|n&a|o&a)-1894007588:(n^o^a)-899497514,s=a,a=o,o=n<<30|n>>>2,n=i,i=l}t[0]=t[0]+i|0,t[1]=t[1]+n|0,t[2]=t[2]+o|0,t[3]=t[3]+a|0,t[4]=t[4]+s|0}resetCache(){this._hash=[1732584193,4023233417,2562383102,271733878,3285377520]}computeHash(e){this.resetCache();const t=e,r=4*e.length*8,i=4*e.length*8;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(i+64>>>9<<4)]=r,this.computeHashCore(t),this._hash}}class ds{constructor(){this._constants=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998]}computeHashCore(e){const t=this._constants,r=this._hash,i=[];let n=r[0],o=r[1],a=r[2],s=r[3],l=r[4],d=r[5],c=r[6],h=r[7];for(let r=0;r<64;r++){if(r<16)i[r]=0|e[0+r];else{const e=i[r-15],t=(e<<25|e>>>7)^(e<<14|e>>>18)^e>>>3,n=i[r-2],o=(n<<15|n>>>17)^(n<<13|n>>>19)^n>>>10;i[r]=t+i[r-7]+o+i[r-16]}const u=n&o^n&a^o&a,p=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),g=h+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&d^~l&c)+t[r]+i[r];h=c,c=d,d=l,l=s+g|0,s=a,a=o,o=n,n=g+(p+u)|0}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+a|0,r[3]=r[3]+s|0,r[4]=r[4]+l|0,r[5]=r[5]+d|0,r[6]=r[6]+c|0,r[7]=r[7]+h|0}resetCache(){this._hash=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225]}computeHash(e){this.resetCache();const t=e,r=4*e.length*8,i=4*e.length*8;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(i+64>>>9<<4)]=r,this.computeHashCore(t),this._hash}}var cs,hs,us,ps,gs,ms,fs,bs,Cs,Ss,Is,Ps,ws,ys,xs,Ts,vs,Ms,Es,Ds,Fs,Rs,Ls,Bs,As,Ns,ks,Os,_s,Us,Hs,Vs,Ws,zs,js,Xs,Gs,Ks,qs,$s,Js,Ys,Qs,Zs,el,tl,rl,il,nl,ol,al,sl,ll,dl,cl,hl,ul,pl,gl,ml,fl,bl,Cl,Sl,Il,Pl,wl,yl,xl=__webpack_require__(6799);class Tl{constructor(){this.initialize()}resetCache(){this._hash=this.getDefaultCache()}initialize(){this.resetCache(),this._k=[new xl.MinMaxNumber(3609767458,1116352408),new xl.MinMaxNumber(602891725,1899447441),new xl.MinMaxNumber(3964484399,3049323471),new xl.MinMaxNumber(2173295548,3921009573),new xl.MinMaxNumber(4081628472,961987163),new xl.MinMaxNumber(3053834265,1508970993),new xl.MinMaxNumber(2937671579,2453635748),new xl.MinMaxNumber(3664609560,2870763221),new xl.MinMaxNumber(2734883394,3624381080),new xl.MinMaxNumber(1164996542,310598401),new xl.MinMaxNumber(1323610764,607225278),new xl.MinMaxNumber(3590304994,1426881987),new xl.MinMaxNumber(4068182383,1925078388),new xl.MinMaxNumber(991336113,2162078206),new xl.MinMaxNumber(633803317,2614888103),new xl.MinMaxNumber(3479774868,3248222580),new xl.MinMaxNumber(2666613458,3835390401),new xl.MinMaxNumber(944711139,4022224774),new xl.MinMaxNumber(2341262773,264347078),new xl.MinMaxNumber(2007800933,604807628),new xl.MinMaxNumber(1495990901,770255983),new xl.MinMaxNumber(1856431235,1249150122),new xl.MinMaxNumber(3175218132,1555081692),new xl.MinMaxNumber(2198950837,1996064986),new xl.MinMaxNumber(3999719339,2554220882),new xl.MinMaxNumber(766784016,2821834349),new xl.MinMaxNumber(2566594879,2952996808),new xl.MinMaxNumber(3203337956,3210313671),new xl.MinMaxNumber(1034457026,3336571891),new xl.MinMaxNumber(2466948901,3584528711),new xl.MinMaxNumber(3758326383,113926993),new xl.MinMaxNumber(168717936,338241895),new xl.MinMaxNumber(1188179964,666307205),new xl.MinMaxNumber(1546045734,773529912),new xl.MinMaxNumber(1522805485,1294757372),new xl.MinMaxNumber(2643833823,1396182291),new xl.MinMaxNumber(2343527390,1695183700),new xl.MinMaxNumber(1014477480,1986661051),new xl.MinMaxNumber(1206759142,2177026350),new xl.MinMaxNumber(344077627,2456956037),new xl.MinMaxNumber(1290863460,2730485921),new xl.MinMaxNumber(3158454273,2820302411),new xl.MinMaxNumber(3505952657,3259730800),new xl.MinMaxNumber(106217008,3345764771),new xl.MinMaxNumber(3606008344,3516065817),new xl.MinMaxNumber(1432725776,3600352804),new xl.MinMaxNumber(1467031594,4094571909),new xl.MinMaxNumber(851169720,275423344),new xl.MinMaxNumber(3100823752,430227734),new xl.MinMaxNumber(1363258195,506948616),new xl.MinMaxNumber(3750685593,659060556),new xl.MinMaxNumber(3785050280,883997877),new xl.MinMaxNumber(3318307427,958139571),new xl.MinMaxNumber(3812723403,1322822218),new xl.MinMaxNumber(2003034995,1537002063),new xl.MinMaxNumber(3602036899,1747873779),new xl.MinMaxNumber(1575990012,1955562222),new xl.MinMaxNumber(1125592928,2024104815),new xl.MinMaxNumber(2716904306,2227730452),new xl.MinMaxNumber(442776044,2361852424),new xl.MinMaxNumber(593698344,2428436474),new xl.MinMaxNumber(3733110249,2756734187),new xl.MinMaxNumber(2999351573,3204031479),new xl.MinMaxNumber(3815920427,3329325298),new xl.MinMaxNumber(3928383900,3391569614),new xl.MinMaxNumber(566280711,3515267271),new xl.MinMaxNumber(3454069534,3940187606),new xl.MinMaxNumber(4000239992,4118630271),new xl.MinMaxNumber(1914138554,116418474),new xl.MinMaxNumber(2731055270,174292421),new xl.MinMaxNumber(3203993006,289380356),new xl.MinMaxNumber(320620315,460393269),new xl.MinMaxNumber(587496836,685471733),new xl.MinMaxNumber(1086792851,852142971),new xl.MinMaxNumber(365543100,1017036298),new xl.MinMaxNumber(2618297676,1126000580),new xl.MinMaxNumber(3409855158,1288033470),new xl.MinMaxNumber(4234509866,1501505948),new xl.MinMaxNumber(987167468,1607167915),new xl.MinMaxNumber(1246189591,1816402316)],this._w=f.ListUtils.initByCallback(80,(()=>new xl.MinMaxNumber(void 0,void 0)))}computeHashCore(e){const t=this._w,r=this._k,i=this._hash,n=i[0],o=i[1],a=i[2],s=i[3],l=i[4],d=i[5],c=i[6],h=i[7];let u=n.maxElement,p=n.minElement,g=o.maxElement,m=o.minElement,f=a.maxElement,b=a.minElement,C=s.maxElement,S=s.minElement,I=l.maxElement,P=l.minElement,w=d.maxElement,y=d.minElement,x=c.maxElement,T=c.minElement,v=h.maxElement,M=h.minElement,E=u,D=p,F=g,R=m,L=f,B=b,A=C,N=S,k=I,O=P,_=w,U=y,H=x,V=T,W=v,z=M;for(let i=0;i<80;i++){let n,o;const a=t[i];if(i<16)o=a.maxElement=0|e[0+2*i],n=a.minElement=0|e[0+2*i+1];else{const e=t[i-15],r=e.maxElement,s=e.minElement,l=(r>>>1|s<<31)^(r>>>8|s<<24)^r>>>7,d=(s>>>1|r<<31)^(s>>>8|r<<24)^(s>>>7|r<<25),c=t[i-2],h=c.maxElement,u=c.minElement,p=(h>>>19|u<<13)^(h<<3|u>>>29)^h>>>6,g=(u>>>19|h<<13)^(u<<3|h>>>29)^(u>>>6|h<<26),m=t[i-7],f=m.maxElement,b=m.minElement,C=t[i-16],S=C.maxElement,I=C.minElement;n=d+b,o=l+f+(n>>>0<d>>>0?1:0),n+=g,o=o+p+(n>>>0<g>>>0?1:0),n+=I,o=o+S+(n>>>0<I>>>0?1:0),a.maxElement=o,a.minElement=n}const s=k&_^~k&H,l=O&U^~O&V,d=E&F^E&L^F&L,c=D&R^D&B^R&B,h=(E>>>28|D<<4)^(E<<30|D>>>2)^(E<<25|D>>>7),u=(D>>>28|E<<4)^(D<<30|E>>>2)^(D<<25|E>>>7),p=(k>>>14|O<<18)^(k>>>18|O<<14)^(k<<23|O>>>9),g=(O>>>14|k<<18)^(O>>>18|k<<14)^(O<<23|k>>>9),m=r[i],f=m.maxElement,b=m.minElement;let C=z+g,S=W+p+(C>>>0<z>>>0?1:0);C+=l,S=S+s+(C>>>0<l>>>0?1:0),C+=b,S=S+f+(C>>>0<b>>>0?1:0),C+=n,S=S+o+(C>>>0<n>>>0?1:0);const I=u+c;W=H,z=V,H=_,V=U,_=k,U=O,O=N+C|0,k=A+S+(O>>>0<N>>>0?1:0)|0,A=L,N=B,L=F,B=R,F=E,R=D,D=C+I|0,E=S+(h+d+(I>>>0<u>>>0?1:0))+(D>>>0<C>>>0?1:0)|0}p=n.minElement=p+D,n.maxElement=u+E+(p>>>0<D>>>0?1:0),m=o.minElement=m+R,o.maxElement=g+F+(m>>>0<R>>>0?1:0),b=a.minElement=b+B,a.maxElement=f+L+(b>>>0<B>>>0?1:0),S=s.minElement=S+N,s.maxElement=C+A+(S>>>0<N>>>0?1:0),P=l.minElement=P+O,l.maxElement=I+k+(P>>>0<O>>>0?1:0),y=d.minElement=y+U,d.maxElement=w+_+(y>>>0<U>>>0?1:0),T=c.minElement=T+V,c.maxElement=x+H+(T>>>0<V>>>0?1:0),M=h.minElement=M+z,h.maxElement=v+W+(M>>>0<z>>>0?1:0)}getDefaultCache(){return[new xl.MinMaxNumber(4089235720,1779033703),new xl.MinMaxNumber(2227873595,3144134277),new xl.MinMaxNumber(4271175723,1013904242),new xl.MinMaxNumber(1595750129,2773480762),new xl.MinMaxNumber(2917565137,1359893119),new xl.MinMaxNumber(725511199,2600822924),new xl.MinMaxNumber(4215389547,528734635),new xl.MinMaxNumber(327033209,1541459225)]}computeHash(e){this.resetCache();const t=e,r=4*e.length*8,i=4*e.length*8;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(i+128>>>10<<5)]=r,this.computeHashCore(t),this.toX32Words(this._hash)}toX32Words(e){const t=e.length,r=[];for(let i=0;i<t;i++){const t=e[i];r.push(t.maxElement),r.push(t.minElement)}return r}}class vl extends Tl{constructor(){super()}getDefaultCache(){return[new xl.MinMaxNumber(3238371032,3418070365),new xl.MinMaxNumber(914150663,1654270250),new xl.MinMaxNumber(812702999,2438529370),new xl.MinMaxNumber(4144912697,355462360),new xl.MinMaxNumber(4290775857,1731405415),new xl.MinMaxNumber(1750603025,2394180231),new xl.MinMaxNumber(1694076839,3675008525),new xl.MinMaxNumber(3204075428,1203062813)]}computeHash(e){const t=super.computeHash(e);return t.length-=4,t}}class Ml{getBytes(e){return new Uint8Array(new Uint32Array([e]).buffer)}calculateLegacyPasswordHash(e){return rn.StringUtils.isNullOrEmpty(e)?null:this.getBytes(this.calculateLegacyPasswordHashInt(e))}calculateLegacyPasswordHashInt(e){if(rn.StringUtils.isNullOrEmpty(e))return 0;const t=this.calculatePasswordBytes(e),r=this.calculateKeyHighWord(t),i=this.calculateKeyLowWord(t);return i<<24&4278190080|i<<8&16711680|r<<8&65280|r>>8&255}calculatePasswordHash(e,t,r,i){const n=this.createHashAlgorithm(i);if(n)return this.calculatePasswordHashAfterDetectedAlgoritm(e,t,r,n);{const t=this.calculateLegacyPasswordHashInt(e);return this.concatenate(new Uint8Array(0),t)}}generatePasswordPrefix(e){const t=[];for(let r=0;r<e;r++)t[r]=P.MathUtils.getRandomInt(0,1e3);return new Uint8Array(t)}createHashAlgorithm(e){switch(e){case Fo.Sha1:return new ls;case Fo.Sha256:return new ds;case Fo.Sha384:return new vl;case Fo.Sha512:return new Tl;case Fo.Md5:return new as;case Fo.Ripemd160:return new ss;case Fo.None:case Fo.Mac:case Fo.HMac:case Fo.Ripemd:case Fo.Md2:case Fo.Md4:default:return null}}calculatePasswordHashAfterDetectedAlgoritm(e,t,r,i){const n=this.calculateLegacyPasswordHashInt(e);return this.calculatePasswordHashCore(this.getUnicodeArray(os.convertToHexBinary(n).toUpperCase()),t,r,i)}getUnicodeArray(e){let t=e.length;const r=new Uint8Array(2*t);for(;t--;){const i=2*t;r[i]=e.charCodeAt(t),r[i+1]=0}return r}calculatePasswordHashCore(e,t,r,i){let n=this.concatenateArrays(t,e),o=this.byteArrayToWordArray(n);for(let e=0;o=i.computeHash(o),e<r;)o=this.concatenateArray(o,e),e++;return new Uint8Array(this.wordArrayToByteArray(o,o.length))}byteArrayToWordArray(e){const t=[];for(let r=0;r<e.length;r++)t[r/4|0]|=e[r]<<24-8*r;return t}wordToByteArray(e,t){const r=[];return t>0&&r.push(e>>>24),t>1&&r.push(e>>>16&255),t>2&&r.push(e>>>8&255),t>3&&r.push(255&e),r}wordArrayToByteArray(e,t){t=4*e.length;const r=[];let i,n=0;for(;t>0;)i=this.wordToByteArray(e[n],Math.min(4,t)),t-=i.length,r.push(i),n++;return[].concat.apply([],r)}concatenateArrays(e,t){if(null==e)return t;if(null==t)return e;const r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}concatenate(e,t){const r=new Array(4);r[3]=(4278190080&t)>>24,r[2]=(16711680&t)>>16,r[1]=(65280&t)>>8,r[0]=255&t;const i=new Uint8Array(e.length+r.length);return i.set(e),i.set(r,e.length),i}concatenateArray(e,t){const r=new Array(4);r[3]=(4278190080&t)>>24,r[2]=(16711680&t)>>16,r[1]=(65280&t)>>8,r[0]=255&t;const i=this.byteArrayToWordArray(r);return e.concat(i)}static compareByteArrays(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;const r=e.length;for(let i=0;i<r;i++)if(e[i]!=t[i])return!1;return!0}calculatePasswordBytes(e){e.length>15&&(e=e.substr(0,15));const t=e.length,r=new Array(t);for(let i=0;i<t;i++){const t=e.charCodeAt(i);r[i]=255&t?255&t:t>>8}return r}calculateKeyLowWord(e){let t=0;const r=e.length;for(let i=r-1;i>=0;i--)t=this.processLowWordByte(t,e[i]);return t=52811^this.processLowWordByte(t,r),t}processLowWordByte(e,t){return(e>>14&1|e<<1&32767)^t}calculateKeyHighWord(e){const t=e.length;let r=Ml.initialValues[t-1];for(let i=0;i<t;i++)r=this.processHighWordByte(r,e[i],15-(t-i));return r}processHighWordByte(e,t,r){let i=1;for(let n=0;n<=6;n++,i<<=1)t&i&&(e^=Ml.encryptionMatrix[r][n]);return e}}Ml.initialValues=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],Ml.encryptionMatrix=[[44796,19929,39858,10053,20106,40212,10761],[31585,63170,64933,60267,50935,40399,11199],[17763,35526,1453,2906,5812,11624,23248],[885,1770,3540,7080,14160,28320,56640],[55369,41139,20807,41614,21821,43642,17621],[28485,56970,44341,19019,38038,14605,29210],[60195,50791,40175,10751,21502,43004,24537],[18387,36774,3949,7898,15796,31592,63184],[47201,24803,49606,37805,14203,28406,56812],[17824,35648,1697,3394,6788,13576,27152],[43601,17539,35078,557,1114,2228,4456],[30388,60776,51953,34243,7079,14158,28316],[14128,28256,56512,43425,17251,34502,7597],[13105,26210,52420,35241,883,1766,3532],[4129,8258,16516,33032,4657,9314,18628]];class El{constructor(e,t,r){this.startOffset=e,this.paragraph=t,this.characterStyle=r.style,this.setCharacterProperties(r.props),this.mergedCharacterProperties=null}isParagraphOrSectionRun(){return!1}setCharacterProperties(e){this.maskedCharacterProperties=this.paragraph.subDocument.documentModel.cache.maskedCharacterPropertiesCache.getItem(e)}onCharacterPropertiesChanged(){this.resetCharacterMergedProperties()}hasCharacterMergedProperies(){return!!this.mergedCharacterProperties}resetCharacterMergedProperties(){this.mergedCharacterProperties=null}getCharacterMergedProperties(){return this.mergedCharacterProperties||(this.mergedCharacterProperties=this.mergeCharacterProperties()),this.mergedCharacterProperties}mergeCharacterProperties(e){const t=new Ii;t.mergeCharacterProperties(this.maskedCharacterProperties),e&&e.excludeCharacterStyle||t.mergeCharacterStyle(this.characterStyle),t.mergeParagraphStyle(this.paragraph.paragraphStyle);const r=this.paragraph.getTableCell();return r&&t.mergeTableStyles(r),t.mergeCharacterProperties(this.paragraph.subDocument.documentModel.defaultCharacterProperties),this.paragraph.subDocument.documentModel.cache.mergedCharacterPropertiesCache.getItem(t.getMergedProperties())}setCharacterMergedProperies(e){this.mergedCharacterProperties=this.paragraph.subDocument.documentModel.cache.mergedCharacterPropertiesCache.getItem(e)}copyFrom(e){this.startOffset=e.startOffset,this.paragraph=e.paragraph,this.characterStyle=e.characterStyle,this.maskedCharacterProperties=e.maskedCharacterProperties,this.mergedCharacterProperties=e.mergedCharacterProperties}createSimularity(e,t,r,i,n){const o=this.clone();return o.startOffset=e,o.paragraph=r,o.characterStyle=i,o.maskedCharacterProperties=n,o.setLength(t),o}getCharPropsBundle(e){return new pn(e.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.stylesManager.addCharacterStyle(this.characterStyle))}}El.anchoredObjectIdCounter=0;class Dl extends El{getLength(){return 1}setLength(e){if(1!=e)throw new Error(R.D.InternalException)}incLength(e){throw new Error(R.D.InternalException)}}class Fl extends Dl{get shape(){return this.info.shape}set shape(e){this.info.shape=e}get size(){return this.info.size}set size(e){this.info.size=e}get cacheInfo(){return this.info.cacheInfo}constructor(e,t,r,i){super(e,t,r),this.info=i}getActualSize(){return this.info.size.actualSize}copyFrom(e){super.copyFrom(e),this.info=e.info.clone()}}class Rl extends Dl{constructor(e,t,r,i,n,o,a){super(e,t,r),this.shape=i,this.subDocId=n,this.textBoxProperties=o,this.containerProperties=a}copyFrom(e){super.copyFrom(e),this.shape=e.shape.clone(),this.subDocId=e.subDocId}}!function(e){e[e.Undefined=-1]="Undefined",e[e.TextRun=1]="TextRun",e[e.ParagraphRun=2]="ParagraphRun",e[e.SectionRun=3]="SectionRun",e[e.FieldCodeStartRun=4]="FieldCodeStartRun",e[e.FieldCodeEndRun=5]="FieldCodeEndRun",e[e.FieldResultEndRun=6]="FieldResultEndRun",e[e.AnchoredPictureRun=7]="AnchoredPictureRun",e[e.AnchoredTextBoxRun=8]="AnchoredTextBoxRun",e[e.InlinePictureRun=9]="InlinePictureRun",e[e.InlineTextBoxRun=10]="InlineTextBoxRun",e[e.LayoutDependentRun=11]="LayoutDependentRun",e[e.FootNoteRun=12]="FootNoteRun",e[e.EndNoteRun=13]="EndNoteRun",e[e.NoteSeparatorRun=14]="NoteSeparatorRun",e[e.NoteContinuationSeparatorRun=15]="NoteContinuationSeparatorRun"}(cs||(cs={}));class Ll extends Dl{getType(){return cs.SectionRun}isParagraphOrSectionRun(){return!0}clone(){return new Ll(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new Ll(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}}class Bl extends Dl{getType(){return cs.ParagraphRun}isParagraphOrSectionRun(){return!0}clone(){return new Bl(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new Bl(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}}class Al extends Dl{getType(){return cs.FieldCodeStartRun}clone(){return new Al(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new Al(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}}class Nl extends Dl{getType(){return cs.FieldCodeEndRun}clone(){return new Nl(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new Nl(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}}class kl extends Dl{getType(){return cs.FieldResultEndRun}clone(){return new kl(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new kl(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}}class Ol extends Dl{getType(){return cs.LayoutDependentRun}clone(){return new Ol(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new Ol(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}}class _l extends Dl{constructor(e,t,r,i=-1){super(e,t,r),this.noteDocumentId=i}}class Ul extends _l{getType(){return cs.FootNoteRun}clone(){return new Ul(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle),this.noteDocumentId)}cloneToNewSubDocument(e){return new Ul(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)),this.noteDocumentId)}}class Hl extends _l{getType(){return cs.EndNoteRun}clone(){return new Hl(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle),this.noteDocumentId)}cloneToNewSubDocument(e){return new Hl(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)),this.noteDocumentId)}}class Vl extends Dl{getType(){return cs.NoteSeparatorRun}clone(){return new Vl(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new Vl(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}}class Wl extends Dl{getType(){return cs.NoteContinuationSeparatorRun}clone(){return new Wl(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new Wl(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}}class zl extends Za{constructor(e,t,r,i,n,o,a,s,l){super(e,t,r,i,n,o,s||null,l),this.maskedCharacterProperties=a}clone(){const e=new zl(this.styleName,this.localizedName,this.deleted,this.hidden,this.semihidden,this.isDefault,this.maskedCharacterProperties,this.base64EncodedImage,this.id);return e.parent=this.parent,e.linkedStyle=this.linkedStyle,e.primary=this.primary,e}}zl.defaultParagraphCharacterStyleName="Default Paragraph Font",zl.hyperlinkStyleName="Hyperlink",zl.lineNumberingStyleName="Line Number",function(e){e[e.Character=0]="Character",e[e.Paragraph=1]="Paragraph",e[e.Table=2]="Table",e[e.TableCell=3]="TableCell",e[e.NumberingList=4]="NumberingList",e[e.Caches=5]="Caches",e[e.MAX_VALUE=6]="MAX_VALUE"}(hs||(hs={})),function(e){e[e.Character=6]="Character",e[e.Paragraph=7]="Paragraph",e[e.Table=8]="Table"}(us||(us={})),function(e){e[e.StyleName=0]="StyleName",e[e.Deleted=1]="Deleted",e[e.Hidden=2]="Hidden",e[e.ParentStyleName=3]="ParentStyleName",e[e.Semihidden=4]="Semihidden",e[e.LocalizedStyleName=5]="LocalizedStyleName",e[e.IsDefault=6]="IsDefault",e[e.Base64EncodedImage=7]="Base64EncodedImage",e[e.MAX_VALUE=8]="MAX_VALUE"}(ps||(ps={})),function(e){e[e.LinkedStyleName=8]="LinkedStyleName",e[e.CharacterPropertiesCacheIndex=9]="CharacterPropertiesCacheIndex"}(gs||(gs={})),function(e){e[e.CharacterPropertiesCacheIndex=8]="CharacterPropertiesCacheIndex",e[e.ParagraphPropertiesCacheIndex=9]="ParagraphPropertiesCacheIndex",e[e.LinkedStyleName=10]="LinkedStyleName",e[e.NextParagraphStyleName=11]="NextParagraphStyleName",e[e.AutoUpdate=12]="AutoUpdate",e[e.Tabs=13]="Tabs",e[e.NumberingListIndex=14]="NumberingListIndex",e[e.ListLevelIndex=15]="ListLevelIndex"}(ms||(ms={})),function(e){e[e.NumberingListIndex=8]="NumberingListIndex"}(fs||(fs={})),function(e){e[e.BaseConditionalStyle=8]="BaseConditionalStyle",e[e.ConditionalStyles=9]="ConditionalStyles"}(bs||(bs={})),function(e){e[e.StyleName=0]="StyleName"}(Cs||(Cs={})),function(e){e[e.LoadOnOneRequest=0]="LoadOnOneRequest",e[e.StartPosition=1]="StartPosition",e[e.MaxChunkLength=2]="MaxChunkLength",e[e.Length=3]="Length"}(Ss||(Ss={})),function(e){e[e.Type=0]="Type"}(Is||(Is={})),function(e){e[e.SectionIndex=0]="SectionIndex",e[e.NewObjectIndex=1]="NewObjectIndex",e[e.Type=2]="Type"}(Ps||(Ps={})),function(e){e[e.Bookmarks=0]="Bookmarks",e[e.Fields=1]="Fields",e[e.Tables=2]="Tables",e[e.Chunks=3]="Chunks",e[e.Paragraphs=4]="Paragraphs",e[e.RangePermissions=5]="RangePermissions"}(ws||(ws={})),function(e){e[e.SubDocumentId=0]="SubDocumentId",e[e.Type=1]="Type"}(ys||(ys={})),function(e){e[e.StartPos=0]="StartPos",e[e.Length=1]="Length",e[e.Name=2]="Name"}(xs||(xs={})),function(e){e[e.Start=0]="Start",e[e.Length=1]="Length",e[e.UserName=2]="UserName",e[e.Group=3]="Group"}(Ts||(Ts={})),function(e){e[e.StartPos=0]="StartPos",e[e.TextBuffer=1]="TextBuffer",e[e.Runs=2]="Runs",e[e.IsLast=3]="IsLast"}(vs||(vs={})),function(e){e[e.Type=0]="Type",e[e.Info=1]="Info",e[e.ParentPieceTableId=2]="ParentPieceTableId"}(Ms||(Ms={})),function(e){e[e.Alignment=0]="Alignment",e[e.LeaderType=1]="LeaderType",e[e.Position=2]="Position",e[e.IsDefault=3]="IsDefault",e[e.IsDeleted=4]="IsDeleted"}(Es||(Es={}));class jl{static convertFromJSONToTabProperties(e){const t=new ts;for(let r of e)t.tabsInfo.push(jl.convertFromJSON(r));return t}static convertFromJSON(e){return new rs(e[Es.Position],e[Es.Alignment],e[Es.LeaderType],!!e[Es.IsDeleted],!!e[Es.IsDefault])}static convertToJSON(e){var t={};return t[Es.Position]=e.position,t[Es.Alignment]=e.alignment,t[Es.LeaderType]=e.leader,t[Es.IsDeleted]=(0,S.boolToInt)(e.deleted),t[Es.IsDefault]=(0,S.boolToInt)(e.isDefault),t}static convertFromTabPropertiesToJSON(e){var t=[];for(let r of e.tabsInfo)t.push(jl.convertToJSON(r));return t}}class Xl{constructor(e,t,r,i,n,o){this.tableProperties=e,this.tableRowProperties=t,this.tableCellProperties=r,this.maskedParagraphProperties=i,this.maskedCharacterProperties=n,this.tabs=o}clone(){var e;return new Xl(this.tableProperties,this.tableRowProperties,this.tableCellProperties,this.maskedParagraphProperties,this.maskedCharacterProperties,null===(e=this.tabs)||void 0===e?void 0:e.clone())}}!function(e){e[e.Type=0]="Type",e[e.Value=1]="Value"}(Ds||(Ds={})),function(e){e[e.Type=0]="Type",e[e.Value=1]="Value"}(Fs||(Fs={})),function(e){e[e.Top=0]="Top",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom"}(Rs||(Rs={})),function(e){e[e.TopBorder=0]="TopBorder",e[e.LeftBorder=1]="LeftBorder",e[e.RightBorder=2]="RightBorder",e[e.BottomBorder=3]="BottomBorder",e[e.InsideHorizontalBorder=4]="InsideHorizontalBorder",e[e.InsideVerticalBorder=5]="InsideVerticalBorder"}(Ls||(Ls={})),function(e){e[e.TopBorder=0]="TopBorder",e[e.LeftBorder=1]="LeftBorder",e[e.RightBorder=2]="RightBorder",e[e.BottomBorder=3]="BottomBorder",e[e.TopLeftDiagonalBorder=4]="TopLeftDiagonalBorder",e[e.TopRightDiagonalBorder=5]="TopRightDiagonalBorder"}(Bs||(Bs={})),function(e){e[e.TableProperties=0]="TableProperties",e[e.TableRowPropertiesIndex=1]="TableRowPropertiesIndex",e[e.TableCellPropertiesIndex=2]="TableCellPropertiesIndex",e[e.MaskedParagraphPropertiesCacheIndex=3]="MaskedParagraphPropertiesCacheIndex",e[e.MaskedCharacterPropertiesCacheIndex=4]="MaskedCharacterPropertiesCacheIndex",e[e.Tabs=5]="Tabs"}(As||(As={})),function(e){e[e.StyleIndex=0]="StyleIndex",e[e.NestedLevel=1]="NestedLevel",e[e.TableProperties=2]="TableProperties",e[e.Index=3]="Index",e[e.PreferredWidth=4]="PreferredWidth",e[e.LookTypes=5]="LookTypes",e[e.ParentCell=6]="ParentCell",e[e.Rows=7]="Rows"}(Ns||(Ns={})),function(e){e[e.CellMargins=0]="CellMargins",e[e.CellSpacing=1]="CellSpacing",e[e.Indent=2]="Indent",e[e.PreferredWidth=3]="PreferredWidth",e[e.Borders=4]="Borders",e[e.TableStyleColBandSize=5]="TableStyleColBandSize",e[e.TableStyleRowBandSize=6]="TableStyleRowBandSize",e[e.IsTableOverlap=7]="IsTableOverlap",e[e.AvoidDoubleBorders=8]="AvoidDoubleBorders",e[e.LayoutType=9]="LayoutType",e[e.TableLookTypes=10]="TableLookTypes",e[e.ShadingInfo=11]="ShadingInfo",e[e.TableRowAlignment=12]="TableRowAlignment",e[e.BottomFromText=13]="BottomFromText",e[e.LeftFromText=14]="LeftFromText",e[e.TopFromText=15]="TopFromText",e[e.RightFromText=16]="RightFromText",e[e.TableHorizontalPosition=17]="TableHorizontalPosition",e[e.TableVerticalPosition=18]="TableVerticalPosition",e[e.HorizontalAlignMode=19]="HorizontalAlignMode",e[e.VerticalAlignMode=20]="VerticalAlignMode",e[e.HorizontalAnchorType=21]="HorizontalAnchorType",e[e.VerticalAnchorType=22]="VerticalAnchorType",e[e.TextWrapping=23]="TextWrapping",e[e.UseValue=24]="UseValue",e[e.ShadingInfoIndex=25]="ShadingInfoIndex"}(ks||(ks={})),function(e){e[e.CellIndex=0]="CellIndex",e[e.RowIndex=1]="RowIndex",e[e.TableIndex=2]="TableIndex"}(Os||(Os={})),function(e){e[e.TablePosition=0]="TablePosition",e[e.Position=1]="Position",e[e.Rows=2]="Rows",e[e.TableInfo=3]="TableInfo"}(_s||(_s={})),function(e){e[e.TableProperties=0]="TableProperties",e[e.StyleName=1]="StyleName",e[e.PreferredWidth=2]="PreferredWidth",e[e.LookTypes=3]="LookTypes"}(Us||(Us={})),function(e){e[e.ParagraphStartPosition=0]="ParagraphStartPosition",e[e.NestedLevel=1]="NestedLevel"}(Hs||(Hs={}));class Gl{static convertFromJSON(e,t){var r=new gr;return r.top=Ho.convertFromJSON(e[Ls.TopBorder],t),r.left=Ho.convertFromJSON(e[Ls.LeftBorder],t),r.right=Ho.convertFromJSON(e[Ls.RightBorder],t),r.bottom=Ho.convertFromJSON(e[Ls.BottomBorder],t),r.insideHorizontal=Ho.convertFromJSON(e[Ls.InsideHorizontalBorder],t),r.insideVertical=Ho.convertFromJSON(e[Ls.InsideVerticalBorder],t),r}static convertToJSON(e){var t={};return t[Ls.TopBorder]=Ho.convertToJSON(e.top),t[Ls.LeftBorder]=Ho.convertToJSON(e.left),t[Ls.RightBorder]=Ho.convertToJSON(e.right),t[Ls.BottomBorder]=Ho.convertToJSON(e.bottom),t[Ls.InsideHorizontalBorder]=Ho.convertToJSON(e.insideHorizontal),t[Ls.InsideVerticalBorder]=Ho.convertToJSON(e.insideVertical),t}}class Kl{static convertFromJSON(e){var t=new dr;return t.type=e[Ds.Type],t.value=e[Ds.Value],t}static convertToJSON(e){var t={};return t[Ds.Type]=e.type,t[Ds.Value]=e.value,t}}class ql{static convertFromJSON(e){var t=new lr;return t.type=e[Fs.Type],t.value=e[Fs.Value],t}static convertToJSON(e){var t={};return t[Fs.Type]=e.type,t[Fs.Value]=e.value,t}}class $l{static convertFromJSON(e){var t=new ar;return t.top=ql.convertFromJSON(e[Rs.Top]),t.left=ql.convertFromJSON(e[Rs.Left]),t.right=ql.convertFromJSON(e[Rs.Right]),t.bottom=ql.convertFromJSON(e[Rs.Bottom]),t}static convertToJSON(e){var t={};return t[Rs.Top]=ql.convertToJSON(e.top),t[Rs.Left]=ql.convertToJSON(e.left),t[Rs.Right]=ql.convertToJSON(e.right),t[Rs.Bottom]=ql.convertToJSON(e.bottom),t}}class Jl{static convertFromJSON(e,t,r){var i=new mr;return i.cellMargins=$l.convertFromJSON(e[ks.CellMargins]),i.cellSpacing=ql.convertFromJSON(e[ks.CellSpacing]),i.indent=ql.convertFromJSON(e[ks.Indent]),i.borders=Gl.convertFromJSON(e[ks.Borders],t),i.tableStyleColumnBandSize=e[ks.TableStyleColBandSize],i.tableStyleRowBandSize=e[ks.TableStyleRowBandSize],i.isTableOverlap=!!e[ks.IsTableOverlap],i.avoidDoubleBorders=!!e[ks.AvoidDoubleBorders],i.layoutType=e[ks.LayoutType],i.shadingInfo=r.getItemByJsonKey(e[ks.ShadingInfoIndex]),i.tableRowAlignment=e[ks.TableRowAlignment],i.bottomFromText=e[ks.BottomFromText],i.leftFromText=e[ks.LeftFromText],i.topFromText=e[ks.TopFromText],i.rightFromText=e[ks.RightFromText],i.tableHorizontalPosition=e[ks.TableHorizontalPosition],i.tableVerticalPosition=e[ks.TableVerticalPosition],i.horizontalAlignMode=e[ks.HorizontalAlignMode],i.verticalAlignMode=e[ks.VerticalAlignMode],i.horizontalAnchorType=e[ks.HorizontalAnchorType],i.verticalAnchorType=e[ks.VerticalAnchorType],i.textWrapping=e[ks.TextWrapping],i.mask=e[ks.UseValue],i}static convertToJSON(e){var t={};return t[ks.CellMargins]=$l.convertToJSON(e.cellMargins),t[ks.CellSpacing]=ql.convertToJSON(e.cellSpacing),t[ks.Indent]=ql.convertToJSON(e.indent),t[ks.Borders]=Gl.convertToJSON(e.borders),t[ks.TableStyleColBandSize]=e.tableStyleColumnBandSize,t[ks.TableStyleRowBandSize]=e.tableStyleRowBandSize,t[ks.IsTableOverlap]=(0,S.boolToInt)(e.isTableOverlap),t[ks.AvoidDoubleBorders]=(0,S.boolToInt)(e.avoidDoubleBorders),t[ks.LayoutType]=e.layoutType,t[ks.ShadingInfo]=pe.convertToJSON(e.shadingInfo),t[ks.TableRowAlignment]=e.tableRowAlignment,t[ks.BottomFromText]=e.bottomFromText,t[ks.LeftFromText]=e.leftFromText,t[ks.TopFromText]=e.topFromText,t[ks.RightFromText]=e.rightFromText,t[ks.TableHorizontalPosition]=e.tableHorizontalPosition,t[ks.TableVerticalPosition]=e.tableVerticalPosition,t[ks.HorizontalAlignMode]=e.horizontalAlignMode,t[ks.VerticalAlignMode]=e.verticalAlignMode,t[ks.HorizontalAnchorType]=e.horizontalAnchorType,t[ks.VerticalAnchorType]=e.verticalAnchorType,t[ks.TextWrapping]=e.textWrapping,t[ks.UseValue]=e.mask,t}}class Yl{static convertFromJSON(e,t){const r=Jl.convertFromJSON(e[As.TableProperties],t.colorModelInfoCache,t.shadingInfoCache),i=t.tableRowPropertiesCache.getItemByJsonKey(e[As.TableRowPropertiesIndex]),n=t.tableCellPropertiesCache.getItemByJsonKey(e[As.TableCellPropertiesIndex]),o=t.maskedParagraphPropertiesCache.getItemByJsonKey(e[As.MaskedParagraphPropertiesCacheIndex]),a=t.maskedCharacterPropertiesCache.getItemByJsonKey(e[As.MaskedCharacterPropertiesCacheIndex]);return new Xl(r,i,n,o,a,jl.convertFromJSONToTabProperties(e[As.Tabs]))}static convertStylesFromJSON(e,t){return b.j.map(e,(e=>Yl.convertFromJSON(e,t)))}static convertToJSON(e,t){const r=e.cache.maskedParagraphPropertiesCache,i=e.cache.maskedCharacterPropertiesCache,n=e.cache.tableRowPropertiesCache,o=e.cache.tableCellPropertiesCache;let a={};return a[As.TableProperties]=Jl.convertToJSON(t.tableProperties),a[As.TableRowPropertiesIndex]=n.indexOf(t.tableRowProperties),a[As.TableCellPropertiesIndex]=o.indexOf(t.tableCellProperties),a[As.MaskedParagraphPropertiesCacheIndex]=r.indexOf(t.maskedParagraphProperties),a[As.MaskedCharacterPropertiesCacheIndex]=i.indexOf(t.maskedCharacterProperties),a[As.Tabs]=jl.convertFromTabPropertiesToJSON(t.tabs),a}static convertStylesToJSON(e,t){return b.j.map(t,(t=>Yl.convertToJSON(e,t)))}}!function(e){e[e.NextPage=0]="NextPage",e[e.OddPage=1]="OddPage",e[e.EvenPage=2]="EvenPage",e[e.Continuous=3]="Continuous",e[e.Column=4]="Column"}(Vs||(Vs={})),function(e){e[e.First=0]="First",e[e.Odd=1]="Odd",e[e.Even=2]="Even"}(Ws||(Ws={})),function(e){e[e.NewPage=0]="NewPage",e[e.NewSection=1]="NewSection",e[e.Continuous=2]="Continuous"}(zs||(zs={})),function(e){e[e.BottomOfPage=0]="BottomOfPage",e[e.BelowText=1]="BelowText",e[e.EndOfDocument=2]="EndOfDocument",e[e.EndOfSection=3]="EndOfSection"}(js||(js={})),function(e){e[e.Separator=0]="Separator",e[e.ContinuationSeparator=1]="ContinuationSeparator",e[e.ContinuationNotice=2]="ContinuationNotice",e[e.Normal=3]="Normal"}(Xs||(Xs={})),function(e){e[e.Continuous=0]="Continuous",e[e.NewPage=1]="NewPage",e[e.NewSection=2]="NewSection"}(Gs||(Gs={}));class Ql{static createDefault(){const e=new Ql;return e.position=js.BottomOfPage,e.numberingFormat=Zi.Decimal,e.numberingRestartType=Gs.Continuous,e.startingNumber=1,e.columnCount=0,e}copyFrom(e){this.position=e.position,this.numberingFormat=e.numberingFormat,this.numberingRestartType=e.numberingRestartType,this.startingNumber=e.startingNumber,this.columnCount=e.columnCount}clone(){const e=new Ql;return e.copyFrom(this),e}equals(e){return this.position===e.position&&this.numberingFormat===e.numberingFormat&&this.numberingRestartType===e.numberingRestartType&&this.startingNumber===e.startingNumber&&this.columnCount===e.columnCount}}class Zl{constructor(e){this.model=e}get separator(){return this.model.subDocuments[this.separatorId]}get continuationSeparator(){return this.model.subDocuments[this.continuationSeparatorId]}get continuationNotice(){return this.model.subDocuments[this.continuationNoticeId]}setSeparator(e,t){switch(t){case Xs.Separator:this.separatorId=e;break;case Xs.ContinuationSeparator:this.continuationSeparatorId=e;break;case Xs.ContinuationNotice:this.continuationNoticeId=e;break;default:throw Error("Invalid separator type.")}}getSeparator(e){switch(e){case Xs.Separator:return this.separator;case Xs.ContinuationSeparator:return this.continuationSeparator;case Xs.ContinuationNotice:return this.continuationNotice;default:throw Error("Invalid separator type.")}}*getSeparatos(){this.separator&&(yield this.separator),this.continuationSeparator&&(yield this.continuationSeparator),this.continuationNotice&&(yield this.continuationNotice)}}class ed{constructor(e){this.isMain=!0,this.isHeaderFooter=!1,this.isFooter=!1,this.isHeader=!1,this.isNote=!1,this.isFootNote=!1,this.isEndNote=!1,this.isTextBox=!1,this.isComment=!1,this.isReferenced=!0,this.subDocumentId=e}getEndPosition(e){return e.subDocuments[this.subDocumentId].getLastChunk().getEndPosition()}getSubDocument(e){return e.subDocuments[this.subDocumentId]}static create(e,t,r){switch(e){case yo.Main:return new od;case yo.Header:return new sd(t);case yo.Footer:return new ld(t);case yo.TextBox:return new td(t,r);case yo.FootNote:return new id(t);case yo.EndNote:return new nd(t)}throw new Error(R.D.NotImplemented)}}class td extends ed{constructor(e,t){super(e),this.isMain=!1,this.isTextBox=!0,this.parentSubDocumentId=t}getType(){return yo.TextBox}clone(){return new td(this.subDocumentId,this.parentSubDocumentId)}}class rd extends ed{constructor(){super(...arguments),this.isMain=!1,this.isNote=!0,this.noteType=Xs.Normal}}class id extends rd{constructor(){super(...arguments),this.isMain=!1,this.isFootNote=!0}getType(){return yo.FootNote}clone(){return new id(this.subDocumentId)}}class nd extends rd{constructor(){super(...arguments),this.isMain=!1,this.isEndNote=!0}getType(){return yo.EndNote}clone(){return new nd(this.subDocumentId)}}class od extends ed{constructor(){super(0)}getType(){return yo.Main}getEndPosition(e){var t=e.sections,r=t[t.length-1];return r.startLogPosition.value+r.getLength()}clone(){return new od}}class ad extends ed{constructor(){super(...arguments),this.headerFooterType=Ws.Odd,this.isMain=!1,this.isHeaderFooter=!0}}class sd extends ad{constructor(){super(...arguments),this.isHeader=!0}getType(){return yo.Header}clone(){return new sd(this.subDocumentId)}}class ld extends ad{constructor(){super(...arguments),this.isFooter=!0}getType(){return yo.Footer}clone(){return new ld(this.subDocumentId)}}!function(e){e[e.StartPos=0]="StartPos",e[e.SeparatorPos=1]="SeparatorPos",e[e.EndPos=2]="EndPos",e[e.Uri=3]="Uri",e[e.Anchor=4]="Anchor",e[e.Tip=5]="Tip",e[e.Visited=6]="Visited",e[e.NoInfo=7]="NoInfo"}(Ks||(Ks={})),function(e){e[e.ActiveRecord=0]="ActiveRecord",e[e.Info=1]="Info",e[e.SubDocumentId=2]="SubDocumentId"}(qs||(qs={})),function(e){e[e.ServerUpdateFieldType=0]="ServerUpdateFieldType",e[e.Data=1]="Data"}($s||($s={})),function(e){e[e.Parameters=0]="Parameters",e[e.FieldName=1]="FieldName"}(Js||(Js={})),function(e){e[e.PureText=0]="PureText",e[e.IntervalStart=1]="IntervalStart",e[e.IntervalEnd=2]="IntervalEnd"}(Ys||(Ys={})),function(e){e[e.SimpleText=0]="SimpleText",e[e.DocumentLength=1]="DocumentLength",e[e.DocumentModel=2]="DocumentModel",e[e.ImageCorrespondence=3]="ImageCorrespondence",e[e.Caches=4]="Caches"}(Qs||(Qs={})),function(e){e[e.DocVariable=1]="DocVariable",e[e.MergeField=2]="MergeField"}(Zs||(Zs={})),function(e){e[e.Type=0]="Type",e[e.Offset=1]="Offset",e[e.Length=2]="Length",e[e.MaskedCharacterPropertiesCacheIndex=3]="MaskedCharacterPropertiesCacheIndex",e[e.CharacterStyleIndex=4]="CharacterStyleIndex",e[e.MAX_VALUE=5]="MAX_VALUE"}(el||(el={})),function(e){e[e.Shape=5]="Shape",e[e.Size=6]="Size",e[e.PictureId=7]="PictureId",e[e.DrawingObjectProperties=8]="DrawingObjectProperties"}(tl||(tl={})),function(e){e[e.Shape=5]="Shape",e[e.Size=6]="Size",e[e.SubDocId=7]="SubDocId",e[e.TextBoxProperties=8]="TextBoxProperties",e[e.DrawingObjectProperties=9]="DrawingObjectProperties"}(rl||(rl={})),function(e){e[e.Shape=5]="Shape",e[e.Size=6]="Size",e[e.PictureId=7]="PictureId",e[e.AnchorInfo=8]="AnchorInfo",e[e.DrawingObjectProperties=9]="DrawingObjectProperties"}(il||(il={})),function(e){e[e.Shape=5]="Shape",e[e.Size=6]="Size",e[e.SubDocId=7]="SubDocId",e[e.AnchorInfo=8]="AnchorInfo",e[e.TextBoxProperties=9]="TextBoxProperties",e[e.DrawingObjectProperties=10]="DrawingObjectProperties"}(nl||(nl={})),function(e){e[e.Position=0]="Position",e[e.Length=1]="Length"}(ol||(ol={})),function(e){e[e.StyleIndex=0]="StyleIndex",e[e.TableCellPropertiesIndex=1]="TableCellPropertiesIndex",e[e.ColumnSpan=2]="ColumnSpan",e[e.PreferredWidth=3]="PreferredWidth",e[e.VerticalMerging=4]="VerticalMerging",e[e.StartParagraphPosition=5]="StartParagraphPosition",e[e.EndParagraphPosition=6]="EndParagraphPosition"}(al||(al={})),function(e){e[e.CellMargins=0]="CellMargins",e[e.Borders=1]="Borders",e[e.HideCellMark=2]="HideCellMark",e[e.NoWrap=3]="NoWrap",e[e.FitText=4]="FitText",e[e.TextDirection=5]="TextDirection",e[e.VerticalAlignment=6]="VerticalAlignment",e[e.ShadingInfo=7]="ShadingInfo",e[e.ShadingInfoIndex=8]="ShadingInfoIndex",e[e.UseValue=9]="UseValue"}(sl||(sl={})),function(e){e[e.StartCellPosition=0]="StartCellPosition",e[e.EndCellPosition=1]="EndCellPosition",e[e.CellIndex=2]="CellIndex",e[e.CellInfo=3]="CellInfo",e[e.RightDirection=4]="RightDirection"}(ll||(ll={})),function(e){e[e.ColumnSpan=0]="ColumnSpan",e[e.CellProperties=1]="CellProperties",e[e.PreferredWidth=2]="PreferredWidth",e[e.VerticalMerging=3]="VerticalMerging"}(dl||(dl={})),function(e){e[e.CellMargins=0]="CellMargins",e[e.PreferredWidth=1]="PreferredWidth",e[e.Borders=2]="Borders",e[e.HideCellMark=3]="HideCellMark",e[e.NoWrap=4]="NoWrap",e[e.FitText=5]="FitText",e[e.TextDirection=6]="TextDirection",e[e.VerticalAlignment=7]="VerticalAlignment",e[e.ShadingInfo=8]="ShadingInfo",e[e.ColumnSpan=9]="ColumnSpan",e[e.VerticalMerging=10]="VerticalMerging"}(cl||(cl={})),function(e){e[e.GridBefore=0]="GridBefore",e[e.GridAfter=1]="GridAfter",e[e.WidthAfter=2]="WidthAfter",e[e.WidthBefore=3]="WidthBefore",e[e.TableRowPropertiesIndex=4]="TableRowPropertiesIndex",e[e.TablePropertiesException=5]="TablePropertiesException",e[e.Height=6]="Height",e[e.Cells=7]="Cells"}(hl||(hl={})),function(e){e[e.CellSpacing=0]="CellSpacing",e[e.Header=1]="Header",e[e.HideCellMark=2]="HideCellMark",e[e.CantSplit=3]="CantSplit",e[e.TableRowAlignment=4]="TableRowAlignment",e[e.UseValue=5]="UseValue",e[e.DivId=6]="DivId"}(ul||(ul={})),function(e){e[e.RowIndex=0]="RowIndex",e[e.Cells=1]="Cells",e[e.RowInfo=2]="RowInfo"}(pl||(pl={})),function(e){e[e.Height=0]="Height",e[e.GridBefore=1]="GridBefore",e[e.GridAfter=2]="GridAfter",e[e.WidthAfter=3]="WidthAfter",e[e.WidthBefore=4]="WidthBefore",e[e.TableRowProperties=5]="TableRowProperties",e[e.TablePropertiesException=6]="TablePropertiesException"}(gl||(gl={})),function(e){e[e.Height=0]="Height",e[e.CellSpacing=1]="CellSpacing",e[e.Header=2]="Header",e[e.HideCellMark=3]="HideCellMark",e[e.CantSplit=4]="CantSplit",e[e.TableRowAlignment=5]="TableRowAlignment",e[e.UseValue=6]="UseValue",e[e.GridAfter=7]="GridAfter",e[e.GridBefore=8]="GridBefore",e[e.WidthAfter=9]="WidthAfter",e[e.WidthBefore=10]="WidthBefore",e[e.DivId=11]="DivId"}(ml||(ml={}));class dd{static exportTables(e,t){const r=e.documentModel.tableStyles;for(let i of e.tables){let n={};n[Ns.StyleIndex]=r.indexOf(i.style),n[Ns.NestedLevel]=i.nestedLevel;let o=Jl.convertToJSON(i.properties);n[Ns.TableProperties]=o,n[Ns.Index]=i.index;let a=ql.convertToJSON(i.preferredWidth);if(n[Ns.PreferredWidth]=a,n[Ns.LookTypes]=i.lookTypes,i.parentCell){let e={};e[Os.CellIndex]=i.parentCell.parentRow.cells.indexOf(i.parentCell),e[Os.RowIndex]=i.rows.indexOf(i.parentCell.parentRow),e[Os.TableIndex]=i.parentCell.parentRow.parentTable.index,n[Ns.ParentCell]=e}dd.exportTableRows(e,i.rows,n[Ns.Rows]=[]),t.push(n)}}static exportTableRows(e,t,r){const i=e.documentModel.cache.tableRowPropertiesCache;for(let n of t){let t={};t[hl.GridBefore]=n.gridBefore,t[hl.GridAfter]=n.gridAfter,t[hl.WidthAfter]=ql.convertToJSON(n.widthAfter),t[hl.WidthBefore]=ql.convertToJSON(n.widthBefore);let o=i.indexOf(n.properties);t[hl.TableRowPropertiesIndex]=o,t[hl.TablePropertiesException]=Jl.convertToJSON(n.tablePropertiesException),t[hl.Height]=Kl.convertToJSON(n.height),dd.exportCells(e,n.cells,t[hl.Cells]=[]),r.push(t)}}static exportCells(e,t,r){const i=e.documentModel.tableCellStyles,n=e.documentModel.cache.tableCellPropertiesCache;for(let e of t){let t={};t[al.StyleIndex]=i.indexOf(e.style);let o=n.indexOf(e.properties);t[al.TableCellPropertiesIndex]=o,t[al.ColumnSpan]=e.columnSpan,t[al.PreferredWidth]=ql.convertToJSON(e.preferredWidth),t[al.VerticalMerging]=e.verticalMerging,t[al.StartParagraphPosition]=e.startParagraphPosition.value,t[al.EndParagraphPosition]=e.endParagrapPosition.value,r.push(t)}}}class cd{static exportSubDocument(e,t){dd.exportTables(e,t[ws.Tables]=[]),cd.exportFields(e,t[ws.Fields]=[]),cd.exportBookmarks(e,t[ws.Bookmarks]=[]),cd.exportParagraphs(e,t[ws.Paragraphs]=[]),cd.exportChunks(e,t[ws.Chunks]=[]),cd.exportRangePermissions(e,t[ws.RangePermissions]=[])}static exportFields(e,t){for(let r of e.fields){let e={};e[Ks.StartPos]=r.getAllFieldInterval().start,e[Ks.SeparatorPos]=r.getSeparatorPosition(),e[Ks.EndPos]=r.getAllFieldInterval().end,r.getHyperlinkInfo()?(e[Ks.Uri]=r.getHyperlinkInfo().uri,e[Ks.Anchor]=r.getHyperlinkInfo().anchor,e[Ks.Tip]=r.getHyperlinkInfo().tip,e[Ks.Visited]=(0,S.boolToInt)(r.getHyperlinkInfo().visited)):e[Ks.NoInfo]=1,t.push(e)}}static exportBookmarks(e,t){for(let r of e.bookmarks){let e={};e[xs.StartPos]=r.start,e[xs.Length]=r.interval.length,e[xs.Name]=r.name,t.push(e)}}static exportParagraphs(e,t){const r=e.paragraphs,i=e.documentModel.paragraphStyles,n=e.documentModel.cache.maskedParagraphPropertiesCache;for(let e of r){const r={};let o=n.indexOf(e.maskedParagraphProperties);r[De.MaskedParagraphPropertiesIndex]=o,r[De.ParagraphStyleIndex]=i.indexOf(e.paragraphStyle),r[De.LogPosition]=e.startLogPosition.value,r[De.Length]=e.length,r[De.Tabs]=jl.convertFromTabPropertiesToJSON(e.tabs),r[De.ListIndex]=e.numberingListIndex,r[De.ListLevelIndex]=e.listLevelIndex,t.push(r)}}static exportChunks(e,t){const r=e.chunks,i=e.documentModel.characterStyles,n=e.documentModel.cache.maskedCharacterPropertiesCache;for(let e of r){const r={};r[vs.StartPos]=e.startLogPosition.value,r[vs.TextBuffer]=e.textBuffer,r[vs.IsLast]=(0,S.boolToInt)(e.isLast);const o=[];for(let t of e.textRuns){let e={},r=n.indexOf(t.maskedCharacterProperties);e[el.MaskedCharacterPropertiesCacheIndex]=r,e[el.Type]=t.getType(),e[el.Offset]=t.startOffset,e[el.Length]=t.getLength(),e[el.CharacterStyleIndex]=i.indexOf(t.characterStyle),o.push(e)}r[vs.Runs]=o,t.push(r)}}static exportRangePermissions(e,t){for(let r of e.availableRangePermissions){let e={};e[Ts.Start]=r.start,e[Ts.Length]=r.interval.length,e[Ts.UserName]=r.userName,e[Ts.Group]=r.group,t.push(e)}}}class hd{static convertFromJSON(e,t=new En){return t.name=e[x.Name],t.scriptMultiplier=e[x.ScriptMultiplier],t.cssString=e[x.CssString],t.canBeSet=!!e[x.CanBeSet],t.subScriptOffset=e[x.SubScriptOffset],t.isLoad=!0,t.reset(),t}static convertToJSON(e){const t={};return t[x.Name]=e.name,t[x.ScriptMultiplier]=e.scriptMultiplier,t[x.CssString]=e.cssString,t[x.CanBeSet]=(0,S.boolToInt)(e.canBeSet),t[x.SubScriptOffset]=e.subScriptOffset,t}}!function(e){e[e.Deleted=0]="Deleted",e[e.Id=1]="Id",e[e.Levels=2]="Levels"}(fl||(fl={})),function(e){e[e.AlIndex=0]="AlIndex",e[e.Id=1]="Id",e[e.Levels=2]="Levels"}(bl||(bl={})),function(e){e[e.CharacterPropertiesIndex=0]="CharacterPropertiesIndex",e[e.ParagraphPropertiesIndex=1]="ParagraphPropertiesIndex",e[e.ListLevelPropertiesIndex=2]="ListLevelPropertiesIndex",e[e.MAX_VALUE=3]="MAX_VALUE"}(Cl||(Cl={})),function(e){e[e.NewStart=3]="NewStart",e[e.OverrideStart=4]="OverrideStart",e[e.Level=5]="Level"}(Sl||(Sl={})),function(e){e[e.Index=0]="Index"}(Il||(Il={})),function(e){e[e.InnerId=0]="InnerId",e[e.Deleted=1]="Deleted",e[e.Levels=2]="Levels",e[e.ParagraphProperties=3]="ParagraphProperties",e[e.ListLevelProperties=4]="ListLevelProperties",e[e.CharacterProperties=5]="CharacterProperties",e[e.OverrideStart=6]="OverrideStart",e[e.NewStart=7]="NewStart",e[e.AbstractNumberingListIndex=8]="AbstractNumberingListIndex"}(Pl||(Pl={})),function(e){e[e.NewStart=0]="NewStart",e[e.OverrideStart=1]="OverrideStart"}(wl||(wl={})),function(e){e[e.Start=0]="Start",e[e.Format=1]="Format",e[e.ConvertPreviousLevelNumberingToDecimal=2]="ConvertPreviousLevelNumberingToDecimal",e[e.SuppressBulletResize=3]="SuppressBulletResize",e[e.SuppressRestart=4]="SuppressRestart",e[e.Alignment=5]="Alignment",e[e.DisplayFormatString=6]="DisplayFormatString",e[e.RelativeRestartLevel=7]="RelativeRestartLevel",e[e.Separator=8]="Separator",e[e.TemplateCode=9]="TemplateCode",e[e.OriginalLeftIndent=10]="OriginalLeftIndent",e[e.Legacy=11]="Legacy",e[e.LegacySpace=12]="LegacySpace",e[e.LegacyIndent=13]="LegacyIndent"}(yl||(yl={}));class ud{static convertFromJSON(e){const t=new sn;return t.start=e[yl.Start],t.format=e[yl.Format],t.convertPreviousLevelNumberingToDecimal=!!e[yl.ConvertPreviousLevelNumberingToDecimal],t.suppressBulletResize=!!e[yl.SuppressBulletResize],t.suppressRestart=!!e[yl.SuppressRestart],t.alignment=e[yl.Alignment],t.displayFormatString=e[yl.DisplayFormatString],t.relativeRestartLevel=e[yl.RelativeRestartLevel],t.separator=e[yl.Separator],t.templateCode=e[yl.TemplateCode],t.originalLeftIndent=e[yl.OriginalLeftIndent],t.legacy=!!e[yl.Legacy],t.legacySpace=e[yl.LegacySpace],t.legacyIndent=e[yl.LegacyIndent],t}static convertToJSON(e){const t={};return t[yl.Start]=e.start,t[yl.Format]=e.format,t[yl.ConvertPreviousLevelNumberingToDecimal]=(0,S.boolToInt)(e.convertPreviousLevelNumberingToDecimal),t[yl.SuppressBulletResize]=(0,S.boolToInt)(e.suppressBulletResize),t[yl.SuppressRestart]=(0,S.boolToInt)(e.suppressRestart),t[yl.Alignment]=e.alignment,t[yl.DisplayFormatString]=e.displayFormatString,t[yl.RelativeRestartLevel]=e.relativeRestartLevel,t[yl.Separator]=e.separator,t[yl.TemplateCode]=e.templateCode,t[yl.OriginalLeftIndent]=e.originalLeftIndent,t[yl.Legacy]=(0,S.boolToInt)(e.legacy),t[yl.LegacySpace]=e.legacySpace,t[yl.LegacyIndent]=e.legacyIndent,t}}var pd,gd=__webpack_require__(7814);class md extends gd.ConstInterval{get start(){return this._start.value}get length(){return this._end.value-this._start.value}get end(){return this._end.value}get center(){return(this.start+this.end)/2}constructor(e,t){super(),this._start=e.registerPosition(t.start),this._end=e.registerPosition(t.end)}destructor(e){e.unregisterPosition(this._start),e.unregisterPosition(this._end)}equals(e){return e&&this.start==e.start&&this.end==e.end}getFixedInterval(){return new on.FixedInterval(this.start,this.length)}getBoundaryInterval(){return new Cn.e(this.start,this.end)}}class fd extends gd.ConstInterval{get start(){return this._interval.start}get length(){return this._interval.length}get end(){return this._interval.end}get interval(){return this._interval.getFixedInterval()}constructor(e,t){super(),this._interval=new md(e,t)}equals(e){return e&&this._interval.equals(e._interval)}destructor(e){this._interval.destructor(e)}}class bd{static isValidName(e,t){return e&&e.length&&!/\d/.test(e[0])&&(t||"_"!=e[0])&&!bd.prohibitedSymbolsForName.test(e)}}bd.prohibitedSymbolsForName=/.*[\`\~\!\@\#\$\%\^\&\*\(\)\+\{\}\|\:\"\<\>\?\-\=\[\]\.\,\;\'\/\\ ].*/;class Cd extends fd{constructor(e,t,r){super(e,t),this.name="",this.name=r}static isValidName(e,t){return bd.isValidName(e,t)}isHidden(){return this.name.length>0&&"_"==this.name[0]}isToc(){return 0==this.name.toUpperCase().indexOf("_TOC")}equals(e){return super.equals(e)&&this.name==e.name}get constBookmark(){return new Sd(this,this.name)}clone(e){return new Cd(e.positionManager,this.interval,this.name)}}class Sd extends gd.ConstInterval{get start(){return this.interval.start}get length(){return this.interval.length}get end(){return this.interval.end}constructor(e,t){super(),this.interval=new Cn.e(e.start,e.end),this.name=t}equals(e){return e&&this.name==e.name&&this.interval.equals(e.interval)}createBookmark(e){return new Cd(e,this.interval,this.name)}static comparer(e,t){const r=e.start-t.start;return 0==r?Qe.Comparers.string(e.name,t.name):r}}class Id{constructor(e,t){this.bookmark=e,this.subDocument=t}}!function(e){e[e.PageColor=0]="PageColor",e[e.DefaultTabWidth=1]="DefaultTabWidth",e[e.DifferentOddAndEvenPages=2]="DifferentOddAndEvenPages",e[e.HeaderFooterCreated=3]="HeaderFooterCreated",e[e.HeaderFooterIndexChanged=4]="HeaderFooterIndexChanged",e[e.LoadFontInfo=5]="LoadFontInfo",e[e.SectionFormattingChanged=6]="SectionFormattingChanged",e[e.CreateStyleLink=7]="CreateStyleLink",e[e.DeleteStyleLink=8]="DeleteStyleLink",e[e.DocumentProtectionChanged=9]="DocumentProtectionChanged",e[e.AbstractNumberingListAdded=10]="AbstractNumberingListAdded",e[e.AbstractNumberingListDeleted=11]="AbstractNumberingListDeleted",e[e.NumberingListAdded=12]="NumberingListAdded",e[e.NumberingListDeleted=13]="NumberingListDeleted",e[e.ListLevelPropertyChanged=14]="ListLevelPropertyChanged",e[e.ListLevelParagraphPropertyChanged=15]="ListLevelParagraphPropertyChanged",e[e.ListLevelCharacterPropertyChanged=16]="ListLevelCharacterPropertyChanged",e[e.IOverrideListLevelChanged=17]="IOverrideListLevelChanged",e[e.BookmarkCreated=18]="BookmarkCreated",e[e.BookmarkDeleted=19]="BookmarkDeleted",e[e.TabInserted=20]="TabInserted",e[e.TabDeleted=21]="TabDeleted",e[e.LoadPicturesInfo=22]="LoadPicturesInfo",e[e.InlinePicturesUpdated=23]="InlinePicturesUpdated",e[e.InlinePictureInserted=24]="InlinePictureInserted",e[e.AnchoredPictureInserted=25]="AnchoredPictureInserted",e[e.AnchoredPictureSizeChanged=26]="AnchoredPictureSizeChanged",e[e.InlineObjectRunPropertyChanged=27]="InlineObjectRunPropertyChanged",e[e.FieldInserted=28]="FieldInserted",e[e.FieldDeleted=29]="FieldDeleted",e[e.HyperlinkInfoChanged=30]="HyperlinkInfoChanged",e[e.FieldsShowCodeChanged=31]="FieldsShowCodeChanged",e[e.SimpleRunInserted=32]="SimpleRunInserted",e[e.TextBufferChanged=33]="TextBufferChanged",e[e.ParagraphInserted=34]="ParagraphInserted",e[e.SectionInserted=35]="SectionInserted",e[e.AnchoredTextBoxInserted=36]="AnchoredTextBoxInserted",e[e.AnchorObjectRemoved=37]="AnchorObjectRemoved",e[e.IntervalRemoved=38]="IntervalRemoved",e[e.ParagraphMerged=39]="ParagraphMerged",e[e.SectionMerged=40]="SectionMerged",e[e.CharacterFormattingChanged=41]="CharacterFormattingChanged",e[e.CharacterPropertiesChanged=42]="CharacterPropertiesChanged",e[e.ParagraphFormattingChanged=43]="ParagraphFormattingChanged",e[e.ParagraphPropertiesChanged=44]="ParagraphPropertiesChanged",e[e.ParagraphAndCharacterMergedPropertiesReset=45]="ParagraphAndCharacterMergedPropertiesReset",e[e.AnchoredTextBoxSizeChanged=46]="AnchoredTextBoxSizeChanged",e[e.AnchoredTextBoxPropertiesChanged=47]="AnchoredTextBoxPropertiesChanged",e[e.AnchorInfoPropertyChanged=48]="AnchorInfoPropertyChanged",e[e.ShapeChanged=49]="ShapeChanged",e[e.ShapePropertyChanged=50]="ShapePropertyChanged",e[e.CharacterStyleApplied=51]="CharacterStyleApplied",e[e.ParagraphStyleApplied=52]="ParagraphStyleApplied",e[e.TableStyleChanged=53]="TableStyleChanged",e[e.ParagraphNumberingListChanged=54]="ParagraphNumberingListChanged",e[e.TableCreated=55]="TableCreated",e[e.TableRemoved=56]="TableRemoved",e[e.TableStartPositionShifted=57]="TableStartPositionShifted",e[e.TableCellPropertyChanged=58]="TableCellPropertyChanged",e[e.TablePropertyChanged=59]="TablePropertyChanged",e[e.TableRowPropertyChanged=60]="TableRowPropertyChanged",e[e.TableCellSplittedHorizontally=61]="TableCellSplittedHorizontally",e[e.TableCellMergedHorizontally=62]="TableCellMergedHorizontally",e[e.TableRowInserted=63]="TableRowInserted",e[e.TableRowRemoved=64]="TableRowRemoved",e[e.TableCellRemoved=65]="TableCellRemoved",e[e.TableCellInserted=66]="TableCellInserted",e[e.RangePermissionsChanged=67]="RangePermissionsChanged",e[e.RangePermissionsPropertiesChanged=68]="RangePermissionsPropertiesChanged"}(pd||(pd={}));class Pd{constructor(e,t){this.subDocumentId=e,this.endPosition=t,this.type=pd.FieldDeleted}}var wd,yd=__webpack_require__(5929);!function(e){e[e.None=0]="None",e[e.CreateDate=1]="CreateDate",e[e.Date=2]="Date",e[e.DocVariable=3]="DocVariable",e[e.Hyperlink=4]="Hyperlink",e[e.If=5]="If",e[e.IncludePicture=6]="IncludePicture",e[e.MergeField=7]="MergeField",e[e.NumPages=8]="NumPages",e[e.Page=9]="Page",e[e.Seq=10]="Seq",e[e.Symbol=11]="Symbol",e[e.TC=12]="TC",e[e.TOC=13]="TOC",e[e.Formula=14]="Formula",e[e.FillIn=15]="FillIn"}(wd||(wd={}));class xd{constructor(e,t,r,i){this.uri=e||"",this.anchor=t||"",this.tip=r||"",this.visited=i||!1}clone(){return new xd(this.uri,this.anchor,this.tip,this.visited)}getUriWithAnchor(){return this.uri+(this.anchor.length>0?"#"+this.anchor:"")}static getNewCodeText(e){return['HYPERLINK "',e.uri,'"',""==e.tip?"":' \\o "'+e.tip+'"',""==e.anchor?"":' \\l "'+e.anchor+'"'].join("")}isUri(){return 0!==this.uri.length&&(!this.uri.startsWith("#")&&yd.jE.isValid(this.uri))}isMail(){return this.uri.startsWith("mailto:")}isValid(){return!(!this.uri&&!this.anchor)}}class Td{constructor(e,t,r,i,n){this.identifier=e,this.repeats=t,this.hidesResult=r,this.resets=i,this.resetsWith=n||0}clone(){return new Td(this.identifier,this.repeats,this.hidesResult,this.resets,this.resetsWith)}}class vd{constructor(e,t,r){this.identifier=e,this.text=t,this.level=r}clone(){return new vd(this.identifier,this.text,this.level)}}class Md{constructor(e,t,r,i,n,o,a){this.codeStartPosition=e.registerPosition(r+1),this.resultStartPosition=e.registerPosition(i+1),this.fieldEndPosition=e.registerPosition(n),this.index=t,this.showCode=o,this.parent=void 0,void 0!==a&&(this.hyperlinkInfo=a)}destructor(e){e.unregisterPosition(this.codeStartPosition),e.unregisterPosition(this.resultStartPosition),e.unregisterPosition(this.fieldEndPosition)}static addField(e,t){var r,i;for(e.splice(t.index,0,t),i=t.index+1;r=e[i];i++)r.index++;for(i=t.index-1;(r=e[i])&&!(r.getFieldEndPosition()<=t.getFieldStartPosition());i--);var n=Math.max(0,i);for(i=t.index+1;(r=e[i])&&!(r.getFieldStartPosition()>=t.getFieldEndPosition());i++);var o=Math.min(e.length-1,i);for(i=n;i<=o;i++)e[i].initParent(e)}static deleteFieldByIndex(e,t,r){for(var i,n=e.fields,o=n[t],a=t+1;i=n[a];a++)i.index--;for(var s,l=o.getFieldEndPosition(),d=t+1;(s=n[d])&&(s.parent==o&&(s.parent=o.parent),!(s.getFieldStartPosition()>=l));d++);n.splice(o.index,1),o.destructor(e.positionManager),r.notifyModelChanged(new Pd(e.id,l))}isHyperlinkField(){return!!this.hyperlinkInfo}setNewHyperlinkInfo(e){this.hyperlinkInfo=e}getHyperlinkInfo(){return this.hyperlinkInfo}getSequenceInfo(){return this.sequenceInfo}setNewSequenceInfo(e){this.sequenceInfo=e}isSequenceField(){return void 0!==this.sequenceInfo}getTcInfo(){return this.tcInfo}setNewTcInfo(e){this.tcInfo=e}isTcField(){return void 0!==this.tcInfo}getFieldStartPosition(){return this.codeStartPosition.value-1}getCodeStartPosition(){return this.codeStartPosition.value}getSeparatorPosition(){return this.resultStartPosition.value-1}getResultStartPosition(){return this.resultStartPosition.value}getResultEndPosition(){return this.fieldEndPosition.value-1}getFieldEndPosition(){return this.fieldEndPosition.value}setParent(e){if(null!==e&&(e.getFieldStartPosition()>=this.getFieldStartPosition()||e.getFieldEndPosition()<=this.getFieldEndPosition()))throw new Error("Incorrect field parent");this.parent=e}initParent(e){for(var t,r=this.index-1;t=e[r];r--){if(t.getFieldEndPosition()>this.getFieldEndPosition())return void(this.parent=t);if(null==t.parent)break}this.parent=null}static normedBinaryIndexOf(e,t){return C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.getCodeStartPosition()),t)}static binaryIndexOf(e,t){return C.SearchUtils.binaryIndexOf(e,(e=>e.getCodeStartPosition()-t))}getAbsolutelyTopLevelField(){for(var e=this;e.parent;e=e.parent);return e}getCodeInterval(){return on.FixedInterval.fromPositions(this.getCodeStartPosition(),this.getSeparatorPosition())}getCodeIntervalWithBorders(){return on.FixedInterval.fromPositions(this.getFieldStartPosition(),this.getResultStartPosition())}getResultInterval(){return on.FixedInterval.fromPositions(this.getResultStartPosition(),this.getResultEndPosition())}getResultIntervalWithBorders(){return on.FixedInterval.fromPositions(this.getResultStartPosition(),this.getFieldEndPosition())}getAllFieldInterval(){return on.FixedInterval.fromPositions(this.getFieldStartPosition(),this.getFieldEndPosition())}getAllFieldIntervalWithoutBorders(){return on.FixedInterval.fromPositions(this.getCodeStartPosition(),this.getResultEndPosition())}isPlacedInCodeAreaTopLevelField(e){return!!nn.IntervalAlgorithms.getIntersection(this.getAllFieldInterval(),e.getCodeInterval())}getPositions(e){e.push(this.codeStartPosition),e.push(this.resultStartPosition),e.push(this.fieldEndPosition)}static correctIntervalDueToFieldsWithoutUiChecks(e,t){const r=e.fields;if(t.length&&r.length){let e=Math.max(0,Md.normedBinaryIndexOf(r,t.start)),i=r[e];for(;i.parent;)i=i.parent;e=i.index;let n=e;for(;(i=r[n])&&i.getFieldStartPosition()<t.end;n++)(nn.IntervalAlgorithms.getIntersectionNonNullLength(t,new on.FixedInterval(i.getFieldStartPosition(),1))||nn.IntervalAlgorithms.getIntersectionNonNullLength(t,new on.FixedInterval(i.getSeparatorPosition(),1))||nn.IntervalAlgorithms.getIntersectionNonNullLength(t,new on.FixedInterval(i.getResultEndPosition(),1)))&&t.expand(i.getAllFieldInterval());return on.FixedInterval.fromPositions(e,n)}return new on.FixedInterval(0,0)}static correctIntervalDueToFieldsCaseSelectionCollapsed(e,t){const r=Ed.getRelativeVisabilityInfo(t,e);for(let e,i=r.length-1;e=r[i];i--){const r=e.field;if(r.getCodeInterval().containsWithIntervalEnd(t)){if(e.showCode)break;t=r.getFieldStartPosition()}else{const i=r.getResultInterval();if(i.containsWithIntervalEnd(t)){if(e.showResult){t==i.start?t=r.getFieldStartPosition():t==i.end&&(t=r.getFieldEndPosition());break}t=r.getFieldEndPosition()}}}return t}static correctIntervalDueToFields(e,t){const r=e.fields;if(!r.length)return;if(!t.length)return t.start=Md.correctIntervalDueToFieldsCaseSelectionCollapsed(e.fields,t.start);const i=Md.correctIntervalDueToFieldsWithoutUiChecks(e,t);f.ListUtils.forEach(r,(r=>{r.getResultInterval().equals(t)&&!this.isFloatingObjectSelected(e,t)&&t.expand(r.getAllFieldInterval())}),i.start,i.end)}static isFloatingObjectSelected(e,t){if(1!==t.length)return!1;const r=e.getRunByPosition(t.start);return r&&(r.getType()==cs.AnchoredPictureRun||r.getType()==cs.AnchoredTextBoxRun)}static correctWhenPositionInStartCode(e,t){if(e.length<1)return t;var r=e[Math.max(0,Md.normedBinaryIndexOf(e,t))];return r.getResultStartPosition()==t?r.parent?Md.correctWhenPositionInStartCode(e,r.getFieldStartPosition()):r.getFieldStartPosition():t}clone(e){const t=new Md(e.positionManager,this.index,this.getFieldStartPosition(),this.getSeparatorPosition(),this.getFieldEndPosition(),this.showCode,this.hyperlinkInfo?this.hyperlinkInfo.clone():this.hyperlinkInfo);return t.sequenceInfo=this.sequenceInfo?this.sequenceInfo.clone():this.sequenceInfo,t.tcInfo=this.tcInfo?this.tcInfo.clone():this.tcInfo,t.disableUpdate=this.disableUpdate,t.hideByParent=this.hideByParent,t.locked=this.locked,t}}class Ed{constructor(e,t,r){this.showCode=e,this.showResult=t,this.field=r}static getRelativeVisabilityInfo(e,t){var r=[],i=Md.normedBinaryIndexOf(t,e+1);if(i<0)return[];var n=t[i];do{n.getAllFieldIntervalWithoutBorders().containsWithIntervalEnd(e)&&r.unshift(new Ed(n.showCode,!n.showCode,n))}while(n=n.parent);for(var o,a=r[0],s=1;o=r[s];s++)Ed.applyTopLevelFieldInfoVisabilityToThisFieldInfo(a,o),a=o;return r}static applyTopLevelFieldInfoVisabilityToThisFieldInfo(e,t){var r=t.field.isPlacedInCodeAreaTopLevelField(e.field)?e.showCode:e.showResult;t.showCode=t.showCode&&r,t.showResult=t.showResult&&r}clone(){return new Ed(this.showCode,this.showResult,this.field)}copyFrom(e){this.field=e.field,this.showCode=e.showCode,this.showResult=e.showResult}}class Dd extends fd{constructor(e,t,r,i){super(e,t),this.userName=r,this.group=i}isGranted(e){return Dd.allow(this.group,Dd.Everyone_GROUP_NAME)||Dd.allow(this.userName,e.authenticationUserName)||Dd.allow(this.userName,e.authenticationEMail)||Dd.allow(this.group,e.authenticationGroup)}static allow(e,t){return""!=t&&0==Qe.Comparers.stringIgnoreCase(e,t)}get end(){return this._interval.end-1}get length(){return this.end-this.start}get interval(){return on.FixedInterval.fromPositions(this.start,this.end)}get constRangePermission(){return new Fd(this,this.userName,this.group)}getRangePermissionColor(e,t){if(e.isDocumentProtectionEnabled)return t.rangeHighlightColor;let r=this.userName;rn.StringUtils.isNullOrEmpty(this.group)||(r+=":"+this.group);let i=e.colorProvider.rangePermissionColors[r];return i||(i=e.colorProvider.getColor(),e.colorProvider.rangePermissionColors[r]=i),i}clone(e){return new Dd(e,this.interval,this.userName,this.group)}equals(e){return super.equals(e)&&(rn.StringUtils.isNullOrEmpty(this.userName)?0==Qe.Comparers.stringIgnoreCase(e.group,this.group):0==Qe.Comparers.stringIgnoreCase(e.userName,this.userName))}}Dd.Everyone_GROUP_NAME="Everyone".toLowerCase(),Dd.Current_GROUP_NAME="Current User".toLowerCase(),Dd.Editors_GROUP_NAME="Editors".toLowerCase(),Dd.Owners_GROUP_NAME="Owners".toLowerCase(),Dd.Contributors_GROUP_NAME="Contributors".toLowerCase(),Dd.Administrators_GROUP_NAME="Administrators".toLowerCase();class Fd extends gd.ConstInterval{get start(){return this.interval.start}get length(){return this.interval.length}get end(){return this.interval.end}constructor(e,t,r){super(),this.interval=Cn.e.makeByConstInterval(e),this.userName=t,this.group=r}equals(e){return e&&this.userName==e.userName&&this.group==e.group&&this.interval.equals(e.interval)}static comparer(e,t){const r=e.start-t.start;return 0==r?e.userName!=t.userName?Qe.Comparers.string(e.userName,t.userName):Qe.Comparers.string(e.group,t.group):r}}class Rd{constructor(e,t){this.preferredWidth=lr.createDefault(),this.columnSpan=1,this.verticalMerging=Xe.None,this.conditionalFormatting=qe.WholeTable,this.parentRow=e,this.properties=t}destructor(e){this.startParagraphPosition&&e.unregisterPosition(this.startParagraphPosition),this.endParagrapPosition&&e.unregisterPosition(this.endParagrapPosition)}get interval(){return on.FixedInterval.fromPositions(this.startParagraphPosition.value,this.endParagrapPosition.value)}get isFirstCellInRow(){return this===this.parentRow.cells[0]}getActualTopCellBorder(e){const t=this.parentRow.parentTable.rows[0]==this.parentRow;return this.getActualBorderCore(new Kr(this.parentRow.tablePropertiesException,t),e)}getActualLeftCellBorder(e){const t=this.parentRow.cells[0]==this;return this.getActualBorderCore(new Xr(this.parentRow.tablePropertiesException,t),e)}getActualBottomCellBorder(e){const t=f.ListUtils.last(this.parentRow.parentTable.rows)==this.parentRow;return this.getActualBorderCore(new qr(this.parentRow.tablePropertiesException,t),e)}getActualRightCellBorder(e){const t=f.ListUtils.last(this.parentRow.cells)==this;return this.getActualBorderCore(new Gr(this.parentRow.tablePropertiesException,t),e)}getActualBorders(e){const t=this.getActualTopCellBorder(e)||new Me,r=this.getActualRightCellBorder(e)||new Me,i=this.getActualBottomCellBorder(e)||new Me,n=this.getActualLeftCellBorder(e)||new Me,o=new Me,a=new Me;return or.create(t,r,i,n,o,a)}getActualBorderCore(e,t){const r=this.parentRow.parentTable.style;return e.getProperty(this.properties,r,this.conditionalFormatting,t)}getActualLeftCellMargin(e){return this.getActualCellMarginCore(new Hr(this.parentRow.parentTable,e,this.parentRow.tablePropertiesException),e.defaultTableCellProperties)}getActualTopCellMargin(e){return this.getActualCellMarginCore(new Wr(this.parentRow.parentTable,e,this.parentRow.tablePropertiesException),e.defaultTableCellProperties)}getActualRightCellMargin(e){return this.getActualCellMarginCore(new Vr(this.parentRow.parentTable,e,this.parentRow.tablePropertiesException),e.defaultTableCellProperties)}getActualBottomCellMargin(e){return this.getActualCellMarginCore(new zr(this.parentRow.parentTable,e,this.parentRow.tablePropertiesException),e.defaultTableCellProperties)}getActualCellMarginCore(e,t){return e.getProperty(this.properties,this.parentRow.parentTable.style,this.conditionalFormatting,t)}getActualMargins(e){const t=this.getActualTopCellMargin(e),r=this.getActualRightCellMargin(e),i=this.getActualBottomCellMargin(e),n=this.getActualLeftCellMargin(e);return ar.create(t,r,i,n)}getActualShadingInfo(e){return(new Qr).getProperty(this.properties,this.parentRow.parentTable.style,this.conditionalFormatting,e)}clone(e,t){const r=e.documentModel.cache.tableCellPropertiesCache.getItem(this.properties),i=new Rd(t,r);return i.preferredWidth=this.preferredWidth.clone(),i.columnSpan=this.columnSpan,i.verticalMerging=this.verticalMerging,i.startParagraphPosition=e.positionManager.registerPosition(this.startParagraphPosition.value),i.endParagrapPosition=e.positionManager.registerPosition(this.endParagrapPosition.value),i.conditionalFormatting=this.conditionalFormatting,i}}class Ld{get logicColumnCount(){return this.gridBefore+this.gridAfter+f.ListUtils.accumulate(this.cells,0,((e,t)=>e+t.columnSpan))}constructor(e,t){this.cells=[],this.widthBefore=lr.createDefault(),this.widthAfter=lr.createDefault(),this.gridBefore=0,this.gridAfter=0,this.height=dr.createDefault(),this.tablePropertiesException=new mr,this.conditionalFormatting=qe.WholeTable,this.parentTable=e,this.properties=t}get isLastRowInTable(){return f.ListUtils.last(this.parentTable.rows)===this}destructor(e){for(var t,r=0;t=this.cells[r];r++)t.destructor(e)}getStartPosition(){return this.cells[0].startParagraphPosition.value}getEndPosition(){return f.ListUtils.last(this.cells).endParagrapPosition.value}get interval(){return on.FixedInterval.fromPositions(this.getStartPosition(),this.getEndPosition())}getCellColumnIndex(e){return f.ListUtils.accumulate(this.cells,this.gridBefore,((e,t)=>e+t.columnSpan),0,e)}getCellIndex(e){let t=0,r=-1;for(;t<=e;)t+=this.cells[++r].columnSpan;return r}getTotalCellsInRowConsiderGrid(){let e=this.gridBefore;for(let t,r=0;t=this.cells[r];r++)e+=t.columnSpan;return e+=this.gridAfter,e}clone(e,t){const r=e.documentModel.cache.tableRowPropertiesCache.getItem(this.properties),i=new Ld(t,r);return i.parentTable=t,i.cells=f.ListUtils.map(this.cells,(t=>t.clone(e,i))),i.widthBefore=this.widthBefore.clone(),i.widthAfter=this.widthAfter.clone(),i.gridBefore=this.gridBefore,i.gridAfter=this.gridAfter,i.height=this.height.clone(),i.tablePropertiesException=this.tablePropertiesException.clone(),i.conditionalFormatting=this.conditionalFormatting,i}}class Bd extends Ze{constructor(e,t,r){super(e),this.boundSubDocument=t,this.tableIndex=r}getTable(){return this.boundSubDocument.tables[this.tableIndex]}static getRowCellsRanges(e){return f.ListUtils.map(e.cells,(e=>e.interval))}static getTableCellsRanges(e){return f.ListUtils.map(e.rows,(e=>Bd.getRowCellsRanges(e)))}}class Ad extends Bd{constructor(e,t,r,i,n){super(e,t,-1),this.firstParagraphIndex=r,this.rowCount=i,this.cellCount=n}redo(){this.tableIndex=this.modelManipulator.table.createTable(this.boundSubDocument,this.firstParagraphIndex,this.rowCount,this.cellCount).index}undo(){this.modelManipulator.table.removeTable(this.boundSubDocument,this.getTable())}}class Nd extends Bd{redo(){this.modelManipulator.table.shiftTableStartPositionToTheRight(this.boundSubDocument,this.getTable())}undo(){this.modelManipulator.table.restoreShiftedTableStartPositionToTheRight(this.boundSubDocument,this.getTable())}}class kd extends Bd{constructor(e,t,r,i,n){super(e,t,r),this.formatting=n,this.rowIndex=i}redo(){let e=this.getTable().rows[this.rowIndex];this.oldFormatting=e.conditionalFormatting,e.conditionalFormatting=this.formatting}undo(){this.getTable().rows[this.rowIndex].conditionalFormatting=this.oldFormatting}}class Od extends Bd{constructor(e,t,r,i,n,o){super(e,t,r),this.formatting=o,this.rowIndex=i,this.cellIndex=n}redo(){let e=this.getTable().rows[this.rowIndex].cells[this.cellIndex];this.oldFormatting=e.conditionalFormatting,e.conditionalFormatting=this.formatting}undo(){this.getTable().rows[this.rowIndex].cells[this.cellIndex].conditionalFormatting=this.oldFormatting}}class _d extends Bd{constructor(e,t,r,i,n){super(e,t,r),this.newValue=n,this.rowIndex=i}}class Ud extends _d{redo(){this.oldState=this.modelManipulator.table.rowProperties.gridAfter.setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.newValue)}undo(){this.modelManipulator.table.rowProperties.gridAfter.restoreValue(this.boundSubDocument,this.oldState)}}class Hd extends _d{redo(){this.oldState=this.modelManipulator.table.rowProperties.gridBefore.setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.newValue)}undo(){this.modelManipulator.table.rowProperties.gridBefore.restoreValue(this.boundSubDocument,this.oldState)}}class Vd extends _d{redo(){this.oldState=this.modelManipulator.table.rowProperties.widthAfter.setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.newValue)}undo(){this.modelManipulator.table.rowProperties.widthAfter.restoreValue(this.boundSubDocument,this.oldState)}}class Wd extends _d{redo(){this.oldState=this.modelManipulator.table.rowProperties.widthBefore.setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.newValue)}undo(){this.modelManipulator.table.rowProperties.widthBefore.restoreValue(this.boundSubDocument,this.oldState)}}class zd extends _d{constructor(e,t,r,i,n,o){super(e,t,r,i,n),this.newUse=o}redo(){this.oldState=this.getManipulator().setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.newValue,this.newUse)}undo(){this.getManipulator().restoreValue(this.boundSubDocument,this.oldState)}getManipulator(){throw new Error(R.D.NotImplemented)}}class jd extends _d{redo(){this.oldState=this.modelManipulator.table.rowProperties.height.setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.newValue)}undo(){this.modelManipulator.table.rowProperties.height.restoreValue(this.boundSubDocument,this.oldState)}}class Xd extends zd{getManipulator(){return this.modelManipulator.table.rowProperties.cellSpacing}}class Gd extends zd{getManipulator(){return this.modelManipulator.table.rowProperties.cantSplit}}class Kd extends zd{getManipulator(){return this.modelManipulator.table.rowProperties.tableRowAlignment}}class qd extends Bd{constructor(e,t,r,i,n,o){super(e,t,r),this.newValue=o,this.rowIndex=i,this.cellIndex=n}}class $d extends qd{redo(){this.oldState=this.modelManipulator.table.cellProperties.columnSpan.setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.cellIndex,this.newValue)}undo(){this.modelManipulator.table.cellProperties.columnSpan.restoreValue(this.boundSubDocument,this.oldState)}}class Jd extends qd{redo(){this.oldState=this.modelManipulator.table.cellProperties.verticalMerging.setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.cellIndex,this.newValue)}undo(){this.modelManipulator.table.cellProperties.verticalMerging.restoreValue(this.boundSubDocument,this.oldState)}static fromPosition(e,t,r,i){return new Jd(e,t,r.table.index,r.rowIndex,r.cellIndex,i)}}class Yd extends qd{constructor(e,t,r,i,n,o,a){super(e,t,r,i,n,o),this.newUse=a}redo(){this.oldState=this.getManipulator().setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.cellIndex,this.newValue,this.newUse)}undo(){this.getManipulator().restoreValue(this.boundSubDocument,this.oldState)}getManipulator(){throw new Error(R.D.NotImplemented)}}class Qd extends qd{constructor(e,t,r,i,n,o,a){if(super(e,t,r,i,n,o),o.length!==a.length)throw new Error("newValues.length should be equal to newUses.length");this.newUses=a}redo(){this.oldState=this.getManipulator().setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.cellIndex,this.newValue,this.newUses)}undo(){this.getManipulator().restoreValue(this.boundSubDocument,this.oldState)}getManipulator(){throw new Error(R.D.NotImplemented)}}class Zd extends Qd{getManipulator(){return this.modelManipulator.table.cellProperties.cellMargins}}class ec extends Qd{getManipulator(){return this.modelManipulator.table.cellProperties.borders}}class tc extends qd{redo(){this.oldState=this.modelManipulator.table.cellProperties.preferredWidth.setValue(this.boundSubDocument,this.tableIndex,this.rowIndex,this.cellIndex,this.newValue)}undo(){this.modelManipulator.table.cellProperties.preferredWidth.restoreValue(this.boundSubDocument,this.oldState)}}class rc extends Yd{getManipulator(){return this.modelManipulator.table.cellProperties.noWrap}}class ic extends Yd{getManipulator(){return this.modelManipulator.table.cellProperties.verticalAlignment}}class nc extends Yd{getManipulator(){return this.modelManipulator.table.cellProperties.shadingInfo}}class oc{static getCellIndexByColumnIndex(e,t){let r=e.gridBefore;for(let i,n=0;i=e.cells[n];n++){if(t>=r&&t<r+i.columnSpan)return n;r+=i.columnSpan}return-1}static getCellIndexByEndColumnIndex(e,t){let r=this.getCellIndexByColumnIndex(e,t);if(r<0)return-1;let i=e.cells[r];return this.getStartColumnIndex(i)+i.columnSpan-1<=t?r:0!=r?r-1:-1}static getStartColumnIndex(e){let t=e.parentRow.gridBefore,r=e.parentRow;for(let i,n=0;(i=r.cells[n])&&i!==e;n++)t+=i.columnSpan;return t}static getEndColumnIndex(e){return this.getStartColumnIndex(e)+e.columnSpan-1}static getColumnCount(e){let t=e.rows[0],r=t.gridBefore+t.gridAfter;for(let e,i=0;e=t.cells[i];i++)r+=e.columnSpan;return r}static getCellIndicesByColumnsRange(e,t){let r=[],i=t.start;for(;i<t.end;){let t=this.getCellIndexByColumnIndex(e,i),n=e.cells[t];if(!n)return r;r.push(t),i+=i-this.getStartColumnIndex(n)+n.columnSpan}return r}static getAbsoluteCellIndexInRow(e,t){if(!e.cells.length)throw new Error("Empty row");t-=e.gridBefore;let r=0,i=e.cells.length;for(;t>0&&r<i;){(t-=e.cells[r].columnSpan)>=0&&r++}return r}static getVerticalSpanCellPositions(e,t){let r=[];if(r.push(e),e.cell.verticalMerging!==Xe.Restart)return r;let i=e.table;for(let n,o=e.rowIndex+1;n=i.rows[o];o++){let e=this.getCellIndexByColumnIndex(n,t),a=n.cells[e];if(!a||a.verticalMerging!==Xe.Continue)break;r.push(Qa.createAndInit(i,o,e))}return r}static getSameTableCells(e,t){const r=e.parentRow.parentTable.nestedLevel>=t.parentRow.parentTable.nestedLevel;let i=r?e:t,n=r?t:e;for(;i.parentRow.parentTable.nestedLevel>n.parentRow.parentTable.nestedLevel;)i=i.parentRow.parentTable.parentCell;for(;;){if(i.parentRow.parentTable===n.parentRow.parentTable)return{firstCell:r?i:n,lastCell:r?n:i};if(i=i.parentRow.parentTable.parentCell,n=n.parentRow.parentTable.parentCell,!i||!n)return null}}static splitTableCellsVerticallyCore(e,t,r,i,n,o){const{table:a,cell:s,row:l,cellIndex:d}=r,{modelManipulator:c}=e.modelManager;if(s.verticalMerging===Xe.Restart)return void this.splitMergedCellsVertically(e,t,r,n,i);this.insertRows(e,t,r,i);const h=d,u=d+n-1;for(let e,n=0;e=l.cells[n];n++)if(n<h||n>u){const s=this.getStartColumnIndex(e),l=Qa.createAndInit(a,r.rowIndex,n),d=this.getVerticalSpanCellPositions(l,s)[0].rowIndex;for(let e=i+r.rowIndex-2;e>=d;e--){const r=this.getCellIndexByColumnIndex(a.rows[e],s),i=Qa.createAndInit(a,e,r);c.table.mergeTwoTableCellsVertically(t,i,o)}c.table.normalizeRows(t,a)}}static insertRows(e,t,r,i){const{history:n,modelManipulator:o}=e.modelManager,a=r.row.height,s=dr.create(a.value/i,a.type),l=new jd(o,t,r.table.index,r.rowIndex,s);n.addAndRedo(l);for(let e=1;e<i;e++)o.table.insertRowBelow(t,r.table,r.rowIndex)}static splitMergedCellsVertically(e,t,r,i,n){const o=r.cellIndex+i-1;for(let i=r.cellIndex;i<=o;i++){const o=Qa.createAndInit(r.table,r.rowIndex,i);this.splitMergedCellsVerticallyCore(e,t,o,n)}}static splitMergedCellsVerticallyCore(e,t,r,i){const{history:n,modelManipulator:o}=e.modelManager,a=this.getStartColumnIndex(r.cell),s=this.getVerticalSpanCellPositions(r,a);if(s.length===i)for(let e,i=0;e=s[i];i++)n.addAndRedo(new Jd(o,t,r.table.index,e.rowIndex,e.cellIndex,Xe.None));else{const e=s.length/i;for(let i,a=0;i=s[a];a++)a%e==0&&n.addAndRedo(new Jd(o,t,r.table.index,i.rowIndex,i.cellIndex,Xe.Restart))}}static splitTableCellsHorizontallyCore(e,t,r,i,n){const{history:o,modelManipulator:a}=e.modelManager,s=this.getStartColumnIndex(r.cell),l=this.getVerticalSpanCellPositions(r,s),d=i-r.cell.columnSpan,c=r.cell.preferredWidth;if(c.type!==Je.Nil&&c.type!==Je.Auto)for(let e=l.length-1;e>=0;e--){const r=l[e],n=r.cell.preferredWidth;n.type!==Je.Nil&&n.type!==Je.Auto&&o.addAndRedo(new tc(a,t,r.table.index,r.rowIndex,r.cellIndex,lr.create(n.value/i,n.type))),r.cell.columnSpan>1&&o.addAndRedo(new $d(a,t,r.table.index,r.rowIndex,r.cellIndex,Math.max(1,r.cell.columnSpan-(i-1))))}for(let e=1;e<i;e++)a.table.insertCellToTheRight(t,r.table,r.rowIndex,r.cellIndex,n,!1,!1);d>0&&this.normalizeColumnSpansAfterSplitHorizontally(e,t,l,s,d)}static normalizeColumnSpansAfterSplitHorizontally(e,t,r,i,n){const{history:o,modelManipulator:a}=e.modelManager,s=r[0].table,l=r[0].rowIndex,d=l+r.length-1;for(let e,r=0;e=s.rows[r];r++){if(r>=l&&r<=d)continue;const c=this.getCellIndexByColumnIndex(e,i),h=e.cells[c];h?o.addAndRedo(new $d(a,t,s.index,r,c,h.columnSpan+n)):e.gridBefore>=i?o.addAndRedo(new Hd(a,t,s.index,r,e.gridBefore+n)):o.addAndRedo(new Ud(a,t,s.index,r,e.gridAfter+n))}}}class ac{static updateTable(e,t,r){let i=(new Nr).getProperty(t.properties,t.style,qe.WholeTable,e.model.defaultTableProperties),n=(new kr).getProperty(t.properties,t.style,qe.WholeTable,e.model.defaultTableProperties);for(let o,a=0;o=t.rows[a];a++){let s=this.getRowConditionalFormatting(t.lookTypes,n,t,a);o.conditionalFormatting!==s&&e.history.addAndRedo(new kd(e.modelManipulator,r,t.index,a,s));for(let n,l=0;n=o.cells[l];l++){let o=s|this.getCellConditionalFormatting(t.lookTypes,i,t,a,l);n.conditionalFormatting!==o&&e.history.addAndRedo(new Od(e.modelManipulator,r,t.index,a,l,o))}}}static updateTableWithoutHistory(e,t){let r=(new Nr).getProperty(t.properties,t.style,qe.WholeTable,e.defaultTableProperties),i=(new kr).getProperty(t.properties,t.style,qe.WholeTable,e.defaultTableProperties);for(let e,n=0;e=t.rows[n];n++){e.conditionalFormatting=this.getRowConditionalFormatting(t.lookTypes,i,t,n);for(let i,o=0;i=e.cells[o];o++)i.conditionalFormatting=e.conditionalFormatting|ac.getCellConditionalFormatting(t.lookTypes,r,t,n,o)}}static getRowConditionalFormatting(e,t,r,i){let n=qe.WholeTable;return e&_e.ApplyFirstRow&&0===i&&(n|=qe.FirstRow),e&_e.ApplyLastRow&&i===r.rows.length-1&&(n|=qe.LastRow),e&_e.DoNotApplyRowBanding||n&qe.FirstRow||n&qe.LastRow||(e&_e.ApplyFirstRow&&i--,Math.floor(i/t)%2==0?n|=qe.OddRowBanding:n|=qe.EvenRowBanding),n}static getCellConditionalFormatting(e,t,r,i,n){let o=qe.WholeTable,a=r.rows[i];return e&_e.ApplyFirstColumn&&0===n&&(o|=qe.FirstColumn),e&_e.ApplyLastColumn&&n===a.cells.length-1&&(o|=qe.LastColumn),e&_e.ApplyFirstRow&&0===i?(e&_e.ApplyFirstColumn&&0===n&&(o|=qe.TopLeftCell),e&_e.ApplyLastColumn&&n===a.cells.length-1&&(o|=qe.TopRightCell)):e&_e.ApplyLastRow&&i===r.rows.length-1&&(e&_e.ApplyFirstColumn&&0===n&&(o|=qe.BottomLeftCell),e&_e.ApplyLastColumn&&n===a.cells.length-1&&(o|=qe.BottomRightCell)),e&_e.DoNotApplyColumnBanding||o&qe.FirstColumn||o&qe.LastColumn||(e&_e.ApplyFirstColumn&&n--,Math.floor(n/t)%2==0?o|=qe.OddColumnBanding:o|=qe.EvenColumnBanding),o}}class sc{static importTables(e,t){if(!t)return;const r={},i=e.tables;for(let n of t){const t=new Ja(Jl.convertFromJSON(n[Ns.TableProperties],e.documentModel.cache.colorModelInfoCache,e.documentModel.cache.shadingInfoCache),e.documentModel.tableStyles[n[Ns.StyleIndex]]);i.push(t),t.index=n[Ns.Index],r[t.index]=t,t.nestedLevel=n[Ns.NestedLevel],t.preferredWidth=ql.convertFromJSON(n[Ns.PreferredWidth]),t.lookTypes=n[Ns.LookTypes];const o=n[Ns.ParentCell];t.parentCell=o?sc.getParentCell(o,r):null;for(let r of n[Ns.Rows])t.rows.push(sc.importTableRow(r,e,t));ac.updateTableWithoutHistory(e.documentModel,t)}Ja.sort(i),Ja.fillTableByLevels(e)}static importTableRow(e,t,r){const i=t.documentModel.cache.tableRowPropertiesCache.getItemByJsonKey(e[hl.TableRowPropertiesIndex]),n=new Ld(r,i);n.gridBefore=e[hl.GridBefore],n.gridAfter=e[hl.GridAfter],n.widthBefore=ql.convertFromJSON(e[hl.WidthBefore]),n.widthAfter=ql.convertFromJSON(e[hl.WidthAfter]),n.height=Kl.convertFromJSON(e[hl.Height]),n.tablePropertiesException=Jl.convertFromJSON(e[hl.TablePropertiesException],t.documentModel.cache.colorModelInfoCache,t.documentModel.cache.shadingInfoCache);for(let r of e[hl.Cells])n.cells.push(sc.importTableCell(r,t,n));return n}static importTableCell(e,t,r){const i=t.documentModel.cache.tableCellPropertiesCache.getItemByJsonKey(e[al.TableCellPropertiesIndex]),n=new Rd(r,i);return n.style=null,n.columnSpan=e[al.ColumnSpan],n.preferredWidth=ql.convertFromJSON(e[al.PreferredWidth]),n.verticalMerging=e[al.VerticalMerging],n.startParagraphPosition=t.positionManager.registerPosition(e[al.StartParagraphPosition]),n.endParagrapPosition=t.positionManager.registerPosition(e[al.EndParagraphPosition]),n}static getParentCell(e,t){return t[e[Os.TableIndex]].rows[e[Os.RowIndex]].cells[e[Os.CellIndex]]}}var lc,dc,cc,hc,uc,pc,gc,mc,fc,bc,Cc,Sc,Ic,Pc,wc,yc,xc,Tc,vc,Mc,Ec,Dc,Fc,Rc,Lc,Bc,Ac,Nc,kc,Oc,_c,Uc,Hc,Vc,Wc,zc,jc=__webpack_require__(3604),Xc=__webpack_require__(8900),Gc=__webpack_require__(9210);!function(e){e[e.Text=0]="Text",e[e.Space=1]="Space",e[e.Dash=2]="Dash",e[e.TabSpace=3]="TabSpace",e[e.LineBreak=4]="LineBreak",e[e.PageBreak=5]="PageBreak",e[e.ColumnBreak=6]="ColumnBreak",e[e.SectionMark=7]="SectionMark",e[e.ParagraphMark=8]="ParagraphMark",e[e.Picture=9]="Picture",e[e.NumberingList=10]="NumberingList",e[e.FieldCodeStart=11]="FieldCodeStart",e[e.FieldCodeEnd=12]="FieldCodeEnd",e[e.FieldResultEnd=13]="FieldResultEnd",e[e.LayoutDependent=14]="LayoutDependent",e[e.NonBreakingSpace=15]="NonBreakingSpace",e[e.AnchorPicture=16]="AnchorPicture",e[e.AnchorTextBox=17]="AnchorTextBox"}(lc||(lc={}));class Kc{constructor(e,t){this.initProps=e,this.colorInfo=t}}class qc extends Va.Rectangle{constructor(e,t){super(0,0,0,0),this.characterProperties=e,this.colorInfo=t}get isDashBox(){return!1}get isSectionBreakBox(){return!1}equals(e){return super.equals(e)&&this.getType()==e.getType()&&this.characterProperties==e.characterProperties&&this.colorInfo.equals(e.colorInfo)&&this.rowOffset==e.rowOffset&&this.hyperlinkTip==e.hyperlinkTip&&this.fieldLevel==this.fieldLevel}copyFrom(e){super.copyFrom(e),this.rowOffset=e.rowOffset,e.hyperlinkTip&&(this.hyperlinkTip=e.hyperlinkTip),e.fieldLevel&&(this.fieldLevel=e.fieldLevel)}static initializeWithMeasurer(e,t,r){var i=[];for(let t of e)t.box.pushInfoForMeasure(i,r);if(t.measure(i),f.ListUtils.reverseForEach(e,(e=>e.box.popInfoForMeasure(i,r))),0!=i.length)throw new Error("In initializeWithMeasurer widthHeightInfo.length != 0"+i.length)}getEndPosition(){return this.rowOffset+this.getLength()}getTop(e){return e.baseLine-this.getAscent()-e.getSpacingBefore()}getAscent(){return this.characterProperties.fontInfo.getAscent(this.height)}getDescent(){return this.characterProperties.fontInfo.getDescent(this.height)}isVisibleForRowAlign(){return!1}isVisible(){return!1}getCharOffsetXInPixels(e,t){return t<=0?0:this.width}getLength(){return 1}calculateCharOffsetByPointX(e,t){return t/this.width>.6?1:0}splitByWidth(e,t,r){return this.width<=t||r?this:null}getCharIndex(e){return-1}splitBoxByPosition(e,t){return null}renderNoStrikeoutAndNoUnderlineIfBoxInEndRow(){return!1}renderIsWordBox(){return!1}renderGetCharacterProperties(){return new Kc(this.characterProperties,this.colorInfo)}}!function(e){e[e.BehindText=0]="BehindText",e[e.InText=1]="InText",e[e.BeforeText=2]="BeforeText"}(dc||(dc={}));class $c extends qc{constructor(e,t,r,i,n,o,a){super(e,t),this.parentCell=null,this.isApproved=!1,this.yShift=0,this.belongsToSubDocId=r,this.anchorInfo=i,this.shape=n,this.objectId=o,this.rotationInRadians=a}equals(e){return super.equals(e)&&this.anchorInfo.equals(e.anchorInfo)&&this.shape.equals(e.shape)&&this.rotationInRadians==e.rotationInRadians&&this.belongsToSubDocId==e.belongsToSubDocId&&this.objectId==e.objectId}isInText(){return this.levelType==dc.InText}get levelType(){return this.anchorInfo.levelType}copyFrom(e){super.copyFrom(e),this.belongsToSubDocId=e.belongsToSubDocId,this.rotationInRadians=e.rotationInRadians,this.anchorInfo=e.anchorInfo,this.shape=e.shape,this.objectId=e.objectId,this.isApproved=e.isApproved}getContentBounds(){const e=this.createRectangle(),t=this.shape.outlineWidth;return e.x+=t/2,e.y+=t/2,e.width-=t,e.height-=t,e}getExtendedBounds(){const e=this.createRectangle(),t=this.shape.outlineWidth;return e.x-=t/2,e.y-=t/2,e.width+=t,e.height+=t,e}setContentSize(e){const t=this.shape.outlineWidth;this.width=e.width+t,this.height=e.height+t}pushInfoForMeasure(e,t){}popInfoForMeasure(e,t){}isWhitespace(){return!0}isLineBreak(){return!1}getRotatedPolygon(){const e=this.center,t=Gc.mg.fromRectangle(this);return 0!=this.rotationInRadians?t.rotateAround(e,this.rotationInRadians,!1,!0):t}getOuterBounds(e){const t=this.getRotatedPolygon();return e?t.bounds.applyOffsetsOutside(this.anchorInfo.getDistanceMargins()):t.bounds}}!function(e){e[e.Margin=0]="Margin",e[e.Page=1]="Page",e[e.LeftMargin=2]="LeftMargin",e[e.RightMargin=3]="RightMargin",e[e.InsideMargin=4]="InsideMargin",e[e.OutsideMargin=5]="OutsideMargin"}(cc||(cc={})),function(e){e[e.Margin=0]="Margin",e[e.Page=1]="Page",e[e.TopMargin=2]="TopMargin",e[e.BottomMargin=3]="BottomMargin",e[e.InsideMargin=4]="InsideMargin",e[e.OutsideMargin=5]="OutsideMargin"}(hc||(hc={})),function(e){e[e.None=0]="None",e[e.TopAndBottom=1]="TopAndBottom",e[e.Tight=2]="Tight",e[e.Through=3]="Through",e[e.Square=4]="Square"}(uc||(uc={})),function(e){e[e.Both=0]="Both",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Largest=3]="Largest"}(pc||(pc={})),function(e){e[e.Page=0]="Page",e[e.Character=1]="Character",e[e.Column=2]="Column",e[e.Margin=3]="Margin",e[e.LeftMargin=4]="LeftMargin",e[e.RightMargin=5]="RightMargin",e[e.InsideMargin=6]="InsideMargin",e[e.OutsideMargin=7]="OutsideMargin"}(gc||(gc={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Inside=4]="Inside",e[e.Outside=5]="Outside"}(mc||(mc={})),function(e){e[e.Page=0]="Page",e[e.Line=1]="Line",e[e.Paragraph=2]="Paragraph",e[e.Margin=3]="Margin",e[e.TopMargin=4]="TopMargin",e[e.BottomMargin=5]="BottomMargin",e[e.InsideMargin=6]="InsideMargin",e[e.OutsideMargin=7]="OutsideMargin"}(fc||(fc={})),function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Center=2]="Center",e[e.Bottom=3]="Bottom",e[e.Inside=4]="Inside",e[e.Outside=5]="Outside"}(bc||(bc={})),function(e){e[e.Top=0]="Top",e[e.Both=1]="Both",e[e.Center=2]="Center",e[e.Bottom=3]="Bottom"}(Cc||(Cc={})),function(e){e[e.Bottom=1]="Bottom",e[e.Center=2]="Center",e[e.Distributed=3]="Distributed",e[e.Justified=4]="Justified",e[e.Top=5]="Top"}(Sc||(Sc={}));class Jc{constructor(){this.allowOverlap=!0,this.hidden=!1,this.layoutTableCell=!1,this.locked=!1,this.isBehindDoc=!1,this.leftDistance=188,this.rightDistance=188,this.topDistance=72,this.bottomDistance=72,this.zOrder=0,this.wrapType=uc.Square,this.wrapSide=pc.Both,this.horizontalPositionType=gc.Column,this.horizontalPositionAlignment=mc.Center,this.verticalPositionType=fc.Paragraph,this.verticalPositionAlignment=bc.None,this.offset=new Xc.Point(0,0),this.percentOffset=new Xc.Point(0,0)}get levelType(){return this.wrapType!=uc.None?dc.InText:this.isBehindDoc?dc.BehindText:dc.BeforeText}getLevelTypeForRendering(e,t){return this.wrapType!=uc.None&&(t>=yg.Word2013||!e)?dc.InText:this.isBehindDoc?dc.BehindText:dc.BeforeText}clone(){const e=new Jc;return e.allowOverlap=this.allowOverlap,e.hidden=this.hidden,e.layoutTableCell=this.layoutTableCell,e.locked=this.locked,e.isBehindDoc=this.isBehindDoc,e.leftDistance=this.leftDistance,e.rightDistance=this.rightDistance,e.topDistance=this.topDistance,e.bottomDistance=this.bottomDistance,e.zOrder=this.zOrder,e.wrapType=this.wrapType,e.wrapSide=this.wrapSide,e.horizontalPositionType=this.horizontalPositionType,e.horizontalPositionAlignment=this.horizontalPositionAlignment,e.verticalPositionType=this.verticalPositionType,e.verticalPositionAlignment=this.verticalPositionAlignment,e.offset=this.offset.clone(),e.percentOffset=this.percentOffset.clone(),e}equals(e){return!!e&&(this.allowOverlap==e.allowOverlap&&this.hidden==e.hidden&&this.layoutTableCell==e.layoutTableCell&&this.locked==e.locked&&this.isBehindDoc==e.isBehindDoc&&this.leftDistance==e.leftDistance&&this.rightDistance==e.rightDistance&&this.topDistance==e.topDistance&&this.bottomDistance==e.bottomDistance&&this.zOrder==e.zOrder&&this.wrapType==e.wrapType&&this.wrapSide==e.wrapSide&&this.horizontalPositionType==e.horizontalPositionType&&this.horizontalPositionAlignment==e.horizontalPositionAlignment&&this.verticalPositionType==e.verticalPositionType&&this.verticalPositionAlignment==e.verticalPositionAlignment&&this.offset.equals(e.offset)&&this.percentOffset.equals(e.percentOffset))}isUsedHorizontalAlignment(){if(!this.horizontalPositionAlignment)return!1;switch(this.horizontalPositionAlignment){case mc.Left:case mc.Center:case mc.Right:return!0}return!1}isUsedHorizontalBookLayout(){if(!this.horizontalPositionAlignment)return!1;switch(this.horizontalPositionAlignment){case mc.Outside:case mc.Inside:return!0}return!1}isUsedHorizontalAbsolutePosition(){return!this.horizontalPositionAlignment&&!this.isUsedHorizontalRelativePosition()}isUsedHorizontalRelativePosition(){return this.percentOffset.x>0}isUsedVerticalAlignment(){return!!this.verticalPositionAlignment}isUsedVerticalAbsolutePosition(){return!this.isUsedVerticalAlignment()&&!this.isUsedVerticalRelativePosition()}isUsedVerticalRelativePosition(){return this.percentOffset.y>0}getRelativeOffsetX(e){return e*this.percentOffset.x/Jc.RELATIVE_COEFF}getRelativeOffsetY(e){return e*this.percentOffset.y/Jc.RELATIVE_COEFF}getDistanceMargins(){return new jc.m(this.leftDistance,this.rightDistance,this.topDistance,this.bottomDistance).applyConverter(g.u.twipsToPixels)}}Jc.RELATIVE_COEFF=1e5;class Yc{constructor(e,t){this.lockAspectRatio=e,this.rotation=t}clone(){throw new Error(R.D.NotImplemented)}copyFrom(e){this.lockAspectRatio=e.lockAspectRatio,this.rotation=e.rotation}}class Qc extends Yc{get originalSize(){return this.cacheInfo.size}constructor(e,t,r,i){super(e,t),this.cacheInfo=r,this.scale=i}get actualSize(){return so.Size.initByCommonAction((e=>e(this.cacheInfo.size)*e(this.scale)/100))}clone(){return new Qc(this.lockAspectRatio,this.rotation,this.cacheInfo,this.scale.clone())}cloneToNewSubDocument(e){return new Qc(this.lockAspectRatio,this.rotation,e.documentModel.cache.imageCache.getPictureData(this.cacheInfo.currId),this.scale.clone())}copyFrom(e){super.copyFrom(e),this.cacheInfo=e.cacheInfo,this.scale=e.scale.clone()}}class Zc extends Yc{constructor(e,t,r){super(e,t),this.absoluteSize=r}get actualSize(){return this.absoluteSize.clone()}clone(){return new Zc(this.lockAspectRatio,this.rotation,this.absoluteSize)}copyFrom(e){super.copyFrom(e),this.absoluteSize=e.absoluteSize.clone()}}class eh extends Zc{constructor(e,t,r,i,n,o,a,s){super(e,t,r),this.flags=new pr.Flag,this.relativeSize=i,this.relativeWidthType=n,this.relativeHeightType=o,this.flags.set(a?Ic.UseAbsoluteSizeWidth:Ic.UseRelativeSizeWidth,!0),this.flags.set(s?Ic.UseAbsoluteSizeHeight:Ic.UseRelativeSizeHeight,!0)}useAbsoluteWidth(){return this.flags.get(Ic.UseAbsoluteSizeWidth)}useAbsoluteHeight(){return this.flags.get(Ic.UseAbsoluteSizeHeight)}setUseAbsoluteWidth(e){this.flags.set(Ic.UseAbsoluteSizeWidth,e),this.flags.set(Ic.UseRelativeSizeWidth,!e)}setUseAbsoluteHeight(e){this.flags.set(Ic.UseAbsoluteSizeHeight,e),this.flags.set(Ic.UseRelativeSizeHeight,!e)}get actualSize(){if(this.flags.get(Ic.UseRelativeSizeWidth))throw new Error(R.D.InternalException);if(this.flags.get(Ic.UseRelativeSizeHeight))throw new Error(R.D.InternalException);return this.absoluteSize.clone()}getActualRelativeHeight(e){return this.relativeSize.height*this.getAbsHeight(e)/eh.RELATIVE_COEFF}getActualRelativeWidth(e){return this.relativeSize.width*this.getAbsWidth(e)/eh.RELATIVE_COEFF}getAbsWidth(e){switch(this.relativeWidthType){case cc.Margin:return e.pageWidth-e.marginLeft-e.marginRight;case cc.OutsideMargin:case cc.LeftMargin:return e.marginLeft;case cc.InsideMargin:case cc.RightMargin:return e.marginRight;case cc.Page:return e.pageWidth;default:throw new Error(R.D.InternalException)}}getAbsHeight(e){switch(this.relativeHeightType){case hc.Margin:return e.pageHeight-e.marginTop-e.marginBottom;case hc.InsideMargin:case hc.TopMargin:return e.marginTop;case hc.OutsideMargin:case hc.BottomMargin:return e.marginBottom;case hc.Page:return e.pageHeight;default:throw new Error(R.D.InternalException)}}clone(){return new eh(this.lockAspectRatio,this.rotation,this.absoluteSize.clone(),this.relativeSize.clone(),this.relativeWidthType,this.relativeHeightType,this.flags.get(Ic.UseAbsoluteSizeWidth),this.flags.get(Ic.UseAbsoluteSizeHeight))}copyFrom(e){super.copyFrom(e),this.relativeSize=e.relativeSize.clone(),this.relativeHeightType=e.relativeHeightType,this.relativeWidthType=e.relativeWidthType,this.flags=e.flags}}eh.RELATIVE_COEFF=1e5,function(e){e[e.UseAbsoluteSizeWidth=2]="UseAbsoluteSizeWidth",e[e.UseAbsoluteSizeHeight=4]="UseAbsoluteSizeHeight",e[e.UseRelativeSizeWidth=8]="UseRelativeSizeWidth",e[e.UseRelativeSizeHeight=16]="UseRelativeSizeHeight"}(Ic||(Ic={}));class th{constructor(e=y.NO_COLOR,t=y.NO_COLOR,r=0){this.fillColor=y.NO_COLOR,this.outlineColor=y.NO_COLOR,this.outlineWidth=0,this.fillColor=e,this.outlineColor=t,this.outlineWidth=r}clone(){return new th(this.fillColor,this.outlineColor,this.outlineWidth)}copyFrom(e){this.fillColor=e.fillColor,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}applyConverter(e){return this.outlineWidth=e(this.outlineWidth),this}equals(e){return!!e&&(this.fillColor==e.fillColor&&this.outlineColor==e.outlineColor&&this.outlineWidth==e.outlineWidth)}}class rh{copyFrom(e){this.id=e.id,this.name=e.name,this.title=e.title,this.description=e.description}clone(){const e=new rh;return e.copyFrom(this),e}}class ih{get cacheInfo(){return this.size.cacheInfo}constructor(e,t,r,i){this.size=e,this.shape=t,this.containerProperties=r,this.nonVisualDrawingProperties=i}}class nh extends ih{constructor(e,t,r,i,n){super(e,t,i,n),this.publicAPIID=r}clone(){return new nh(this.size.clone(),this.shape.clone(),this.publicAPIID,this.containerProperties.clone(),this.nonVisualDrawingProperties.clone())}cloneToNewSubDocument(e){return new nh(this.size.cloneToNewSubDocument(e),this.shape.clone(),this.publicAPIID,this.containerProperties.clone(),this.nonVisualDrawingProperties.clone())}static defaultInfo(e,t=new so.Size(100,100)){return new nh(new Qc(!0,0,e,t),new th,-1,new rh,new rh)}}class oh extends ih{constructor(e,t,r,i,n){super(e,t,i,n),this.anchorInfo=r}clone(){return new oh(this.size.clone(),this.shape.clone(),this.anchorInfo.clone(),this.containerProperties.clone(),this.nonVisualDrawingProperties.clone())}cloneToNewSubDocument(e){return new oh(this.size.cloneToNewSubDocument(e),this.shape.clone(),this.anchorInfo.clone(),new rh,new rh)}static defaultInfo(e,t=new so.Size(100,100)){return new oh(new Qc(!0,0,e,t),new th,new Jc,new rh,new rh)}}class ah extends Fl{get anchorInfo(){return this.info.anchorInfo}set anchorInfo(e){this.info.anchorInfo=e}constructor(e,t,r,i,n){super(e,t,r,i),this.anchoredObjectID=n<0?El.anchoredObjectIdCounter++:n}getType(){return cs.AnchoredPictureRun}clone(){return new ah(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle),this.info.clone(),-1)}cloneToNewSubDocument(e){return new ah(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)),this.info.cloneToNewSubDocument(e),-1)}}class sh extends Rl{constructor(e,t,r,i,n,o,a,s,l,d=new rh){super(e,t,r,i,n,l,d),this.size=o,this.anchorInfo=a,this.anchoredObjectID=s<0?El.anchoredObjectIdCounter++:s}getType(){return cs.AnchoredTextBoxRun}clone(){return new sh(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle),this.shape.clone(),this.subDocId,this.size.clone(),this.anchorInfo.clone(),-1,this.textBoxProperties.clone(),this.containerProperties.clone())}cloneToNewSubDocument(e){return new sh(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)),this.shape.clone(),this.subDocId,this.size.clone(),this.anchorInfo.clone(),-1,this.textBoxProperties.clone())}copyFrom(e){super.copyFrom(e),this.anchorInfo=e.anchorInfo.clone(),this.size=e.size.clone()}}class lh extends Fl{get publicAPIId(){return this.info.publicAPIID}constructor(e,t,r,i){super(e,t,r,i),this.info.publicAPIID=this.info.publicAPIID>=0?this.info.publicAPIID:this.getNextPublicAPIId()}getType(){return cs.InlinePictureRun}clone(){const e=this.info.clone();return e.publicAPIID=-1,new lh(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle),e)}cloneToNewSubDocument(e){const t=this.info.cloneToNewSubDocument(e);return new lh(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)),t)}getNextPublicAPIId(){return lh.nextPublicAPIId++}}lh.nextPublicAPIId=0;class dh extends Rl{constructor(e,t,r,i,n,o,a,s=new rh){super(e,t,r,i,n,a,s),this.size=o}getType(){return cs.InlineTextBoxRun}clone(){return new dh(this.startOffset,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle),this.shape.clone(),this.subDocId,this.size.clone(),this.textBoxProperties.clone())}cloneToNewSubDocument(e){return new dh(this.startOffset,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)),this.shape.clone(),this.subDocId,this.size.clone(),this.textBoxProperties.clone())}copyFrom(e){super.copyFrom(e),this.size=e.size.clone()}}class ch extends El{constructor(e,t,r,i){super(e,r,i),this.length=t}getLength(){return this.length}setLength(e){this.length=e}getType(){return cs.TextRun}incLength(e){this.length+=e}clone(){return new ch(this.startOffset,this.length,this.paragraph,new pn(this.maskedCharacterProperties,this.characterStyle))}cloneToNewSubDocument(e){return new ch(this.startOffset,this.length,e.getParagraphByPosition(this.paragraph.startLogPosition.value),new pn(e.documentModel.cache.maskedCharacterPropertiesCache.getItem(this.maskedCharacterProperties),e.documentModel.stylesManager.getCharacterStyleByName(this.characterStyle.styleName)))}copyFrom(e){super.copyFrom(e),this.length=e.length}}!function(e){e[e.FillColor=0]="FillColor",e[e.OutlineColor=1]="OutlineColor",e[e.OutlineWidth=2]="OutlineWidth"}(Pc||(Pc={})),function(e){e[e.LockAspectRatio=0]="LockAspectRatio",e[e.Rotation=1]="Rotation",e[e.MAX_VALUE=2]="MAX_VALUE"}(wc||(wc={})),function(e){e[e.Scale=2]="Scale"}(yc||(yc={})),function(e){e[e.AbsoluteSize=2]="AbsoluteSize"}(xc||(xc={})),function(e){e[e.AbsoluteSize=2]="AbsoluteSize",e[e.RelativeSize=3]="RelativeSize",e[e.RelativeSizeType=4]="RelativeSizeType",e[e.UseAbsoluteSize=5]="UseAbsoluteSize"}(Tc||(Tc={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Bottom=3]="Bottom"}(vc||(vc={})),function(e){e[e.AllowOverlap=0]="AllowOverlap",e[e.Hidden=1]="Hidden",e[e.LayoutTableCell=2]="LayoutTableCell",e[e.Locked=3]="Locked",e[e.IsBehindDoc=4]="IsBehindDoc",e[e.LeftDistance=5]="LeftDistance",e[e.RightDistance=6]="RightDistance",e[e.TopDistance=7]="TopDistance",e[e.BottomDistance=8]="BottomDistance",e[e.ZOrder=9]="ZOrder",e[e.WrapType=10]="WrapType",e[e.WrapSide=11]="WrapSide",e[e.HorizontalPositionType=12]="HorizontalPositionType",e[e.HorizontalPositionAlignment=13]="HorizontalPositionAlignment",e[e.VerticalPositionType=14]="VerticalPositionType",e[e.VerticalPositionAlignment=15]="VerticalPositionAlignment",e[e.OffsetX=16]="OffsetX",e[e.OffsetY=17]="OffsetY",e[e.PercentOffsetX=18]="PercentOffsetX",e[e.PercentOffsetY=19]="PercentOffsetY"}(Mc||(Mc={})),function(e){e[e.Position=0]="Position",e[e.CacheInfo=1]="CacheInfo",e[e.ScaleSize=2]="ScaleSize",e[e.DrawingObjectProperties=3]="DrawingObjectProperties"}(Ec||(Ec={})),function(e){e[e.TmpId=0]="TmpId",e[e.ActualId=1]="ActualId",e[e.Url=2]="Url",e[e.Base64=3]="Base64",e[e.Size=4]="Size"}(Dc||(Dc={})),function(e){e[e.Scales=0]="Scales",e[e.LockAspectRatio=1]="LockAspectRatio"}(Fc||(Fc={})),function(e){e[e.ResizeShapeToFitText=0]="ResizeShapeToFitText",e[e.Upright=1]="Upright",e[e.VerticalAlignment=2]="VerticalAlignment",e[e.WrapText=3]="WrapText",e[e.LeftMargin=4]="LeftMargin",e[e.RightMargin=5]="RightMargin",e[e.TopMargin=6]="TopMargin",e[e.BottomMargin=7]="BottomMargin"}(Rc||(Rc={})),function(e){e[e.Position=0]="Position",e[e.ImageCacheId=1]="ImageCacheId",e[e.Size=2]="Size",e[e.AnchorInfo=3]="AnchorInfo",e[e.SubDocId=4]="SubDocId",e[e.DrawingObjectProperties=5]="DrawingObjectProperties"}(Lc||(Lc={})),function(e){e[e.Name=0]="Name",e[e.Title=1]="Title",e[e.Description=2]="Description",e[e.Id=3]="Id",e[e.Hidden=4]="Hidden",e[e.ClickHyperlink=5]="ClickHyperlink",e[e.HoverHyperlink=6]="HoverHyperlink"}(Bc||(Bc={}));class hh{static convertFromJSON(e){const t=new th;return t.fillColor=e[Pc.FillColor],t.outlineColor=e[Pc.OutlineColor],t.outlineWidth=e[Pc.OutlineWidth],t}static convertToJSON(e){const t={};return t[Pc.FillColor]=e.fillColor,t[Pc.OutlineColor]=e.outlineColor,t[Pc.OutlineWidth]=e.outlineWidth,t}}class uh{static convertFromJSON(e){const t=new Jc;return t.allowOverlap=!!e[Mc.AllowOverlap],t.hidden=!!e[Mc.Hidden],t.layoutTableCell=!!e[Mc.LayoutTableCell],t.locked=!!e[Mc.Locked],t.isBehindDoc=!!e[Mc.IsBehindDoc],t.leftDistance=e[Mc.LeftDistance],t.rightDistance=e[Mc.RightDistance],t.topDistance=e[Mc.TopDistance],t.bottomDistance=e[Mc.BottomDistance],t.zOrder=e[Mc.ZOrder],t.wrapType=e[Mc.WrapType],t.wrapSide=e[Mc.WrapSide],t.horizontalPositionType=e[Mc.HorizontalPositionType],t.horizontalPositionAlignment=e[Mc.HorizontalPositionAlignment],t.verticalPositionType=e[Mc.VerticalPositionType],t.verticalPositionAlignment=e[Mc.VerticalPositionAlignment],t.offset=new Xc.Point(e[Mc.OffsetX],e[Mc.OffsetY]),t.percentOffset=new Xc.Point(e[Mc.PercentOffsetX],e[Mc.PercentOffsetY]),t}static convertToJSON(e){const t={};return t[Mc.AllowOverlap]=(0,S.boolToInt)(e.allowOverlap),t[Mc.Hidden]=(0,S.boolToInt)(e.hidden),t[Mc.LayoutTableCell]=(0,S.boolToInt)(e.layoutTableCell),t[Mc.Locked]=(0,S.boolToInt)(e.locked),t[Mc.IsBehindDoc]=(0,S.boolToInt)(e.isBehindDoc),t[Mc.LeftDistance]=e.leftDistance,t[Mc.RightDistance]=e.rightDistance,t[Mc.TopDistance]=e.topDistance,t[Mc.BottomDistance]=e.bottomDistance,t[Mc.ZOrder]=e.zOrder,t[Mc.WrapType]=e.wrapType,t[Mc.WrapSide]=e.wrapSide,t[Mc.HorizontalPositionType]=e.horizontalPositionType,t[Mc.HorizontalPositionAlignment]=e.horizontalPositionAlignment,t[Mc.VerticalPositionType]=e.verticalPositionType,t[Mc.VerticalPositionAlignment]=e.verticalPositionAlignment,t[Mc.OffsetX]=e.offset.x,t[Mc.OffsetY]=e.offset.y,t[Mc.PercentOffsetX]=e.percentOffset.x,t[Mc.PercentOffsetY]=e.percentOffset.y,t}}class ph{constructor(e){this.resizeShapeToFitText=!0,this.upright=!1,this.verticalAlignment=Sc.Top,this.wrapText=!0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.bottomMargin=0,e&&(this.leftMargin=e.left,this.rightMargin=e.right,this.topMargin=e.top,this.bottomMargin=e.bottom)}clone(){const e=new ph;return e.resizeShapeToFitText=this.resizeShapeToFitText,e.upright=this.upright,e.verticalAlignment=this.verticalAlignment,e.wrapText=this.wrapText,e.leftMargin=this.leftMargin,e.rightMargin=this.rightMargin,e.topMargin=this.topMargin,e.bottomMargin=this.bottomMargin,e}equals(e){return!!e&&(e.resizeShapeToFitText===this.resizeShapeToFitText&&e.upright===this.upright&&e.verticalAlignment===this.verticalAlignment&&e.wrapText===this.wrapText&&e.leftMargin===this.leftMargin&&e.rightMargin===this.rightMargin&&e.topMargin===this.topMargin&&e.bottomMargin===this.bottomMargin)}getContentMargins(){return new jc.m(this.leftMargin,this.rightMargin,this.topMargin,this.bottomMargin)}setMarginsToAnotherMeasuringSystem(e){return this.leftMargin=e(this.leftMargin),this.rightMargin=e(this.rightMargin),this.topMargin=e(this.topMargin),this.bottomMargin=e(this.bottomMargin),this}}class gh{static convertFromJSON(e){const t=new ph;return t.resizeShapeToFitText=!!e[Rc.ResizeShapeToFitText],t.upright=!!e[Rc.Upright],t.verticalAlignment=e[Rc.VerticalAlignment],t.wrapText=!!e[Rc.WrapText],t.leftMargin=e[Rc.LeftMargin],t.rightMargin=e[Rc.RightMargin],t.topMargin=e[Rc.TopMargin],t.bottomMargin=e[Rc.BottomMargin],t}static convertToJSON(e){const t={};return t[Rc.ResizeShapeToFitText]=(0,S.boolToInt)(e.resizeShapeToFitText),t[Rc.Upright]=(0,S.boolToInt)(e.upright),t[Rc.VerticalAlignment]=e.verticalAlignment,t[Rc.WrapText]=(0,S.boolToInt)(e.wrapText),t[Rc.LeftMargin]=e.leftMargin,t[Rc.RightMargin]=e.rightMargin,t[Rc.TopMargin]=e.topMargin,t[Rc.BottomMargin]=e.bottomMargin,t}}class mh{constructor(e){this.indices={},this.section=e,this.setObjectIndex(Ws.Even,mh.INVALID_INDEX),this.setObjectIndex(Ws.Odd,mh.INVALID_INDEX),this.setObjectIndex(Ws.First,mh.INVALID_INDEX)}getObject(e){let t=this.getObjectIndex(e);return this.getObjectsCache()[t]}getObjectIndex(e){return this.indices[e]}setObjectIndex(e,t){this.indices[e]=t}getActualObject(e,t){let r=mh.getActualObjectType(this.section,e,t),i=this.getObjectIndex(r);return this.getObjectsCache()[i]}copyFrom(e){this.indices={},this.setObjectIndex(Ws.Even,e.getObjectIndex(Ws.Even)),this.setObjectIndex(Ws.Odd,e.getObjectIndex(Ws.Odd)),this.setObjectIndex(Ws.First,e.getObjectIndex(Ws.First))}isLinkedToPrevious(e){const t=this.section.documentModel.getPreviousSection(this.section);return t&&this.getContainer(t).getObjectIndex(e)===this.getObjectIndex(e)}canLinkToPrevious(){return!!this.section.documentModel.getPreviousSection(this.section)}static getActualObjectType(e,t,r){return t&&e.sectionProperties.differentFirstPage?Ws.First:r&&e.documentModel.differentOddAndEvenPages?Ws.Even:Ws.Odd}static isLinkedToPrevious(e,t){return e.headers.isLinkedToPrevious(t)||e.footers.isLinkedToPrevious(t)}}mh.INVALID_INDEX=-1;class fh extends mh{getContainer(e){return e.headers}getObjectsCache(){return this.section.documentModel.headers}clone(){let e=new fh(this.section);return e.copyFrom(this),e}}class bh extends mh{getContainer(e){return e.footers}getObjectsCache(){return this.section.documentModel.footers}clone(){let e=new bh(this.section);return e.copyFrom(this),e}}class Ch{constructor(e,t,r,i){this.documentModel=e,this.startLogPosition=t,this.length=r,this.sectionProperties=i,this.headers=new fh(this),this.footers=new bh(this)}getLength(){return this.length}setLength(e,t){e.isMain()&&(this.length=t)}getEndPosition(){return this.startLogPosition.value+this.length}static getPageSectionIndex(e,t){const r=e.getPosition();return C.SearchUtils.normedInterpolationIndexOf(t,(e=>e.startLogPosition.value),r)}get interval(){return new on.FixedInterval(this.startLogPosition.value,this.length)}cloneToNewModel(e){return new Ch(e,e.mainSubDocument.positionManager.registerPosition(this.startLogPosition.value),this.length,this.sectionProperties.clone())}}!function(e){e[e.Copy=0]="Copy",e[e.CreateNew=1]="CreateNew",e[e.Cut=2]="Cut",e[e.Drag=3]="Drag",e[e.Drop=4]="Drop",e[e.FontSource=5]="FontSource",e[e.ForeColorSource=6]="ForeColorSource",e[e.MaxZoomFactor=7]="MaxZoomFactor",e[e.MinZoomFactor=8]="MinZoomFactor",e[e.OfficeScrolling=9]="OfficeScrolling",e[e.Open=10]="Open",e[e.OvertypeAllowed=11]="OvertypeAllowed",e[e.PageBreakInsertMode=12]="PageBreakInsertMode",e[e.Paste=13]="Paste",e[e.PasteLineBreakSubstitution=14]="PasteLineBreakSubstitution",e[e.PasteSingleCellAsText=15]="PasteSingleCellAsText",e[e.Printing=16]="Printing",e[e.Save=17]="Save",e[e.SaveAs=18]="SaveAs",e[e.ShowPopupMenu=19]="ShowPopupMenu",e[e.TabMarker=20]="TabMarker",e[e.Touch=21]="Touch",e[e.UseFontSubstitution=22]="UseFontSubstitution",e[e.Zooming=23]="Zooming",e[e.DocumentPropertiesAutoUpdate=24]="DocumentPropertiesAutoUpdate",e[e.KeepTextHighlightingOnClearFormatting=25]="KeepTextHighlightingOnClearFormatting",e[e.Download=26]="Download",e[e.AcceptsTab=27]="AcceptsTab",e[e.FullScreen=28]="FullScreen",e[e.RaiseClientEventsOnModificationsViaAPI=29]="RaiseClientEventsOnModificationsViaAPI"}(Ac||(Ac={})),function(e){e[e.Copy=0]="Copy",e[e.CreateNew=1]="CreateNew",e[e.Cut=2]="Cut",e[e.Drag=3]="Drag",e[e.Drop=4]="Drop",e[e.Open=5]="Open",e[e.Paste=6]="Paste",e[e.Printing=7]="Printing",e[e.Save=8]="Save",e[e.SaveAs=9]="SaveAs",e[e.FullScreen=10]="FullScreen",e[e.Bookmarks=11]="Bookmarks",e[e.CharacterFormatting=12]="CharacterFormatting",e[e.CharacterStyle=13]="CharacterStyle",e[e.Fields=14]="Fields",e[e.Hyperlinks=15]="Hyperlinks",e[e.InlinePictures=16]="InlinePictures",e[e.ParagraphFormatting=17]="ParagraphFormatting",e[e.Paragraphs=18]="Paragraphs",e[e.ParagraphStyle=19]="ParagraphStyle",e[e.ParagraphTabs=20]="ParagraphTabs",e[e.Sections=21]="Sections",e[e.TabSymbol=22]="TabSymbol",e[e.Undo=23]="Undo",e[e.NumberingBulleted=24]="NumberingBulleted",e[e.NumberingMultiLevel=25]="NumberingMultiLevel",e[e.NumberingSimple=26]="NumberingSimple",e[e.HeadersFooters=27]="HeadersFooters",e[e.Tables=28]="Tables",e[e.TableStyle=29]="TableStyle",e[e.TabMarker=30]="TabMarker",e[e.PageBreakInsertMode=31]="PageBreakInsertMode",e[e.AcceptsTab=32]="AcceptsTab",e[e.Download=33]="Download",e[e.RaiseClientEventsOnModificationsViaAPI=34]="RaiseClientEventsOnModificationsViaAPI"}(Nc||(Nc={})),function(e){e[e.StartPos=0]="StartPos",e[e.Length=1]="Length",e[e.Properties=2]="Properties",e[e.Headers=3]="Headers",e[e.Footers=4]="Footers"}(kc||(kc={})),function(e){e[e.Width=0]="Width",e[e.Space=1]="Space"}(Oc||(Oc={})),function(e){e[e.SectionIndex=0]="SectionIndex",e[e.GetPropertiesFromNext=1]="GetPropertiesFromNext"}(_c||(_c={})),function(e){e[e.Position=0]="Position",e[e.SectionProperties=1]="SectionProperties"}(Uc||(Uc={})),function(e){e[e.MarginLeft=0]="MarginLeft",e[e.MarginTop=1]="MarginTop",e[e.MarginRight=2]="MarginRight",e[e.MarginBottom=3]="MarginBottom",e[e.ColumnCount=4]="ColumnCount",e[e.Space=5]="Space",e[e.ColumnsInfo=6]="ColumnsInfo",e[e.PageWidth=7]="PageWidth",e[e.PageHeight=8]="PageHeight",e[e.StartType=9]="StartType",e[e.Landscape=10]="Landscape",e[e.EqualWidthColumns=11]="EqualWidthColumns",e[e.DifferentFirstPage=12]="DifferentFirstPage",e[e.HeaderOffset=13]="HeaderOffset",e[e.FooterOffset=14]="FooterOffset",e[e.PaperKind=15]="PaperKind",e[e.FirstPageNumber=16]="FirstPageNumber",e[e.ContinueNumbering=17]="ContinueNumbering"}(Hc||(Hc={}));class Sh{constructor(e,t){this.width=0,this.space=0,this.width=e,this.space=t}equals(e){return!!e&&(this.width==e.width&&this.space==e.space)}copyFrom(e){this.width=e.width,this.space=e.space}clone(){return new Sh(this.width,this.space)}applyConverter(e){return this.width=e(this.width),this.space=e(this.space),this}static equalsColumnsInfoBinary(e,t){return e&&t&&(e===t||e.length==t.length&&f.ListUtils.allOf2(e,t,((e,t)=>e.equals(t))))}}!function(e){e[e.Custom=0]="Custom",e[e.Letter=1]="Letter",e[e.LetterSmall=2]="LetterSmall",e[e.Tabloid=3]="Tabloid",e[e.Ledger=4]="Ledger",e[e.Legal=5]="Legal",e[e.Statement=6]="Statement",e[e.Executive=7]="Executive",e[e.A3=8]="A3",e[e.A4=9]="A4",e[e.A4Small=10]="A4Small",e[e.A5=11]="A5",e[e.B4=12]="B4",e[e.B5=13]="B5",e[e.Folio=14]="Folio",e[e.Quarto=15]="Quarto",e[e.Standard10x14=16]="Standard10x14",e[e.Standard11x17=17]="Standard11x17",e[e.Note=18]="Note",e[e.Number9Envelope=19]="Number9Envelope",e[e.Number10Envelope=20]="Number10Envelope",e[e.Number11Envelope=21]="Number11Envelope",e[e.Number12Envelope=22]="Number12Envelope",e[e.Number14Envelope=23]="Number14Envelope",e[e.CSheet=24]="CSheet",e[e.DSheet=25]="DSheet",e[e.ESheet=26]="ESheet",e[e.DLEnvelope=27]="DLEnvelope",e[e.C5Envelope=28]="C5Envelope",e[e.C3Envelope=29]="C3Envelope",e[e.C4Envelope=30]="C4Envelope",e[e.C6Envelope=31]="C6Envelope",e[e.C65Envelope=32]="C65Envelope",e[e.B4Envelope=33]="B4Envelope",e[e.B5Envelope=34]="B5Envelope",e[e.B6Envelope=35]="B6Envelope",e[e.ItalyEnvelope=36]="ItalyEnvelope",e[e.MonarchEnvelope=37]="MonarchEnvelope",e[e.PersonalEnvelope=38]="PersonalEnvelope",e[e.USStandardFanfold=39]="USStandardFanfold",e[e.GermanStandardFanfold=40]="GermanStandardFanfold",e[e.GermanLegalFanfold=41]="GermanLegalFanfold",e[e.IsoB4=42]="IsoB4",e[e.JapanesePostcard=43]="JapanesePostcard",e[e.Standard9x11=44]="Standard9x11",e[e.Standard10x11=45]="Standard10x11",e[e.Standard15x11=46]="Standard15x11",e[e.InviteEnvelope=47]="InviteEnvelope",e[e.LetterExtra=50]="LetterExtra",e[e.LegalExtra=51]="LegalExtra",e[e.TabloidExtra=52]="TabloidExtra",e[e.A4Extra=53]="A4Extra",e[e.LetterTransverse=54]="LetterTransverse",e[e.A4Transverse=55]="A4Transverse",e[e.LetterExtraTransverse=56]="LetterExtraTransverse",e[e.APlus=57]="APlus",e[e.BPlus=58]="BPlus",e[e.LetterPlus=59]="LetterPlus",e[e.A4Plus=60]="A4Plus",e[e.A5Transverse=61]="A5Transverse",e[e.B5Transverse=62]="B5Transverse",e[e.A3Extra=63]="A3Extra",e[e.A5Extra=64]="A5Extra",e[e.B5Extra=65]="B5Extra",e[e.A2=66]="A2",e[e.A3Transverse=67]="A3Transverse",e[e.A3ExtraTransverse=68]="A3ExtraTransverse",e[e.JapaneseDoublePostcard=69]="JapaneseDoublePostcard",e[e.A6=70]="A6",e[e.JapaneseEnvelopeKakuNumber2=71]="JapaneseEnvelopeKakuNumber2",e[e.JapaneseEnvelopeKakuNumber3=72]="JapaneseEnvelopeKakuNumber3",e[e.JapaneseEnvelopeChouNumber3=73]="JapaneseEnvelopeChouNumber3",e[e.JapaneseEnvelopeChouNumber4=74]="JapaneseEnvelopeChouNumber4",e[e.LetterRotated=75]="LetterRotated",e[e.A3Rotated=76]="A3Rotated",e[e.A4Rotated=77]="A4Rotated",e[e.A5Rotated=78]="A5Rotated",e[e.B4JisRotated=79]="B4JisRotated",e[e.B5JisRotated=80]="B5JisRotated",e[e.JapanesePostcardRotated=81]="JapanesePostcardRotated",e[e.JapaneseDoublePostcardRotated=82]="JapaneseDoublePostcardRotated",e[e.A6Rotated=83]="A6Rotated",e[e.JapaneseEnvelopeKakuNumber2Rotated=84]="JapaneseEnvelopeKakuNumber2Rotated",e[e.JapaneseEnvelopeKakuNumber3Rotated=85]="JapaneseEnvelopeKakuNumber3Rotated",e[e.JapaneseEnvelopeChouNumber3Rotated=86]="JapaneseEnvelopeChouNumber3Rotated",e[e.JapaneseEnvelopeChouNumber4Rotated=87]="JapaneseEnvelopeChouNumber4Rotated",e[e.B6Jis=88]="B6Jis",e[e.B6JisRotated=89]="B6JisRotated",e[e.Standard12x11=90]="Standard12x11",e[e.JapaneseEnvelopeYouNumber4=91]="JapaneseEnvelopeYouNumber4",e[e.JapaneseEnvelopeYouNumber4Rotated=92]="JapaneseEnvelopeYouNumber4Rotated",e[e.Prc16K=93]="Prc16K",e[e.Prc32K=94]="Prc32K",e[e.Prc32KBig=95]="Prc32KBig",e[e.PrcEnvelopeNumber1=96]="PrcEnvelopeNumber1",e[e.PrcEnvelopeNumber2=97]="PrcEnvelopeNumber2",e[e.PrcEnvelopeNumber3=98]="PrcEnvelopeNumber3",e[e.PrcEnvelopeNumber4=99]="PrcEnvelopeNumber4",e[e.PrcEnvelopeNumber5=100]="PrcEnvelopeNumber5",e[e.PrcEnvelopeNumber6=101]="PrcEnvelopeNumber6",e[e.PrcEnvelopeNumber7=102]="PrcEnvelopeNumber7",e[e.PrcEnvelopeNumber8=103]="PrcEnvelopeNumber8",e[e.PrcEnvelopeNumber9=104]="PrcEnvelopeNumber9",e[e.PrcEnvelopeNumber10=105]="PrcEnvelopeNumber10",e[e.Prc16KRotated=106]="Prc16KRotated",e[e.Prc32KRotated=107]="Prc32KRotated",e[e.Prc32KBigRotated=108]="Prc32KBigRotated",e[e.PrcEnvelopeNumber1Rotated=109]="PrcEnvelopeNumber1Rotated",e[e.PrcEnvelopeNumber2Rotated=110]="PrcEnvelopeNumber2Rotated",e[e.PrcEnvelopeNumber3Rotated=111]="PrcEnvelopeNumber3Rotated",e[e.PrcEnvelopeNumber4Rotated=112]="PrcEnvelopeNumber4Rotated",e[e.PrcEnvelopeNumber5Rotated=113]="PrcEnvelopeNumber5Rotated",e[e.PrcEnvelopeNumber6Rotated=114]="PrcEnvelopeNumber6Rotated",e[e.PrcEnvelopeNumber7Rotated=115]="PrcEnvelopeNumber7Rotated",e[e.PrcEnvelopeNumber8Rotated=116]="PrcEnvelopeNumber8Rotated",e[e.PrcEnvelopeNumber9Rotated=117]="PrcEnvelopeNumber9Rotated",e[e.PrcEnvelopeNumber10Rotated=118]="PrcEnvelopeNumber10Rotated"}(Vc||(Vc={}));class Ih{static calculatePaperSize(e){var t=Ih.paperSizeTable[e];return t||Ih.paperSizeTable[Vc.Letter]}static calculatePaperKind(e,t,r=0,i=t){if(0==e.width||0==e.height)return i;for(const t in Ih.paperSizeTable){if(!Object.prototype.hasOwnProperty.call(Ih.paperSizeTable,t))continue;const i=Ih.paperSizeTable[t];if(Math.abs(e.width-i.width)<=r&&Math.abs(e.height-i.height)<=r)return parseInt(t)}return t}}Ih.paperSizeTable={[Vc.Letter]:new so.Size(12240,15840),[Vc.LetterSmall]:new so.Size(12240,15840),[Vc.Tabloid]:new so.Size(15840,24480),[Vc.Ledger]:new so.Size(24480,15840),[Vc.Legal]:new so.Size(12240,20160),[Vc.Statement]:new so.Size(7920,12240),[Vc.Executive]:new so.Size(10440,15120),[Vc.A3]:new so.Size(16839,23814),[Vc.A4]:new so.Size(11907,16839),[Vc.A4Small]:new so.Size(11907,16839),[Vc.A5]:new so.Size(8391,11907),[Vc.B4]:new so.Size(14572,20639),[Vc.B5]:new so.Size(10319,14571),[Vc.Folio]:new so.Size(12240,18720),[Vc.Quarto]:new so.Size(12189,15591),[Vc.Standard10x14]:new so.Size(14400,20160),[Vc.Standard11x17]:new so.Size(15840,24480),[Vc.Note]:new so.Size(12240,15840),[Vc.Number9Envelope]:new so.Size(5580,12780),[Vc.Number10Envelope]:new so.Size(5940,13680),[Vc.Number11Envelope]:new so.Size(6480,14940),[Vc.Number12Envelope]:new so.Size(6840,15840),[Vc.Number14Envelope]:new so.Size(7200,16560),[Vc.CSheet]:new so.Size(24480,31680),[Vc.DSheet]:new so.Size(31680,48960),[Vc.ESheet]:new so.Size(48960,63360),[Vc.DLEnvelope]:new so.Size(6237,12474),[Vc.C5Envelope]:new so.Size(9185,12984),[Vc.C3Envelope]:new so.Size(18369,25965),[Vc.C4Envelope]:new so.Size(12983,18369),[Vc.C6Envelope]:new so.Size(6463,9184),[Vc.C65Envelope]:new so.Size(6463,12983),[Vc.B4Envelope]:new so.Size(14173,20013),[Vc.B5Envelope]:new so.Size(9978,14173),[Vc.B6Envelope]:new so.Size(9978,7087),[Vc.ItalyEnvelope]:new so.Size(6236,13039),[Vc.MonarchEnvelope]:new so.Size(5580,10800),[Vc.PersonalEnvelope]:new so.Size(5220,9360),[Vc.USStandardFanfold]:new so.Size(21420,15840),[Vc.GermanStandardFanfold]:new so.Size(12240,17280),[Vc.GermanLegalFanfold]:new so.Size(12240,18720),[Vc.IsoB4]:new so.Size(14173,20013),[Vc.JapanesePostcard]:new so.Size(5669,8391),[Vc.Standard9x11]:new so.Size(12960,15840),[Vc.Standard10x11]:new so.Size(14400,15840),[Vc.Standard15x11]:new so.Size(21600,15840),[Vc.InviteEnvelope]:new so.Size(12472,12472),[Vc.LetterExtra]:new so.Size(13680,17280),[Vc.LegalExtra]:new so.Size(13680,21600),[Vc.TabloidExtra]:new so.Size(16834,25920),[Vc.A4Extra]:new so.Size(13349,18274),[Vc.LetterTransverse]:new so.Size(12240,15840),[Vc.A4Transverse]:new so.Size(11907,16839),[Vc.LetterExtraTransverse]:new so.Size(13680,17280),[Vc.APlus]:new so.Size(12869,20183),[Vc.BPlus]:new so.Size(17291,27609),[Vc.LetterPlus]:new so.Size(12240,18274),[Vc.A4Plus]:new so.Size(11907,18709),[Vc.A5Transverse]:new so.Size(8391,11907),[Vc.B5Transverse]:new so.Size(10319,14571),[Vc.A3Extra]:new so.Size(18255,25228),[Vc.A5Extra]:new so.Size(9865,13323),[Vc.B5Extra]:new so.Size(11395,15647),[Vc.A2]:new so.Size(23811,33676),[Vc.A3Transverse]:new so.Size(16839,23814),[Vc.A3ExtraTransverse]:new so.Size(18255,25228),[Vc.JapaneseDoublePostcard]:new so.Size(11339,8391),[Vc.A6]:new so.Size(5953,8391),[Vc.JapaneseEnvelopeKakuNumber2]:new so.Size(12240,15840),[Vc.JapaneseEnvelopeKakuNumber3]:new so.Size(12240,15840),[Vc.JapaneseEnvelopeChouNumber3]:new so.Size(12240,15840),[Vc.JapaneseEnvelopeChouNumber4]:new so.Size(12240,15840),[Vc.LetterRotated]:new so.Size(15840,12240),[Vc.A3Rotated]:new so.Size(23814,16839),[Vc.A4Rotated]:new so.Size(16839,11907),[Vc.A5Rotated]:new so.Size(11907,8391),[Vc.B4JisRotated]:new so.Size(20636,14570),[Vc.B5JisRotated]:new so.Size(14570,10318),[Vc.JapanesePostcardRotated]:new so.Size(8391,5669),[Vc.JapaneseDoublePostcardRotated]:new so.Size(8391,11339),[Vc.A6Rotated]:new so.Size(8391,5953),[Vc.JapaneseEnvelopeKakuNumber2Rotated]:new so.Size(12240,15840),[Vc.JapaneseEnvelopeKakuNumber3Rotated]:new so.Size(12240,15840),[Vc.JapaneseEnvelopeChouNumber3Rotated]:new so.Size(12240,15840),[Vc.JapaneseEnvelopeChouNumber4Rotated]:new so.Size(12240,15840),[Vc.B6Jis]:new so.Size(7257,10318),[Vc.B6JisRotated]:new so.Size(10318,7257),[Vc.Standard12x11]:new so.Size(17280,15840),[Vc.JapaneseEnvelopeYouNumber4]:new so.Size(12240,15840),[Vc.JapaneseEnvelopeYouNumber4Rotated]:new so.Size(15840,12240),[Vc.Prc16K]:new so.Size(8277,12189),[Vc.Prc32K]:new so.Size(5499,8561),[Vc.Prc32KBig]:new so.Size(5499,8561),[Vc.PrcEnvelopeNumber1]:new so.Size(5783,9354),[Vc.PrcEnvelopeNumber2]:new so.Size(5783,9978),[Vc.PrcEnvelopeNumber3]:new so.Size(7087,9978),[Vc.PrcEnvelopeNumber4]:new so.Size(6236,11792),[Vc.PrcEnvelopeNumber5]:new so.Size(6236,12472),[Vc.PrcEnvelopeNumber6]:new so.Size(6803,13039),[Vc.PrcEnvelopeNumber7]:new so.Size(9071,13039),[Vc.PrcEnvelopeNumber8]:new so.Size(6803,17518),[Vc.PrcEnvelopeNumber9]:new so.Size(12983,18369),[Vc.PrcEnvelopeNumber10]:new so.Size(18369,25965),[Vc.Prc16KRotated]:new so.Size(12189,8277),[Vc.Prc32KRotated]:new so.Size(8561,5499),[Vc.Prc32KBigRotated]:new so.Size(8561,5499),[Vc.PrcEnvelopeNumber1Rotated]:new so.Size(9354,5783),[Vc.PrcEnvelopeNumber2Rotated]:new so.Size(9978,5783),[Vc.PrcEnvelopeNumber3Rotated]:new so.Size(9978,7087),[Vc.PrcEnvelopeNumber4Rotated]:new so.Size(11792,6236),[Vc.PrcEnvelopeNumber5Rotated]:new so.Size(12472,6236),[Vc.PrcEnvelopeNumber6Rotated]:new so.Size(13039,6803),[Vc.PrcEnvelopeNumber7Rotated]:new so.Size(13039,9071),[Vc.PrcEnvelopeNumber8Rotated]:new so.Size(17518,6803),[Vc.PrcEnvelopeNumber9Rotated]:new so.Size(18369,12983),[Vc.PrcEnvelopeNumber10Rotated]:new so.Size(25965,18369)};class Ph{}Ph.countBy=0,Ph.start=1,Ph.distance=360,Ph.restart=zs.NewPage;class wh{constructor(e=Ph.countBy,t=Ph.start,r=Ph.distance,i=Ph.restart){this.countBy=e,this.start=t,this.distance=r,this.restart=i}get isDefined(){return this.countBy!==Ph.countBy}copyFrom(e){this.countBy=e.countBy,this.distance=e.distance,this.restart=e.restart,this.start=e.start}clone(){const e=new wh;return e.copyFrom(this),e}equals(e){return e&&this.countBy===e.countBy&&this.distance===e.distance&&this.restart===e.restart&&this.start===e.start}}class yh{constructor(){this.margins=new jc.m(1440,1440,1440,1440),this.headerOffset=720,this.footerOffset=720,this.columnCount=1,this.space=720,this.equalWidthColumns=!0,this.columnsInfo=[],this.pageSize=new so.Size(12240,15840),this.startType=Vs.NextPage,this.landscape=!1,this.differentFirstPage=!1,this.paperKind=Vc.Letter,this.firstPageNumber=-1,this.continueNumbering=!0,this.lineNumbering=new wh}static createSimpleSectionProperties(e,t){const r=new yh;return r.margins=new jc.m(0,0,0,0),r.pageWidth=g.u.pixelsToTwips(e),r.pageHeight=g.u.pixelsToTwips(t),r}get marginLeft(){return this.margins.left}get marginTop(){return this.margins.top}get marginRight(){return this.margins.right}get marginBottom(){return this.margins.bottom}get pageWidth(){return this.pageSize.width}get pageHeight(){return this.pageSize.height}set marginLeft(e){this.margins.left=e}set marginTop(e){this.margins.top=e}set marginRight(e){this.margins.right=e}set marginBottom(e){this.margins.bottom=e}set pageWidth(e){this.pageSize.width=e}set pageHeight(e){this.pageSize.height=e}copyFrom(e){if(this.columnCount=e.columnCount,e.columnsInfo){this.columnsInfo=[];for(var t=0;t<e.columnsInfo.length;t++)this.columnsInfo.push(new Sh(e.columnsInfo[t].width,e.columnsInfo[t].space))}else this.columnsInfo=e.columnsInfo;this.lineNumbering.copyFrom(e.lineNumbering),this.equalWidthColumns=e.equalWidthColumns,this.marginBottom=e.marginBottom,this.marginLeft=e.marginLeft,this.marginRight=e.marginRight,this.marginTop=e.marginTop,this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.space=e.space,this.startType=e.startType,this.landscape=e.landscape,this.differentFirstPage=e.differentFirstPage,this.headerOffset=e.headerOffset,this.footerOffset=e.footerOffset,this.paperKind=e.paperKind,this.firstPageNumber=e.firstPageNumber,this.continueNumbering=e.continueNumbering}clone(){var e=new yh;return e.copyFrom(this),e}equals(e){return!!e&&(this.margins.equals(e.margins)&&this.headerOffset==e.headerOffset&&this.footerOffset==e.footerOffset&&this.columnCount==e.columnCount&&this.space==e.space&&this.equalWidthColumns==e.equalWidthColumns&&this.pageSize.equals(e.pageSize)&&this.startType==e.startType&&this.landscape==e.landscape&&this.differentFirstPage==e.differentFirstPage&&Sh.equalsColumnsInfoBinary(this.columnsInfo,e.columnsInfo)&&this.paperKind==e.paperKind&&this.firstPageNumber==e.firstPageNumber&&this.continueNumbering==e.continueNumbering)}}class xh{static convertFromJSON(e){const t=[];for(let r of e)t.push(new Sh(r[Oc.Width],r[Oc.Space]));return t}static convertToJSON(e){const t=[];for(let r of e){const e={};e[Oc.Width]=r.width,e[Oc.Space]=r.space,t.push(e)}return t}}class Th{static convertFromJSON(e){var t=new yh;if(t.marginLeft=e[Hc.MarginLeft],t.marginTop=e[Hc.MarginTop],t.marginRight=e[Hc.MarginRight],t.marginBottom=e[Hc.MarginBottom],t.columnCount=e[Hc.ColumnCount],t.space=e[Hc.Space],t.columnsInfo=xh.convertFromJSON(e[Hc.ColumnsInfo]),t.pageWidth=e[Hc.PageWidth],t.pageHeight=e[Hc.PageHeight],t.startType=e[Hc.StartType],t.landscape=!!e[Hc.Landscape],t.equalWidthColumns=!!e[Hc.EqualWidthColumns],t.differentFirstPage=!!e[Hc.DifferentFirstPage],t.headerOffset=e[Hc.HeaderOffset],t.footerOffset=e[Hc.FooterOffset],t.paperKind=e[Hc.PaperKind],t.firstPageNumber=e[Hc.FirstPageNumber],t.continueNumbering=!!e[Hc.ContinueNumbering],!t.equalWidthColumns)for(;t.columnCount>t.columnsInfo.length;)t.columnsInfo.push(new Sh(0,0));return t}static convertToJSON(e){var t={};return t[Hc.MarginLeft]=e.marginLeft,t[Hc.MarginTop]=e.marginTop,t[Hc.MarginRight]=e.marginRight,t[Hc.MarginBottom]=e.marginBottom,t[Hc.ColumnCount]=e.columnCount,t[Hc.Space]=e.space,t[Hc.ColumnsInfo]=xh.convertToJSON(e.columnsInfo),t[Hc.PageWidth]=e.pageWidth,t[Hc.PageHeight]=e.pageHeight,t[Hc.StartType]=e.startType,t[Hc.Landscape]=(0,S.boolToInt)(e.landscape),t[Hc.EqualWidthColumns]=(0,S.boolToInt)(e.equalWidthColumns),t[Hc.DifferentFirstPage]=(0,S.boolToInt)(e.differentFirstPage),t[Hc.HeaderOffset]=e.headerOffset,t[Hc.FooterOffset]=e.footerOffset,t[Hc.PaperKind]=e.paperKind,t[Hc.FirstPageNumber]=e.firstPageNumber,t[Hc.ContinueNumbering]=(0,S.boolToInt)(e.continueNumbering),t}}class vh{static convertFromJSON(e,t){var r=new or;return r.top=Ho.convertFromJSON(e[Bs.TopBorder],t),r.left=Ho.convertFromJSON(e[Bs.LeftBorder],t),r.right=Ho.convertFromJSON(e[Bs.RightBorder],t),r.bottom=Ho.convertFromJSON(e[Bs.BottomBorder],t),r.topLeftDiagonal=Ho.convertFromJSON(e[Bs.TopLeftDiagonalBorder],t),r.topRightDiagonal=Ho.convertFromJSON(e[Bs.TopRightDiagonalBorder],t),r}static convertToJSON(e){var t={};return t[Bs.TopBorder]=Ho.convertToJSON(e.top),t[Bs.LeftBorder]=Ho.convertToJSON(e.left),t[Bs.RightBorder]=Ho.convertToJSON(e.right),t[Bs.BottomBorder]=Ho.convertToJSON(e.bottom),t[Bs.TopLeftDiagonalBorder]=Ho.convertToJSON(e.topLeftDiagonal),t[Bs.TopRightDiagonalBorder]=Ho.convertToJSON(e.topRightDiagonal),t}}class Mh{static convertFromJSON(e,t,r){const i=new cr;return i.cellMargins=$l.convertFromJSON(e[sl.CellMargins]),i.borders=vh.convertFromJSON(e[sl.Borders],t),i.hideCellMark=!!e[sl.HideCellMark],i.noWrap=!!e[sl.NoWrap],i.fitText=!!e[sl.FitText],i.textDirection=e[sl.TextDirection],i.verticalAlignment=e[sl.VerticalAlignment],i.shadingInfo=r.getItemByJsonKey(e[sl.ShadingInfoIndex]),i.mask=e[sl.UseValue],i}static convertToJSON(e){const t={};return t[sl.CellMargins]=$l.convertToJSON(e.cellMargins),t[sl.Borders]=vh.convertToJSON(e.borders),t[sl.HideCellMark]=(0,S.boolToInt)(e.hideCellMark),t[sl.NoWrap]=(0,S.boolToInt)(e.noWrap),t[sl.FitText]=(0,S.boolToInt)(e.fitText),t[sl.TextDirection]=e.textDirection,t[sl.VerticalAlignment]=e.verticalAlignment,t[sl.ShadingInfo]=pe.convertToJSON(e.shadingInfo),t[sl.UseValue]=e.mask,t}}class Eh{static convertFromJSON(e){var t=new za;return t.cellSpacing=ql.convertFromJSON(e[ul.CellSpacing]),t.header=!!e[ul.Header],t.hideCellMark=!!e[ul.HideCellMark],t.cantSplit=!!e[ul.CantSplit],t.tableRowAlignment=e[ul.TableRowAlignment],t.mask=e[ul.UseValue],t.divId=e[ul.DivId],t}static convertToJSON(e){var t={};return t[ul.CellSpacing]=ql.convertToJSON(e.cellSpacing),t[ul.Header]=(0,S.boolToInt)(e.header),t[ul.HideCellMark]=(0,S.boolToInt)(e.hideCellMark),t[ul.CantSplit]=(0,S.boolToInt)(e.cantSplit),t[ul.TableRowAlignment]=e.tableRowAlignment,t[ul.UseValue]=e.mask,t[ul.DivId]=e.divId,t}}class Dh{static importDocumentProperties(e,t){e.defaultTabWidth=t[Eo.DefaultTabWidth],e.differentOddAndEvenPages=!!t[Eo.DifferentOddAndEvenPages],e.displayBackgroundShape=!!t[Eo.DisplayBackgroundShape],e.pageBackColor=t[Eo.PageBackColor],e.setDefaultCharacterProperties(t[Eo.DefaultCharacterProperties]),e.setDefaultParagraphProperties(t[Eo.DefaultParagraphProperties]),e.defaultTableProperties=Jl.convertFromJSON(t[Eo.DefaultTableProperties],e.cache.colorModelInfoCache,e.cache.shadingInfoCache),e.defaultTableRowProperties=e.cache.tableRowPropertiesCache.getItem(Eh.convertFromJSON(t[Eo.DefaultTableRowProperties])),e.defaultTableCellProperties=e.cache.tableCellPropertiesCache.getItem(Mh.convertFromJSON(t[Eo.DefaultTableCellProperties],e.cache.colorModelInfoCache,e.cache.shadingInfoCache));const r=t[Eo.ProtectionProperties],i=!!r[vo.EnforceProtection],n=r[vo.ProtectionType];e.aspxIsDocumentProtectionEnabled=i&&(n===Mo.ReadOnly||n===Mo.AllowComments)}static importCompatibilitySettings(e,t){e.compatibilitySettings.dontJustifyLinesEndingInSoftLineBreak=!!t[Do.DontJustifyLinesEndingInSoftLineBreak];t[Do.CompatibilityMode]&&(e.compatibilitySettings.compatibilityMode=t[Do.CompatibilityMode])}static importModelHeaderFooter(e,t,r){for(let i of t){const t=new r(i[ys.SubDocumentId]);t.headerFooterType=i[ys.Type],e.push(t)}}static importSections(e,t){for(let r of t)e.sections.push(new Ch(e,e.mainSubDocument.positionManager.registerPosition(r[kc.StartPos]),r[kc.Length],Th.convertFromJSON(r[kc.Properties])));for(var r,i=0;r=t[i];i++){const t=e.sections[i];this.importHeaderFooter(t.headers,r[kc.Headers]),this.importHeaderFooter(t.footers,r[kc.Footers])}}static importHeaderFooter(e,t){b.j.forEach(t,((t,r)=>e.setObjectIndex(r,t)))}static importOptions(e,t){t&&(void 0!==t[Nc.Copy]&&(e.copy=t[Nc.Copy]),void 0!==t[Nc.CreateNew]&&(e.createNew=t[Nc.CreateNew]),void 0!==t[Nc.Cut]&&(e.cut=t[Nc.Cut]),void 0!==t[Nc.Drag]&&(e.drag=t[Nc.Drag]),void 0!==t[Nc.Drop]&&(e.drop=t[Nc.Drop]),void 0!==t[Nc.Open]&&(e.open=t[Nc.Open]),void 0!==t[Nc.Paste]&&(e.paste=t[Nc.Paste]),void 0!==t[Nc.Printing]&&(e.printing=t[Nc.Printing]),void 0!==t[Nc.Save]&&(e.save=t[Nc.Save]),void 0!==t[Nc.SaveAs]&&(e.saveAs=t[Nc.SaveAs]),void 0!==t[Nc.FullScreen]&&(e.fullScreen=t[Nc.FullScreen]),void 0!==t[Nc.Bookmarks]&&(e.bookmarks=t[Nc.Bookmarks]),void 0!==t[Nc.CharacterFormatting]&&(e.characterFormatting=t[Nc.CharacterFormatting]),void 0!==t[Nc.CharacterStyle]&&(e.characterStyle=t[Nc.CharacterStyle]),void 0!==t[Nc.Fields]&&(e.fields=t[Nc.Fields]),void 0!==t[Nc.Hyperlinks]&&(e.hyperlinks=t[Nc.Hyperlinks]),void 0!==t[Nc.InlinePictures]&&(e.inlinePictures=t[Nc.InlinePictures]),void 0!==t[Nc.ParagraphFormatting]&&(e.paragraphFormatting=t[Nc.ParagraphFormatting]),void 0!==t[Nc.Paragraphs]&&(e.paragraphs=t[Nc.Paragraphs]),void 0!==t[Nc.ParagraphStyle]&&(e.paragraphStyle=t[Nc.ParagraphStyle]),void 0!==t[Nc.ParagraphTabs]&&(e.paragraphTabs=t[Nc.ParagraphTabs]),void 0!==t[Nc.Sections]&&(e.sections=t[Nc.Sections]),void 0!==t[Nc.TabSymbol]&&(e.tabSymbol=t[Nc.TabSymbol]),void 0!==t[Nc.Undo]&&(e.undo=t[Nc.Undo]),void 0!==t[Nc.NumberingBulleted]&&(e.numberingBulleted=t[Nc.NumberingBulleted]),void 0!==t[Nc.NumberingMultiLevel]&&(e.numberingMultiLevel=t[Nc.NumberingMultiLevel]),void 0!==t[Nc.NumberingSimple]&&(e.numberingSimple=t[Nc.NumberingSimple]),void 0!==t[Nc.HeadersFooters]&&(e.headersFooters=t[Nc.HeadersFooters]),void 0!==t[Nc.Tables]&&(e.tables=t[Nc.Tables]),void 0!==t[Nc.TableStyle]&&(e.tableStyle=t[Nc.TableStyle]),void 0!==t[Nc.TabMarker]&&(e.tabMarker=t[Nc.TabMarker]),void 0!==t[Nc.PageBreakInsertMode]&&(e.pageBreakInsertMode=t[Nc.PageBreakInsertMode]),void 0!==t[Nc.AcceptsTab]&&(e.acceptsTab=!!t[Nc.AcceptsTab]),void 0!==t[Nc.Download]&&(e.download=t[Nc.Download]),e.raiseClientEventsOnModificationsViaAPI=!!t[Nc.RaiseClientEventsOnModificationsViaAPI])}}class Fh{static convertFromJSON(e){return new so.Size(e[Z.Width],e[Z.Height])}static convertToJSON(e){const t={};return t[Z.Width]=e.width,t[Z.Height]=e.height,t}static convertToJSONSeparately(e,t){const r={};return r[Z.Width]=e,r[Z.Height]=t,r}}class Rh{static convertFromJSON(e){const t=Fh.convertFromJSON(e[Tc.RelativeSizeType]),r=Fh.convertFromJSON(e[Tc.UseAbsoluteSize]);return new eh(!!e[wc.LockAspectRatio],e[wc.Rotation],Fh.convertFromJSON(e[Tc.AbsoluteSize]),Fh.convertFromJSON(e[Tc.RelativeSize]),t.width,t.height,!!r.width,!!r.height)}static convertToJSON(e){const t={};return t[wc.LockAspectRatio]=(0,S.boolToInt)(e.lockAspectRatio),t[wc.Rotation]=e.rotation,t[Tc.AbsoluteSize]=Fh.convertToJSON(e.absoluteSize),t[Tc.RelativeSize]=Fh.convertToJSON(e.relativeSize),t[Tc.RelativeSizeType]=Fh.convertToJSONSeparately(e.relativeWidthType,e.relativeHeightType),t[Tc.UseAbsoluteSize]=Fh.convertToJSONSeparately((0,S.boolToInt)(e.useAbsoluteWidth()),(0,S.boolToInt)(e.useAbsoluteHeight())),t}}class Lh{static convertFromJSON(e,t){return new Qc(!!e[wc.LockAspectRatio],e[wc.Rotation],t,Fh.convertFromJSON(e[yc.Scale]))}static convertToJSON(e){const t={};return t[wc.LockAspectRatio]=(0,S.boolToInt)(e.lockAspectRatio),t[wc.Rotation]=e.rotation,t[yc.Scale]=Fh.convertToJSON(e.scale),t}}class Bh{static convertFromJSON(e){return new Zc(!!e[wc.LockAspectRatio],e[wc.Rotation],Fh.convertFromJSON(e[xc.AbsoluteSize]))}static convertToJSON(e){const t={};return t[wc.LockAspectRatio]=(0,S.boolToInt)(e.lockAspectRatio),t[wc.Rotation]=e.rotation,t[xc.AbsoluteSize]=Fh.convertToJSON(e.absoluteSize),t}}class Ah{static convertFromJSON(e){const t=new rh;return e&&(t.id=e[Bc.Id],t.name=e[Bc.Name],t.title=e[Bc.Title],t.description=e[Bc.Description]),t}static convertToJSON(e){const t={};return t[Bc.Id]=e.id,t[Bc.Name]=e.name,t[Bc.Title]=e.title,t[Bc.Description]=e.description,t}}class Nh{getRun(e,t,r){return this.makeRun(r,t,e,new pn(this.maskedCharacterPropertiesCache.getItemByJsonKey(r[el.MaskedCharacterPropertiesCacheIndex]),this.charStyles[r[el.CharacterStyleIndex]]))}init(e,t,r,i){this.imageCorrespondence=i,this.charStyles=t,this.maskedCharacterPropertiesCache=e,this.imageCache=r}}class kh extends Nh{constructor(e){super(),this.runConstructor=e}makeRun(e,t,r,i){return new this.runConstructor(t,r,i)}}class Oh extends Nh{constructor(e){super(),this.runConstructor=e}makeRun(e,t,r,i){return new this.runConstructor(t,r,i,-1)}}class _h{static importSubDocument(e,t,r,i){sc.importTables(e,r[ws.Tables]),_h.importFields(e,r[ws.Fields]),_h.importBookmarks(e,r[ws.Bookmarks]),_h.importParagraphs(e,r[ws.Paragraphs]),_h.importChunks(e,r[ws.Chunks],i),_h.importRangePermissions(e,t,r[ws.RangePermissions])}static importFields(e,t){if(t){for(var r,i=0;r=t[i];i++){let t;const n=r[Ks.Uri],o=r[Ks.Anchor];void 0===n&&void 0===o||(t=new xd(n,o,r[Ks.Tip],!!r[Ks.Visited])),e.fields.push(new Md(e.positionManager,i,r[Ks.StartPos],r[Ks.SeparatorPos],r[Ks.EndPos],!1,t))}e.fields.sort(((e,t)=>e.getCodeStartPosition()-t.getCodeStartPosition()));var n;for(i=0;n=e.fields[i];i++)n.index=i,n.initParent(e.fields)}}static importBookmarks(e,t){t&&(f.ListUtils.forEach(t,(t=>{const r=parseInt(t[xs.StartPos]),i=parseInt(t[xs.Length]),n=t[xs.Name];e.bookmarks.push(new Cd(e.positionManager,new on.FixedInterval(r,i),n))})),e.bookmarks=e.bookmarks.sort(Sd.comparer))}static importRangePermissions(e,t,r){r&&(e.availableRangePermissions=f.ListUtils.reducedMap(r,(r=>{const i=parseInt(r[Ts.Start]),n=parseInt(r[Ts.Length])+1,o=new Dd(e.positionManager,new on.FixedInterval(i,n),r[Ts.UserName],r[Ts.Group]);return o.isGranted(t)?o:null})))}static importParagraphs(e,t){if(!t)return;const r=e.paragraphs,i=e.documentModel.paragraphStyles,n=e.positionManager;for(let o of t){const t=new ns(e,n.registerPosition(o[De.LogPosition]),o[De.Length],i[o[De.ParagraphStyleIndex]],null,o[De.MaskedParagraphPropertiesIndex]);t.numberingListIndex=o[De.ListIndex],t.listLevelIndex=o[De.ListLevelIndex],t.tabs.setTabs(jl.convertFromJSONToTabProperties(o[De.Tabs])),r.push(t)}}static importChunks(e,t,r){if(!t)return;const i=e.documentModel.characterStyles,n=e.documentModel.cache.imageCache,o=e.documentModel.cache.maskedCharacterPropertiesCache;b.j.forEach(_h.runTypeToRunImporter,(e=>e.init(o,i,n,r)));const a=e.chunks,s=e.paragraphs,l=t[0][vs.StartPos];let d=C.SearchUtils.normedInterpolationIndexOf(s,(e=>e.startLogPosition.value),l),c=s[d],h=c.getEndPosition();for(let r of t){const t=r[vs.StartPos],i=new mo(e.positionManager.registerPosition(t),r[vs.TextBuffer],!!r[vs.IsLast]);a.push(i);for(let e of r[vs.Runs]){const r=e[el.Offset];t+r>=h&&(c=s[++d],h=c.getEndPosition()),i.textRuns.push(_h.runTypeToRunImporter[e[el.Type]].getRun(c,r,e))}}}}_h.runTypeToRunImporter={[cs.TextRun]:new class extends Nh{makeRun(e,t,r,i){return new ch(t,e[el.Length],r,i)}},[cs.ParagraphRun]:new kh(Bl),[cs.SectionRun]:new kh(Ll),[cs.FieldCodeStartRun]:new kh(Al),[cs.FieldCodeEndRun]:new kh(Nl),[cs.FieldResultEndRun]:new kh(kl),[cs.AnchoredPictureRun]:new class extends Nh{makeRun(e,t,r,i){const n=e[il.PictureId],o=this.imageCorrespondence?this.imageCorrespondence[n]:n,a=this.imageCache.getPictureData(o);return new ah(t,r,i,new oh(Lh.convertFromJSON(e[il.Size],a),hh.convertFromJSON(e[il.Shape]),uh.convertFromJSON(e[il.AnchorInfo]),Ah.convertFromJSON(e[il.DrawingObjectProperties]),new rh),-1)}},[cs.AnchoredTextBoxRun]:new class extends Nh{makeRun(e,t,r,i){return new sh(t,r,i,hh.convertFromJSON(e[nl.Shape]),e[nl.SubDocId],Rh.convertFromJSON(e[nl.Size]),uh.convertFromJSON(e[nl.AnchorInfo]),-1,gh.convertFromJSON(e[nl.TextBoxProperties]),Ah.convertFromJSON(e[nl.DrawingObjectProperties]))}},[cs.InlinePictureRun]:new class extends Nh{makeRun(e,t,r,i){const n=e[il.PictureId],o=this.imageCorrespondence?this.imageCorrespondence[n]:n,a=this.imageCache.getPictureData(o);return new lh(t,r,i,new nh(Lh.convertFromJSON(e[tl.Size],a),hh.convertFromJSON(e[tl.Shape]),-1,Ah.convertFromJSON(e[tl.DrawingObjectProperties]),new rh))}},[cs.InlineTextBoxRun]:new class extends Nh{makeRun(e,t,r,i){return new dh(t,r,i,hh.convertFromJSON(e[rl.Shape]),e[rl.SubDocId],Bh.convertFromJSON(e[rl.Size]),gh.convertFromJSON(e[rl.TextBoxProperties]),Ah.convertFromJSON(e[rl.DrawingObjectProperties]))}},[cs.LayoutDependentRun]:new kh(Ol),[cs.FootNoteRun]:new Oh(Ul),[cs.EndNoteRun]:new Oh(Hl),[cs.NoteSeparatorRun]:new kh(Vl),[cs.NoteContinuationSeparatorRun]:new kh(Wl)};class Uh{constructor(e,t,r){this.documentModel=r,this.cache=e;const i=t[c.FontInfoCache],n=t[c.CharacterPropertiesCache],o=t[c.ParagraphPropertiesCache],a=t[c.ListLevelPropertiesCache],s=t[c.TableRowPropertiesCache],l=t[c.TableCellPropertiesCache],d=t[c.ColorModelInfoCache],h=t[c.ShadingInfoCache];i&&e.fontInfoCache.merge(i,hd.convertFromJSON),d&&e.colorModelInfoCache.merge(d,ue.convertFromJSON),h&&e.shadingInfoCache.merge(h,(t=>pe.convertFromJSON(t,e.colorModelInfoCache))),n&&e.maskedCharacterPropertiesCache.merge(n,(t=>_o.convertFromJSON(t,e.colorModelInfoCache,e.shadingInfoCache,e.fontInfoCache))),o&&e.maskedParagraphPropertiesCache.merge(o,(t=>Vo.convertFromJSON(t,e.colorModelInfoCache,e.shadingInfoCache))),a&&e.listLevelPropertiesCache.merge(a,ud.convertFromJSON),s&&e.tableRowPropertiesCache.merge(s,Eh.convertFromJSON),l&&e.tableCellPropertiesCache.merge(l,(t=>Mh.convertFromJSON(t,e.colorModelInfoCache,e.shadingInfoCache))),this.jsonSubDocs=t[c.SubDocuments]}importSubDocuments(e,t){b.j.forEach(this.jsonSubDocs,((r,i)=>{const n=r[Ms.Type];let o;switch(n){case yo.Header:o=Uh.getInfoBySubDocumentId(this.documentModel.headers,i);break;case yo.Footer:o=Uh.getInfoBySubDocumentId(this.documentModel.footers,i);break;case yo.Main:o=ed.create(n,i,-1);break;case yo.TextBox:o=ed.create(n,i,r[Ms.ParentPieceTableId]);break;default:throw new Error("Unknown subDocumentType")}const a=o.isMain?this.documentModel.mainSubDocument:this.documentModel.importSubDocument(o),s=r[Ms.Info];_h.importSubDocument(a,e,s,t)}))}exportSubDocuments(){let e=this.documentModel.subDocuments,t=[];return b.j.forEach(e,(e=>{let r=[];cd.exportSubDocument(e,r),t.push(r)})),t}static getInfoBySubDocumentId(e,t){for(let r of e)if(r.subDocumentId===t)return r;throw new Error(R.D.InternalException)}dispose(){this.cache.clearTemporaryCaches()}}class Hh extends Za{constructor(e,t,r,i,n,o,a,s){super(e,t,r,i,n,o),this.tableCellProperties=a,this.characterProperties=s}clone(){return new Hh(this.styleName,this.localizedName,this.deleted,this.hidden,this.semihidden,this.isDefault,this.tableCellProperties,this.characterProperties)}}Hh.DEFAULT_STYLENAME="";class Vh extends Za{constructor(e,t,r,i,n,o,a,s,l,d){super(e,t,r,i,n,o,l,d),this.conditionalStyles={},this.conditionalStyles=a,this.baseConditionalStyle=s}clone(){return new Vh(this.styleName,this.localizedName,this.deleted,this.hidden,this.semihidden,this.isDefault,b.j.map(this.conditionalStyles,(e=>e.clone())),this.baseConditionalStyle.clone(),this.base64EncodedImage,this.id)}}Vh.SIMPLE_STYLENAME="Table Simple 1",Vh.DEFAULT_STYLENAME="Normal Table",Vh.DEFAULT_STYLENAME_2="Table Normal";class Wh{constructor(e){this.characterAndParagraphStyleGalleryItems=[[],[]],this.characterStyleNameToIndex={},this.paragraphStyleNameToIndex={},this.numberingListStyleNameToIndex={},this.tableStyleNameToIndex={},this.tableCellStyleNameToIndex={},this.documentModel=e}static isParagraphStyle(e){return rn.StringUtils.startsAt(e,Wh.paragraphPrefix)}static getStyleNameWithoutPrefix(e){return Wh.paragraphPrefix&&Wh.isParagraphStyle(e)?e.substr(Wh.paragraphPrefix.length):e.substr(Wh.characterPrefix.length)}initCharacterAndParagraphStyleGalleryItems(){const e=[[],[]];for(let t of this.documentModel.paragraphStyles)t.deleted||t.hidden||t.semihidden||e[0].push({value:Wh.paragraphPrefix+t.styleName,text:t.localizedName,data:t.base64EncodedImage});for(let t of this.documentModel.characterStyles)t.deleted||t.hidden||t.semihidden||t.linkedStyle||e[1].push({value:Wh.characterPrefix+t.styleName,text:t.localizedName,data:t.base64EncodedImage});for(let t of Wh.presetParagraphStyles)t.deleted||t.hidden||t.semihidden||this.documentModel.getParagraphStyleByName(t.styleName)||e[0].push({value:Wh.paragraphPrefix+t.styleName,text:t.localizedName,data:t.base64EncodedImage});for(let t of Wh.presetCharacterStyles)t.deleted||t.hidden||t.semihidden||t.linkedStyle||this.documentModel.getCharacterStyleByName(t.styleName)||e[1].push({value:Wh.characterPrefix+t.styleName,text:t.localizedName,data:t.base64EncodedImage});this.characterAndParagraphStyleGalleryItems=e}registerLink(e,t){e.linkedStyle=t,t.linkedStyle=e}unregisterLink(e,t){e.linkedStyle=null,t.linkedStyle=null}getCharacterStyleByName(e){return Wh.getStyleByNameCore(e,this.documentModel.characterStyles,this.characterStyleNameToIndex)}getParagraphStyleByName(e){return Wh.getStyleByNameCore(e,this.documentModel.paragraphStyles,this.paragraphStyleNameToIndex)}getNumberingListStyleByName(e){return Wh.getStyleByNameCore(e,this.documentModel.numberingListStyles,this.numberingListStyleNameToIndex)}getTableStyleByName(e){return Wh.getStyleByNameCore(e,this.documentModel.tableStyles,this.tableStyleNameToIndex)}getTableCellStyleByName(e){return Wh.getStyleByNameCore(e,this.documentModel.tableCellStyles,this.tableCellStyleNameToIndex)}getDefaultCharacterStyle(){return this.defaultCharacterStyle||this.getDefaultStyleCore(this.documentModel.characterStyles,(e=>{this.defaultCharacterStyle=e}))}getDefaultParagraphStyle(){return this.defaultParagraphStyle||this.getDefaultStyleCore(this.documentModel.paragraphStyles,(e=>{this.defaultParagraphStyle=e}))}getDefaultTableStyle(){return this.getTableStyleByName(Vh.DEFAULT_STYLENAME)||this.getTableStyleByName(Vh.DEFAULT_STYLENAME_2)||this.documentModel.tableStyles[0]||null}getDefaultTableCellStyle(){return this.getTableCellStyleByName(Hh.DEFAULT_STYLENAME)||this.documentModel.tableCellStyles[0]||null}addCharacterStyle(e){return e?this.getCharacterStyleByName(e.styleName)||this.addCharacterStyleCore(e):null}registerCharacterStyle(e){this.characterStyleNameToIndex[e.styleName]=this.documentModel.characterStyles.push(e)-1}removeLastStyle(){var e=this.documentModel.characterStyles.pop();delete this.characterStyleNameToIndex[e.styleName]}addParagraphStyle(e){return e?this.getParagraphStyleByName(e.styleName)||this.addParagraphStyleCore(e):null}registerParagraphStyle(e){this.paragraphStyleNameToIndex[e.styleName]=this.documentModel.paragraphStyles.push(e)-1}addTableStyle(e){return e?this.getTableStyleByName(e.styleName)||this.addTableStyleCore(e):null}registerTableStyle(e){this.tableStyleNameToIndex[e.styleName]=this.documentModel.tableStyles.push(e)-1}addTableCellStyle(e){return e?this.getTableCellStyleByName(e.styleName)||this.addTableCellStyleCore(e):null}addTableStyleCore(e){var t=e.clone();return this.tableStyleNameToIndex[t.styleName]=this.documentModel.tableStyles.push(t)-1,b.j.forEach(e.conditionalStyles,((e,r)=>t.conditionalStyles[r]=this.cloneTableConditionalStyle(e))),t}addTableCellStyleCore(e){var t=e.clone();return this.tableCellStyleNameToIndex[t.styleName]=this.documentModel.tableCellStyles.push(t)-1,t.characterProperties=this.documentModel.cache.mergedCharacterPropertiesCache.getItem(e.characterProperties),t.tableCellProperties=this.documentModel.cache.tableCellPropertiesCache.getItem(e.tableCellProperties),t}cloneTableConditionalStyle(e){let t=e.maskedCharacterProperties;return t.fontInfo&&void 0===t.fontInfo.measurer&&(t.fontInfo=this.documentModel.cache.fontInfoCache.getItemByName(t.fontInfo.name)),new Xl(e.tableProperties.clone(),this.documentModel.cache.tableRowPropertiesCache.getItem(e.tableRowProperties),this.documentModel.cache.tableCellPropertiesCache.getItem(e.tableCellProperties),this.documentModel.cache.maskedParagraphPropertiesCache.getItem(e.maskedParagraphProperties),this.documentModel.cache.maskedCharacterPropertiesCache.getItem(t),e.tabs.clone())}addCharacterStyleCore(e){var t=e.clone();this.registerCharacterStyle(t);let r=e.maskedCharacterProperties;return r.fontInfo&&void 0===r.fontInfo.measurer&&(r.fontInfo=this.documentModel.cache.fontInfoCache.getItemByName(r.fontInfo.name)),t.maskedCharacterProperties=this.documentModel.cache.maskedCharacterPropertiesCache.getItem(r),t.parent=this.addCharacterStyle(e.parent),t.linkedStyle=this.addParagraphStyle(e.linkedStyle),t}addParagraphStyleCore(e){var t=e.clone();this.registerParagraphStyle(t);let r=e.maskedCharacterProperties;return r.fontInfo&&void 0===r.fontInfo.measurer&&(r.fontInfo=this.documentModel.cache.fontInfoCache.getItemByName(r.fontInfo.name)),t.maskedCharacterProperties=this.documentModel.cache.maskedCharacterPropertiesCache.getItem(r),t.maskedParagraphProperties=this.documentModel.cache.maskedParagraphPropertiesCache.getItem(e.maskedParagraphProperties),t.linkedStyle=this.addCharacterStyle(e.linkedStyle),t.parent=this.addParagraphStyle(e.parent),t}getDefaultStyleCore(e,t){for(var r,i=0;r=e[i];i++)if(r.isDefault)return t(r),r}static getPresetCharacterStyleLocalizedName(e){const t=this.getStyleByNameCore(e,this.presetCharacterStyles,this.presetCharacterStyleNameToIndex);return t&&t.localizedName?t.localizedName:e}static getPresetParagraphStyleLocalizedName(e){const t=this.getStyleByNameCore(e,this.presetParagraphStyles,this.presetParagraphStyleNameToIndex);return t&&t.localizedName?t.localizedName:e}static getPresetTableStyleLocalizedName(e){const t=this.getStyleByNameCore(e,this.presetTableStyles,this.presetTableStyleNameToIndex);return t&&t.localizedName?t.localizedName:e}static getPresetCharacterStyleByName(e,t=!1){return this.getStyleByNameCore(e,this.presetCharacterStyles,this.presetCharacterStyleNameToIndex,t)}static getPresetParagraphStyleByName(e,t=!1){return this.getStyleByNameCore(e,this.presetParagraphStyles,this.presetParagraphStyleNameToIndex,t)}static getPresetTableStyleByName(e,t=!1){return this.getStyleByNameCore(e,this.presetTableStyles,this.presetTableStyleNameToIndex,t)}static populateGalleryHeaders(e){Wh.characterStylesGalleryTitle=e[us.Character],Wh.paragraphStylesGalleryTitle=e[us.Paragraph],Wh.tableStylesGalleryTitle=e[us.Table]}static populatePresetStyles(e){if(Wh.presetCharacterStyles.length)return;const t=e[hs.Character],r=e[hs.Paragraph],i=e[hs.Table],n=new uo,o=new Uh(n,e[hs.Caches],null);_n.fillDefaultFonts(n.fontInfoCache),Wh.populatePresetCharacterStyles(t,n),Wh.populatePresetParagraphStyles(r,n),Wh.populatePresetTableStyles(i,n);for(let e,r=0;e=Wh.presetCharacterStyles[r];r++){const i=t[r];e.parent=Wh.getPresetCharacterStyleByName(i[ps.ParentStyleName]);const n=i[gs.LinkedStyleName];void 0!==n&&(e.linkedStyle=Wh.getPresetParagraphStyleByName(n))}for(let e,t=0;e=Wh.presetParagraphStyles[t];t++){const i=r[t];e.parent=Wh.getPresetParagraphStyleByName(i[ps.ParentStyleName]);const n=i[ms.LinkedStyleName];void 0!==n&&(e.linkedStyle=Wh.getPresetCharacterStyleByName(n));const o=i[ms.NextParagraphStyleName];void 0!==o&&(e.nextParagraphStyle=Wh.getPresetParagraphStyleByName(o))}for(let e,t=0;e=Wh.presetTableStyles[t];t++)e.parent=Wh.getPresetTableStyleByName(i[t][ps.ParentStyleName]);o.dispose()}static populatePresetCharacterStyles(e,t){if(Wh.presetCharacterStyles=[],e)for(let r of e){const e=r[ps.StyleName];Wh.presetCharacterStyles.push(new zl(e,Wh.presetStylesLocalizedNames[e]||r[ps.LocalizedStyleName],!!r[ps.Deleted],!!r[ps.Hidden],!!r[ps.Semihidden],!!r[ps.IsDefault],t.maskedCharacterPropertiesCache.getItemByJsonKey(r[gs.CharacterPropertiesCacheIndex]),r[ps.Base64EncodedImage]))}}static populatePresetParagraphStyles(e,t){if(Wh.presetParagraphStyles=[],e)for(let r of e){const e=r[ps.StyleName];Wh.presetParagraphStyles.push(new es(e,Wh.presetStylesLocalizedNames[e]||r[ps.LocalizedStyleName],!!r[ps.Deleted],!!r[ps.Hidden],!!r[ps.Semihidden],!!r[ps.IsDefault],t.maskedCharacterPropertiesCache.getItemByJsonKey(r[ms.CharacterPropertiesCacheIndex]),t.maskedParagraphPropertiesCache.getItemByJsonKey(r[ms.ParagraphPropertiesCacheIndex]),jl.convertFromJSONToTabProperties(r[ms.Tabs]),!!r[ms.AutoUpdate],r[ms.NumberingListIndex],r[ms.ListLevelIndex],r[ps.Base64EncodedImage]))}}static populatePresetTableStyles(e,t){if(Wh.presetTableStyles=[],e)for(let r of e){const e=r[ps.StyleName];Wh.presetTableStyles.push(new Vh(e,Wh.presetStylesLocalizedNames[e]||r[ps.LocalizedStyleName],!!r[ps.Deleted],!!r[ps.Hidden],!!r[ps.Semihidden],!!r[ps.IsDefault],Yl.convertStylesFromJSON(r[bs.ConditionalStyles],t),Yl.convertFromJSON(r[bs.BaseConditionalStyle],t),r[ps.Base64EncodedImage]))}}static getStyleByNameCore(e,t,r,i=!1){var n=r[e];if(void 0===n){for(var o,a=0;o=t[a];a++)if(void 0===r[o.styleName]&&(r[o.styleName]=a),this.compareNames(o.styleName,e,i))return o;return null}return t[n]}static compareNames(e,t,r){return!(e&&!t||!e&&t)&&(e===t||!!r&&e.toLowerCase()===t.toLowerCase())}clone(e){const t=new Wh(e),r=e=>f.ListUtils.map(e,(e=>({value:e.value,text:e.text,data:e.data})));return t.characterAndParagraphStyleGalleryItems=[r(this.characterAndParagraphStyleGalleryItems[0]),r(this.characterAndParagraphStyleGalleryItems[1])],t.documentModel=e,t.characterStyleNameToIndex=B.StringMapUtils.shallowCopy(this.characterStyleNameToIndex),t.paragraphStyleNameToIndex=B.StringMapUtils.shallowCopy(this.paragraphStyleNameToIndex),t.numberingListStyleNameToIndex=B.StringMapUtils.shallowCopy(this.numberingListStyleNameToIndex),t.tableStyleNameToIndex=B.StringMapUtils.shallowCopy(this.tableStyleNameToIndex),t.tableCellStyleNameToIndex=B.StringMapUtils.shallowCopy(this.tableCellStyleNameToIndex),t}}Wh.characterPrefix="",Wh.paragraphPrefix="¶",Wh.characterStylesGalleryTitle="Character Styles",Wh.paragraphStylesGalleryTitle="Paragraph Styles",Wh.tableStylesGalleryTitle="Table Styles",Wh.presetStylesLocalizedNames={},Wh.presetCharacterStyleNameToIndex={},Wh.presetParagraphStyleNameToIndex={},Wh.presetTableStyleNameToIndex={},Wh.presetCharacterStyles=[],Wh.presetParagraphStyles=[],Wh.presetTableStyles=[];class zh{constructor(e,t,r,i,n=0){this.chunkIndex=e,this.chunk=t,this.runIndex=r,this.run=i,this.charOffset=n}getAbsoluteRunPosition(){return this.chunk.startLogPosition.value+this.run.startOffset}getAbsolutePosition(){return this.getAbsoluteRunPosition()+this.charOffset}getAbsoluteEndRunPosition(){return this.getAbsoluteRunPosition()+this.run.getLength()}getCurrentChar(){return this.chunk.textBuffer[this.run.startOffset+this.charOffset]}getRunText(e=0,t=this.run.getLength()){return this.chunk.textBuffer.substr(this.run.startOffset+e,t)}}class jh extends zh{constructor(e,t){super(-1,null,-1,null,0),this.subDocument=e,this.chunks=e.chunks,this.ignoreHiddenRuns=t}setPositionByFullRunInfo(e){this.run&&this.getAbsolutePosition()==e.getAbsolutePosition()||(this.chunkIndex=e.chunkIndex,this.chunk=e.chunk,this.runs=this.chunk.textRuns,this.runIndex=e.runIndex,this.run=e.run,this.charOffset=e.charOffset,this.ignoreHiddenRuns&&this.run.getCharacterMergedProperties().hidden&&this.moveToNextRun())}setPosition(e){if(!this.run||this.getAbsolutePosition()!=e){this.chunkIndex=C.SearchUtils.normedInterpolationIndexOf(this.chunks,(e=>e.startLogPosition.value),e),this.chunk=this.chunks[this.chunkIndex];var t=e-this.chunk.startLogPosition.value;this.runs=this.chunk.textRuns,this.runIndex=C.SearchUtils.normedInterpolationIndexOf(this.runs,(e=>e.startOffset),t),this.run=this.runs[this.runIndex],this.charOffset=t-this.run.startOffset,this.ignoreHiddenRuns&&this.run.getCharacterMergedProperties().hidden&&this.moveToNextRun()}}moveToNextChar(){return this.charOffset+1<this.run.getLength()?(this.charOffset++,!0):this.moveToNextRun()}moveToPrevChar(){return this.charOffset>0?(this.charOffset--,!0):this.moveToPrevRun()}moveToNextRun(){return this.runIndex+1<this.runs.length?(this.charOffset=0,this.runIndex++,this.run=this.runs[this.runIndex],!this.ignoreHiddenRuns||!this.run.getCharacterMergedProperties().hidden||this.moveToNextRun()):this.chunkIndex+1<this.chunks.length&&(this.charOffset=0,this.runIndex=0,this.chunkIndex++,this.chunk=this.chunks[this.chunkIndex],this.runs=this.chunk.textRuns,this.run=this.runs[this.runIndex],!this.ignoreHiddenRuns||!this.run.getCharacterMergedProperties().hidden||this.moveToNextRun())}moveToPrevRun(){return this.runIndex>0?(this.runIndex--,this.run=this.runs[this.runIndex],this.charOffset=this.run.getLength()-1,!this.ignoreHiddenRuns||!this.run.getCharacterMergedProperties().hidden||this.moveToPrevRun()):this.chunkIndex>0&&(this.chunkIndex--,this.chunk=this.chunks[this.chunkIndex],this.runs=this.chunk.textRuns,this.runIndex=this.runs.length-1,this.run=this.runs[this.runIndex],this.charOffset=this.run.getLength()-1,!this.ignoreHiddenRuns||!this.run.getCharacterMergedProperties().hidden||this.moveToPrevRun())}clone(){var e=new jh(this.subDocument,this.ignoreHiddenRuns);return e.chunks=this.chunks,e.chunk=this.chunk,e.chunkIndex=this.chunkIndex,e.runs=this.runs,e.run=this.run,e.runIndex=this.runIndex,e.charOffset=this.charOffset,e}}class Xh{static getWordStartPosition(e,t){return Xh.getWordStartPositionByCharCondition(e,t,(e=>an.isWhitespace.test(e)))}static getWordStartPositionByCharCondition(e,t,r){let i=new jh(e,!0);for(i.setPosition(t);i.moveToPrevChar();){let e=i.getCurrentChar(),t=i.run.getType();if(r(e)||t==cs.ParagraphRun||t==cs.SectionRun)return i.getAbsolutePosition()+1}return i.getAbsolutePosition()}static getPrevWordStartPosition(e,t){let r=new jh(e,!0);r.setPosition(t);let i=!1,n=!1;for(;r.moveToPrevChar();){let e=r.getCurrentChar(),t=r.run.getType();if(an.isWhitespace.test(e)&&n||t==cs.ParagraphRun||t==cs.SectionRun)return r.getAbsolutePosition()+1;an.isWhitespace.test(e)?i=!0:i&&(n=!0)}return r.getAbsolutePosition()}static getNextWordEndPosition(e,t){let r=new jh(e,!0);r.setPosition(t);let i=!1,n=!1;do{let e=r.getCurrentChar(),t=r.run.getType();if(an.isWhitespace.test(e)&&n||t==cs.ParagraphRun||t==cs.SectionRun)return r.getAbsolutePosition()-1;an.isWhitespace.test(e)?i=!0:i&&(n=!0)}while(r.moveToNextChar());return r.getAbsolutePosition()}}class Gh extends on.FixedInterval{setStart(e){this.start=e,this.onChanged()}setLength(e){this.length=e,this.onChanged()}onChanged(){}}class Kh extends Gh{constructor(e,t,r=!0){super(e,t),this.info=new qh(r)}onChanged(){this.info.isChecking=!1}}class qh{constructor(e){this.isSplitted=e,this.isChecking=!1}}class $h extends Gh{constructor(e,t,r){super(e,t),this.errorInfo=r}}class Jh extends Gh{constructor(e,t,r){super(e,t),this.word=r}}class Yh{constructor(e,t){this.misspelledIntervalsChangesListener=e,this.settings=t}dispose(){clearTimeout(this.checkCoreId)}initialize(e){this.subDocument=e,this.intervalsManager=e.spellCheckerIntervalsManager}processResponse(e){this.intervalsManager.applyCheckResults(e),this.updateMisspelledBoxes(),this.checkCore()}check(){this.settings.isEnabled&&(this.checkCoreId=setTimeout((()=>{this.checkCore()}),0))}getSelectedMisspelledInterval(e){return this.intervalsManager.getSelectedMisspelledInterval(e)}findNextMisspelledInterval(e){return this.intervalsManager.findNextMisspelledInterval(e)}ignore(e){this.intervalsManager.addIgnoredInterval(e.start,e.end,e.errorInfo.word),this.intervalsManager.deleteMisspelledIntervalsByPositions(e.start,e.end),this.updateMisspelledBoxes()}ignoreAll(e){this.intervalsManager.ignoreAll(e.errorInfo.word),this.updateMisspelledBoxes()}addWord(e){let t=e.errorInfo.word;this.intervalsManager.removeIntervalsWithErrorByWord(t),this.updateMisspelledBoxes(),this.sendAddWordRequest(t)}getIntervalsWithErrorByWord(e){return this.intervalsManager.getIntervalsWithErrorByWord(e)}isInProgress(){return this.intervalsManager.getUncheckedIntervalsCount()>0}getMisspelledIntervals(){return this.intervalsManager.getMisspelledIntervals()}onModelIntervalChanged(e,t,r){this.settings.isEnabled&&this.intervalsManager.onModelIntervalChanged(e,t,r)}onCurrentSelectedWordChanged(){this.check()}onLayoutChanged(){this.updateMisspelledBoxes()}checkCore(){this.intervalsManager.initializeUncheckedIntervals();const e=this.intervalsManager.getIntervalsToCheck();e.length>0&&this.sendCheckSpellingRequest(e)}updateMisspelledBoxes(){this.settings.isEnabled&&this.misspelledIntervalsChangesListener.setMisspelledSelectionIntervals(this.getMisspelledIntervals())}}!function(e){e[e.Unknown=0]="Unknown",e[e.Misspelling=1]="Misspelling",e[e.Repeating=2]="Repeating",e[e.Syntax=3]="Syntax"}(Wc||(Wc={}));class Qh{constructor(e,t,r){this.errorType=e,this.suggestions=t,this.word=r}}class Zh{constructor(){this.intervals=[]}getIntervals(){return this.intervals}add(e){let t=this.intervals.length;for(;t>0&&!(this.intervals[t-1].start<e.start);)t--;this.intervals.splice(t,0,e)}remove(e){this.intervals.splice(e,1)}onModelIntervalChanged(e,t,r){t>0?this.onModelIntervalInserted(e,t,r):this.onModelIntervalRemoved(e,-t)}onModelIntervalInserted(e,t,r){this.forEach((r=>{r.start>e?r.setStart(r.start+t):r.end>=e&&r.setLength(r.length+t)}))}onModelIntervalRemoved(e,t){let r=new on.FixedInterval(e,t);this.forEach(((e,t)=>{r.containsInterval(e)?this.remove(t):r.start<e.start?(e.setLength(e.length-Math.max(0,r.end-e.start)),e.setStart(e.start-Math.min(r.length,e.start-r.start))):e.end>r.start&&e.setLength(e.length-Math.min(r.length,e.end-r.start))}))}forEach(e){let t=this.intervals.length;for(;--t>=0;)e(this.intervals[t],t)}deleteIntervalsByPositions(e,t,r=!1){const i=on.FixedInterval.fromPositions(e,t);r?f.ListUtils.anyOf(this.intervals,((e,t)=>{const r=i.equals(e);return r&&this.remove(t),r})):this.forEach(((e,t)=>{const r=nn.IntervalAlgorithms.getIntersection(e,i);r&&r.length>0&&this.remove(t)}))}findIntervalIndexByPositions(e,t){return f.ListUtils.indexBy(this.intervals,(r=>r.start==e&&r.end==t))}clear(){this.intervals=[]}}class eu extends Zh{findCheckingIntervalByPositions(e,t){const r=this.findIntervalIndexByPositions(e,t);return r>=0&&this.intervals[r].info.isChecking?this.intervals[r]:null}onModelIntervalInserted(e,t,r){let i=!1,n=!1;this.forEach((t=>{t.containsWithIntervalEnd(e)&&(i=!0,r&&t.end==e?n=!0:t.info.isSplitted=!1)})),n||super.onModelIntervalInserted(e,t,r),i||this.add(new Kh(e,t,!1))}onModelIntervalRemoved(e,t){let r=new on.FixedInterval(e,t),i=!1;this.forEach((e=>{nn.IntervalAlgorithms.getIntersection(e,r)&&(i=!0)})),super.onModelIntervalRemoved(e,t),i||this.add(new Kh(e,1))}}class tu extends Zh{addIfNotExists(e){this.findIntervalIndexByPositions(e.start,e.end)<0&&this.add(e)}findNext(e){for(let t,r=0;t=this.intervals[r];r++)if(t.end>=e)return t;return this.intervals[0]?this.intervals[0]:null}deleteOldIntervals(e,t){this.forEach(((r,i)=>{const n=nn.IntervalAlgorithms.getIntersection(r,e);n&&n.length>0&&(t||r.start!==e.start||r.errorInfo.errorType!==Wc.Repeating)&&this.remove(i)}))}}class ru extends Zh{contains(e,t,r){const i=this.findIntervalIndexByPositions(e,e+t);return i>=0&&this.intervals[i].word==r}}class iu{constructor(){this.ignoredWords=[]}add(e){this.contains(e)||this.ignoredWords.push(e)}contains(e){return-1!==this.ignoredWords.indexOf(e)}clear(){this.ignoredWords=[]}}class nu{constructor(e){this.subDocument=e,this.uncheckedIntervalCollection=new eu,this.misspelledIntervalCollection=new tu,this.ignoredIntervalCollection=new ru,this.ignoredWordsCollection=new iu,this.isInitialize=!1}initializeUncheckedIntervals(){this.isInitialize||(this.createUncheckedIntervals(0,this.subDocument.getDocumentEndPosition()),this.isInitialize=!0)}reset(){this.uncheckedIntervalCollection.clear(),this.misspelledIntervalCollection.clear(),this.ignoredIntervalCollection.clear(),this.ignoredWordsCollection.clear(),this.isInitialize=!1}getIntervalsToCheck(){this.splitUncheckedIntervals();let e=[],t=0,r=this.uncheckedIntervalCollection.getIntervals();const i=this.subDocument.documentModel.modelOptions.maxSpellRequestLength;for(let n,o=0;n=r[o];o++){if(n.info.isChecking||t>i)return this.removeEmptyUncheckedIntervals(o),e;this.expandUncheckedInterval(n),n.length>0&&(this.prepareUncheckedInterval(n),n.info.isChecking=!0,t+=n.length,e.push(n))}return this.removeEmptyUncheckedIntervals(),e}applyCheckResults(e){for(let t,r=0;t=e[r];r++){const e=t[Q.StartPosition],r=t[Q.EndPosition],i=this.uncheckedIntervalCollection.findCheckingIntervalByPositions(e,r);if(i){let n=e===Xh.getPrevWordStartPosition(this.subDocument,e);this.misspelledIntervalCollection.deleteOldIntervals(i,n),this.createMisspelledIntervals(t[Q.SpellingErrors],i),this.uncheckedIntervalCollection.deleteIntervalsByPositions(e,r,!0)}}}onModelIntervalChanged(e,t,r){this.uncheckedIntervalCollection.onModelIntervalChanged(e,t,r),this.misspelledIntervalCollection.onModelIntervalChanged(e,t,r),this.ignoredIntervalCollection.onModelIntervalChanged(e,t,r)}getMisspelledIntervals(){return this.misspelledIntervalCollection.getIntervals()}getUncheckedIntervalsCount(){return this.uncheckedIntervalCollection.getIntervals().length}getSelectedMisspelledInterval(e){let t=null;return this.misspelledIntervalCollection.forEach((r=>{const i=new on.FixedInterval(r.start,r.length);Md.correctIntervalDueToFieldsWithoutUiChecks(this.subDocument,i),i.containsInterval(e[0])&&(t=r)})),t}findNextMisspelledInterval(e){return this.misspelledIntervalCollection.findNext(e)}addIgnoredInterval(e,t,r){this.ignoredIntervalCollection.add(new Jh(e,t,r))}deleteMisspelledIntervalsByPositions(e,t){this.misspelledIntervalCollection.deleteIntervalsByPositions(e,t)}ignoreAll(e){this.ignoredWordsCollection.add(e),this.misspelledIntervalCollection.forEach(((t,r)=>{t.errorInfo.word==e&&t.errorInfo.errorType==Wc.Misspelling&&this.misspelledIntervalCollection.remove(r)}))}removeIntervalsWithErrorByWord(e){this.misspelledIntervalCollection.forEach(((t,r)=>{t.errorInfo.word==e&&t.errorInfo.errorType==Wc.Misspelling&&this.misspelledIntervalCollection.remove(r)}))}getIntervalsWithErrorByWord(e){let t=[];return this.misspelledIntervalCollection.forEach((r=>{r.errorInfo.word==e&&r.errorInfo.errorType==Wc.Misspelling&&t.push(new on.FixedInterval(r.start,r.length))})),t}expandUncheckedInterval(e){let t=Xh.getPrevWordStartPosition(this.subDocument,e.start),r=Xh.getNextWordEndPosition(this.subDocument,e.end);e.start=t,e.length=Math.max(0,r-t)}removeEmptyUncheckedIntervals(e=this.uncheckedIntervalCollection.getIntervals().length){this.uncheckedIntervalCollection.forEach(((t,r)=>{e<r&&0==t.length&&this.uncheckedIntervalCollection.remove(r)}))}prepareUncheckedInterval(e){let t=new jh(this.subDocument,!1),r="",i=[],n=0,o=0,a=0,s=!1;t.setPosition(e.start);do{t.run.getCharacterMergedProperties().hidden||t.run.getType()===cs.FieldCodeStartRun||0!==a?(n++,s=!0,t.run.getType()==cs.FieldCodeStartRun&&a++,t.run.getType()==cs.FieldResultEndRun&&a--):(r+=t.getCurrentChar(),s&&(i.push(new on.FixedInterval(o,n)),n=0,s=!1),o++)}while(t.getAbsolutePosition()<e.end&&t.moveToNextChar());e.info.textToCheck=r,e.info.hiddenIntervals=i}createUncheckedIntervals(e,t){let r=0,i=new jh(this.subDocument,!0);i.setPosition(e);do{if(i.run.getType()==cs.ParagraphRun){let t=i.getAbsolutePosition(),n=t-e;n>0&&(this.uncheckedIntervalCollection.add(new Kh(e,n)),r++),e=t+1}}while(i.getAbsolutePosition()<t&&i.moveToNextRun());0==r&&t>e&&this.uncheckedIntervalCollection.add(new Kh(e,t-e))}splitUncheckedIntervals(){let e=this.uncheckedIntervalCollection.getIntervals();const t=this.subDocument.documentModel.modelOptions.maxSpellRequestLength;for(let r,i=0;r=e[i];i++){if(r.info.isChecking)return;if(!r.info.isSplitted)if(r.length>t){const e=r.start,t=r.end;this.uncheckedIntervalCollection.remove(i),this.createUncheckedIntervals(e,t)}else r.info.isSplitted=!0}}createMisspelledIntervals(e,t){for(let r,i=0;r=e[i];i++){let e=r[Q.ErrorStart]+t.start,i=r[Q.ErrorLength];for(let n,o=0;n=t.info.hiddenIntervals[o];o++)r[Q.ErrorStart]>n.start?e+=n.length:n.start<r[Q.ErrorStart]+r[Q.ErrorLength]&&(i+=n.length);const n=r[Q.ErrorWord];if(!(this.ignoredIntervalCollection.contains(e,i,n)||this.ignoredWordsCollection.contains(n)&&r[Q.ErrorType]==Wc.Misspelling)){const t=new Qh(r[Q.ErrorType],r[Q.Suggestions],n),o=new $h(e,i,t);this.misspelledIntervalCollection.addIfNotExists(o)}}}}class ou{constructor(e,t,r,i,n){this.currentRun=null,this.currentChunk=null,this.currentSection=null,this.runs=[],this.chunks=[],this.sections=[],this.currentRunIndex=0,this.currentChunkIndex=0,this.currentSectionIndex=0,this.indexForChunks=[],this.indexForSections=[],this.runs=e,this.chunks=t,this.sections=r,this.indexForChunks=i,this.indexForSections=n}moveNext(){return this.currentRun=this.runs[this.currentRunIndex],this.currentRun?(this.currentChunk=this.chunks[this.currentChunkIndex],this.currentSection=this.sections[this.currentSectionIndex],this.currentRunIndex==this.indexForChunks[this.currentChunkIndex]&&this.currentChunkIndex++,this.currentRunIndex==this.indexForSections[this.currentSectionIndex]&&this.currentSectionIndex++,this.currentRunIndex++,!0):(this.currentChunk=void 0,this.currentSection=void 0,!1)}currentInterval(){return this.currentRun?new on.FixedInterval(this.currentChunk.startLogPosition.value+this.currentRun.startOffset,this.currentRun.getLength()):new on.FixedInterval(this.chunks[0].startLogPosition.value+this.runs[0].startOffset,this.runs[0].getLength())}getFirstRun(){return this.runs[0]}getLastRun(){return this.runs[this.runs.length-1]}getRunsCount(){return this.runs.length}reset(){this.currentRunIndex=0,this.currentChunkIndex=0,this.currentSectionIndex=0}}class au{constructor(e,t,r=!1){this.subDocumentId=e,this.bkmTempate=t,this.deleted=r,this.type=pd.BookmarkCreated}toJSON(e){return this.deleted?[[this.bkmTempate.name]]:[[this.bkmTempate.name,this.bkmTempate.start,this.bkmTempate.end]]}}class su{constructor(e,t,r=!1){this.subDocumentId=e,this.bkmTempate=t,this.deleted=r,this.type=pd.BookmarkDeleted}toJSON(e){return this.deleted?[[this.bkmTempate.name]]:[[this.bkmTempate.name,this.bkmTempate.start,this.bkmTempate.end]]}}class lu{get history(){return this.modelManipulator.modelManager.history}get model(){return this.modelManipulator.modelManager.model}constructor(e){this.modelManipulator=e}}class du extends lu{createBookmark(e,t,r){e.bookmarks.push(new Cd(e.positionManager,t,t.name)),r&&(e.bookmarks=e.bookmarks.sort(Sd.comparer)),this.modelManipulator.notifyModelChanged(new au(e.id,t))}deleteBookmark(e,t,r=f.ListUtils.indexBy(e.bookmarks,(e=>e.constBookmark.equals(t)))){e.bookmarks.splice(r,1)[0].destructor(e.positionManager),this.modelManipulator.notifyModelChanged(new su(e.id,t))}static findBookmark(e,t){let r;const i=b.j.elementBy(e,(e=>!!(r=f.ListUtils.elementBy(e.bookmarks,(e=>e.name==t)))));return i?new Id(r,i):null}static copyBookmarksFromSubDocumentTo(e,t,r){let i=[];nn.IntervalAlgorithms.handleAffectedObjects(e.bookmarks,nn.IntervalAlgorithms.getMergedIntervalsTemplate(r,!0,new Cn.e(0,0)),((e,t,r,n)=>{(n.length||0==e.interval.length)&&i.push(new Sd(new Cn.e(e.start-r.start,e.end-r.start),e.name))}),du.findBookmarkStartIndex),t.bookmarks=f.ListUtils.map(f.ListUtils.unique(i,Sd.comparer,Sd.comparer),(e=>e.createBookmark(t.positionManager)))}deleteBookmarks(e,t){const r=e.bookmarks,i=[];let n=C.SearchUtils.normedInterpolationIndexOf(r,(e=>e.start),t.start);for(;r[n]&&r[n].start>=t.start;)n--;n=Math.max(0,n);for(let o;(o=r[n])&&o.interval.start<=t.end;)if(t.containsInterval(o.interval)){const t=o.constBookmark;this.deleteBookmark(e,t,n),i.push(t)}else n++;return i}insertBookmarksFromSubDocument(e,t,r,i){const n=e.bookmarks;let o=C.SearchUtils.normedInterpolationIndexOf(n,(e=>e.start),r.start);for(;n[o]&&n[o].start>=r.start;)o--;o=Math.max(0,o);for(let e;(e=n[o])&&e.start<=r.end;o++)if(r.containsInterval(e.interval)){const r=e.constBookmark;r.interval.start+=i,r.interval.end+=i,this.createBookmark(t,r,!1)}t.bookmarks=t.bookmarks.sort(Sd.comparer)}static findBookmarkStartIndex(e,t){return 0}}class cu{constructor(e){this.value=e,this.refCount=0}incRefCount(){++this.refCount}decRefCount(){--this.refCount}hasReference(){return this.refCount>0}}class hu{constructor(){this.notLoadedPicturePositions=[],this.positions=[]}registerSpecRunPosition(e){return this.specRunPosition=new cu(e),this.specRunPosition}unregisterSpecRunPosition(){this.specRunPosition=null}registerNotLoadedPicturePosition(e){return this.registerPositionCore(e,this.notLoadedPicturePositions)}registerPosition(e){return this.registerPositionCore(e,this.positions)}registerPositionCore(e,t){var r=C.SearchUtils.binaryIndexOf(t,(t=>t.value-e));if(r>=0){var i=t[r];return i.incRefCount(),i}var n=~r,o=new cu(e);return o.incRefCount(),t.splice(n,0,o),o}unregisterPosition(e){this.unregisterPositionCore(e,this.positions)}unregisterNotLoadedPicturePosition(e){this.unregisterPositionCore(e,this.notLoadedPicturePositions)}unregisterPositionCore(e,t){var r=this.findPosition(e,t);if(null==r)throw new Error("PositionManager unregisterPosition: unregister nonexisted Position");var i=t[r];i.decRefCount(),i.hasReference()||t.splice(r,1)}findPosition(e,t){var r=C.SearchUtils.binaryIndexOf(t,(t=>t.value-e.value));if(r>=0){var i;for(i=r;i>=0&&t[i].value==e.value;i--)if(t[i]==e)return i;var n=t.length;for(i=r+1;i<n&&t[i].value==e.value;i++)if(t[i]==e)return i}return null}reset(){this.positions=[],this.notLoadedPicturePositions=[]}advance(e,t,r=0){(0,S.isDefined)(this.specRunPosition)&&this.specRunPosition.value>=e&&(this.specRunPosition.value+=t),this.advanceCore(e+r,this.positions,t),this.advanceCore(e,this.notLoadedPicturePositions,t)}advanceCore(e,t,r){var i=C.SearchUtils.binaryIndexOf(t,(t=>t.value-e)),n=i>=0?i:~i,o=t.length;if(!(n>=o)){var a;for(i>=0&&(n=this.correctPositionIndex(e,t,r,n)),a=n;a<o;a++)t[a].value+=r;if(r<0&&n<o&&n>=0)for(a=n;a<o&&t[a].value<e;a++)t[a].value=e}}correctPositionIndex(e,t,r,i){if(r<0)for(;i<t.length&&t[i].value==e;)i++;else for(;i>0&&t[i-1].value==t[i].value;)i--;return i}}class uu{constructor(e,t){this.chunks=[],this.paragraphs=[],this.fields=[],this.tables=[],this.tablesByLevels=[],this.positionManager=new hu,this.fieldsWaitingForUpdate=null,this.bookmarks=[],this.rangePermissions=[],this.availableRangePermissions=[],this.documentModel=e,this.id=t.subDocumentId,this.info=t,e.subDocumentsCollection.add(this),this.spellCheckerIntervalsManager=new nu(this)}get interval(){return new on.FixedInterval(0,this.getDocumentEndPosition())}getLastChunk(){return this.chunks[this.chunks.length-1]}getFirstChunk(){return this.chunks[0]}getLastParagraph(){return this.paragraphs[this.paragraphs.length-1]}getFirstParagraph(){return this.paragraphs[0]}getText(e=new on.FixedInterval(0,this.getDocumentEndPosition())){for(var t="",r=C.SearchUtils.normedInterpolationIndexOf(this.chunks,(e=>e.startLogPosition.value),e.start),i=this.chunks[r],n=e.length,o=e.start-i.startLogPosition.value;i;){var a=Math.min(i.textBuffer.length-o,n);if(t+=i.textBuffer.substr(o,a),0===(n-=a))break;i=this.chunks[++r],o=0}return t}getSimpleText(e){let t="",r=e.start,i=0;const n=Md.normedBinaryIndexOf(this.fields,r);if(n>-1){let e=this.fields[n];for(;e.parent;)e=e.parent;r=e.getFieldStartPosition()}const o=new jh(this,!0);for(o.setPosition(r);r<e.end;){switch(o.run.getType()){case cs.FieldCodeStartRun:i++;break;case cs.FieldCodeEndRun:i--;break;case cs.TextRun:r>=e.start&&0==i&&(t+=o.getCurrentChar())}if(!o.moveToNextChar())break;r=o.getAbsolutePosition()}return t.replace(an.specialCharacters.LineBreak," ")}splitRun(e){var t=this.getRunAndIndexesByPosition(e),r=e-(t.chunk.startLogPosition.value+t.run.startOffset);r>0&&t.chunk.splitRun(t.runIndex,r)}getLastRun(){var e=this.getLastChunk();return e.textRuns[e.textRuns.length-1]}getFirstRun(){return this.chunks[0].textRuns[0]}getRunIterator(e){return this.getRunIteratorInternal(e,!1)}getConstRunIterator(e){return this.getRunIteratorInternal(e,!0)}getRunIteratorInternal(e,t){if(0==e.length)return new ou([],[],[],[1],[1]);var r=[],i=[],n=[],o=[],a=[],s=C.SearchUtils.normedInterpolationIndexOf(this.chunks,(e=>e.startLogPosition.value),e.start),l=this.chunks[s];i.push(l);var d=C.SearchUtils.normedInterpolationIndexOf(l.textRuns,(e=>l.startLogPosition.value+e.startOffset),e.start),c=l.textRuns[d],h=e.length;l.startLogPosition.value+c.startOffset<e.start&&(t?h+=e.start-(l.startLogPosition.value+c.startOffset):(l.splitRun(d,e.start-(l.startLogPosition.value+c.startOffset)),d++));var u=C.SearchUtils.normedInterpolationIndexOf(this.documentModel.sections,(e=>e.startLogPosition.value),e.start),p=this.documentModel.sections[u];n.push(p);for(var g=0,m=0,f=p.startLogPosition.value+p.getLength()-e.start;c=l.textRuns[d];){if(0===f&&this.isMain()&&(u++,p=this.documentModel.sections[u],n.push(p),a.push(m-1),f=p.getLength()),c.getLength()>h){t?r.push(c.createSimularity(Math.max(c.startOffset,e.start-l.startLogPosition.value),Math.min(h,e.length),c.paragraph,c.characterStyle,c.maskedCharacterProperties)):(l.splitRun(d,h),r.push(c));break}if(0==g&&t&&c.startOffset+l.startLogPosition.value<e.start){var b=l.startLogPosition.value+c.startOffset+c.getLength()-e.start;r.push(c.createSimularity(e.start-l.startLogPosition.value,b,c.paragraph,c.characterStyle,c.maskedCharacterProperties)),f-=b}else r.push(c),f-=c.getLength();if(d++,!(h-=c.getLength()))break;d==l.textRuns.length&&(s++,o.push(g),l=this.chunks[s],i.push(l),d=0),m++,g++}return o.push(g+1),a.push(m+1),new ou(r,i,n,o,a)}getRunsByInterval(e){for(var t,r=[],i=C.SearchUtils.normedInterpolationIndexOf(this.chunks,(e=>e.startLogPosition.value),e.start),n=this.chunks[i],o=C.SearchUtils.normedInterpolationIndexOf(n.textRuns,(e=>n.startLogPosition.value+e.startOffset),e.start),a=e.length,s=e.start-n.textRuns[o].startOffset-n.startLogPosition.value;n&&(t=n.textRuns[o])&&(r.push(t),!((a-=t.getLength()-s)<=0));)++o>=n.textRuns.length&&(o=0,i++,n=this.chunks[i]),s=0;return r}getRunByPosition(e){var t=C.SearchUtils.normedInterpolationIndexOf(this.chunks,(e=>e.startLogPosition.value),e),r=this.chunks[t],i=C.SearchUtils.normedInterpolationIndexOf(r.textRuns,(e=>r.startLogPosition.value+e.startOffset),e);return r.textRuns[i]}getRunAndIndexesByPosition(e){const t=C.SearchUtils.normedInterpolationIndexOf(this.chunks,(e=>e.startLogPosition.value),e),r=this.chunks[t],i=e-r.startLogPosition.value,n=C.SearchUtils.normedInterpolationIndexOf(r.textRuns,(e=>e.startOffset),i),o=r.textRuns[n];return new zh(t,r,n,o,i-o.startOffset)}getSectionByPosition(e){return this.documentModel.sections[C.SearchUtils.normedInterpolationIndexOf(this.documentModel.sections,(e=>e.startLogPosition.value),e)]}getParagraphByPosition(e){return this.paragraphs[C.SearchUtils.normedInterpolationIndexOf(this.paragraphs,(e=>e.startLogPosition.value),e)]}getParagraphIndexByPosition(e){return C.SearchUtils.normedInterpolationIndexOf(this.paragraphs,(e=>e.startLogPosition.value),e)}getParagraphsIndices(e){const t=e.end,r=on.FixedInterval.fromPositions(C.SearchUtils.normedInterpolationIndexOf(this.paragraphs,(e=>e.startLogPosition.value),e.start),C.SearchUtils.normedInterpolationIndexOf(this.paragraphs,(e=>e.startLogPosition.value),t));return t>this.paragraphs[r.end].startLogPosition.value&&r.length++,r}getParagraphsByInterval(e){var t,r=[],i=e.end,n=C.SearchUtils.normedInterpolationIndexOf(this.paragraphs,(e=>e.startLogPosition.value),e.start);for(r.push(this.paragraphs[n++]);(t=this.paragraphs[n])&&t.startLogPosition.value<i;n++)r.push(t);return r}getParagraphIndicesByIntervals(e){let t=[];for(var r,i=0;r=e[i];i++){let e=C.SearchUtils.normedInterpolationIndexOf(this.paragraphs,(e=>e.startLogPosition.value),r.start),i=r.end;t.push(e++);for(let r;(r=this.paragraphs[e])&&r.startLogPosition.value<i;e++)t.push(e)}return f.ListUtils.uniqueNumber(t)}getDocumentEndPosition(){return this.info.getEndPosition(this.documentModel)}getWholeWordInterval(e,t=!1,r=!1){var i=new on.FixedInterval(e,0);if(!r&&(e==this.getDocumentEndPosition()||0==e))return i;var n=C.SearchUtils.normedInterpolationIndexOf(this.chunks,(e=>e.startLogPosition.value),e),o=e-this.chunks[n].startLogPosition.value,a=C.SearchUtils.normedInterpolationIndexOf(this.chunks[n].textRuns,(e=>e.startOffset),o),s=this.getWordEnd(e,t,n,a);if(s==e&&!r)return i;var l=this.getWordStart(e,t,this.chunks[n].textRuns[a]);return l!=e||r?(i.start=l,i.length=s-l,i):i}getWordStart(e,t,r){if(e<=0)return e;var i=e;e--;for(var n=C.SearchUtils.normedInterpolationIndexOf(this.chunks,(e=>e.startLogPosition.value),e),o=this.chunks[n],a=C.SearchUtils.normedInterpolationIndexOf(o.textRuns,(e=>e.startOffset),e-o.startLogPosition.value),s=o.textRuns[a];o&&s&&s.getType()===cs.TextRun&&o.textBuffer[e-o.startLogPosition.value].match(an.isAlphanumeric)&&(!t||r===s||r.maskedCharacterProperties.equals(s.maskedCharacterProperties));)if(i=e,--e-o.startLogPosition.value-s.startOffset<0)if(r=s,--a>=0)s=o.textRuns[a];else{if(!(o=this.chunks[--n]))break;a=o.textRuns.length-1,s=o.textRuns[a]}return i}getWordEnd(e,t,r,i){if(e==this.getDocumentEndPosition())return e;for(var n=this.chunks[r],o=n.textRuns[i],a=e,s=o;n&&o&&o.getType()===cs.TextRun&&n.textBuffer[e-n.startLogPosition.value].match(an.isAlphanumeric)&&(!t||s===o||s.maskedCharacterProperties.equals(o.maskedCharacterProperties));)if(a=++e,e===n.startLogPosition.value+o.startOffset+o.getLength()&&(s=o,!(o=n.textRuns[++i]))){if(!(n=this.chunks[++r]))break;i=0,o=n.textRuns[i]}return a}resetMergedFormattingCache(e,t=new on.FixedInterval(0,this.getDocumentEndPosition())){const r=this.getParagraphsIndices(t);e&wg.Paragraph&&f.ListUtils.forEach(this.paragraphs,(e=>e.resetParagraphMergedProperties()),r.start,r.end);const i=this.getRunAndIndexesByPosition(t.start),n=this.getRunAndIndexesByPosition(t.end);if(e&wg.Character){let e=i.runIndex;f.ListUtils.forEach(this.chunks,(t=>{f.ListUtils.allOf(t.textRuns,(e=>(e.resetCharacterMergedProperties(),n.run!=e)),e),e=0}),i.chunkIndex,n.chunkIndex+1)}return on.FixedInterval.fromPositions(this.paragraphs[r.start].startLogPosition.value,this.paragraphs[Math.max(r.start,r.end-1)].getEndPosition())}isEditable(e){return!this.documentModel.isDocumentProtectionEnabled||f.ListUtils.allOf(e,(e=>(e.end==this.getDocumentEndPosition()&&(e=e.makeByStartLength(e.start,e.length-1)),f.ListUtils.unsafeAnyOf(this.availableRangePermissions,(t=>t.interval.containsInterval(e))))))}filterRangePermissions(e){this.availableRangePermissions=this.documentModel.isDocumentProtectionEnabled?f.ListUtils.reducedMap(this.rangePermissions,(t=>t.isGranted(e)?t:null)):f.ListUtils.shallowCopy(this.rangePermissions)}clone(e){const t=new uu(e,this.info.clone());t.paragraphs=f.ListUtils.map(this.paragraphs,(e=>e.clone(t))),t.chunks=f.ListUtils.map(this.chunks,(e=>e.clone(t))),t.fields=f.ListUtils.map(this.fields,(e=>e.clone(t))),t.fields.forEach((e=>e.initParent(t.fields)));for(let e of this.tables)t.tables.push(e.clone(t));return t.bookmarks=f.ListUtils.map(this.bookmarks,(e=>e.clone(t))),t.availableRangePermissions=f.ListUtils.map(this.availableRangePermissions,(e=>e.clone(t.positionManager))),t.rangePermissions=f.ListUtils.map(this.rangePermissions,(e=>e.clone(t.positionManager))),t.isDeleted=this.isDeleted,t}isMain(){return this.info.isMain}isHeaderFooter(){return this.info.isHeaderFooter}isFooter(){return this.info.isFooter}isHeader(){return this.info.isHeader}isNote(){return this.info.isNote}isFootNote(){return this.info.isFootNote}isEndNote(){return this.info.isEndNote}isTextBox(){return this.info.isTextBox}isComment(){return this.info.isComment}isReferenced(){return this.info.isReferenced}getParagraphProperties(e){return e.getParagraphMergedProperties()}findBookmarkByInterval(e,t=!0){const r=[];return nn.IntervalAlgorithms.handleAffectedObjects(this.bookmarks,nn.IntervalAlgorithms.getMergedIntervals(e,!0),((e,i,n,o)=>{!t&&e.isHidden()||!(o.length||0==e.length||o.start==e.start||0==n.length&&n.start<e.end)||r.push(e)}),du.findBookmarkStartIndex),r}getActualSubDocument(){var e;return this.isDeleted?null===(e=this.documentModel.subDocumentsCollection.collection[this.replacedWithSubDocId])||void 0===e?void 0:e.getActualSubDocument():this}}uu.AUTOGENERATE_ID=-1,uu.MAIN_SUBDOCUMENT_ID=0;class pu{constructor(e,t){this.subDocument=e,this.position=t}validateInterval(){const e=this.subDocument.getDocumentEndPosition();this.position=Math.min(this.position,e-1)}clone(){return new pu(this.subDocument,this.position)}equals(e){return e&&this.subDocument.id==e.subDocument.id&&this.position==e.position}}class gu{constructor(e,t){this.subDocument=e,this.interval=t}static fromPosition(e,t){return new gu(e,new on.FixedInterval(t,0))}clone(){return new gu(this.subDocument,this.interval.clone())}validateInterval(){fu(this.subDocument,this.interval)}equals(e){return e&&this.subDocument.id==e.subDocument.id&&this.interval.equals(e.interval)}}class mu{constructor(e,t){this.subDocument=e,this.intervals=t}get multiselection(){return this.intervals.length>1}validateInterval(){for(let e of this.intervals)fu(this.subDocument,e)}clone(){return new mu(this.subDocument,f.ListUtils.deepCopy(this.intervals))}equals(e){return e&&this.subDocument.id==e.subDocument.id&&e.intervals&&f.ListUtils.equals(this.intervals,e.intervals)}static fromPosition(e,t){return new mu(e,[new on.FixedInterval(t,0)])}}function fu(e,t){const r=e.getDocumentEndPosition();0==t.start&&t.end==r||(t.start=Math.min(t.start,r-1),t.end=Math.min(t.end,r))}class bu{constructor(){this.leftMargin=0,this.topMargin=0,this.rightMargin=0,this.bottomMargin=0,this.id=1}isBodyMarginsSet(){return 0!=this.leftMargin||0!=this.topMargin||0!=this.rightMargin||0!=this.bottomMargin}clone(){const e=new bu;return e.leftMargin=this.leftMargin,e.topMargin=this.topMargin,e.rightMargin=this.rightMargin,e.bottomMargin=this.bottomMargin,e.id=this.id,e}}class Cu{constructor(e,t,r){this.rowIndex=e,this.gridCellIndex=t,this.cellIndexes=r}get rowIndexesInterval(){return new on.FixedInterval(this.rowIndex,this.cellIndexes.length)}getStartRowIndex(){return this.rowIndex}getCellIndex(e){return this.cellIndexes[e]}getCellIndexAbs(e){return this.cellIndexes[e-this.rowIndex]}getNumRowsInCell(){return this.cellIndexes.length}getGridCellIndex(){return this.gridCellIndex}getGridCellIndexEnd(e){return this.gridCellIndex+this.getColumnSpan(e)}addCellIndex(e){return this.cellIndexes.push(e),this}intersectRow(e){return e>=this.rowIndex&&e<this.getEndRowIndex()}getEndRowIndex(){return this.rowIndex+this.cellIndexes.length}getLastRowIndex(){return this.getEndRowIndex()-1}getColumnSpan(e){return e.rows[this.getStartRowIndex()].cells[this.getCellIndex(0)].columnSpan}intersectGridColumn(e,t){return e>=this.gridCellIndex&&e<this.gridCellIndex+t}}class Su{static fillGridInfo(e,t,r){const i=e.rows;for(let e,n=0;e=i[n];n++){const i=[],o=[];t.push(i),r.push(o);let a=e.gridBefore;for(let e=a;e>0;e--)i.push(null);for(let r,s=0;r=e.cells[s];s++){const e=r.verticalMerging!=Xe.Continue?new Cu(n,a,[s]):t[n-1][a].addCellIndex(s);o.push(e);for(let t=r.columnSpan;t>0;t--)i.push(e);a+=r.columnSpan}}}}class Iu{constructor(e){this.table=e,this.tableCellGridInfos=[],this.tableCellInfos=[],Su.fillGridInfo(e,this.tableCellGridInfos,this.tableCellInfos)}get commonWidth(){return f.ListUtils.last(this.columns.positions)}}class Pu{constructor(e){this.model=e}check(){return b.j.allOf(this.model.subDocuments,(e=>(this.poss=[],this.addParagraphs(e),this.addTables(e),this.addFields(e),this.addBookmarks(e),this.addRangePermissions(e),e.isMain()&&this.addSections(),this.compare(this.poss,f.ListUtils.shallowCopy(e.positionManager.positions)))))}compare(e,t){this.sort(t),this.sort(e);let r=new Cn.e(0,0),i=new cu(-1);for(let n of e){for(i.value!=n.value&&(r=this.getNewRegInterval(t,r));this.isGreater(n,t,r);)r=this.getNewRegInterval(t,r);if(!this.isEqual(n,t,r))return!1;i=n}return!0}getNewRegInterval(e,t){let r=e[(t=new Cn.e(t.end,t.end+1)).start];for(let i;(i=e[t.end])&&r.value==i.value;t.end++)r=i;return t}isGreater(e,t,r){for(let i=r.start;i<r.end;i++)if(t[i]&&e.value>t[i].value)return!0;return!1}isEqual(e,t,r){for(let i=r.start;i<r.end;i++)if(e===t[i])return!0;return!1}sort(e){e.sort(((e,t)=>e.value-t.value))}addSections(){for(let e of this.model.sections)this.poss.push(e.startLogPosition)}addParagraphs(e){for(let t of e.paragraphs)this.poss.push(t.startLogPosition)}addTables(e){for(let t of e.tables)for(let e of t.rows)for(let t of e.cells)this.poss.push(t.startParagraphPosition),this.poss.push(t.endParagrapPosition)}addFields(e){for(let t of e.fields)t.getPositions(this.poss)}addBookmarks(e){for(let t of e.bookmarks)this.poss.push(t._interval._start),this.poss.push(t._interval._end)}addRangePermissions(e){for(let t of e.rangePermissions)this.poss.push(t._interval._start),this.poss.push(t._interval._end)}}!function(e){e[e.None=0]="None",e[e.Run=1]="Run",e[e.Paragraph=2]="Paragraph",e[e.Chunk=3]="Chunk",e[e.Section=4]="Section",e[e.SubDocument=5]="SubDocument",e[e.Field=6]="Field",e[e.Table=7]="Table",e[e.PositionManager=8]="PositionManager",e[e.RangePermission=9]="RangePermission"}(zc||(zc={}));class wu{constructor(e){this.results=[],this.model=e}checkAll(){return!!wu.disableCheckModel||(this.check([this.checkModelProps,this.checkParagraphs,this.checkChunks,this.checkSections,this.checkParagraphChunk,this.checkFields,this.checkTables,this.checkPositions]),!this.results.length)}check(e){for(let t of e){const e=t.call(this);if(e!=zc.None&&null!==e){this.results.push(e);break}}}checkModelProps(){return this.model.mainSubDocument&&this.model.subDocuments[uu.MAIN_SUBDOCUMENT_ID]?zc.None:zc.SubDocument}checkParagraphs(){return b.j.unsafeAnyOf(this.model.subDocuments,(e=>{if(!e.paragraphs[0]||0!=e.paragraphs[0].startLogPosition.value)return zc.Paragraph;let t=0;for(let r of e.paragraphs){if(r.startLogPosition.value!=t||r.length<1||!e.getRunByPosition(r.getEndPosition()-1).isParagraphOrSectionRun())return zc.Paragraph;const i=this.checkTabs(r.tabs);if(i)return i;t+=r.length}return zc.None}))}checkTabs(e){for(let t of e.tabsInfo)if(void 0===t.leader)return zc.Paragraph;return zc.None}checkChunks(){return b.j.unsafeAnyOf(this.model.subDocuments,(e=>{if(!e.chunks[0]&&0!=e.chunks[0].startLogPosition.value)return zc.Chunk;let t=0;for(let r of e.chunks){if(r.textBuffer.length<1||r.textRuns.length<1||r.startLogPosition.value!=t)return zc.Chunk;for(let e of r.textRuns)if(!e.maskedCharacterProperties.fontInfo||!e.characterStyle)return zc.Run;t+=r.textBuffer.length}return zc.None}))}checkSections(){const e=this.model.mainSubDocument;if(!this.model.sections[0]||0!=this.model.sections[0].startLogPosition.value)return zc.Section;let t=0;for(let r of this.model.sections){if(t!=r.startLogPosition.value||r.getLength()<1||!e.getRunByPosition(r.getEndPosition()-1).isParagraphOrSectionRun())return zc.Section;t+=r.getLength()}return f.ListUtils.last(this.model.sections).getEndPosition()!=f.ListUtils.last(e.paragraphs).getEndPosition()?zc.Section:zc.None}checkParagraphChunk(){return b.j.unsafeAnyOf(this.model.subDocuments,(e=>f.ListUtils.last(e.paragraphs).getEndPosition()!=f.ListUtils.last(e.chunks).getEndPosition()?zc.Chunk:zc.None))}checkFields(){return b.j.unsafeAnyOf(this.model.subDocuments,(e=>{const t=f.ListUtils.shallowCopy(e.fields).sort(((e,t)=>e.getFieldStartPosition()-t.getFieldStartPosition()));return f.ListUtils.allOf2(t,e.fields,((e,t)=>e.index==t.index))?f.ListUtils.unsafeAnyOf(e.fields,((t,r)=>{if(t.index!=r)return zc.Field;return this.checkField(e,t)})):zc.Field}))}checkTables(){return b.j.unsafeAnyOf(this.model.subDocuments,(e=>{const t=f.ListUtils.shallowCopy(e.tables);return t.sort(Ja.comparer),f.ListUtils.allOf2(t,e.tables,((e,t)=>e.index==t.index))?e.tables.length!=f.ListUtils.accumulateNumber(e.tablesByLevels,(e=>e.length))||f.ListUtils.unsafeAnyOf(e.tablesByLevels,(e=>f.ListUtils.unsafeAnyOf(e,((t,r)=>t.getStartPosition()-e[r-1].getEndPosition()<1),1)))?zc.Table:f.ListUtils.unsafeAnyOf(e.tables,((t,r)=>{if(t.index!=r)return zc.Table;return this.checkTable(e,t)})):zc.Table}))}checkField(e,t){const r=t.getFieldStartPosition(),i=t.getCodeStartPosition(),n=t.getSeparatorPosition(),o=t.getResultStartPosition(),a=t.getResultEndPosition(),s=t.getFieldEndPosition();return r+1==i&&n+1==o&&a+1==s&&n>r&&a-n>0&&e.getRunByPosition(r).getType()==cs.FieldCodeStartRun&&e.getRunByPosition(n).getType()==cs.FieldCodeEndRun&&e.getRunByPosition(a).getType()==cs.FieldResultEndRun?t.parent&&!this.isParentOfField(t,t.parent)?zc.Field:zc.None:zc.Field}isParentOfField(e,t){const r=e.getAllFieldInterval(),i=e.getFieldStartPosition()<t.getSeparatorPosition()?t.getCodeInterval():t.getResultInterval();return r.start>=i.start&&r.end<=i.end}checkTable(e,t){if(t.parentCell&&!t.parentCell.interval.containsIntervalWithoutEnd(t.interval))return zc.Table;if(!t.rows[0]||!t.rows[0].cells[0])return zc.Table;let r=t.rows[0].cells[0].startParagraphPosition.value;const i=t.rows[0].getTotalCellsInRowConsiderGrid();for(let n,o=0;n=t.rows[o];o++){if(n.getTotalCellsInRowConsiderGrid()!=i||!n.cells[0])return zc.Table;for(let t,i=0;t=n.cells[i];i++){const i=t.interval;if(i.start!=r||i.length<1||e.getRunByPosition(i.end-1).getType()!=cs.ParagraphRun||t.columnSpan<1)return zc.Table;r+=i.length}}const n=new Iu(t);for(let e,r=0;e=t.rows[r];r++)for(let t,i=0;t=e.cells[i];i++){const e=n.tableCellInfos[r][i];switch(t.verticalMerging){case Xe.None:if(r!=e.getStartRowIndex()||r+1!=e.getEndRowIndex())return zc.Table;break;case Xe.Continue:if(!(r>e.getStartRowIndex()&&r<e.getEndRowIndex()))return zc.Table;break;case Xe.Restart:if(!(r==e.getStartRowIndex()&&e.getEndRowIndex()>r+1))return zc.Table;break;default:return zc.Table}}return zc.None}checkPositions(){return new Pu(this.model).check()?zc.None:zc.PositionManager}}wu.disableCheckModel=!1;const yu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xu=yu.split("");function Tu(e){const t=e.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" "),r=t.length,i=[];for(let e=0;e<r;e++)i.push(String.fromCharCode(+t[e]));return function(e){for(var t=0,r=0,i=e.length/3,n=[];t<i;++t){var o=e.charCodeAt(r++),a=e.charCodeAt(r++),s=e.charCodeAt(r++);if((o|a|s)>255)throw new Error("String contains an invalid character");n[n.length]=xu[o>>2]+xu[o<<4&63|a>>4]+(isNaN(a)?"=":xu[a<<2&63|s>>6])+(isNaN(a+s)?"=":xu[63&s])}return n.join("")}(i.join(""))}function vu(e){for(var t=0,r=function(e){if(/(=[^=]+|={3,})$/.test(e))throw new Error("String contains an invalid character");var t=3&(e=e.replace(/=/g,"")).length;if(1===t)throw new Error("String contains an invalid character");for(var r=0,i=0,n=e.length/4,o=[];r<n;++r){var a=yu.indexOf(e[i++]||"A"),s=yu.indexOf(e[i++]||"A"),l=yu.indexOf(e[i++]||"A"),d=yu.indexOf(e[i++]||"A");if((a|s|l|d)<0)throw new Error("String contains an invalid character");o[o.length]=255&(a<<2|s>>4),o[o.length]=255&(s<<4|l>>2),o[o.length]=255&(l<<6|d)}const c=o.length+t-4,h=[];for(let e=0;e<c;e++)h.push(String.fromCharCode(o[e]));return h.join("")}(e.replace(/[ \r\n]+$/,"")),i=[];t<r.length;++t){var n=r.charCodeAt(t).toString(16);1===n.length&&(n="0"+n),i[i.length]=n}return i.join("")}function Mu(e){let t=os.numberToHex(e);return 1===t.length?"0"+t:t}class Eu{constructor(e={}){this.result=e}add(e,t){return this.result[e]=t,this}append(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.result[t]=e[t]);return this}getByKey(e){return this.result[e]}get(){return this.result}}class Du{static convertExtensionToMimeType(e){const t=Du.extToMimeType[e.toLowerCase()];return t||"image/png"}static convertMimeTypeToExtension(e){const t=Du.mimeToExt[e.toLowerCase()];return t||"png"}static makeBase64UriPrefix(e){return`data:${e};base64,`}static getBase64DataWithoutPrefix(e){const t=e.match(/data\:.*\;base64,/);return t?e.substr(t[0].length):e}static getMimeTypeFromBase64Uri(e){const t=e.match(/data\:(.*)\;base64,/);return t&&t[1]?t[1].toLowerCase():"png"}}Du.extToMimeType=(new Eu).add("png","image/png").add("jpeg","image/jpeg").add("jpg","image/jpeg").add("svg","image/svg+xml").add("gif","image/gif").get(),Du.mimeToExt=(new Eu).add("image/png","png").add("image/jpeg","jpeg").add("image/svg+xml","svg").add("image/gif","gif").get();var Fu,Ru=__webpack_require__(4633);!function(e){e[e.Undefined=0]="Undefined",e[e.PlainText=1]="PlainText",e[e.Rtf=2]="Rtf",e[e.Html=3]="Html",e[e.OpenXml=4]="OpenXml",e[e.Mht=5]="Mht",e[e.WordML=6]="WordML",e[e.OpenDocument=7]="OpenDocument",e[e.ePub=9]="ePub",e[e.Doc=10]="Doc"}(Fu||(Fu={}));const Lu={[Ru.DxMimeType.OpenXml]:Fu.OpenXml,[Ru.DxMimeType.Docm]:Fu.OpenXml,[Ru.DxMimeType.Rtf]:Fu.Rtf,[Ru.DxMimeType.PlainText]:Fu.PlainText,[Ru.DxMimeType.Html]:Fu.Html},Bu={[Fu.OpenXml]:Ru.DxMimeType.OpenXml,[Fu.Rtf]:Ru.DxMimeType.Rtf,[Fu.PlainText]:Ru.DxMimeType.PlainText,[Fu.Html]:Ru.DxMimeType.Html};class Au{constructor(e,t,r=null){this.results=[],this.pictureSizeAccuracy=6,this.nextRowMark="\n    ",this.source=e,this.target=t,this.format=r}compareAll(){return this.compare([this.compareSubDocuments]),!this.results.length}compare(e){for(let t of e){const e=t.call(this);if(e!=zc.None&&null!==e){this.results.push(e),console.log(this.consoleErrorMessage);break}}}compareSubDocuments(){this.consoleErrorMessage="fail comparing into"+this.nextRowMark;let e=this.compareSubDocumentsCore(this.source.mainSubDocument,this.target.mainSubDocument);return e||(e=f.ListUtils.unsafeAnyOf(this.source.sections,((e,t)=>this.compareSection(e,this.target.sections[t]))),e||zc.None)}compareSection(e,t){let r=this.compareHeadersFooters(e.headers,t.headers);return r||(r=this.compareHeadersFooters(e.footers,t.footers)),r}compareHeadersFooters(e,t){let r=this.compareHeaderFooter(e,t,Ws.Even);return r||(r=this.compareHeaderFooter(e,t,Ws.Odd)),r||(r=this.compareHeaderFooter(e,t,Ws.First)),r}compareHeaderFooter(e,t,r){let i=e.getObject(r),n=t.getObject(r);return i||n?i&&n?this.compareSubDocumentsCore(i.getSubDocument(this.source),n.getSubDocument(this.target)):zc.Section:zc.None}compareSubDocumentsCore(e,t){if(this.consoleErrorMessage+="SubDoc id = "+e.id+" is header: "+e.isHeader()+" is footer: "+e.isFooter()+this.nextRowMark,!e||!t)return zc.SubDocument;if(e.chunks.length!=t.chunks.length)return zc.SubDocument;let r=this.compareRangePermissions(e.rangePermissions,t.rangePermissions);return r!=zc.None?r:f.ListUtils.unsafeAnyOf(e.chunks,((e,r)=>(this.consoleErrorMessage+="chunk index = "+r+this.nextRowMark,this.compareChunks(e,t.chunks[r]))))}compareRangePermissions(e,t){return e.length!=t.length||f.ListUtils.anyOf(e,((e,r)=>!e.equals(t[r])))?zc.RangePermission:zc.None}countNotLoadedPicture(e){return f.ListUtils.reducedMap(e,(e=>this.runShouldBeLostOnExport(e)?e:null)).length}runShouldBeLostOnExport(e){const t=e.getType();return(t==cs.InlinePictureRun||t==cs.AnchoredPictureRun)&&!e.info.cacheInfo.isLoaded}isASCII(e){return e>=0&&e<=127}compareChunks(e,t){this.consoleErrorMessage+="chunk length = "+e.textRuns.length+this.nextRowMark;const r=e.textRuns.length!=t.textRuns.length;if(r&&e.textRuns.length-this.countNotLoadedPicture(e.textRuns)!=t.textRuns.length)return this.format!=Fu.Rtf||e.textBuffer!=t.textBuffer?zc.Chunk:zc.None;let i=0,n=0,o=0;return f.ListUtils.unsafeAnyOf(e.textRuns,((a,s)=>{const l=s-i+o,d=t.textRuns[l],c=a.getType()!=d.getType()||a.startOffset-n!=d.startOffset||a.getLength()!=d.getLength();if(this.consoleErrorMessage+="source run index = "+s+" target run index = "+l+this.nextRowMark,c&&r){if(this.runShouldBeLostOnExport(a))return i++,n+=a.getLength(),zc.None;let t=0;if(a.getType()==cs.TextRun){const r=e.getRunText(a),i=a.getLength();let n=!1;for(let e=0;e<i;e++)this.isASCII(r.charCodeAt(e))||(n=!0,t++);if(n)return r.length==t&&t--,this.isASCII(r.charCodeAt(0))&&this.isASCII(r.charCodeAt(r.length-1))&&t++,o+=t,zc.None}return zc.Run}return this.compareRuns(a,d,e,t,n)}))}compareRuns(e,t,r,i,n){if(e.getType()!=t.getType()||e.startOffset-n!=t.startOffset||e.getLength()!=t.getLength()||r.getRunText(e)!=i.getRunText(t)||!this.compareCharacterPropertiesBundle(e.getCharPropsBundle(this.source),t.getCharPropsBundle(this.target)))return this.consoleErrorMessage+="main run properties comparing failed "+this.nextRowMark,zc.Run;switch(e.getType()){case cs.TextRun:case cs.ParagraphRun:return zc.None;case cs.InlinePictureRun:return this.compareInlinePictureRuns(e,t);case cs.AnchoredPictureRun:return this.compareAnchoredPictureRuns(e,t);case cs.AnchoredTextBoxRun:return this.compareAnchoredTextBoxRuns(e,t);default:return zc.None}}compareCharacterPropertiesBundle(e,t){return this.compareStyles(e.style,t.style)}compareStyles(e,t){return e&&t?e.styleName==t.styleName&&e.deleted==t.deleted&&this.compareStyles(e.parent,t.parent):!e&&!t}compareInlinePictureRuns(e,t){const r=this.comparePictureSize(e.size,t.size)&&this.compareShape(e.info.shape,t.info.shape)&&this.compareNonVisualDrawingObjectInfo(e.info.containerProperties,t.info.containerProperties);return this.consoleErrorMessage+="InlinePicture run properties comparing failed "+this.nextRowMark,r?zc.None:zc.Run}compareAnchoredPictureRuns(e,t){const r=this.comparePictureSize(e.size,t.size)&&this.compareShape(e.info.shape,t.info.shape)&&this.compareNonVisualDrawingObjectInfo(e.info.containerProperties,t.info.containerProperties)&&this.compareAnchorInfo(e.info.anchorInfo,t.info.anchorInfo);return this.consoleErrorMessage+="AnchoredPictureRun run properties comparing failed "+this.nextRowMark,r?zc.None:zc.Run}compareAnchoredTextBoxRuns(e,t){const r=this.compareTextBoxSize(e.size,t.size)&&this.compareShape(e.shape,t.shape)&&this.compareAnchorInfo(e.anchorInfo,t.anchorInfo)&&this.compareTextBoxProperties(e.textBoxProperties,t.textBoxProperties);return this.consoleErrorMessage+="AnchoredTextBoxRun run properties comparing failed "+this.nextRowMark,r?zc.None:zc.Run}compareTextBoxProperties(e,t){return e.resizeShapeToFitText==t.resizeShapeToFitText&&e.upright==t.upright&&e.verticalAlignment==t.verticalAlignment&&e.wrapText==t.wrapText&&e.leftMargin==t.leftMargin&&e.rightMargin==t.rightMargin&&e.topMargin==t.topMargin&&e.bottomMargin==t.bottomMargin}compareAnchorInfo(e,t){return e.equals(t)}compareTextBoxSize(e,t){return!!e.useAbsoluteHeight()||(!(e.relativeHeightType!=t.relativeHeightType||!e.useAbsoluteWidth())||e.relativeWidthType==t.relativeWidthType&&e.lockAspectRatio==t.lockAspectRatio&&e.rotation==t.rotation&&this.compareSize(e.relativeSize,t.relativeSize)&&this.compareSize(e.absoluteSize,t.absoluteSize))}comparePictureSize(e,t){return this.compareSizeBasedOnScale(e.actualSize,t.actualSize,e.scale)&&e.lockAspectRatio==t.lockAspectRatio&&this.compareSize(e.originalSize,t.originalSize)&&this.compareSize(e.scale,t.scale)&&e.rotation==t.rotation&&this.compareCacheInfo(e.cacheInfo,t.cacheInfo)}compareSizeBasedOnScale(e,t,r){const i=Math.floor(r.width/100)+this.pictureSizeAccuracy,n=Math.floor(r.height/100)+this.pictureSizeAccuracy;return this.compareSize(e,t,i,n)}compareSize(e,t,r,i){return null!=r||(r=this.pictureSizeAccuracy),null!=i||(i=this.pictureSizeAccuracy),Math.abs(e.width-t.width)<r&&Math.abs(e.height-t.height)<i}compareCacheInfo(e,t){return vu(Du.getBase64DataWithoutPrefix(e.base64))===vu(Du.getBase64DataWithoutPrefix(t.base64))&&this.compareSize(e.size,t.size)}compareShape(e,t){const r=w.i.colorToHash(e.fillColor)==w.i.colorToHash(t.fillColor)||U.isTransparentOrEmptyorNoColor(e.fillColor)==U.isTransparentOrEmptyorNoColor(t.fillColor),i=!U.isTransparentOrEmptyorNoColor(e.outlineColor),n=!(e.outlineWidth>0&&i)||(w.i.colorToHash(e.outlineColor)==w.i.colorToHash(t.outlineColor)||U.isTransparentOrEmptyorNoColor(e.outlineColor)==U.isTransparentOrEmptyorNoColor(t.outlineColor))&&e.outlineWidth==t.outlineWidth;return r&&n}compareNonVisualDrawingObjectInfo(e,t){if(this.format&&this.format==Fu.Rtf)return e.description==t.description;return!(e.name||t.name!="Picture "+t.id)||e.name==t.name&&e.title==t.title&&e.description==t.description}}var Nu,ku,Ou,_u,Uu,Hu,Vu,Wu,zu=__webpack_require__(8889);class ju{get model(){return this.intervalsInfo.subDocument.documentModel}resetParagraphMergedProperties(){this.mergedParagraphPropertiesRaw=null,this.mergedParagraphPropertiesFull=null}get charPropsBundle(){return new pn(this.getMaskedCharacterProperties().clone(),this.getCharacterStyle())}get parPropsBundle(){return new gn(this.getMaskedParagraphProperties().clone(),this.getParagraphStyle())}setIntervals(e){return this.intervalsInfo=e.clone(),this.resetReturnValues(),this}getCharacterStyle(){return this.characterStyle||(this.characterStyle=this.getCharacterStyleInternal()),this.characterStyle}getParagraphStyle(){return this.paragraphStyle||(this.setSourceRun(),this.paragraphStyle=this.sourceRun.paragraph.paragraphStyle),this.paragraphStyle}setCharacterStyle(e){this.characterStyle=e}getMaskedCharacterProperties(){return this.maskedCharacterProperties||(this.setSourceRun(),this.maskedCharacterProperties=this.sourceRun.maskedCharacterProperties.clone()),this.maskedCharacterProperties}getMaskedParagraphProperties(){return this.maskedParagraphProperties||(this.setSourceRun(),this.maskedParagraphProperties=this.sourceRun.paragraph.maskedParagraphProperties.clone()),this.maskedParagraphProperties}getMergedCharacterPropertiesRaw(){return this.mergedCharacterPropertiesRaw||this.setMergedCharacterAndParagraphPropertiesRaw(),this.mergedCharacterPropertiesRaw}getMergedCharacterPropertiesFull(){return this.mergedCharacterPropertiesFull||(this.mergedCharacterPropertiesFull=ju.mergePropertiesFull(this.getMergedCharacterPropertiesRaw(),ir.ALL_FIELDS)),this.mergedCharacterPropertiesFull}getMergedParagraphPropertiesRaw(){return this.mergedParagraphPropertiesRaw||this.setMergedCharacterAndParagraphPropertiesRaw(),this.mergedParagraphPropertiesRaw}getMergedParagraphPropertiesFull(){return this.mergedParagraphPropertiesFull||(this.mergedParagraphPropertiesFull=ju.mergePropertiesFull(this.getMergedParagraphPropertiesRaw(),Ft.ALL_FIELDS)),this.mergedParagraphPropertiesFull}setMergedCharacterAndParagraphPropertiesRaw(){this.setSourceRun(),this.mergedCharacterPropertiesRaw=this.sourceRun.getCharacterMergedProperties().clone(),this.mergedParagraphPropertiesRaw=this.sourceRun.paragraph.getParagraphMergedProperties().clone();var e=this.intervalsInfo.interval,t=e.start,r=e.end,i=this.intervalsInfo.subDocument.chunks,n=C.SearchUtils.normedInterpolationIndexOf(i,(e=>e.startLogPosition.value),t),o=i[n],a=C.SearchUtils.normedInterpolationIndexOf(o.textRuns,(e=>o.startLogPosition.value+e.startOffset),t),s=this.sourceRun.paragraph;e:for(;o=i[n];n++)for(var l;l=o.textRuns[a];a++){if(o.startLogPosition.value+l.startOffset>=r)break e;l!==this.sourceRun&&(l.getType()===cs.TextRun&&ju.mergePropertiesRaw(this.mergedCharacterPropertiesRaw,l.getCharacterMergedProperties(),ir.ALL_FIELDS),s!==l.paragraph&&(ju.mergePropertiesRaw(this.mergedParagraphPropertiesRaw,l.paragraph.getParagraphMergedProperties(),Ft.ALL_FIELDS),s=l.paragraph))}}static mergePropertiesRaw(e,t,r){for(var i,n=0;i=r[n];n++)i.binaryEquals(i.getProp(e),i.getProp(t))||i.setProp(e,void 0)}static mergePropertiesFull(e,t){for(var r,i=e.clone(),n=0;r=t[n];n++)void 0===r.getProp(i)&&r.setProp(i,r.defaultValue);return i}getCharacterStyleInternal(){var e=this.intervalsInfo.interval;if(0==e.length)return this.getCharacterStyleCollapsedIntervalInternal(e.start);var t=this.intervalsInfo.subDocument.chunks,r=e.start,i=e.end,n=this.intervalsInfo.subDocument.getRunAndIndexesByPosition(r);if(r==n.run.paragraph.startLogPosition.value&&n.run.paragraph.length>1)return n.run.characterStyle;if(r>0){var o=this.intervalsInfo.subDocument.getRunAndIndexesByPosition(r-1);if(o.run.getType()==cs.TextRun)return o.run.characterStyle}for(var a,s=n.chunkIndex;a=t[s];s++)for(var l,d=n.runIndex;l=a.textRuns[d];d++){if(a.startLogPosition.value+l.startOffset>=i)return n.run.characterStyle;if(l.getType()==cs.TextRun)return l.characterStyle}return n.run.characterStyle}isHyperlinkField(e){e++;const t=this.intervalsInfo.subDocument.fields;return t[0]&&f.ListUtils.reverseElementBy(t,(t=>t.getFieldEndPosition()==e),Math.max(0,Md.normedBinaryIndexOf(t,e))).isHyperlinkField()}getCharacterStyleCollapsedIntervalInternal(e){var t=this.intervalsInfo.subDocument.chunks;if(0==e)return t[0].textRuns[0].characterStyle;const r=new jh(this.intervalsInfo.subDocument,!1);return r.setPosition(e-1),r.run.isParagraphOrSectionRun()||r.run.getType()==cs.FieldResultEndRun&&this.isHyperlinkField(r.getAbsolutePosition())?(r.moveToNextRun(),r.run.characterStyle):r.run.characterStyle}setSourceRun(){if(this.sourceRun)return;const e=this.intervalsInfo.interval;if(0==e.length)if(0==e.start){const e=this.intervalsInfo.subDocument.chunks[0];this.sourceRun=e?e.textRuns[0].clone():null}else{const t=new jh(this.intervalsInfo.subDocument,!1);t.setPosition(e.start-1),I.Y.isAnyOf(t.run.getType(),cs.TextRun,cs.FieldResultEndRun)||t.moveToNextRun(),this.sourceRun=t.run.clone()}else{const t=this.intervalsInfo.subDocument.getRunByPosition(e.start);if(t.getType()==cs.TextRun)return void(this.sourceRun=t.clone());const r=e.end;let i=this.intervalsInfo.subDocument.getRunByPosition(r-1);if(r==this.model.sections[this.model.sections.length-1].getEndPosition()&&r>2&&(i=this.intervalsInfo.subDocument.getRunByPosition(r-2)),i.getType()==cs.TextRun)return void(this.sourceRun=i.clone());this.sourceRun=t.clone()}}resetReturnValues(){this.sourceRun=null,this.characterStyle=null,this.maskedCharacterProperties=null,this.mergedCharacterPropertiesRaw=null,this.mergedCharacterPropertiesFull=null,this.mergedParagraphPropertiesRaw=null,this.mergedParagraphPropertiesFull=null}getAllCharacterProperties(){return new Xu(this.getMaskedCharacterProperties().clone(),this.getMergedCharacterPropertiesRaw().clone(),this.mergedCharacterPropertiesFull?this.mergedCharacterPropertiesFull.clone():null)}applyAllCharacterProperties(e,t=!1){this.maskedCharacterProperties=e.maskedCharacterProperties,this.mergedCharacterPropertiesRaw=e.mergedCharacterPropertiesRaw,this.mergedCharacterPropertiesFull=e.mergedCharacterPropertiesFull,t||this.applyAllCharacterPropertiesToSourceRun()}applyAllCharacterPropertiesToSourceRun(){this.setSourceRun(),this.sourceRun.maskedCharacterProperties=this.maskedCharacterProperties,this.sourceRun.setCharacterMergedProperies(this.mergedCharacterPropertiesRaw)}getAllParagraphProperties(){return new Gu(this.getMaskedParagraphProperties().clone(),this.getMergedParagraphPropertiesRaw().clone(),this.mergedParagraphPropertiesFull?this.mergedParagraphPropertiesFull.clone():null)}applyAllParagraphProperties(e){this.maskedParagraphProperties=e.maskedParagraphProperties,this.mergedParagraphPropertiesRaw=e.mergedParagraphPropertiesRaw,this.mergedParagraphPropertiesFull=e.mergedParagraphPropertiesFull}}class Xu{constructor(e,t,r){this.maskedCharacterProperties=e,this.mergedCharacterPropertiesRaw=t,this.mergedCharacterPropertiesFull=r}}class Gu{constructor(e,t,r){this.maskedParagraphProperties=e,this.mergedParagraphPropertiesRaw=t,this.mergedParagraphPropertiesFull=r}}class Ku{constructor(e){this.tableCellGridInfos=[],this.tableCellInfos=[],Su.fillGridInfo(e,this.tableCellGridInfos,this.tableCellInfos)}gridInfosByTablePosition(e){return this.tableCellInfos[e.rowIndex][e.cellIndex]}}class qu{get row(){return this.cells[0].cell.parentRow}constructor(e,t){this.rowIndex=e,this.cells=t}get isSeries(){return f.ListUtils.allOf(this.cells,((e,t)=>e.cellIndex==this.cells[t-1].cellIndex+1),1)}get columnCountInSeries(){return this.isSeries?f.ListUtils.accumulateNumber(this.cells,(e=>e.cell.columnSpan)):0}}class $u{constructor(e,t){this.cell=e,this.cellIndex=t}}class Ju{get numRows(){return this.rows.length}get startRowIndex(){return this.rows[0].rowIndex}get isSquare(){return void 0===this._isSquare?this._isSquare=this.calculateIsSquare():this._isSquare}get firstCell(){return this.firstCellInfo.cell}get firstCellInfo(){return this.firstRowInfo.cells[0]}get firstRowInfo(){return this.rows[0]}get lastCellInfo(){return f.ListUtils.last(this.lastRowInfo.cells)}get lastCell(){return this.lastCellInfo.cell}get lastRowInfo(){return f.ListUtils.last(this.rows)}get withoutGapByRows(){return void 0===this._withoutGapByRows?this._withoutGapByRows=f.ListUtils.allOf(this.rows,((e,t)=>e.rowIndex==this.rows[t-1].rowIndex+1),1):this._withoutGapByRows}get isSelectedEntireTable(){return void 0===this._isSelectedEntireTable?this._isSelectedEntireTable=this.numRows==this.info.table.rows.length&&f.ListUtils.allOf2(this.rows,this.info.table.rows,((e,t)=>e.cells.length==t.cells.length)):this._isSelectedEntireTable}get areCellsSelectedInSeries(){return void 0===this._areCellsSelectedInSeries?this._areCellsSelectedInSeries=f.ListUtils.allOf(this.rows,((e,t)=>(0==t||e.rowIndex==this.rows[t-1].rowIndex+1)&&e.isSeries)):this._areCellsSelectedInSeries}constructor(e,t){this.info=e,this.rows=t,t[0]||(this._isSquare=!1,this._isSelectedEntireTable=!1,this._withoutGapByRows=!1,this._areCellsSelectedInSeries=!1)}foreach(e,t){for(let r,i=0;r=this.rows[i];i++){e(r);for(let e,i=0;e=r.cells[i];i++)t(e,r)}}allOfCells(e){for(let t,r=0;t=this.rows[r];r++)for(let r,i=0;r=t.cells[i];i++)if(!e(r,t))return!1;return!0}calculateIsSquare(){let e;if(!this.withoutGapByRows)return!1;for(let t of this.rows){const r=this.info.gridInfoManager.tableCellInfos[t.rowIndex],i=f.ListUtils.map(t.cells,(e=>new on.FixedInterval(r[e.cellIndex].getGridCellIndex(),e.cell.columnSpan))),n=f.ListUtils.allOf(i,((e,t)=>e.start==i[t-1].end),1),o=new Cn.e(i[0].start,f.ListUtils.last(i).end);if(!n||e&&!o.equals(e))return!1;e=o}return!0}atLeastOneCellFullySelected(e){return this.numRows>1||1==this.numRows&&this.rows[0].cells.length>1||f.ListUtils.unsafeAnyOf(e,(e=>e.equals(this.firstCell.interval)))}}class Yu{get isSelected(){return!!this.rawData.rows.length}constructor(e,t,r,i){this.table=e,this.gridInfoManager=t,this.rawData=new Ju(this,r),this.extendedData=new Ju(this,i)}}class Qu{constructor(){this.map={}}calculate(e,t){const r=this.findTable(e,t);return r?this.fillResult(r,t):new Yu(null,null,[],[])}findTable(e,t){if(!e.length)return null;const r=new Cn.e(t[0].start,f.ListUtils.last(t).end);if(0==r.length)return Ja.getTableByPosition(e,r.start,!0);let i=null,n=0;for(let t=Ja.correctBoundTable(e,Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.getStartPosition()),r.start)),r.start,(e=>--e)),o=t.index;(t=e[o])&&t.getStartPosition()<=r.end;o++){const e=nn.IntervalAlgorithms.getIntersection(t.interval,r);e&&(e.length||e.start!=t.getEndPosition())&&(!i||t.nestedLevel<i.nestedLevel?(i=t,n=1):t.nestedLevel==i.nestedLevel&&n++)}return i&&1==n&&i.interval.containsInterval(r)?i:null}fillResult(e,t){let r=0,i=Cn.e.makeByConstInterval(t[r]);const n=new Qa(e,-1,-1);for(;n.moveToNextRow();)for(;n.moveToNextCell();){const o=n.cell.interval,a=nn.IntervalAlgorithms.getIntersection(i,o);if(a&&(a.length||!i.length&&a.start<o.end)&&(this.add(n),n.cell.endParagrapPosition.value>=i.end)){const n=t[++r];if(!n)return this.extendMergedCells(e);i=Cn.e.makeByConstInterval(n)}}return this.extendMergedCells(e)}add(e){e=e.clone();const t=this.map[e.rowIndex];t?t.push(e):this.map[e.rowIndex]=[e]}extendMergedCells(e){const t=new Ku(e),r=b.j.toListBy(this.map,(e=>f.ListUtils.deepCopy(e)));f.ListUtils.forEach(r,(r=>{f.ListUtils.forEach(r,(r=>{if(r.cell.verticalMerging!=Xe.None){const i=t.gridInfosByTablePosition(r);f.ListUtils.forEachOnInterval(i.rowIndexesInterval,(t=>{this.add(new Qa(e,t,i.getCellIndexAbs(t)).init())}))}}))}));const i=b.j.toListBy(this.map,(e=>f.ListUtils.unique(e,((e,t)=>e.cellIndex-t.cellIndex)))).sort(((e,t)=>e[0].rowIndex-t[0].rowIndex));return new Yu(e,t,Qu.translateRowPositionsToSelectedInfo(r),Qu.translateRowPositionsToSelectedInfo(i))}static translateRowPositionsToSelectedInfo(e){return f.ListUtils.map(e,(e=>new qu(e[0].rowIndex,f.ListUtils.map(e,(e=>new $u(e.cell,e.cellIndex))))))}}class Zu{static correctIntervalDueToTables(e,t){if(0!=t.length&&0!=e.tables.length){var r=Ja.getTableCellByPosition(e.tables,t.start),i=Ja.getTableCellByPosition(e.tables,t.end);if(null!=r||null!=i)if(null!=r||null==i)if(null==r||t.end!=r.endParagrapPosition.value){if(!(null!=r&&null==i||Zu.firstCellIsParentCellForSecondCellsTable(i,r)))return Ja.getTableByPosition(e.tables,t.start,!1)!=Ja.getTableByPosition(e.tables,t.end,!1)?(t.expand(new on.FixedInterval(r.parentRow.getStartPosition(),t.start-r.parentRow.getStartPosition())),void(t.end!=i.parentRow.getStartPosition()&&t.expand(new on.FixedInterval(t.end,i.parentRow.getEndPosition()-t.end)))):null!=r&&null!=i&&r!=i&&r.parentRow.parentTable==i.parentRow.parentTable?(t.expand(r.interval),void(t.end!=i.startParagraphPosition.value&&t.expand(i.interval))):void 0;t.end!=r.parentRow.parentTable.getEndPosition()&&t.expand(new on.FixedInterval(r.parentRow.getStartPosition(),t.start-r.parentRow.getStartPosition()))}else t.expand(r.interval);else t.end!=i.parentRow.getStartPosition()&&t.expand(new on.FixedInterval(t.end,i.parentRow.getEndPosition()-t.end))}}static firstCellIsParentCellForSecondCellsTable(e,t){if(null==e||null==t||null==t.parentRow.parentTable.parentCell)return!1;for(var r=t.parentRow.parentTable;null!=r.parentCell;){if(r.parentCell==e)return!0;r=r.parentCell.parentRow.parentTable}return!1}}class ep{constructor(){this.noSpecRun()}get picturePos(){return(0,S.isDefined)(this.picturePosition)?this.picturePosition.value:-1}get textBoxPos(){return(0,S.isDefined)(this.textBoxPosition)?this.textBoxPosition.value:-1}noSpecRun(){this.setSpecRunInfo(null,-1,-1,!1,-1)}setSpecRunInfo(e,t,r,i,n){(0,S.isDefined)(this.picturePosition)&&(this.parentSubDocument.positionManager.unregisterSpecRunPosition(),this.picturePosition=null),t>-1&&(this.picturePosition=e.positionManager.registerSpecRunPosition(t)),(0,S.isDefined)(this.textBoxPosition)&&(this.parentSubDocument.positionManager.unregisterSpecRunPosition(),this.textBoxPosition=null),r>-1&&(this.textBoxPosition=e.positionManager.registerSpecRunPosition(r)),this.parentSubDocument=e,this.isAnchoredObject=i,this.textBoxInnerSubDocumentId=n}init(e,t){const r=e.subDocument;if(this.getActualTextBoxInnerSubDocumentId(t)!=r.id)if(e.multiselection||1!=e.interval.length)this.noSpecRun();else{const t=e.interval.start,i=r.getRunByPosition(t);switch(i.getType()){case cs.AnchoredTextBoxRun:this.setSpecRunInfo(r,-1,t,!0,i.subDocId);break;case cs.AnchoredPictureRun:this.setSpecRunInfo(r,t,-1,!0,-1);break;case cs.InlinePictureRun:this.setSpecRunInfo(r,t,-1,!1,-1);break;default:this.noSpecRun()}}}getTextBoxInnerSubDocumentId(){return this.textBoxInnerSubDocumentId}get isSelectedAnchorObject(){return this.isAnchoredObject}getParentSubDocument(){return this.parentSubDocument}getPosition(){return this.picturePos>-1?this.picturePos:this.textBoxPos}getPicturePosition(){return this.picturePos}getTextBoxPosition(){return this.textBoxPos}isPictureSelected(){return this.picturePos>-1}isTextBoxSelected(){return this.textBoxPos>-1}isSelected(){return this.isPictureSelected()||this.isTextBoxSelected()}clone(){const e=new ep;return e.picturePosition=this.picturePosition,e.textBoxPosition=this.textBoxPosition,e.parentSubDocument=this.parentSubDocument,e.isAnchoredObject=this.isAnchoredObject,e.textBoxInnerSubDocumentId=this.textBoxInnerSubDocumentId,e}getActualTextBoxInnerSubDocumentId(e){return this.textBoxInnerSubDocumentId<1||(this.textBoxInnerSubDocumentId=e.subDocumentsCollection.collection[this.textBoxInnerSubDocumentId].getActualSubDocument().id),this.textBoxInnerSubDocumentId}}class tp{resetTableInfo(){this._tableInfo=null}get tableInfo(){return this._tableInfo||(this._tableInfo=(new Qu).calculate(this.subDocument.tables,this.intervals)),this._tableInfo}get subDocument(){var e;return this._subDocument=null===(e=this._subDocument)||void 0===e?void 0:e.getActualSubDocument()}set subDocument(e){this._subDocument=e}get intervals(){return this._intervals}set intervals(e){this._intervals=e,this.lastIntervalIndex=e.length-1}get interval(){return this.intervals[this.lastIntervalIndex]}set interval(e){this._intervals=[e],this.lastIntervalIndex=0}get position(){return this.interval.start}set position(e){this._intervals=[new on.FixedInterval(e,0)],this.lastIntervalIndex=0}get subDocIntervals(){return new mu(this.subDocument,f.ListUtils.deepCopy(this.intervals))}get subDocInterval(){return new gu(this.subDocument,this.interval.clone())}get subDocPosition(){return new pu(this.subDocument,this.position)}get multiselection(){return this.intervals.length>1}get isCollapsed(){return!this._intervals[1]&&this._intervals[0].isCollapsed()}constructor(e,t,r=t.length-1){this.specialRunInfo=new ep,this.subDocument=e,this._intervals=t,this.lastIntervalIndex=r,this._tableInfo=null}static fromPosition(e,t){return new tp(e,[new on.FixedInterval(t,0)],0)}static fromInterval(e,t){return new tp(e,[t],0)}validateInterval(){const e=this.subDocument.getDocumentEndPosition();for(let t of this.intervals)t.start=Math.max(e-1,t.start),t.end=Math.max(e,t.end)}equals(e){return e&&this.subDocument.id==e.subDocument.id&&e._intervals&&f.ListUtils.equals(this._intervals,e._intervals)&&this.lastIntervalIndex==e.lastIntervalIndex}clone(){const e=new tp(this.subDocument,f.ListUtils.deepCopy(this._intervals),this.lastIntervalIndex);return e._tableInfo=this._tableInfo,e.specialRunInfo=this.specialRunInfo.clone(),e}}class rp{constructor(e,t){this.needCorrectParams=e,this.needCheckParams=t}fail(e){if(O.isDebug)throw new Error(e);return!1}correctAndCheckParams(){return this.needCorrectParams&&this.correctParams(),!(this.needCheckParams&&!this.checkParams())}innerCheck(e,t){return e||this.fail(t),e}}class ip extends rp{constructor(e){super(!0,!0),this.subDocPos=e}correctParams(){const e=this.subDocPos.subDocument.getDocumentEndPosition();this.subDocPos.position=P.MathUtils.restrictValue(this.subDocPos.position,0,e-1)}checkParams(){const e=this.subDocPos.subDocument.getDocumentEndPosition();return this.innerCheck(this.subDocPos.position>=0&&this.subDocPos.position<e,R.D.InternalException)}}class np extends ip{constructor(e,t){super(e),this.charPropsBundle=t}checkParams(){return super.checkParams()&&this.innerCheck(!!this.charPropsBundle.props,R.D.InternalException)&&this.innerCheck(!!this.charPropsBundle.style,R.D.InternalException)}}class op extends np{constructor(e,t,r,i){super(e,t),this.text=i,this.runType=r}clone(){return new op(this.subDocPos,this.charPropsBundle,this.runType,this.text)}}class ap extends op{constructor(e,t){super(e,t,cs.LayoutDependentRun,an.specialCharacters.LayoutDependentText)}}!function(e){e[e.start=0]="start",e[e.addedParsersCodePart=1]="addedParsersCodePart",e[e.updatedParsersCodePart=2]="updatedParsersCodePart",e[e.resultPartCreated=3]="resultPartCreated",e[e.addedParsersResultPart=4]="addedParsersResultPart",e[e.end=5]="end"}(Nu||(Nu={})),function(e){e[e.Error=0]="Error",e[e.DateAndTime=1]="DateAndTime",e[e.Numeric=2]="Numeric",e[e.General=3]="General",e[e.FieldSpecific=4]="FieldSpecific"}(ku||(ku={})),function(e){e[e.NonMailMerge=1]="NonMailMerge",e[e.MailMerge=2]="MailMerge",e[e.Mixed=3]="Mixed"}(Ou||(Ou={}));class sp{constructor(e,t,r){this.name=t,this.type=e,this.arg=r}}class lp{constructor(e,t,r=!1){this.text=t,this.interval=e,this.quoted=r}clone(){return new lp(this.interval.clone(),this.text,this.quoted)}}class dp{static isWhitespaceAndTextRunType(e,t){return an.isWhitespace.test(e)&&t==cs.TextRun}static isBackslesh(e){return"\\"==e}static isQuote(e){return'"'==e}}class cp{constructor(e){this.switchInfoList=[],this.parameterInfoList=[],this.modelManager=e.modelManager,this.layoutFormatterManager=e.layoutFormatterManager,this.requestManager=e.requestManager,this.subDocument=e.subDocument,this.inputPos=(new ju).setIntervals(tp.fromPosition(e.subDocument,e.field.getResultInterval().start)),this.fieldsStack=[e.field],this.modelIterator=e.modelIterator,this.lowLevelParsers=[],this.parserState=Nu.start,this.fieldNameFirstLetterPosition=e.subDocument.positionManager.registerPosition(e.fieldNameFirstLetterPosition)}removeInterval(e){this.modelManager.modelManipulator.range.removeInterval(new gu(this.subDocument,e),!0,!1)}replaceTextByInterval(e,t){this.removeInterval(e),this.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(this.subDocument,e.start),this.inputPos.charPropsBundle,cs.TextRun,t))}replaceTextByLayoutDependentRun(e){this.removeInterval(e),this.modelManager.modelManipulator.text.insertTextViaHistory(new ap(new pu(this.subDocument,e.start),this.inputPos.charPropsBundle))}static finalAction(e,t,r){t.showCode=!1,e&&e.invalidator.onIntervalChanged(r.id,t.getAllFieldInterval())}destructor(){this.subDocument.positionManager.unregisterPosition(this.fieldNameFirstLetterPosition),this.fieldNameFirstLetterPosition=null,cp.finalAction(this.layoutFormatterManager,this.getTopField(),this.subDocument)}getMailMergeType(){throw new Error(R.D.NotImplemented)}handleSwitch(e){return this.switchInfoList.push(e),!0}handleParameter(e){return this.parameterInfoList.push(e),!0}getFormattedResult(e){if(!(0,S.isDefined)(e))return null;const t=this.modelManager;let r=ku.Error,i="";for(let e,t=0;e=this.switchInfoList[t];t++)if(e.type!=ku.FieldSpecific){i=e.arg,r=e.type;break}const n="string"==typeof e?parseInt(e):e;if(r!=ku.General||rn.StringUtils.isNullOrEmpty(i)){if(r==ku.DateAndTime){const r=isNaN(n)?new Date(e.toString()):new Date(n);if(!isNaN(r.getDate())){const e=new zu.J(t.richOptions.cultureOpts);return rn.StringUtils.isNullOrEmpty(i)?e.format(r,t.richOptions.fields.defaultDateFormat):e.format(r,i)}}else if(r==ku.Numeric&&!isNaN(n)&&!rn.StringUtils.isNullOrEmpty(i))return t.model.simpleFormattersManager.formatNumber(i,n)}else{if(!isNaN(n))return Oa.createConverterByTypeName(i,t.model.simpleFormattersManager).convertNumber(n);if("string"==typeof e)switch(i.toLowerCase()){case"upper":return e.toLocaleUpperCase();case"lower":return e.toLocaleLowerCase();case"firstcap":return this.capitalizesFirstLetterOfFirstWord(e);case"caps":return this.capitalizesFirstLetterOfEachWord(e);default:return e}}return e.toString()}capitalizesFirstLetterOfFirstWord(e){let t=e;return t.length>0&&(t=this.replaceCharacter(t,0,t[0].toLocaleUpperCase())),t}capitalizesFirstLetterOfEachWord(e){let t=e.toLocaleLowerCase(),r=this.skipCharacters(0,t,(e=>!this.isLetterOrDigit(e)));for(;r<t.length;)t=this.replaceCharacter(t,r,t[r].toLocaleUpperCase()),r=this.skipCharacters(r,t,(e=>this.isLetterOrDigit(e))),r=this.skipCharacters(r,t,(e=>!this.isLetterOrDigit(e)));return t}replaceCharacter(e,t,r){return e.substr(0,t)+r+e.substr(t+1)}skipCharacters(e,t,r){for(;e<t.length&&r(t[e]);)e++;return e}isLetterOrDigit(e){return 1==e.length&&(!!e.match(/[0-9]/i)||e.toLocaleLowerCase()!=e.toLocaleUpperCase())}setInputPositionState(){this.inputPos.setIntervals(tp.fromPosition(this.subDocument,this.fieldNameFirstLetterPosition.value))}getTopField(){return this.fieldsStack[0]}update(e){if(this.parserState==Nu.end)throw new Error("Excess call updated field");switch(this.parserState){case Nu.start:var t=this.getTopField();return this.collectAndUpdateLowLevelFields(t.index+1,t.getCodeStartPosition(),t.getSeparatorPosition())?(this.parserState=Nu.updatedParsersCodePart,this.parseCodeCurrentField(null)):(this.parserState=Nu.addedParsersCodePart,!1);case Nu.addedParsersCodePart:return!!this.updateLowLevelFields(e)&&(this.parserState=Nu.updatedParsersCodePart,this.parseCodeCurrentField(e));case Nu.updatedParsersCodePart:return this.parseCodeCurrentField(e);case Nu.addedParsersResultPart:return this.updateFieldsInResult(e)}}collectAndUpdateLowLevelFields(e,t,r){for(var i,n=this.subDocument.fields;(i=n[e])&&!(i.getFieldStartPosition()>r);e++)if(i.parent!=this.getTopField()||i.getFieldEndPosition()<=t)e++;else{var o=Jg.getParser(this.modelManager,this.layoutFormatterManager,this.requestManager,this.subDocument,i);o?o.update(null)?o.destructor():this.lowLevelParsers.push(o):this.removeInterval(i.getResultInterval())}return 0==this.lowLevelParsers.length}updateLowLevelFields(e){for(var t,r=0;t=this.lowLevelParsers[r];r++)t.update(e)&&(t.destructor(),this.lowLevelParsers.splice(r,1),r--);return 0==this.lowLevelParsers.length}parseCodeCurrentField(e){if(!this.parseCodeCurrentFieldInternal(e)){if(this.parserState==Nu.updatedParsersCodePart)return!1;throw new Error("wrong way")}switch(this.parserState){case Nu.resultPartCreated:return this.updateFieldsInResult(e);case Nu.end:return!0;default:throw new Error("wrong way")}}updateFieldsInResult(e){switch(this.parserState){case Nu.resultPartCreated:var t=Md.normedBinaryIndexOf(this.subDocument.fields,this.getTopField().getResultStartPosition()+1),r=this.getTopField();return this.collectAndUpdateLowLevelFields(t,r.getResultStartPosition(),r.getResultEndPosition())?(this.parserState=Nu.end,!0):(this.parserState=Nu.addedParsersResultPart,!1);case Nu.addedParsersResultPart:return!!this.updateLowLevelFields(e)&&(this.parserState=Nu.end,!0)}}moveIteratorToNextChar(){if(this.modelIterator.run.getType()==cs.FieldCodeEndRun)return!1;if(!this.modelIterator.moveToNextChar())throw new Error("wrong way");for(;;)switch(this.modelIterator.run.getType()){case cs.FieldCodeStartRun:var e=Md.normedBinaryIndexOf(this.subDocument.fields,this.modelIterator.getAbsolutePosition()+1),t=this.subDocument.fields[e];this.fieldsStack.push(t),this.modelIterator.setPosition(t.getResultStartPosition());break;case cs.FieldResultEndRun:case cs.FieldCodeEndRun:t=this.fieldsStack.pop();if(0==this.fieldsStack.length)return this.fieldsStack.push(t),!1;this.modelIterator.setPosition(t.getFieldEndPosition());break;default:return!0}}updateInfo(){return!!this.needUpdateInfo()&&(this.parseSwitchesAndArgs(),this.updateInfoCore(),!0)}needUpdateInfo(){return!1}updateInfoCore(){}parseSwitchesAndArgs(){for(;this.skipWhitespaces()&&this.modelIterator.run.getType()!=cs.FieldCodeEndRun;){var e=this.modelIterator.getCurrentChar();if(dp.isBackslesh(e)){var t=this.getSwitchInfo();if(t.type==ku.Error||!this.handleSwitch(t))return!1}else{var r=this.getFieldParameterInfo();if(!r||!this.handleParameter(r))return!1}}return this.modelIterator.run.getType()==cs.FieldCodeEndRun}skipWhitespaces(){var e=!1;do{if(!dp.isWhitespaceAndTextRunType(this.modelIterator.getCurrentChar(),this.modelIterator.run.getType())&&this.modelIterator.run.getType()!=cs.ParagraphRun&&this.modelIterator.run.getType()!=cs.SectionRun)break;e=!0}while(this.moveIteratorToNextChar());return e}getFieldParameterInfo(){var e=this.modelIterator.getAbsolutePosition(),t=this.parseSwitchOrFieldArgument();if(!t)return null;var r=t.quoted?on.FixedInterval.fromPositions(e+1,this.modelIterator.getAbsolutePosition()-1):on.FixedInterval.fromPositions(e,this.modelIterator.getAbsolutePosition());return new lp(r,t.argListChars.join(""),t.quoted)}getSwitchInfo(){if(!this.moveIteratorToNextChar()||this.modelIterator.run.getType()!=cs.TextRun)return new sp(ku.Error,"","");var e=this.modelIterator.getCurrentChar();switch(e){case"*":return this.makeSwitchInfo(ku.General,e,!0);case"@":return this.makeSwitchInfo(ku.DateAndTime,e,!0);case"#":return this.makeSwitchInfo(ku.Numeric,e,!0);default:if("!"==e)return this.makeSwitchInfo(ku.FieldSpecific,e,!0);if(!an.isLatinLetter.test(e))return new sp(ku.Error,"","");var t=e,r=this.modelIterator.getAbsolutePosition();return this.moveIteratorToNextChar()?(e=this.modelIterator.getCurrentChar(),an.isLatinLetter.test(e)?t+=e:this.modelIterator.setPosition(r)):this.modelIterator.setPosition(r),this.makeSwitchInfo(ku.FieldSpecific,t,!1)}}makeSwitchInfo(e,t,r){var i=this.getSwitchArgument(r);return null===i||r&&0==i.length?new sp(ku.Error,"",""):new sp(e,t,i)}getSwitchArgument(e){if(!this.moveIteratorToNextChar())return e?null:"";if(!this.skipWhitespaces())return null;var t=this.parseSwitchOrFieldArgument();if(!t)return e?null:"";var r=t.argListChars.join("");return 0==r.length?null:r}parseSwitchOrFieldArgument(){if(this.modelIterator.run.getType()==cs.FieldCodeEndRun)return null;var e=this.modelIterator.getCurrentChar();if(dp.isBackslesh(e))return this.modelIterator.moveToPrevChar(),null;var t=[],r=this.fieldsStack.length,i=r,n=dp.isQuote(e);if(n&&!this.moveIteratorToNextChar())return null;var o=!n;do{if(e=this.modelIterator.getCurrentChar(),n){if(dp.isQuote(e)){var a=t[t.length-1];if(!a||!dp.isBackslesh(a)){o=!0,i=this.fieldsStack.length,this.moveIteratorToNextChar();break}}}else if(dp.isWhitespaceAndTextRunType(e,this.modelIterator.run.getType()))break;t.push(e),i=this.fieldsStack.length}while(this.moveIteratorToNextChar());return r==i&&o?{argListChars:t,quoted:n}:null}}!function(e){e[e.Unknown=0]="Unknown",e[e.Time=1]="Time",e[e.Date=2]="Date",e[e.Page=3]="Page",e[e.NumPages=4]="NumPages",e[e.MergeField=5]="MergeField",e[e.DocVariable=6]="DocVariable",e[e.Hyperlink=7]="Hyperlink",e[e.Seq=8]="Seq",e[e.Tc=9]="Tc",e[e.PageRef=10]="PageRef",e[e.Toc=11]="Toc",e[e.FillIn=12]="FillIn",e[e.If=13]="If"}(_u||(_u={}));class hp extends Ze{constructor(e,t,r,i){super(e),this.boundSubDocument=t,this.newInfo=i,this.fieldIndex=r}redo(){this.oldInfo=this.modelManipulator.field.setHyperlinkInfoInner(this.boundSubDocument,this.fieldIndex,this.newInfo)}undo(){this.modelManipulator.field.setHyperlinkInfoInner(this.boundSubDocument,this.fieldIndex,this.oldInfo)}}class up{constructor(e,t,r,i){this.subDocumentId=e,this.startPosition=t,this.separatorPosition=r,this.endPosition=i,this.type=pd.FieldInserted}}class pp extends Ze{constructor(e,t,r,i,n,o,a){super(e),this.subDocument=t,this.startFieldPos=r,this.separatorPos=this.startFieldPos+1+i,this.endPos=this.separatorPos+1+n+1,this.showCode=o,this.charPropsBundle=a}redo(){var e=an.specialCharacters,t=this.modelManipulator.text;const r=this.charPropsBundle.style,i=this.charPropsBundle.props;t.insertTextInner(new op(new pu(this.subDocument,this.startFieldPos),new pn(i,r),cs.FieldCodeStartRun,e.FieldCodeStartRun)),t.insertTextInner(new op(new pu(this.subDocument,this.separatorPos),new pn(i,r),cs.FieldCodeEndRun,e.FieldCodeEndRun)),t.insertTextInner(new op(new pu(this.subDocument,this.endPos-1),new pn(i,r),cs.FieldResultEndRun,e.FieldResultEndRun));var n=this.subDocument.fields,o=Md.normedBinaryIndexOf(n,this.startFieldPos+1)+1,a=new Md(this.subDocument.positionManager,o,this.startFieldPos,this.separatorPos,this.endPos,this.showCode,void 0);Md.addField(n,a),this.modelManipulator.notifyModelChanged(new up(this.subDocument.id,this.startFieldPos,this.separatorPos,this.endPos))}undo(){this.modelManipulator.range.removeIntervalWithoutHistory(this.subDocument,new on.FixedInterval(this.startFieldPos,1),!1),this.modelManipulator.range.removeIntervalWithoutHistory(this.subDocument,new on.FixedInterval(this.endPos-2,1),!1),this.modelManipulator.range.removeIntervalWithoutHistory(this.subDocument,new on.FixedInterval(this.separatorPos-1,1),!1)}}class gp extends cp{getMailMergeType(){return Ou.NonMailMerge}parseCodeCurrentFieldInternal(e){return this.removeInterval(this.getTopField().getResultInterval()),this.parseSwitchesAndArgs()&&this.fillResult(),this.parserState=Nu.end,!0}createLocalHyperLink(e,t){this.modelManager.history.addAndRedo(new pp(this.modelManager.modelManipulator,this.subDocument,e.start,0,e.length,!1,this.inputPos.charPropsBundle));let r=Md.normedBinaryIndexOf(this.subDocument.fields,e.start+1),i=this.subDocument.fields[r];const n=new xd("",t,"",!1);this.modelManager.history.addAndRedo(new hp(this.modelManager.modelManipulator,this.subDocument,i.index,n)),this.inputPos.setIntervals(tp.fromInterval(this.subDocument,i.getCodeInterval())),this.replaceTextByInterval(i.getCodeInterval(),this.modelManager.model.simpleFormattersManager.formatString('HYPERLINK \\l "{0}"',t))}fillResult(){throw new Error(R.D.NotImplemented)}}class mp extends gp{get name(){return _u.Date}fillResult(){const e=new zu.J(this.modelManager.richOptions.cultureOpts),t=new Date;let r;for(var i,n=[],o=0;i=this.switchInfoList[o];o++)i.type==ku.DateAndTime&&n.push(i);if(1===n.length)r=e.format(t,n[0].arg);else r=e.format(t,this.getDefaultFormat());return r&&(this.setInputPositionState(),this.replaceTextByInterval(this.getTopField().getResultInterval(),r)),!0}getDefaultFormat(){return this.modelManager.richOptions.fields.defaultDateFormat}}class fp{static convertFromJSON(e){const t=e[Dc.ActualId];return new co(e[Dc.Base64],t,e[Dc.TmpId],e[Dc.Url],void 0,void 0,Fh.convertFromJSON(e[Dc.Size]),null!=t)}static convertToJSON(e,t){return{[Dc.Base64]:t?e.base64:void 0,[Dc.ActualId]:e.actualId,[Dc.TmpId]:e.tmpId,[Dc.Url]:e.imageUrl,[Dc.Size]:Fh.convertToJSON(e.size)}}static translateImageCorrespondence(e,t){return f.ListUtils.map(e,(e=>{const r=fp.convertFromJSON(e);return r.actualId=t[r.actualId],fp.convertToJSON(r,!0)}))}static importImageCache(e,t,r){if(r){const n=t?fp.translateImageCorrespondence(r,t):r;for(var i of n)e.registerPictureData(fp.convertFromJSON(i))}}}class bp{applyInverseDefaultGamma(e){return e<0?0:e<=.04045?e/12.92:e<1?Math.pow((e+.055)/1.055,2.4):1}applyInverseDefaultGammaByColor(e){return U.fromRgb(this.toIntValue(this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getRed(e)))),this.toIntValue(this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getGreen(e)))),this.toIntValue(this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getBlue(e)))))}applyDefaultGamma(e){return e<0?0:e<=.0031308?12.92*e:e<1?1.055*Math.pow(e,1/2.4)-.055:1}applyDefaultGammaByColor(e){return U.fromRgb(this.toIntValue(this.applyDefaultGamma(this.toDoubleValue(w.i.getRed(e)))),this.toIntValue(this.applyDefaultGamma(this.toDoubleValue(w.i.getGreen(e)))),this.toIntValue(this.applyDefaultGamma(this.toDoubleValue(w.i.getBlue(e)))))}toDoubleValue(e){return e/255}toIntValue(e){return this.getFixRGBValue(Math.round(255*e))}getFixRGBValue(e){return P.MathUtils.restrictValue(e,0,255)}}class Cp extends bp{constructor(e){super(),this.value=e}equals(e){return e&&e instanceof Cp&&this.value==e.value}getRGBFromValue(){const e=this.value/_.ThousandthOfPercentage;return this.toIntValue(this.applyDefaultGamma(e))}applyRGBOffsetNormalized(e,t){return this.getFixRGBNormalValue(e+t)}applyRGBOffset(e){var t=this.value/_.ThousandthOfPercentage;return this.toIntValue(this.applyDefaultGamma(this.applyRGBOffsetNormalized(this.applyInverseDefaultGamma(this.toDoubleValue(e)),t)))}applyRGBModulationNormalized(e,t){return this.getFixRGBNormalValue(e*t)}applyRGBModulation(e){const t=this.value/_.ThousandthOfPercentage;return this.applyRGBModulationCore(e,t)}getFixRGBNormalValue(e){return P.MathUtils.restrictValue(e,0,1)}applyRGBModulationCore(e,t){return this.toIntValue(this.applyDefaultGamma(this.applyRGBModulationNormalized(this.applyInverseDefaultGamma(this.toDoubleValue(e)),t)))}}class Sp extends Cp{static createFromAlpha(e){return new Sp(Math.floor(e*_.ThousandthOfPercentage/255))}applyTransform(e){return U.fromArgb(this.toIntValue(this.value/_.ThousandthOfPercentage),e)}clone(){return new Sp(this.value)}}class Ip{constructor(e=[]){this.transforms=e}applyTransform(e){for(let t of this.transforms)t.applyTransform(e);return e}add(e){this.transforms.push(e)}equals(e){return e&&f.ListUtils.allOf2(this.transforms,e.transforms,((e,t)=>e.equals(t)))}clear(){this.transforms=[]}clone(){return new Ip(f.ListUtils.deepCopy(this.transforms))}}class Pp{constructor(e,t=new Ip){this.transforms=t,this.color=e}static createByDrawingColorModel(e){return new Pp(e)}static createByColor(e){const t=w.i.getAlpha(e);return 255==t?new Pp(Bn.createARGB(e)):new Pp(Bn.createRGB(e),new Ip([Sp.createFromAlpha(t)]))}get isEmpty(){return 0==this.transforms.transforms.length&&this.color.isEmpty}finalColor(e){return this.toRgb(e,U.empty)}get originalColor(){return this}setColorFromRGB(e){const t=w.i.getAlpha(e);255==t?this.rgb=e:(this.rgb=U.fromArgb(255,e),this.transforms.add(Sp.createFromAlpha(t)))}get rgb(){return this.color.rgb}set rgb(e){this.color.rgb==e&&this.color.colorType==W.Rgb||(this.color.rgb=e)}get system(){return this.color.systemColor}set system(e){this.color.systemColor==e&&this.color.colorType==W.System||(this.color.systemColor=e)}get scheme(){return this.color.schemeColor}set scheme(e){this.color.schemeColor==e&&this.color.colorType==W.Scheme||(this.color.schemeColor=e)}get preset(){return this.color.preset}set preset(e){this.color.preset==e&&this.color.colorType==W.Preset||(this.color.preset=e)}get hsl(){return this.color.hsl}set hsl(e){this.color.hsl.equals(e)&&this.color.colorType==W.Hsl||(this.color.hsl=e)}get scRgb(){return this.color.scRgb}set scRgb(e){this.color.scRgb.equals(e)&&this.color.colorType==W.ScRgb||(this.color.scRgb=e)}get colorType(){return this.color.colorType}toRgb(e,t){return this.transforms.applyTransform(this.color.toRgb(e,t))}get type(){return Zn.Color}equals(e){return e&&this.color.equals(e.color)&&this.transforms.equals(e.transforms)}clear(){this.color=An.defaultItem,this.transforms.clear()}clone(){return new Pp(this.color.clone(),this.transforms.clone())}}class wp{static convertFromJSON(e){const t=yp.convertFromJSON(e[G.Color]);return new Pp(t)}}class yp{static convertFromJSON(e){const t=new Bn;return t._rgb=e[K.Rgb],t._systemColor=e[K.System],t._schemeColor=e[K.Scheme],t._preset=e[K.Preset],t._hsl=xp.convertFromJSON(e[K.Hsl]),t._scRgb=Tp.convertFromJSON(e[K.ScRgb]),t._colorType=e[K.ColorType],t}}class xp{static convertFromJSON(e){const t=e[q.Hue],r=e[q.Saturation],i=e[q.Luminance];return new H(t,r,i)}}class Tp{static convertFromJSON(e){const t=e[$.ScR],r=e[$.ScG],i=e[$.ScB];return new Ln(t,r,i)}}class vp extends Za{constructor(e,t,r,i,n,o,a,s){super(e,t,r,i,n,o,s),this.numberingListIndex=a}clone(){return new vp(this.styleName,this.localizedName,this.deleted,this.hidden,this.semihidden,this.isDefault,this.numberingListIndex,this.id)}}class Mp{static importStyles(e,t){Mp.importCharacterStyles(e,t[hs.Character]),Mp.importParagraphStyles(e,t[hs.Paragraph]),Mp.importNumberingStyles(e,t[hs.NumberingList]),Mp.importTableStyles(e,t[hs.Table]),Mp.finishCharacterStylesImport(e,t[hs.Character]),Mp.finishParagraphStylesImport(e,t[hs.Paragraph]),Mp.finishNumberingListStylesImport(e,t[hs.NumberingList]),Mp.finishTableStylesImport(e,t[hs.Table])}static exportStyles(e){let t={};return t[hs.Character]=Mp.exportCharacterStyles(e),t[hs.Paragraph]=Mp.exportParagraphStyles(e),t[hs.NumberingList]=Mp.exportNumberingStyles(e),t[hs.Table]=Mp.exportTableStyles(e),t}static exportCharacterStyles(e){let t=[];for(let r of e.characterStyles){let i={};i[ps.StyleName]=r.styleName,i[ps.Deleted]=(0,S.boolToInt)(r.deleted),i[ps.Hidden]=(0,S.boolToInt)(r.hidden),i[ps.ParentStyleName]=r.parent?r.parent.styleName:"",i[ps.Semihidden]=(0,S.boolToInt)(r.semihidden),i[ps.LocalizedStyleName]=r.localizedName,i[ps.IsDefault]=(0,S.boolToInt)(r.isDefault),i[ps.Base64EncodedImage]=r.base64EncodedImage,i[gs.LinkedStyleName]=r.linkedStyle?r.linkedStyle.styleName:"",i[gs.CharacterPropertiesCacheIndex]=e.characterStyles.indexOf(r),t.push(i)}return t}static exportParagraphStyles(e){const t=e.cache.maskedCharacterPropertiesCache,r=e.cache.maskedParagraphPropertiesCache;let i=[];for(let n of e.paragraphStyles){let e={};e[ps.StyleName]=n.styleName,e[ps.Deleted]=(0,S.boolToInt)(n.deleted),e[ps.Hidden]=(0,S.boolToInt)(n.hidden),e[ps.ParentStyleName]=n.parent?n.parent.styleName:"",e[ps.Semihidden]=(0,S.boolToInt)(n.semihidden),e[ps.LocalizedStyleName]=n.localizedName,e[ps.IsDefault]=(0,S.boolToInt)(n.isDefault),e[ps.Base64EncodedImage]=n.base64EncodedImage,e[ms.CharacterPropertiesCacheIndex]=t.indexOf(n.maskedCharacterProperties),e[ms.ParagraphPropertiesCacheIndex]=r.indexOf(n.maskedParagraphProperties),e[ms.LinkedStyleName]=n.linkedStyle?n.linkedStyle.styleName:"",e[ms.NextParagraphStyleName]=n.nextParagraphStyle?n.nextParagraphStyle.styleName:"",e[ms.AutoUpdate]=(0,S.boolToInt)(n.autoUpdate),e[ms.Tabs]=jl.convertFromTabPropertiesToJSON(n.tabs),e[ms.NumberingListIndex]=n.numberingListIndex,e[ms.ListLevelIndex]=n.listLevelIndex,i.push(e)}return i}static exportNumberingStyles(e){let t=[];for(let r of e.numberingListStyles){let e={};e[ps.StyleName]=r.styleName,e[ps.Deleted]=(0,S.boolToInt)(r.deleted),e[ps.Hidden]=(0,S.boolToInt)(r.hidden),e[ps.ParentStyleName]=r.parent?r.parent.styleName:"",e[ps.Semihidden]=(0,S.boolToInt)(r.semihidden),e[ps.LocalizedStyleName]=r.localizedName,e[ps.IsDefault]=(0,S.boolToInt)(r.isDefault),e[ps.Base64EncodedImage]=r.base64EncodedImage,e[fs.NumberingListIndex]=r.numberingListIndex,t.push(e)}return t}static exportTableStyles(e){let t=[];for(let r of e.tableStyles){let i={};i[ps.StyleName]=r.styleName,i[ps.Deleted]=(0,S.boolToInt)(r.deleted),i[ps.Hidden]=(0,S.boolToInt)(r.hidden),i[ps.ParentStyleName]=r.parent?r.parent.styleName:"",i[ps.Semihidden]=(0,S.boolToInt)(r.semihidden),i[ps.LocalizedStyleName]=r.localizedName,i[ps.IsDefault]=(0,S.boolToInt)(r.isDefault),i[ps.Base64EncodedImage]=r.base64EncodedImage,i[bs.BaseConditionalStyle]=Yl.convertToJSON(e,r.baseConditionalStyle),i[bs.ConditionalStyles]=Yl.convertStylesToJSON(e,r.conditionalStyles),t.push(i)}return t}static importCharacterStyles(e,t){const r=e.cache.maskedCharacterPropertiesCache,i=e.characterStyles;for(let e of t)i.push(new zl(e[ps.StyleName],e[ps.LocalizedStyleName],!!e[ps.Deleted],!!e[ps.Hidden],!!e[ps.Semihidden],!!e[ps.IsDefault],r.getItemByJsonKey(e[gs.CharacterPropertiesCacheIndex]),e[ps.Base64EncodedImage]))}static importParagraphStyles(e,t){const r=e.cache.maskedCharacterPropertiesCache,i=e.cache.maskedParagraphPropertiesCache,n=e.paragraphStyles;for(let e of t)n.push(new es(e[ps.StyleName],e[ps.LocalizedStyleName],!!e[ps.Deleted],!!e[ps.Hidden],!!e[ps.Semihidden],!!e[ps.IsDefault],r.getItemByJsonKey(e[ms.CharacterPropertiesCacheIndex]),i.getItemByJsonKey(e[ms.ParagraphPropertiesCacheIndex]),jl.convertFromJSONToTabProperties(e[ms.Tabs]),!!e[ms.AutoUpdate],e[ms.NumberingListIndex],e[ms.ListLevelIndex],e[ps.Base64EncodedImage]))}static importNumberingStyles(e,t){const r=e.numberingListStyles;for(let e of t)r.push(new vp(e[ps.StyleName],e[ps.LocalizedStyleName],!!e[ps.Deleted],!!e[ps.Hidden],!!e[ps.Semihidden],!!e[ps.IsDefault],e[fs.NumberingListIndex]))}static importTableStyles(e,t){const r=e.tableStyles;for(let i of t)r.push(new Vh(i[ps.StyleName],i[ps.LocalizedStyleName],!!i[ps.Deleted],!!i[ps.Hidden],!!i[ps.Semihidden],!!i[ps.IsDefault],Yl.convertStylesFromJSON(i[bs.ConditionalStyles],e.cache),Yl.convertFromJSON(i[bs.BaseConditionalStyle],e.cache),i[ps.Base64EncodedImage]))}static finishCharacterStylesImport(e,t){for(var r,i=0;r=e.characterStyles[i];i++){const n=t[i],o=n[ps.ParentStyleName];o&&(r.parent=e.getCharacterStyleByName(o));const a=n[gs.LinkedStyleName];void 0!==a&&(r.linkedStyle=e.getParagraphStyleByName(a))}}static finishParagraphStylesImport(e,t){for(var r,i=0;r=e.paragraphStyles[i];i++){const n=t[i],o=n[ps.ParentStyleName];o&&(r.parent=e.getParagraphStyleByName(o));const a=n[ms.LinkedStyleName];void 0!==a&&(r.linkedStyle=e.getCharacterStyleByName(a));const s=n[ms.NextParagraphStyleName];void 0!==s&&(r.nextParagraphStyle=e.getParagraphStyleByName(s))}}static finishNumberingListStylesImport(e,t){for(var r,i=0;r=e.numberingListStyles[i];i++)r.parent=e.getNumberingListStyleByName(t[i][ps.ParentStyleName])}static finishTableStylesImport(e,t){for(var r,i=0;r=e.tableStyles[i];i++)r.parent=e.getTableStyleByName(t[i][ps.ParentStyleName])}}class Ep{static importAbstractNumberingLists(e,t){for(let r of t)e.abstractNumberingLists.push(Ep.getAbstractNumbertingList(e,r))}static importNumberingLists(e,t){for(let r of t)e.numberingLists.push(Ep.getNumberingList(e,r))}static importAbstractNumberingListTemplates(e,t){if(t)for(let r of t)e.abstractNumberingListTemplates.push(Ep.getAbstractNumbertingList(e,r))}static getAbstractNumbertingList(e,t){var r=new dn(e);return r.deleted=!!t[fl.Deleted],r.innerId=t[fl.Id],r.levels=Ep.getAbstractNumberingListLevels(e,t[fl.Levels]),r}static getNumberingList(e,t){var r=new cn(e,t[bl.AlIndex]);return r.deleted=!1,r.innerId=t[bl.Id],r.levels=Ep.getNumberingListLevels(e,t[bl.Levels],r),r}static getAbstractNumberingListLevels(e,t){const r=[];for(var i,n=0;i=t[n];n++){const t=e.cache.maskedCharacterPropertiesCache.getItemByJsonKey(i[Cl.CharacterPropertiesIndex]),n=e.cache.maskedParagraphPropertiesCache.getItemByJsonKey(i[Cl.ParagraphPropertiesIndex]),o=e.cache.listLevelPropertiesCache.getItemByJsonKey(i[Cl.ListLevelPropertiesIndex]);r.push(new Ji(e,t,n,o))}return r}static getNumberingListLevels(e,t,r){const i=[];for(let n of t){let t;if(void 0===n[Sl.Level]){const r=e.cache.maskedCharacterPropertiesCache.getItemByJsonKey(n[Cl.CharacterPropertiesIndex]),i=e.cache.maskedParagraphPropertiesCache.getItemByJsonKey(n[Cl.ParagraphPropertiesIndex]),o=e.cache.listLevelPropertiesCache.getItemByJsonKey(n[Cl.ListLevelPropertiesIndex]);t=new Qi(e,r,i,o)}else t=new Yi(r,n[Sl.Level]);t.setNewStart(n[Sl.NewStart]),t.overrideStart=!!n[Sl.OverrideStart],i.push(t)}return i}}class Dp{static insertDocumentModelFromServer(e,t,r,i){const n=e.model,o=new cm(n.modelOptions,0);o.cache.fontInfoCache=n.cache.fontInfoCache,o.cache.imageCache=n.cache.imageCache;const a=new Uh(o.cache,t[Qs.Caches],o),s=t[Qs.ImageCorrespondence];Dp.processNewDocumentResponse(o,s,t[Qs.DocumentModel]),a.importSubDocuments(e.richOptions.documentProtection,s);const l=n.subDocuments[i],d=e.modelManipulator.subDocument.insertSubDocument(new pu(l,r),new gu(o.mainSubDocument,new on.FixedInterval(0,t[Qs.DocumentLength])));return a.dispose(),d.insetedInterval}static processNewDocumentResponse(e,t,r){Dh.importDocumentProperties(e,r[To.DocumentProperties]),Dh.importCompatibilitySettings(e,r[To.CompatibilitySettings]),Mp.importStyles(e,r[To.Styles]),Dh.importModelHeaderFooter(e.headers,r[To.Headers],sd),Dh.importModelHeaderFooter(e.footers,r[To.Footers],ld),Dh.importSections(e,r[To.Sections]),Ep.importAbstractNumberingLists(e,r[To.AbstractNumberingLists]),Ep.importNumberingLists(e,r[To.NumberingLists]),Ep.importAbstractNumberingListTemplates(e,r[To.AbstractNumberingListTemplates]),fp.importImageCache(e.cache.imageCache,t,r[To.Images]);const i=r[To.PaletteColors];b.j.forEach(i,((t,r)=>e.colorProvider.palette.setColor(r,t)));const n=r[To.OfficeThemeColors];b.j.forEach(n,((t,r)=>e.colorProvider.officeTheme.colors.setDrawingColor(r,wp.convertFromJSON(t))))}}class Fp{constructor(){this.updateMap={}}getSubDocumentData(e){let t=this.updateMap[e.id];return t||(this.updateMap[e.id]=t={}),t}clear(e){this.updateMap[e.id]&&delete this.updateMap[e.id]}add(e,t){const r=this.getSubDocumentData(e),i=Fp.fieldId++;return r[i]=t,i}checkResponse(e,t){const r=this.getSubDocumentData(e);if(r&&((b.j.isEmpty(r)?t:!t)||b.j.containsBy(r,((e,r)=>!t[r]))))throw new Error(R.D.InternalException)}requestAsJson(e){return{[qs.ActiveRecord]:this.activeRecord,[qs.Info]:b.j.map(this.getSubDocumentData(e),(e=>e.asJson()))}}}Fp.fieldId=0;class Rp extends Fp{sendRequest(e,t,r){}forceSendDelayedRequests(){}}class Lp{}class Bp extends Lp{get serverUpdateFieldType(){return Uu.DocVariable}constructor(e,t,r){super(),this.fieldInterval=e,this.fieldName=t,this.parameters=r}asJson(){return{[$s.ServerUpdateFieldType]:this.serverUpdateFieldType,[$s.Data]:{[Js.FieldName]:this.fieldName,[Js.Parameters]:f.ListUtils.map(this.parameters,(e=>({[Ys.PureText]:e.text,[Ys.IntervalStart]:e.interval.start,[Ys.IntervalEnd]:e.interval.end})))}}}}class Ap extends Lp{get serverUpdateFieldType(){return Uu.MergeField}constructor(e){super(),this.fieldName=e}asJson(){return{[$s.ServerUpdateFieldType]:this.serverUpdateFieldType,[$s.Data]:{[Js.FieldName]:this.fieldName}}}}!function(e){e[e.DocVariable=1]="DocVariable",e[e.MergeField=2]="MergeField"}(Uu||(Uu={}));class Np extends cp{get name(){return _u.DocVariable}getMailMergeType(){return Ou.NonMailMerge}parseCodeCurrentFieldInternal(e){return e&&null!=this.fieldID&&e[this.fieldID]?(this.applyResponse(e[this.fieldID])?this.parserState=Nu.resultPartCreated:this.parserState=Nu.end,!0):this.parseSwitchesAndArgs()?(this.insertDefaultText()||!this.placeRequest())&&(this.parserState=Nu.end,!0):(this.parserState=Nu.end,!0)}insertDefaultText(){return!1}placeRequest(){return!(this.parameterInfoList.length<1)&&(this.fieldID=this.subDocument.fieldsWaitingForUpdate.requestManager.add(this.subDocument,this.getRequestData()),!0)}getRequestData(){return new Bp(this.getTopField().getAllFieldInterval(),this.parameterInfoList[0].text,f.ListUtils.map(this.parameterInfoList,(e=>e.clone()),1))}getFormattedResult(e){return an.replaceParagraphEndCharsWithLineBreak(super.getFormattedResult(e))}applyResponse(e){var t=this.getTopField().getResultInterval();this.setInputPositionState();var r=e[Qs.SimpleText];if(void 0!==r)return null!==r&&(""!==r?this.replaceTextByInterval(t,this.getFormattedResult(r)):this.removeInterval(t)),!0;if(e[Qs.Caches])return this.removeInterval(t),Dp.insertDocumentModelFromServer(this.modelManager,e,this.getTopField().getResultStartPosition(),this.subDocument.id),!0;{const r=e[Qs.DocumentModel];this.removeInterval(t),r.insertTo(this.modelManager.modelManipulator,new pu(this.subDocument,this.getTopField().getResultStartPosition()))}}}class kp extends tt{constructor(e,t,r,i){super(e,t),this.newStyle=r,this.restoreHyperlinks=i}redo(){this.oldState=this.modelManipulator.style.setCharacterStyle(this.boundSubDocument,this.interval,this.newStyle,this.restoreHyperlinks)}undo(){this.modelManipulator.style.restoreCharacterStyle(this.boundSubDocument,this.oldState)}}class Op extends tt{constructor(e,t,r){super(e,t),this.newStyle=r}redo(){this.oldState=this.modelManipulator.style.setParagraphStyle(this.boundSubDocument,this.interval,this.newStyle)}undo(){this.modelManipulator.style.restoreParagraphStyle(this.boundSubDocument,this.oldState)}}class _p extends Ze{constructor(e,t,r,i){super(e),this.newStyle=i,this.tableIndex=r,this.subDocument=t}redo(){this.oldStyle=this.subDocument.tables[this.tableIndex].style,this.modelManipulator.table.setTableStyle(this.subDocument,this.tableIndex,this.newStyle)}undo(){this.modelManipulator.table.setTableStyle(this.subDocument,this.tableIndex,this.oldStyle)}}class Up extends tt{constructor(e,t){super(e,t),this.historyItems=[]}redo(){if(void 0===Up.mask)throw new Error("CharacterPropertiesMask defined later than that class");if(this.historyItems.length>0)for(var e=0;i=this.historyItems[e];e++)i.redo();else{var t=this.modelManipulator.model.getCharacterStyleByName(zl.hyperlinkStyleName),r=this.interval.end;this.boundSubDocument.splitRun(this.interval.start),this.boundSubDocument.splitRun(r);var i,n=new jh(this.boundSubDocument,!1);n.setPosition(this.interval.start);do{var o=n.run,a=o.getCharacterMergedProperties(),s=new on.FixedInterval(n.chunk.startLogPosition.value+o.startOffset,o.getLength());(i=new kp(this.modelManipulator,this.subDocInterval,t,!1)).redo(),this.historyItems.push(i);for(let e of ir.whatNeedSetWhenCreateHyperlinkField)(i=new(e.getHistoryItemConstructor())(this.modelManipulator,new gu(this.boundSubDocument,s),e.getProp(a),!0)).redo(),this.historyItems.push(i);(i=new At(this.modelManipulator,new gu(this.boundSubDocument,s),Up.mask)).redo(),this.historyItems.push(i)}while(s.start<r&&n.moveToNextRun())}}undo(){for(var e,t=this.historyItems.length-1;e=this.historyItems[t];t--)e.undo();this.boundSubDocument.splitRun(this.interval.start),this.boundSubDocument.splitRun(this.interval.end);var r=new jh(this.boundSubDocument,!1);r.setPosition(this.interval.start);do{}while(r.chunk.startLogPosition.value+r.run.startOffset<this.interval.end&&r.moveToNextRun())}}Up.mask=ie.UseAll&~(ie.UseFontUnderlineType|ie.UseUnderlineWordsOnly|ie.UseForeColorIndex);class Hp extends gp{get name(){return _u.Hyperlink}parseCodeCurrentFieldInternal(e){return this.parseSwitchesAndArgs()?this.fillResult():this.removeInterval(this.getTopField().getResultInterval()),this.parserState=Nu.end,!0}fillResult(){var e,t;const r=this.getTopField(),i=null!==(t=null===(e=this.parameterInfoList[0])||void 0===e?void 0:e.text)&&void 0!==t?t:"",n=this.updateHyperlinkInfo(i);if(!n)return this.modelManager.richOptions.fields.keepHyperlinkResultForInvalidReference||this.removeInterval(this.getTopField().getResultInterval()),!0;const o=this.modelManager.modelManipulator,a=r.getResultInterval();if(0===a.length){const e=null!=i?i:"#"+n.anchor,t=new on.FixedInterval(a.start,e.length);this.setInputPositionState(),this.replaceTextByInterval(a,e);const r=new gu(this.subDocument,t),s=new Up(o,r);this.modelManager.history.addAndRedo(s)}const s=new hp(o,this.subDocument,r.index,n);return this.modelManager.history.addAndRedo(s),!0}updateHyperlinkInfo(e){const t=new xd("","","",!1);[t.uri,t.anchor]=yd.jE.splitUrlByAnchor(e),t.visited=!1;for(const e of this.switchInfoList)if(e.type==ku.FieldSpecific)switch(e.name.toLocaleUpperCase()){case"O":t.tip=e.arg;break;case"L":t.anchor=e.arg}return t.isValid()?t:null}}class Vp extends Np{get name(){return _u.MergeField}getMailMergeType(){return Ou.MailMerge}insertDefaultText(){if(this.modelManager.richOptions.mailMerge.isEnabled&&this.modelManager.richOptions.mailMerge.viewMergedData)return!1;const e=this.modelManager.model.simpleFormattersManager.formatString("<<{0}>>",this.parameterInfoList[0].text);return this.setInputPositionState(),this.modelManager.modelManipulator.range.removeInterval(new gu(this.subDocument,this.getTopField().getResultInterval()),!0,!1),this.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(this.subDocument,this.getTopField().getResultInterval().start),this.inputPos.charPropsBundle,cs.TextRun,e)),!0}getRequestData(){return new Ap(this.parameterInfoList[0].text)}getMergeFieldName(){return 0==this.parameterInfoList.length&&this.parseSwitchesAndArgs(),this.parameterInfoList[0]?this.parameterInfoList[0].text:""}applyResponse(e){const t=e[Qs.SimpleText];if(null===t)return!1;const r=this.getTopField().getResultInterval();return this.modelManager.modelManipulator.range.removeInterval(new gu(this.subDocument,r),!0,!1),""!==t&&(this.setInputPositionState(),this.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(this.subDocument,r.start),this.inputPos.charPropsBundle,cs.TextRun,this.getFormattedResult(t)))),!0}}class Wp extends gp{get name(){return _u.NumPages}fillResult(){if(this.setInputPositionState(),this.subDocument.isMain()){const e=this.layoutFormatterManager.layout.lastMaxNumPages.toString();this.replaceTextByInterval(this.getTopField().getResultInterval(),e)}else this.replaceTextByLayoutDependentRun(this.getTopField().getResultInterval());return!0}}!function(e){e[e.None=-1]="None",e[e.Page=0]="Page",e[e.PageArea=1]="PageArea",e[e.Column=2]="Column",e[e.TableRow=3]="TableRow",e[e.TableCell=4]="TableCell",e[e.Row=5]="Row",e[e.Box=6]="Box",e[e.Character=7]="Character",e[e.Max=255]="Max"}(Hu||(Hu={}));class zp extends Xc.Point{constructor(e,t,r){super(t,r),this.pageIndex=e}isEmpty(){return-1==this.pageIndex}static Empty(){return new zp(-1,-1,-1)}clone(){return new zp(this.pageIndex,this.x,this.y)}get point(){return new Xc.Point(this.x,this.y)}}class jp{constructor(e,t){this.layoutPosition=e,this.modelPosition=t}}class Xp{constructor(){this.row=null,this.box=null,this.boxIndex=-1,this.charOffset=-1}}class Gp extends Xp{constructor(){super(...arguments),this.detailsLevel=Hu.None,this.rowIndex=-1,this.column=null,this.columnIndex=-1,this.pageArea=null,this.pageAreaIndex=-1,this.page=null,this.pageIndex=-1}getRelatedSubDocumentPagePosition(){return this.pageArea.subDocument.isMain()?this.page.getPosition():0}equals(e){if(this.detailsLevel!=e.detailsLevel)return!1;switch(this.detailsLevel){case Hu.Character:if(this.charOffset!=e.charOffset)return!1;case Hu.Box:if(this.boxIndex!=e.boxIndex)return!1;case Hu.Row:if(this.rowIndex!=e.rowIndex)return!1;case Hu.Column:if(this.columnIndex!=e.columnIndex)return!1;case Hu.PageArea:if(this.pageAreaIndex!=e.pageAreaIndex||this.pageArea.subDocument.id!=e.pageArea.subDocument.id)return!1;case Hu.Page:if(this.pageIndex!=e.pageIndex)return!1}return!0}getOffsetRelativeColumn(){return new Xc.Point(this.pageArea.x+this.column.x,this.pageArea.y+this.column.y)}stepBackRow(){return 0!=this.rowIndex&&(this.row=this.column.rows[--this.rowIndex],!0)}stepForwardRow(){const e=this.column.rows[++this.rowIndex];return e?(this.row=e,!0):(this.rowIndex--,!1)}getPositionRelativePage(e){return new zp(this.page.index,this.getLayoutX(e),this.getLayoutY())}getLayoutX(e,t){t||(t=this.detailsLevel);let r=0;switch(t){case Hu.Max:case Hu.Character:r+=this.box.getCharOffsetXInPixels(e,this.charOffset);case Hu.Box:r+=this.box.x;case Hu.Row:r+=this.row.x;case Hu.Column:r+=this.column.x;case Hu.PageArea:r+=this.pageArea.x}return r}getLayoutY(e){e||(e=this.detailsLevel);let t=0;switch(e){case Hu.Max:case Hu.Character:case Hu.Box:t+=this.row.baseLine-this.box.getAscent()-this.row.getSpacingBefore();case Hu.Row:t+=this.row.y;case Hu.Column:t+=this.column.y;case Hu.PageArea:t+=this.pageArea.y}return t}getPageAreaBySubDocument(e){return e.isMain()?this.page.mainSubDocumentPageAreas[this.pageAreaIndex]:this.page.otherPageAreas[e.id]}advanceToPrevRow(e){if(this.rowIndex--,this.rowIndex<0){if(!this.pageArea.subDocument.isMain())return this.rowIndex=0,!1;if(this.columnIndex--,this.columnIndex<0){if(this.pageAreaIndex--,this.pageAreaIndex<0){if(this.pageIndex--,this.pageIndex<0)return this.pageIndex=0,this.pageAreaIndex=0,this.columnIndex=0,this.rowIndex=0,!1;this.page=e.pages[this.pageIndex],this.pageAreaIndex=this.page.mainSubDocumentPageAreas.length-1}this.pageArea=this.page.mainSubDocumentPageAreas[this.pageAreaIndex],this.columnIndex=this.pageArea.columns.length-1}this.column=this.pageArea.columns[this.columnIndex],this.rowIndex=this.column.rows.length-1}return this.row=this.column.rows[this.rowIndex],!0}advanceToNextBoxInRow(){return this.boxIndex+1<this.row.boxes.length&&(this.boxIndex++,this.box=this.row.boxes[this.boxIndex],this.charOffset=0,!0)}advanceToPrevBoxInRow(){return this.boxIndex>0&&(this.boxIndex--,this.box=this.row.boxes[this.boxIndex],this.charOffset=this.box.getLength()-1,!0)}advanceToNextRow(e){if(this.rowIndex++,this.rowIndex>=this.column.rows.length){if(!this.pageArea.subDocument.isMain())return this.rowIndex--,!1;if(this.rowIndex=0,this.columnIndex++,this.columnIndex>=this.pageArea.columns.length){if(this.columnIndex=0,this.pageAreaIndex++,this.pageAreaIndex>=this.page.mainSubDocumentPageAreas.length){if(this.pageAreaIndex=0,this.pageIndex++,this.pageIndex>=e.validPageCount)return this.pageIndex--,this.pageAreaIndex=this.page.mainSubDocumentPageAreas.length-1,this.columnIndex=this.pageArea.columns.length-1,this.rowIndex=this.column.rows.length-1,!1;this.page=e.pages[this.pageIndex]}this.pageArea=this.page.mainSubDocumentPageAreas[this.pageAreaIndex]}this.column=this.pageArea.columns[this.columnIndex]}return this.row=this.column.rows[this.rowIndex],!0}}class Kp extends Gp{constructor(e){super(),this.detailsLevel=e}static ensure(e,t,r,i=Hu.Row){const n=e.layout,o=(new cg).setDefault(!1),a=(new cg).setDefault(!1);if(t.isMain())return ug.ensureLayoutPosition(e,t,r,i,o,a);for(;;){const s=n.getPageBySubDocumentId(t.id).index,l=new pg(n,t,r,s,i).create(o,a);if(l)return l;if(!e.forceFormatPage(n.validPageCount))return null}}getLogPosition(e=null){e||(e=this.detailsLevel);var t=0;switch(e){case Hu.Max:case Hu.Character:t+=this.charOffset;case Hu.Box:t+=this.box.rowOffset;case Hu.Row:t+=this.row.columnOffset;case Hu.Column:t+=this.column.pageAreaOffset;case Hu.PageArea:t+=this.pageArea.pageOffset}return e>=Hu.PageArea&&this.pageArea.subDocument.isMain()&&(t+=this.page.getPosition()),t}isPositionBoxEnd(){return this.charOffset==this.box.getLength()}isLastBoxInRow(){return this.boxIndex==this.row.boxes.length-1}isPositionAfterLastBoxInRow(){return this.isLastBoxInRow()&&this.isPositionBoxEnd()}isPositionBeforeFirstBoxInRow(){return 0==this.boxIndex&&0==this.charOffset}switchToEndPrevBoxInRow(){return 0==this.charOffset&&this.boxIndex>0&&(this.boxIndex--,this.box=this.row.boxes[this.boxIndex],this.charOffset=this.box.getLength(),!0)}switchToStartNextBoxInRow(){this.charOffset==this.box.getLength()&&this.boxIndex+1<this.row.boxes.length&&(this.boxIndex++,this.box=this.row.boxes[this.boxIndex],this.charOffset=0)}copyFrom(e){this.detailsLevel=e.detailsLevel,this.pageIndex=e.pageIndex,this.page=e.page,this.pageArea=e.pageArea,this.pageAreaIndex=e.pageAreaIndex,this.column=e.column,this.columnIndex=e.columnIndex,this.row=e.row,this.rowIndex=e.rowIndex,this.box=e.box,this.boxIndex=e.boxIndex,this.charOffset=e.charOffset}clone(){var e=new Kp(this.detailsLevel);return e.copyFrom(this),e}initByIndexes(e,t=-1,r=-1,i=-1,n=-1,o=-1){return this.pageIndex=e,this.pageAreaIndex=t,this.columnIndex=r,this.rowIndex=i,this.boxIndex=n,this.charOffset=o,this}applyObjectsAsMainSubDocument(e,t){if(this.page=e.pages[this.pageIndex],t<0){if(this.pageAreaIndex<0)return this;this.pageArea=this.page.mainSubDocumentPageAreas[this.pageAreaIndex]}else this.pageArea=this.page.otherPageAreas[t];return this.columnIndex<0?this:(this.column=this.pageArea.columns[this.columnIndex],this.rowIndex<0?this:(this.row=this.column.rows[this.rowIndex],this.boxIndex<0||(this.box=this.row.boxes[this.boxIndex]),this))}posIsStartPage(){return 0==this.rowIndex&&0==this.columnIndex&&0==this.pageAreaIndex}isFirstRowOnPage(){return 0==this.pageAreaIndex&&0==this.columnIndex&&0==this.rowIndex}}class qp{static onStartCharLevel(e){e.charOffset=0}static onStartBoxLevel(e){e.boxIndex=0,e.box=e.row.boxes[0],qp.onStartCharLevel(e)}static onStartRowLevel(e){e.rowIndex=0,e.row=e.column.rows[0],qp.onStartBoxLevel(e)}static onStartColumnLevel(e){e.columnIndex=0,e.column=e.pageArea.columns[0],qp.onStartRowLevel(e)}static onStartPageAreaLevel(e){e.pageAreaIndex=0,e.pageArea=e.page.mainSubDocumentPageAreas[0],qp.onStartColumnLevel(e)}static onStartPageLevel(e,t){t.pageIndex=0,t.page=e[0],qp.onStartPageAreaLevel(t)}static onEndCharLevel(e){e.charOffset=0}static onEndBoxLevel(e){e.boxIndex=e.row.boxes.length-1,e.box=e.row.boxes[e.boxIndex],qp.onEndCharLevel(e)}static onEndRowLevel(e){e.rowIndex=e.column.rows.length-1,e.row=e.column.rows[e.rowIndex],qp.onEndBoxLevel(e)}static onEndColumnLevel(e){e.columnIndex=e.pageArea.columns.length-1,e.column=e.pageArea.columns[e.columnIndex],qp.onEndRowLevel(e)}static onEndPageAreaLevel(e){e.pageAreaIndex=e.page.mainSubDocumentPageAreas.length-1,e.pageArea=e.page.mainSubDocumentPageAreas[e.pageAreaIndex],qp.onEndColumnLevel(e)}static onEndPageLevel(e,t){t.pageIndex=e.pages.length-1,t.page=e.pages[t.pageIndex],qp.onEndPageAreaLevel(t)}}function $p(e,t){const r=e.anchorInfo,i=t.anchorInfo;switch(r.levelType){case dc.BehindText:if(i.levelType!=dc.BehindText)return-1;break;case dc.BeforeText:case dc.InText:if(i.levelType==dc.BehindText)return 1}const n=r.zOrder-i.zOrder;return n||t.position-e.position}class Jp{constructor(e){this._page=e,this.objects={}}getObjectByModelPosition(e,t,r){return b.j.elementBy(this.objects,((i,n)=>e.anchorObjectsPositionInfo.getPosition(n)==t&&i.belongsToSubDocId===r))}removeOrphanedObjects(e){if(!e.subDocument.isMain())return;const t=e.subDocument.id,r=e.rowFormatter.manager.layout,i=e.rowFormatter.getPosition(),n=[];b.j.forEach(this.objects,((o,a)=>{r.anchorObjectsPositionInfo.getPosition(a)>=i&&o.belongsToSubDocId===t&&(n.push(a),o.getType()===lc.AnchorTextBox&&this._page.removeOtherPageArea(o.internalSubDocId),e.layoutRowBoundsCalculator.removeAnchorObjectId(a))}));for(let e of n)delete this.objects[e]}getObjectsForRenderer(e,t=this.objects){return b.j.toList(t).sort(function(e){const t=t=>e.getPosition(t.objectId);return(e,r)=>e.rendererLevel-r.rendererLevel||(e.anchorInfo.zOrder!=r.anchorInfo.zOrder?e.anchorInfo.zOrder-r.anchorInfo.zOrder:t(e)-t(r))}(e))}getObjById(e){return this.objects[e]}getUnapprovedObj(){return b.j.elementBy(this.objects,(e=>!e.isApproved))}getTextBoxByInternalSubDocId(e){return b.j.elementBy(this.objects,(t=>t.getType()==lc.AnchorTextBox&&t.internalSubDocId==e))}isObjectExist(e){return!!this.objects[e.objectId]}addObject(e,t){var r;this.objects[t.objectId]=t;const i=null===(r=e.activeFormatter.tableFormatter)||void 0===r?void 0:r.actualFormatter;i&&(t.parentCell=i.tableInfo.currCellInfo.cell),e.anchoredObjectsManager.anchorObjectHorizontalPositionCalculator.calculate(t),e.anchoredObjectsManager.anchorObjectVerticalPositionCalculator.calculate(t),this.correctPositionDueToOtherBoxes(t)}removeObject(e){delete this.objects[e.objectId]}correctPositionDueToOtherBoxes(e){}shallowCopy(e){const t=new Jp(e);return t.objects=b.j.shallowCopy(this.objects),t}}!function(e){e[e.HeaderFooterSubDoc_Behind=0]="HeaderFooterSubDoc_Behind",e[e.HeaderFooterSubDoc_InText=1]="HeaderFooterSubDoc_InText",e[e.HeaderFooterSubDoc_InFront=2]="HeaderFooterSubDoc_InFront",e[e.MainSubDoc_Behind=3]="MainSubDoc_Behind",e[e.MainSubDoc_InText=4]="MainSubDoc_InText",e[e.MainSubDoc_InFront=5]="MainSubDoc_InFront"}(Vu||(Vu={}));class Yp{constructor(){this.maxRenderLevels=Math.max(Yp.subGroupTypes.length,9),this.realGroupLevelsBounds=[],this.renderGroupLevelsBounds=[]}get mainPageAreaLevel(){return this.realGroupLevelsBounds[Vu.MainSubDoc_InText]}get headerFooterPageAreasLevel(){return this.realGroupLevelsBounds[Vu.HeaderFooterSubDoc_InText]}get renderMainPageAreaLevel(){return this.renderGroupLevelsBounds[Vu.MainSubDoc_InText]}get renderHeaderFooterPageAreasLevel(){return this.renderGroupLevelsBounds[Vu.HeaderFooterSubDoc_InText]}getRenderLevel(e){const t=f.ListUtils.indexBy(this.realGroupLevelsBounds,(t=>e<t),1)-1,r=this.renderGroupLevelsBounds[t+1]-this.renderGroupLevelsBounds[t]-1,i=Math.min(e-this.realGroupLevelsBounds[t],r);return this.renderGroupLevelsBounds[t]+i}calcLevels(e,t,r){if(b.j.isEmpty(e.objects))return this.realGroupLevelsBounds=[0,1,2,3,4,5,6],void(this.renderGroupLevelsBounds=[0,1,2,3,4,5,6]);const i=this.getObjects(e,t),n=this.getGroups(i,r);for(let e of n)for(let t of Yp.subGroupTypes){const r=e.subGroups[t];if(r&&r.objects){const e=this.realGroupLevelsBounds[t];f.ListUtils.forEach(b.j.toList(r.objects).sort(((e,t)=>e.index-t.index)),((t,r)=>{t.obj.rendererLevel=e+r}))}}}equals(e){return f.ListUtils.equalsByReference(this.realGroupLevelsBounds,e.realGroupLevelsBounds)&&f.ListUtils.equalsByReference(this.renderGroupLevelsBounds,e.renderGroupLevelsBounds)}getObjects(e,t){const r=b.j.toList(e.objects).sort(function(e){const t=t=>e.getPosition(t.objectId);return(e,r)=>e.anchorInfo.zOrder-r.anchorInfo.zOrder||t(e)-t(r)}(t)),i=f.ListUtils.map(r,((e,t)=>new eg(e,t)));return f.ListUtils.forEach(i,((e,t)=>{f.ListUtils.forEach(i,(t=>{t.intersections[e.index]&&(e.intersections[t.index]=t)}),0,t),f.ListUtils.forEach(i,(t=>{Gc.mg.collision(e.obj.getRotatedPolygon(),t.obj.getRotatedPolygon())!=Gc.VW.None&&(e.intersections[t.index]=t)}),t)})),i}getGroups(e,t){const r=[];for(let t of e)t.group||(t.group=new Zp,t.group.objects[t.index]=t,r.push(t.group)),b.j.forEach(t.intersections,(e=>{t.group.objects[e.index]=e,e.group=t.group}));for(let e of r)e.fillSubGroups(t);return this.fillGroupsBounds(e,r),r}fillGroupsBounds(e,t){const r=Yp.subGroupTypes.map((e=>f.ListUtils.maxExtended(t,(t=>{const r=t.subGroups[e];return r?r.numObjects:0})).maxValue));f.ListUtils.unsafeAnyOf(e,(e=>e.obj.belongsToSubDocId!=uu.MAIN_SUBDOCUMENT_ID))&&r[Vu.HeaderFooterSubDoc_InText]++,r[Vu.MainSubDoc_InText]++,this.realGroupLevelsBounds=this.translateToBounds(r),this.renderGroupLevelsBounds=this.translateToBounds(this.reduceLevels(r))}translateToBounds(e){const t=[];let r=0;for(let i of e)t.push(r),r+=i;return t.push(r),t}reduceLevels(e){const t=f.ListUtils.shallowCopy(e);let r=f.ListUtils.accumulateNumber(t,(e=>e));const i=Yp.reduceRenderOrder;for(let e=0;r>this.maxRenderLevels;e++)e>=i.length&&(e=0),t[i[e]]>1&&(t[i[e]]--,r--);return t}}Yp.subGroupTypes=[Vu.HeaderFooterSubDoc_Behind,Vu.HeaderFooterSubDoc_InText,Vu.HeaderFooterSubDoc_InFront,Vu.MainSubDoc_Behind,Vu.MainSubDoc_InText,Vu.MainSubDoc_InFront],Yp.reduceRenderOrder=[Vu.HeaderFooterSubDoc_Behind,Vu.HeaderFooterSubDoc_InFront,Vu.HeaderFooterSubDoc_InText,Vu.MainSubDoc_Behind,Vu.MainSubDoc_InText,Vu.MainSubDoc_InFront];class Qp{constructor(){this.objects={},this.numObjects=0}addObject(e){this.objects[e.index]=e,this.numObjects++}}class Zp{constructor(){this.objects={},this.subGroups={}}fillSubGroups(e){b.j.forEach(this.objects,(t=>{const r=this.getObjSubGroupType(t,e);let i=this.subGroups[r];i||(i=this.subGroups[r]=new Qp),i.addObject(t)}))}getObjSubGroupType(e,t){const r=e.obj.belongsToSubDocId==uu.MAIN_SUBDOCUMENT_ID?3:0;switch(e.obj.anchorInfo.getLevelTypeForRendering(!0,t)){case dc.BehindText:return Vu.HeaderFooterSubDoc_Behind+r;case dc.InText:return Vu.HeaderFooterSubDoc_InText+r;case dc.BeforeText:return Vu.HeaderFooterSubDoc_InFront+r}}}class eg{constructor(e,t){this.intersections={},this.obj=e,this.index=t}}class tg{constructor(){this.holder=new Map}addTableCellAnchoredObject(e,t){for(const r of this.holder.keys())if(r.equals(e)){const e=this.holder.get(r);return void(e.indexOf(t)<0&&e.push(t))}this.holder.set(e.clone(),[t])}getTableCellAnchoredObjects(e,t){for(const r of this.holder.keys())if(r.equals(e))return this.holder.get(r).map((e=>t.layoutPosition.page.anchoredObjectHolder.getObjById(e)));return[]}shallowCopy(){const e=new tg;return this.holder.forEach(((t,r)=>e.holder.set(r.clone(),[...t]))),e}}!function(e){e[e.MustBeRendered=1]="MustBeRendered",e[e.ContentRendered=2]="ContentRendered",e[e.NeedRenderContent=4]="NeedRenderContent",e[e.NeedDeleteContent=8]="NeedDeleteContent",e[e.IsFirstPageOfSection=16]="IsFirstPageOfSection",e[e.IsIntervalsCorrect=32]="IsIntervalsCorrect",e[e.IsSelectionRendered=64]="IsSelectionRendered",e[e.IsSearchSelectionRendered=128]="IsSearchSelectionRendered",e[e.IsMisspelledSelectionRendered=256]="IsMisspelledSelectionRendered",e[e.IsRangePermissionsRendered=512]="IsRangePermissionsRendered"}(Wu||(Wu={}));class rg{constructor(e,t,r){this.headerPageArea=e,this.footerPageArea=t,this.textBoxesPageAreas=r}getDocumentModel(){if(!this.documentModel){const e=this.headerPageArea||this.footerPageArea||this.textBoxesPageAreas[0];this.documentModel=e?e.subDocument.documentModel:null}return this.documentModel}}class ig extends Va.Rectangle{constructor(){super(0,0,0,0),this.mainSubDocumentPageAreas=[],this.otherPageAreas={},this.flags=new pr.Flag,this.anchoredObjectHolder=new Jp(this),this.tableAnchoredObjectsHolder=new tg}setRenderLevelCalculator(e,t){this.renderLevelCalculator=new Yp,this.renderLevelCalculator.calcLevels(this.anchoredObjectHolder,e,t)}setAbsolutePosition(e){this.contentIntervals=[new on.FixedInterval(e,0)],this.flags.set(Wu.IsIntervalsCorrect,!1)}startWithFloatingObject(e){const t=b.j.min(this.anchoredObjectHolder.objects,(t=>e.getPosition(t.objectId)));return t&&e.getPosition(t.objectId)<this.getPosition()?t:null}getStartPositionConsideringAncObj(e){const t=this.startWithFloatingObject(e);return Math.min(this.getPosition(),t?e.getPosition(t.objectId):Number.MAX_VALUE)}invalidate(){this.isValid=!1,this.markPageIntervalsAsIncorrect()}getPosition(){return this.contentIntervals[0].start}deepCopy(){const e=new ig;return e.isValid=this.isValid,e.mainSubDocumentPageAreas=f.ListUtils.map(this.mainSubDocumentPageAreas,(e=>e.deepCopy())),e.otherPageAreas=b.j.shallowCopy(this.otherPageAreas),e.flags=this.flags.clone(),e.index=this.index,e.layoutPageIndex=this.layoutPageIndex,e.pageOrdinal=this.pageOrdinal,e.anchoredObjectHolder=this.anchoredObjectHolder.shallowCopy(e),e.tableAnchoredObjectsHolder=this.tableAnchoredObjectsHolder.shallowCopy(),e.contentIntervals=f.ListUtils.shallowCopy(this.contentIntervals),e.startPageSectionIndex=this.startPageSectionIndex,e.copyFrom(this),e}markPageIntervalsAsIncorrect(){this.flags.set(Wu.IsIntervalsCorrect,!1)}getLayoutOtherPageAreasInfo(){let e,t;const r=[];return b.j.forEach(this.otherPageAreas,(i=>{i.subDocument.isHeader()?e=i:i.subDocument.isFooter()?t=i:i.subDocument.isTextBox()&&r.push(i)})),new rg(e,t,r)}calculateContentIntervals(e,t){if(!this.flags.get(Wu.IsIntervalsCorrect)){const r=this.getPosition();t?this.contentIntervals=ng.getNoneTidyIntervals(this.mainSubDocumentPageAreas,this.contentIntervals[0].start):(this.contentIntervals=new ng(this.mainSubDocumentPageAreas,this.contentIntervals[0].start).getIntervals(),this.flags.set(Wu.IsIntervalsCorrect,!0)),b.j.forEach(this.anchoredObjectHolder.objects,(t=>{t.belongsToSubDocId==uu.MAIN_SUBDOCUMENT_ID&&this.contentIntervals.push(new on.FixedInterval(e.getPosition(t.objectId),1))})),this.contentIntervals=nn.IntervalAlgorithms.getMergedIntervals(this.contentIntervals,!0);const i=r-this.contentIntervals[0].start;if(i>0)for(let e of this.mainSubDocumentPageAreas)e.pageOffset=i}}getContentIntervals(){return this.contentIntervals}static getFirstPageInGroup(e,t){for(;t>=0;t--){const r=e[t],i=r.mainSubDocumentPageAreas[0].columns[0];if(!i.rows[0]||!i.rows[0].tableCellInfo)return r;const n=i.tablesInfo[0].tableRows[0].rowCells;let o=!0;for(let e of n)o=o&&e.boundFlags.get(_a.StartOnThisColumn);if(o)return r}return e[0]}static getLastValidPageInGroup(e,t,r,i,n){let o=e[t];for(;t<e.length;t++){const a=e[t];if(i&&(!a.isValid||a.index>=r))return n?o:null;const s=f.ListUtils.last(f.ListUtils.last(f.ListUtils.last(a.mainSubDocumentPageAreas).columns).rows);if(!s||!s.tableCellInfo)return a;const l=s.tableCellInfo?ng.getTopLevelTableRow(s.tableCellInfo.parentRow).rowCells:[];let d=!0;for(let e of l)d=d&&e.boundFlags.get(_a.EndOnThisColumn);if(d)return a;o=e[t]}return f.ListUtils.last(e)}getEndPosition(){return this.getPosition()+f.ListUtils.last(this.mainSubDocumentPageAreas).getEndPosition()}static getPrevPageLastPosition(e,t){const r=e[t-1];return r?r.getEndPosition():0}removeOtherPageArea(e){delete this.otherPageAreas[e]}}class ng{constructor(e,t){this.extendInfo=[],this.startPagePos=t,this.cellIterator=new ag(e),this.intervals=[]}static getNoneTidyIntervals(e,t){const r=[];for(let i of e)for(let e of i.columns){const n=t+i.pageOffset+e.pageAreaOffset;for(let t of e.rows){const e=f.ListUtils.last(t.boxes);r.push(new on.FixedInterval(n+t.columnOffset+t.boxes[0].rowOffset,e.rowOffset+e.getLength()))}}return nn.IntervalAlgorithms.getMergedIntervals(r,!1)}startInterval(e){if(this.intervals.length>0){const t=f.ListUtils.last(this.intervals);if(t.end==e)return void(this.currInterval=t)}this.currInterval=new on.FixedInterval(e,0),this.intervals.push(this.currInterval)}extendInterval(e){this.currInterval.length=Math.max(this.currInterval.length,e-this.currInterval.start)}startExtend(){const e=this.cellIterator.tableCell.boundFlags;this.extendInfo.push(new og(this.getPosition(ng.getCellLastRowEndPosition),this.cellIterator.tableColumn.logicInfo.grid.table.nestedLevel,!(e.get(_a.StartOnThisColumn)&&e.get(_a.EndOnThisColumn)),this.cellIterator.tableCell,this.startPagePos+this.cellIterator.pageArea.pageOffset+this.cellIterator.column.pageAreaOffset))}finishExtend(e){const t=e?0:this.cellIterator.tableColumn.logicInfo.grid.table.nestedLevel;for(;this.currInterval&&this.extendInfo.length>0;){const e=this.extendInfo.pop();if(!(t<=e.level)){this.extendInfo.push(e);break}e.endOfCellPos>=0&&this.extendInterval(e.endOfCellPos),e.isStartNewInterval&&(this.currInterval=null)}}getPosition(e){const t=e(this.cellIterator);return-1==t?-1:this.startPagePos+this.cellIterator.pageArea.pageOffset+this.cellIterator.column.pageAreaOffset+t}getIntervals(){for(this.startInterval(this.startPagePos);this.cellIterator.moveNext();){const e=this.cellIterator.tableCell,t=this.cellIterator.isFirstTopLevelCell;if(this.finishExtend(!1),!this.currInterval)if(t){const e=this.cellIterator.previousTopLevelTableEndPosition>-1?this.cellIterator.previousTopLevelTableEndPosition:f.ListUtils.last(this.intervals).end;this.startInterval(e)}else this.startInterval(this.getPosition(ng.getCellFirstRowStartPos));t&&this.extendInterval(this.getPosition(ng.getCellFirstRowStartPos)),t||e.boundFlags.get(_a.StartOnThisColumn)||this.startInterval(this.getPosition(ng.getCellFirstRowStartPos)),this.startExtend()}this.finishExtend(!0),this.handleLastExtends();const e=this.startPagePos+f.ListUtils.last(this.cellIterator.pageAreas).getEndPosition();return this.currInterval?this.extendInterval(e):this.addAdditionalInterval(e),nn.IntervalAlgorithms.getMergedIntervals(this.intervals,!0)}handleLastExtends(){if(this.extendInfo[0]){for(let e;e=this.extendInfo.pop();){const t=e.cell.internalTables[e.cell.layoutRows.length]?null:f.ListUtils.reverseElementBy(e.cell.layoutRows,((t,r)=>!!e.cell.internalTables[r]||0==r));t&&(this.startInterval(e.columnOffsetPos+t.getStartPosition()),this.extendInterval(e.endOfCellPos))}this.currInterval=null}}addAdditionalInterval(e){const t=f.ListUtils.last(this.cellIterator.pageAreas),r=f.ListUtils.last(t.columns),i=f.ListUtils.last(r.tablesInfo);if(!i)return;const n=f.ListUtils.last(f.ListUtils.last(i.getTopLevelColumn().tableRows).rowCells).getLastLayoutRowIncludingInternalTables(),o=r.rows[n.indexInColumn+1];o&&this.intervals.push(on.FixedInterval.fromPositions(this.startPagePos+t.pageOffset+r.pageAreaOffset+o.getStartPosition(),e))}static getCellLastRowEndPosition(e){const t=f.ListUtils.last(e.tableCell.layoutRows);return t?t.getEndPosition():-1}static getCellFirstRowStartPos(e){return e.tableCell.getFirstLayoutRowByModelPositionIncludingInternalTables().getStartPosition()}static getTopLevelTableRow(e){for(;e.parentTable.logicInfo.grid.table.nestedLevel>0;)e=e.parentTable.parentCell.parentRow;return e}}class og{constructor(e,t,r,i,n){this.endOfCellPos=e,this.level=t,this.isStartNewInterval=r,this.cell=i,this.columnOffsetPos=n}}class ag{constructor(e){this.pageAreaIndex=-1,this.previousTopLevelTableEndPosition=-1,this.tableIndexes=[],this.tableRowIndexes=[],this.tableCellIndexes=[],this.tableCellInternalTableIndexes=[],this.currLevel=0,this.isInit=!1,this.pageAreas=e}get isFirstTopLevelCell(){return this._isFirstTopLevelCell}moveNext(){return this.isInit?this.moveToNextTableCell():(this.isInit=!0,this.init())}init(){return this.pageAreaIndex=0,this.pageArea=this.pageAreas[0],this.columnIndex=-1,!!this.moveToNextColumnWithTable()&&(this.initTopTableProperties(0),!0)}initTopTableProperties(e){this.tableIndexes=[e,-1],this.tableColumn=this.column.tablesInfo[e],this.tableRowIndexes=[0],this.setTableRow(0),this.tableCellIndexes=[0],this.tableCell=this.tableRowCells[0],this._isFirstTopLevelCell=!0,this.tableCellInternalTableIndexes=[],this.collectInternalTableIndexes()}moveToNextColumnWithTable(){return(this.column=this.pageArea.columns[++this.columnIndex])?this.column.tablesInfo.length>0||this.moveToNextColumnWithTable():!!(this.pageArea=this.pageAreas[++this.pageAreaIndex])&&(this.columnIndex=-1,this.moveToNextColumnWithTable())}moveToNextTableCell(){return!!(this.goToInternalTable()||this.goToNextTableCell()||this.goToNextTableRow())||(0==this.currLevel?this.goToNextTopLevelTable():this.goToTopLevel())}goToInternalTable(){const e=f.ListUtils.incLast(this.tableIndexes),t=this.tableCellInternalTableIndexes[this.currLevel];return!(e>=t.length)&&(this.tableColumn=this.tableCell.internalTables[t[e]],this.tableRowIndexes.push(0),this.setTableRow(0),this.tableCellIndexes.push(0),this.tableCell=this.tableRowCells[0],this._isFirstTopLevelCell=!1,this.currLevel++,this.collectInternalTableIndexes(),this.tableIndexes.push(-1),!0)}goToNextTableCell(){const e=f.ListUtils.incLast(this.tableCellIndexes);return!(e>=this.tableRowCells.length)&&(this.tableCell=this.tableRowCells[e],this._isFirstTopLevelCell=!1,this.tableCellInternalTableIndexes.pop(),this.collectInternalTableIndexes(),f.ListUtils.setLast(this.tableIndexes,-1),!0)}goToNextTableRow(){const e=f.ListUtils.incLast(this.tableRowIndexes);return!(e>=this.tableColumn.tableRows.length)&&(this.setTableRow(e),f.ListUtils.setLast(this.tableCellIndexes,-1),this.goToNextTableCell())}goToNextTopLevelTable(){return void 0!==this.tableIndexes[0]&&(this.previousTopLevelTableEndPosition=this.column.tablesInfo[this.tableIndexes[0]].logicInfo.grid.table.getEndPosition()),this.tableIndexes[0]=this.getNextTopLevelTableIndexInThisColumn(),this.tableIndexes[0]>=0?(this.initTopTableProperties(this.tableIndexes[0]),!0):!!this.moveToNextColumnWithTable()&&(this.initTopTableProperties(0),!0)}goToTopLevel(){return this.tableCellInternalTableIndexes.pop(),this.tableCellIndexes.pop(),this.tableRowIndexes.pop(),this.tableIndexes.pop(),this.currLevel--,this.tableCell=this.tableColumn.parentCell,this.tableRow=this.tableCell.parentRow,this.tableRowCells=this.getTableRowCells(),this.tableColumn=this.tableRow.parentTable,this.moveToNextTableCell()}getNextTopLevelTableIndexInThisColumn(){const e=this.column.tablesInfo;for(let t=this.tableIndexes[0]+1;t<e.length;t++)if(0==e[t].logicInfo.grid.table.nestedLevel)return t;return-1}collectInternalTableIndexes(){const e=[],t=this.tableCell.internalTables;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(parseInt(r));e.sort(Qe.Comparers.number),this.tableCellInternalTableIndexes.push(e)}setTableRow(e){this.tableRow=this.tableColumn.tableRows[e],this.tableRowCells=this.getTableRowCells()}getTableRowCells(){return f.ListUtils.shallowCopy(this.tableRow.rowCells).sort(((e,t)=>e.getFirstLayoutRowByModelPositionIncludingInternalTables().getStartPosition()-t.getFirstLayoutRowByModelPositionIncludingInternalTables().getStartPosition()))}}class sg{static level_1(e,t,r="",i="\n"){return O.w(3,O.join)(i)(O.map(((t,i)=>`${r}[${i}]=${e(t)}`),t))}static level_2(e,t,r,i=""){const n=(e,r,i)=>`[${e}][${i}]=${t(r)}`;return O.w(3,O.join)("\n")(O.map(((t,r)=>`${i}${O.join(O.splitBy,O.map(O.w(3,n)(r),e(t)))}`),r))}}class lg{static point(e){return e?`[x: ${e.x}, y:${e.y}]`:"null"}static fixedInterval(e){return`[${e.start}, ${e.end}]`}static tableWidthUnit(e){return`type: ${Je[e.type]}, val: ${e.value}`}static tableHeightUnit(e){return`type: ${$e[e.type]}, val: ${e.value}`}static tableMembers(e,t=""){const r=[];return r.push(`${t}index: ${e.index}`),r.push(`${t}nestedLevel: ${e.nestedLevel}`),r.push(`${t}lookTypes: ${O.mask(_e,e.lookTypes)}`),r.push(`${t}preferredWidth: ${lg.tableWidthUnit(e.preferredWidth)}`),r.join("\n")}static tableProperties(e,t=""){const r=[];return r.push(`${t}mask: ${O.mask(ur,e.mask)}`),e.mask&ur.UseTopMargin&&r.push(`${t}cellMargins.top: ${lg.tableWidthUnit(e.cellMargins.top)}`),e.mask&ur.UseRightMargin&&r.push(`${t}cellMargins.right: ${lg.tableWidthUnit(e.cellMargins.right)}`),e.mask&ur.UseBottomMargin&&r.push(`${t}cellMargins.bottom: ${lg.tableWidthUnit(e.cellMargins.bottom)}`),e.mask&ur.UseLeftMargin&&r.push(`${t}cellMargins.left: ${lg.tableWidthUnit(e.cellMargins.left)}`),e.mask&ur.UseCellSpacing&&r.push(`${t}cellSpacing: ${lg.tableWidthUnit(e.cellSpacing)}`),e.mask&ur.UseTableIndent&&r.push(`${t}indent: ${lg.tableWidthUnit(e.indent)}`),e.mask&ur.UseTopBorder&&r.push(`${t}borders.top: ${lg.borderInfo(e.borders.top)}`),e.mask&ur.UseRightBorder&&r.push(`${t}borders.right: ${lg.borderInfo(e.borders.right)}`),e.mask&ur.UseBottomBorder&&r.push(`${t}borders.bottom: ${lg.borderInfo(e.borders.bottom)}`),e.mask&ur.UseLeftBorder&&r.push(`${t}borders.left: ${lg.borderInfo(e.borders.left)}`),e.mask&ur.UseInsideHorizontalBorder&&r.push(`${t}borders.insideHorizontal: ${lg.borderInfo(e.borders.insideHorizontal)}`),e.mask&ur.UseInsideVerticalBorder&&r.push(`${t}borders.insideVertical: ${lg.borderInfo(e.borders.insideVertical)}`),e.mask&ur.UseTableStyleColBandSize&&r.push(`${t}tableStyleColumnBandSize: ${e.tableStyleColumnBandSize}`),e.mask&ur.UseTableStyleRowBandSize&&r.push(`${t}tableStyleRowBandSize: ${e.tableStyleRowBandSize}`),e.mask&ur.UseAvoidDoubleBorders&&r.push(`${t}avoidDoubleBorders: ${e.avoidDoubleBorders}`),e.mask&ur.UseShadingInfoIndex&&r.push(`${t}shadingInfo: ${lg.shadingInfo(e.shadingInfo)} \n`),e.mask&ur.UseTableAlignment&&r.push(`${t}tableRowAlignment: ${e.tableRowAlignment}\n`),r.push(`${t}layoutType: ${Oe[e.layoutType]}`),r.join("\n")}static borderInfo(e){return`color: [${lg.colorModelInfo(e.color)}], width: ${e.width}, style: ${de[e.style]}`}static colorModelInfo(e){return e.toDebugString()}static shadingInfo(e){return`backColor: ${e.backColor}, foreColor: ${e.foreColor}, shadingPattern: ${re[e.shadingPattern]}`}static tableCellMembers(e,t=""){const r=[];return r.push(`${t}columnSpan: ${e.columnSpan}`),r.push(`${t}conditionalFormatting: ${O.mask(qe,e.conditionalFormatting)}`),r.push(`${t}startParagraphPosition: ${e.startParagraphPosition.value}`),r.push(`${t}endParagrapPosition: ${e.endParagrapPosition.value}`),r.push(`${t}verticalMerging: ${Xe[e.verticalMerging]}`),r.push(`${t}preferredWidth: ${lg.tableWidthUnit(e.preferredWidth)}`),r.join("\n")}static tableCellProperties(e,t=""){const r=[];return r.push(`${t}mask: ${O.mask(Ye,e.mask)}`),e.mask&Ye.UseTopBorder&&r.push(`${t}borders.top: ${e.borders.top}`),e.mask&Ye.UseRightBorder&&r.push(`${t}borders.right: ${e.borders.right}`),e.mask&Ye.UseBottomBorder&&r.push(`${t}borders.bottom: ${e.borders.bottom}`),e.mask&Ye.UseLeftBorder&&r.push(`${t}borders.left: ${e.borders.left}`),e.mask&Ye.UseTopLeftDiagonalBorder&&r.push(`${t}borders.topLeftDiagonal: ${e.borders.topLeftDiagonal}`),e.mask&Ye.UseTopRightDiagonalBorder&&r.push(`${t}borders.topRightDiagonal: ${e.borders.topRightDiagonal}`),e.mask&Ye.UseTopMargin&&r.push(`${t}cellMargins.top: ${lg.tableWidthUnit(e.cellMargins.top)}`),e.mask&Ye.UseRightMargin&&r.push(`${t}cellMargins.right: ${lg.tableWidthUnit(e.cellMargins.right)}`),e.mask&Ye.UseBottomMargin&&r.push(`${t}cellMargins.bottom: ${lg.tableWidthUnit(e.cellMargins.bottom)}`),e.mask&Ye.UseLeftMargin&&r.push(`${t}cellMargins.left: ${lg.tableWidthUnit(e.cellMargins.left)}`),e.mask&Ye.UseFitText&&r.push(`${t}fitText: ${e.fitText}`),e.mask&Ye.UseHideCellMark&&r.push(`${t}hideCellMark: ${e.hideCellMark}`),e.mask&Ye.UseNoWrap&&r.push(`${t}noWrap: ${e.noWrap}`),e.mask&Ye.UseShadingInfoIndex&&r.push(`${t}shadingInfo: ${lg.shadingInfo(e.shadingInfo)}`),e.mask&Ye.UseTextDirection&&r.push(`${t}textDirection: ${Ge[e.textDirection]}`),e.mask&Ye.UseVerticalAlignment&&r.push(`${t}verticalAlignment: ${Ke[e.verticalAlignment]}`),r.join("\n")}static tableRowMembers(e,t=""){const r=[];return r.push(`${t}conditionalFormatting: ${O.mask(qe,e.conditionalFormatting)}`),r.push(`${t}height: ${lg.tableHeightUnit(e.height)}`),r.push(`${t}gridAfter: ${e.gridAfter}`),r.push(`${t}gridBefore: ${e.gridBefore}`),r.push(`${t}widthAfter: ${lg.tableWidthUnit(e.widthAfter)}`),r.push(`${t}widthBefore: ${lg.tableWidthUnit(e.widthBefore)}`),r.join("\n")}static tableRowProperties(e,t=""){const r=[];return r.push(`${t}mask: ${O.mask(Ua,e.mask)}`),e.mask&Ua.UseCantSplit&&r.push(`${t}cantSplit: ${e.cantSplit}`),e.mask&Ua.UseCellSpacing&&r.push(`${t}cellSpacing: ${lg.tableWidthUnit(e.cellSpacing)}`),e.mask&Ua.UseHeader&&r.push(`${t}header: ${e.header}`),e.mask&Ua.UseHideCellMark&&r.push(`${t}hideCellMark: ${e.hideCellMark}`),e.mask&Ua.UseTableRowAlignment&&r.push(`${t}tableRowAlignment: ${je[e.tableRowAlignment]}`),r.join("\n")}static tableConditionalStyle(e,t=""){const r=t+"\t",i=[];return i.push(`${t}tableProperties:\n${lg.tableProperties(e.tableProperties,r)}`),i.push(`${t}tableRowProperties:\n${lg.tableRowProperties(e.tableRowProperties,r)}`),i.push(`${t}tableCellProperties:\n${lg.tableCellProperties(e.tableCellProperties,r)}`),i.join("\n")}static tableStyle(e,t=""){const r=t+"\t",i=[];for(let t of _r.conditionalTableStyleFormattingPriority)e.conditionalStyles[t]&&i.push(t);const n=[];return n.push(`${t}name: ${e.styleName}`),n.push(`${t}isDefault: ${e.isDefault}`),n.push(`${t}hidden: ${e.hidden}`),n.push(`${O.map((i=>`${t}${qe[i]}:\n${lg.tableConditionalStyle(e.conditionalStyles[i],r)}`),i).join("\n")}`),e.parent&&n.push(`${lg.tableStyle(e.parent,t)}`),n.join("\n")}static rectangle(e,t="",r="\t"){const i=[];return i.push(`${t}x: ${e.x}`),i.push(`${t}y: ${e.y}`),i.push(`${t}width: ${e.width}`),i.push(`${t}height: ${e.height}`),i.join(r)}static historyItemListLevelStateObject(e,t="",r="\t"){const i=[];return i.push(`${t}value: ${e.value}`),i.push(`${t}listLevelIndex: ${e.listLevelIndex}`),i.push(`${t}numberingListIndex: ${e.numberingListIndex}`),i.push(`${t}isAbstractNumberingList: ${e.isAbstractNumberingList}`),i.join(r)}static historyItemTableStateObject(e,t="",r="\t"){const i=[];return i.push(`${t}value: ${e.value}`),i.push(`${t}value: ${e.tableIndex}`),i.push(`${t}value: ${e.tableNestedLevel}`),i.push(`${t}value: ${e.tableStartPosition}`),i.join(r)}static historyItemTableRowStateObject(e,t="",r="\t"){const i=[];return i.push(`${t}value: ${e.value}`),i.push(`${t}value: ${e.tableIndex}`),i.push(`${t}value: ${e.tableNestedLevel}`),i.push(`${t}value: ${e.tableStartPosition}`),i.push(`${t}value: ${e.rowIndex}`),i.join(r)}static historyItemTableCellStateObject(e,t="",r="\t"){const i=[];return i.push(`${t}value: ${e.value}`),i.push(`${t}value: ${e.tableIndex}`),i.push(`${t}value: ${e.tableNestedLevel}`),i.push(`${t}value: ${e.tableStartPosition}`),i.push(`${t}value: ${e.rowIndex}`),i.push(`${t}value: ${e.cellIndex}`),i.join(r)}static historyItemIntervalStateObject(e,t="",r="\t"){const i=[];return i.push(`${t}value: ${e.value}`),i.push(`${t}interval: ${lg.fixedInterval(e.interval)}`),i.join(r)}static size(e,t="",r="\t"){const i=[];return i.push(`${t}width: ${e.width}`),i.push(`${t}height: ${e.height}`),i.join(r)}static cacheImageInfo(e,t="",r="\t"){const i=[];return i.push(`${t}base64Defined?: ${void 0!==e.base64}`),i.push(`${t}actualId: ${e.actualId}`),i.push(`${t}tmpId: ${e.tmpId}`),i.push(`${t}referenceInfo: ${e.referenceInfo}`),i.join(r)}static historyItemSectionStateObject(e,t="",r="\t"){const i=[];return i.push(`${t}value: ${e.value}`),i.push(`${t}sectionIndex: ${e.sectionIndex}`),i.join(r)}static historyItemState(e,t,r="\t",i="\n"){return sg.level_1(O.w(3,O.flip(O.flip(e,0,1),1,2))("",", "),t.objects,r,i)}static hyperlinkInfo(e,t="",r="\t"){const i=[];return e&&(i.push(`${t}uri: ${e.uri}`),i.push(`${t}tip: ${e.tip}`),i.push(`${t}anchor: ${e.anchor}`),i.push(`${t}visited: ${e.visited}`)),i.join(r)}static subDocumentInfoBase(e,t="",r="\t"){const i=[];return i.push(`${t}subDocumentId: ${e.subDocumentId}`),i.push(`${t}getType(): ${yo[e.getType()]}`),i.join(r)}static headerFooterSubDocumentInfoBase(e,t="",r="\t"){const i=[];return i.push(lg.subDocumentInfoBase(e,t,r)),i.push(`${t}headerFooterType: ${Ws[e.headerFooterType]}`),i.join(r)}static historyItemListLevelUseStateObject(e,t="",r="\t"){const i=[];return i.push(lg.historyItemListLevelStateObject(e,t,r)),i.push(`${t}use: ${e.use}`),i.join(r)}static historyItemIntervalState(e,t,r="\t",i="\n"){const n=[];return n.push(lg.historyItemState(e,t,r,i)()),n.push(`${r}interval: ${lg.fixedInterval(t.interval)}`),()=>n.join(i)}}class dg{constructor(e,t){this.interval=t,this.pageIndex=e}}class cg{setDefault(e){return this.left=e,this.middle=e,this.right=e,this.simple=e,this}setCustom(e,t,r,i){return this.left=e,this.middle=t,this.right=r,this.simple=i,this}allIsTrue(){return this.left&&this.middle&&this.right&&this.simple}atLeastOneIsTrue(){return this.left||this.middle||this.right||this.simple}atLeastOneIsFalse(){return!(this.left&&this.middle&&this.right&&this.simple)}copyFrom(e){return this.left=e.left,this.middle=e.middle,this.right=e.right,this.simple=e.simple,this}clone(){return(new cg).copyFrom(this)}}class hg{constructor(e,t,r,i){this.layout=e,this.subDocument=t,this.position=r,this.startPosition=r,this.detailsLevel=i,this.result=new Kp(i)}create(e,t){return this.endRowConflictFlags=e,this.middleRowConflictFlags=t,null}static createLightLayoutPosition(e,t,r,i,n,o,a){return t.isMain()?new ug(e,t,r,n).create((new cg).setDefault(o),(new cg).setDefault(a)):new pg(e,t,r,i,n).create((new cg).setDefault(o),(new cg).setDefault(a))}updateRowInfo(){var e=this.result.column.rows;const t=C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.columnOffset),this.position),r=e[t];[this.result.row,this.result.rowIndex]=hg.conflictResolver(this.position,this.endRowConflictFlags,e,r,t,(e=>e.columnOffset),(e=>e.getEndPosition())),this.result.detailsLevel>Hu.Row&&(this.position=Math.max(0,this.position-this.result.row.columnOffset),this.updateBoxInfo())}updateBoxInfo(){const e=this.result.row.boxes,t=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.rowOffset),this.position)),r=e[t];if([this.result.box,this.result.boxIndex]=hg.conflictResolver(this.position,this.middleRowConflictFlags,e,r,t,(e=>e.rowOffset),(e=>e.getEndPosition())),this.result.detailsLevel>Hu.Box){this.position=Math.max(0,this.position-this.result.box.rowOffset);const e=this.result.box.getLength();this.result.charOffset=this.position<e?this.position:e}}static conflictResolver(e,t,r,i,n,o,a){const s=r[n-1],l=o(i);if(s&&l==e){return l==a(s)?t.simple?[s,n-1]:[i,n]:t.right?[s,n-1]:[i,n]}const d=r[n+1];if(d){const r=a(i);if(e>=r){return r==o(d)?t.simple?[i,n]:[d,n+1]:e==r?t.left?[i,n]:[d,n+1]:t.middle?[i,n]:[d,n+1]}}return[i,n]}}class ug extends hg{constructor(e,t,r,i,n=!1){if(super(e,t,r,i),this.isUseMoreHardAlgorithm=n,!this.subDocument.isMain())throw new Error("LayoutPositionMainSubDocumentCreator need set here main sub document")}create(e,t){return super.create(e,t),this.layout.pages.length?this.updatePageInfo():this.result=null,this.result}static ensureLayoutPosition(e,t,r,i,n,o){const a=e.layout;for(;;){var s=new ug(a,t,r,i).create(n,o);if(s)break;if(!e.forceFormatPage(a.validPageCount))break}return s}updatePageInfoInterval(e,t,r){if(0==r.index&&this.position<=r.getPosition())return e>0?r:null;const i=Math.max(0,ig.getFirstPageInGroup(t,r.index).index-1),n=ig.getLastValidPageInGroup(t,r.index,e,!this.isUseMoreHardAlgorithm,!0);if(!n)return null;const o=Math.min(e,n.index+2),a=[];for(let e=Math.max(0,i-1);e<o;e++){const r=t[e];r.calculateContentIntervals(this.layout.anchorObjectsPositionInfo,this.isUseMoreHardAlgorithm);for(let e of r.getContentIntervals()){if(e.containsWithoutIntervalEndAndStart(this.position))return r;a.push(new dg(r.index,e))}}if(0==a.length)return null;a.sort(((e,t)=>e.interval.start-t.interval.start)),O.isDebug&&f.ListUtils.forEach(a,((e,t)=>{f.ListUtils.forEach(a,(t=>{if(nn.IntervalAlgorithms.getIntersectionNonNullLength(e.interval,t.interval))throw new Error("Detected page intervals intersection. It's very bad. "+f.ListUtils.map(a,(e=>lg.fixedInterval(e.interval))).join(", "))}),t+1)}));let s,l=a[0];for(let e=1;(s=a[e])&&!on.FixedInterval.fromPositions(l.interval.end,s.interval.start).containsWithIntervalEnd(this.position);e++)l=s;const d=l.pageIndex,c=s?s.pageIndex:d+1;return d==c?t[d]:c>=e?this.layout.isFullyFormatted||this.endRowConflictFlags.allIsTrue()&&f.ListUtils.unsafeAnyOf(t[d].getContentIntervals(),(e=>e.containsWithIntervalEnd(this.position)))?t[d]:null:s?this.getPageResolvedFlag(l.interval.end,s.interval.start)?t[d]:t[c]:this.layout.isFullyFormatted?t[d]:null}getPageResolvedFlag(e,t){return e==t?this.endRowConflictFlags.simple:e==this.position?this.endRowConflictFlags.left:t==this.position?this.endRowConflictFlags.right:this.endRowConflictFlags.middle}updatePageInfo(){var e=this.layout.validPageCount,t=this.layout.pages,r=t[Math.max(0,C.SearchUtils.normedInterpolationIndexOf(t,(e=>e.getPosition()),this.position,0,e-1))];r&&(this.result.page=this.updatePageInfoInterval(e,t,r)),this.result.page?(this.result.pageIndex=this.result.page.index,this.result.detailsLevel>Hu.Page&&(this.position=Math.max(0,this.position-this.result.page.getPosition()),this.updatePageAreaInfo())):this.result=null}updatePageAreaInfo(){var e=this.result.page.mainSubDocumentPageAreas;if(e.length>1){const t=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.pageOffset),this.position)),r=e[t];[this.result.pageArea,this.result.pageAreaIndex]=hg.conflictResolver(this.position,this.endRowConflictFlags,e,r,t,(e=>e.pageOffset),(e=>e.getEndPosition()))}else this.result.pageAreaIndex=0,this.result.pageArea=e[0];this.result.detailsLevel>Hu.PageArea&&(this.position=Math.max(0,this.position-this.result.pageArea.pageOffset),this.updateColumnInfo())}updateColumnInfo(){var e=this.result.pageArea.columns;if(e.length>1){const t=C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.pageAreaOffset),this.position),r=e[t];[this.result.column,this.result.columnIndex]=hg.conflictResolver(this.position,this.endRowConflictFlags,e,r,t,(e=>e.pageAreaOffset),(e=>e.getEndPosition()))}else this.result.columnIndex=0,this.result.column=e[0];this.result.detailsLevel>Hu.Column&&(this.position=Math.max(0,this.position-this.result.column.pageAreaOffset),this.updateRowInfo())}}class pg extends hg{constructor(e,t,r,i,n){if(super(e,t,r,n),this.subDocument.isMain())throw new Error("LayoutPositionMainSubDocumentCreator need set here not main sub document");this.result.page=this.layout.pages[i],this.result.pageIndex=i}create(e,t){return super.create(e,t),this.result.page?(this.result.pageArea=this.result.page.otherPageAreas[this.subDocument.id],this.result.pageArea?(this.result.pageAreaIndex=0,this.position=Math.max(0,this.position-this.result.pageArea.pageOffset),this.result.column=this.result.pageArea.columns[0],this.result.columnIndex=0,this.position=Math.max(0,this.position-this.result.column.pageAreaOffset),this.updateRowInfo()):this.result=null,this.result):(this.result=null,null)}}class gg extends gp{get name(){return _u.Page}fillResult(){const e=this.getPosition();if(null==e)return!0;if(this.setInputPositionState(),this.subDocument.isMain()){let t=ug.ensureLayoutPosition(this.layoutFormatterManager,this.subDocument,e,Hu.Page,(new cg).setDefault(!1),(new cg).setDefault(!0)),r=this.getFormattedResult(t.pageIndex+1);this.replaceTextByInterval(this.getTopField().getResultInterval(),r)}else this.replaceTextByLayoutDependentRun(this.getTopField().getResultInterval());return!0}getPosition(){let e=this.getTopField();return e.showCode?e.getCodeStartPosition():e.getResultStartPosition()}}class mg extends gp{get name(){return _u.PageRef}fillResult(){const e=this.getPosition();if(null==e)return!0;let t=!1;for(let e,r=0;e=this.switchInfoList[r];r++)e.type==ku.FieldSpecific&&"H"==e.name.toUpperCase()&&(t=!0);if(this.modelManager.history.beginTransaction(),this.setInputPositionState(),this.subDocument.isMain()){const r=ug.ensureLayoutPosition(this.layoutFormatterManager,this.subDocument,e,Hu.Page,(new cg).setDefault(!1),(new cg).setDefault(!0)),i=this.getFormattedResult(r.pageIndex+1);this.replaceTextByInterval(this.getTopField().getResultInterval(),i),t&&this.createLocalHyperLink(this.getTopField().getResultInterval(),this.getBookmarkName())}else this.replaceTextByLayoutDependentRun(this.getTopField().getResultInterval());return this.modelManager.history.endTransaction(),!0}getPosition(){const e=this.findBookmark(this.getBookmarkName());return e?e.start:null}getBookmarkName(){return this.parameterInfoList[0]?this.parameterInfoList[0].text:""}findBookmark(e){e=e.toUpperCase();for(let t of this.subDocument.bookmarks)if(t.name.toUpperCase()==e)return t;return null}}class fg extends gp{get name(){return _u.Seq}fillResult(){let e=this.getTopField(),t=this.updateSequenceInfo(e);if(!t||t.hidesResult)return this.removeInterval(this.getTopField().getResultInterval()),!0;let r=0;for(let i=0;i<=e.index;i++){const e=this.subDocument.fields[i].getSequenceInfo();e&&e.identifier==t.identifier&&(e.repeats||r++,e.resets&&(r=e.resetsWith))}let i=this.getFormattedResult(r);return this.removeInterval(this.getTopField().getResultInterval()),this.setInputPositionState(),this.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(this.subDocument,this.getTopField().getResultInterval().start),this.inputPos.charPropsBundle,cs.TextRun,i)),!0}updateSequenceInfo(e){let t,r,i;for(let e,n=0;e=this.switchInfoList[n];n++)if(e.type==ku.FieldSpecific)switch(e.name.toLocaleUpperCase()){case"C":t=e;break;case"H":r=e;break;case"R":i=e}const n=this.parameterInfoList[0]?this.parameterInfoList[0].text:"";let o=new Td(n,!!t,!!r,!!i,i?Number(i.arg):0);return e.setNewSequenceInfo(o),o}needUpdateInfo(){return!0}updateInfoCore(){this.updateSequenceInfo(this.getTopField())}}class bg extends gp{get name(){return _u.Tc}fillResult(){const e=this.getTopField();return this.updateTcInfo(e),!0}updateTcInfo(e){let t,r;for(let e,i=0;e=this.switchInfoList[i];i++)if(e.type==ku.FieldSpecific)switch(e.name.toLocaleUpperCase()){case"F":t=e;break;case"L":r=e}if(t&&t.arg){const i=this.parameterInfoList[0]?this.parameterInfoList[0].text:"",n=new vd(t.arg,i,r?Number(r.arg):1);e.setNewTcInfo(n)}}needUpdateInfo(){return!0}updateInfoCore(){this.updateTcInfo(this.getTopField())}}class Cg extends mp{get name(){return _u.Time}getDefaultFormat(){return this.modelManager.richOptions.fields.defaultTimeFormat}}var Sg,Ig,Pg,wg,yg,xg,Tg=__webpack_require__(9712);class vg{constructor(e,t){this.text=e,this.charProp=t,this.resultSize=this.charProp.getSize(this.text)}get signCssString(){return Nn.getSizeSignificantCssString(this.charProp)}}class Mg extends vg{getEncodedText(){return Tg.EncodeUtils.encodeHtml(this.text)}}class Eg extends vg{getEncodedText(){return this.text}}!function(e){e[e.None=0]="None",e[e.Dots=1]="Dots",e[e.MiddleDots=2]="MiddleDots",e[e.Hyphens=3]="Hyphens",e[e.Underline=4]="Underline",e[e.ThickLine=5]="ThickLine",e[e.EqualSign=6]="EqualSign"}(Sg||(Sg={}));class Dg extends qc{equals(e){return super.equals(e)&&this.spaceWidth==e.spaceWidth&&this.hiddenTabWidth==e.hiddenTabWidth&&this.tabLeaderSymbol==e.tabLeaderSymbol}clone(){const e=new Dg(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.spaceWidth=e.spaceWidth,this.hiddenTabWidth=e.hiddenTabWidth,this.tabLeaderSymbol=e.tabLeaderSymbol}setTabParams(e,t,r){this.tabLeaderSymbol=e,this.spaceWidth=t,this.hiddenTabWidth=r}getType(){return lc.TabSpace}pushInfoForMeasure(e,t){throw new Error(R.D.InternalException)}popInfoForMeasure(e,t){throw new Error(R.D.InternalException)}isVisible(){return!0}renderGetContent(e){if(0==this.hiddenTabWidth){var t=Math.ceil(this.width/Math.max(1,this.spaceWidth));return rn.StringUtils.repeat(this.tabLeaderSymbol,t)}var r=this.width-this.hiddenTabWidth,i=r<0?0:r/2,n=Math.floor(i/Math.max(1,this.spaceWidth)),o=this.width-(n*this.spaceWidth+this.hiddenTabWidth),a=o<0?0:Math.ceil(o/Math.max(1,this.spaceWidth));return rn.StringUtils.repeat(this.tabLeaderSymbol,n)+an.specialCharacters.HiddenTabSpace+rn.StringUtils.repeat(this.tabLeaderSymbol,a)}renderGetCharacterProperties(){if(this.characterProperties.fontBold||this.characterProperties.fontItalic||this.colorInfo.textColor){const e=this.characterProperties.clone();e.linkMeasurerSizes(this.characterProperties),e.fontBold=!1,e.fontItalic=!1;const t=new Se(this.colorInfo.textColor?0:this.colorInfo.textColor,this.colorInfo.foregroundColor,this.colorInfo.textColor&&!this.colorInfo.strikeoutColor?this.colorInfo.textColor:this.colorInfo.strikeoutColor,this.colorInfo.textColor&&!this.colorInfo.underlineColor?this.colorInfo.textColor:this.colorInfo.underlineColor);return new Kc(e,t)}return new Kc(this.characterProperties,this.colorInfo)}isWhitespace(){return!0}isLineBreak(){return!1}}class Fg extends Dg{static getTabLeaderMap(){const e={[Sg.None]:"&nbsp;",[Sg.Dots]:an.specialCharacters.Dot,[Sg.EqualSign]:an.specialCharacters.EqualSign,[Sg.Hyphens]:an.specialCharacters.Hyphen,[Sg.MiddleDots]:an.specialCharacters.MiddleDot,[Sg.ThickLine]:an.specialCharacters.Underscore,[Sg.Underline]:an.specialCharacters.Underscore};return Fg.tabLeaderSymbolList=[],Fg.tabLeaderTypeList=[],b.j.forEach(e,((e,t)=>{Fg.tabLeaderSymbolList.push(e),Fg.tabLeaderTypeList.push(t)})),e}getLayoutTabBox(e){const t=this.leadersMeasureInfo[e],r=this.clone();return r.setTabParams(Fg.tabLeaderMap[e],t.resultSize.width,this.showHiddenSymbols?this.hiddenTabMeasureInfo.resultSize.width:0),r.height=t.resultSize.height,r}pushInfoForMeasure(e,t){const r=this.renderGetCharacterProperties().initProps;f.ListUtils.forEach(Fg.tabLeaderSymbolList,(t=>e.push(new Eg(t,r)))),e.push(new Eg(an.specialCharacters.HiddenTabSpace,r))}popInfoForMeasure(e,t){this.leadersMeasureInfo={},this.hiddenTabMeasureInfo=e.pop(),f.ListUtils.reverseForEach(Fg.tabLeaderTypeList,(t=>this.leadersMeasureInfo[t]=e.pop())),this.showHiddenSymbols=t}}Fg.tabLeaderMap=Fg.getTabLeaderMap();class Rg extends Ze{constructor(e,t,r){super(e),this.bkmTemplate=r,this.boundSubDocument=t}}class Lg extends Rg{redo(){this.modelManipulator.bookmark.createBookmark(this.boundSubDocument,this.bkmTemplate,!0)}undo(){this.modelManipulator.bookmark.deleteBookmark(this.boundSubDocument,this.bkmTemplate)}}class Bg extends Rg{redo(){this.modelManipulator.bookmark.deleteBookmark(this.boundSubDocument,this.bkmTemplate)}undo(){this.modelManipulator.bookmark.createBookmark(this.boundSubDocument,this.bkmTemplate,!0)}}class Ag extends np{constructor(e,t,r=mn.notSetted,i=!0,n=()=>{}){super(e,t),this.parPropsBundle=r,this.applyDirectlyToNewParagraph=i,this.actionAfter=n}correctParams(){const e=this.subDocPos.subDocument.getDocumentEndPosition();this.subDocPos.position=P.MathUtils.restrictValue(this.subDocPos.position,0,e)}checkParams(){const e=this.subDocPos.subDocument.getDocumentEndPosition();return this.innerCheck(this.subDocPos.position>=0&&this.subDocPos.position<=e,R.D.InternalException)&&this.innerCheck(!!this.charPropsBundle.props,R.D.InternalException)&&this.innerCheck(!!this.charPropsBundle.style,R.D.InternalException)}clone(){return new Ag(this.subDocPos,this.charPropsBundle,this.parPropsBundle,this.applyDirectlyToNewParagraph,this.actionAfter)}static makeParamsByPosition(e,t=(new ju).setIntervals(tp.fromPosition(e.subDocument,e.position)),r=!0){const i=e.subDocument,n=e.position;let o=t.getCharacterStyle(),a=t.getMaskedCharacterProperties();const s=i.getRunByPosition(n).paragraph,l=s.paragraphStyle?s.paragraphStyle.nextParagraphStyle:null;r=r&&l&&s.getEndPosition()-1==n;let d=()=>{};if(s.isInList()&&!r){const e=i.getRunByPosition(s.getEndPosition()-1);a=e.maskedCharacterProperties.clone(),o=e.characterStyle}else{const e=n+an.specialCharacters.ParagraphMark.length;r&&i.isEditable([new on.FixedInterval(e,1)])&&(d=t=>{t.history.addAndRedo(new Op(t.modelManipulator,new gu(i,new on.FixedInterval(e,0)),t.model.stylesManager.addParagraphStyle(l)))})}return new Ag(new pu(i,n),new pn(a,o),new mn(void 0,void 0,un.default,void 0),!1,d)}}class Ng extends gp{get name(){return _u.Toc}fillResult(){this.modelManager.history.beginTransaction();const e=this.getTocParserParams(),t=this.createTocElements(e);return this.setInputPositionState(),this.resetParagraphTabs(),t.length>0?this.createToc(t,e):this.insertNoTocText(),this.modelManager.history.endTransaction(),!0}createTocElements(e){return e.fromTc?this.createTocElementsByTc(e):e.fromSeq?this.createTocElementsBySeq(e):this.createTocElementsByOutlineLevel(e)}createTocElementsByTc(e){let t=[];for(let r,i=0;r=this.subDocument.fields[i];i++)if(r.isTcField()){const i=r.getTcInfo();if(i.identifier.toUpperCase()==e.tcIdentifier.toUpperCase()&&(!e.useSpecifiedTcLevels||i.level>=e.tcLevelStart&&i.level<=e.tcLevelEnd)){const e=this.getBookmarkName(r.getAllFieldInterval());this.isValidHeading(i.text)&&t.push(new Og(e,i.text,i.level,!1))}}return t}createTocElementsBySeq(e){let t=[];for(let r,i=0;r=this.subDocument.fields[i];i++)if(r.isSequenceField()){if(r.getSequenceInfo().identifier.toUpperCase()==e.seqIdentifier.toUpperCase()){const e=this.subDocument.getParagraphByPosition(r.getCodeStartPosition()).interval;e.length-=1;const i=this.subDocument.getSimpleText(e).trim(),n=this.getBookmarkName(e);this.isValidHeading(i)&&t.push(new Og(n,i,1,!1))}}return t}createTocElementsByOutlineLevel(e){let t=[];for(let r,i=0;r=this.subDocument.paragraphs[i];i++){const i=r.paragraphStyle.getMergedParagraphProperties().outlineLevel,n=e.fromOutlineLevel&&i<=0?r.getParagraphMergedProperties().outlineLevel:i;if(n>0&&(!e.useSpecifiedLevels||n>=e.specifiedLevelStart&&n<=e.specifiedLevelEnd)){const e=this.getParagraphInterval(r),i=this.getBookmarkName(e),o=this.subDocument.getSimpleText(r.interval).trim().replace(new RegExp(an.specialCharacters.TabMark,"gi"),an.specialCharacters.Space);let a=o;const s=r.getNumberingListIndex()>=0;s&&(a=r.getNumberingListText()+r.getNumberingListSeparatorChar()+o),this.isValidHeading(a)&&t.push(new Og(i,a,n,s))}}return t}static getParagraphInterval(e,t){const r=new jh(e,!1),i=t.interval.end-1;for(r.setPosition(t.startLogPosition.value);r.getAbsolutePosition()<i&&this.isWhiteSpace(r.getCurrentChar())&&r.moveToNextChar(););const n=r.getAbsolutePosition(),o=t.interval.length-(n-t.startLogPosition.value)-1;return new on.FixedInterval(n,o)}getParagraphInterval(e){return Ng.getParagraphInterval(this.subDocument,e)}static isWhiteSpace(e){return an.isWhitespace.test(e)||e==an.specialCharacters.NonBreakingSpace||e==an.specialCharacters.PageBreak||e==an.specialCharacters.ColumnBreak||e==an.specialCharacters.LineBreak}createToc(e,t){let r=[];for(let i,n=0;i=e[n];n++){const o=this.interval.start;this.resetParagraphTabs(),this.insertHeading(i),i.hasNumbering&&this.insertTocNumberingTabInfo(i.level),t.useCustomSeparator||this.insertDotTabInfo(),(!t.omitsPageNumbers||i.level<t.omitsPageNumbersStart||i.level>t.omitsPageNumbersEnd)&&(this.insertSeparator(t),r.push(this.insetPageRef(i))),t.asHyperlink&&this.createLocalHyperLink(on.FixedInterval.fromPositions(o,this.interval.end),i.bookmarkName),this.setParagraphStyle(i),e[n+1]&&(this.removeInterval(this.interval),this.modelManager.modelManipulator.paragraph.insertParagraphViaHistory(new Ag(new pu(this.subDocument,this.interval.start),this.inputPos.charPropsBundle,mn.notSetted,!0,(()=>{}))))}if(r.length>0){let e=[];f.ListUtils.forEach(r,(t=>{e.push(t.getAllFieldInterval())})),new Jg(this.modelManager,this.layoutFormatterManager,new Rp,new mu(this.subDocument,e),new $g,(()=>{})).update(null)}}insertNoTocText(){this.replaceTextByInterval(this.interval,this.layoutFormatterManager.stringResources.commonLabels.noTocEntriesFound)}resetParagraphTabs(){const e=this.subDocument.getParagraphIndexByPosition(this.interval.start),t=this.subDocument.paragraphs[e];let r,i=t.getTabs();for(;r=i.positions.pop();)this.modelManager.history.addAndRedo(new ot(this.modelManager.modelManipulator,new gu(this.subDocument,t.interval),r))}setParagraphStyle(e){const t=this.subDocument.paragraphs[this.subDocument.getParagraphIndexByPosition(this.interval.start)];this.modelManager.modelManipulator.style.applyParagraphStyleByName(new gu(this.subDocument,t.interval),`${es.tocStyleName} ${e.level}`)}insertHeading(e){this.replaceTextByInterval(this.interval,e.text)}insertSeparator(e){const t=e.useCustomSeparator?e.separator:an.specialCharacters.TabMark;this.replaceTextByInterval(this.interval,t)}insertDotTabInfo(){const e=this.modelManager.model.getSectionByPosition(this.interval.start).sectionProperties,t=e.pageWidth-e.marginLeft-e.marginRight;this.insertTabInfo(t,Sg.Dots,Ha.Right,!1)}insertTocNumberingTabInfo(e){const t=g.u.inchesToTwips(.31)+(e-1)*g.u.inchesToTwips(.15);this.insertTabInfo(t,Sg.None,Ha.Left,!1)}insertTabInfo(e,t,r,i){const n=this.interval,o=new rs(e,r,t,!1,i);this.modelManager.history.addAndRedo(new nt(this.modelManager.modelManipulator,new gu(this.subDocument,n),o))}insetPageRef(e){const t=this.interval;this.modelManager.history.addAndRedo(new pp(this.modelManager.modelManipulator,this.subDocument,t.start,0,t.length,!1,this.inputPos.charPropsBundle));let r=Md.normedBinaryIndexOf(this.subDocument.fields,t.start+1),i=this.subDocument.fields[r];const n=this.modelManager.model.simpleFormattersManager.formatString('PAGEREF "{0}" \\h',e.bookmarkName);return this.replaceTextByInterval(i.getCodeInterval(),n),i}getTocParserParams(){let e=new kg;for(let t,r=0;t=this.switchInfoList[r];r++)if(t.type==ku.FieldSpecific)switch(t.name.toLocaleUpperCase()){case"H":e.asHyperlink=!0;break;case"F":e.tcIdentifier=t.arg,e.fromTc=!!e.tcIdentifier;break;case"C":e.seqIdentifier=t.arg,e.fromSeq=!!e.seqIdentifier;break;case"U":e.fromOutlineLevel=!0;break;case"P":e.useCustomSeparator=!0,e.separator=t.arg;break;case"O":const r=new _g(t.arg);e.useSpecifiedLevels=r.isValid(),e.specifiedLevelStart=r.getStart(),e.specifiedLevelEnd=r.getEnd();break;case"L":const i=new _g(t.arg);e.useSpecifiedTcLevels=i.isValid(),e.tcLevelStart=i.getStart(),e.tcLevelEnd=i.getEnd();break;case"N":e.omitsPageNumbers=!0;const n=new _g(t.arg);n.isValid()?(e.omitsPageNumbersStart=n.getStart(),e.omitsPageNumbersEnd=n.getEnd()):(e.omitsPageNumbersStart=1,e.omitsPageNumbersEnd=9)}return e}isValidHeading(e){if(!e)return!1;for(let t,r=0;t=e[r];r++)if(!an.isWhitespace.test(t))return!0;return!1}get interval(){let e=this.getTopField().getResultInterval().end;return new on.FixedInterval(e,0)}getBookmarkName(e){const t=f.ListUtils.elementBy(this.subDocument.bookmarks,(t=>t.isToc()&&t.start==e.start&&t.end==e.end));return t?t.name:this.createNewBookmark(e)}createNewBookmark(e){const t=this.generateNewBookmarkName();return this.modelManager.history.addAndRedo(new Lg(this.modelManager.modelManipulator,this.subDocument,new Sd(e,t))),t}generateNewBookmarkName(){for(;;){const e=this.modelManager.model.simpleFormattersManager.formatString("_Toc{0}",P.MathUtils.getRandomInt(0,1e10));for(let t,r=0;t=this.subDocument.bookmarks[r];r++)if(t.name.toUpperCase()==e.toUpperCase())continue;return e}}}class kg{constructor(){this.asHyperlink=!1,this.fromOutlineLevel=!1,this.fromTc=!1,this.fromSeq=!1,this.useCustomSeparator=!1,this.useSpecifiedLevels=!1,this.omitsPageNumbers=!1,this.useSpecifiedTcLevels=!1}}class Og{constructor(e,t,r,i){this.bookmarkName=e,this.text=t,this.level=r,this.hasNumbering=i}}class _g{constructor(e){this.start=Number(e.split("-")[0]),this.end=Number(e.split("-")[1])}getStart(){return this.isValid()?this.start:null}getEnd(){return this.isValid()?this.end:null}isValid(){return!isNaN(this.start)&&!isNaN(this.end)&&this.start>=0&&this.end>=0&&this.end>=this.start}}class Ug extends gp{get name(){return _u.FillIn}fillResult(){var e,t,r;const i=f.ListUtils.reducedMap(this.switchInfoList,(e=>e.type==ku.FieldSpecific?e:null)),n="d"==(null===(e=i[0])||void 0===e?void 0:e.name)?i[0].arg:"",o=null!==(r=null===(t=this.parameterInfoList[0])||void 0===t?void 0:t.text)&&void 0!==r?r:"",a=window.prompt(o,n);return a&&(this.setInputPositionState(),this.replaceTextByInterval(this.getTopField().getResultInterval(),a)),!0}}class Hg extends gp{get name(){return _u.If}fillResult(){this.setInputPositionState();let e=null;try{e=this.getResult()}catch(t){t instanceof zg&&(e=t.message)}finally{return e&&this.replaceTextByInterval(this.getTopField().getResultInterval(),e),!0}}getResult(){return this.parseParameters(this.parameterInfoList).evaluate()}parseParameters(e){var t,r,i,n,o,a,s,l,d,c,h,u;if(e.length>5)throw new Xg;if(0===e.length)throw new Gg;let p,g,m,f,b;return e.length<=3&&!Vg.isOperator(null===(t=e[1])||void 0===t?void 0:t.text)?(p=new Wg(null===(r=e[0])||void 0===r?void 0:r.text,null===(i=e[0])||void 0===i?void 0:i.quoted),f=null===(n=e[1])||void 0===n?void 0:n.text,b=null===(o=e[2])||void 0===o?void 0:o.text):(p=new Wg(null===(a=e[0])||void 0===a?void 0:a.text,null===(s=e[0])||void 0===s?void 0:s.quoted),g=null===(l=e[1])||void 0===l?void 0:l.text,m=new Wg(null===(d=e[2])||void 0===d?void 0:d.text,null===(c=e[2])||void 0===c?void 0:c.quoted),f=null===(h=e[3])||void 0===h?void 0:h.text,b=null===(u=e[4])||void 0===u?void 0:u.text),new Vg(g,p,m,f,b)}}class Vg{constructor(e,t,r,i=void 0,n=void 0){this.operator=e,this.leftExpression=t,this.rightExpression=r,this.trueText=i,this.falseText=n}static isOperator(e){return Vg.operators.includes(e)}evaluate(){if(!this.operator&&!this.leftExpression.isNumber)return this.leftExpression.text?this.trueText:this.falseText;if(!Vg.isOperator(this.operator))throw new jg;let e;if(this.leftExpression.isNumber&&this.rightExpression.isNumber)e=this.leftExpression.number-this.rightExpression.number;else{e=("="===this.operator||"<>"===this.operator?Vg.compareStringsWithWildcards:Vg.compareStrings)(this.leftExpression.text,this.rightExpression.text)}return this.evaluateComparison(e)?this.trueText:this.falseText}evaluateComparison(e){switch(this.operator){case"<":return e<0;case">":return e>0;case"=":return 0===e;case"<=":return e<=0;case">=":return e>=0;case"<>":return 0!=e;default:return!1}}static compareStrings(e,t){return e.localeCompare(t)}static compareStringsWithWildcards(e,t){const r=t.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*").replace(/\?/g,".");return new RegExp(`^${r}$`).test(e)?0:1}}Vg.operators=["<",">","=","<=",">=","<>"];class Wg{constructor(e,t=!1){this.text=e,this.number=parseFloat(e),this.isNumber=!t&&!Number.isNaN(this.number)}}class zg extends Error{constructor(e){super(e),Object.setPrototypeOf(this,zg.prototype)}}class jg extends zg{constructor(e){super(null!=e?e:"IF field error: Invalid comparison operator"),Object.setPrototypeOf(this,jg.prototype)}}class Xg extends zg{constructor(e){super(null!=e?e:"IF field error: Too many parameters"),Object.setPrototypeOf(this,Xg.prototype)}}class Gg extends zg{constructor(e){super(null!=e?e:"IF field error: Missing parameter(s)"),Object.setPrototypeOf(this,Gg.prototype)}}class Kg{constructor(e){this.interval=e,this.parsers=[],this.updated=!1}destructor(e){this.interval.destructor(e)}}class qg{constructor(e){this.subDocIntervals=e}}class $g{constructor(e=!0,t=!0){this.updateToc=e,this.updateFillIn=t}}class Jg{get fields(){return this.subDocument.fields}constructor(e,t,r,i,n,o){this.infoForFutureUpdate=[],this.savedSelectionIntervals=[],this.modelManager=e,this.layoutFormatterManager=t,this.requestManager=r,this.callback=o,this.subDocument=i.subDocument,this.options=n,this.infoForFutureUpdate=f.ListUtils.map(i.intervals,(e=>new Kg(new md(this.subDocument.positionManager,e)))),this.savedSelectionIntervals=f.ListUtils.map(i.intervals,(e=>new md(this.subDocument.positionManager,e)))}update(e,t=!0){if(0!=this.fields.length){this.requestManager.checkResponse(this.subDocument,e),this.requestManager.clear(this.subDocument);for(var r,i=0,n=0;r=this.infoForFutureUpdate[n];n++)if(r.updated)i++;else if(r.parsers.length>0)this.continueUpdateCurrentInterval(r.parsers,e)&&(r.updated=!0,i++);else{for(var o=Math.max(0,Md.normedBinaryIndexOf(this.fields,r.interval.start+1)),a=this.fields[o];!a.getAllFieldInterval().containsWithIntervalEnd(r.interval.start)&&a.parent;)a=a.parent;var s=a.parent,l=!1;for(o=a.index;a=this.fields[o];o++){const t=a.getFieldStartPosition();if(t>r.interval.end||t==r.interval.end&&r.interval.length>0)break;if(a.getFieldEndPosition()<=r.interval.start||null!=a.parent&&a.parent!=s||!this.subDocument.isEditable([a.getAllFieldInterval()]))continue;const i=Jg.getParser(this.modelManager,this.layoutFormatterManager,this.requestManager,this.subDocument,a);if(i){if(!this.options.updateToc&&i instanceof Ng||!this.options.updateFillIn&&i instanceof Ug){const e=a.getFieldEndPosition();i.destructor();for(let t=o+1;a=this.fields[t];t++)if(a.getFieldStartPosition()>=e){o=t-1;break}continue}i.update(e)?i.destructor():(l=!0,r.parsers.push(i))}else this.modelManager.modelManipulator.range.removeInterval(new gu(this.subDocument,a.getResultInterval()),!0,!1),cp.finalAction(this.layoutFormatterManager,a,this.subDocument)}l||(r.updated=!0,i++)}this.infoForFutureUpdate.length!=i?this.requestManager.sendRequest(this.subDocument,this.modelManager.richOptions.mailMerge.activeRecordIndex,t):(this.requestManager.forceSendDelayedRequests(),this.endAction())}else this.endAction()}endAction(){const e=f.ListUtils.map(this.savedSelectionIntervals,(e=>{const t=e.getFixedInterval();return e.destructor(this.subDocument.positionManager),t}));for(let e of this.infoForFutureUpdate)e.destructor(this.subDocument.positionManager);this.infoForFutureUpdate=[],this.callback(new qg(new mu(this.subDocument,e)))}continueUpdateCurrentInterval(e,t){for(var r,i=!0,n=0;r=e[n];n++)r.update(t)?(r.destructor(),e.splice(n,1),n--):i=!1;return i}static getParser(e,t,r,i,n){const o=new jh(i,!1);o.setPosition(n.getCodeStartPosition());const a=Jg.findName(o),s=Jg.parsersMap[a.fieldName];return s?s({modelManager:e,layoutFormatterManager:t,requestManager:r,subDocument:i,field:n,modelIterator:o,fieldNameFirstLetterPosition:a.fieldNameFirstLetterPosition}):null}static findName(e){for(;e.run.getType()==cs.TextRun&&an.isWhitespace.test(e.getCurrentChar())||e.run.getType()==cs.ParagraphRun||e.run.getType()==cs.SectionRun;)e.moveToNextChar();const t=e.getAbsolutePosition();let r="";do{r+=e.getCurrentChar(),e.moveToNextChar()}while(e.run.getType()==cs.TextRun&&!an.isWhitespace.test(e.getCurrentChar())&&e.run.getType()!=cs.ParagraphRun&&e.run.getType()!=cs.SectionRun);return new Yg(r.toUpperCase(),t)}}Jg.TOC_NAME="TOC",Jg.parsersMap={IF:e=>new Hg(e),DATE:e=>new mp(e),TIME:e=>new Cg(e),DOCVARIABLE:e=>new Np(e),HYPERLINK:e=>new Hp(e),MERGEFIELD:e=>new Vp(e),NUMPAGES:e=>new Wp(e),PAGE:e=>new gg(e),SEQ:e=>new fg(e),TC:e=>new bg(e),[Jg.TOC_NAME]:e=>new Ng(e),PAGEREF:e=>new mg(e),FILLIN:e=>new Ug(e)};class Yg{constructor(e,t){this.fieldName=e,this.fieldNameFirstLetterPosition=t}}class Qg{constructor(e,t,r,i){this.layout=t,this.subDocument=e,this.intervalStart=r,this.intervalEnd=i,this.lastModelPosition=-1}isInitialized(){throw new Error(R.D.NotImplemented)}resetToInterval(e,t){return this.intervalStart=e,this.intervalEnd=t,this.lastModelPosition=-1,this.isInitialized()}moveNext(e,t){if(this.endRowConflictFlags=e.clone(),this.middleRowConflictFlags=t.clone(),this.lastModelPosition<0&&(this.position=this.getNewLayoutPosition(this.intervalStart,this.endRowConflictFlags,this.middleRowConflictFlags),!this.position&&this.endRowConflictFlags.atLeastOneIsFalse()&&(this.position=this.getNewLayoutPosition(this.intervalStart,this.endRowConflictFlags.setDefault(!0),this.middleRowConflictFlags)),this.position))return this.lastModelPosition=this.position.getLogPosition(),!0;if(this.lastModelPosition>this.intervalEnd||this.lastModelPosition<0)return!1;if(this.lastModelPosition==this.intervalEnd)return this.setBoundPosition(this.intervalEnd,this.position,(e=>e<this.lastModelPosition));const r=this.position.clone();if(!this.advancePosition())return this.position.charOffset!=this.position.box.getLength()&&this.setBoundPosition(this.intervalEnd,r,(e=>e<this.lastModelPosition));const i=this.position.getLogPosition();return i>=this.intervalEnd?this.setBoundPosition(this.intervalEnd,r,(e=>e<this.lastModelPosition)):(this.lastModelPosition=i,!0)}movePrev(e,t){if(this.endRowConflictFlags=e.clone(),this.middleRowConflictFlags=t.clone(),this.lastModelPosition<0&&(this.position=this.getNewLayoutPosition(this.intervalEnd,this.endRowConflictFlags,this.middleRowConflictFlags),!this.position&&this.endRowConflictFlags.atLeastOneIsFalse()&&(this.position=this.getNewLayoutPosition(this.intervalEnd,this.endRowConflictFlags.setDefault(!0),this.middleRowConflictFlags)),this.position))return this.lastModelPosition=this.position.getLogPosition(),!0;if(this.lastModelPosition<this.intervalStart||this.lastModelPosition<0)return!1;if(this.lastModelPosition==this.intervalStart)return this.setBoundPosition(this.intervalStart,this.position,(e=>e>this.lastModelPosition));const r=this.position.clone();if(!this.advancePositionBack())return!1;const i=this.position.getLogPosition();return i<=this.intervalStart?this.setBoundPosition(this.intervalStart,r,(e=>e>this.lastModelPosition)):(this.lastModelPosition=i,!0)}setBoundPosition(e,t,r){let i=this.getNewLayoutPosition(e,this.endRowConflictFlags,this.middleRowConflictFlags);i||(i=this.getNewLayoutPosition(e,this.endRowConflictFlags.setDefault(!0),this.middleRowConflictFlags));const n=i.getLogPosition();return i.equals(t)||r(n)?(this.position=t,!1):(this.position=i,this.lastModelPosition=n,!0)}advancePosition(){return this.position.boxIndex+1<this.position.row.boxes.length?(this.position.boxIndex++,this.position.box=this.position.row.boxes[this.position.boxIndex],this.position.charOffset=0,!0):!!this.position.advanceToNextRow(this.layout)&&(this.position.boxIndex=0,this.position.box=this.position.row.boxes[0],this.position.charOffset=0,!0)}advancePositionBack(){return 0!=this.position.charOffset?(this.position.charOffset=0,!0):this.position.boxIndex>0?(this.position.boxIndex--,this.position.box=this.position.row.boxes[this.position.boxIndex],this.position.charOffset=0,!0):!!this.position.advanceToPrevRow(this.layout)&&(this.position.boxIndex=this.position.row.boxes.length-1,this.position.box=this.position.row.boxes[this.position.boxIndex],this.position.charOffset=0,!0)}}class Zg{constructor(e,t){this.lp=e,this.layout=t,this.oldLp=e.clone()}finalHandle(e){if(e&&!this.lp.page)throw new Error("Likely model is incorrect. See last table actions");return!(!e||!this.lp.page.isValid)||(this.lp.copyFrom(this.oldLp),!1)}setLayoutRowInCell(e,t){const r=t?e=>0:e=>e.layoutRows.length,i=t?e=>e.tableRows[0].rowCells[0]:e=>f.ListUtils.last(f.ListUtils.last(e.tableRows).rowCells);let n;for(;n=e.internalTables[r(e)];)e=i(n);this.setLayoutRow((t?e.layoutRows[0]:f.ListUtils.last(e.layoutRows)).indexInColumn,t)}setLayoutRow(e,t){return this.lp.rowIndex=e,this.lp.row=this.lp.column.rows[this.lp.rowIndex],!!this.lp.row&&((t?qp.onStartBoxLevel:qp.onEndBoxLevel)(this.lp),!0)}advanceBoxSimple(e,t){return t?this.lp.boxIndex++:this.lp.boxIndex--,this.lp.box=this.lp.row.boxes[this.lp.boxIndex],this.lp.box?(t?qp.onStartCharLevel(this.lp):qp.onEndCharLevel(this.lp),!0):!!e&&this.advanceRowSimple(!0,t)}advanceRowSimple(e,t){return t?this.lp.rowIndex++:this.lp.rowIndex--,!!this.setLayoutRow(this.lp.rowIndex,t)||!!e&&this.advanceColumnSimple(!0,t)}advanceColumnSimple(e,t){return t?this.lp.columnIndex++:this.lp.columnIndex--,this.lp.column=this.lp.pageArea.columns[this.lp.columnIndex],this.lp.column?(t?qp.onStartRowLevel(this.lp):qp.onEndRowLevel(this.lp),!0):!!e&&this.advancePageAreaSimple(!0,t)}advancePageAreaSimple(e,t){return t?this.lp.pageAreaIndex++:this.lp.pageAreaIndex--,this.lp.pageArea=this.lp.page.mainSubDocumentPageAreas[this.lp.pageAreaIndex],this.lp.pageArea?(t?qp.onStartColumnLevel(this.lp):qp.onEndColumnLevel(this.lp),!0):!!e&&this.advancePageSimple(t)}advancePageSimple(e){return e?this.lp.pageIndex++:this.lp.pageIndex--,this.lp.page=this.layout.pages[this.lp.pageIndex],!!this.lp.page&&(e?qp.onStartPageAreaLevel(this.lp):qp.onEndPageAreaLevel(this.lp),!0)}setRowByGridInfo(e,t,r,i,n){if(n&&!this.advanceColumnSimple(!0,i))return!1;const o=f.ListUtils.elementBy(this.lp.column.tablesInfo,(e=>e.logicInfo==t));if(!o)return!1;const a=e?f.ListUtils.unsafeAnyOf:f.ListUtils.unsafeReverseAnyOf,s=t.grid.tableCellGridInfos,l=a(o.tableRows,(e=>{const t=s[e.rowIndex];return a(e.rowCells,(e=>t[e.cellGridIndex]==r?e:null))}));return l&&(e?i||l.boundFlags.get(_a.StartOnThisColumn):!i||l.boundFlags.get(_a.EndOnThisColumn))?(this.setLayoutRowInCell(l,e),!0):this.setRowByGridInfo(e,t,r,i,!0)}static getNextTableCellGridInfo(e,t,r,i,n){let o;const a=e?f.ListUtils.unsafeAnyOf:f.ListUtils.unsafeReverseAnyOf;return a(t.table.rows,((i,s)=>(-2==n&&(n=i.cells.length-1),o=a(i.cells,((e,i)=>{if(e.verticalMerging!=Xe.Continue){const e=t.tableCellInfos[s][i];return e==r?null:e}return null}),n),o||(n=e?0:-2,null))),i)?o:null}}class em extends Zg{advance(){return 0!=this.lp.charOffset?(qp.onEndCharLevel(this.lp),!0):this.finalHandle(!!this.advanceBoxSimple(!1,!1)||this.moveToPrevRow())}moveToPrevRow(){const e=this.lp.row.tableCellInfo;if(!e){if(!this.advanceRowSimple(!0,!1))return!1;const e=this.lp.row.tableCellInfo;return!e||(this.setOnLastCellOnTable(e.parentRow.parentTable.logicInfo),!0)}if(this.advanceRowSimple(!1,!1)){const t=this.lp.row.tableCellInfo;if(t){if(t==e||e.parentRow.parentTable.parentCell==t)return!0;if(t.parentRow.parentTable.parentCell==e)return this.setOnLastCellOnTable(t.parentRow.parentTable.logicInfo),!0}}return this.moveToPrevCell(e)}setOnLastCellOnTable(e){const t=e.grid,r=t.tableCellInfos.length-1,i=t.tableCellInfos[r].length-1,n=Zg.getNextTableCellGridInfo(!1,t,null,r,i);this.setRowByGridInfo(!1,e,n,!1,!1)}moveToPrevCell(e){const t=e.parentRow.parentTable.logicInfo,r=t.grid,i=e.parentRow.rowIndex,n=r.tableCellGridInfos[i][e.cellGridIndex];if(!e.boundFlags.get(_a.StartOnThisColumn))return this.setRowByGridInfo(!1,t,n,!1,!0),!0;const o=Zg.getNextTableCellGridInfo(!1,r,n,i,n.getCellIndex(i-n.getStartRowIndex())-1);if(o){const e=o.getEndRowIndex()-1>=i,r=this.lp.clone();if(!this.setRowByGridInfo(!1,t,o,e,!1)){if(this.lp.copyFrom(r),!e)throw new Error(R.D.InternalException);this.setRowByGridInfo(!1,t,o,!1,!0)}return!0}const a=e.parentRow.parentTable,s=a.parentCell;if(s){const t=b.j.keyBy(s.internalTables,(e=>e==a)),r=s.layoutRows[t-1];if(r)return this.setLayoutRow(r.indexInColumn,!1),!0;if(e.boundFlags.get(_a.StartOnThisColumn))return this.moveToPrevCell(s);const i=s.parentRow,n=i.parentTable.logicInfo,o=n.grid.tableCellGridInfos[i.rowIndex][s.cellGridIndex];return this.setRowByGridInfo(!1,n,o,!1,!0),!0}return this.lp.copyFrom(this.oldLp),this.advanceRowSimple(!0,!1)}}class tm extends Zg{advance(){return this.finalHandle(!!this.advanceBoxSimple(!1,!0)||this.moveToNextRow())}moveToNextRow(){const e=this.lp.row.tableCellInfo;if(!e)return this.advanceRowSimple(!0,!0);if(this.advanceRowSimple(!1,!0)){const t=this.lp.row.tableCellInfo;if(t&&(t==e||t.parentRow.parentTable.parentCell==e))return!0}return this.moveToNextCell(e)}moveToNextCell(e){const t=e.parentRow.parentTable.logicInfo,r=t.grid,i=e.parentRow.rowIndex,n=r.tableCellGridInfos[i][e.cellGridIndex];if(!e.boundFlags.get(_a.EndOnThisColumn))return this.setRowByGridInfo(!0,t,n,!0,!0),!0;const o=Zg.getNextTableCellGridInfo(!0,r,n,n.getStartRowIndex(),n.getCellIndex(0)+1);if(o){const e=o.getStartRowIndex()<=i,r=this.lp.clone();if(!this.setRowByGridInfo(!0,t,o,!e,!1)){if(this.lp.copyFrom(r),e)throw new Error(R.D.InternalException);this.setRowByGridInfo(!0,t,o,!0,!0)}return!0}const a=e.parentRow.parentTable,s=a.parentCell;if(s){const e=b.j.keyBy(s.internalTables,(e=>e==a)),t=s.layoutRows[e];return t?(this.setLayoutRow(t.indexInColumn,!0),!0):this.toNextRowAfterTable(a)}return this.lp.copyFrom(this.oldLp),this.toNextRowAfterTable(e.parentRow.parentTable)}toNextRowAfterTable(e){const t=e.logicInfo;let r=this.lp.clone(),i=f.ListUtils.elementBy(this.lp.column.tablesInfo,(e=>e.logicInfo==t));for(;this.advanceColumnSimple(!0,!0);){const e=f.ListUtils.elementBy(this.lp.column.tablesInfo,(e=>e.logicInfo==t));if(!e)break;r=this.lp.clone(),i=e}this.lp.copyFrom(r);const n=f.ListUtils.accumulate(f.ListUtils.last(i.tableRows).rowCells,-1,((e,t)=>Math.max(f.ListUtils.last(t.layoutRows).indexInColumn,e)))+1,o=this.lp.column.rows[n];if(o){const e=i.parentCell;if(!e)return this.setLayoutRow(n,!0);if(o.tableCellInfo==e)return this.setLayoutRow(n,!0);const t=e.parentRow.parentTable.logicInfo,r=t.grid.tableCellGridInfos[e.parentRow.rowIndex][e.cellGridIndex];return e.boundFlags.get(_a.EndOnThisColumn)?(this.setLayoutRow(n,!0),!0):(this.setRowByGridInfo(!0,t,r,!0,!0),!0)}return!!this.advanceColumnSimple(!0,!0)&&(this.setLayoutRow(0,!0),!0)}}class rm extends Qg{constructor(e,t,r,i){super(e,t,r,i)}isInitialized(){if(!this.layout.isFullyFormatted){const e=this.layout.getLastValidPage();if(!e||this.intervalEnd>f.ListUtils.last(e.getContentIntervals()).end)return!1}return!0}getNewLayoutPosition(e,t,r){return new ug(this.layout,this.subDocument,e,Hu.Character).create(t,r)}advancePosition(){return new tm(this.position,this.layout).advance()}advancePositionBack(){return new em(this.position,this.layout).advance()}}class im extends Qg{constructor(e,t,r,i,n){super(e,t,r,i),this.pageIndex=n}isInitialized(){const e=this.layout.pages[this.pageIndex];return!(!e||e.otherPageAreas[this.subDocument.id].getEndPosition()<this.intervalEnd)}getNewLayoutPosition(e,t,r){return new pg(this.layout,this.subDocument,e,this.pageIndex,Hu.Character).create(t,r)}}class nm extends Ze{canBeMerged(){return!0}constructor(e,t){super(e),this.params=t.clone()}redo(){this.modelManipulator.text.insertTextInner(this.params)}undo(){this.modelManipulator.range.removeIntervalWithoutHistory(this.params.subDocPos.subDocument,new on.FixedInterval(this.params.subDocPos.position,this.params.text.length),!1)}}!function(e){e[e.Start=0]="Start",e[e.Found=1]="Found",e[e.DocumentBegin=2]="DocumentBegin",e[e.DocumentEnd=3]="DocumentEnd",e[e.SearchEnd=4]="SearchEnd"}(Ig||(Ig={})),function(e){e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.All=3]="All"}(Pg||(Pg={}));class om{constructor(e,t,r,i,n,o){this.modelManager=e,this.layoutFormatterManager=t,this.pageIndex=r,this.subDocument=i,this.layout=n,this.storeSelection=o}setSearchParams(e,t,r,i,n,o,a){if(o<0||o>this.subDocument.getDocumentEndPosition())throw"In FindReplaceHelper setSearchParams findWithPosition < 0 || findWithPosition > this.subDocument.getDocumentEndPosition()";if(a&&n)throw"In FindReplaceHelper setSearchParams can't set wholeWordsOnly && regularExpression";if(a&&om.isCanSetWholeWordsOnlyForThisExpression(e)>=0)throw"In FindReplaceHelper setSearchParams whatFind expression consider not Alphanumeric char["+om.isCanSetWholeWordsOnlyForThisExpression(e)+"]";const s=this.template!=(i?e:e.toUpperCase())||this.regularExpression!=n||this.matchCase!=i||this.searchDirection==Pg.Up&&r!=Pg.Up||this.searchDirection!=Pg.Up&&r==Pg.Up;this.replaceWith=t,this.searchDirection=r,this.regularExpression=n,this.matchCase=i,this.wholeWordsOnly=a,this.template=this.matchCase?e:e.toUpperCase(),this.lastFound=null,this.state=Ig.Start,this.beginOrStartDocumentReach=!1,this.findWithPosition=o,this.currentPos=o,this.templateLength=e.length,(!this.wholeWordsOnly&&s||!this.supportFunction)&&this.crateSupportFunction()}static isCanSetWholeWordsOnlyForThisExpression(e){for(let t=0;t<e.length;t++)if(!e[t].match(an.isAlphanumeric))return t;return-1}findNext(){let e;switch(this.state==Ig.SearchEnd&&this.setSearchParams(this.template,this.replaceWith,this.searchDirection,this.matchCase,this.regularExpression,this.findWithPosition,this.wholeWordsOnly),this.searchDirection){case Pg.Down:e=this.findNextDown();break;case Pg.All:e=this.findNextAll();break;case Pg.Up:e=this.findNextUp()}return e!=Ig.DocumentEnd&&e!=Ig.DocumentBegin||(this.beginOrStartDocumentReach=!0),e===Ig.Found&&this.shouldSkipSearchInterval(this.subDocument.id,this.lastFound)?this.findNext():e}shouldSkipSearchInterval(e,t){return!!(0,S.isDefined)(this.modelManager.richOptions.search.filterInterval)&&!this.modelManager.richOptions.search.filterInterval(e,t)}findNextDown(){switch(this.state){case Ig.Start:case Ig.Found:const e=this.currentPos>=this.findWithPosition;this.findNextDownInternal(this.currentPos,e?this.subDocument.getDocumentEndPosition():this.findWithPosition)?this.state=Ig.Found:e&&0!=this.findWithPosition?this.state=Ig.DocumentEnd:this.state=Ig.SearchEnd;break;case Ig.DocumentEnd:0==this.findWithPosition?this.state=Ig.SearchEnd:this.findNextDownInternal(0,this.findWithPosition)?this.state=Ig.Found:this.state=Ig.SearchEnd}return this.state}findNextUp(){switch(this.state){case Ig.Start:case Ig.Found:const e=this.currentPos<=this.findWithPosition;if(this.beginOrStartDocumentReach&&e)return this.lastFound=null,this.state=Ig.SearchEnd,this.state;this.findNextUpInternal(e?0:this.findWithPosition,this.currentPos)?this.state=Ig.Found:e&&this.findWithPosition!=this.subDocument.getDocumentEndPosition()-1?this.state=Ig.DocumentBegin:this.state=Ig.SearchEnd;break;case Ig.DocumentBegin:const t=this.subDocument.getDocumentEndPosition();this.findWithPosition==t-1?this.state=Ig.SearchEnd:this.findNextUpInternal(this.findWithPosition,t-1)?this.state=Ig.Found:this.state=Ig.SearchEnd}return this.state}findNextAll(){for(;this.findNextDown()==Ig.DocumentEnd;);return this.state}findNextDownInternal(e,t){const r=new sm(this.modelManager,this.layoutFormatterManager,this.pageIndex,this.subDocument,e,t);if(this.wholeWordsOnly)return this.findNextDownWholeWordsOnly(r,e,t);let i=0,n=-1;for(;r.nextChar();){for(this.matchCase||(r.char=r.char.toUpperCase());i>0&&this.template[i]!=r.char;)i=this.supportFunction[i-1],n++;if(this.template[i]==r.char&&(0==i&&(n=r.getCurrLogPosition()),i++),i==this.templateLength)return this.lastFound=on.FixedInterval.fromPositions(n,r.getCurrLogPosition()+1),this.currentPos=this.lastFound.end,!0}return this.currentPos=t,this.lastFound=null,!1}findNextDownWholeWordsOnly(e,t,r){let i=0;this.layout.pages[0].getPosition()<t&&this.isCharCanBeInWord((this.subDocument.isMain()?new ug(this.layout,this.subDocument,t-1,Hu.Character):new pg(this.layout,this.subDocument,t-1,this.pageIndex,Hu.Character)).create((new cg).setDefault(!1),(new cg).setDefault(!0)))&&(i=-1);let n=-1;for(;e.nextChar();){if(i==this.templateLength){if(e.char.match(an.isAlphanumeric)){i=-1;continue}return this.lastFound=on.FixedInterval.fromPositions(n,e.getCurrLogPosition()+1),this.currentPos=this.lastFound.end,!0}i<0&&!e.char.match(an.isAlphanumeric)||i>=0&&this.template[i]==(this.matchCase?e.char:e.char.toUpperCase())?(i+=1,0==i&&(n=e.getCurrLogPosition())):i=-1}return this.currentPos=r,this.lastFound=null,!1}findNextUpInternal(e,t){if(t<1)return this.currentPos=0,this.lastFound=null,!1;const r=new lm(this.modelManager,this.layoutFormatterManager,this.pageIndex,this.subDocument,e,t);if(this.wholeWordsOnly)return this.findNextUpWholeWordsOnly(r,t);let i=0;const n=this.templateLength-1;let o=-1;for(;r.prevChar();){for(this.matchCase||(r.char=r.char.toUpperCase());i>0&&this.template[n-i]!=r.char;)i=this.supportFunction[i-1];if(this.template[n-i]==r.char&&(0==i&&(o=r.getCurrLogPosition()+1),i++),i==this.templateLength)return this.lastFound=on.FixedInterval.fromPositions(r.getCurrLogPosition(),o),this.currentPos=Math.max(0,this.lastFound.start-1),!0}return this.currentPos=0,this.lastFound=null,!1}findNextUpWholeWordsOnly(e,t){let r=0;let i=-1;t<(this.subDocument.isMain()?this.layout.getLastValidPage():this.layout.pages[this.pageIndex]).getEndPosition()-1&&this.isCharCanBeInWord((this.subDocument.isMain()?new ug(this.layout,this.subDocument,t+1,Hu.Character):new pg(this.layout,this.subDocument,t+1,this.pageIndex,Hu.Character)).create((new cg).setDefault(!0),(new cg).setDefault(!1)))?r=-1:i=e.getCurrLogPosition();const n=this.templateLength-1;for(;e.prevChar();){if(r==this.templateLength){if(e.char.match(an.isAlphanumeric)){r=-1;continue}return this.lastFound=on.FixedInterval.fromPositions(e.getCurrLogPosition(),i+1),this.currentPos=this.lastFound.start,!0}r<0?(r=e.char.match(an.isAlphanumeric)?-1:0,0==r&&(i=e.getCurrLogPosition())):this.template[n-r]==(this.matchCase?e.char:e.char.toUpperCase())&&(r+=1)}return r==this.templateLength?(this.currentPos=0,this.lastFound=new on.FixedInterval(0,i+1),!0):(this.currentPos=0,this.lastFound=null,!1)}isCharCanBeInWord(e){if(!e)return!1;if(e.switchToStartNextBoxInRow(),e.box.getType()!=lc.Text&&e.box.getType()!=lc.Dash)return!1;let t;if(e.charOffset>=e.box.getLength()){if(!e.advanceToNextRow(this.layout))return!1;t=e.row.boxes[0].renderGetContent(null)[0]}else t=e.box.renderGetContent(null)[e.charOffset];return t.match(an.isAlphanumeric).length>0}getLastFound(){return this.lastFound?this.lastFound.clone():null}replaceLastFound(){if(!this.lastFound||null===this.replaceWith||void 0===this.replaceWith)return;const e=this.modelManager,t=this.subDocument.getRunByPosition(this.lastFound.start),r=t.characterStyle,i=t.maskedCharacterProperties;e.history.beginTransaction(),this.storeSelection(new on.FixedInterval(this.lastFound.start,this.replaceWith.length)),e.modelManipulator.range.removeInterval(new gu(this.subDocument,this.lastFound.clone()),!0,!1),this.replaceWith&&e.history.addAndRedo(new nm(e.modelManipulator,new op(new pu(this.subDocument,this.lastFound.start),new pn(i,r),cs.TextRun,this.replaceWith))),e.history.endTransaction();const n=this.replaceWith.length-this.templateLength;this.searchDirection!=Pg.Up&&(this.currentPos+=n),this.findWithPosition>=this.lastFound.end&&(this.findWithPosition+=n),this.lastFound=null}replaceAll(e){if(null===this.replaceWith||void 0===this.replaceWith)return;const t=this.modelManager,r=this.findWithPosition;this.setSearchParams(this.template,this.replaceWith,this.searchDirection,this.matchCase,this.regularExpression,0,this.wholeWordsOnly);const i=t.history,n=this.subDocument.positionManager.registerPosition(e);this.currentPos=0;const o=[];for(;this.findNextAll()==Ig.Found;)this.shouldSkipSearchInterval(this.subDocument.id,this.lastFound)||o.push(this.lastFound);if(o.length){i.beginTransaction();for(let e=o.length-1;e>=0;e--){const r=o[e],i=this.subDocument.getRunByPosition(r.start),n=i.characterStyle,a=i.maskedCharacterProperties;t.modelManipulator.range.removeInterval(new gu(this.subDocument,r.clone()),!0,!1),this.replaceWith.length&&t.history.addAndRedo(new nm(t.modelManipulator,new op(new pu(this.subDocument,r.start),new pn(a,n),cs.TextRun,this.replaceWith)))}this.storeSelection(new on.FixedInterval(Math.min(n.value,this.subDocument.getDocumentEndPosition()-1),0)),i.endTransaction()}return this.subDocument.positionManager.unregisterPosition(n),this.setSearchParams(this.template,this.replaceWith,this.searchDirection,this.matchCase,this.regularExpression,r,this.wholeWordsOnly),o.length}crateSupportFunction(){let e;if(this.searchDirection==Pg.Up){e="";for(let t=this.templateLength-1;t>=0;t--)e+=this.template[t]}else e=this.template;this.supportFunction=[0];for(let t=2;t<this.templateLength;t++)this.supportFunction.push(om.calcOneElemSuppFunc(e,t))}static calcOneElemSuppFunc(e,t){for(let r=1;r<t;r++){const i=t-r;let n=0;for(;n<i&&e[n]==e[n+r];n++);if(n==i)return t-r}return 0}}class am{constructor(e,t,r,i,n,o){for(this.modelManager=e,this.subDocument=i,this.iterator=i.isMain()?new rm(i,t.layout,n,o):new im(i,t.layout,n,o,r);!this.iterator.isInitialized();)t.forceFormatPage(t.layout.validPageCount);this.char=null,this.charIndexInBox=-1}getCurrLogPosition(){return this.iterator.position.getLogPosition(Hu.Box)+this.charIndexInBox}getCharInternal(){switch(this.iterator.position.box.getType()){case lc.Text:case lc.Dash:this.char=this.iterator.position.box.text[this.charIndexInBox];break;case lc.Space:this.char=an.specialCharacters.Space;break;case lc.TabSpace:this.char=an.specialCharacters.TabMark;break;case lc.ParagraphMark:this.char=an.specialCharacters.ParagraphMark;break;default:this.char=String.fromCharCode(0)}}}class sm extends am{getCharInternal(){return!(this.charIndexInBox>=this.iterator.position.box.getLength())&&(super.getCharInternal(),!0)}nextChar(){if(-1==this.charIndexInBox){if(this.iterator.moveNext((new cg).setDefault(!1),(new cg).setDefault(!0)),this.charIndexInBox=this.iterator.position.charOffset,this.iterator.position.getLogPosition(Hu.Box)+this.charIndexInBox<this.iterator.intervalEnd&&this.getCharInternal())return!0}else this.charIndexInBox++;for(this.char=null;null==this.char&&this.iterator.position.getLogPosition(Hu.Box)+this.charIndexInBox<this.iterator.intervalEnd;)if(!this.getCharInternal()){if(!this.iterator.moveNext((new cg).setDefault(!1),(new cg).setDefault(!0)))return!1;this.charIndexInBox=this.iterator.position.charOffset}return!!this.char}}class lm extends am{getCharInternal(){return!(this.charIndexInBox<0)&&(super.getCharInternal(),!0)}prevChar(){if(-1==this.charIndexInBox){if(this.iterator.movePrev((new cg).setDefault(!0),(new cg).setDefault(!1)),this.charIndexInBox=this.iterator.position.charOffset-1,-1==this.charIndexInBox){if(!this.iterator.movePrev((new cg).setDefault(!0),(new cg).setDefault(!1)))return!1;this.charIndexInBox=this.iterator.position.box.getLength()-1}if(this.getCharInternal())return!0;this.charIndexInBox=-1}else this.charIndexInBox--;for(this.char=null;null==this.char&&this.iterator.position.getLogPosition(Hu.Box)+this.charIndexInBox>=this.iterator.intervalStart;)if(!this.getCharInternal()){if(this.iterator.position.charOffset>0&&this.iterator.movePrev((new cg).setDefault(!1),(new cg).setDefault(!0)),!this.iterator.movePrev((new cg).setDefault(!1),(new cg).setDefault(!0)))return!1;this.charIndexInBox=this.iterator.position.box.getLength()-1}return!!this.char}}class dm{constructor(){this._collection={},this._filteredCollection=null}get filteredCollection(){var e;return null!==(e=this._filteredCollection)&&void 0!==e?e:this._filteredCollection=b.j.reducedMap(this._collection,((e,t)=>e.isDeleted?null:e))}get collection(){return this._collection}add(e){this._collection[e.id]=e,this._filteredCollection=null}delete(e){this._collection[e].isDeleted=!0,this._filteredCollection=null}replace(e,t){const r=this._collection[e];r.isDeleted=!0,r.replacedWithSubDocId=t,this._filteredCollection=null}restore(e){this._collection[e].isDeleted=!1,this._filteredCollection=null}clone(e){const t=new dm;for(const r in this._collection)if(Object.prototype.hasOwnProperty.call(this._collection,r)){const i=this._collection[r];t.add(i.clone(e))}return t}}class cm{get subDocuments(){return this.subDocumentsCollection.filteredCollection}get options(){return this.modelOptions.control}get isDocumentProtectionEnabled(){const e=this.documentProtectionProperties;return this.aspxIsDocumentProtectionEnabled||e.enforceProtection&&e.protectionType!=Mo.None}constructor(e,t=1){this.mirrorMargins=!1,this.aspxIsDocumentProtectionEnabled=!1,this.documentEndNotePosition=js.EndOfDocument,this.sections=[],this.headers=[],this.footers=[],this.characterStyles=[],this.paragraphStyles=[],this.numberingListStyles=[],this.tableStyles=[],this.tableCellStyles=[],this.subDocumentsCollection=new dm,this.abstractNumberingListTemplates=[],this.abstractNumberingLists=[],this.numberingLists=[],this.abstractNumberingListsIdProvider=new Xo(this),this.numberingListsIdProvider=new jo(this),this.footNoteSeparators=new Zl(this),this.endNoteSeparators=new Zl(this),this.repositoryBorderItem=new Me,this.compatSettings=[],this.subDocumentsIdCounter=-1,this.loaded=!1,this.documentProtectionProperties=new Go,this.modelOptions=e,this.simpleFormattersManager=new m.$(e.cultureOpts),this.cache=new uo,this.mainSubDocument=this.importSubDocument(ed.create(yo.Main,uu.MAIN_SUBDOCUMENT_ID,-1)),this.stylesManager=new Wh(this),this.subDocumentsIdCounter=t,this.colorProvider=new Oo(this.cache.colorModelInfoCache),this.initRepositoryBorderItem(),this.webSettings=new bu,this.compatibilitySettings=new um,this.docVariables=new pm}setPageColor(e){this.displayBackgroundShape=!0,this.pageBackColor=e}getAllBookmarks(e){const t=[];return b.j.forEach(this.subDocuments,(r=>{e?f.ListUtils.addListOnTail(t,r.bookmarks):f.ListUtils.forEach(r.bookmarks,(e=>{e.isHidden()||t.push(e)}))})),t}getAllImages(){const e=[];return b.j.forEach(this.subDocuments,(t=>{b.j.forEach(t.chunks,(t=>{b.j.forEach(t.textRuns,(t=>{(t instanceof ah||t instanceof lh)&&e.push(t.cacheInfo)}))}))})),e}initRepositoryBorderItem(){this.repositoryBorderItem.color=this.colorProvider.getModelColorFromRgba(y.AUTOMATIC_COLOR),this.repositoryBorderItem.style=de.Single,this.repositoryBorderItem.width=g.u.pixelsToTwipsF(1)}getCharacterStyleByName(e){return this.stylesManager.getCharacterStyleByName(e)}getParagraphStyleByName(e){return this.stylesManager.getParagraphStyleByName(e)}getNumberingListStyleByName(e){return this.stylesManager.getNumberingListStyleByName(e)}getTableStyleByName(e){return this.stylesManager.getTableStyleByName(e)}getTableCellStyleByName(e){return this.stylesManager.getTableCellStyleByName(e)}getDefaultCharacterStyle(){return this.stylesManager.getDefaultCharacterStyle()}getDefaultParagraphStyle(){return this.stylesManager.getDefaultParagraphStyle()}getDefaultTableStyle(){return this.stylesManager.getDefaultTableStyle()}getDefaultTableCellStyle(){return this.stylesManager.getDefaultTableCellStyle()}setDefaultCharacterProperties(e){const t=_o.convertFromJSON(e,this.cache.colorModelInfoCache,this.cache.shadingInfoCache,this.cache.fontInfoCache);t.setAllUse(),this.defaultCharacterProperties=this.cache.maskedCharacterPropertiesCache.getItem(t)}setDefaultParagraphProperties(e){const t=Vo.convertFromJSON(e,this.cache.colorModelInfoCache,this.cache.shadingInfoCache);t.setUseValue(Be.UseAll,!0),this.defaultParagraphProperties=this.cache.maskedParagraphPropertiesCache.getItem(t)}getSectionsByInterval(e){for(var t,r=[],i=e.end,n=C.SearchUtils.normedInterpolationIndexOf(this.sections,(e=>e.startLogPosition.value),e.start);(t=this.sections[n])&&!(t.startLogPosition.value>i);n++)r.push(t);return r}getSectionIndicesByIntervals(e){let t=[];for(var r,i=0;r=e[i];i++){let e=C.SearchUtils.normedInterpolationIndexOf(this.sections,(e=>e.startLogPosition.value),r.start),i=r.end;t.push(e++);for(let r;(r=this.sections[e])&&r.startLogPosition.value<i;e++)t.push(e)}return f.ListUtils.uniqueNumber(t)}getSectionByPosition(e){var t=C.SearchUtils.normedInterpolationIndexOf(this.sections,(e=>e.startLogPosition.value),e);return this.sections[t]}getCurrentLength(){var e=this.mainSubDocument.getLastChunk(),t=e.textRuns[e.textRuns.length-1];return e.startLogPosition.value+t.startOffset+t.getLength()}isLoaded(){if(this.loaded)return!0;const e=this.mainSubDocument.getLastChunk();return this.loaded=!!e&&e.isLast,this.loaded}getActualPageBackgroundColor(){return this.displayBackgroundShape?this.pageBackColor:y.NO_COLOR}getNumberingListIndexById(e){for(var t,r=0;t=this.numberingLists[r];r++)if(t.getId()===e)return r;return-1}getAbstractNumberingListIndexById(e){for(var t,r=0;t=this.abstractNumberingLists[r];r++)if(t.getId()===e)return r;return-1}getRangeListCounters(e){return new Wo(e.getAbstractNumberingList()).calculateCounters(e)}resetMergedFormattingCache(e){this.mainSubDocument.resetMergedFormattingCache(e)}getPreviousSection(e){var t=C.SearchUtils.normedInterpolationIndexOf(this.sections,(e=>e.startLogPosition.value),e.startLogPosition.value);return this.sections[t-1]}getNextSection(e){var t=C.SearchUtils.normedInterpolationIndexOf(this.sections,(e=>e.startLogPosition.value),e.startLogPosition.value);return this.sections[t+1]}importSubDocument(e){return this.createSubDocumentInternal(e,!0)}updateHyperlinkFields(e,t,r){const i=[t,...r.map((e=>new gu(e,e.interval)))];b.j.forEach(i,(t=>{for(let r of t.subDocument.fields)if(t.interval.containsInterval(r.getAllFieldInterval())){const i=Jg.getParser(e.modelManager,e.layoutFormatterManager,e.createFieldRequestManager(),t.subDocument,r);i instanceof Hp&&!r.getHyperlinkInfo()&&i.parseCodeCurrentFieldInternal(null)}}))}createSubDocument(e,t,r=!1){const i=this.subDocumentsIdCounter++,n=ed.create(e,i,t);if(n.getType()!==e)throw new Error("SubDocument.type doesn't equal to info.type");return this.createSubDocumentInternal(n,r)}createSubDocumentInternal(e,t){if(this.subDocuments[e.subDocumentId])throw new Error("SubDocument with this ID already exists");const r=new uu(this,e);return t||this.initNewSubDocument(r),this.subDocumentsCollection.add(r),r}initNewSubDocument(e){e.chunks=[new mo(e.positionManager.registerPosition(0),"",!0)],e.paragraphs.push(new ns(e,e.positionManager.registerPosition(0),1,this.getDefaultParagraphStyle(),Lt.createDefault(this))),e.chunks[0].textRuns.push(new Bl(0,e.paragraphs[0],new pn(Pe.createDefault(this),this.getDefaultCharacterStyle()))),e.chunks[0].textBuffer=an.specialCharacters.ParagraphMark}checkPasswordHash(e,t){return null==t||t.length<=0||Ml.compareByteArrays(e,t)}checkLegacyDocumentProtectionPassword(e,t){const r=e.calculateLegacyPasswordHash(t);return this.checkPasswordHash(r,this.documentProtectionProperties.word2003PasswordHash)}checkOpenXmlDocumentProtectionPassword(e,t){const r=e.calculatePasswordHash(t,this.documentProtectionProperties.passwordPrefix,this.documentProtectionProperties.hashIterationCount,this.documentProtectionProperties.hashAlgorithmType);return this.checkPasswordHash(r,this.documentProtectionProperties.passwordHash)}checkDocumentProtectionPassword(e){const t=new Ml;if(this.documentProtectionProperties.passwordPrefix&&this.documentProtectionProperties.passwordHash)return this.checkOpenXmlDocumentProtectionPassword(t,e);this.checkLegacyDocumentProtectionPassword(t,e)}findAll(e){const t=[],r=new om(e.modelManager,e.formatterManager,e.pageIndex,e.subDocument,e.layout,e.storeSelection);for(r.setSearchParams(e.text,null,Pg.All,e.matchCase,!1,0,!1);r.findNext()!==Ig.SearchEnd;){const e=r.getLastFound();t.push(e)}return t}clone(){const e=new cm(this.modelOptions,this.subDocumentsIdCounter);return e.modelOptions=this.modelOptions.clone(),e.defaultTabWidth=this.defaultTabWidth,e.differentOddAndEvenPages=this.differentOddAndEvenPages,e.displayBackgroundShape=this.displayBackgroundShape,e.pageBackColor=this.pageBackColor,e.aspxIsDocumentProtectionEnabled=this.aspxIsDocumentProtectionEnabled,e.webSettings=this.webSettings.clone(),e.compatSettings=f.ListUtils.deepCopy(this.compatSettings),e.compatibilitySettings=this.compatibilitySettings.clone(),e.cache=this.cache.clone(),e.defaultCharacterProperties=this.defaultCharacterProperties.clone(),e.defaultParagraphProperties=this.defaultParagraphProperties.clone(),e.defaultTableProperties=this.defaultTableProperties.clone(),e.defaultTableRowProperties=this.defaultTableRowProperties.clone(),e.defaultTableCellProperties=this.defaultTableCellProperties.clone(),e.stylesManager=this.stylesManager.clone(e),e.characterStyles=f.ListUtils.deepCopy(this.characterStyles),e.paragraphStyles=f.ListUtils.deepCopy(this.paragraphStyles),e.numberingListStyles=f.ListUtils.deepCopy(this.numberingListStyles),e.tableStyles=f.ListUtils.deepCopy(this.tableStyles),e.tableCellStyles=f.ListUtils.deepCopy(this.tableCellStyles),e.headers=f.ListUtils.deepCopy(this.headers),e.footers=f.ListUtils.deepCopy(this.footers),e.sections=f.ListUtils.map(this.sections,(t=>t.cloneToNewModel(e))),e.abstractNumberingListTemplates=f.ListUtils.map(this.abstractNumberingListTemplates,(t=>t.clone(e))),e.abstractNumberingLists=f.ListUtils.map(this.abstractNumberingLists,(t=>t.clone(e))),e.numberingLists=f.ListUtils.map(this.numberingLists,(t=>t.clone(e))),e.abstractNumberingListsIdProvider=this.abstractNumberingListsIdProvider.clone(e),e.numberingListsIdProvider=this.numberingListsIdProvider.clone(e),e.repositoryBorderItem=this.repositoryBorderItem.clone(),e.colorProvider=this.colorProvider.clone(e.cache.colorModelInfoCache),e.simpleFormattersManager=new m.$(e.modelOptions.cultureOpts),e.documentProtectionProperties=this.documentProtectionProperties.clone(),e.subDocumentsIdCounter=this.subDocumentsIdCounter,e.subDocumentsCollection=this.subDocumentsCollection.clone(e),e.mainSubDocument=e.subDocuments[uu.MAIN_SUBDOCUMENT_ID],e.loaded=this.loaded,e}compare(e,t=null){return new Au(this,e,t).compareAll()}}class hm{constructor(e,t,r,i,n,o,a,s,l){this.modelManager=e,this.formatterManager=t,this.layout=r,this.subDocument=i,this.text=n,this.matchCase=o,this.highlightResults=a,this.pageIndex=s,this.storeSelection=l}}!function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph",e[e.All=2147483647]="All"}(wg||(wg={})),function(e){e[e.Word2003=11]="Word2003",e[e.Word2007=12]="Word2007",e[e.Word2010=14]="Word2010",e[e.Word2013=15]="Word2013"}(yg||(yg={}));class um{constructor(){this.dontJustifyLinesEndingInSoftLineBreak=!1,this.compatibilityMode=yg.Word2013}get allowParagraphSpacingAfterPageBreak(){return this.compatibilityMode<=yg.Word2010}get layoutInTableCell(){return this.compatibilityMode>=yg.Word2013}get matchHorizontalTableIndentsToTextEdge(){return this.compatibilityMode>=yg.Word2013}getActualLayoutInTableCell(e){return!!this.layoutInTableCell||e.layoutTableCell}clone(){const e=new um;return e.dontJustifyLinesEndingInSoftLineBreak=this.dontJustifyLinesEndingInSoftLineBreak,e.compatibilityMode=this.compatibilityMode,e}}class pm{constructor(){this._map={}}get count(){return Object.keys(this._map).length}contains(e){return Object.prototype.hasOwnProperty.call(this._map,e.toLowerCase())}getValue(e){return this._map[e.toLowerCase()]}addValue(e,t){this._map[e.toLowerCase()]=t}foreach(e){for(let t in this._map)e(t,this._map[t])}}class gm{constructor(e,t,r,i){this.parameterName=e,this.parameterType=t,this.typeAssertion=r,this.getResult=i}getStringRepresentation(e){return`${this.parameterName}: ${this.parameterType}${e?"|undefined":""}`}}class mm{static check(e,t,r,i){for(const t of i)if(t.typeAssertion(e))return t.getResult(e);r&&void 0===e||mm.showErrorString(t,r,i)}static showErrorString(e,t,r){const i=f.ListUtils.map(r,(e=>e.getStringRepresentation(t)));let n;switch(e){case 1:n="First";break;case 2:n="Second";break;case 3:n="Third";break;case 4:n="Fourth";break;case 5:n="Fifth";break;case 6:n="Sixth";break;case 7:n="Seventh";break;case 8:n="Eighth";break;case 9:n="Ninth";break;case 10:n="Tenth";break;default:n="One of the last"}throw new Error(`${n} parameter must be one of [${i.join(", ")}]`)}static defaultDescriptor(e){return new gm("","",(()=>!0),e)}static numberDescriptor(e,t,r=Bo.Constants.MIN_SAFE_INTEGER,i=Bo.Constants.MAX_SAFE_INTEGER){return new gm(e,`number on interval [${r}, ${i}]`,(e=>(0,S.isNumber)(e)&&e>=r&&e<i),t)}static booleanDescriptor(e,t){return new gm(e,"boolean",(e=>"boolean"==typeof e),t)}static arrayDescriptor(e,t){return new gm(e,"array",(e=>e instanceof Array),t)}static functionDescriptor(e,t){return new gm(e,"function",(e=>"function"==typeof e),t)}static stringDescriptor(e,t,r){return new gm(e,"string",(e=>"string"==typeof e&&(r||!!e.length)),t)}static stringDescriptorPredefined(e,t,r){return new gm(e,`string of constants(${B.StringMapUtils.toList(B.StringMapUtils.map(t,((e,t)=>`"${t}"`))).join(", ")})`,(e=>"string"==typeof e&&(r||!!e.length)&&void 0!==t[e]),(e=>t[e]))}static regExpDescriptor(e,t){return new gm(e,"RegExp",(e=>"object"==typeof e),t)}static enumDescriptor(e,t,r,i){return new gm(e,i,(e=>void 0!==r[e]),t)}static objectDescriptor(e,t,r){return new gm(e,t,(e=>"object"==typeof e),r)}}class fm{constructor(e,t,r,i,n){this.modelManager=e,this.inputPosition=t,this.newCharProps=r,this.modelManip=this.modelManager.modelManipulator,this.subDoc=i,this.intervals=n}apply(){const e=this.modelManager.history;this.maskedCharProps=this.inputPosition.getMaskedCharacterProperties(),this.charPropsRaw=this.inputPosition.getMergedCharacterPropertiesRaw(),this.charPropsFull=this.inputPosition.getMergedCharacterPropertiesFull(),this.charPropsRaw=this.inputPosition.getMergedCharacterPropertiesRaw(),this.oldCharPropsRaw=this.charPropsRaw.clone();let t=0;return e.beginTransaction(),t|=this.applyProp(ir.allCaps),t|=this.applyProp(ir.size),t|=this.applyProp(ir.bold),t|=this.applyProp(ir.italic),t|=this.applyProp(ir.fontInfo),t|=this.applyProp(ir.script),t|=this.applyProp(ir.strikeoutType),t|=this.applyProp(ir.underlineType),t|=this.applyProp(ir.underlineWordsOnly),t|=this.applyProp(ir.strikeoutWordsOnly),t|=this.applyProp(ir.noProof),t|=this.applyProp(ir.hidden),t|=this.applyProp(ir.textColor),t|=this.applyProp(ir.shadingInfo),t|=this.applyProp(ir.highlightColor),t|=this.applyProp(ir.strikeoutColor),t|=this.applyProp(ir.underlineColor),t|=this.applyProp(ir.langInfo),t|=this.applyProp(ir.smallCaps),e.endTransaction(),!!t}applyProp(e){const t=e.getProp(this.newCharProps),r=e.getProp(this.oldCharPropsRaw);if(void 0!==t&&t!==r){e.setProp(this.maskedCharProps,t),e.setProp(this.charPropsRaw,t),e.setProp(this.charPropsFull,t),this.maskedCharProps.setUseValue(e.maskValue(),!0);for(let r of this.intervals)r.length>0&&this.modelManager.history.addAndRedo(new(e.getHistoryItemConstructor())(this.modelManip,new tp(this.subDoc,[r]),t,!0));return 1}return 0}}class bm{static getObject(e,t,r,i){const n=C.SearchUtils.normedInterpolationIndexOf(e,t,r);for(let o,a=n;(o=e[a])&&t(o)==r;a--)if(o.equals(i))return a;for(let o,a=n+1;(o=e[a])&&t(o)==r;a++)if(o.equals(i))return a;return-1}static getAllRunsByFullSearch(e,t){const r=new jh(e,!1);r.setPosition(0);do{if(t(r))return r}while(r.moveToNextRun());return null}static internalColorToApiColor(e){if(void 0!==e)return e===y.AUTOMATIC_COLOR?"Auto":e===y.NO_COLOR?"NoColor":w.i.colorToHash(e).toUpperCase()}static assertObject(e,t){if("object"!=typeof e)throw new Error(t+" must be object")}static assertBoolean(e,t){if("boolean"!=typeof e)throw new Error(t+" must be boolean or undefined")}static assertArray(e,t){if(!(e instanceof Array))throw new Error(t+" must be array or undefined")}static assertNumber(e,t){if(!(0,S.isNumber)(e))throw new Error(t+" must be number or undefined")}static assertNonNegativeNumber(e,t){if(bm.assertNumber(e,t),e<0)throw new Error(t+" must be non-negative")}static assertNumberByBounds(e,t,r,i){if(bm.assertNumber(e,i),e<t||e>r)throw new Error(`${i} must be between ${t} and ${r}`)}static assertPositiveNumber(e,t){if(bm.assertNumber(e,t),e<=0)throw new Error(t+" must be positive")}static assertFunction(e,t){if("function"!=typeof e)throw new Error(t+" must be function")}static assertString(e,t,r){if("string"!=typeof e)throw new Error(r+" must be string or undefined");if(t&&!e)throw new Error(r+" must be non-empty or undefined")}static assertAndConvertColor(e,t,r){const i=`${r} must be string${t?" or null":""}`;if(void 0===e)throw new Error(i);if(null===e||""===e){if(t)return null;throw new Error(i)}if("string"!=typeof e)throw new Error(i);if(w.i.colorNames[e])e=w.i.colorNames[e];else if(4!==e.length&&7!==e.length&&"#"!=e.charAt(0))throw new Error(r+" must be hash code or a known color");if("auto"===e.toLocaleLowerCase())return null;const n=w.i.fromString(e);if(null===n)throw new Error(`${r} is unknown color (${e})`);return n}static assertFile(e,t){if(!("string"==typeof e&&e.length>0))throw new Error(t+" must be non-empty string or File")}static assertEnum(e,t,r,i){if(void 0===t[e])throw new Error(i+" must be "+r)}static isNullOrEmptyString(e){return null===e||""===e}}function Cm(e,t=Bo.Constants.MIN_SAFE_INTEGER,r=Bo.Constants.MAX_SAFE_INTEGER){const i=P.MathUtils.restrictValue(e.start+e.length,t,r),n=P.MathUtils.restrictValue(e.start,t,r);return on.FixedInterval.fromPositions(n,Math.max(n,i))}class Sm{static isInterval(e){return"object"==typeof e&&"number"==typeof e.start&&"number"==typeof e.length}static intervalDescriptor(e,t,r=Bo.Constants.MIN_SAFE_INTEGER,i=Bo.Constants.MAX_SAFE_INTEGER){return new gm(e,`ASPx.Interval on interval [${r}, ${i})`,(e=>Sm.isInterval(e)&&e.start>=r&&e.start+e.length<=i),t)}static intervalsDescriptor(e,t,r=Bo.Constants.MIN_SAFE_INTEGER,i=Bo.Constants.MAX_SAFE_INTEGER){return new gm(e,`ASPx.Interval[] on interval [${r}, ${i})`,(e=>Array.isArray(e)&&f.ListUtils.allOf(e,(e=>Sm.isInterval(e)&&e.start>=r&&e.start+e.length<=i))),t)}static colorDescriptors(e){return[new gm(e,'"Auto"',(e=>"string"==typeof e&&"auto"==e.toLowerCase()),(e=>y.AUTOMATIC_COLOR)),new gm(e,'"NoColor"',(e=>"string"==typeof e&&"nocolor"==e.toLowerCase()),(e=>y.NO_COLOR)),new gm(e,"KnownColorName(darkblue, darkcyan, etc)",(e=>"string"==typeof e&&w.i.isKnownColorName(e)),(e=>w.i.fromString(w.i.colorNames[e.toLowerCase()]))),new gm(e,"#354843|rgb(255,0,0)",(e=>{if("string"!=typeof e)return!1;const t=w.i.fromString(e.toLowerCase());return null!==t&&null!=t}),(e=>w.i.fromString(e.toLowerCase())))]}static subDocumentById(e,t,r,i,n,o){const a=[mm.numberDescriptor("subDocumentId",(e=>i.subDocuments[e]))],s=mm.check(e,t,r,a);return s||(void 0===e?n:(o&&mm.showErrorString(t,r,a),null))}}!function(e){e[e.Normal=0]="Normal",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(xg||(xg={}));class Im{}function Pm(e,t){const r=new Im;return r.allCaps=e.allCaps,r.smallCaps=e.smallCaps,r.foreColor=void 0===e.textColor?void 0:bm.internalColorToApiColor(e.textColor.toRgb(t)),r.fontName=e.fontInfo?e.fontInfo.name:void 0,r.size=e.fontSize,r.strikeout=void 0===e.fontStrikeoutType?void 0:e.fontStrikeoutType!==se.None,r.bold=e.fontBold,r.italic=e.fontItalic,r.underline=void 0===e.fontUnderlineType?void 0:e.fontUnderlineType!==le.None,r.underlineColor=void 0===e.underlineColor?void 0:bm.internalColorToApiColor(e.underlineColor.toRgb(t)),r.hidden=e.hidden,r.script=e.script,r.underlineWordsOnly=e.underlineWordsOnly,r.backColor=void 0===e.shadingInfo?void 0:bm.internalColorToApiColor(e.shadingInfo.getActualColor(t)),r.highlightColor=void 0!==e.highlightColor?bm.internalColorToApiColor(e.highlightColor.toRgb(t)):void 0,r}function wm(e,t,r,i,n){var o,a,s,l,d,c,h,u,p;e=mm.check(e,r,!1,[mm.objectDescriptor("properties","CharacterProperties",(e=>e))]),n||(n=new Ie),n.allCaps=null!==(o=mm.check(e.allCaps,r,!0,[mm.booleanDescriptor("properties.allCaps",(e=>e))]))&&void 0!==o?o:n.allCaps,n.smallCaps=null!==(a=mm.check(e.smallCaps,r,!0,[mm.booleanDescriptor("properties.smallCaps",(e=>e))]))&&void 0!==a?a:n.smallCaps,n.fontBold=null!==(s=mm.check(e.bold,r,!0,[mm.booleanDescriptor("properties.bold",(e=>e))]))&&void 0!==s?s:n.fontBold;const g=mm.check(e.foreColor,r,!0,Sm.colorDescriptors("properties.foreColor"));n.textColor=void 0===g?n.textColor:he.makeByColor(g),n.fontItalic=null!==(l=mm.check(e.italic,r,!0,[mm.booleanDescriptor("properties.italic",(e=>e))]))&&void 0!==l?l:n.fontItalic,n.fontInfo=null!==(d=mm.check(e.fontName,r,!0,[mm.stringDescriptor("properties.fontName",(e=>{const r=t.getItemByName(e);if(!r)throw Error("Unknown font name");return r}),!1)]))&&void 0!==d?d:n.fontInfo,n.fontSize=null!==(c=mm.check(e.size,r,!0,[mm.numberDescriptor("properties.size",(e=>e),0,601)]))&&void 0!==c?c:n.fontSize,n.hidden=null!==(h=mm.check(e.hidden,r,!0,[mm.booleanDescriptor("properties.hidden",(e=>e))]))&&void 0!==h?h:n.hidden;const m=mm.check(e.backColor,r,!0,Sm.colorDescriptors("properties.backColor"));n.shadingInfo=void 0===m?n.shadingInfo:fe.createByColor(he.makeByColor(m)),n.script=null!==(u=mm.check(e.script,r,!0,[mm.enumDescriptor("properties.script",(e=>e),xg,"CharacterPropertiesScript")]))&&void 0!==u?u:n.script;const f=mm.check(e.underlineColor,r,!0,Sm.colorDescriptors("properties.underlineColor"));n.underlineColor=void 0===f?n.underlineColor:he.makeByColor(f),n.underlineWordsOnly=null!==(p=mm.check(e.underlineWordsOnly,r,!0,[mm.booleanDescriptor("properties.underlineWordsOnly",(e=>e))]))&&void 0!==p?p:n.underlineWordsOnly;const b=mm.check(e.strikeout,r,!0,[mm.booleanDescriptor("properties.strikeout",(e=>e))]);n.fontStrikeoutType=!0===b?se.Single:!1===b?se.None:n.fontStrikeoutType;const C=mm.check(e.underline,r,!0,[mm.booleanDescriptor("properties.underline",(e=>e))]);n.fontUnderlineType=!0===C?le.Single:!1===C?le.None:n.fontUnderlineType;const S=mm.check(e.highlightColor,r,!0,Sm.colorDescriptors("properties.highlightColor"));return n.highlightColor=void 0===S?n.highlightColor:he.makeByColor(S),i&&(n.langInfo=void 0,n.strikeoutColor=void 0,n.noProof=void 0,n.compositeFontInfo=void 0),n}function ym(e,t,r){return Pm((new ju).setIntervals(tp.fromInterval(t,r)).getMergedCharacterPropertiesRaw(),e.modelManager.model.colorProvider)}function xm(e,t,r,i){const n=wm(i,e.modelManager.model.cache.fontInfoCache,2,!0,{}),o=(new ju).setIntervals(new tp(t,[r]));e.beginUpdate(),new fm(e.modelManager,o,n,t,[r]).apply(),e.endUpdate()}class Tm{constructor(e,t){this.subDocumentId=e,this.fieldInterval=t,this.type=pd.FieldsShowCodeChanged}}class vm{constructor(e,t,r,i){this.subDocumentId=e,this.fieldResultInterval=t,this.fieldCodeInterval=r,this.newHyperlinkInfo=i,this.type=pd.HyperlinkInfoChanged}}class Mm{constructor(e,t,r){this.width=e,this.colSpan=t,this.type=r}substract(e){const t=this.colSpan-e.colSpan;if(this.type==e.type)return new Mm(Math.max(0,this.width-e.width),t,this.type);switch(this.type){case Je.FiftiethsOfPercent:return new Mm(e.width,t,e.type);case Je.ModelUnits:return new Mm(this.width,t,this.type);default:const r=this.type==Je.Auto||e.type==Je.Auto?Je.Auto:Je.Nil;return new Mm(0,t,r)}}}class Em{constructor(e){this.columnsInfo=e,this.intervalIndex=0,this.interval=e[0]}endOfIntervals(){return!this.interval}moveNext(){this.intervalIndex++,this.interval=this.columnsInfo[this.intervalIndex]}advance(e){this.interval.colSpan==e.colSpan?this.moveNext():this.interval=this.interval.substract(e)}}class Dm{static getIntervals(e){const t=e.rows;let r=Dm.columnsInfo(t[0]);for(let e,i=1;e=t[i];i++){const t=Dm.columnsInfo(e);r=Dm.mergeRowColumnIntervals(r,t)}return r}static columnsInfo(e){const t=[];e.gridBefore>0&&t.push(new Mm(e.widthBefore.value,e.gridBefore,e.widthBefore.type));for(let r of e.cells){const e=r.preferredWidth;t.push(new Mm(e.value,r.columnSpan,e.type))}return e.gridAfter>0&&t.push(new Mm(e.widthAfter.value,e.gridAfter,e.widthAfter.type)),t}static mergeRowColumnIntervals(e,t){const r=[],i=new Em(e),n=new Em(t);for(;!i.endOfIntervals()&&!n.endOfIntervals();){const e=i.interval.colSpan,t=n.interval.colSpan;if(e>t)Dm.processDependedIntervals(i,n,r);else if(t>e)Dm.processDependedIntervals(n,i,r);else{const e=Dm.mergeIntervalsDifferentRows(i.interval,n.interval);r.push(e),i.advance(e),n.advance(e)}}return Dm.copyRestIntervals(i,r),Dm.copyRestIntervals(n,r),r}static mergeIntervalsDifferentRows(e,t){const r=e.colSpan;return e.type==t.type?new Mm(Math.max(e.width,t.width),r,e.type):e.type==Je.FiftiethsOfPercent?Dm.mergeIntervalsDifferentRowsDifferentTypes(e,t,r):t.type==Je.FiftiethsOfPercent?Dm.mergeIntervalsDifferentRowsDifferentTypes(t,e,r):e.type==Je.ModelUnits?new Mm(e.width,r,Je.ModelUnits):new Mm(t.width,r,Je.ModelUnits)}static mergeIntervalsDifferentRowsDifferentTypes(e,t,r){return t.width>0?new Mm(t.width,r,t.type):new Mm(e.width,r,e.type)}static copyRestIntervals(e,t){for(;!e.endOfIntervals();)t.push(e.interval),e.advance(e.interval)}static processDependedIntervals(e,t,r){const i=[];let n=0,o=e.interval;do{const e=t.interval;e.type!=Je.Auto&&e.type!=Je.Nil||n++,i.push(e),t.advance(e),o=o.substract(e)}while(o.colSpan>0&&!t.endOfIntervals()&&t.interval.colSpan<=o.colSpan);const a=o.type==Je.ModelUnits&&n>0,s=a?o.width/n:0;for(let t of i)!a||t.type!=Je.Auto&&t.type!=Je.Nil||(t.type=Je.ModelUnits,t.width=s),r.push(e.interval.colSpan>1?t:Dm.mergeIntervalsDifferentRows(e.interval,t)),e.advance(t)}}class Fm{constructor(e,t,r){this.subDocumentId=e,this.table=t,this.newStyle=r,this.type=pd.TableStyleChanged}}class Rm{constructor(e,t,r,i){this.subDocumentId=e,this.table=t,this.rowIndex=r,this.cellIndex=i,this.type=pd.TableCellInserted}}class Lm{constructor(e,t,r,i,n){this.subDocumentId=e,this.table=t,this.rowIndex=r,this.cellIndex=i,this.rightDirection=n,this.type=pd.TableCellMergedHorizontally}}class Bm{constructor(e,t,r,i){this.subDocumentId=e,this.table=t,this.rowIndex=r,this.cellIndex=i,this.type=pd.TableCellRemoved}}class Am{constructor(e,t,r,i,n){this.subDocumentId=e,this.table=t,this.rowIndex=r,this.cellIndex=i,this.rightDirection=n,this.type=pd.TableCellSplittedHorizontally}}class Nm{constructor(e,t){this.subDocumentId=e,this.table=t,this.type=pd.TableCreated}}class km{constructor(e,t,r,i,n){this.subDocumentId=e,this.startPosition=t,this.endPosition=r,this.nestedLevel=i,this.removedText=n,this.type=pd.TableRemoved}}class Om{constructor(e,t,r){this.subDocumentId=e,this.table=t,this.rowIndex=r,this.type=pd.TableRowInserted}}class _m{constructor(e,t,r){this.subDocumentId=e,this.table=t,this.rowIndex=r,this.type=pd.TableRowRemoved}}class Um{constructor(e,t,r,i){this.subDocumentId=e,this.table=t,this.oldPosition=r,this.newPosition=i,this.type=pd.TableStartPositionShifted}}class Hm extends tt{constructor(e,t,r){super(e,t),this.setPropertiesSecondParagraph=r}redo(){this.result=this.modelManipulator.range.removeIntervalInner(this.boundSubDocument,this.interval,this.setPropertiesSecondParagraph)}undo(){this.modelManipulator.range.restoreRemovedInterval(this.boundSubDocument,this.result)}}class Vm extends Bd{constructor(e,t,r,i,n){super(e,t,r),this.rowIndex=i,this.cellIndex=n,this.cell=this.getTable().rows[i].cells[n],this.length=this.cell.interval.length}redo(){this.modelManipulator.table.removeCell(this.boundSubDocument,this.getTable(),this.rowIndex,this.cellIndex)}undo(){this.modelManipulator.table.insertCell(this.boundSubDocument,this.getTable(),this.rowIndex,this.cellIndex,this.cell,this.length)}}class Wm extends Bd{redo(){this.table=this.getTable(),this.cellsRanges=Bd.getTableCellsRanges(this.table),this.modelManipulator.table.removeTable(this.boundSubDocument,this.table)}undo(){this.modelManipulator.table.restoreRemovedTable(this.boundSubDocument,this.table,this.cellsRanges)}}class zm extends Bd{constructor(e,t,r,i){super(e,t,r),this.rowIndex=i}redo(){const e=this.getTable();this.oldRow=e.rows[this.rowIndex],this.cellIntervals=Bd.getRowCellsRanges(this.oldRow),this.modelManipulator.table.removeRow(this.boundSubDocument,e.index,this.rowIndex)}undo(){this.modelManipulator.table.insertRow(this.boundSubDocument,this.getTable().index,this.oldRow,this.rowIndex,this.cellIntervals)}}class jm extends Bd{constructor(e,t,r,i){super(e,t,r),this.newValue=i}}class Xm extends jm{constructor(e,t,r,i,n){super(e,t,r,i),this.newUse=n}redo(){this.oldState=this.getManipulator().setValue(this.boundSubDocument,this.tableIndex,this.newValue,this.newUse)}undo(){this.getManipulator().restoreValue(this.boundSubDocument,this.oldState)}getManipulator(){throw new Error(R.D.NotImplemented)}}class Gm extends jm{constructor(e,t,r,i,n){if(super(e,t,r,i),i.length!==n.length)throw new Error("newValues.length should be equal to newUses.length");this.newUses=n}redo(){this.oldState=this.getManipulator().setValue(this.boundSubDocument,this.tableIndex,this.newValue,this.newUses)}undo(){this.getManipulator().restoreValue(this.boundSubDocument,this.oldState)}getManipulator(){throw new Error(R.D.NotImplemented)}}class Km extends Gm{getManipulator(){return this.modelManipulator.table.tableProperties.cellMargins}}class qm extends Xm{getManipulator(){return this.modelManipulator.table.tableProperties.cellSpacing}}class $m extends Xm{getManipulator(){return this.modelManipulator.table.tableProperties.indent}}class Jm extends jm{redo(){this.oldState=this.modelManipulator.table.tableProperties.preferredWidth.setValue(this.boundSubDocument,this.tableIndex,this.newValue)}undo(){this.modelManipulator.table.tableProperties.preferredWidth.restoreValue(this.boundSubDocument,this.oldState)}}class Ym extends Gm{getManipulator(){return this.modelManipulator.table.tableProperties.borders}}class Qm extends Xm{getManipulator(){return this.modelManipulator.table.tableProperties.layoutType}}class Zm extends jm{redo(){this.oldState=this.modelManipulator.table.tableProperties.lookTypes.setValue(this.boundSubDocument,this.tableIndex,this.newValue),this.modelManipulator.table.resetParagraphCharacterMergedProperties(this.boundSubDocument,this.tableIndex)}undo(){this.modelManipulator.table.tableProperties.lookTypes.restoreValue(this.boundSubDocument,this.oldState),this.modelManipulator.table.resetParagraphCharacterMergedProperties(this.boundSubDocument,this.tableIndex)}}class ef extends Xm{getManipulator(){return this.modelManipulator.table.tableProperties.shadingInfo}}class tf extends Xm{getManipulator(){return this.modelManipulator.table.tableProperties.tableRowAlignment}}class rf extends Bd{constructor(e,t,r,i,n,o){super(e,t,r),this.rowIndex=i,this.cellIndex=n,this.copyProperties=o}redo(){this.modelManipulator.table.splitTableCellHorizontally(this.boundSubDocument,this.getTable(),this.rowIndex,this.cellIndex,!1,this.copyProperties)}undo(){this.modelManipulator.table.restoreSplittedCellHorizontally(this.boundSubDocument,this.getTable(),this.rowIndex,this.cellIndex+1,!1)}}class nf extends Bd{constructor(e,t,r,i,n,o){super(e,t,r),this.rowIndex=i,this.cellIndex=n,this.copyProperties=o}redo(){this.modelManipulator.table.splitTableCellHorizontally(this.boundSubDocument,this.getTable(),this.rowIndex,this.cellIndex,!0,this.copyProperties)}undo(){this.modelManipulator.table.restoreSplittedCellHorizontally(this.boundSubDocument,this.getTable(),this.rowIndex,this.cellIndex,!0)}}class of{get modelManipulator(){return this.modelManager.modelManipulator}constructor(e,t){this.subDocument=t,this.modelManager=e}execute(e,t,r,i,n){let o=e.rows[t].cells[r],a=oc.getStartColumnIndex(o),s=Ja.getFirstCellPositionInVerticalMergingGroup(Qa.createAndInit(e,t,r)),l=oc.getVerticalSpanCellPositions(s,a);for(let t,r=l.length-1;t=l[r];r--)n.canNormalizeVerticalMerging&&this.modelManipulator.table.normalizeVerticalMerging(this.subDocument,e,t.rowIndex,t.cellIndex),this.insertTableCellCore(this.subDocument,t,i,n);n.canNormalizeTable&&(this.normalizeTableGridAfter(e),this.modelManipulator.table.normalizeCellColumnSpans(this.subDocument,e,!0))}normalizeTableGridAfter(e){let t=0,r=[];for(let i,n=0;i=e.rows[n];n++){let e=i.cells[i.cells.length-1],n=oc.getEndColumnIndex(e)+i.gridAfter;r.push(n),t=Math.max(t,n)}for(let i,n=0;i=e.rows[n];n++){let o=t-r[n];o>0&&this.modelManager.history.addAndRedo(new Ud(this.modelManager.modelManipulator,this.subDocument,e.index,n,i.gridAfter+o))}}}class af extends of{insertTableCellCore(e,t,r,i){this.modelManipulator.table.insertParagraphToTheCellStartAndShiftContent(e,t.cell,r),this.modelManager.history.addAndRedo(new rf(this.modelManager.modelManipulator,e,t.table.index,t.rowIndex,t.cellIndex,i.canCopyProperties)),t.cell.verticalMerging!==Xe.None&&this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,e,t.table.index,t.rowIndex,t.cellIndex,t.cell.verticalMerging))}}class sf extends of{insertTableCellCore(e,t,r,i){this.modelManager.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(e,t.cell.endParagrapPosition.value-1),r,i.needToSetNextStyle)),this.modelManager.history.addAndRedo(new nf(this.modelManager.modelManipulator,e,t.table.index,t.rowIndex,t.cellIndex,i.canCopyProperties)),t.cell.verticalMerging!==Xe.None&&this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,e,t.table.index,t.rowIndex,t.cellIndex+1,t.cell.verticalMerging))}}class lf extends Ze{constructor(e,t){super(e),this.params=t}redo(){this.modelManipulator.paragraph.insertParagraphInner(this.params)}undo(){this.modelManipulator.range.removeIntervalWithoutHistory(this.params.subDocPos.subDocument,new on.FixedInterval(this.params.subDocPos.position,an.specialCharacters.ParagraphMark.length),!0)}}class df extends Bd{constructor(e,t,r,i,n,o){super(e,t,r),this.targetRowIndex=n,this.cellIntervals=o,this.patternRow=i}redo(){this.modelManipulator.table.insertRow(this.boundSubDocument,this.tableIndex,this.patternRow,this.targetRowIndex,this.cellIntervals)}undo(){this.modelManipulator.table.removeRow(this.boundSubDocument,this.tableIndex,this.targetRowIndex)}}class cf{get modelManipulator(){return this.modelManager.modelManipulator}constructor(e,t){this.modelManager=e,this.subDocument=t}execute(e,t){let r=e.rows[t],i=this.getInsertParagraphsPositionInfo(e,t);this.insertParagraphs(this.subDocument,i,r),t=this.insertRowsCore(e,t),this.correctVerticalMerging(this.subDocument,e,t)}insertParagraphs(e,t,r){const i=r.cells,n={};for(let t,r=i.length-1;t=i[r];r--){const i=t.startParagraphPosition.value,o=e.getRunByPosition(i),a=e.getParagraphByPosition(i);n[r]={charBundle:o.getCharPropsBundle(e.documentModel),paragraphBundle:a.getParagraphBundleFull(e.documentModel)}}let o=!!t.cell;for(let r=i.length-1;r>=0;r--){const i=n[r];this.modelManager.history.addAndRedo(new lf(this.modelManager.modelManipulator,new Ag(new pu(e,t.position),i.charBundle,i.paragraphBundle))),o&&(this.modelManipulator.table.shiftContent(this.subDocument,t.cell),o=!1)}}}class hf extends cf{insertRowsCore(e,t){for(var r=[],i=e.rows[t],n=i.getStartPosition(),o=i.cells.length,a=0;a<o;a++)r.push(new on.FixedInterval(n+a,1));return this.modelManager.history.addAndRedo(new df(this.modelManager.modelManipulator,this.subDocument,e.index,e.rows[t],t,r)),t+1}getInsertParagraphsPositionInfo(e,t){return{cell:e.rows[t].cells[0],position:e.rows[t].getStartPosition()}}correctVerticalMerging(e,t,r){let i=t.rows[r];for(let n,o=0;n=i.cells[o];o++)n.verticalMerging===Xe.Restart&&this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,e,t.index,r-1,o,Xe.None))}}class uf extends cf{insertRowsCore(e,t){for(var r=[],i=e.rows[t],n=i.getEndPosition(),o=i.cells.length,a=0;a<o;a++)r.push(new on.FixedInterval(n+a,1));return this.modelManager.history.addAndRedo(new df(this.modelManager.modelManipulator,this.subDocument,e.index,e.rows[t],t+1,r)),t}getInsertParagraphsPositionInfo(e,t){return{cell:e.rows[t+1]?e.rows[t+1].cells[0]:null,position:e.rows[t].getEndPosition()}}correctVerticalMerging(e,t,r){let i=t.rows[r],n=r+1,o=t.rows[n+1];for(let r,a=0;r=i.cells[a];a++)if(r.verticalMerging===Xe.Continue)if(o){let i=oc.getStartColumnIndex(r),s=oc.getAbsoluteCellIndexInRow(o,i);o.cells[s].verticalMerging!==Xe.Continue&&this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,e,t.index,n,a,Xe.None))}else this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,e,t.index,n,a,Xe.None));else r.verticalMerging===Xe.Restart&&this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,e,t.index,n,a,Xe.Continue))}}class pf{get modelManipulator(){return this.modelManager.modelManipulator}constructor(e,t){this.needDeleteNextTableCell=!1,this.modelManager=e,this.subDocument=t}execute(e,t,r){let i=this.calculateNextCell(e);this.updateCellsProperties(e,i);let n=i.cell,o=e.cell,a=this.isEmptyCell(o);if(!this.isEmptyCell(n)){let e=o.endParagrapPosition.value-1,t=this.subDocument.paragraphs[this.getCellLastParagraphIndex(n)];a||(this.modelManager.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(this.subDocument,e),r)),e++),this.applyParagraphProperties(this.getCellLastParagraphIndex(o),t),this.modelManager.modelManipulator.range.copyIntervalTo(this.subDocument,on.FixedInterval.fromPositions(n.startParagraphPosition.value,n.endParagrapPosition.value-1),e)}this.deleteTableCellWithContent(i),this.modelManipulator.table.normalizeCellColumnSpans(this.subDocument,e.table,!0),t||this.modelManipulator.table.normalizeRows(this.subDocument,o.parentRow.parentTable)}getCellLastParagraphIndex(e){return this.subDocument.getParagraphIndexByPosition(e.endParagrapPosition.value-1)}applyParagraphProperties(e,t){let r=this.subDocument.paragraphs[e];r.maskedParagraphProperties.equals(t.maskedParagraphProperties)&&r.numberingListIndex===t.numberingListIndex&&r.listLevelIndex===t.listLevelIndex&&!r.tabs.equals(t.tabs)&&r.paragraphStyle===t.paragraphStyle||this.modelManager.history.addAndRedo(new Dt(this.modelManager.modelManipulator,this.subDocument,e,t.maskedParagraphProperties,t.paragraphStyle,t.numberingListIndex,t.listLevelIndex,t.tabs))}deleteTableCellWithContent(e){if(this.needDeleteNextTableCell)this.modelManipulator.table.removeTableCellWithContent(this.subDocument,e.table,e.rowIndex,e.cellIndex);else{let t=e.cell;this.modelManager.modelManipulator.range.removeInterval(new gu(this.subDocument,on.FixedInterval.fromPositions(t.startParagraphPosition.value,t.endParagrapPosition.value-1)),!0,!1)}}isEmptyCell(e){return e.endParagrapPosition.value-e.startParagraphPosition.value==1}}class gf extends pf{constructor(){super(...arguments),this.needDeleteNextTableCell=!0}calculateNextCell(e){let t=e.cellIndex+1;return Qa.createAndInit(e.table,e.rowIndex,t)}updateCellsProperties(e,t){let r=e.cell,i=t.cell;this.modelManager.history.addAndRedo(new $d(this.modelManager.modelManipulator,this.subDocument,e.table.index,e.rowIndex,e.cellIndex,r.columnSpan+i.columnSpan));let n=r.preferredWidth,o=i.preferredWidth;if(n&&o&&o.type===n.type){let t=lr.create(n.value+o.value,n.type);this.modelManager.history.addAndRedo(new tc(this.modelManager.modelManipulator,this.subDocument,e.table.index,e.rowIndex,e.cellIndex,t))}}}class mf extends pf{calculateNextCell(e){let t=e.rowIndex+1,r=e.table.rows[t],i=oc.getStartColumnIndex(e.cell);return Qa.createAndInit(e.table,t,oc.getCellIndexByColumnIndex(r,i))}updateCellsProperties(e,t){this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,this.subDocument,e.table.index,e.rowIndex,e.cellIndex,Xe.Restart)),this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,this.subDocument,t.table.index,t.rowIndex,t.cellIndex,Xe.Continue))}}class ff extends pf{calculateNextCell(e){return Qa.createAndInit(e.table,e.rowIndex-1,e.cellIndex)}updateCellsProperties(e,t){let r=this.modelManager.modelManipulator,i=this.subDocument;this.modelManager.history.addAndRedo(new ec(r,i,e.table.index,e.rowIndex,e.cellIndex,[t.cell.properties.borders.top.clone(),t.cell.properties.borders.right.clone(),t.cell.properties.borders.bottom.clone(),t.cell.properties.borders.left.clone(),t.cell.properties.borders.topLeftDiagonal.clone(),t.cell.properties.borders.topRightDiagonal.clone()],[t.cell.properties.getUseValue(Ye.UseTopBorder),t.cell.properties.getUseValue(Ye.UseRightBorder),t.cell.properties.getUseValue(Ye.UseBottomBorder),t.cell.properties.getUseValue(Ye.UseLeftBorder),t.cell.properties.getUseValue(Ye.UseTopLeftDiagonalBorder),t.cell.properties.getUseValue(Ye.UseTopRightDiagonalBorder)])),this.modelManager.history.addAndRedo(new nc(r,i,e.table.index,e.rowIndex,e.cellIndex,t.cell.properties.shadingInfo,!0)),this.modelManager.history.addAndRedo(new ic(r,i,e.table.index,e.rowIndex,e.cellIndex,t.cell.properties.verticalAlignment,!0))}deleteTableCellWithContent(e){let t=e.cell;t.endParagrapPosition.value-t.startParagraphPosition.value>1&&this.modelManager.modelManipulator.range.removeInterval(new gu(this.subDocument,on.FixedInterval.fromPositions(t.startParagraphPosition.value,t.endParagrapPosition.value-1)),!0,!1)}}class bf extends mf{execute(e,t,r){e.rowIndex===e.table.rows.length-1?this.deleteContentFromCell(e.cell):(this.deleteContentFromCell(e.cell),super.execute(e,t,r))}updateCellsProperties(e,t){if(e.cell.verticalMerging===Xe.Restart)if(this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,this.subDocument,e.table.index,e.rowIndex,e.cellIndex,Xe.None)),t.rowIndex===t.table.rows.length-1)this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,this.subDocument,t.table.index,t.rowIndex,t.cellIndex,Xe.None));else{let e=this.calculateNextCell(t);e.cell&&e.cell.verticalMerging===Xe.Continue?this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,this.subDocument,t.table.index,t.rowIndex,t.cellIndex,Xe.Restart)):this.modelManager.history.addAndRedo(new Jd(this.modelManager.modelManipulator,this.subDocument,t.table.index,t.rowIndex,t.cellIndex,Xe.None))}}deleteContentFromCell(e){let t=e.interval;--t.length>0&&this.modelManager.modelManipulator.range.removeInterval(new gu(this.subDocument,t),!0,!1)}}class Cf{get subDocumentId(){return this.subDocument.id}constructor(e,t,r){this.subDocument=e,this.property=t,this.newState=r,this.type=pd.TableCellPropertyChanged}}class Sf{constructor(...e){this.objects=[];for(var t,r=0;t=e[r];r++)this.register(t)}register(e){return this.lastObject&&this.lastObject.canMerge(e)?this.lastObject.merge(e):(this.objects.push(e),this.lastObject=e),this}toJSON(e){for(var t,r=[],i=0;t=this.objects[i];i++)r.push(t.toJSON(e));return r}isEmpty(){return!this.lastObject}}class If extends Sf{get interval(){return this.lastObject?on.FixedInterval.fromPositions(this.objects[0].interval.start,this.lastObject.interval.end):null}}class Pf{constructor(e,t){this.interval=e.clone(),this.value=t}merge(e){this.interval.length+=e.interval.length}canMerge(e){return this.interval.end===e.interval.start&&this.isEqualValue(e)}isEqualValue(e){return this.value===e.value}toJSON(e){return[this.interval.start,this.interval.length,this.getPropertyValueForJSON(this.value,e)]}getPropertyValueForJSON(e,t){return e instanceof En?e.name:e}}class wf extends Pf{constructor(e,t){super(e,t)}isEqualValue(e){return this.value.position==e.value.position}getPropertyValueForJSON(e){return jl.convertToJSON(e)}}class yf extends Pf{constructor(e,t){super(new on.FixedInterval(e,t.length),t)}canMerge(e){return!1}}class xf extends Pf{constructor(e,t){super(e,t)}getPropertyValueForJSON(e){return e.styleName}}class Tf extends Pf{constructor(e,t){super(e,t)}getPropertyValueForJSON(e){return _o.convertToJSON(e)}}class vf extends Pf{constructor(e,t,r){super(e,t),this.use=r}canMerge(e){return super.canMerge(e)&&this.use===e.use}toJSON(){return super.toJSON().concat([this.use?1:0])}}class Mf{constructor(e,t){this.value=t,this.sectionIndex=e}toJSON(){return[this.sectionIndex,this.getPropertyValueForJSON(this.value)]}getPropertyValueForJSON(e){return e instanceof Array?xh.convertToJSON(e):e}canMerge(e){return!1}merge(e){}}class Ef{constructor(e,t,r,i){this.isAbstractNumberingList=e,this.numberingListIndex=t,this.listLevelIndex=r,this.value=i}toJSON(){return[this.isAbstractNumberingList?1:0,this.numberingListIndex,this.listLevelIndex,this.getPropertyValueForJSON(this.value)]}canMerge(e){return!1}merge(e){throw new Error(R.D.NotImplemented)}getPropertyValueForJSON(e){return e instanceof En?e.name:e}}class Df extends Ef{constructor(e,t,r,i,n){super(e,t,r,i),this.use=n}toJSON(){return super.toJSON().concat([this.use?1:0])}}class Ff{constructor(e,t,r,i){this.tableIndex=r,this.value=i,this.tableStartPosition=e,this.tableNestedLevel=t}toJSON(){return[this.tableStartPosition,this.tableNestedLevel,this.getPropertyValueForJSON(this.value)]}canMerge(e){return!1}merge(e){throw new Error(R.D.NotImplemented)}getPropertyValueForJSON(e){return e instanceof lr||e instanceof dr?[e.type,e.value]:e instanceof Me?[e.color.toJSON(),e.frame,e.offset,e.shadow,e.style,e.width]:e}}class Rf extends Ff{constructor(e,t,r,i,n){super(e,t,r,i),this.use=n}toJSON(){return super.toJSON().concat([this.use?1:0])}}class Lf extends Ff{constructor(e,t,r,i,n){super(e,t,r,i),this.uses=n}toJSON(){let e=[],t=this.uses.length;for(let r=0;r<t;r++)e.push(this.uses[r]?1:0);return super.toJSON().concat([e])}getPropertyValueForJSON(e){let t=[],r=e.length;for(let i=0;i<r;i++)t.push(super.getPropertyValueForJSON(e[i]));return t}}class Bf{constructor(e,t,r,i,n,o){this.tableIndex=r,this.rowIndex=i,this.cellIndex=n,this.value=o,this.tableStartPosition=e,this.tableNestedLevel=t}toJSON(){return[this.tableStartPosition,this.tableNestedLevel,this.rowIndex,this.cellIndex,this.getPropertyValueForJSON(this.value)]}canMerge(e){return!1}merge(e){throw new Error(R.D.NotImplemented)}getPropertyValueForJSON(e){return e instanceof lr||e instanceof dr?[e.type,e.value]:e instanceof Me?[e.color.toJSON(),e.frame,e.offset,e.shadow,e.style,e.width]:e}}class Af extends Bf{constructor(e,t,r,i,n,o,a){super(e,t,r,i,n,o),this.use=a}toJSON(){return super.toJSON().concat([this.use?1:0])}}class Nf extends Bf{constructor(e,t,r,i,n,o,a){super(e,t,r,i,n,o),this.uses=a}toJSON(){let e=[],t=this.uses.length;for(let r=0;r<t;r++)e.push(this.uses[r]?1:0);return super.toJSON().concat([e])}getPropertyValueForJSON(e){let t=[],r=e.length;for(let i=0;i<r;i++)t.push(super.getPropertyValueForJSON(e[i]));return t}}class kf{constructor(e,t,r,i,n){this.tableIndex=r,this.rowIndex=i,this.value=n,this.tableStartPosition=e,this.tableNestedLevel=t}toJSON(){return[this.tableStartPosition,this.tableNestedLevel,this.rowIndex,this.getPropertyValueForJSON(this.value)]}canMerge(e){return!1}merge(e){throw new Error(R.D.NotImplemented)}getPropertyValueForJSON(e){return e instanceof lr||e instanceof dr?[e.type,e.value]:e}}class Of extends kf{constructor(e,t,r,i,n,o){super(e,t,r,i,n),this.use=o}toJSON(){return super.toJSON().concat([this.use?1:0])}}class _f extends Pf{constructor(e,t){super(e,t)}getPropertyValueForJSON(e){return e instanceof Qc?Lh.convertToJSON(e):e instanceof eh?Rh.convertToJSON(e):e}}class Uf extends Pf{constructor(e,t){super(e,t)}getPropertyValueForJSON(e){return hh.convertToJSON(e)}}class Hf extends Pf{constructor(e,t){super(e,t)}getPropertyValueForJSON(e){return gh.convertToJSON(e)}}class Vf extends Pf{getPropertyValueForJSON(e){return e instanceof so.Size?[e.width,e.height]:e}}class Wf{constructor(e){this.cellMargins=new Xf(e,cl.CellMargins,[Ye.UseTopMargin,Ye.UseRightMargin,Ye.UseBottomMargin,Ye.UseLeftMargin],((e,t)=>{e.cellMargins.top=t[0]||e.cellMargins.top,e.cellMargins.right=t[1]||e.cellMargins.right,e.cellMargins.bottom=t[2]||e.cellMargins.bottom,e.cellMargins.left=t[3]||e.cellMargins.left}),(e=>[e.cellMargins.top,e.cellMargins.right,e.cellMargins.bottom,e.cellMargins.left])),this.borders=new Xf(e,cl.Borders,[Ye.UseTopBorder,Ye.UseRightBorder,Ye.UseBottomBorder,Ye.UseLeftBorder,Ye.UseTopLeftDiagonalBorder,Ye.UseTopRightDiagonalBorder],((e,t)=>{e.borders.top=t[0]||e.borders.top,e.borders.right=t[1]||e.borders.right,e.borders.bottom=t[2]||e.borders.bottom,e.borders.left=t[3]||e.borders.left,e.borders.topLeftDiagonal=t[4]||e.borders.topLeftDiagonal,e.borders.topRightDiagonal=t[5]||e.borders.topRightDiagonal}),(e=>[e.borders.top,e.borders.right,e.borders.bottom,e.borders.left,e.borders.topLeftDiagonal,e.borders.topRightDiagonal])),this.preferredWidth=new zf(e,cl.PreferredWidth,((e,t)=>e.preferredWidth=t),(e=>e.preferredWidth)),this.hideCellMark=new Gf(e,cl.HideCellMark,Ye.UseHideCellMark,((e,t)=>e.hideCellMark=t),(e=>e.hideCellMark)),this.noWrap=new Gf(e,cl.NoWrap,Ye.UseNoWrap,((e,t)=>e.noWrap=t),(e=>e.noWrap)),this.fitText=new Gf(e,cl.FitText,Ye.UseFitText,((e,t)=>e.fitText=t),(e=>e.fitText)),this.textDirection=new Gf(e,cl.TextDirection,Ye.UseTextDirection,((e,t)=>e.textDirection=t),(e=>e.textDirection)),this.verticalAlignment=new Gf(e,cl.VerticalAlignment,Ye.UseVerticalAlignment,((e,t)=>e.verticalAlignment=t),(e=>e.verticalAlignment)),this.shadingInfo=new Gf(e,cl.ShadingInfo,Ye.UseShadingInfoIndex,((e,t)=>e.shadingInfo=t),(e=>e.shadingInfo)),this.columnSpan=new jf(e,cl.ColumnSpan,((e,t)=>e.columnSpan=t),(e=>e.columnSpan)),this.verticalMerging=new jf(e,cl.VerticalMerging,((e,t)=>e.verticalMerging=t),(e=>e.verticalMerging))}}class zf{constructor(e,t,r,i){this.manipulator=e,this.jsonTableCellProperty=t,this.setProperty=r,this.getProperty=i}setValue(e,t,r,i,n){let o=e.tables[t],a=o.getStartPosition();var s=new Sf,l=new Sf;let d=o.rows[r].cells[i];return l.register(new Bf(a,o.nestedLevel,t,r,i,this.getProperty(d))),this.setProperty(d,n),s.register(new Bf(a,o.nestedLevel,t,r,i,n)),this.manipulator.notifyModelChanged(new Cf(e,this.jsonTableCellProperty,s)),l}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex].rows[t.lastObject.rowIndex].cells[t.lastObject.cellIndex];this.setProperty(r,t.lastObject.value),this.manipulator.notifyModelChanged(new Cf(e,this.jsonTableCellProperty,t))}}class jf{constructor(e,t,r,i){this.manipulator=e,this.jsonTableCellProperty=t,this.setProperty=r,this.getProperty=i}setValue(e,t,r,i,n){let o=e.tables[t],a=o.getStartPosition();var s=new Sf,l=new Sf;let d=o.rows[r].cells[i];return l.register(new Bf(a,o.nestedLevel,t,r,i,this.getProperty(d))),this.setProperty(d,n),s.register(new Bf(a,o.nestedLevel,t,r,i,n)),this.manipulator.notifyModelChanged(new Cf(e,this.jsonTableCellProperty,s)),l}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex].rows[t.lastObject.rowIndex].cells[t.lastObject.cellIndex];this.setProperty(r,t.lastObject.value),this.manipulator.notifyModelChanged(new Cf(e,this.jsonTableCellProperty,t))}}class Xf{constructor(e,t,r,i,n){this.manipulator=e,this.jsonTableCellProperty=t,this.setProperties=i,this.getProperties=n,this.masks=r}setValue(e,t,r,i,n,o){let a=e.tables[t],s=a.getStartPosition();var l=new Sf,d=new Sf;let c=a.rows[r].cells[i],h=c.properties,u=[];for(let e of this.masks)u.push(h.getUseValue(e));return d.register(new Nf(s,a.nestedLevel,t,r,i,this.getProperties(h),u)),this.setValuesCore(e.documentModel.cache,c,n,o),l.register(new Nf(s,a.nestedLevel,t,r,i,n,o)),this.manipulator.notifyModelChanged(new Cf(e,this.jsonTableCellProperty,l)),d}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex].rows[t.lastObject.rowIndex].cells[t.lastObject.cellIndex];this.setValuesCore(e.documentModel.cache,r,t.lastObject.value,t.lastObject.uses),this.manipulator.notifyModelChanged(new Cf(e,this.jsonTableCellProperty,t))}setValuesCore(e,t,r,i){var n=t.properties.clone();this.setProperties(n,r);for(let e=this.masks.length-1;e>=0;e--)void 0!==i[e]&&n.setUseValue(this.masks[e],i[e]);t.properties=e.tableCellPropertiesCache.getItem(n)}}class Gf{constructor(e,t,r,i,n){this.manipulator=e,this.tableCellPropertiesMask=r,this.jsonTableCellProperty=t,this.setProperty=i,this.getProperty=n}setValue(e,t,r,i,n,o){let a=e.tables[t],s=a.getStartPosition();var l=new Sf,d=new Sf;let c=a.rows[r].cells[i],h=c.properties;return d.register(new Af(s,a.nestedLevel,t,r,i,this.getProperty(h),h.getUseValue(this.tableCellPropertiesMask))),this.setValueCore(e.documentModel.cache,c,n,o),l.register(new Af(s,a.nestedLevel,t,r,i,n,o)),this.manipulator.notifyModelChanged(new Cf(e,this.jsonTableCellProperty,l)),d}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex].rows[t.lastObject.rowIndex].cells[t.lastObject.cellIndex];this.setValueCore(e.documentModel.cache,r,t.lastObject.value,t.lastObject.use),this.manipulator.notifyModelChanged(new Cf(e,this.jsonTableCellProperty,t))}setValueCore(e,t,r,i){var n=t.properties.clone();this.setProperty(n,r),n.setUseValue(this.tableCellPropertiesMask,i),t.properties=e.tableCellPropertiesCache.getItem(n)}}class Kf{get subDocumentId(){return this.subDocument.id}constructor(e,t,r){this.subDocument=e,this.property=t,this.newState=r,this.type=pd.TablePropertyChanged}}class qf{constructor(e){this.cellMargins=new Jf(e,ks.CellMargins,[ur.UseTopMargin,ur.UseRightMargin,ur.UseBottomMargin,ur.UseLeftMargin],((e,t)=>{e.cellMargins.top=t[0]||e.cellMargins.top,e.cellMargins.right=t[1]||e.cellMargins.right,e.cellMargins.bottom=t[2]||e.cellMargins.bottom,e.cellMargins.left=t[3]||e.cellMargins.left}),(e=>[e.cellMargins.top,e.cellMargins.right,e.cellMargins.bottom,e.cellMargins.left])),this.cellSpacing=new Yf(e,ks.CellSpacing,ur.UseCellSpacing,((e,t)=>e.cellSpacing=t),(e=>e.cellSpacing)),this.indent=new Yf(e,ks.Indent,ur.UseTableIndent,((e,t)=>e.indent=t),(e=>e.indent)),this.preferredWidth=new $f(e,ks.PreferredWidth,((e,t)=>e.preferredWidth=t),(e=>e.preferredWidth)),this.lookTypes=new $f(e,ks.TableLookTypes,((e,t)=>e.lookTypes=t),(e=>e.lookTypes)),this.borders=new Jf(e,ks.Borders,[ur.UseTopBorder,ur.UseRightBorder,ur.UseBottomBorder,ur.UseLeftBorder,ur.UseInsideHorizontalBorder,ur.UseInsideVerticalBorder],((e,t)=>{e.borders.top=t[0]||e.borders.top,e.borders.right=t[1]||e.borders.right,e.borders.bottom=t[2]||e.borders.bottom,e.borders.left=t[3]||e.borders.left,e.borders.insideHorizontal=t[4]||e.borders.insideHorizontal,e.borders.insideVertical=t[5]||e.borders.insideVertical}),(e=>[e.borders.top,e.borders.right,e.borders.bottom,e.borders.left,e.borders.insideHorizontal,e.borders.insideVertical])),this.tableStyleColumnBandSize=new Yf(e,ks.TableStyleColBandSize,ur.UseTableStyleColBandSize,((e,t)=>e.tableStyleColumnBandSize=t),(e=>e.tableStyleColumnBandSize)),this.tableStyleRowBandSize=new Yf(e,ks.TableStyleRowBandSize,ur.UseTableStyleRowBandSize,((e,t)=>e.tableStyleRowBandSize=t),(e=>e.tableStyleRowBandSize)),this.avoidDoubleBorders=new Yf(e,ks.AvoidDoubleBorders,ur.UseAvoidDoubleBorders,((e,t)=>e.avoidDoubleBorders=t),(e=>e.avoidDoubleBorders)),this.layoutType=new Yf(e,ks.LayoutType,ur.UseTableLayout,((e,t)=>e.layoutType=t),(e=>e.layoutType)),this.shadingInfo=new Yf(e,ks.ShadingInfo,ur.UseShadingInfoIndex,((e,t)=>e.shadingInfo=t),(e=>e.shadingInfo)),this.tableRowAlignment=new Yf(e,ks.TableRowAlignment,ur.UseTableAlignment,((e,t)=>e.tableRowAlignment=t),(e=>e.tableRowAlignment)),this.isTableOverlap=new Yf(e,ks.IsTableOverlap,ur.UseIsTableOverlap,((e,t)=>e.isTableOverlap=t),(e=>e.isTableOverlap))}}class $f{constructor(e,t,r,i){this.manipulator=e,this.jsonTableProperty=t,this.setProperty=r,this.getProperty=i}setValue(e,t,r){let i=e.tables[t],n=i.getStartPosition();var o=new Sf,a=new Sf;return a.register(new Ff(n,i.nestedLevel,t,this.getProperty(i))),this.setProperty(i,r),o.register(new Ff(n,i.nestedLevel,t,r)),this.manipulator.notifyModelChanged(new Kf(e,this.jsonTableProperty,o)),a}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex];this.setProperty(r,t.lastObject.value),this.manipulator.notifyModelChanged(new Kf(e,this.jsonTableProperty,t))}}class Jf{constructor(e,t,r,i,n){this.manipulator=e,this.jsonTableProperty=t,this.setProperties=i,this.getProperties=n,this.masks=r}setValue(e,t,r,i){let n=e.tables[t],o=n.getStartPosition();var a=new Sf,s=new Sf;let l=n.properties,d=[];for(let e of this.masks)d.push(l.getUseValue(e));return s.register(new Lf(o,n.nestedLevel,t,this.getProperties(l),d)),this.setValuesCore(n,r,i),a.register(new Lf(o,n.nestedLevel,t,r,i)),this.manipulator.notifyModelChanged(new Kf(e,this.jsonTableProperty,a)),s}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex];this.setValuesCore(r,t.lastObject.value,t.lastObject.uses),this.manipulator.notifyModelChanged(new Kf(e,this.jsonTableProperty,t))}setValuesCore(e,t,r){var i=e.properties.clone();this.setProperties(i,t);for(let e=this.masks.length-1;e>=0;e--)void 0!==r[e]&&i.setUseValue(this.masks[e],r[e]);e.properties=i}}class Yf{constructor(e,t,r,i,n){this.manipulator=e,this.tablePropertiesMask=r,this.jsonTableProperty=t,this.setProperty=i,this.getProperty=n}setValue(e,t,r,i){let n=e.tables[t],o=n.getStartPosition();var a=new Sf,s=new Sf;let l=n.properties;return s.register(new Rf(o,n.nestedLevel,t,this.getProperty(l),l.getUseValue(this.tablePropertiesMask))),this.setValueCore(n,r,i),a.register(new Rf(o,n.nestedLevel,t,r,i)),this.manipulator.notifyModelChanged(new Kf(e,this.jsonTableProperty,a)),s}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex];this.setValueCore(r,t.lastObject.value,t.lastObject.use),this.manipulator.notifyModelChanged(new Kf(e,this.jsonTableProperty,t))}setValueCore(e,t,r){var i=e.properties.clone();this.setProperty(i,t),i.setUseValue(this.tablePropertiesMask,r),e.properties=i}}class Qf{get subDocumentId(){return this.subDocument.id}constructor(e,t,r){this.subDocument=e,this.property=t,this.newState=r,this.type=pd.TableRowPropertyChanged}}class Zf{constructor(e){this.cellSpacing=new tb(e,ml.CellSpacing,Ua.UseCellSpacing,((e,t)=>e.cellSpacing=t),(e=>e.cellSpacing)),this.cantSplit=new tb(e,ml.CantSplit,Ua.UseCantSplit,((e,t)=>e.cantSplit=t),(e=>e.cantSplit)),this.hideCellMark=new tb(e,ml.HideCellMark,Ua.UseHideCellMark,((e,t)=>e.hideCellMark=t),(e=>e.hideCellMark)),this.header=new tb(e,ml.Header,Ua.UseHeader,((e,t)=>e.header=t),(e=>e.header)),this.tableRowAlignment=new tb(e,ml.TableRowAlignment,Ua.UseTableRowAlignment,((e,t)=>e.tableRowAlignment=t),(e=>e.tableRowAlignment)),this.height=new eb(e,ml.Height,((e,t)=>e.height=t),(e=>e.height)),this.gridAfter=new eb(e,ml.GridAfter,((e,t)=>e.gridAfter=t),(e=>e.gridAfter)),this.gridBefore=new eb(e,ml.GridBefore,((e,t)=>e.gridBefore=t),(e=>e.gridBefore)),this.widthAfter=new eb(e,ml.WidthAfter,((e,t)=>e.widthAfter=t),(e=>e.widthAfter)),this.widthBefore=new eb(e,ml.WidthBefore,((e,t)=>e.widthBefore=t),(e=>e.widthBefore))}}class eb{constructor(e,t,r,i){this.manipulator=e,this.jsonTableRowProperty=t,this.setProperty=r,this.getProperty=i}setValue(e,t,r,i){let n=e.tables[t],o=n.getStartPosition();var a=new Sf,s=new Sf;let l=n.rows[r];return s.register(new kf(o,n.nestedLevel,t,r,this.getProperty(l))),this.setProperty(l,i),a.register(new kf(o,n.nestedLevel,t,r,i)),this.manipulator.notifyModelChanged(new Qf(e,this.jsonTableRowProperty,a)),s}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex].rows[t.lastObject.rowIndex];this.setProperty(r,t.lastObject.value),this.manipulator.notifyModelChanged(new Qf(e,this.jsonTableRowProperty,t))}}class tb{constructor(e,t,r,i,n){this.manipulator=e,this.tableRowPropertiesMask=r,this.jsonTableRowProperty=t,this.setProperty=i,this.getProperty=n}setValue(e,t,r,i,n){let o=e.tables[t],a=o.getStartPosition();var s=new Sf,l=new Sf;let d=o.rows[r],c=d.properties;return l.register(new Of(a,o.nestedLevel,t,r,this.getProperty(c),c.getUseValue(this.tableRowPropertiesMask))),this.setValueCore(e.documentModel.cache,d,i,n),s.register(new Of(a,o.nestedLevel,t,r,i,n)),this.manipulator.notifyModelChanged(new Qf(e,this.jsonTableRowProperty,s)),l}restoreValue(e,t){let r=e.tables[t.lastObject.tableIndex].rows[t.lastObject.rowIndex];this.setValueCore(e.documentModel.cache,r,t.lastObject.value,t.lastObject.use),this.manipulator.notifyModelChanged(new Qf(e,this.jsonTableRowProperty,t))}setValueCore(e,t,r,i){var n=t.properties.clone();this.setProperty(n,r),n.setUseValue(this.tableRowPropertiesMask,i),t.properties=e.tableRowPropertiesCache.getItem(n)}}class rb extends lu{constructor(e){super(e),this.cellProperties=new Wf(e),this.tableProperties=new qf(e),this.rowProperties=new Zf(e)}static removeTableCore(e,t,r){const i=e.getStartPosition(),n=r[e.nestedLevel];n.splice(C.SearchUtils.binaryIndexOf(n,(e=>e.getStartPosition()-i)),1),t.splice(e.index,1),Ja.advanceIndices(t,e.index,-1)}createTable(e,t,r,i){let n=e.paragraphs[t],o=Ja.getTableCellByPosition(e.tables,n.startLogPosition.value),a=new Ja(new mr,e.documentModel.getDefaultTableStyle());return this.createTableStructure(e,t,a,r,i),this.insertTableCore(a,e.tables,e.tablesByLevels,o),this.modelManipulator.notifyModelChanged(new Nm(e.id,a)),a}removeTable(e,t){const r=t.getStartPosition(),i=t.getEndPosition();t.destructor(e.positionManager);const n=e.getText(t.interval);rb.removeTableCore(t,e.tables,e.tablesByLevels),this.modelManipulator.notifyModelChanged(new km(e.id,r,i,t.nestedLevel,n))}restoreRemovedTable(e,t,r){for(let i,n=0;i=t.rows[n];n++)for(let t,o=0;t=i.cells[o];o++){let i=r[n][o];t.startParagraphPosition=e.positionManager.registerPosition(i.start),t.endParagrapPosition=e.positionManager.registerPosition(i.end)}t.parentCell=Ja.getTableCellByPosition(e.tables,t.getStartPosition()),this.insertTableCore(t,e.tables,e.tablesByLevels,t.parentCell),this.modelManipulator.notifyModelChanged(new Nm(e.id,t))}pasteTable(e,t,r){let i=Ja.getTableCellByPosition(e.tables,r),n=new Ja(t.properties,this.model.stylesManager.addTableStyle(t.style));n.preferredWidth=t.preferredWidth.clone(),n.lookTypes=t.lookTypes;for(let i,o=0;i=t.rows[o];o++){let t=new Ld(n,e.documentModel.cache.tableRowPropertiesCache.getItem(i.properties.clone()));t.gridAfter=i.gridAfter,t.gridBefore=i.gridBefore,i.tablePropertiesException&&(t.tablePropertiesException=i.tablePropertiesException.clone()),t.widthAfter=i.widthAfter.clone(),t.widthBefore=i.widthBefore.clone(),t.height=i.height.clone(),i.tablePropertiesException&&(t.tablePropertiesException=i.tablePropertiesException.clone());for(let n,o=0;n=i.cells[o];o++){let i=n.endParagrapPosition.value-n.startParagraphPosition.value,o=new Rd(t,e.documentModel.cache.tableCellPropertiesCache.getItem(n.properties.clone()));o.startParagraphPosition=e.positionManager.registerPosition(r),r+=i,o.endParagrapPosition=e.positionManager.registerPosition(r),o.columnSpan=n.columnSpan,o.conditionalFormatting=n.conditionalFormatting,o.verticalMerging=n.verticalMerging,o.preferredWidth=n.preferredWidth.clone(),t.cells.push(o)}n.rows.push(t)}return this.insertTableCore(n,e.tables,e.tablesByLevels,i),this.modelManipulator.notifyModelChanged(new Nm(e.id,n)),n}insertRow(e,t,r,i,n){var o=e.tables[t],a=new Ld(o,r.properties);if(n.length!==r.cells.length)throw new Error("cellIntervals.length should be equal to patternRow.cells.length");a.gridAfter=r.gridAfter,a.gridBefore=r.gridBefore,a.height=r.height.clone(),a.properties=r.properties,a.tablePropertiesException=r.tablePropertiesException,a.widthAfter=r.widthAfter.clone(),a.widthBefore=r.widthBefore.clone();for(let t,i=0;t=n[i];i++){let n=r.cells[i],o=new Rd(a,n.properties);o.startParagraphPosition=e.positionManager.registerPosition(t.start),o.endParagrapPosition=e.positionManager.registerPosition(t.end),o.columnSpan=n.columnSpan,o.conditionalFormatting=n.conditionalFormatting,o.preferredWidth=n.preferredWidth.clone(),o.verticalMerging=n.verticalMerging,o.style=n.style,a.cells.push(o)}o.rows.splice(i,0,a);let s=o.rows[i+1];s&&(e.positionManager.unregisterPosition(s.cells[0].startParagraphPosition),s.cells[0].startParagraphPosition=e.positionManager.registerPosition(a.getEndPosition())),this.modelManipulator.notifyModelChanged(new Om(e.id,o,i))}removeRow(e,t,r){const i=e.tables[t];rb.removeRowCore(e,i,r),this.modelManipulator.notifyModelChanged(new _m(e.id,i,r))}static removeRowCore(e,t,r){const i=t.rows[r];i.destructor(e.positionManager);var n=t.rows[r+1];if(n){var o=n.cells[0];e.positionManager.unregisterPosition(o.startParagraphPosition),o.startParagraphPosition=e.positionManager.registerPosition(i.getStartPosition())}t.rows.splice(r,1)}removeCell(e,t,r,i){let n=t.rows[r],o=n.cells[i],a=n.cells[i+1];!a&&t.rows.length>r+1&&(a=t.rows[r+1].cells[0]),o.destructor(e.positionManager),a&&(e.positionManager.unregisterPosition(a.startParagraphPosition),a.startParagraphPosition=e.positionManager.registerPosition(o.startParagraphPosition.value)),n.cells.splice(i,1),this.modelManipulator.notifyModelChanged(new Bm(e.id,t,r,i))}insertCell(e,t,r,i,n,o){let a=t.rows[r];var s=new Rd(a,n.properties);s.columnSpan=n.columnSpan,s.conditionalFormatting=n.conditionalFormatting,s.preferredWidth=n.preferredWidth.clone(),s.style=n.style,s.verticalMerging=n.verticalMerging;let l=0;l=i>0?a.cells[i-1].endParagrapPosition.value:r>0?t.rows[r-1].getEndPosition():t.getStartPosition(),s.startParagraphPosition=e.positionManager.registerPosition(l),s.endParagrapPosition=e.positionManager.registerPosition(l+o),a.cells.splice(i,0,s);let d=a.cells[i+1];!d&&t.rows.length>r+1&&(d=t.rows[r+1].cells[0]),d&&(e.positionManager.unregisterPosition(d.startParagraphPosition),d.startParagraphPosition=e.positionManager.registerPosition(s.endParagrapPosition.value)),this.modelManipulator.notifyModelChanged(new Rm(e.id,t,r,i))}insertParagraphToTheCellStartAndShiftContent(e,t,r){this.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(e,t.startParagraphPosition.value),r)),this.shiftContent(e,t)}shiftContent(e,t){const r=t.parentRow.parentTable;let i=e.tables[r.index+1],n=[];for(;i&&i.nestedLevel>r.nestedLevel;){let r=i.getStartPosition();if(r===t.startParagraphPosition.value)n.push(i);else if(r>t.startParagraphPosition.value)break;i=e.tables[i.index+1]}for(let t,r=n.length-1;t=n[r];r--)this.history.addAndRedo(new Nd(this.modelManipulator,e,t.index))}changeTableStartPosition(e,t,r){let i=t.rows[0].cells[0];var n=i.startParagraphPosition.value;e.positionManager.unregisterPosition(i.startParagraphPosition),i.startParagraphPosition=e.positionManager.registerPosition(r),this.modelManipulator.notifyModelChanged(new Um(e.id,t,n,r))}shiftTableStartPositionToTheRight(e,t){this.changeTableStartPosition(e,t,t.rows[0].cells[0].startParagraphPosition.value+1)}restoreShiftedTableStartPositionToTheRight(e,t){this.changeTableStartPosition(e,t,t.rows[0].cells[0].startParagraphPosition.value-1)}splitTableCellHorizontally(e,t,r,i,n,o){let a=t.rows[r];n?this.splitTableCellToTheRightCore(e,a,i,o):this.splitTableCellToTheLeftCore(e,a,i,o),this.modelManipulator.notifyModelChanged(new Am(e.id,t,r,n?i:i+1,n))}restoreSplittedCellHorizontally(e,t,r,i,n){let o=t.rows[r],a=o.cells[i],s=n?o.cells[i+1]:o.cells[i-1];n?(e.positionManager.unregisterPosition(a.endParagrapPosition),a.endParagrapPosition=e.positionManager.registerPosition(s.endParagrapPosition.value),s.destructor(e.positionManager),o.cells.splice(i+1,1)):(e.positionManager.unregisterPosition(a.startParagraphPosition),a.startParagraphPosition=e.positionManager.registerPosition(s.startParagraphPosition.value),s.destructor(e.positionManager),o.cells.splice(i-1,1)),this.modelManipulator.notifyModelChanged(new Lm(e.id,t,r,n?i:i-1,n))}splitTableCellToTheLeftCore(e,t,r,i){if(r<0)throw new Error("splittingCellIndex should be > 0");let n=t.cells[r],o=e.getParagraphByPosition(n.startParagraphPosition.value),a=new Rd(t,i?n.properties:e.documentModel.cache.tableCellPropertiesCache.getItem(new cr));a.preferredWidth=n.preferredWidth.clone(),t.cells.splice(r,0,a),a.startParagraphPosition=e.positionManager.registerPosition(o.startLogPosition.value),a.endParagrapPosition=e.positionManager.registerPosition(o.getEndPosition()),e.positionManager.unregisterPosition(n.startParagraphPosition),n.startParagraphPosition=e.positionManager.registerPosition(o.getEndPosition())}splitTableCellToTheRightCore(e,t,r,i){if(r<0)throw new Error("splittingCellIndex should be > 0");let n=t.cells[r],o=e.getParagraphByPosition(n.endParagrapPosition.value-1),a=new Rd(t,i?n.properties:e.documentModel.cache.tableCellPropertiesCache.getItem(new cr));a.preferredWidth=n.preferredWidth.clone(),t.cells.splice(r+1,0,a),a.startParagraphPosition=e.positionManager.registerPosition(o.startLogPosition.value),a.endParagrapPosition=e.positionManager.registerPosition(o.getEndPosition()),e.positionManager.unregisterPosition(n.endParagrapPosition),n.endParagrapPosition=e.positionManager.registerPosition(o.startLogPosition.value)}setTableStyle(e,t,r){const i=e.tables[t];i.style=r,this.resetParagraphCharacterMergedProperties(e,t),this.modelManipulator.notifyModelChanged(new Fm(e.id,i,r))}removeTableWithContent(e,t){this.history.beginTransaction(),this.removeNestedTablesByParentTable(e,t),this.history.addAndRedo(new Wm(this.modelManipulator,e,t.index)),this.history.addAndRedo(new Hm(this.modelManipulator,new gu(e,on.FixedInterval.fromPositions(t.getStartPosition(),t.getEndPosition())),!1)),this.history.endTransaction()}removeTableCellWithContent(e,t,r,i){let n=t.rows[r].cells[i];this.removeNestedTablesByParentCell(e,n),this.history.addAndRedo(new Vm(this.modelManipulator,e,t.index,r,i)),this.history.addAndRedo(new Hm(this.modelManipulator,new gu(e,n.interval),!1))}removeTableRowWithContent(e,t,r){let i=t.rows[r];this.removeNestedTables(e,i),this.updateVerticalMergingState(e,t,r),this.history.addAndRedo(new zm(this.modelManipulator,e,t.index,r)),this.history.addAndRedo(new Hm(this.modelManipulator,new gu(e,on.FixedInterval.fromPositions(i.getStartPosition(),i.getEndPosition())),!1))}updateVerticalMergingState(e,t,r){let i=t.rows[r];for(let n,o=i.cells.length-1;n=i.cells[o];o--)if(n.verticalMerging!==Xe.None){let i=oc.getStartColumnIndex(n),o=t.rows[r+1],a=o?oc.getCellIndexByColumnIndex(o,i):-1,s=o?o.cells[a]:null;if(n.verticalMerging==Xe.Restart){if(s){let n=t.rows[r+2],o=n?n.cells[oc.getCellIndexByEndColumnIndex(n,i)]:null;o&&o.verticalMerging===Xe.Continue?this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,r+1,a,Xe.Restart)):this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,r+1,a,Xe.None))}}else if(n.verticalMerging==Xe.Continue&&r>0){let n=t.rows[r-1],o=oc.getCellIndexByColumnIndex(n,i),a=n.cells[o];a&&a.verticalMerging===Xe.Restart&&(s&&s.verticalMerging===Xe.Continue||this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,r-1,o,Xe.None)))}}}removeNestedTables(e,t){let r=e.tables[t.parentTable.index+1],i=[];for(;r&&r.nestedLevel>t.parentTable.nestedLevel;)this.isNestedTableInRow(r,t)&&i.push(r),r=e.tables[r.index+1];for(let t,r=i.length-1;t=i[r];r--)this.history.addAndRedo(new Wm(this.modelManipulator,e,t.index))}isNestedTableInRow(e,t){return e.parentCell&&(e.parentCell.parentRow===t||this.isNestedTableInRow(e.parentCell.parentRow.parentTable,t))}removeNestedTablesByParentTable(e,t){let r=e.tables[t.index+1],i=[];for(;r&&r.nestedLevel>t.nestedLevel;)this.isNestedTableInTable(r,t)&&i.push(r),r=e.tables[r.index+1];for(let t,r=i.length-1;t=i[r];r--)this.history.addAndRedo(new Wm(this.modelManipulator,e,t.index))}removeNestedTablesByParentCell(e,t){let r=e.tables[t.parentRow.parentTable.index+1],i=[];for(;r&&r.nestedLevel>t.parentRow.parentTable.nestedLevel;)this.isNestedTableInCell(r,t)&&i.push(r),r=e.tables[r.index+1];for(let t,r=i.length-1;t=i[r];r--)this.history.addAndRedo(new Wm(this.modelManipulator,e,t.index))}isNestedTableInCell(e,t){return e.parentCell&&(e.parentCell===t||this.isNestedTableInCell(e.parentCell.parentRow.parentTable,t))}isNestedTableInTable(e,t){return e.parentCell&&(e.parentCell.parentRow.parentTable===t||this.isNestedTableInTable(e.parentCell.parentRow.parentTable,t))}normalizeVerticalSpans(e,t){let r=t.rows.length;if(1!==r)for(let i=0;i<r;i++){let n=t.rows[i],o=n.gridBefore;for(let a,s=0;a=n.cells[s];s++){switch(a.verticalMerging){case Xe.Restart:if(i==r-1)this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,s,Xe.None));else{let r=oc.getCellIndexByColumnIndex(t.rows[i+1],o),n=t.rows[i+1].cells[r];n&&n.verticalMerging===Xe.Continue||this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,s,Xe.None))}break;case Xe.Continue:if(0===i)this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,s,Xe.None));else{let n=oc.getCellIndexByColumnIndex(t.rows[i-1],o),a=t.rows[i-1].cells[n];if(!a||a.verticalMerging===Xe.None)if(i==r-1)this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,s,Xe.None));else{let r=oc.getCellIndexByColumnIndex(t.rows[i+1],o),n=t.rows[i+1].cells[r];n&&n.verticalMerging==Xe.Continue?this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,s,Xe.Restart)):this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,s,Xe.None))}}}o+=a.columnSpan}}else{let r=t.rows[0];for(let i,n=0;i=r.cells[n];n++)i.verticalMerging!==Xe.None&&this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,0,n,Xe.None))}}normalizeTableGrid(e,t){var r=-1;for(let e,i=0;e=t.rows[i];i++)r=Math.max(r,e.getTotalCellsInRowConsiderGrid()-1);for(let i,n=0;i=t.rows[n];n++){let o=r-(i.getTotalCellsInRowConsiderGrid()-1);0!=o&&this.history.addAndRedo(new Ud(this.modelManipulator,e,t.index,n,i.gridAfter+o))}}normalizeCellColumnSpans(e,t,r){rb.normalizeRowsGridBefore(t,r,((t,r,i)=>this.history.addAndRedo(new Hd(this.modelManipulator,e,t.index,r,i))),((t,r,i)=>this.history.addAndRedo(new Ud(this.modelManipulator,e,t.index,r,i))),((t,r,i)=>this.history.addAndRedo(new Wd(this.modelManipulator,e,t.index,r,i))),((t,r,i)=>this.history.addAndRedo(new Vd(this.modelManipulator,e,t.index,r,i))));const i=Dm.getIntervals(t);for(let r=t.rows.length-1;r>=0;r--)rb.normalizeTableRow(t,r,i.slice(0),((t,r,i)=>this.history.addAndRedo(new Hd(this.modelManipulator,e,t.index,r,i))),((t,r,i)=>this.history.addAndRedo(new Ud(this.modelManipulator,e,t.index,r,i))),((t,r,i,n)=>this.history.addAndRedo(new $d(this.modelManipulator,e,t.index,r,i,n))))}static normalizeCellColumnSpansWithoutHistory(e,t){rb.normalizeRowsGridBefore(e,t,((e,t,r)=>e.rows[t].gridBefore=r),((e,t,r)=>e.rows[t].gridAfter=r),((e,t,r)=>e.rows[t].widthBefore=r),((e,t,r)=>e.rows[t].widthAfter=r));const r=Dm.getIntervals(e);for(let t=e.rows.length-1;t>=0;t--)rb.normalizeTableRow(e,t,r.slice(0),((e,t,r)=>e.rows[t].gridBefore=r),((e,t,r)=>e.rows[t].gridAfter=r),((e,t,r,i)=>e.rows[t].cells[r].columnSpan=i))}static normalizeTableRow(e,t,r,i,n,o){let a=e.rows[t],s=rb.calculateNewSpan(a.gridBefore,r);a.gridBefore!=s&&i(e,t,s);for(let i,n=0;i=a.cells[n];n++)s=rb.calculateNewSpan(i.columnSpan,r),i.columnSpan!==s&&o(e,t,n,s);s=rb.calculateNewSpan(a.gridAfter,r),a.gridAfter!==s&&n(e,t,s)}static calculateNewSpan(e,t){let r=0,i=0;for(;i<e;)i+=t[0].colSpan,r++,t.splice(0,1);return r}static normalizeRowsGridBefore(e,t,r,i,n,o){let a=e.rows[0].gridBefore,s=e.rows[0].gridAfter;for(let t,r=1;t=e.rows[r];r++)a=Math.min(a,t.gridBefore),s=Math.min(s,t.gridAfter);if(0!=a||0!=s)for(let l,d=0;l=e.rows[d];d++)0!==a&&r(e,d,l.gridBefore-a),0!==l.gridBefore||l.widthBefore.type==Je.Nil&&0==l.widthBefore.value||!t||n(e,d,lr.createDefault()),0!=s&&i(e,d,l.gridAfter-s),0!=l.gridAfter||l.widthAfter.type==Je.Nil&&0==l.widthAfter.value||!t||o(e,d,lr.createDefault())}normalizeTableCellWidth(e,t){for(let r,i=0;r=t.rows[i];i++){let n=0,o=[];for(let e,t=0;e=r.cells[t];t++){let t=e.preferredWidth;if(o.push(t),t.type!==Je.FiftiethsOfPercent){n=0;break}n+=t.value}if(!(n<=5e3))for(let a=0;a<r.cells.length;a++){let r=5e3*o[a].value/n,s=o[a].clone();s.value=r,this.history.addAndRedo(new tc(this.modelManipulator,e,t.index,i,a,s))}}}createTableStructure(e,t,r,i,n){let o=e.paragraphs[t];for(let a=0;a<i;a++){let i=new Ld(r,e.documentModel.cache.tableRowPropertiesCache.getItem(new za));r.rows.push(i);for(let r=0;r<n;r++){let r=new Rd(i,e.documentModel.cache.tableCellPropertiesCache.getItem(new cr));i.cells.push(r),r.startParagraphPosition=e.positionManager.registerPosition(o.startLogPosition.value),r.endParagrapPosition=e.positionManager.registerPosition(o.getEndPosition()),o=e.paragraphs[++t]}}}fullCellWidth(e,t,r){return f.ListUtils.accumulate(e,0,((e,t)=>e+t),t,t+r)}initializeColumnWidthsWhenInsertTable(e,t,r){this.history.addAndRedo(new Jm(this.modelManipulator,e,t.index,lr.create(0,Je.Auto)));const i=this.distributeWidthsToAllColumns(t,r);this.forEachCell(t,((r,n)=>{this.history.addAndRedo(new tc(this.modelManipulator,e,t.index,r.rowIndex,r.cellIndex,lr.create(this.fullCellWidth(i,n,r.cell.columnSpan),Je.ModelUnits)))}))}validateTableIndent(e,t){let r=e.getParagraphIndexByPosition(t.getStartPosition()),i=e.paragraphs[r],n=i.getParagraphMergedProperties().leftIndent,o=i.getParagraphMergedProperties().firstLineIndent,a=i.getParagraphMergedProperties().firstLineIndentType;if(0===n&&0===o&&a===ke.None)return;let s=e.getParagraphIndexByPosition(t.getEndPosition()-1);for(;r<=s;r++)i=e.paragraphs[r],this.history.addAndRedo(new ft(this.modelManipulator,new gu(e,i.interval),0,!0)),this.history.addAndRedo(new pt(this.modelManipulator,new gu(e,i.interval),0,!0)),this.history.addAndRedo(new gt(this.modelManipulator,new gu(e,i.interval),ke.None,!0))}tryJoinTables(e,t){let r=e.getParagraphIndexByPosition(t.getStartPosition());if(0===r)return;let i=e.paragraphs[r-1],n=Ja.getTableCellByPosition(e.tables,i.startLogPosition.value);n&&t.nestedLevel===n.parentRow.parentTable.nestedLevel&&this.joinTablesCore(e,[n.parentRow.parentTable,t])}joinTablesCore(e,t){if(t.length<2)throw new Error("tables.length should be > 2")}forEachCell(e,t){const r=new Qa(e,-1,-1);for(;r.moveToNextRow();){let e=r.row.gridBefore;for(;r.moveToNextCell();)t(r,e),e+=r.cell.columnSpan}}distributeWidthsToAllColumns(e,t){const r=e.getTotalVirtualColumnsCount(),i=Math.max(Math.ceil(t/r),1),n=f.ListUtils.initByValue(r-1,i);return n.push(Math.max(1,Math.ceil(t-i*(r-1)))),n}insertTableCore(e,t,r,i){e.nestedLevel=i?i.parentRow.parentTable.nestedLevel+1:0,e.parentCell=i;let n=e.getStartPosition();r[e.nestedLevel]||(r[e.nestedLevel]=[]);let o=C.SearchUtils.normedInterpolationIndexOf(r[e.nestedLevel],(e=>e.getStartPosition()),n);if(r[e.nestedLevel].splice(o+1,0,e),i){let r=i.parentRow.parentTable.index+1;for(let e;(e=t[r])&&!(e.getStartPosition()>=n);r++);e.index=r}else e.index=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(t,(e=>e.getStartPosition()),n)+1);t.splice(e.index,0,e),Ja.advanceIndices(t,e.index+1,1)}normalizeVerticalMerging(e,t,r,i){let n=t.rows[r];for(let o,a=i+1;o=n.cells[a];a++){if(o.verticalMerging===Xe.None)continue;let i=o.verticalMerging,n=Ja.getFirstCellPositionInVerticalMergingGroup(Qa.createAndInit(t,r,a).init()),s=oc.getStartColumnIndex(n.cell),l=oc.getVerticalSpanCellPositions(n,s);if(this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,r,a,Xe.None)),i===Xe.Restart)l.length>2?this.history.addAndRedo(Jd.fromPosition(this.modelManipulator,e,l[1],Xe.Restart)):(this.history.addAndRedo(Jd.fromPosition(this.modelManipulator,e,l[0],Xe.None)),this.history.addAndRedo(Jd.fromPosition(this.modelManipulator,e,l[1],Xe.None)));else{let t=Qa.indexOfCell(l,o);1===t&&this.history.addAndRedo(Jd.fromPosition(this.modelManipulator,e,l[0],Xe.None)),l.length-2===t?this.history.addAndRedo(Jd.fromPosition(this.modelManipulator,e,l[l.length-1],Xe.None)):l.length-1!==t&&this.history.addAndRedo(Jd.fromPosition(this.modelManipulator,e,l[t+1],Xe.Restart))}}}normalizeRows(e,t){for(let r,i=t.rows.length-1;r=t.rows[i];i--)if(this.areAllCellsHasVerticalMerge(r)){let n=r.height;if(n.type!==$e.Auto&&i>0){let r=t.rows[i-1].height;this.history.addAndRedo(new jd(this.modelManipulator,e,t.index,i-1,dr.create(r.value+n.value,n.type)))}this.removeTableRowWithContent(e,t,i)}}areAllCellsHasVerticalMerge(e){for(let t,r=0;t=e.cells[r];r++)if(t.verticalMerging!==Xe.Continue)return!1;return!0}mergeSelectedTableCellsHorizontally(e,t,r){t.extendedData.rows.forEach((i=>{const n=new Cn.e(i.cells[0].cellIndex,f.ListUtils.last(i.cells).cellIndex+1);for(let o=n.end-2;o>=n.start;o--){const n=new Qa(t.table,i.rowIndex,o).init();this.modelManipulator.table.mergeTwoTableCellsHorizontally(e,n,r)}}))}mergeSelectedTableCellsVertically(e,t,r){f.ListUtils.reverseForEach(t.extendedData.rows,(i=>{const n=new Qa(t.table,i.rowIndex,i.cells[0].cellIndex).init();this.modelManipulator.table.mergeTwoTableCellsVertically(e,n,r)}),t.extendedData.numRows-2)}mergeTwoTableCellsHorizontally(e,t,r){new gf(this.modelManipulator.modelManager,e).execute(t,!0,r)}mergeTwoTableCellsVertically(e,t,r){new mf(this.modelManipulator.modelManager,e).execute(t,!0,r)}insertCellToTheRight(e,t,r,i,n,o=!0,a=!0,s=!0,l=!0){new sf(this.modelManipulator.modelManager,e).execute(t,r,i,n,{canNormalizeTable:o,canNormalizeVerticalMerging:a,canCopyProperties:s,needToSetNextStyle:l})}insertCellToTheLeft(e,t,r,i,n,o=!0,a=!0,s=!0){new af(this.modelManipulator.modelManager,e).execute(t,r,i,n,{canNormalizeTable:o,canNormalizeVerticalMerging:a,canCopyProperties:s})}insertRowBelow(e,t,r){new uf(this.modelManipulator.modelManager,e).execute(t,r)}insertRowAbove(e,t,r){new hf(this.modelManipulator.modelManager,e).execute(t,r)}insertTable(e,t,r,i,n,o,a=!1){if(t<1||r<1)throw new Error("rowCount and cellCount must be greater than 0");this.history.beginTransaction();let s=e.getParagraphIndexByPosition(i);(e.paragraphs[s].startLogPosition.value!==i||C.SearchUtils.binaryIndexOf(e.tables,(e=>e.getEndPosition()-i))>=0)&&(this.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(e,i),o)),i++,s++);let l=t*r;for(let t=0;t<l;t++)this.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(e,i+t),o));this.history.addAndRedo(new Ad(this.modelManipulator,e,s,t,r));const d=Ja.getTableByPosition(e.tables,i,!0);return this.initializeColumnWidthsWhenInsertTable(e,d,n),this.validateTableIndent(e,d),this.history.addAndRedo(new Zm(this.modelManipulator,e,d.index,_e.ApplyFirstRow|_e.ApplyFirstColumn|_e.DoNotApplyColumnBanding)),this.tryJoinTables(e,d),a&&this.applyInitialBorders(e,d),this.history.endTransaction(),d}applyInitialBorders(e,t){let r=new Me;r.style=de.Single,r.width=15,r.color=this.model.colorProvider.getModelColorFromRgba(0),this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[r.clone(),r.clone(),r.clone(),r.clone(),r.clone(),r.clone()],[!0,!0,!0,!0,!0,!0]))}removeTablesOnInterval(e,t){const r=e.subDocument,i=e.interval;let n=i.end,o=Math.max(C.SearchUtils.normedInterpolationIndexOf(r.tables,(e=>e.getStartPosition()),i.start),0);for(;o>0&&r.tables[o].nestedLevel>0;)o--;let a=[];for(let e,s=o;e=r.tables[s];s++){let r=e.getStartPosition();if(n<=r)break;let o=e.getEndPosition();const s=e.interval;r===i.start&&o===n?t&&a.push(e):i.containsInterval(s)&&a.push(e)}for(let e=a.length-1;e>=0;e--)this.history.addAndRedo(new Wm(this.modelManipulator,r,a[e].index))}resetParagraphCharacterMergedProperties(e,t){const r=e.tables[t],i=r.getStartPosition(),n=r.getEndPosition(),o=new jh(e,!1);o.setPosition(i);let a=null;do{const e=o.run;if(a!=e.paragraph){if(a=e.paragraph,a.startLogPosition.value>=n)break;a.resetParagraphMergedProperties()}e.resetCharacterMergedProperties()}while(o.moveToNextRun())}}var ib=__webpack_require__(7496);class nb{constructor(e,t,r){this.subDocumentId=e,this.position=t,this.length=r}canContinuesWith(e){return e.subDocumentId==this.subDocumentId&&e.position==this.position+this.length}}class ob extends nb{constructor(e,t,r,i,n,o){super(e,i,1),this.objectId=t,this.innerSubDocId=r,this.anchorInfo=n,this.containerProperties=o,this.type=pd.AnchoredTextBoxInserted}}class ab extends Ze{get boundSubDocument(){return this.subDocPos.subDocument}get position(){return this.subDocPos.position}constructor(e,t){super(e),this.subDocPos=t}}class sb extends ab{constructor(e,t,r,i,n){super(e,t),this.charPropsBundle=r,this.picInfo=i,this.options=n}redo(){this.modelManipulator.picture.insertAnchoredPictureInner(this.subDocPos,this.charPropsBundle,this.picInfo,this.options),this.options=void 0}undo(){this.modelManipulator.range.removeIntervalWithoutHistory(this.boundSubDocument,new on.FixedInterval(this.position,1),!1)}}class lb extends ab{constructor(e,t,r,i){super(e,t),this.charPropsBundle=r,this.textBoxInfo=i}redo(){this.modelManipulator.textBox.insertAnchoredTextBox(this.subDocPos,this.charPropsBundle,this.textBoxInfo),this.modelManipulator.model.subDocumentsCollection.restore(this.textBoxInfo.innerSubDocument.id)}undo(){this.modelManipulator.range.removeIntervalWithoutHistory(this.boundSubDocument,new on.FixedInterval(this.position,1),!1)}}class db extends lu{insertRunInternal(e,t,r,i){const n=e.subDocument;let o=e.position;o>=n.getDocumentEndPosition()&&o--;const a=C.SearchUtils.normedInterpolationIndexOf(n.chunks,(e=>e.startLogPosition.value),o),s=n.chunks[a],l=o-s.startLogPosition.value;let d=C.SearchUtils.normedInterpolationIndexOf(s.textRuns,(e=>e.startOffset),l),c=s.textRuns[d];const h=C.SearchUtils.normedInterpolationIndexOf(n.documentModel.sections,(e=>e.startLogPosition.value),o);if(n.documentModel.sections[h].setLength(n,n.documentModel.sections[h].getLength()+i.length),s.textBuffer=[s.textBuffer.substr(0,l),i,s.textBuffer.substr(l)].join(""),l!=c.startOffset){if(r==cs.TextRun&&c.getType()==cs.TextRun&&c.characterStyle.equalsByName(t.style)&&c.maskedCharacterProperties.equals(t.props))return c.incLength(i.length),db.moveRunsInChunk(s,d+1,i.length),n.positionManager.advance(o,i.length,1),{chunkIndex:a,runIndex:d};s.splitRun(d,l-c.startOffset),d++,c=s.textRuns[d]}let u;n.positionManager.advance(o,i.length,1);const p=s.textRuns[d-1];return p&&r==cs.TextRun&&p.getType()==cs.TextRun&&p.characterStyle.equalsByName(t.style)&&p.maskedCharacterProperties.equals(t.props)?(p.incLength(i.length),db.moveRunsInChunk(s,d,i.length),{chunkIndex:a,runIndex:d-1}):r==cs.TextRun&&c.getType()==cs.TextRun&&c.characterStyle.equalsByName(t.style)&&c.maskedCharacterProperties.equals(t.props)?(c.incLength(i.length),db.moveRunsInChunk(s,d+1,i.length),{chunkIndex:a,runIndex:d}):(u=cb.createRun[r](l,i.length,c.paragraph,t),s.textRuns.splice(d,0,u),db.moveRunsInChunk(s,d+1,i.length),{chunkIndex:a,runIndex:d})}static moveRunsInChunk(e,t,r){for(let i,n=t;i=e.textRuns[n];n++)i.startOffset+=r}}class cb{}cb.createRun={[cs.TextRun]:(e,t,r,i)=>new ch(e,t,r,i),[cs.ParagraphRun]:(e,t,r,i)=>new Bl(e,r,i),[cs.SectionRun]:(e,t,r,i)=>new Ll(e,r,i),[cs.FieldCodeStartRun]:(e,t,r,i)=>new Al(e,r,i),[cs.FieldCodeEndRun]:(e,t,r,i)=>new Nl(e,r,i),[cs.FieldResultEndRun]:(e,t,r,i)=>new kl(e,r,i),[cs.AnchoredPictureRun]:(e,t,r,i)=>new ah(e,r,i,oh.defaultInfo(null,new so.Size(0,0)),-1),[cs.AnchoredTextBoxRun]:(e,t,r,i)=>new sh(e,r,i,new th,-1,new eh(!0,0,new so.Size(0,0),new so.Size(0,0),cc.Page,hc.Page,!0,!0),new Jc,-1,new ph),[cs.InlinePictureRun]:(e,t,r,i)=>new lh(e,r,i,nh.defaultInfo(null)),[cs.InlineTextBoxRun]:(e,t,r,i)=>new dh(e,r,i,new th,-1,new Zc(!0,0,new so.Size(0,0)),new ph),[cs.LayoutDependentRun]:(e,t,r,i)=>new Ol(e,r,i),[cs.FootNoteRun]:(e,t,r,i)=>new Ul(e,r,i),[cs.EndNoteRun]:(e,t,r,i)=>new Hl(e,r,i),[cs.NoteSeparatorRun]:(e,t,r,i)=>new Vl(e,r,i),[cs.NoteContinuationSeparatorRun]:(e,t,r,i)=>new Wl(e,r,i)};class hb{constructor(e,t,r,i,n,o){this.innerSubDocument=e,this.size=t,this.shape=r,this.anchorInfo=i,this.textBoxProperties=n,this.containerProperties=o}}class ub extends db{insertAnchoredTextBoxViaHistory(e,t,r){this.history.addAndRedo(new lb(this.modelManipulator,e,t,r))}insertAnchoredTextBox(e,t,r){const i=e.subDocument,n=e.position;if(i.isTextBox())throw new Error("TextBox can not be inserted into another TextBox");const o=this.modelManipulator.text.insertRunInternal(e,t,cs.AnchoredTextBoxRun,an.specialCharacters.ObjectMark),a=i.chunks[o.chunkIndex].textRuns[o.runIndex];a.size.copyFrom(r.size),a.shape.copyFrom(r.shape),a.anchorInfo=r.anchorInfo.clone(),a.containerProperties.copyFrom(r.containerProperties);let s=r.innerSubDocument?r.innerSubDocument:this.model.createSubDocument(yo.TextBox,i.id);r.innerSubDocument=s,a.subDocId=s.id,i.chunks[o.chunkIndex].textRuns[o.runIndex].paragraph.length++,this.modelManipulator.notifyModelChanged(new ob(i.id,a.anchoredObjectID,a.subDocId,n,r.anchorInfo,a.containerProperties));const l=new on.FixedInterval(n,1);return this.modelManipulator.floatingObject.textBoxSize.setValue(i,l,r.size),this.modelManipulator.floatingObject.shape.fillColor.setValue(i,l,r.shape.fillColor),this.modelManipulator.floatingObject.shape.outlineColor.setValue(i,l,r.shape.outlineColor),this.modelManipulator.floatingObject.shape.outlineWidth.setValue(i,l,r.shape.outlineWidth),this.modelManipulator.floatingObject.textBoxProperties.setValue(i,l,r.textBoxProperties),a}}class pb extends ib.m7{constructor(){super(...arguments),this.insertParagraphMarkBeforeIfStartsWithTable=!0,this.enableCharacterStyleCreation=!0,this.enableParagraphStyleCreation=!0,this.enableTableStyleCreation=!0,this.overlapTableCellContent=!1,this.numberingListCache={},this.abstractNumberingListCache={}}}class gb{get history(){return this.targetModelManipulator.modelManager.history}get modelsConstOffset(){return this.targetStartPosition-this.sourceInterval.start}get sameModel(){return this.sourceDocumentModel===this.targetDocumentModel}get currInsertSubDocumentPosition(){return new pu(this.targetSubDocument,this.currentTargetPosition)}constructor(e,t,r,i){this.numberingListCache={},this.abstractNumberingListIndexesMap={},this.unloadedCacheImageInfo=[],this.abstractNumberingListIndexesMap=t.abstractNumberingListCache,this.numberingListCache=t.numberingListCache,e.modelManager.clientMode||(t.enableCharacterStyleCreation=!1,t.enableParagraphStyleCreation=!1,t.enableTableStyleCreation=!1),this.targetModelManipulator=e,this.options=t,this.targetSubDocPos=r,this.sourceSubDocInterval=i,this.newTables=[],this.runHandlers={[cs.TextRun]:this.textRunHandler.bind(this),[cs.ParagraphRun]:this.paragraphRunHandler.bind(this),[cs.SectionRun]:this.sectionRunHandler.bind(this),[cs.FieldCodeStartRun]:this.fieldCodeRunHandler.bind(this),[cs.FieldCodeEndRun]:this.textRunHandler.bind(this),[cs.FieldResultEndRun]:this.textRunHandler.bind(this),[cs.LayoutDependentRun]:this.textRunHandler.bind(this),[cs.InlinePictureRun]:this.inlinePictureRunHandler.bind(this),[cs.InlineTextBoxRun]:this.notSupportedRunHandler.bind(this),[cs.AnchoredPictureRun]:this.anchoredPictureRunHandler.bind(this),[cs.AnchoredTextBoxRun]:this.anchoredTextBoxRunHandler.bind(this),[cs.Undefined]:this.notSupportedRunHandler.bind(this),[cs.FootNoteRun]:this.notSupportedRunHandler.bind(this),[cs.EndNoteRun]:this.notSupportedRunHandler.bind(this),[cs.NoteSeparatorRun]:this.notSupportedRunHandler.bind(this),[cs.NoteContinuationSeparatorRun]:this.notSupportedRunHandler.bind(this)}}insert(){this.sourceSubDocument=this.sourceSubDocInterval.subDocument,this.sourceInterval=this.sourceSubDocInterval.interval,this.targetSubDocument=this.targetSubDocPos.subDocument,this.targetStartPosition=this.targetSubDocPos.position,this.sourceDocumentModel=this.sourceSubDocInterval.subDocument.documentModel,this.targetDocumentModel=this.targetSubDocPos.subDocument.documentModel,this.currentTargetPosition=this.targetSubDocPos.position,this.constRunIterator=this.sourceSubDocInterval.subDocument.getConstRunIterator(this.sourceSubDocInterval.interval),this.fromFieldIndexesWhatNeedCopyInfo=[],this.insertedSubDocuments=[],this.history.addTransaction((()=>{for(this.prependTableByParagraph();this.constRunIterator.moveNext();){const e=this.constRunIterator.currentRun,t=this.runHandlers[e.getType()];if(!t)throw new Error(R.D.internalExceptionTemplate(`SubDocumentInserter. Inknown run type "${e.getType()}."`));t(e),this.currentTargetPosition+=e.getLength()}if(this.collectTables(),this.collectFields(),this.collectBookmarks(),this.collectRangePermission(),this.options.overlapTableCellContent){const e=this.targetSubDocument.getParagraphByPosition(this.currInsertSubDocumentPosition.position-1);this.targetSubDocument.getParagraphByPosition(this.currInsertSubDocumentPosition.position).copyFrom(e);const t=new gu(this.targetSubDocument,new on.FixedInterval(this.currInsertSubDocumentPosition.position-1,1));this.targetModelManipulator.range.removeInterval(t,!1,!1,!1)}f.ListUtils.unique(this.unloadedCacheImageInfo,((e,t)=>e.currId-t.currId)).forEach((e=>this.targetModelManipulator.picture.loader.load(e)))})),this.insertedInterval=on.FixedInterval.fromPositions(this.targetSubDocPos.position,this.currentTargetPosition)}fieldCodeRunHandler(e){const t=this.constRunIterator.currentChunk.startLogPosition.value+e.startOffset;this.fromFieldIndexesWhatNeedCopyInfo.push(Md.normedBinaryIndexOf(this.sourceSubDocument.fields,t+1)),this.textRunHandler(e)}textRunHandler(e){this.targetModelManipulator.text.insertTextInner(new op(this.currInsertSubDocumentPosition,this.getCharPropsBundle(e),e.getType()==cs.LayoutDependentRun&&this.targetSubDocument.isMain()?cs.TextRun:e.getType(),this.constRunIterator.currentChunk.getRunText(e)))}inlinePictureRunHandler(e){var t;const r=null===(t=this.options.pictureSizeUpdater)||void 0===t?void 0:t.getImageLoadingOptions(e);this.targetModelManipulator.picture.insertInlinePictureInner(this.currInsertSubDocumentPosition,this.getCharPropsBundle(e),this.getInlinePictureInfo(e.info),r)}anchoredPictureRunHandler(e){this.targetModelManipulator.picture.insertAnchoredPictureInner(this.currInsertSubDocumentPosition,this.getCharPropsBundle(e),this.getAnchorPictureInfo(e.info))}anchoredTextBoxRunHandler(e){const t=e;if(this.targetSubDocument.isTextBox())this.targetModelManipulator.text.insertTextInner(new op(this.currInsertSubDocumentPosition,this.getCharPropsBundle(e),cs.TextRun," "));else{let r=this.targetModelManipulator.textBox.insertAnchoredTextBox(this.currInsertSubDocumentPosition,this.getCharPropsBundle(e),new hb(null,t.size.clone(),t.shape.clone(),t.anchorInfo.clone(),t.textBoxProperties.clone(),t.containerProperties.clone()));const i=this.sourceDocumentModel.subDocuments[t.subDocId],n=this.targetModelManipulator.model.subDocuments[r.subDocId];this.insertedSubDocuments.push(n),new gb(this.targetModelManipulator,this.options,new pu(n,0),new gu(i,new on.FixedInterval(0,i.getDocumentEndPosition()))).insert(),this.targetModelManipulator.range.removeIntervalInner(n,new on.FixedInterval(n.getDocumentEndPosition()-2,1),!1)}}paragraphRunHandler(e){this.targetModelManipulator.paragraph.insertParagraphInner(new Ag(this.currInsertSubDocumentPosition,this.getCharPropsBundle(e),this.getMaskedParagraphPropertiesBundleFull(e.paragraph),!0,(()=>{})))}sectionRunHandler(e){this.targetModelManipulator.section.insertSection(this.currInsertSubDocumentPosition,this.getCharPropsBundle(e),this.constRunIterator.currentSection.sectionProperties.clone(),!0,this.getMaskedParagraphPropertiesBundleFull(e.paragraph),!0)}notSupportedRunHandler(e){}collectTables(){let e=this.sourceSubDocInterval.interval;e=new on.FixedInterval(e.start,e.length-(this.options.overlapTableCellContent?1:0));const t=this.sourceSubDocument.tables,r=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(t,(e=>e.getStartPosition()),e.start)),i=this.modelsConstOffset;for(let n,o=r;n=t[o];o++){if(n.interval.start>=e.end)break;const t=nn.IntervalAlgorithms.getIntersectionNonNullLength(n.interval,e);if(!t||t.length!=n.interval.length)continue;const r=this.getPatternTable(n),o=this.targetModelManipulator.table.pasteTable(this.targetSubDocument,r,i+n.getStartPosition());r.destructor(this.sourceSubDocInterval.subDocument.positionManager),this.newTables.push(o)}}getPatternTable(e){const t=e.clone(this.sourceSubDocInterval.subDocument);t.properties=this.getTableProperties(e.properties),t.style=this.getTableStyle(e.style);for(const e of t.rows){e.properties=this.getTableRowProperties(e.properties),e.tablePropertiesException=this.getTableProperties(e.tablePropertiesException),e.conditionalFormatting=e.conditionalFormatting;for(const t of e.cells)t.properties=this.getTableCellProperties(t.properties),t.style=this.getTableCellStyle(t.style),t.conditionalFormatting=t.conditionalFormatting}return t}collectFields(){if(this.fromFieldIndexesWhatNeedCopyInfo.length>0){const e=this.sourceSubDocument.fields,t=this.targetSubDocument.fields,r=this.modelsConstOffset,i=r+e[this.fromFieldIndexesWhatNeedCopyInfo[0]].getCodeStartPosition();let n=Md.normedBinaryIndexOf(t,i);for((n<0||t[n].getCodeStartPosition()<i)&&n++;this.fromFieldIndexesWhatNeedCopyInfo.length>0;){const e=this.sourceSubDocument.fields[this.fromFieldIndexesWhatNeedCopyInfo.shift()],i=new Md(this.targetSubDocument.positionManager,n,e.getFieldStartPosition()+r,e.getSeparatorPosition()+r,e.getFieldEndPosition()+r,e.showCode,e.isHyperlinkField()?e.getHyperlinkInfo().clone():void 0);Md.addField(t,i),n++,this.targetModelManipulator.notifyModelChanged(new up(this.targetSubDocument.id,i.getFieldStartPosition(),i.getSeparatorPosition(),i.getFieldEndPosition())),i.isHyperlinkField()&&this.targetModelManipulator.notifyModelChanged(new vm(this.targetSubDocument.id,i.getResultInterval(),i.getCodeInterval(),i.getHyperlinkInfo()))}}}collectBookmarks(){this.targetModelManipulator.bookmark.insertBookmarksFromSubDocument(this.sourceSubDocument,this.targetSubDocument,this.sourceInterval,this.modelsConstOffset)}collectRangePermission(){this.targetModelManipulator.rangePermission.insertRangePermissionsFromSubDocument(this.sourceSubDocument,this.targetSubDocument,this.sourceInterval,this.modelsConstOffset)}prependTableByParagraph(){if(this.options.insertParagraphMarkBeforeIfStartsWithTable){const e=Ja.getTableByPosition(this.sourceSubDocument.tables,this.sourceInterval.start,!1);e&&e.getStartPosition()==this.sourceInterval.start&&(this.targetSubDocument.getParagraphByPosition(this.targetStartPosition).startLogPosition.value!=this.targetStartPosition||f.ListUtils.unsafeAnyOf(this.targetSubDocument.tables,(e=>e.getEndPosition()==this.targetStartPosition)))&&(this.targetModelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(this.targetSubDocument,this.targetStartPosition))),this.history.addAndRedo(new zt(this.targetModelManipulator,new gu(this.targetSubDocument,new on.FixedInterval(this.targetStartPosition,1)),!0,!0)),this.targetStartPosition++,this.currentTargetPosition++)}}getFontInfo(e){const t=this.targetDocumentModel.cache.fontInfoCache,r=t.getItemByName(e.name);return r||this.targetModelManipulator.modelManager.richOptions.fonts.getPermittedFont(t,e)}getColorModelInfo(e){return this.targetDocumentModel.cache.colorModelInfoCache.getItem(e)}getCharPropsBundle(e){return new pn(this.getMaskedCharacterProperties(e.maskedCharacterProperties),this.getCharacterStyle(e.characterStyle))}getMaskedParagraphPropertiesBundleFull(e){return new mn(this.getMaskedParagraphProperties(e.maskedParagraphProperties),this.getParagraphStyle(e.paragraphStyle),this.getParagraphListInfo(e),e.tabs.clone())}getMaskedCharacterProperties(e){const t=e.clone();return t.fontInfo&&(t.fontInfo=this.getFontInfo(t.fontInfo)),t.highlightColor=this.getColorModelInfo(t.highlightColor),t.textColor=this.getColorModelInfo(t.textColor),t.underlineColor=this.getColorModelInfo(t.underlineColor),t.strikeoutColor=this.getColorModelInfo(t.strikeoutColor),t}getMaskedParagraphProperties(e){const t=e.clone();return t.shadingInfo=this.targetDocumentModel.cache.shadingInfoCache.getItem(t.shadingInfo),t}getTableProperties(e){return e.clone()}getTableRowProperties(e){return e.clone()}getTableCellProperties(e){return e.clone()}getCharacterStyle(e){let t=this.targetDocumentModel.stylesManager.getCharacterStyleByName(e.styleName);return t||(this.options.enableCharacterStyleCreation?(t=e.clone(),this.targetDocumentModel.stylesManager.registerCharacterStyle(t),t.maskedCharacterProperties=this.getMaskedCharacterProperties(t.maskedCharacterProperties),t.parent&&(t.parent=this.getCharacterStyle(t.parent)),t.linkedStyle&&(t.linkedStyle=this.getParagraphStyle(t.linkedStyle)),t):this.targetDocumentModel.stylesManager.getDefaultCharacterStyle())}getParagraphStyle(e){let t=this.targetDocumentModel.stylesManager.getParagraphStyleByName(e.styleName);return t||(this.options.enableParagraphStyleCreation?(t=e.clone(),this.targetDocumentModel.stylesManager.registerParagraphStyle(t),t.maskedCharacterProperties=this.getMaskedCharacterProperties(t.maskedCharacterProperties),t.maskedParagraphProperties=this.getMaskedParagraphProperties(t.maskedParagraphProperties),t.parent&&(t.parent=this.getParagraphStyle(t.parent)),t.linkedStyle&&(t.linkedStyle=this.getCharacterStyle(t.linkedStyle)),t):this.targetDocumentModel.stylesManager.getDefaultParagraphStyle())}getTableStyle(e){let t=this.targetDocumentModel.stylesManager.getTableStyleByName(e.styleName);return t||(this.options.enableTableStyleCreation?(t=e.clone(),this.targetDocumentModel.stylesManager.registerTableStyle(t),t.baseConditionalStyle=this.getTableConditionalStyle(t.baseConditionalStyle),t.conditionalStyles=b.j.map(t.conditionalStyles,(e=>this.getTableConditionalStyle(e))),t.parent&&(t.parent=this.getTableStyle(t.parent)),t):this.targetDocumentModel.stylesManager.getDefaultTableStyle())}getTableConditionalStyle(e){const t=e.clone();return t.maskedCharacterProperties=this.getMaskedCharacterProperties(t.maskedCharacterProperties),t.maskedParagraphProperties=this.getMaskedParagraphProperties(t.maskedParagraphProperties),t.tableProperties=this.getTableProperties(t.tableProperties),t.tableRowProperties=this.getTableRowProperties(t.tableRowProperties),t.tableCellProperties=this.getTableCellProperties(t.tableCellProperties),t}getTableCellStyle(e){if(!e)return e;let t=this.targetDocumentModel.stylesManager.getTableCellStyleByName(e.styleName);return t||this.targetDocumentModel.stylesManager.getDefaultTableCellStyle()}getCacheImageInfo(e){let t=null;return t=e.isLoaded?this.targetModelManipulator.modelManager.clientMode?this.targetDocumentModel.cache.imageCache.createLoadedInfo(e.base64,e.size):this.targetDocumentModel.cache.imageCache.createUnloadedInfoByBase64(e.base64,e.size):e.imageUrl?this.targetDocumentModel.cache.imageCache.createUnloadedInfoByUrl(e.imageUrl):e.file?this.targetDocumentModel.cache.imageCache.createUnloadedInfoByFile(e.file):this.targetDocumentModel.cache.imageCache.createUnloadedInfoByBase64(e.base64),t.isLoaded||this.unloadedCacheImageInfo.push(t),t}getInlinePictureInfo(e){const t=e.clone();return t.size.cacheInfo=this.getCacheImageInfo(t.size.cacheInfo),t}getAnchorPictureInfo(e){const t=e.clone();return t.size.cacheInfo=this.getCacheImageInfo(t.size.cacheInfo),t}getParagraphListInfo(e){const t=new un(-1,e.listLevelIndex),r=e.getNumberingListIndex();if(r>=0)if(this.sameModel){const e=this.sourceDocumentModel.numberingLists[r];if(t.numberingListIndex=this.targetDocumentModel.getNumberingListIndexById(e.getId()),t.numberingListIndex<0){let r=this.targetDocumentModel.getAbstractNumberingListIndexById(this.sourceDocumentModel.abstractNumberingLists[e.abstractNumberingListIndex].getId());if(r<0){const t=new dn(this.targetDocumentModel);t.copyFrom(this.sourceDocumentModel.abstractNumberingLists[e.abstractNumberingListIndex]),t.resetId(),t.getId(),r=this.targetModelManipulator.numberingList.addAbstractNumberingList(t)}const i=new cn(this.targetDocumentModel,r);i.copyFrom(e),t.numberingListIndex=this.targetModelManipulator.numberingList.addNumberingList(i)}}else{let e=this.getListIndex(this.numberingListCache,this.targetDocumentModel.numberingLists,r);if(void 0!==e)t.numberingListIndex=e;else{const e=this.sourceDocumentModel.numberingLists[r],i=this.getAbstractNumberingListId(e.abstractNumberingListIndex),n=new cn(this.targetDocumentModel,i);n.copyFrom(e),n.resetId(),n.getId(),t.numberingListIndex=this.targetModelManipulator.numberingList.addNumberingList(n);const o=this.targetDocumentModel.numberingLists[t.numberingListIndex].getId();this.numberingListCache[o]=r}}if(t.numberingListIndex<0){const e=this.targetSubDocument.getParagraphByPosition(this.currentTargetPosition),r=e.getNumberingListIndex();r>=0&&this.targetStartPosition===e.startLogPosition.value&&(t.numberingListIndex=r,t.listLevelIndex=e.getListLevelIndex())}return t}getAbstractNumberingListId(e){let t=this.getListIndex(this.abstractNumberingListIndexesMap,this.targetDocumentModel.abstractNumberingLists,e);if(void 0!==t)return t;const r=new dn(this.targetDocumentModel);r.copyFrom(this.sourceDocumentModel.abstractNumberingLists[e]),r.resetId(),r.getId(),t=this.targetModelManipulator.numberingList.addAbstractNumberingList(r);const i=this.targetDocumentModel.abstractNumberingLists[t].getId();return this.abstractNumberingListIndexesMap[i]=e,t}getListIndex(e,t,r){const i=b.j.keyBy(e,(e=>e==r));return(0,S.isDefined)(i)?f.ListUtils.indexBy(t,(e=>e.getId()==i)):void 0}}class mb{get documentModel(){return this.subDocument.documentModel}constructor(e,t,r){this.newOffsetAtStartChunk=0,this.additionalParagraphRunPositions={},this.subDocument=e,this.numberingListCache=r,this.abstractNumberingListCache=t}copyStyles(e){e.characterStyles=f.ListUtils.deepCopy(this.documentModel.characterStyles),e.paragraphStyles=f.ListUtils.deepCopy(this.documentModel.paragraphStyles),e.numberingListStyles=f.ListUtils.deepCopy(this.documentModel.numberingListStyles),e.tableStyles=f.ListUtils.deepCopy(this.documentModel.tableStyles),e.tableCellStyles=f.ListUtils.deepCopy(this.documentModel.tableCellStyles)}execute(e){const t=this.initNewDocumentModel(),r=t.mainSubDocument;if(this.copyStyles(t),f.ListUtils.allOf(e,(e=>0==e.length)))throw new Error(R.D.InternalException);let i=0;for(let r of e)this.copyMainContent(r,t,i),i+=r.length;du.copyBookmarksFromSubDocumentTo(this.subDocument,r,e),r.getLastChunk().isLast=!0,this.copyTables(r,e);const n=this.tryAppendAdditionalParagraphRunInTheEnd(r,!1);return new fb(t,n,this.abstractNumberingListCache,this.numberingListCache)}copyMainContent(e,t,r){const i=t.mainSubDocument,n=this.subDocument.getConstRunIterator(e);for(this.oldFieldStartIndex=-1;n.moveNext();){var o=n.currentRun;if(this.oldCurrentSection!=n.currentSection&&(this.oldCurrentSection=n.currentSection,this.newCurrentSection=this.appendNewSection(i)),this.oldCurrentParagraph!=o.paragraph&&(this.oldCurrentParagraph=o.paragraph,this.newCurrentParagraph=this.appendNewParagraph(i)),this.oldCurrentChunk!=n.currentChunk&&(this.oldCurrentChunk=n.currentChunk,this.newCurrentChunk=this.appendNewChunk(i),this.newOffsetAtStartChunk=0),this.newCurrentParagraph.length+=o.getLength(),this.newCurrentSection.setLength(i,this.newCurrentSection.getLength()+o.getLength()),this.newCurrentChunk.textBuffer+=this.oldCurrentChunk.getTextInChunk(o.startOffset,o.getLength()),o.getType()==cs.FieldCodeStartRun)this.appendField(i,o,e.start-r);else if(o.getType()==cs.AnchoredTextBoxRun){const e=this.documentModel.subDocuments[o.subDocId].clone(t),r=this.documentModel.subDocuments[o.subDocId].paragraphs;f.ListUtils.forEach(e.paragraphs,((t,i)=>{t.numberingListIndex=mb.getNewNumberingListIndex(this.documentModel,r[i].numberingListIndex,e,this.abstractNumberingListCache,this.numberingListCache)}))}this.newCurrentChunk.textRuns.push(o.createSimularity(this.newOffsetAtStartChunk,o.getLength(),this.newCurrentParagraph,t.stylesManager.addCharacterStyle(o.characterStyle),t.cache.maskedCharacterPropertiesCache.getItem(o.maskedCharacterProperties))),this.newOffsetAtStartChunk+=o.getLength()}}appendField(e,t,r){let i=this.oldFieldStartIndex;const n=this.subDocument;if(i<0){const e=this.oldCurrentChunk.startLogPosition.value+t.startOffset;i=Md.normedBinaryIndexOf(n.fields,e+1)}else i++;const o=n.fields[i],a=new Md(e.positionManager,e.fields.length,o.getFieldStartPosition()-r,o.getSeparatorPosition()-r,o.getFieldEndPosition()-r,o.showCode,o.getHyperlinkInfo()?o.getHyperlinkInfo().clone():void 0);e.fields.push(a),a.initParent(e.fields),this.oldFieldStartIndex=i}appendParagraphMarkInTheEnd(e,t,r){this.newCurrentParagraph.length+=1,this.newCurrentSection.setLength(e,this.newCurrentSection.getLength()+1);let i=r?an.specialCharacters.SectionMark:an.specialCharacters.ParagraphMark,n=r?Ll:Bl;this.newCurrentChunk.textBuffer+=i,this.newCurrentChunk.textRuns.push(new n(t,this.newCurrentParagraph,new pn(e.getLastRun().maskedCharacterProperties,e.getLastRun().characterStyle))),this.newOffsetAtStartChunk++}appendNewChunk(e){let t=e.chunks.length?e.getLastChunk().getEndPosition():0,r=e.positionManager.registerPosition(t),i=new mo(r,"",!1);return e.chunks.push(i),i}appendNewSection(e){this.tryAppendAdditionalParagraphRunInTheEnd(e,!0);let t=e.documentModel.sections[e.documentModel.sections.length-1],r=t?t.getEndPosition():0,i=e.positionManager.registerPosition(r),n=new Ch(e.documentModel,i,0,this.oldCurrentSection.sectionProperties.clone());return e.documentModel.sections.push(n),n}copyToCore(e,t,r){e.maskedCharacterProperties=t.maskedCharacterProperties.clone(),e.maskedParagraphProperties=t.maskedParagraphProperties.clone(),e.tabs=t.tabs.clone(),t.isInOwnList()?e.numberingListIndex=mb.getNewNumberingListIndex(this.documentModel,t.numberingListIndex,r,this.abstractNumberingListCache,this.numberingListCache):t.numberingListIndex==dn.NoNumberingListIndex&&(e.numberingListIndex=dn.NoNumberingListIndex)}copyPropertiesTo(e,t,r){this.copyToCore(e,t,r),t.parent&&(e.parent=r.documentModel.stylesManager.addParagraphStyle(e.parent),this.copyPropertiesTo(e.parent,t.parent,r)),null!=t.nextParagraphStyle&&(e.nextParagraphStyle=r.documentModel.stylesManager.addParagraphStyle(e.nextParagraphStyle))}appendNewParagraph(e){this.tryAppendAdditionalParagraphRunInTheEnd(e,!1);const t=this.oldCurrentParagraph,r=t.subDocument.documentModel,i=e.paragraphs[e.paragraphs.length-1],n=i?i.getEndPosition():0,o=e.positionManager.registerPosition(n),a=e.documentModel.stylesManager.addParagraphStyle(t.paragraphStyle);this.copyPropertiesTo(a,t.paragraphStyle,e);const s=e.documentModel.cache.maskedParagraphPropertiesCache.getItem(t.maskedParagraphProperties),l=new ns(e,o,0,a,s);return l.listLevelIndex=t.listLevelIndex,l.numberingListIndex=mb.getNewNumberingListIndex(r,t.numberingListIndex,e,this.abstractNumberingListCache,this.numberingListCache),l.tabs=t.tabs.clone(),e.paragraphs.push(l),l}static getNewNumberingListIndex(e,t,r,i={},n={}){let o=-1,a=-1;if(t>=0){const s=e.numberingLists[t];if(o=n[s.getId()],void 0===o){const t=e.abstractNumberingLists[s.abstractNumberingListIndex];if(a=i[t.getId()],void 0===a){const e=new dn(r.documentModel);e.copyFrom(t),a=r.documentModel.abstractNumberingLists.push(e)-1,i[t.getId()]=a}const l=new cn(r.documentModel,a);l.copyFrom(s),o=r.documentModel.numberingLists.push(l)-1,n[s.getId()]=o}}return o}tryAppendAdditionalParagraphRunInTheEnd(e,t){let r=e.getLastChunk();if(!r)return!1;let i=r.textRuns[r.textRuns.length-1];return!!i&&(!i.isParagraphOrSectionRun()&&(this.appendParagraphMarkInTheEnd(e,i.startOffset+i.getLength(),t),this.additionalParagraphRunPositions[r.getEndPosition()-1]=!0,!0))}initNewDocumentModel(){const e=new cm(this.documentModel.modelOptions,0);return e.defaultCharacterProperties=e.cache.maskedCharacterPropertiesCache.getItem(this.documentModel.defaultCharacterProperties),e.defaultParagraphProperties=e.cache.maskedParagraphPropertiesCache.getItem(this.documentModel.defaultParagraphProperties),e.defaultTableProperties=this.documentModel.defaultTableProperties.clone(),e.defaultTableRowProperties=e.cache.tableRowPropertiesCache.getItem(this.documentModel.defaultTableRowProperties),e.defaultTableCellProperties=e.cache.tableCellPropertiesCache.getItem(this.documentModel.defaultTableCellProperties),e.colorProvider.officeTheme.copyFrom(this.documentModel.colorProvider.officeTheme),e.cache.imageCache=this.documentModel.cache.imageCache,e}getNestedLevel(e,t,r){if(t.nestedLevel>r)return r+1;if(!t.parentCell)return 0;const i=this.mapSourceTableIndexToTarget[t.getParentTable().index];return(0,S.isDefined)(i)?e.tables[i].nestedLevel+1:-1}copyTables(e,t){const r=this.subDocument.tables;if(this.mapSourceTableIndexToTarget=(new Eu).get(),!r.length)return;const i=t[0].start;let n=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(r,(e=>e.getStartPosition()),i));n=Ja.correctBoundTable(r,n,i,(e=>--e)).index;let o=-1,a=t[0].end,s=0;for(let r,i=n;r=this.subDocument.tables[i];i++){r.nestedLevel!=o&&(o=this.getNestedLevel(e,r,o));const i=r.getStartPosition(),n=r.interval;for(;t.length>0&&i>=t[0].end;)this.additionalParagraphRunPositions[t[0].end]&&s++,s+=t[0].length,t.shift();if(!t.length)break;if(nn.IntervalAlgorithms.getIntersectionNonNullLength(r.interval,t[0]))if(t[0].containsInterval(n))this.appendWholeTable(e,r,t[0].start-s,o);else{let i=this.getSelectedCells(r,t.slice(0),s);this.canCopyParticallyTable(i)?this.appendParticallyTable(e,i,o):o=-1}else if(i>=a)break}}appendWholeTable(e,t,r,i){let n=this.createTable(e,t,i,r);n.preferredWidth=t.preferredWidth.clone(),n.lookTypes=t.lookTypes;for(let i,o=0;i=t.rows[o];o++){let t=new Ld(n,e.documentModel.cache.tableRowPropertiesCache.getItem(i.properties.clone()));n.rows.push(t),t.height=i.height.clone(),i.tablePropertiesException&&(t.tablePropertiesException=i.tablePropertiesException.clone()),t.gridBefore=i.gridBefore,t.gridAfter=i.gridAfter,t.widthAfter=i.widthAfter.clone(),t.widthBefore=i.widthBefore.clone();for(let n,o=0;n=i.cells[o];o++){let i=this.cloneTableCell(e,t,n);i.verticalMerging=n.verticalMerging,i.startParagraphPosition=e.positionManager.registerPosition(n.startParagraphPosition.value-r),i.endParagrapPosition=e.positionManager.registerPosition(n.endParagrapPosition.value-r),t.cells.push(i)}}}appendParticallyTable(e,t,r){let i=Number.MAX_VALUE,n=0,o=t[0][0].cell.parentRow.parentTable;for(let e,r=0;e=t[r];r++){let t=oc.getStartColumnIndex(e[0].cell),r=oc.getEndColumnIndex(e[e.length-1].cell);i=Math.min(i,t),n=Math.max(n,r)}let a=t[0][0].cell.startParagraphPosition.value-t[0][0].positionDelta,s=this.createTable(e,o,r,a);s.preferredWidth=lr.create(0,Je.Auto);for(let r,o=0;r=t[o];o++){let t=oc.getStartColumnIndex(r[0].cell),o=oc.getEndColumnIndex(r[r.length-1].cell),a=r[0].cell.parentRow,l=new Ld(s,e.documentModel.cache.tableRowPropertiesCache.getItem(a.properties.clone()));s.rows.push(l),l.height=a.height.clone(),l.gridBefore=t-i,l.gridAfter=n-o;for(let t,i=0;t=r[i];i++){let r=this.cloneTableCell(e,l,t.cell);r.startParagraphPosition=e.positionManager.registerPosition(t.cell.startParagraphPosition.value-t.positionDelta),r.endParagrapPosition=e.positionManager.registerPosition(t.cell.endParagrapPosition.value-t.positionDelta),l.cells.push(r)}}rb.normalizeCellColumnSpansWithoutHistory(s,!0)}canCopyParticallyTable(e){if(0===e.length)return!1;let t=e[0][0].cell.parentRow.getEndPosition(),r=oc.getStartColumnIndex(e[0][0].cell),i=oc.getEndColumnIndex(e[0][e[0].length-1].cell);for(let n,o=0;n=e[o];o++){let e=n[0].cell.endParagrapPosition.value;for(let t,r=1;t=n[r];r++){if(t.cell.startParagraphPosition.value!==e)return!1;e=t.cell.endParagrapPosition.value}if(o>0){if(n[0].cell.parentRow.getStartPosition()!==t)return!1;let e=oc.getStartColumnIndex(n[0].cell);if(oc.getEndColumnIndex(n[n.length-1].cell)<r||e>i)return!1;t=n[0].cell.parentRow.getEndPosition()}}return!0}cloneTableCell(e,t,r){let i=new Rd(t,e.documentModel.cache.tableCellPropertiesCache.getItem(r.properties.clone()));return i.columnSpan=r.columnSpan,i.conditionalFormatting=r.conditionalFormatting,i.preferredWidth=r.preferredWidth.clone(),i.style=r.style,i}createTable(e,t,r,i){let n=e.documentModel.stylesManager.addTableStyle(t.style),o=new Ja(t.properties.clone(),n);if(o.nestedLevel=r,r>0){let r=t.getStartPosition()-i;o.parentCell=Ja.getTableCellByPosition(e.tables,r)}return o.index=e.tables.push(o)-1,this.mapSourceTableIndexToTarget[t.index]=o.index,(e.tablesByLevels[r]||(e.tablesByLevels[r]=[])).push(o),o}getSelectedCells(e,t,r){let i=0,n=t.length-1,o=[];for(let a,s=0;a=e.rows[s];s++){let e=[];for(let o,s=0;o=a.cells[s];s++){for(;i<=n&&t[i].end<o.endParagrapPosition.value;)this.additionalParagraphRunPositions[t[i].end]&&r++,r+=t[i].length,i++;if(i>n)break;t[i].containsInterval(o.interval)&&e.push(new bb(o,t[i].start-r))}if(e.length&&o.push(e),i>n)break}return o}}class fb{constructor(e,t,r={},i={},n){this.model=e,this.addedUselessParagraphMarkInEnd=t,this.abstractNumberingListCache=r,this.numberingListCache=i,this.pictureSizeUpdater=n}insertTo(e,t,r=!1){const i=new on.FixedInterval(0,this.model.mainSubDocument.getDocumentEndPosition()-(this.addedUselessParagraphMarkInEnd?1:0)),n=new pb;return n.overlapTableCellContent=r,n.abstractNumberingListCache=this.abstractNumberingListCache,n.numberingListCache=this.numberingListCache,n.pictureSizeUpdater=this.pictureSizeUpdater,e.subDocument.insertSubDocument(t,new gu(this.model.mainSubDocument,i),n).insetedInterval}insertToTable(e,t,r){const i=this.model.mainSubDocument.tables[0];return i?this.overlapTableContent(e,i,r):this.insertTo(e,t)}overlapTableContent(e,t,r){let i=r.rawData.firstCellInfo.cellIndex,n=r.rawData.lastCellInfo.cellIndex,o=r.rawData.firstRowInfo.rowIndex,a=r.rawData.lastRowInfo.rowIndex;i==n&&(n=i+t.rows[0].cells.length-1,o==a&&(a=o+t.rows.length-1));for(let s=o;s<=a;s++)for(let o=i;o<=n;o++){if(s>=r.table.rows.length)return r.table.interval;this.overlapTableCellContent(e,t,r,s,o)}return r.table.interval}overlapTableCellContent(e,t,r,i,n){const o=r.table.rows[i].cells[n];if(!o)return;const a=(i-r.rawData.firstRowInfo.rowIndex)%t.rows.length,s=(n-r.rawData.firstCellInfo.cellIndex)%t.rows[a].cells.length,l=t.rows[a].cells[s],d=new mb(this.model.mainSubDocument,this.abstractNumberingListCache,this.numberingListCache).execute([l.interval]);e.range.removeInterval(new gu(e.model.mainSubDocument,o.interval),!1,!0),d.insertTo(e,new pu(e.model.mainSubDocument,o.interval.start),!0)}static create(e){return new mb(e.subDocument,{},{}).execute(e.intervals)}}class bb{constructor(e,t){this.cell=e,this.positionDelta=t}}class Cb extends Ze{constructor(e,t,r){super(e),this.subDocument=t,this.fieldIndex=r.index,this.startPos=r.getFieldStartPosition(),this.separatorPos=r.getSeparatorPosition(),this.endPos=r.getFieldEndPosition(),this.hyperlinkInfo=r.getHyperlinkInfo().clone()}redo(){const e=on.FixedInterval.fromPositions(this.separatorPos+1,this.endPos-1);if(!this.styleHistory){const t=this.modelManipulator.model.getCharacterStyleByName(zl.defaultParagraphCharacterStyleName);this.styleHistory=new kp(this.modelManipulator,new gu(this.subDocument,e),t,!1)}this.styleHistory.redo();const t=e.length?fb.create(new mu(this.subDocument,[e])):null,r=on.FixedInterval.fromPositions(this.startPos,this.endPos);this.removeOperationResult=this.modelManipulator.range.removeIntervalInner(this.subDocument,r,!1),t&&t.insertTo(this.modelManipulator,new pu(this.subDocument,this.startPos))}undo(){this.modelManipulator.range.restoreRemovedInterval(this.subDocument,this.removeOperationResult),this.styleHistory.undo()}}class Sb{constructor(e,t=()=>{},r=new $g){this.subDocsInfo=e,this.callback=t||(()=>{}),this.updateOptions=r}}class Ib{constructor(e){this.subDocsInfo=e}}class Pb{constructor(e,t){this.subDocument=e,this.requestId=t,this.result=null}}class wb extends lu{constructor(){super(...arguments),this.currentlyUpdatedSubDocumentsInfo={},this.requestId=0}setHyperlinkInfoViaHistory(e,t,r){this.history.addAndRedo(new hp(this.modelManipulator,e,t,r))}setHyperlinkInfoInner(e,t,r){const i=e.fields[t],n=i.getHyperlinkInfo();return i.setNewHyperlinkInfo(r),this.modelManipulator.notifyModelChanged(new vm(e.id,i.getResultInterval(),i.getCodeInterval(),r)),n}setHyperlinkInfoWithReplaceResultAndCode(e,t,r,i){const n=e.fields[t],o=(new ju).setIntervals(tp.fromPosition(e,n.getCodeInterval().start)),a=xd.getNewCodeText(r);this.history.addTransaction((()=>{this.modelManipulator.range.removeInterval(new gu(e,n.getCodeInterval()),!0,!1);let s=new op(new pu(e,n.getCodeInterval().start),o.charPropsBundle,cs.TextRun,a);if(this.modelManipulator.text.insertTextViaHistory(s),i){this.modelManipulator.range.removeInterval(new gu(e,n.getResultInterval()),!0,!1);const t=new op(new pu(e,n.getResultInterval().start),o.charPropsBundle,cs.TextRun,i);this.modelManipulator.text.insertTextViaHistory(t),this.history.addAndRedo(new Up(this.modelManipulator,new gu(e,n.getResultInterval())))}this.setHyperlinkInfoViaHistory(e,t,r)}))}setAllFieldsShowCode(e,t){for(let r of t){const t=r.fields;let i=null;for(let r,n=0;r=t[n];n++)r.showCode!=e&&(r.showCode=e,null===i&&(i=n));null!==i&&this.modelManipulator.notifyModelChanged(new Tm(r.id,on.FixedInterval.fromPositions(t[i].getFieldStartPosition(),t[t.length-1].getFieldEndPosition())))}}setFieldShowCode(e,t,r){t.showCode!=r&&(t.showCode=r,this.modelManipulator.notifyModelChanged(new Tm(e.id,t.getAllFieldInterval())))}continueUpdateFields(e,t){var r=e.subDocuments[t[qs.SubDocumentId]];r&&r.fieldsWaitingForUpdate&&r.fieldsWaitingForUpdate.update(t[qs.Info])}updateFields(e,t,r){if(f.ListUtils.unsafeAnyOf(r.subDocsInfo,(e=>!!this.currentlyUpdatedSubDocumentsInfo[e.subDocument.id])))return r.callback(new Ib([])),!1;const i=f.ListUtils.reducedMap(r.subDocsInfo,(e=>e.subDocument.fields.length>0?e:null));if(!i.length)return r.callback(new Ib([])),!0;const n=this.requestId++;for(let e of i)this.currentlyUpdatedSubDocumentsInfo[e.subDocument.id]=new Pb(e.subDocument,n);this.modelManipulator.modelManager.history.beginTransaction();const o=i.length-1;for(let a,s=0;a=i[s];s++)a.subDocument.fieldsWaitingForUpdate=new Jg(this.modelManipulator.modelManager,e,t,a,r.updateOptions,(e=>{e.subDocIntervals.subDocument.fieldsWaitingForUpdate=null,this.currentlyUpdatedSubDocumentsInfo[e.subDocIntervals.subDocument.id].result=e.subDocIntervals,this.allSubDocsByRequestUpdated(n)&&(this.modelManipulator.modelManager.history.endTransaction(),r.callback(this.collectResult(n)))})),a.subDocument.fieldsWaitingForUpdate.update(null,s==o);return!0}get isBusy(){return b.j.isEmpty(this.currentlyUpdatedSubDocumentsInfo)}allSubDocsByRequestUpdated(e){return b.j.allOf(this.currentlyUpdatedSubDocumentsInfo,(t=>t.requestId!=e||!!t.result))}collectResult(e){const t=new Ib([]),r={};return b.j.forEach(this.currentlyUpdatedSubDocumentsInfo,((i,n)=>{i.requestId==e?t.subDocsInfo.push(i.result):r[n]=i})),this.currentlyUpdatedSubDocumentsInfo=r,t}removeHyperlink(e,t){t&&t.isHyperlinkField()&&(this.history.beginTransaction(),this.history.addAndRedo(new Cb(this.modelManipulator,e,t)),this.history.endTransaction())}changeHyperlinkInfo(e,t,r,i){if(!t||!t.isHyperlinkField())return!1;const n=xd.getNewCodeText(r),o=t.getCodeInterval();return this.history.addTransaction((()=>{o.length&&this.modelManipulator.range.removeInterval(new gu(e,o),!0,!1);const a=(new ju).setIntervals(tp.fromPosition(e,o.start));if(this.modelManipulator.text.insertTextViaHistory(new op(new pu(e,o.start),a.charPropsBundle,cs.TextRun,n)),i){const r=t.getResultInterval();r.length&&this.modelManipulator.range.removeInterval(new gu(e,r),!0,!1),a.setIntervals(tp.fromPosition(e,r.start)),this.modelManipulator.text.insertTextViaHistory(new op(new pu(e,r.start),a.charPropsBundle,cs.TextRun,i)),this.history.addAndRedo(new Up(this.modelManipulator,new gu(e,t.getResultInterval())))}this.history.addAndRedo(new hp(this.modelManipulator,e,t.index,r))})),!0}}class yb{static getHyperlinkResultText(e,t){var r="",i=new jh(e,!0);i.setPosition(t.getResultStartPosition());var n=t.index,o=e.fields;do{if(i.getAbsolutePosition()>=t.getResultEndPosition())break;switch(i.run.getType()){case cs.FieldCodeStartRun:n++,i.setPosition(o[n].getResultStartPosition());continue;case cs.FieldResultEndRun:i.setPosition(o[n].getFieldEndPosition());continue;case cs.TextRun:r+=i.chunk.getRunText(i.run)}}while(i.moveToNextRun());return r}static canChangeHyperlinkDisplayText(e){var t=new jh(e.subDocument,!1);t.setPosition(e.interval.start);do{if(t.getAbsolutePosition()>=e.interval.end)break;const r=t.run.getType();if(r==cs.InlinePictureRun||r==cs.AnchoredPictureRun||r==cs.AnchoredTextBoxRun||r==cs.InlineTextBoxRun)return!1}while(t.moveToNextRun());return!0}static showUpdateAndToogleCodeItems(e,t){if(0==e.length)return!1;for(var r,i=0;r=t[i];i++){var n=r.end,o=Math.max(0,Md.normedBinaryIndexOf(e,r.start+1)),a=e[o].getAbsolutelyTopLevelField(),s=a;for(o=a.index;a=e[o];o++)if(!(a.showCode?a.getSeparatorPosition()<r.start:a.getResultEndPosition()<r.start)){if(a.showCode?a.getFieldStartPosition()>=n:a.getResultStartPosition()>n)break;return!0}if(s.getFieldStartPosition()==r.start)return!0}return!1}static showCreateHyperlinkItem(e,t){if(0==e.length)return!0;var r=t.end,i=Math.max(0,Md.normedBinaryIndexOf(e,t.start+1)),n=e[i].getAbsolutelyTopLevelField();for(i=n.index;(n=e[i])&&!(n.getFieldStartPosition()>=r);i++)if(!(n.getFieldEndPosition()<=t.start))return!1;return!0}static showHyperlinkItems(e,t){return this.getHyperlinkFieldCore(e,t,(e=>e.getAllFieldInterval()))}static getHyperlinkField(e,t){return this.getHyperlinkFieldCore(e,t,(e=>e.getAllFieldIntervalWithoutBorders()))}static getHyperlinkFieldCore(e,t,r){if(0==e.length)return null;var i=e[Math.max(0,Md.normedBinaryIndexOf(e,t.start+1))];if(0==t.length){do{if(r(i).containsWithIntervalEnd(t.start))return i.isHyperlinkField()?i:null;i=i.parent}while(i);return null}if(nn.IntervalAlgorithms.getIntersection(r(i),t))return yb.getFinalResult(e,t,i);var n=i.parent;return n?nn.IntervalAlgorithms.getIntersection(r(n),t)?yb.getFinalResult(e,t,n):(i=yb.getNextTopLevelField(e,i.index))&&nn.IntervalAlgorithms.getIntersection(r(i),t)?yb.getFinalResult(e,t,i):null:t.start<=i.getFieldStartPosition()?null:(i=yb.getNextTopLevelField(e,i.index))&&nn.IntervalAlgorithms.getIntersection(r(i),t)?yb.getFinalResult(e,t,i):null}static getNextTopLevelField(e,t){var r;for(t++;(r=e[t])&&r.parent;t++);return r}static getFinalResult(e,t,r){if(!r)return null;if(!r.isHyperlinkField())return null;var i=yb.getNextTopLevelField(e,r.index);return i&&i.getCodeStartPosition()<=t.end?null:r}}class xb{get end(){return this.start+this.length}constructor(e,t){this.start=e,this.length=Math.max(0,t)}}function Tb(e){return new xb(e.start,e.length)}function vb(e){return new on.FixedInterval(e.start,e.length)}class Mb{constructor(e=!1,t,r){this.imageLoadedEvent=[],this.calculateActualSize=e,this.actualSize=t,r&&this.imageLoadedEvent.push(r)}static initByActualSize(e,t){return e=e&&e.width&&e.height?e:void 0,new Mb(!e,e,t)}}class Eb{constructor(e,t,r,i,n){this.modelManager=e,this.newParProps=r,this.inputPosition=t,this.modelManip=this.modelManager.modelManipulator,this.subDoc=i,this.intervals=n}apply(){const e=this.modelManager.history;this.parPropsFull=this.inputPosition.getMergedParagraphPropertiesFull(),this.parPropsRaw=this.inputPosition.getMergedParagraphPropertiesRaw(),this.oldParPropsRaw=this.parPropsRaw.clone();const t=this.subDoc.getParagraphIndicesByIntervals(this.intervals);let r=0;return e.beginTransaction(),f.ListUtils.reverseForEach(t,(e=>{const t=this.subDoc.paragraphs[e],i=this.subDoc.paragraphs[e].interval;this.oldParPropsRaw=t.getParagraphMergedProperties().clone(),r|=this.applyProp(i,Ft.firstLineIndentType),r|=this.applyProp(i,Ft.firstLineIndent),r|=this.applyProp(i,Ft.widowOrphanControl),r|=this.applyProp(i,Ft.afterAutoSpacing),r|=this.applyProp(i,Ft.outlineLevel),r|=this.applyProp(i,Ft.beforeAutoSpacing),r|=this.applyProp(i,Ft.pageBreakBefore),r|=this.applyProp(i,Ft.rightIndent),r|=this.applyProp(i,Ft.suppressHyphenation),r|=this.applyProp(i,Ft.suppressLineNumbers),r|=this.applyProp(i,Ft.keepLinesTogether),r|=this.applyProp(i,Ft.keepWithNext),r|=this.applyProp(i,Ft.shadingInfo),r|=this.applyProp(i,Ft.leftIndent),r|=this.applyProp(i,Ft.lineSpacingType),r|=this.applyProp(i,Ft.lineSpacing),r|=this.applyProp(i,Ft.alignment),r|=this.applyProp(i,Ft.contextualSpacing),r|=this.applyProp(i,Ft.spacingBefore),r|=this.applyProp(i,Ft.spacingAfter),r|=this.applyProp(i,Ft.divId)})),e.endTransaction(),!!r}applyProp(e,t){const r=t.getProp(this.newParProps),i=t.getProp(this.oldParPropsRaw);return void 0!==r&&r!==i?(t.setProp(this.parPropsFull,r),t.setProp(this.parPropsRaw,r),this.modelManager.history.addAndRedo(new(t.getHistoryItemConstructor())(this.modelManip,new gu(this.subDoc,e),r,!0)),1):0}}var Db,Fb,Rb,Lb=__webpack_require__(1772);class Bb{constructor(){this.copy=Db.Default,this.createNew=Db.Default,this.cut=Db.Default,this.drag=Db.Default,this.drop=Db.Default,this.open=Db.Default,this.paste=Db.Default,this.printing=Db.Default,this.save=Db.Default,this.saveAs=Db.Default,this.download=Db.Default,this.fullScreen=Db.Default,this.tabMarker=an.specialCharacters.TabMark,this.pageBreakInsertMode=Fb.NewLine,this.characterFormatting=Db.Default,this.characterStyle=Db.Default,this.fields=Db.Default,this.hyperlinks=Db.Default,this.inlinePictures=Db.Default,this.paragraphFormatting=Db.Default,this.paragraphs=Db.Default,this.paragraphStyle=Db.Default,this.paragraphTabs=Db.Default,this.sections=Db.Default,this.tabSymbol=Db.Default,this.undo=Db.Default,this.bookmarks=Db.Default,this.numberingBulleted=Db.Default,this.numberingMultiLevel=Db.Default,this.numberingSimple=Db.Default,this.headersFooters=Db.Default,this.tables=Db.Default,this.tableStyle=Db.Default,this.floatingObjects=Db.Default,this.acceptsTab=!0,this.raiseClientEventsOnModificationsViaAPI=!0}static isEnabled(e){return e===Db.Default||e===Db.Enabled}static isVisible(e){return e!==Db.Hidden}clone(){const e=new Bb;return e.copy=this.copy,e.createNew=this.createNew,e.cut=this.cut,e.drag=this.drag,e.drop=this.drop,e.open=this.open,e.paste=this.paste,e.printing=this.printing,e.save=this.save,e.saveAs=this.saveAs,e.download=this.download,e.fullScreen=this.fullScreen,e.tabMarker=this.tabMarker,e.pageBreakInsertMode=this.pageBreakInsertMode,e.characterFormatting=this.characterFormatting,e.characterStyle=this.characterStyle,e.fields=this.fields,e.hyperlinks=this.hyperlinks,e.inlinePictures=this.inlinePictures,e.paragraphFormatting=this.paragraphFormatting,e.paragraphs=this.paragraphs,e.paragraphStyle=this.paragraphStyle,e.paragraphTabs=this.paragraphTabs,e.sections=this.sections,e.tabSymbol=this.tabSymbol,e.undo=this.undo,e.bookmarks=this.bookmarks,e.numberingBulleted=this.numberingBulleted,e.numberingMultiLevel=this.numberingMultiLevel,e.numberingSimple=this.numberingSimple,e.headersFooters=this.headersFooters,e.tables=this.tables,e.tableStyle=this.tableStyle,e.floatingObjects=this.floatingObjects,e.acceptsTab=this.acceptsTab,e.raiseClientEventsOnModificationsViaAPI=this.raiseClientEventsOnModificationsViaAPI,e}}!function(e){e[e.Default=0]="Default",e[e.Disabled=1]="Disabled",e[e.Enabled=2]="Enabled",e[e.Hidden=3]="Hidden"}(Db||(Db={})),function(e){e[e.NewLine=0]="NewLine",e[e.CurrentLine=1]="CurrentLine"}(Fb||(Fb={}));class Ab{constructor(e){this.historyItems=[],this.currentIndex=-1,this.transaction=null,this.incrementalId=-1,this.transactionLevel=-1,this.unmodifiedIndex=-1,this.isProcessingUndo=!1,this.currTransactionId=0,this.transactionMap={},this.options=e}isModified(){if(this.unmodifiedIndex==this.currentIndex)return!1;for(var e=Math.min(this.unmodifiedIndex,this.currentIndex),t=Math.max(this.unmodifiedIndex,this.currentIndex),r=e+1;r<=t;r++)if(this.historyItems[r].changeModified())return!0;return!1}undo(){this.canUndo()&&(this.isProcessingUndo=!0,this.historyItems[this.currentIndex].undo(),this.currentIndex--,this.isProcessingUndo=!1)}redo(){this.canRedo()&&(this.currentIndex++,this.historyItems[this.currentIndex].redo())}canUndo(){return this.currentIndex>=0&&Bb.isEnabled(this.options.undo)}canRedo(){return this.currentIndex<this.historyItems.length-1&&Bb.isEnabled(this.options.undo)}beginTransaction(){this.transactionLevel++,0==this.transactionLevel&&(this.transaction=new et);const e=this.currTransactionId++;return this.transactionMap[e]=this.transaction,e}addTransaction(e,t=!1){this.beginTransaction(),e(this),this.endTransaction(t)}endTransaction(e=!1){if(--this.transactionLevel>=0)return;const t=this.transaction.historyItems.length;t>1?this.addInternal(this.transaction,e):1==t&&this.addInternal(this.transaction.historyItems.pop(),e),this.transaction=null}addAndRedo(e,t=!1){this.add(e,t),e.redo()}add(e,t=!1){this.transactionLevel>=0?this.transaction.add(e):this.addInternal(e,t)}addInternal(e,t){if(this.isProcessingUndo){if(t)return;throw new Error("Add new item is not allowed while undo operation in process.")}this.currentIndex<this.historyItems.length-1&&(this.historyItems.splice(this.currentIndex+1),this.unmodifiedIndex=Math.min(this.unmodifiedIndex,this.currentIndex)),this.historyItems.push(e),this.currentIndex++,this.deleteOldItems()}deleteOldItems(){const e=this.historyItems.length-Ab.MAX_HISTORY_ITEM_COUNT;e>0&&this.currentIndex>e&&(this.historyItems.splice(0,e),this.currentIndex-=e)}getNextId(){return this.incrementalId++,this.incrementalId}clear(){this.currentIndex=-1,this.unmodifiedIndex=-1,this.incrementalId=-1,this.historyItems=[]}resetModified(){this.unmodifiedIndex=this.currentIndex}getCurrentItemId(){if(-1==this.currentIndex)return-1;var e=this.historyItems[this.currentIndex];return-1==e.uniqueId&&(e.uniqueId=this.getNextId()),e.uniqueId}}Ab.MAX_HISTORY_ITEM_COUNT=100;class Nb{constructor(){this.listeners=[]}clear(){f.ListUtils.clear(this.listeners)}add(e){f.ListUtils.unsafeAnyOf(this.listeners,(t=>t===e))||this.listeners.push(e)}remove(e){for(let t,r=0;t=this.listeners[r];r++)if(t===e){this.listeners.splice(r,1);break}}dispose(){const e=this.listeners;this.listeners=[],e.forEach((e=>{var t;return null===(t=e.dispose)||void 0===t?void 0:t.call(e)}))}}class kb{constructor(e,t,r){this.subDocumentId=e,this.property=t,this.newState=r,this.type=pd.CharacterFormattingChanged}}class Ob{constructor(e,t){this.subDocumentId=e,this.newState=t,this.type=pd.CharacterPropertiesChanged}}class _b extends lu{constructor(e){super(e),this.fontBold=new Hb(e,ir.bold),this.fontItalic=new Hb(e,ir.italic),this.fontName=new Hb(e,ir.fontInfo),this.fontSize=new Hb(e,ir.size),this.fontCaps=new Hb(e,ir.allCaps),this.fontStrikeoutType=new Hb(e,ir.strikeoutType),this.fontStrikeoutWordsOnly=new Hb(e,ir.strikeoutWordsOnly),this.fontUnderlineType=new Hb(e,ir.underlineType),this.fontHidden=new Hb(e,ir.hidden),this.script=new Hb(e,ir.script),this.fontUnderlineWordsOnly=new Hb(e,ir.underlineWordsOnly),this.fontNoProof=new Hb(e,ir.noProof),this.langInfo=new Hb(e,ir.langInfo),this.compositeFontInfo=new Hb(e,ir.compositeFontInfo),this.textColor=new Hb(e,ir.textColor),this.shadingInfo=new Hb(e,ir.shadingInfo),this.fontHighlightColor=new Hb(e,ir.highlightColor),this.fontStrikeoutColor=new Hb(e,ir.strikeoutColor),this.fontUnderlineColor=new Hb(e,ir.underlineColor),this.fontSmallCaps=new Hb(e,ir.smallCaps),this.useValue=new Ub(e),this.modelManipulator=e}resetCharacterFormatting(e,t){this.history.addAndRedo(new Nt(this.modelManipulator,new gu(e,t),Pe.createDefault(this.model))),this.history.addAndRedo(new kp(this.modelManipulator,new gu(e,t),this.model.getDefaultCharacterStyle(),!0))}setValue(e,t,r){var i=new If;if(!Bb.isEnabled(e.documentModel.options.characterFormatting))return i;for(var n=new If,o=e.getRunIterator(t);o.moveNext();){var a=o.currentRun;i.register(new Tf(o.currentInterval(),a.maskedCharacterProperties.clone())),a.setCharacterProperties(r),a.onCharacterPropertiesChanged()}return n.register(new Tf(t,r)),this.modelManipulator.notifyModelChanged(new Ob(e.id,n)),i}restoreValue(e,t){if(Bb.isEnabled(e.documentModel.options.characterFormatting)){for(var r,i=0;r=t.objects[i];i++)for(var n=e.getRunIterator(r.interval);n.moveNext();){var o=n.currentRun;o.setCharacterProperties(r.value),o.onCharacterPropertiesChanged()}this.modelManipulator.notifyModelChanged(new Ob(e.id,t))}}}class Ub{constructor(e){this.manipulator=e}setValue(e,t,r){var i=new If;if(!Bb.isEnabled(e.documentModel.options.characterFormatting))return i;for(var n=new If,o=e.getRunIterator(t);o.moveNext();){var a=o.currentRun;i.register(new Pf(o.currentInterval(),a.maskedCharacterProperties.getUseValueFull()));var s=a.maskedCharacterProperties.clone();s.setUseValueFull(r),a.setCharacterProperties(s),a.onCharacterPropertiesChanged()}return n.register(new Pf(t,r)),this.manipulator.notifyModelChanged(new kb(e.id,v.UseValue,n)),i}restoreValue(e,t){if(Bb.isEnabled(e.documentModel.options.characterFormatting)){for(var r,i=0;r=t.objects[i];i++)for(var n=e.getRunIterator(r.interval);n.moveNext();){var o=n.currentRun,a=o.maskedCharacterProperties.clone();a.setUseValueFull(r.value),o.setCharacterProperties(a),o.onCharacterPropertiesChanged()}this.manipulator.notifyModelChanged(new kb(e.id,v.UseValue,t))}}}class Hb{constructor(e,t){this.manipulator=e,this.descriptor=t}setValue(e,t,r,i){var n=new If;if(!Bb.isEnabled(e.documentModel.options.characterFormatting))return n;for(var o=new If,a=this.descriptor.maskValue(),s=e.getRunIterator(t);s.moveNext();){var l=s.currentInterval(),d=s.currentRun.maskedCharacterProperties.clone();if(o.register(new vf(l,r,i)),n.register(new vf(l,this.descriptor.getProp(d),d.getUseValue(a))),this.descriptor.setProp(d,r),d.setUseValue(a,i),s.currentRun.setCharacterProperties(d),s.currentRun.hasCharacterMergedProperies()&&i){var c=s.currentRun.getCharacterMergedProperties().clone();this.descriptor.setProp(c,r),s.currentRun.setCharacterMergedProperies(c)}else s.currentRun.onCharacterPropertiesChanged()}return this.manipulator.notifyModelChanged(new kb(e.id,this.descriptor.getJSONProperty(),o)),n}restoreValue(e,t){if(Bb.isEnabled(e.documentModel.options.characterFormatting)&&!t.isEmpty()){for(var r,i=0;r=t.objects[i];i++)for(var n=e.getRunIterator(r.interval);n.moveNext();){var o=n.currentRun.maskedCharacterProperties.clone();this.descriptor.setProp(o,r.value),o.setUseValue(this.descriptor.maskValue(),r.use),n.currentRun.setCharacterProperties(o),n.currentRun.onCharacterPropertiesChanged()}this.manipulator.notifyModelChanged(new kb(e.id,this.descriptor.getJSONProperty(),t))}}}class Vb extends lu{constructor(e){super(e)}mergeDocumentModel(e,t){this.history.beginTransaction();const r=t.subDocument;let i=t.position;const n=e.subDocument,o=e.interval,a=n.documentModel,s=r.documentModel,l=n.getConstRunIterator(o),d=[],c=n.fields,h=r.fields,u=i-o.start,p=e=>(e=e.clone(),s.cache.imageCache.registerFromAnotherModel(e),this.modelManipulator.picture.loader.load(e),e);let g=l.moveNext();g&&this.needInsertParagraphBeforeTable(n,o)&&(this.insertParagraph(s,r,l.currentRun,i,-1,l.currentRun.paragraph.listLevelIndex),i++);let m=i;for(;g;){var f=l.currentRun;switch(f.getType()){case cs.FieldCodeStartRun:var b=l.currentChunk.startLogPosition.value+f.startOffset;d.push(Md.normedBinaryIndexOf(n.fields,b+1));case cs.FieldCodeEndRun:case cs.FieldResultEndRun:case cs.TextRun:case cs.LayoutDependentRun:var C=l.currentChunk.getRunText(f),S=s.cache.maskedCharacterPropertiesCache.getItem(f.maskedCharacterProperties),I=s.stylesManager.addCharacterStyle(f.characterStyle);this.modelManipulator.text.insertTextInner(new op(new pu(r,m),new pn(S,I),f.getType()==cs.LayoutDependentRun&&r.isMain()?cs.TextRun:f.getType(),C));break;case cs.InlinePictureRun:{var P=f;if(!(P instanceof lh))throw new Error("In TexManipulator.insertPartSubDocumentInOtherSubDocument currentPictureRun not have type InlinePictureRun");const e=P.info.clone();e.size.cacheInfo=p(e.size.cacheInfo),this.modelManipulator.picture.insertInlinePictureInner(new pu(r,m),P.getCharPropsBundle(s),e);break}case cs.AnchoredPictureRun:{let e=f;if(!(e instanceof ah))throw new Error("In TexManipulator.insertPartSubDocumentInOtherSubDocument currentAnchoredPictureRun not have type AnchoredPictureRun");this.modelManipulator.picture.insertAnchoredPictureInner(new pu(r,m),e.getCharPropsBundle(s),e.info.clone());break}case cs.InlineTextBoxRun:break;case cs.AnchoredTextBoxRun:{const e=f;if(r.isTextBox()){this.modelManipulator.text.insertTextInner(new op(new pu(r,m),e.getCharPropsBundle(s),cs.TextRun," "));break}let t=this.modelManipulator.textBox.insertAnchoredTextBox(new pu(r,m),f.getCharPropsBundle(s),new hb(null,e.size.clone(),e.shape.clone(),e.anchorInfo.clone(),e.textBoxProperties.clone(),e.containerProperties.clone()));const i=this.modelManipulator.model.subDocuments[e.subDocId],n=this.modelManipulator.model.subDocuments[t.subDocId];this.mergeDocumentModel(new gu(i,new on.FixedInterval(0,i.getDocumentEndPosition())),new pu(n,0)),this.modelManipulator.range.removeIntervalInner(n,new on.FixedInterval(n.getDocumentEndPosition()-2,1),!1);break}case cs.ParagraphRun:var w=-1,y=f.paragraph.listLevelIndex;if(f.paragraph.numberingListIndex>=0){var x=a.numberingLists[f.paragraph.numberingListIndex];if((w=s.getNumberingListIndexById(x.getId()))<0){var T=s.getAbstractNumberingListIndexById(a.abstractNumberingLists[x.abstractNumberingListIndex].getId());if(T<0){var v=new dn(s);v.copyFrom(a.abstractNumberingLists[x.abstractNumberingListIndex]),T=this.modelManipulator.numberingList.addAbstractNumberingList(v)}var M=new cn(s,T);M.copyFrom(x),w=this.modelManipulator.numberingList.addNumberingList(M)}}if(w<0){var E=r.getParagraphByPosition(m),D=E.getNumberingListIndex();D>=0&&i===E.startLogPosition.value&&(w=D,y=E.getListLevelIndex())}this.insertParagraph(s,r,f,m,w,y);break;case cs.SectionRun:this.modelManipulator.section.insertSection(new pu(r,m),f.getCharPropsBundle(s),l.currentSection.sectionProperties.clone(),!0,f.paragraph.getParagraphBundleFull(s),!0);break;default:throw new Error("In TextManipulator.insertPartSubDocumentInOtherSubDocument need insert some inknown run type = "+f.getType())}m+=f.getLength(),g=l.moveNext()}let F=[];for(let e,t=0;e=n.tables[t];t++)F.push(this.modelManipulator.table.pasteTable(r,e,i+e.getStartPosition()));if(d.length>0){var R=u+c[d[0]].getCodeStartPosition(),L=Md.normedBinaryIndexOf(h,R);for((L<0||h[L].getCodeStartPosition()<R)&&L++;d.length>0;){var B=n.fields[d.shift()],A=new Md(r.positionManager,L,B.getFieldStartPosition()+u,B.getSeparatorPosition()+u,B.getFieldEndPosition()+u,B.showCode,B.isHyperlinkField()?B.getHyperlinkInfo().clone():void 0);Md.addField(h,A),L++,this.modelManipulator.notifyModelChanged(new up(r.id,A.getFieldStartPosition(),A.getSeparatorPosition(),A.getFieldEndPosition())),A.isHyperlinkField()&&this.modelManipulator.notifyModelChanged(new vm(r.id,A.getResultInterval(),A.getCodeInterval(),A.getHyperlinkInfo()))}}return this.modelManipulator.bookmark.insertBookmarksFromSubDocument(n,r,o,u),this.history.endTransaction(),F}needInsertParagraphBeforeTable(e,t){return e.getParagraphByPosition(t.start).interval.start==t.start&&f.ListUtils.anyOf(e.tables,(e=>e.interval.start<=t.start&&e.interval.end>=t.start))}insertParagraph(e,t,r,i,n,o){this.modelManipulator.paragraph.insertParagraphInner(new Ag(new pu(t,i),r.getCharPropsBundle(e),new mn(e.cache.maskedParagraphPropertiesCache.getItem(r.paragraph.maskedParagraphProperties),r.paragraph.paragraphStyle,new un(n,o),r.paragraph.tabs.clone()),!0,(()=>{})))}}class Wb{constructor(e){this.newDefaultTabWidth=e,this.type=pd.DefaultTabWidth}}class zb{constructor(e){this.newValue=e,this.type=pd.DifferentOddAndEvenPages}}class jb{constructor(e){this.newColor=e,this.type=pd.PageColor}}class Xb extends lu{setDefaultTabWidth(e,t){var r=e.defaultTabWidth;return e.defaultTabWidth=t,this.modelManipulator.notifyModelChanged(new Wb(t)),r}changePageColor(e,t){var r=e.pageBackColor;return e.setPageColor(t),this.modelManipulator.notifyModelChanged(new jb(t)),r}changeDifferentOddAndEvenPages(e,t){let r=e.differentOddAndEvenPages;return e.differentOddAndEvenPages=t,this.modelManipulator.notifyModelChanged(new zb(t)),r}}class Gb{constructor(e){this.documentProtectionProperties=e,this.type=pd.DocumentProtectionChanged}}class Kb{constructor(e,t){this.subDocumentId=e,this.permission=t,this.type=pd.RangePermissionsChanged}}class qb{constructor(){this.type=pd.RangePermissionsPropertiesChanged}}class $b extends Ze{constructor(e,t){super(e),this.newProtectionProperties=t}redo(){this.oldProtectionProperties=this.modelManipulator.documentProtectionProperties.changeProtectionProperties(this.modelManipulator.model,this.newProtectionProperties)}undo(){this.modelManipulator.documentProtectionProperties.changeProtectionProperties(this.modelManipulator.model,this.oldProtectionProperties)}}class Jb extends lu{changeProtectionProperties(e,t){const r=e.documentProtectionProperties.clone();return e.documentProtectionProperties.copyFrom(t),this.raiseProtectionPropertiesChanged(),r}raiseProtectionPropertiesChanged(){this.filterRangePermissions(),this.modelManipulator.notifyModelChanged(new Gb(this.model.documentProtectionProperties))}raiseRangePermissionPropertiesChanged(){this.filterRangePermissions(),this.modelManipulator.notifyModelChanged(new qb)}filterRangePermissions(){b.j.forEach(this.model.subDocuments,(e=>{e.filterRangePermissions(this.modelManipulator.modelManager.richOptions.documentProtection)}))}enforceDocumentProtection(e,t=Mo.ReadOnly){const r=this.model.documentProtectionProperties.clone();if(r.enforceProtection=!0,r.protectionType=t,rn.StringUtils.isNullOrEmpty(e))r.hashAlgorithmType=Fo.None,r.hashIterationCount=0,r.passwordPrefix=null,r.passwordHash=null,r.word2003PasswordHash=null,r.openOfficePasswordHash=null;else{r.hashAlgorithmType=Fo.Sha1,r.hashIterationCount=1e5;const t=new Ml;r.passwordPrefix=t.generatePasswordPrefix(16),r.passwordHash=t.calculatePasswordHash(e,r.passwordPrefix,r.hashIterationCount,r.hashAlgorithmType),r.word2003PasswordHash=t.calculateLegacyPasswordHash(e)}this.modelManipulator.modelManager.history.addAndRedo(new $b(this.modelManipulator,r))}forceRemoveDocumentProtection(){const e=this.model.documentProtectionProperties.clone();e.enforceProtection=!1,this.modelManipulator.modelManager.history.addAndRedo(new $b(this.modelManipulator,e))}}class Yb{constructor(e,t,r,i){this.subDocumentId=e,this.objectId=t,this.property=r,this.newState=i,this.type=pd.AnchorInfoPropertyChanged}}class Qb extends lu{constructor(e,t,r,i){super(e),this.jsonAnchorInfoProperty=t,this.setPropertyValue=r,this.getPropertyValue=i}setValue(e,t,r){var i=new If,n=new If,o=e.getRunByPosition(t.start),a=(o.getType(),cs.AnchoredPictureRun,o),s=a.anchorInfo.clone();return i.register(new Pf(t,this.getPropertyValue(s))),this.setPropertyValue(s,r),a.anchorInfo=s,n.register(new Pf(t,r)),this.modelManipulator.notifyModelChanged(new Yb(e.id,a.anchoredObjectID,this.jsonAnchorInfoProperty,n)),i}restoreValue(e,t){if(!t.isEmpty()){var r=t.lastObject,i=e.getRunByPosition(r.interval.start),n=(i.getType(),cs.AnchoredPictureRun,i);this.setPropertyValue(n.anchorInfo,r.value),this.modelManipulator.notifyModelChanged(new Yb(e.id,n.anchoredObjectID,this.jsonAnchorInfoProperty,t))}}}class Zb extends lu{constructor(e){super(e),this.allowOverlap=new Qb(e,Mc.AllowOverlap,((e,t)=>e.allowOverlap=t),(e=>e.allowOverlap)),this.hidden=new Qb(e,Mc.Hidden,((e,t)=>e.hidden=t),(e=>e.hidden)),this.layoutTableCell=new Qb(e,Mc.LayoutTableCell,((e,t)=>e.layoutTableCell=t),(e=>e.layoutTableCell)),this.locked=new Qb(e,Mc.Locked,((e,t)=>e.locked=t),(e=>e.locked)),this.isBehindDoc=new Qb(e,Mc.IsBehindDoc,((e,t)=>e.isBehindDoc=t),(e=>e.isBehindDoc)),this.leftDistance=new Qb(e,Mc.LeftDistance,((e,t)=>e.leftDistance=t),(e=>e.leftDistance)),this.rightDistance=new Qb(e,Mc.RightDistance,((e,t)=>e.rightDistance=t),(e=>e.rightDistance)),this.topDistance=new Qb(e,Mc.TopDistance,((e,t)=>e.topDistance=t),(e=>e.topDistance)),this.bottomDistance=new Qb(e,Mc.BottomDistance,((e,t)=>e.bottomDistance=t),(e=>e.bottomDistance)),this.zOrder=new Qb(e,Mc.ZOrder,((e,t)=>e.zOrder=t),(e=>e.zOrder)),this.wrapType=new Qb(e,Mc.WrapType,((e,t)=>e.wrapType=t),(e=>e.wrapType)),this.wrapSide=new Qb(e,Mc.WrapSide,((e,t)=>e.wrapSide=t),(e=>e.wrapSide)),this.horizontalPositionType=new Qb(e,Mc.HorizontalPositionType,((e,t)=>e.horizontalPositionType=t),(e=>e.horizontalPositionType)),this.horizontalPositionAlignment=new Qb(e,Mc.HorizontalPositionAlignment,((e,t)=>e.horizontalPositionAlignment=t),(e=>e.horizontalPositionAlignment)),this.verticalPositionType=new Qb(e,Mc.VerticalPositionType,((e,t)=>e.verticalPositionType=t),(e=>e.verticalPositionType)),this.verticalPositionAlignment=new Qb(e,Mc.VerticalPositionAlignment,((e,t)=>e.verticalPositionAlignment=t),(e=>e.verticalPositionAlignment)),this.offsetX=new Qb(e,Mc.OffsetX,((e,t)=>e.offset.x=t),(e=>e.offset.x)),this.offsetY=new Qb(e,Mc.OffsetY,((e,t)=>e.offset.y=t),(e=>e.offset.y)),this.percentOffsetX=new Qb(e,Mc.PercentOffsetX,((e,t)=>e.percentOffset.x=t),(e=>e.percentOffset.x)),this.percentOffsetY=new Qb(e,Mc.PercentOffsetY,((e,t)=>e.percentOffset.y=t),(e=>e.percentOffset.y))}}class eC{constructor(e,t){this.subDocumentId=e,this.updatedImageInfo=t,this.type=pd.InlinePicturesUpdated}}class tC{constructor(e,t,r){this.position=e,this.info=t,this.size=r}}class rC extends lu{setValue(e,t,r){const i=new If,n=new If,o=e.getRunByPosition(t.start);return i.register(new Pf(t,[o.info.cacheInfo.base64,o.size.actualSize])),n.register(new Pf(t,[r[0],r[1]])),this.setPropertyValue(e,n,o,!0),i}restoreValue(e,t){if(t.isEmpty())return;const r=e.getRunByPosition(t.interval.start);this.setPropertyValue(e,t,r,!1)}setPropertyValue(e,t,r,i){const n=this.modelManipulator.model.cache.imageCache,o=t.lastObject.value,a=n.createUnloadedInfoByBase64(o[0],o[1]);a.isLoaded=i,r.size.cacheInfo=a,this.notifyModelChanged(t.interval.start,a,r.size,e)}notifyModelChanged(e,t,r,i){this.modelManipulator.notifyModelChanged(new eC(i.id,new tC(e,t,r)))}}class iC{constructor(e,t,r){this.subDocumentId=e,this.objectId=t,this.newState=r,this.type=pd.ShapeChanged}}class nC{constructor(e,t,r,i){this.subDocumentId=e,this.objectId=t,this.property=r,this.newState=i,this.type=pd.ShapePropertyChanged}}class oC extends lu{constructor(e){super(e),this.fillColor=new aC(e,Pc.FillColor,((e,t)=>e.fillColor=t),(e=>e.fillColor)),this.outlineColor=new aC(e,Pc.OutlineColor,((e,t)=>e.outlineColor=t),(e=>e.outlineColor)),this.outlineWidth=new aC(e,Pc.OutlineWidth,((e,t)=>e.outlineWidth=t),(e=>e.outlineWidth))}setValue(e,t,r){let i=new If,n=new If,o=e.getRunByPosition(t.start);return i.register(new Uf(t,o.shape.clone())),o.shape=r,n.register(new Uf(t,r)),this.modelManipulator.notifyModelChanged(new iC(e.id,o.anchoredObjectID,n)),i}restoreValue(e,t){let r=t.lastObject,i=e.getRunByPosition(r.interval.start);i.shape=r.value,this.modelManipulator.notifyModelChanged(new iC(e.id,i.anchoredObjectID,t))}}class aC{constructor(e,t,r,i){this.manipulator=e,this.jsonShapeProperty=t,this.setPropertyValue=r,this.getPropertyValue=i}setValue(e,t,r){var i=new If,n=new If,o=e.getRunByPosition(t.start),a=o.shape.clone();return i.register(new Pf(t,this.getPropertyValue(a))),this.setPropertyValue(a,r),o.shape=a,n.register(new Pf(t,r)),this.manipulator.notifyModelChanged(new nC(e.id,o.anchoredObjectID,this.jsonShapeProperty,n)),i}restoreValue(e,t){if(!t.isEmpty()){var r=t.lastObject,i=e.getRunByPosition(r.interval.start);this.setPropertyValue(i.shape,r.value),this.manipulator.notifyModelChanged(new nC(e.id,i.anchoredObjectID,this.jsonShapeProperty,t))}}}class sC{constructor(e,t,r,i){this.subDocumentId=e,this.objectId=t,this.position=r,this.newState=i,this.type=pd.AnchoredTextBoxSizeChanged}}class lC{constructor(e,t,r,i){this.subDocumentId=e,this.objectId=t,this.position=r,this.newState=i,this.type=pd.AnchoredPictureSizeChanged}toJSON(e){return this.newState.toJSON(e)}}class dC extends lu{setValue(e,t,r){var i=new If,n=new If,o=e.getRunByPosition(t.start);return i.register(new _f(t,o.size.clone())),o.size=r,n.register(new _f(t,r)),this.notify(n.interval,o.anchoredObjectID,n,e),i}restoreValue(e,t){var r=t.lastObject,i=e.getRunByPosition(r.interval.start);i.size=r.value,this.notify(t.interval,i.anchoredObjectID,t,e)}}class cC extends dC{setValue(e,t,r){return super.setValue(e,t,r)}notify(e,t,r,i){this.modelManipulator.notifyModelChanged(new sC(i.id,t,e.start,r))}}class hC extends dC{setValue(e,t,r){return super.setValue(e,t,r)}notify(e,t,r,i){this.modelManipulator.notifyModelChanged(new lC(i.id,t,e.start,r))}}class uC{constructor(e,t,r,i){this.subDocumentId=e,this.objectId=t,this.position=r,this.newState=i,this.type=pd.AnchoredTextBoxPropertiesChanged}}class pC extends lu{setValue(e,t,r){var i=new If,n=new If,o=e.getRunByPosition(t.start);return i.register(new Hf(t,o.textBoxProperties.clone())),o.textBoxProperties=r,n.register(new Hf(t,r)),this.modelManipulator.notifyModelChanged(new uC(e.id,o.anchoredObjectID,n.interval.start,n)),i}restoreValue(e,t){var r=t.lastObject,i=e.getRunByPosition(r.interval.start);i.textBoxProperties=r.value,this.modelManipulator.notifyModelChanged(new uC(e.id,i.anchoredObjectID,t.interval.start,t))}}class gC extends tt{constructor(e,t,r,i){super(e,t),this.newValue=r,this.propertyManipulator=i}redo(){this.oldState=this.propertyManipulator.setValue(this.boundSubDocument,this.interval,this.newValue)}undo(){this.propertyManipulator.restoreValue(this.boundSubDocument,this.oldState)}}class mC{constructor(e,t){this.anchorInfo=e,this.position=t}}class fC extends lu{getNewZOrder(e){const t=this.getFloatingObjects(e);return t.length?f.ListUtils.last(t).anchorInfo.zOrder+fC.STEP:fC.STEP}getFloatingObjects(e){const t=[],r=new jh(e,!1);r.setPosition(0);do{I.Y.isAnyOf(r.run.getType(),cs.AnchoredPictureRun,cs.AnchoredTextBoxRun)&&t.push(new mC(r.run.anchorInfo,r.getAbsolutePosition()))}while(r.moveToNextRun());return t.sort($p)}setNewZOrder(e,t,r,i){e.history.addAndRedo(new gC(this.modelManipulator,new gu(t,new on.FixedInterval(r,1)),i,e.modelManipulator.floatingObject.anchorInfo.zOrder))}bringToFront(e,t,r){const i=this.getFloatingObjects(t);if(f.ListUtils.last(i).position==r)return!0;const n=f.ListUtils.last(i).anchorInfo.zOrder+fC.STEP;return this.setNewZOrder(e,t,r,n),!0}sendToBack(e,t,r){const i=this.getFloatingObjects(t),n=i[0];if(n.position==r)return!0;const o=n.anchorInfo.zOrder;if(o>0)return this.setNewZOrder(e,t,r,Math.floor(o/2)),!0;const a=f.ListUtils.indexBy(i,(e=>e.position==r));return i.splice(a,1),e.history.beginTransaction(),this.setNewZOrder(e,t,r,1),this.advanceOrder(e,t,i,0,2,!1),e.history.endTransaction(),!0}bringForward(e,t,r){const i=this.getFloatingObjects(t);if(f.ListUtils.last(i).position==r)return!0;const n=f.ListUtils.indexBy(i,(e=>e.position==r)),o=i[n+1].anchorInfo.zOrder+1;return e.history.beginTransaction(),this.setNewZOrder(e,t,r,o),this.advanceOrder(e,t,i,n+2,o+1,i[n].anchorInfo.levelType==dc.BehindText),e.history.endTransaction(),!0}sendBackward(e,t,r){const i=this.getFloatingObjects(t);if(i[0].position==r)return!0;const n=f.ListUtils.indexBy(i,(e=>e.position==r)),o=i[n-1].anchorInfo.zOrder+1,a=i.splice(n,1)[0];return e.history.beginTransaction(),this.setNewZOrder(e,t,r,o),this.advanceOrder(e,t,i,n-1,o+1,a.anchorInfo.levelType==dc.BehindText),e.history.endTransaction(),!0}advanceOrder(e,t,r,i,n,o){for(let a,s=i,l=r[i];l&&(a=r[s],!(l.anchorInfo.zOrder>=n||o&&l.anchorInfo.levelType!=dc.BehindText));s++){const r=on.FixedInterval.fromPositions(n,a?a.anchorInfo.zOrder:l.anchorInfo.zOrder+2*fC.STEP).normalizeLength();n=Math.floor(r.center),this.setNewZOrder(e,t,l.position,n),n++,l=a}}}fC.STEP=1024;class bC extends lu{constructor(e){super(e),this.anchorInfo=new Zb(e),this.shape=new oC(e),this.textBoxSize=new cC(e),this.pictureSize=new hC(e),this.textBoxProperties=new pC(e),this.zOrder=new fC(e),this.image=new rC(e)}}class CC{constructor(e){this.fontInfo=e,this.type=pd.LoadFontInfo}}class SC{constructor(e,t){this.subDocumentId=e,this.interval=t,this.type=pd.ParagraphAndCharacterMergedPropertiesReset}}class IC extends lu{constructor(){super(...arguments),this.loadingFontInfosHashtable={}}loadFontInfo(e,t,r,i){if(this.modelManipulator.modelManager.richOptions.fonts.limitedFonts)return;const n=B.StringMapUtils.elementBy(this.loadingFontInfosHashtable,(t=>t.fontInfo.name==e.name));if(n)return void n.addRequest(t,r);const o=this.modelManipulator.model.cache.fontInfoCache,a=o.count;this.loadingFontInfosHashtable[e.name]=new PC(t,r,e),this.modelManipulator.notifyModelChanged(new CC(e)),e.isLoad=!1,o.getItem(e);const s=this.modelManipulator.modelManager;if(s.clientMode){const t=hd.convertToJSON(e);o.merge({[a]:t},hd.convertFromJSON);const r=s.modelManipulator.font.applyFontInfoLoadedOnPaste(i,{[F.FontInfoIndex]:a},{[a]:t});this.modelManipulator.raiseFontAdded(r)}}applyFontInfoLoadedOnPaste(e,t,r){const i=r[t[F.FontInfoIndex]],n=i[x.Name],o=this.model.cache.fontInfoCache.getItemByName(n);if(o.isLoad)return o;const a=this.loadingFontInfosHashtable[o.name];if(!a)return o;const s=this.modelManipulator;return delete this.loadingFontInfosHashtable[o.name],e.clearCache(),hd.convertFromJSON(i,o),a.applyFont(s),o}addFontByName(e,t){const r=this.model.cache.fontInfoCache.addFont(e,t);return this.modelManipulator.raiseFontAdded(r),r}removeFont(e){this.model.cache.fontInfoCache.deleteFont(e),this.modelManipulator.raiseFontRemoved(e)}}class PC{constructor(e,t,r){this.fontInfo=r,this.subDocuments=[e],this.applyNewFontOnIntervalsAfterLoad=[this.getLinkedIntervals(e,t)]}addRequest(e,t){const r=this.getLinkedIntervals(e,t),i=this.subDocuments.indexOf(e);i<0?(this.subDocuments.push(e),this.applyNewFontOnIntervalsAfterLoad.push(r)):f.ListUtils.addListOnTail(this.applyNewFontOnIntervalsAfterLoad[i],r)}applyFont(e){f.ListUtils.forEach(this.subDocuments,((t,r)=>{let i=null;const n=nn.IntervalAlgorithms.getMergedIntervals(f.ListUtils.map(this.applyNewFontOnIntervalsAfterLoad[r],(e=>e.getFixedInterval())),!0);for(let r of n)if(r.length>0){e.characterProperties.fontName.setValue(t,r,this.fontInfo,!0);const n=t.resetMergedFormattingCache(wg.All,r);i=i?i.expand(n):n}i&&e.notifyModelChanged(new SC(t.id,i))})),this.destructor()}getLinkedIntervals(e,t){return f.ListUtils.map(t,(t=>new md(e.positionManager,t)))}destructor(){f.ListUtils.forEach(this.subDocuments,((e,t)=>{for(let r of this.applyNewFontOnIntervalsAfterLoad[t])r.destructor(e.positionManager)}))}}class wC extends nb{constructor(e,t,r){super(r.subDocumentId,0,1),this.isHeader=e,this.headerFooterType=t,this.subDocumentInfo=r,this.type=pd.HeaderFooterCreated}}class yC{constructor(e,t,r,i){this.sectionIndex=e,this.isHeader=t,this.headerFooterType=r,this.newIndex=i,this.type=pd.HeaderFooterIndexChanged}}class xC extends Ze{constructor(e,t,r,i,n){super(e),this.sectionIndex=t,this.type=r,this.newIndex=i,this.actionAfterUndo=n}redo(){this.oldIndex=this.getManipulator().changeObjectIndex(this.sectionIndex,this.type,this.newIndex)}undo(){this.getManipulator().changeObjectIndex(this.sectionIndex,this.type,this.oldIndex),this.actionAfterUndo(this.oldIndex)}}class TC extends xC{getManipulator(){return this.modelManipulator.header}}class vC extends xC{getManipulator(){return this.modelManipulator.footer}}class MC extends lu{createObject(e){let t=this.createObjectCore();t.headerFooterType=e;let r=this.getObjectsCache().push(t)-1;return this.modelManipulator.notifyModelChanged(new wC(this.isHeader(),e,t)),r}changeObjectIndex(e,t,r){this.modelManipulator.notifyModelChanged(new yC(e,this.isHeader(),t,r));let i=this.modelManipulator.model.sections[e],n=this.getContainer(i).getObjectIndex(t);return this.getContainer(i).setObjectIndex(t,r),n}insertHeaderFooter(e,t,r){this.modelManipulator.batchUpdatableObject.beginUpdate();const i=this.getHeaderFooterManipulator(t).createObject(r);this.history.addAndRedo(new(t?TC:vC)(this.modelManipulator,e,r,i,(e=>{}))),this.modelManipulator.batchUpdatableObject.endUpdate()}getHeaderFooterManipulator(e){return e?this.modelManipulator.header:this.modelManipulator.footer}}class EC extends MC{createObjectCore(){return this.modelManipulator.model.createSubDocument(yo.Header,-1).info}getObjectsCache(){return this.modelManipulator.model.headers}isHeader(){return!0}getContainer(e){return e.headers}}class DC extends MC{createObjectCore(){return this.modelManipulator.model.createSubDocument(yo.Footer,-1).info}getObjectsCache(){return this.modelManipulator.model.footers}isHeader(){return!1}getContainer(e){return e.footers}}class FC{constructor(e,t,r,i){this.subDocumentId=e,this.property=t,this.position=r,this.newState=i,this.type=pd.InlineObjectRunPropertyChanged}}class RC extends lu{constructor(e){super(e),this.scale=new BC(e),this.lockAspectRatio=new AC(e)}}class LC extends lu{setValue(e,t,r){var i=new If,n=new If,o=e.getRunByPosition(t.start);return i.register(new Vf(t,this.getPropertyValue(o.size))),n.register(new Vf(t,r)),this.setPropertyValue(o.size,r),this.modelManipulator.notifyModelChanged(new FC(e.id,this.getJSONInlineObjectProperty(),t.start,n)),i}restoreValue(e,t){if(!t.isEmpty()){var r=t.lastObject,i=e.getRunByPosition(r.interval.start);this.setPropertyValue(i.size,r.value),this.modelManipulator.notifyModelChanged(new FC(e.id,this.getJSONInlineObjectProperty(),t.interval.start,t))}}}class BC extends LC{getPropertyValue(e){return e.scale.clone()}setPropertyValue(e,t){e.scale.width=t.width,e.scale.height=t.height}getJSONInlineObjectProperty(){return Fc.Scales}}class AC extends LC{getPropertyValue(e){return e.lockAspectRatio}setPropertyValue(e,t){e.lockAspectRatio=t}getJSONInlineObjectProperty(){return Fc.LockAspectRatio}}class NC{constructor(e){this.index=e,this.type=pd.AbstractNumberingListAdded}}class kC{constructor(e){this.index=e,this.type=pd.AbstractNumberingListDeleted}}class OC{constructor(e,t){this.property=e,this.newState=t,this.type=pd.IOverrideListLevelChanged}}class _C{constructor(e){this.index=e,this.type=pd.NumberingListAdded}}class UC{constructor(e){this.index=e,this.type=pd.NumberingListDeleted}}class HC{get subDocumentId(){return this.subDocument.id}constructor(e,t,r){this.subDocument=e,this.newState=t,this.oldAbstractNumberingListIndex=r,this.type=pd.ParagraphNumberingListChanged}}class VC{constructor(e,t){this.property=e,this.newState=t,this.type=pd.ListLevelCharacterPropertyChanged}}class WC extends lu{constructor(e){super(e),this.fontBold=new zC(e,ir.bold),this.fontItalic=new zC(e,ir.italic),this.fontName=new zC(e,ir.fontInfo),this.fontSize=new zC(e,ir.size),this.fontCaps=new zC(e,ir.allCaps),this.fontSmallCaps=new zC(e,ir.smallCaps),this.fontStrikeoutType=new zC(e,ir.strikeoutType),this.fontStrikeoutWordsOnly=new zC(e,ir.strikeoutWordsOnly),this.fontUnderlineType=new zC(e,ir.underlineType),this.fontHidden=new zC(e,ir.hidden),this.script=new zC(e,ir.script),this.fontUnderlineWordsOnly=new zC(e,ir.underlineWordsOnly),this.fontNoProof=new zC(e,ir.noProof),this.textColor=new zC(e,ir.textColor),this.shadingInfo=new zC(e,ir.shadingInfo),this.highlightColor=new zC(e,ir.highlightColor),this.fontStrikeoutColor=new zC(e,ir.strikeoutColor),this.fontUnderlineColor=new zC(e,ir.underlineColor)}}class zC extends lu{constructor(e,t){super(e),this.descriptor=t}setValue(e,t,r,i,n,o){var a=new Sf,s=new Sf,l=t?e.abstractNumberingLists[r]:e.numberingLists[r],d=l.levels[i],c=d.getCharacterProperties();if(d instanceof Yi){var h=l.abstractNumberingListIndex;s.register(new Df(!0,h,i,this.descriptor.getProp(c),c.getUseValue(this.descriptor.maskValue()))),this.setValueCore(d,n,o),a.register(new Df(!0,h,i,n,o))}else s.register(new Df(t,r,i,this.descriptor.getProp(c),c.getUseValue(this.descriptor.maskValue()))),this.setValueCore(d,n,o),a.register(new Df(t,r,i,n,o));return this.model.resetMergedFormattingCache(wg.Character),this.modelManipulator.notifyModelChanged(new VC(this.descriptor.getJSONProperty(),a)),s}restoreValue(e,t){var r=t.objects[0],i=(r.isAbstractNumberingList?e.abstractNumberingLists[r.numberingListIndex]:e.numberingLists[r.numberingListIndex]).levels[r.listLevelIndex];this.setValueCore(i,r.value,r.use),this.model.resetMergedFormattingCache(wg.Character),this.modelManipulator.notifyModelChanged(new VC(this.descriptor.getJSONProperty(),t))}setValueCore(e,t,r){var i=e.getCharacterProperties().clone();this.descriptor.setProp(i,t),i.setUseValue(this.descriptor.maskValue(),r),e.setCharacterProperties(i),e.onCharacterPropertiesChanged()}}class jC{constructor(e,t){this.property=e,this.newState=t,this.type=pd.ListLevelParagraphPropertyChanged}}class XC extends lu{constructor(e){super(e),this.align=new GC(e,Ee.Alignment,Be.UseAlignment,((e,t)=>e.alignment=t),(e=>e.alignment)),this.contextualSpacing=new GC(e,Ee.ContextualSpacing,Be.UseContextualSpacing,((e,t)=>e.contextualSpacing=t),(e=>e.contextualSpacing)),this.afterAutoSpacing=new GC(e,Ee.AfterAutoSpacing,Be.UseAfterAutoSpacing,((e,t)=>e.afterAutoSpacing=t),(e=>e.afterAutoSpacing)),this.shadingInfo=new GC(e,Ee.ShadingInfo,Be.UseShadingInfoIndex,((e,t)=>e.shadingInfo=t),(e=>e.shadingInfo)),this.beforeAutoSpacing=new GC(e,Ee.BeforeAutoSpacing,Be.UseBeforeAutoSpacing,((e,t)=>e.beforeAutoSpacing=t),(e=>e.beforeAutoSpacing)),this.firstLineIndent=new GC(e,Ee.FirstLineIndent,Be.UseFirstLineIndent,((e,t)=>e.firstLineIndent=t),(e=>e.firstLineIndent)),this.keepLinesTogether=new GC(e,Ee.KeepLinesTogether,Be.UseKeepLinesTogether,((e,t)=>e.keepLinesTogether=t),(e=>e.keepLinesTogether)),this.firstLineIndentType=new GC(e,Ee.FirstLineIndentType,Be.UseFirstLineIndent,((e,t)=>e.firstLineIndentType=t),(e=>e.firstLineIndentType)),this.leftIndent=new GC(e,Ee.LeftIndent,Be.UseLeftIndent,((e,t)=>e.leftIndent=t),(e=>e.leftIndent)),this.lineSpacing=new GC(e,Ee.LineSpacing,Be.UseLineSpacing,((e,t)=>e.lineSpacing=t),(e=>e.lineSpacing)),this.lineSpacingType=new GC(e,Ee.LineSpacingType,Be.UseLineSpacing,((e,t)=>e.lineSpacingType=t),(e=>e.lineSpacingType)),this.outlineLevel=new GC(e,Ee.OutlineLevel,Be.UseOutlineLevel,((e,t)=>e.outlineLevel=t),(e=>e.outlineLevel)),this.pageBreakBefore=new GC(e,Ee.PageBreakBefore,Be.UsePageBreakBefore,((e,t)=>e.pageBreakBefore=t),(e=>e.pageBreakBefore)),this.rightIndent=new GC(e,Ee.RightIndent,Be.UseRightIndent,((e,t)=>e.rightIndent=t),(e=>e.rightIndent)),this.spacingAfter=new GC(e,Ee.SpacingAfter,Be.UseSpacingAfter,((e,t)=>e.spacingAfter=t),(e=>e.spacingAfter)),this.spacingBefore=new GC(e,Ee.SpacingBefore,Be.UseSpacingBefore,((e,t)=>e.spacingBefore=t),(e=>e.spacingBefore)),this.suppressHyphenation=new GC(e,Ee.SuppressHyphenation,Be.UseSuppressHyphenation,((e,t)=>e.suppressHyphenation=t),(e=>e.suppressHyphenation)),this.suppressLineNumbers=new GC(e,Ee.SuppressLineNumbers,Be.UseSuppressLineNumbers,((e,t)=>e.suppressLineNumbers=t),(e=>e.suppressLineNumbers)),this.widowOrphanControl=new GC(e,Ee.WidowOrphanControl,Be.UseWidowOrphanControl,((e,t)=>e.widowOrphanControl=t),(e=>e.widowOrphanControl))}}class GC extends lu{constructor(e,t,r,i,n){super(e),this.paragraphPropertiesMask=r,this.jsonParagraphFormattingProperty=t,this.setProperty=i,this.getProperty=n}setValue(e,t,r,i,n,o){var a=new Sf,s=new Sf,l=t?e.abstractNumberingLists[r]:e.numberingLists[r],d=l.levels[i],c=d.getParagraphProperties();if(d instanceof Yi){var h=l.abstractNumberingListIndex;s.register(new Df(!0,h,i,this.getProperty(c),c.getUseValue(this.paragraphPropertiesMask))),this.setValueCore(d,n,o),a.register(new Df(!0,h,i,n,o))}else s.register(new Df(t,r,i,this.getProperty(c),c.getUseValue(this.paragraphPropertiesMask))),this.setValueCore(d,n,o),a.register(new Df(t,r,i,n,o));return this.model.resetMergedFormattingCache(wg.Paragraph),this.modelManipulator.notifyModelChanged(new jC(this.jsonParagraphFormattingProperty,a)),s}restoreValue(e,t){var r=t.objects[0],i=(r.isAbstractNumberingList?e.abstractNumberingLists[r.numberingListIndex]:e.numberingLists[r.numberingListIndex]).levels[r.listLevelIndex];this.setValueCore(i,r.value,r.use),this.model.resetMergedFormattingCache(wg.Paragraph),this.modelManipulator.notifyModelChanged(new jC(this.jsonParagraphFormattingProperty,t))}setValueCore(e,t,r){var i=e.getParagraphProperties().clone();this.setProperty(i,t),i.setUseValue(this.paragraphPropertiesMask,r),e.setParagraphProperties(i),e.onParagraphPropertiesChanged()}}class KC{constructor(e,t){this.property=e,this.newState=t,this.type=pd.ListLevelPropertyChanged}}class qC extends lu{constructor(e){super(e),this.start=new JC(e),this.format=new YC(e),this.alignment=new QC(e),this.convertPreviousLevelNumberingToDecimal=new ZC(e),this.separator=new eS(e),this.suppressRestart=new tS(e),this.suppressBulletResize=new rS(e),this.displayFormatString=new iS(e),this.relativeRestartLevel=new nS(e),this.templateCode=new oS(e),this.originalLeftIndent=new aS(e),this.legacy=new sS(e),this.legacySpace=new lS(e),this.legacyIndent=new dS(e)}}class $C{constructor(e){this.manipulator=e}setValue(e,t,r,i,n){var o=new Sf,a=new Sf,s=t?e.abstractNumberingLists[r]:e.numberingLists[r],l=s.levels[i];if(l instanceof Yi){var d=s.abstractNumberingListIndex;o.register(new Ef(!0,d,i,this.getPropertyValue(l.getListLevelProperties()))),this.setValueCore(l,n),a.register(new Ef(!0,d,i,n))}else o.register(new Ef(t,r,i,this.getPropertyValue(l.getListLevelProperties()))),this.setValueCore(l,n),a.register(new Ef(t,r,i,n));return this.manipulator.notifyModelChanged(new KC(this.getJSONListLevelProperty(),a)),o}restoreValue(e,t){var r=t.objects[0],i=(r.isAbstractNumberingList?e.abstractNumberingLists[r.numberingListIndex]:e.numberingLists[r.numberingListIndex]).levels[r.listLevelIndex];this.setValueCore(i,r.value),this.manipulator.notifyModelChanged(new KC(this.getJSONListLevelProperty(),t))}setValueCore(e,t){var r=e.getListLevelProperties().clone();this.setPropertyValue(r,t),e.setListLevelProperties(r)}}class JC extends $C{setPropertyValue(e,t){e.start=t}getPropertyValue(e){return e.start}getJSONListLevelProperty(){return yl.Start}}class YC extends $C{setPropertyValue(e,t){e.format=t}getPropertyValue(e){return e.format}getJSONListLevelProperty(){return yl.Format}}class QC extends $C{setPropertyValue(e,t){e.alignment=t}getPropertyValue(e){return e.alignment}getJSONListLevelProperty(){return yl.Alignment}}class ZC extends $C{setPropertyValue(e,t){e.convertPreviousLevelNumberingToDecimal=t}getPropertyValue(e){return e.convertPreviousLevelNumberingToDecimal}getJSONListLevelProperty(){return yl.ConvertPreviousLevelNumberingToDecimal}}class eS extends $C{setPropertyValue(e,t){e.separator=t}getPropertyValue(e){return e.separator}getJSONListLevelProperty(){return yl.Separator}}class tS extends $C{setPropertyValue(e,t){e.suppressRestart=t}getPropertyValue(e){return e.suppressRestart}getJSONListLevelProperty(){return yl.SuppressRestart}}class rS extends $C{setPropertyValue(e,t){e.suppressBulletResize=t}getPropertyValue(e){return e.suppressBulletResize}getJSONListLevelProperty(){return yl.SuppressBulletResize}}class iS extends $C{setPropertyValue(e,t){e.displayFormatString=t}getPropertyValue(e){return e.displayFormatString}getJSONListLevelProperty(){return yl.DisplayFormatString}}class nS extends $C{setPropertyValue(e,t){e.relativeRestartLevel=t}getPropertyValue(e){return e.relativeRestartLevel}getJSONListLevelProperty(){return yl.RelativeRestartLevel}}class oS extends $C{setPropertyValue(e,t){e.templateCode=t}getPropertyValue(e){return e.templateCode}getJSONListLevelProperty(){return yl.TemplateCode}}class aS extends $C{setPropertyValue(e,t){e.originalLeftIndent=t}getPropertyValue(e){return e.originalLeftIndent}getJSONListLevelProperty(){return yl.OriginalLeftIndent}}class sS extends $C{setPropertyValue(e,t){e.legacy=t}getPropertyValue(e){return e.legacy}getJSONListLevelProperty(){return yl.Legacy}}class lS extends $C{setPropertyValue(e,t){e.legacySpace=t}getPropertyValue(e){return e.legacySpace}getJSONListLevelProperty(){return yl.LegacySpace}}class dS extends $C{setPropertyValue(e,t){e.legacyIndent=t}getPropertyValue(e){return e.legacyIndent}getJSONListLevelProperty(){return yl.LegacyIndent}}class cS extends lu{constructor(e){super(e),this.listLevelProperties=new qC(e),this.listLevelCharacterProperties=new WC(e),this.listLevelParagraphProperties=new XC(e)}addAbstractNumberingList(e){var t=this.model.abstractNumberingLists.push(e)-1;return e.deleted=!1,this.modelManipulator.notifyModelChanged(new NC(t)),t}deleteAbstractNumberingList(e){this.model.abstractNumberingLists[e].deleted=!0,this.model.abstractNumberingLists.splice(e,1),this.modelManipulator.notifyModelChanged(new kC(e))}addNumberingList(e){const t=this.model.numberingLists.push(e)-1;return e.deleted=!1,this.modelManipulator.notifyModelChanged(new _C(t)),t}deleteNumberingList(e){this.model.numberingLists.splice(e,1),this.modelManipulator.notifyModelChanged(new UC(e))}setIOverrideListLevelOverrideStart(e,t,r){var i=this.model.numberingLists[e].levels[t],n=new Sf,o=new Sf;return o.register(new Ef(!1,e,t,i.overrideStart)),i.overrideStart=r,n.register(new Ef(!1,e,t,r)),this.modelManipulator.notifyModelChanged(new OC(wl.OverrideStart,n)),o}restoreIOverrideListLevelOverrideStart(e){var t=e.objects[0];this.model.numberingLists[t.numberingListIndex].levels[t.listLevelIndex].overrideStart=t.value,this.modelManipulator.notifyModelChanged(new OC(wl.OverrideStart,t.value))}setIOverrideListLevelNewStart(e,t,r){var i=this.model.numberingLists[e].levels[t],n=new Sf,o=new Sf;return o.register(new Ef(!1,e,t,i.getNewStart())),i.setNewStart(r),n.register(new Ef(!1,e,t,r)),this.modelManipulator.notifyModelChanged(new OC(wl.NewStart,n)),o}restoreIOverrideListLevelNewStart(e){var t=e.objects[0];this.model.numberingLists[t.numberingListIndex].levels[t.listLevelIndex].setNewStart(t.value),this.modelManipulator.notifyModelChanged(new OC(wl.NewStart,t.value))}setParagraphNumberingList(e,t,r,i){var n=new If,o=new If,a=e.paragraphs[t],s=a.getAbstractNumberingListIndex();return n.register(new Pf(a.interval,[a.numberingListIndex,a.listLevelIndex])),o.register(new Pf(a.interval,[r,i])),a.numberingListIndex=r,a.listLevelIndex=i,a.resetParagraphMergedProperties(),this.modelManipulator.notifyModelChanged(new HC(e,o,s)),n}removeNumberingListFromParagraph(e,t){var r=new If,i=new If,n=e.paragraphs[t],o=n.getAbstractNumberingListIndex(),a=cn.NumberingListNotSettedIndex;return n.isInStyleList()&&(a=cn.NoNumberingListIndex),r.register(new Pf(n.interval,[n.numberingListIndex,n.listLevelIndex])),n.numberingListIndex=a,n.listLevelIndex=-1,n.resetParagraphMergedProperties(),i.register(new Pf(n.interval,[a,-1])),this.modelManipulator.notifyModelChanged(new HC(e,i,o)),r}restoreParagraphNumberingList(e,t){var r=e.getParagraphsByInterval(t.interval)[0],i=r.getAbstractNumberingListIndex();r.numberingListIndex=t.objects[0].value[0],r.listLevelIndex=t.objects[0].value[1],r.resetParagraphMergedProperties(),this.modelManipulator.notifyModelChanged(new HC(e,t,i))}}class hS extends nb{constructor(e,t,r){super(e,t,1),this.paragraph=r,this.type=pd.ParagraphInserted}}class uS extends db{insertParagraphViaHistory(e){return e.correctAndCheckParams()?(this.history.addAndRedo(new lf(this.modelManipulator,e)),new on.FixedInterval(e.subDocPos.position,1)):new on.FixedInterval(e.subDocPos.position,0)}insertParagraphInner(e){const t=e.subDocPos.subDocument;if(uS.insertParagraphInEnd(t,e.subDocPos.position,e.charPropsBundle))return void this.modelManipulator.notifyModelChanged(new hS(t.id,e.subDocPos.position,f.ListUtils.last(t.paragraphs)));const r=this.insertRunInternal(e.subDocPos,e.charPropsBundle,cs.ParagraphRun,an.specialCharacters.ParagraphMark),i=t.chunks[r.chunkIndex].textRuns[r.runIndex],n=C.SearchUtils.normedInterpolationIndexOf(t.paragraphs,(e=>e.startLogPosition.value),e.subDocPos.position+1),o=t.paragraphs[n];t.positionManager.unregisterPosition(o.startLogPosition);const a=new ns(t,null,1,null,null);a.onParagraphPropertiesChanged(),this.applyParagraphProperties(a,o,!e.applyDirectlyToNewParagraph,e.parPropsBundle),i.paragraph=a,t.paragraphs.splice(n,0,a);let s=r.runIndex-1;e:for(var l=r.chunkIndex;d=t.chunks[l];l--){for(;c=d.textRuns[s];s--){if(c.isParagraphOrSectionRun())break e;c.paragraph=a,c.onCharacterPropertiesChanged(),a.length+=c.getLength(),o.length-=c.getLength()}l>0&&(s=t.chunks[l-1].textRuns.length-1)}a.startLogPosition=t.positionManager.registerPosition(null!=c?d.startLogPosition.value+c.startOffset+1:0),o.startLogPosition=t.positionManager.registerPosition(e.subDocPos.position+1),s=r.runIndex+1;var d;e:for(l=r.chunkIndex;d=t.chunks[l];l++){for(var c;c=d.textRuns[s];s++)if(c.onCharacterPropertiesChanged(),c.isParagraphOrSectionRun())break e;s=0}this.modelManipulator.notifyModelChanged(new hS(t.id,e.subDocPos.position,a)),e.actionAfter(this.modelManipulator.modelManager)}applyParagraphProperties(e,t,r,i){i.props?r?(t.onParagraphPropertiesChanged(),e.setParagraphProperties(t.maskedParagraphProperties),t.setParagraphProperties(i.props)):e.setParagraphProperties(i.props):e.setParagraphProperties(t.maskedParagraphProperties),i.style?r?(e.paragraphStyle=t.paragraphStyle,t.paragraphStyle=i.style):e.paragraphStyle=i.style:e.paragraphStyle=t.paragraphStyle,void 0!==i.listInfo&&void 0!==i.listInfo.listLevelIndex&&void 0!==i.listInfo.numberingListIndex?r?(e.numberingListIndex=t.numberingListIndex,e.listLevelIndex=t.listLevelIndex,t.numberingListIndex=i.listInfo.numberingListIndex,t.listLevelIndex=i.listInfo.listLevelIndex):(e.numberingListIndex=i.listInfo.numberingListIndex,e.listLevelIndex=i.listInfo.listLevelIndex):(e.numberingListIndex=t.numberingListIndex,e.listLevelIndex=t.listLevelIndex),i.tabs?r?(e.tabs=t.tabs.clone(),t.tabs=i.tabs):e.tabs=i.tabs:e.tabs=t.tabs.clone()}static insertParagraphInEnd(e,t,r){var i=e.chunks[e.chunks.length-1],n=i.startLogPosition.value+i.textBuffer.length;if(t>=n){t=n;const a=e.paragraphs[e.paragraphs.length-1],s=new ns(e,e.positionManager.registerPosition(t),1,a.paragraphStyle,a.maskedParagraphProperties),l=new Bl(t-i.startLogPosition.value,s,r);e.paragraphs.push(s),i.textRuns.push(l),i.textBuffer=i.textBuffer+an.specialCharacters.ParagraphMark;var o=e.documentModel.sections[e.documentModel.sections.length-1];return o.setLength(e,o.getLength()+1),!0}return!1}}class pS{constructor(e,t,r){this.subDocumentId=e,this.property=t,this.newState=r,this.type=pd.ParagraphFormattingChanged}}class gS{constructor(e,t,r,i,n,o,a){this.subDocumentId=e,this.paragraphIndex=t,this.paragraphInterval=r,this.properties=i,this.style=n,this.tabs=o,this.listInfo=a,this.type=pd.ParagraphPropertiesChanged}}class mS extends lu{constructor(e){super(e),this.align=new bS(e,Ft.alignment),this.contextualSpacing=new bS(e,Ft.contextualSpacing),this.rightToLeft=new bS(e,Ft.rightToLeft),this.afterAutoSpacing=new bS(e,Ft.afterAutoSpacing),this.shadingInfo=new bS(e,Ft.shadingInfo),this.beforeAutoSpacing=new bS(e,Ft.beforeAutoSpacing),this.firstLineIndent=new bS(e,Ft.firstLineIndent),this.keepLinesTogether=new bS(e,Ft.keepLinesTogether),this.firstLineIndentType=new bS(e,Ft.firstLineIndentType),this.leftIndent=new bS(e,Ft.leftIndent),this.lineSpacing=new bS(e,Ft.lineSpacing),this.lineSpacingType=new bS(e,Ft.lineSpacingType),this.outlineLevel=new bS(e,Ft.outlineLevel),this.pageBreakBefore=new bS(e,Ft.pageBreakBefore),this.rightIndent=new bS(e,Ft.rightIndent),this.spacingAfter=new bS(e,Ft.spacingAfter),this.spacingBefore=new bS(e,Ft.spacingBefore),this.suppressHyphenation=new bS(e,Ft.suppressHyphenation),this.suppressLineNumbers=new bS(e,Ft.suppressLineNumbers),this.widowOrphanControl=new bS(e,Ft.widowOrphanControl),this.divId=new bS(e,Ft.divId),this.keepWithNext=new bS(e,Ft.keepWithNext),this.useValue=new fS(e)}changeAllProperties(e,t,r,i,n,o,a){var s=e.paragraphs[t];s.setParagraphProperties(r),s.paragraphStyle=i,s.tabs=n.clone(),s.numberingListIndex=o,s.listLevelIndex=a,s.onParagraphPropertiesChanged(),this.modelManipulator.notifyModelChanged(new gS(e.id,t,e.paragraphs[t].interval,r,i,n,new un(o,a)))}}class fS{constructor(e){this.manipulator=e}setValue(e,t,r){var i=new If;if(!Bb.isEnabled(e.documentModel.options.paragraphFormatting))return i;for(var n,o=new If,a=e.getParagraphsByInterval(t),s=0;n=a[s];s++){var l=n.maskedParagraphProperties.clone();i.register(new Pf(new on.FixedInterval(n.startLogPosition.value,n.length),l.useValue)),o.register(new Pf(new on.FixedInterval(n.startLogPosition.value,n.length),r)),l.useValue=r,n.setParagraphProperties(l),n.onParagraphPropertiesChanged()}return this.manipulator.notifyModelChanged(new pS(e.id,Ee.UseValue,o)),i}restoreValue(e,t){if(Bb.isEnabled(e.documentModel.options.paragraphFormatting)){for(var r,i=0;r=t.objects[i];i++){var n,o=e.getParagraphsByInterval(r.interval);for(i=0;n=o[i];i++){var a=n.maskedParagraphProperties.clone();a.useValue=r.value,n.setParagraphProperties(a),n.onParagraphPropertiesChanged()}}this.manipulator.notifyModelChanged(new pS(e.id,Ee.UseValue,t))}}}class bS{constructor(e,t){this.manipulator=e,this.descriptor=t}setValue(e,t,r,i){var n=new If;if(!Bb.isEnabled(e.documentModel.options.paragraphFormatting))return n;for(var o,a=new If,s=e.getParagraphsByInterval(t),l=0;o=s[l];l++){var d=o.interval,c=o.maskedParagraphProperties.clone();if(n.register(new vf(d,this.descriptor.getProp(c),c.getUseValue(this.descriptor.maskValue()))),a.register(new vf(d,r,i)),this.descriptor.setProp(c,r),c.setUseValue(this.descriptor.maskValue(),i),o.setParagraphProperties(c),o.hasParagraphMergedProperies()&&i){var h=o.getParagraphMergedProperties().clone();this.descriptor.setProp(h,r),o.setParagraphMergedProperies(h)}else o.onParagraphPropertiesChanged()}return this.manipulator.notifyModelChanged(new pS(e.id,this.descriptor.getJSONProperty(),a)),n}restoreValue(e,t){if(Bb.isEnabled(e.documentModel.options.paragraphFormatting)&&!t.isEmpty()){for(var r,i=0;r=t.objects[i];i++)for(var n,o=e.getParagraphsByInterval(r.interval),a=0;n=o[a];a++){var s=n.maskedParagraphProperties.clone();if(this.descriptor.setProp(s,r.value),s.setUseValue(this.descriptor.maskValue(),r.use),n.setParagraphProperties(s),n.hasParagraphMergedProperies()){var l=n.getParagraphMergedProperties().clone();this.descriptor.setProp(l,r.value),n.setParagraphMergedProperies(l)}else n.onParagraphPropertiesChanged()}this.manipulator.notifyModelChanged(new pS(e.id,this.descriptor.getJSONProperty(),t))}}}class CS extends nb{constructor(e,t,r,i,n,o,a){super(e,r,1),this.objectId=t,this.id=i,this.size=n,this.anchorInfo=o,this.containerProperties=a,this.type=pd.AnchoredPictureInserted}}class SS extends nb{constructor(e,t,r,i){super(e,t,length),this.picInfo=r,this.containerProperties=i,this.type=pd.InlinePictureInserted}}class IS extends tt{constructor(e,t,r){super(e,t),this.size=r}redo(){this.oldState=this.modelManipulator.floatingObject.pictureSize.setValue(this.boundSubDocument,this.interval,this.size)}undo(){this.modelManipulator.floatingObject.pictureSize.restoreValue(this.boundSubDocument,this.oldState)}}class PS extends tt{constructor(e,t,r,i){super(e,t),this.newValue=r,this.propertyManipulator=i}redo(){this.oldState=this.propertyManipulator.setValue(this.boundSubDocument,this.interval,this.newValue)}undo(){this.propertyManipulator.restoreValue(this.boundSubDocument,this.oldState)}}class wS extends tt{constructor(e,t,r){super(e,t),this.newValue=r}redo(){this.oldState=this.modelManipulator.floatingObject.shape.setValue(this.boundSubDocument,this.interval,this.newValue)}undo(){this.modelManipulator.floatingObject.shape.restoreValue(this.boundSubDocument,this.oldState)}}class yS extends ab{constructor(e,t,r,i,n){super(e,t),this.charPropsBundle=r,this.picInfo=i,this.options=n}redo(){this.picInfo.publicAPIID=this.modelManipulator.picture.insertInlinePictureInner(this.subDocPos,this.charPropsBundle,this.picInfo,this.options),this.options=void 0}undo(){this.modelManipulator.range.removeIntervalWithoutHistory(this.subDocPos.subDocument,new on.FixedInterval(this.subDocPos.position,1),!1)}}class xS extends tt{constructor(e,t,r,i){super(e,t),this.newValue=r,this.propertyManipulator=i}redo(){this.oldState=this.propertyManipulator.setValue(this.boundSubDocument,this.interval,this.newValue)}undo(){this.propertyManipulator.restoreValue(this.boundSubDocument,this.oldState)}}class TS{static generateSectionColumns(e){for(var t=e.pageWidth-(e.marginLeft+e.marginRight+e.space*(e.columnCount-1)),r=e.pageHeight-(e.marginTop+e.marginBottom),i=e.marginLeft,n=[],o=0;o<e.columnCount;o++){var a=Math.max(e.equalWidthColumns?Math.floor(t/(e.columnCount-o)):e.columnsInfo[o].width,1),s=new Va.Rectangle(g.u.twipsToPixelsF(i),g.u.twipsToPixelsF(e.marginTop),Math.max(g.u.twipsToPixelsF(a),1),g.u.twipsToPixelsF(r));n.push(s),i+=a+(e.equalWidthColumns?e.space:e.columnsInfo[o].space),t-=a}return n}static findMinimalColumnSize(e){return f.ListUtils.min(TS.generateSectionColumns(e),(e=>e.width)).createSize()}}class vS{constructor(){this.pageIndex=-1}init(e){this.section=e,this.mirrorMargins=e.documentModel.mirrorMargins;const t=this.section.sectionProperties;this.equalWidthColumns=t.equalWidthColumns,this.columnCount=t.columnCount,this.space=g.u.twipsToPixelsF(t.space),this.marginTop=g.u.twipsToPixelsF(t.marginTop),this.marginBottom=g.u.twipsToPixelsF(t.marginBottom),this.marginRight=g.u.twipsToPixelsF(t.marginRight),this.marginBottom=g.u.twipsToPixelsF(t.marginBottom),this.marginLeft=g.u.twipsToPixelsF(t.marginLeft),this.pageWidth=g.u.twipsToPixelsF(t.pageWidth),this.pageHeight=g.u.twipsToPixelsF(t.pageHeight),this.headerOffset=g.u.twipsToPixelsF(t.headerOffset),this.footerOffset=g.u.twipsToPixelsF(t.footerOffset),this.mirrorMargins&&this.pageIndex>=0&&(0,S.isEven)(this.pageIndex)&&([this.marginRight,this.marginLeft]=[this.marginLeft,this.marginRight]),this.columnsInfo=f.ListUtils.map(t.columnsInfo,(e=>e.clone().applyConverter(g.u.twipsToPixelsF))),this.avaliablePageHeight=this.pageHeight-(this.marginTop+this.marginBottom),this.availableHeaderFooterWidth=this.pageWidth-this.marginLeft-this.marginRight}initWhenPageStart(e){this.pageIndex=e,this.mainPageAreasBounds=[],this.mainColumnsBounds=[]}setHeaderBounds(e){if(0==e)return this.headerPageAreaBounds=null,void(this.headerColumnBounds=null);const t=-1==e?Number.MAX_VALUE:Math.max(this.marginTop-this.headerOffset,Math.min(Math.floor(this.pageHeight*vS.MAX_HEADER_FOOTER_HEIGHT_COEFF),e));this.headerPageAreaBounds=new Va.Rectangle(this.marginLeft,this.headerOffset,this.availableHeaderFooterWidth,t),this.headerColumnBounds=new Va.Rectangle(0,0,this.headerPageAreaBounds.width,this.headerPageAreaBounds.height)}setFooterBounds(e){if(0==e)return this.footerPageAreaBounds=null,void(this.footerColumnBounds=null);if(-1==e)this.footerPageAreaBounds=new Va.Rectangle(this.marginLeft,this.pageHeight-this.footerOffset,this.availableHeaderFooterWidth,Number.MAX_VALUE),this.footerColumnBounds=new Va.Rectangle(0,0,this.footerPageAreaBounds.width,this.footerPageAreaBounds.height);else{e=Math.min(Math.round(this.pageHeight*vS.MAX_HEADER_FOOTER_HEIGHT_COEFF),e);const t=this.footerOffset+e;this.footerPageAreaBounds=new Va.Rectangle(this.marginLeft,this.pageHeight-t,this.availableHeaderFooterWidth,t),this.footerColumnBounds=new Va.Rectangle(0,0,this.footerPageAreaBounds.width,e)}}calculateMainPageAreaBounds(e){let t;if(e>0){const r=this.mainPageAreasBounds[this.mainPageAreasBounds.length-1];for(let t of this.mainColumnsBounds[this.mainColumnsBounds.length-1])t.height=e;r.height=e,t=r.bottom}else t=Math.max(this.marginTop,this.headerPageAreaBounds?this.headerPageAreaBounds.bottom:0);let r=Math.min(this.pageHeight-this.marginBottom,this.footerPageAreaBounds?this.footerPageAreaBounds.y:Number.MAX_VALUE)-t;this.mainPageAreasBounds.push(new Va.Rectangle(this.marginLeft,t,this.availableHeaderFooterWidth,r))}calculateColumnBounds(e){if(this.equalWidthColumns){const t=Math.floor((this.availableHeaderFooterWidth-(this.columnCount-1)*this.space)/this.columnCount),r=t+this.space;this.mainColumnsBounds.push(f.ListUtils.initByCallback(this.columnCount,(i=>new Va.Rectangle(r*i,0,t,e.height))))}else{let t=0;this.mainColumnsBounds.push(f.ListUtils.map(this.columnsInfo,(r=>{const i=new Va.Rectangle(t,0,Math.max(1,r.width),e.height);return t+=r.width+r.space,i})))}}calculatePageBounds(e){this.pageBounds=new Va.Rectangle(0,e,this.pageWidth,this.pageHeight)}}vS.MAX_HEADER_FOOTER_HEIGHT_COEFF=.48;class MS{constructor(e,t,r,i,n){this.subDocument=e,this.runPosition=t,this.run=r,this.options=i,this.histItemSize=n}}class ES{constructor(e,t){this.loadingData={},this.modelManipulator=e,this.pictureLoadedListener=t}getImageLoadingOptions(e){const t=this.loadingData[e.cacheInfo.tmpId];if(t){const r=t.find((t=>t instanceof MS&&t.run===e));if(r)return r.options}return null}addLoadListener(e,t){const r=this.loadingData[e.tmpId];r&&r.push(t)}allPicturesLoaded(){return b.j.isEmpty(this.loadingData)}addSizes(e,t,r,i){const n=r.info.cacheInfo;let o=this.loadingData[n.tmpId];o||(o=this.loadingData[n.tmpId]=[]);const a=e.subDocument.positionManager.registerNotLoadedPicturePosition(e.position);o.push(new MS(e.subDocument,a,r,t,i))}update(e,t){const r=this.loadingData[e.tmpId];if(r){delete this.loadingData[e.tmpId],this.modelManipulator.batchUpdatableObject.beginUpdate();for(let e of r)e instanceof MS?this.updateInner(e,t):e();this.modelManipulator.batchUpdatableObject.endUpdate(),this.pictureLoadedListener.notifyPictureLoaded()}}updateInner(e,t){const r=e.options,i=e.run.info.cacheInfo.size;let n=null;if(r.actualSize)n=so.Size.initByCommonAction((e=>100*e(r.actualSize)/e(i)));else if(r.calculateActualSize){const t=this.modelManipulator.model.getSectionByPosition(e.runPosition.value);let r;if(e.subDocument.isTextBox()){const n=this.getAnchoredTextBoxRun(e.subDocument.info),o=n.size,a=new vS;a.init(t);const s=n.textBoxProperties.getContentMargins();let l,d=(o.useAbsoluteWidth()?o.absoluteSize.width:g.u.pixelsToTwipsF(o.getActualRelativeWidth(a)))-s.horizontal;l=n.textBoxProperties.resizeShapeToFitText?i.height:o.useAbsoluteHeight()?o.absoluteSize.height:g.u.pixelsToTwipsF(o.getActualRelativeHeight(a))-s.vertical,r=new so.Size(d,l)}else r=TS.findMinimalColumnSize(t.sectionProperties).applyConverter(g.u.pixelsToTwips);const o=100*Math.min(r.width/Math.max(1,i.width),r.height/Math.max(1,i.height)),a=Math.max(1,Math.min(o,100));n=new so.Size(a,a)}n&&(e.histItemSize&&(e.histItemSize.scale=n.clone()),e.run.size.scale=n.clone(),t&&e.subDocument.getRunByPosition(e.runPosition.value)===e.run&&this.modelManipulator.notifyModelChanged(new eC(e.subDocument.id,new tC(e.runPosition.value,e.run.info.cacheInfo,e.run.size)))),e.subDocument.positionManager.unregisterNotLoadedPicturePosition(e.runPosition),e.options.imageLoadedEvent.forEach((t=>t(new on.FixedInterval(e.runPosition.value,1),e.run.info.cacheInfo)))}getAnchoredTextBoxRun(e){const t=this.modelManipulator.model.subDocuments[e.parentSubDocumentId],r=t.getRunIterator(t.interval);for(;r.moveNext();){const t=r.currentRun;if(t instanceof sh){const r=t;if(r.subDocId===e.subDocumentId)return r}}return null}}class DS{constructor(e,t){this.callback=e,this.timeoutId=t}}class FS{get imageCache(){return this.modelManipulator.model.cache.imageCache}constructor(e){this.callbacksInfo=[],this.modelManipulator=e,this.sizeUpdater=new ES(e,this)}notifyPictureLoaded(){if(this.sizeUpdater.allPicturesLoaded()){const e=this.callbacksInfo;this.callbacksInfo=[],e.forEach((e=>{clearTimeout(e.timeoutId),e.callback(!0)}))}}ensureAllPicturesLoaded(e,t){if(this.sizeUpdater.allPicturesLoaded())return void t(!0);const r=new DS(t,setTimeout((()=>{const e=this.callbacksInfo.indexOf(r);e>=0&&(this.callbacksInfo.splice(e,1),r.callback(!1))}),e));this.callbacksInfo.push(r)}ensureAllPicturesPdfCompatible(e,t,r){this.ensureAllPicturesLoaded(e,(e=>{if((0,S.isDefined)(t)){const e=this.modelManipulator.model.getAllImages(),i=[];b.j.forEach(e,(e=>{if(e.shouldMakeImagePdfCompatible()){const r=t(e.base64);r instanceof Promise&&i.push(r.then((t=>{e.setPdfCompatibleBase64(t)})).catch((e=>console.log(e))))}})),Promise.all(i).then((()=>r()))}else r()}))}load(e){e.isLoaded||this.loadInner(e)}finalizeLoading(e,t){t||(t=this.imageCache.getPictureData(void 0!==e.tmpId?e.tmpId:e.actualId)),t.isLoaded||this.imageCache.finalizeLoading(t,e),this.sizeUpdater.update(t,!0)}loadPictureByBase64(e,t){const r=new Image;r.onload=()=>{e.size=new so.Size(r.width,r.height).applyConverter(g.u.pixelsToTwips);"image/bmp"==Du.getMimeTypeFromBase64Uri(e.base64)&&this.convertBmpToPng(e,r),t(e)},r.src=e.base64}convertBmpToPng(e,t){const r=document.createElement("canvas");if(!r)return;const i=e.size.clone().applyConverter(g.u.twipsToPixelsF),n=r.getContext("2d");n&&(r.width=i.width,r.height=i.height,n.drawImage(t,0,0),e.base64=r.toDataURL())}loadPictureByUrl(e,t){const r=new XMLHttpRequest;r.onload=()=>{lo.Base64Utils.fromBlobAsDataUrl(r.response,(r=>{e.base64=r,this.loadPictureByBase64(e,(e=>t(e)))}))},r.onerror=()=>t(this.imageCache.emptyImage);try{r.open("GET",e.imageUrl,!0),r.responseType="blob",r.send()}catch(e){t(this.imageCache.emptyImage)}}loadPictureByFile(e,t){lo.Base64Utils.fromBlobAsDataUrl(e.file,(r=>{e.base64=r,e.file=void 0,this.loadPictureByBase64(e,(e=>t(e)))}))}}class RS extends FS{loadInner(e){return e.file?this.loadPictureByFile(e,(()=>this.finalizeLoading(e,e))):e.imageUrl?this.loadPictureByUrl(e,(()=>this.finalizeLoading(e,e))):e.base64&&this.loadPictureByBase64(e,(()=>this.finalizeLoading(e,e))),e}addLoadListener(e,t){this.sizeUpdater.addLoadListener(e,t)}applyRequest(e){throw new Error(R.D.InternalException)}}class LS{constructor(e,t){this.subDocumentId=e,this.data=t,this.type=pd.LoadPicturesInfo}}class BS extends FS{loadInner(e){return e.imageUrl&&(e.imageUrl.match(/^file\:\/\//gi)||e.imageUrl.match(/^blob\:/gi))&&this.resetCacheImageInfoToDefault(e),e.file?this.loadPictureByFile(e,(e=>this.notifyLoad(e))):(e.imageUrl||e.base64)&&this.notifyLoad(e),e}notifyLoad(e){this.modelManipulator.notifyModelChanged(new LS(this.modelManipulator.model.mainSubDocument.id,e))}applyRequest(e){b.j.forEach(e,(e=>this.finalizeLoading(fp.convertFromJSON(e))))}resetCacheImageInfoToDefault(e){e.imageUrl=void 0,e.base64=this.imageCache.emptyImage.base64}}class AS extends tt{constructor(e,t,r,i){super(e,t),this.base64=r,this.size=i}redo(){this.oldState=this.modelManipulator.floatingObject.image.setValue(this.boundSubDocument,this.interval,[this.base64,this.size])}undo(){this.modelManipulator.floatingObject.image.restoreValue(this.boundSubDocument,this.oldState)}}class NS{constructor(e,t){this.inserted=e,this.insertedInterval=t}}class kS{constructor(e,t,r){this.inserted=e,this.insertedInterval=t,this.anchoredObjectID=r}}class OS extends db{constructor(e){super(e),this.loader=this.modelManipulator.modelManager.clientMode?new RS(e):new BS(e),this.descriptionManipulator=new _S(e,((e,t)=>e.description=t),(e=>e.description))}changeHorizontalPosition(e,t,r){this.history.beginTransaction(),this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r.horizontalPositionAlignment,this.modelManipulator.floatingObject.anchorInfo.horizontalPositionAlignment)),r.offset.x,this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r.horizontalPositionType,this.modelManipulator.floatingObject.anchorInfo.horizontalPositionType)),this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r.offset.x,this.modelManipulator.floatingObject.anchorInfo.offsetX)),this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r.percentOffset.x,this.modelManipulator.floatingObject.anchorInfo.percentOffsetX)),this.history.endTransaction()}changeVerticalPosition(e,t,r){this.history.beginTransaction(),this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r.verticalPositionAlignment,this.modelManipulator.floatingObject.anchorInfo.verticalPositionAlignment)),this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r.verticalPositionType,this.modelManipulator.floatingObject.anchorInfo.verticalPositionType)),this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r.offset.y,this.modelManipulator.floatingObject.anchorInfo.offsetY)),this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r.percentOffset.y,this.modelManipulator.floatingObject.anchorInfo.percentOffsetY)),this.history.endTransaction()}changeDescription(e,t,r){this.history.addAndRedo(new xS(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r,this.modelManipulator.picture.descriptionManipulator))}changeWrapSide(e,t,r){this.history.addAndRedo(new gC(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r,this.modelManipulator.floatingObject.anchorInfo.wrapSide))}changeShapeOutlineWidth(e,t,r){this.changeNumberedShapeProperty(e,t,r,this.modelManipulator.floatingObject.shape.outlineWidth)}changeShapeOutlineColor(e,t,r){this.changeNumberedShapeProperty(e,t,r,this.modelManipulator.floatingObject.shape.outlineColor)}changeShapeFillColor(e,t,r){this.changeNumberedShapeProperty(e,t,r,this.modelManipulator.floatingObject.shape.fillColor)}changeNumberedShapeProperty(e,t,r,i){this.history.addAndRedo(new PS(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r,i))}changePictureSize(e,t,r){this.history.addAndRedo(new IS(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r))}setFloatingObjectInlineTextWrapType(e,t,r){const i=e.getRunByPosition(t),n=new on.FixedInterval(t,1),o=i;i.getType()!==cs.InlinePictureRun&&this.history.addTransaction((()=>{this.modelManipulator.range.removeInterval(new gu(e,n),!0,!1);const t=new nh(o.size.clone(),new th,-1,o.info.containerProperties,o.info.nonVisualDrawingProperties);this.modelManipulator.picture.insertInlinePictureViaHistory(new pu(e,n.start),r,t)}))}setFloatingObjectTextWrapType(e,t,r,i,n){const o=this.modelManipulator;let a=e.getRunByPosition(t);if(this.history.beginTransaction(),a.getType()===cs.InlinePictureRun){let i=new on.FixedInterval(t,1),n=a;const o=new Jc;o.zOrder=this.modelManipulator.floatingObject.zOrder.getNewZOrder(e),this.modelManipulator.range.removeInterval(new gu(e,i),!0,!1);const s=new oh(n.size.clone(),new th,o,n.info.containerProperties,n.info.nonVisualDrawingProperties);this.modelManipulator.picture.insertAnchoredPictureViaHistory(new pu(e,i.start),r,s,new Mb(!1)),a=e.getRunByPosition(i.start)}let s=(a.getType(),cs.AnchoredPictureRun,a);s.anchorInfo.wrapType===n&&s.anchorInfo.isBehindDoc===i||(this.history.addAndRedo(new gC(o,new gu(e,new on.FixedInterval(t,1)),n,o.floatingObject.anchorInfo.wrapType)),this.history.addAndRedo(new gC(o,new gu(e,new on.FixedInterval(t,1)),i,o.floatingObject.anchorInfo.isBehindDoc))),this.history.endTransaction()}insertInlinePictureViaHistory(e,t,r,i){return this.history.addAndRedo(new yS(this.modelManipulator,e,t,r,i)),new NS(!0,new on.FixedInterval(e.position,1))}insertAnchoredPictureViaHistory(e,t,r,i){return this.history.addAndRedo(new sb(this.modelManipulator,e,t,r,i)),new NS(!0,new on.FixedInterval(e.position,1))}reloadPicture(e,t,r,i){this.history.addAndRedo(new AS(this.modelManipulator,new gu(e,new on.FixedInterval(t,1)),r,i))}insertInlinePictureInner(e,t,r,i=new Mb(!1,r.size.actualSize)){const n=r.size.cacheInfo,o=r.clone();this.loader.load(n);const a=this.insertRunInternal(e,t,cs.InlinePictureRun,an.specialCharacters.ObjectMark),s=e.subDocument.chunks[a.chunkIndex].textRuns[a.runIndex];return s.info=o,e.subDocument.chunks[a.chunkIndex].textRuns[a.runIndex].paragraph.length++,this.loader.sizeUpdater.addSizes(e,i,s,r.size),this.modelManipulator.notifyModelChanged(new SS(e.subDocument.id,e.position,o,s.info.containerProperties)),n.isLoaded&&this.loader.sizeUpdater.update(n,!0),o.publicAPIID}insertAnchoredPictureInner(e,t,r,i=new Mb(!1)){if(e.subDocument.isTextBox())return new kS(!0,new on.FixedInterval(e.position,1),this.insertInlinePictureInner(e,t,new nh(r.size,r.shape,-1,r.containerProperties,r.nonVisualDrawingProperties),i));const n=r.size.cacheInfo,o=r.clone();this.loader.load(n);const a=this.insertRunInternal(e,t,cs.AnchoredPictureRun,an.specialCharacters.ObjectMark),s=e.subDocument.chunks[a.chunkIndex].textRuns[a.runIndex];s.info=o,e.subDocument.chunks[a.chunkIndex].textRuns[a.runIndex].paragraph.length++,this.loader.sizeUpdater.addSizes(e,i,s,r.size),n.isLoaded&&this.loader.sizeUpdater.update(n,!1),this.modelManipulator.notifyModelChanged(new CS(e.subDocument.id,s.anchoredObjectID,e.position,n.currId,o.size,o.anchorInfo,o.containerProperties));const l=new on.FixedInterval(e.position,1);return this.modelManipulator.floatingObject.shape.fillColor.setValue(e.subDocument,l.clone(),o.shape.fillColor),this.modelManipulator.floatingObject.shape.outlineColor.setValue(e.subDocument,l.clone(),o.shape.outlineColor),this.modelManipulator.floatingObject.shape.outlineWidth.setValue(e.subDocument,l.clone(),o.shape.outlineWidth),new kS(!0,l,s.anchoredObjectID)}}class _S extends lu{constructor(e,t,r){super(e),this.setPropertyValue=t,this.getPropertyValue=r}setValue(e,t,r){const i=new If,n=new If,o=e.getRunByPosition(t.start),a=(o.getType(),cs.AnchoredPictureRun,o),s=a.info.containerProperties;return i.register(new Pf(t,this.getPropertyValue(s))),this.setPropertyValue(s,r),a.info.containerProperties.copyFrom(s),n.register(new Pf(t,r)),i}restoreValue(e,t){if(t.isEmpty())return;const r=t.lastObject,i=e.getRunByPosition(r.interval.start),n=(i.getType(),cs.AnchoredPictureRun,i);this.setPropertyValue(n.info.containerProperties,r.value)}}class US extends lu{createRangePermission(e,t){e.rangePermissions.push(new Dd(e.positionManager,t.interval,t.userName,t.group)),e.rangePermissions=e.rangePermissions.sort(Fd.comparer),e.filterRangePermissions(this.modelManipulator.modelManager.richOptions.documentProtection),this.modelManipulator.notifyModelChanged(new Kb(e.id,t))}deleteRangePermission(e,t,r=f.ListUtils.indexBy(e.rangePermissions,(e=>e.constRangePermission.equals(t)))){e.rangePermissions.splice(r,1)[0].destructor(e.positionManager),e.filterRangePermissions(this.modelManipulator.modelManager.richOptions.documentProtection),this.modelManipulator.notifyModelChanged(new Kb(e.id,t))}insertRangePermissionsFromSubDocument(e,t,r,i){const n=e.rangePermissions;let o=C.SearchUtils.normedInterpolationIndexOf(n,(e=>e.start),r.start);for(;n[o]&&n[o].start>=r.start;)o--;o=Math.max(0,o);for(let e;(e=n[o])&&e.start<=r.end;o++)if(r.containsInterval(e.interval)){const r=e.constRangePermission;r.interval.start+=i,r.interval.end+=i+1,this.createRangePermission(t,r)}t.rangePermissions=t.rangePermissions.sort(Fd.comparer)}deleteRangePermissions(e,t){const r=e.rangePermissions,i=[];let n=C.SearchUtils.normedInterpolationIndexOf(r,(e=>e.start),t.start);for(;r[n]&&r[n].start>=t.start;)n--;n=Math.max(0,n);for(let o;(o=r[n])&&o.interval.start<=t.end;)if(t.containsInterval(o.interval)){const t=o.constRangePermission;this.deleteRangePermission(e,t,n),i.push(t)}else n++;return i}}class HS{constructor(e,t,r,i){this.type=e,this.charPropsBundle=t,this.offsetAtStartDocument=r,this.text=i}}class VS extends HS{constructor(e,t,r,i){super(cs.InlinePictureRun,t,e,an.specialCharacters.ObjectMark),this.picInfo=r,this.options=i}}class WS extends HS{constructor(e,t,r,i,n,o,a,s,l){super(e,t,r,i),this.showCode=n,this.startPosition=o,this.separatorPosition=a,this.endPosition=s,this.hyperlinkInfo=l}}class zS extends HS{}class jS extends HS{}class XS extends HS{constructor(e,t,r,i,n,o){super(e,t,i,n),this.applyDirectlyToNewParagraph=o,this.parPropsBundle=r}}class GS extends XS{constructor(e,t,r,i,n){super(cs.SectionRun,e,t,i,an.specialCharacters.SectionMark,n),this.sectionProperties=r.sectionProperties,this.headers=r.headers.clone(),this.footers=r.footers.clone()}}class KS extends HS{constructor(e,t,r){super(cs.AnchoredPictureRun,e,r,an.specialCharacters.ObjectMark),this.picInfo=t}}class qS extends HS{constructor(e,t,r){super(cs.AnchoredTextBoxRun,e,r,an.specialCharacters.ObjectMark),this.textBoxInfo=t}}class $S{constructor(e,t,r){this.sectionIndex=e,this.removedInterval=t,this.getPropertiesFromNext=r,this.type=pd.SectionMerged}}class JS{constructor(e,t,r){this.subDocumentId=e,this.objectId=t,this.position=r,this.type=pd.AnchorObjectRemoved}}class YS{constructor(e,t,r){this.subDocumentId=e,this.interval=t,this.removedText=r,this.type=pd.IntervalRemoved}}class QS{constructor(e,t,r,i){this.subDocumentId=e,this.removedInterval=t,this.position=r,this.getPropertiesFromNext=i,this.type=pd.ParagraphMerged}}class ZS{constructor(e,t){this.currentCellIndex=0,this.modelManipulator=e,this.subDocument=t}execute(e,t,r){this.cellsIterator=new tI(this.subDocument,e);const i=new eI(this.cellsIterator);if(i.bookmarkItems=this.modelManipulator.bookmark.deleteBookmarks(this.subDocument,e),i.rangePermssionsItems=this.modelManipulator.rangePermission.deleteRangePermissions(this.subDocument,e),this.tryPackSelectionInOneRun(e,i))return i;var n=this.subDocument.getRunIterator(e);return r&&this.fillResult(e,i),this.initializeStartPositions(e.start),this.executeCore(t,e.start,n,i),this.correctTablesStart(),i}correctTablesStart(){for(let e of this.subDocument.tables){const t=e.getStartPosition(),r=this.subDocument.getParagraphByPosition(t).startLogPosition.value;t!=r&&this.modelManipulator.table.changeTableStartPosition(this.subDocument,e,r)}}initializeStartPositions(e){this.position=e,this.currentChunkIndex=C.SearchUtils.normedInterpolationIndexOf(this.subDocument.chunks,(e=>e.startLogPosition.value),e),this.currentSectionIndex=C.SearchUtils.normedInterpolationIndexOf(this.subDocument.documentModel.sections,(e=>e.startLogPosition.value),e),this.currentParagraphIndex=C.SearchUtils.normedInterpolationIndexOf(this.subDocument.paragraphs,(e=>e.startLogPosition.value),e),this.fieldIndexThatNeedDelete=-1}executeCore(e,t,r,i){var n=this.subDocument,o=new on.FixedInterval(this.position,0);let a=[];for(;r.moveNext();){if(I.Y.isAnyOf(r.currentRun.getType(),cs.AnchoredPictureRun,cs.AnchoredTextBoxRun)){const e=r.currentRun,t=r.currentInterval().start,i=new JS(this.subDocument.id,e.anchoredObjectID,t);e instanceof sh&&this.modelManipulator.model.subDocumentsCollection.replace(e.subDocId,n.id),this.modelManipulator.notifyModelChanged(i)}r.currentChunk!==n.chunks[this.currentChunkIndex]&&(this.removeAccumulatedInterval(o,this.position,0,a),this.currentChunkIndex++),n.documentModel.sections[this.currentSectionIndex]!==r.currentSection&&this.currentSectionIndex++;var s=C.SearchUtils.normedInterpolationIndexOf(n.chunks[this.currentChunkIndex].textRuns,(e=>e.startOffset),r.currentRun.startOffset);if(r.currentRun.getType()==cs.FieldCodeStartRun&&this.removeField(t),r.currentRun.getType()==cs.ParagraphRun&&1===n.paragraphs.length){i.removeLastParagraphRun();continue}r.currentRun.paragraph.length-=r.currentRun.getLength(),this.modifySectionLength(r.currentSection,-r.currentRun.getLength());this.getStrategy(r,o).call(this,o,a,s)}this.removeAccumulatedInterval(o,-1,0,a),this.shouldMergeParagraphs&&this.tryMergeStartEndParagraphs(t,e),this.cellsIterator.reset()}modifySectionLength(e,t){e.setLength(this.subDocument,e.getLength()+t)}getStrategy(e,t){return this.canRemoveRun(e.currentRun,e.currentRun.startOffset+e.currentChunk.startLogPosition.value+t.length,0===e.currentRun.paragraph.length)?e.currentRun.getType()===cs.SectionRun&&0==e.currentSection.getLength()?this.removeWholeSection:e.currentRun.getType()===cs.ParagraphRun&&0===e.currentRun.paragraph.length?this.removeWholeParagraph:e.currentRun.getType()===cs.SectionRun&&this.shouldMergeParagraphs&&0===e.currentRun.paragraph.length?this.mergePreviousParagraph:e.currentRun.isParagraphOrSectionRun()?this.skipParagraphRunAndMergeParagraphsAtTheEnd:this.removeTextRun:this.skipRunAndMoveToNextParagraph}removeTextRun(e,t,r){e.length+=this.subDocument.chunks[this.currentChunkIndex].textRuns[r].getLength(),t.push(this.removeRunInternal(this.subDocument,r))}skipParagraphRunAndMergeParagraphsAtTheEnd(e,t,r){this.skipRunAndMoveToNextParagraph(e,t,r),this.shouldMergeParagraphs=!0}skipRunAndMoveToNextParagraph(e,t,r){this.subDocument.paragraphs[this.currentParagraphIndex].length++,this.modifySectionLength(this.subDocument.documentModel.sections[this.currentSectionIndex],1),this.position++,this.removeAccumulatedInterval(e,this.position,0,t),this.currentParagraphIndex++}mergePreviousParagraph(e,t,r){0===r&&this.currentChunkIndex--;var i=this.currentParagraphIndex;const n=this.subDocument.paragraphs[i],o=n.getEndPosition()-1;n.length++,this.removeAccumulatedInterval(e,this.position,0,t),this.mergeParagraphsInternal(this.subDocument,i-1,!1),this.modelManipulator.notifyModelChanged(new QS(this.subDocument.id,new on.FixedInterval(o,1),this.subDocument.paragraphs[i-1].getEndPosition()-1,!1))}removeWholeSection(e,t,r){var i=this.subDocument,n=i.documentModel.sections[this.currentSectionIndex];if(this.removeAccumulatedInterval(e,this.position,-1,t),i.documentModel.sections.length>1){const e=n.getEndPosition();i.positionManager.unregisterPosition(n.startLogPosition),i.documentModel.sections.splice(this.currentSectionIndex,1),i.positionManager.unregisterPosition(i.paragraphs[this.currentParagraphIndex].startLogPosition),i.paragraphs.splice(this.currentParagraphIndex,1),this.removeRunInternal(i,r),this.currentSectionIndex--,this.modelManipulator.notifyModelChanged(new $S(this.currentSectionIndex+1,new on.FixedInterval(e,1),!1))}}removeWholeParagraph(e,t,r){var i=this.subDocument;if(this.removeAccumulatedInterval(e,this.position,-1,t),i.paragraphs.length>1){const e=i.paragraphs[this.currentParagraphIndex].startLogPosition,t=e.value;i.positionManager.unregisterPosition(e),i.paragraphs.splice(this.currentParagraphIndex,1),this.removeRunInternal(i,r),this.modelManipulator.notifyModelChanged(new QS(i.id,new on.FixedInterval(t,1),this.position,!1))}}tryMergeStartEndParagraphs(e,t){var r=this.subDocument,i=r.getParagraphIndexByPosition(e),n=r.paragraphs[i],o=r.paragraphs[i+1],a=C.SearchUtils.normedInterpolationIndexOf(r.documentModel.sections,(e=>e.startLogPosition.value),n.startLogPosition.value),s=r.documentModel.sections[a];if(o)if(this.modifySectionLength(s,-1),this.subDocument.isMain()&&s.getEndPosition()===n.getEndPosition()-1&&a<r.documentModel.sections.length-1){const e=r.documentModel.sections[a+1],n=s.getEndPosition();r.positionManager.unregisterPosition(e.startLogPosition),e.startLogPosition=r.positionManager.registerPosition(s.startLogPosition.value),this.modifySectionLength(e,s.getLength()),r.positionManager.unregisterPosition(s.startLogPosition),r.documentModel.sections.splice(a,1),this.mergeParagraphsInternal(r,i,t),this.modelManipulator.notifyModelChanged(new $S(a,new on.FixedInterval(n,1),!!t))}else{const e=o.startLogPosition.value-1;this.mergeParagraphsInternal(r,i,t),this.modelManipulator.notifyModelChanged(new QS(r.id,new on.FixedInterval(e,1),o.startLogPosition.value-1,!!t))}}removeField(e){this.fieldIndexThatNeedDelete<0&&(this.fieldIndexThatNeedDelete=Md.normedBinaryIndexOf(this.subDocument.fields,e+1),(this.fieldIndexThatNeedDelete<0||e>this.subDocument.fields[this.fieldIndexThatNeedDelete].getFieldStartPosition())&&this.fieldIndexThatNeedDelete++),Md.deleteFieldByIndex(this.subDocument,this.fieldIndexThatNeedDelete,this.modelManipulator)}tryPackSelectionInOneRun(e,t){const r=this.subDocument.getRunAndIndexesByPosition(e.start),i=r.chunk.startLogPosition.value+r.run.startOffset,n=i+r.run.getLength(),o=e.end,a=e.start;if(i<a&&o<n){const i=r.chunk.startLogPosition.value,n=a-i,s=o-i,l=r.chunk.getTextInChunk(n,e.length);t.registerItem(new HS(r.run.getType(),r.run.getCharPropsBundle(this.modelManipulator.model),a,l)),r.run.incLength(-e.length),r.chunk.textBuffer=[r.chunk.textBuffer.substr(0,n),r.chunk.textBuffer.substr(s)].join("");const d=C.SearchUtils.normedInterpolationIndexOf(this.subDocument.paragraphs,(e=>e.startLogPosition.value),a);this.subDocument.paragraphs[d].length-=e.length;const c=C.SearchUtils.normedInterpolationIndexOf(this.subDocument.documentModel.sections,(e=>e.startLogPosition.value),a);return this.modifySectionLength(this.subDocument.documentModel.sections[c],-e.length),db.moveRunsInChunk(r.chunk,r.runIndex+1,-e.length),this.subDocument.positionManager.advance(a,-e.length),this.modelManipulator.notifyModelChanged(new YS(this.subDocument.id,e,l)),!0}return!1}canRemoveRun(e,t,r){if(e.getType()===cs.ParagraphRun){this.cellsIterator.moveTo(t);let e=this.cellsIterator.getCurrent();if(e&&t===e.endParagrapPosition.value-1)return!1;let i=this.cellsIterator.getNext();if(i&&i.startParagraphPosition.value===t+1){if(!r)return!1;let e=this.cellsIterator.getPrev();if(e&&e.parentRow.parentTable.getLastCell()===e)return!1}}return!0}fillResult(e,t){for(var r=this.subDocument.getRunIterator(e),i=void 0,n=0;r.moveNext();){var o=r.currentRun,a=r.currentChunk,s=r.currentInterval();if(n+=s.length,this.canRemoveRun(o,s.start,r.currentRun.paragraph.length===n))switch(o.getType()){case cs.TextRun:t.registerItem(new HS(o.getType(),o.getCharPropsBundle(this.modelManipulator.model),s.start,a.getRunText(o)));break;case cs.ParagraphRun:case cs.SectionRun:var l;if(void 0===i&&(i=o.paragraph.startLogPosition.value==e.start),i)l=o.paragraph;else{var d=C.SearchUtils.normedInterpolationIndexOf(this.subDocument.paragraphs,(e=>e.startLogPosition.value),o.paragraph.startLogPosition.value)+1;l=this.subDocument.paragraphs[d]}o.getType()==cs.ParagraphRun?t.registerItem(new XS(o.getType(),o.getCharPropsBundle(this.modelManipulator.model),l.getParagraphBundleFull(this.modelManipulator.model),s.start,a.getRunText(o),i)):t.registerItem(new GS(o.getCharPropsBundle(this.modelManipulator.model),l.getParagraphBundleFull(this.modelManipulator.model),r.currentSection,s.start,i)),n=0;break;case cs.InlinePictureRun:var c=o;if(!(c instanceof lh))throw new Error("In TexManipulator.getHistoryRunsFromInterval currentPictureRun not have type InlinePictureRun");t.registerItem(new VS(s.start,o.getCharPropsBundle(this.modelManipulator.model),c.info.clone()));break;case cs.FieldCodeStartRun:var h=s.start,u=Md.normedBinaryIndexOf(this.subDocument.fields,h+1),p=this.subDocument.fields[u];t.registerItem(new WS(o.getType(),o.getCharPropsBundle(this.modelManipulator.model),h,a.getRunText(o),p.showCode,p.getFieldStartPosition(),p.getSeparatorPosition(),p.getFieldEndPosition(),p.getHyperlinkInfo()?p.getHyperlinkInfo().clone():void 0));break;case cs.FieldCodeEndRun:t.registerItem(new zS(o.getType(),o.getCharPropsBundle(this.modelManipulator.model),s.start,a.getRunText(o)));break;case cs.FieldResultEndRun:t.registerItem(new jS(o.getType(),o.getCharPropsBundle(this.modelManipulator.model),s.start,a.getRunText(o)));break;case cs.AnchoredPictureRun:var g=o;if(!(g instanceof ah))throw new Error("In TextManipulator.getHistoryRunsFromInterval currentAnchoredRun is not of type AnchoredPictureRun");t.registerItem(new KS(o.getCharPropsBundle(this.modelManipulator.model),g.info.clone(),s.start));break;case cs.AnchoredTextBoxRun:const m=o;if(!(m instanceof sh))throw new Error("In TextManipulator.getHistoryRunsFromInterval currentAnchoredTextBoxRun is not of type AnchoredTextBoxRun");t.registerItem(new qS(o.getCharPropsBundle(this.modelManipulator.model),new hb(this.modelManipulator.model.subDocuments[m.subDocId],m.size.clone(),m.shape.clone(),m.anchorInfo.clone(),m.textBoxProperties.clone(),m.containerProperties.clone()),s.start))}else o.isParagraphOrSectionRun()&&(n=0)}r.reset(),this.cellsIterator.reset()}removeAccumulatedInterval(e,t,r,i){if(r-=e.length,Math.abs(r)>0&&this.subDocument.positionManager.advance(e.start,r),e.length){const t=i.join("");this.modelManipulator.notifyModelChanged(new YS(this.subDocument.id,e.clone(),t)),i.splice(0)}e.start=t,e.length=0}mergeParagraphsInternal(e,t,r){var i=e.paragraphs[t],n=e.paragraphs[t+1],o=e.getRunAndIndexesByPosition(n.startLogPosition.value-1);r&&i.copyFrom(n);var a=e.getRunsByInterval(new on.FixedInterval(n.startLogPosition.value,n.length)),s=this.currentChunkIndex-o.chunkIndex;this.currentChunkIndex=o.chunkIndex,this.removeRunInternal(e,o.runIndex),this.currentChunkIndex+=s,i.length--;for(var l,d=0;l=a[d];d++)l.paragraph=i,l.onCharacterPropertiesChanged(),i.length+=l.getLength();e.positionManager.advance(n.startLogPosition.value,-1,-1),e.positionManager.unregisterPosition(n.startLogPosition),e.paragraphs.splice(t+1,1)}removeRunInternal(e,t){const r=e.chunks[this.currentChunkIndex],i=r.textRuns[t],n=r.textBuffer.substr(i.startOffset,i.getLength());return r.textBuffer=r.textBuffer.substr(0,i.startOffset)+r.textBuffer.substr(i.startOffset+i.getLength()),r.textRuns.splice(t,1),db.moveRunsInChunk(r,t,-i.getLength()),0===r.textRuns.length&&(e.positionManager.unregisterPosition(r.startLogPosition),e.chunks.splice(this.currentChunkIndex--,1)),n}}class eI{constructor(e){this.historyRuns=[],this.nestingLevels=[],this.bookmarkItems=[],this.rangePermssionsItems=[],this.cellsIterator=e}registerItem(e){this.cellsIterator.moveTo(e.offsetAtStartDocument);var t=this.cellsIterator.getCurrent();this.registerItemCore(e,t?t.parentRow.parentTable.nestedLevel:-1)}registerItemCore(e,t){this.historyRuns.push(e),this.nestingLevels.push(t)}removeLastParagraphRun(){var e=this.historyRuns.length-1,t=this.historyRuns[e];t&&t.type==cs.ParagraphRun&&(this.historyRuns.splice(e,1),this.nestingLevels.splice(e,1))}getIterator(){return new rI(this.historyRuns,this.nestingLevels)}}class tI{constructor(e,t){this.current=0,this.cells=tI.getCellsByInterval(e,t)}moveTo(e){let t;for(e<this.position&&this.reset(),this.position=e;t=this.cells[this.current];){if(!(e>=t.endParagrapPosition.value))return!0;this.current++}return!1}getCurrent(){let e=this.cells[this.current];return e?tI.correctCurrent(this.position,e):null}getPrev(){let e=this.cells[this.current];return e&&this.position>=e.endParagrapPosition.value?e:this.cells[this.current-1]||null}getNext(){let e=this.cells[this.current];return e&&this.position<e.startParagraphPosition.value?e:this.cells[this.current+1]||null}reset(){this.current=0,this.position=0}static getCellsByInterval(e,t){if(0===e.tables.length)return[];let r=e.tablesByLevels[0][Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e.tablesByLevels[0],(e=>e.getStartPosition()),t.start))],i=t.end;if(i<r.getStartPosition())return[];let n=[];return this.collectCellsByIntervalCore(e,n,r,t.start,i),n.sort(((e,t)=>e.endParagrapPosition.value-t.endParagrapPosition.value))}static collectCellsByIntervalCore(e,t,r,i,n){let o=e.tables[r.index+1];o&&o.getStartPosition()<=n&&this.collectCellsByIntervalCore(e,t,o,i,n);for(let e,o=0;e=r.rows[o];o++)for(let r,o=0;r=e.cells[o];o++)if(i<r.endParagrapPosition.value&&n>r.startParagraphPosition.value)t.push(r);else if(i===r.endParagrapPosition.value&&r.parentRow.parentTable.getLastCell()===r)t.push(r);else if(r.parentRow.parentTable.getFirstCell()===r&&r.startParagraphPosition.value===n)t.push(r);else if(r.startParagraphPosition.value>n)return}static correctCurrent(e,t){return e>=t.startParagraphPosition.value&&e<t.endParagrapPosition.value?t:e<t.startParagraphPosition.value&&t.parentRow.parentTable.parentCell?this.correctCurrent(e,t.parentRow.parentTable.parentCell):null}}class rI{constructor(e,t){this.position=-1,this.historyRuns=e,this.nestingLevels=t}moveNext(){return this.position++,this.currentHistoryRun=this.historyRuns[this.position],this.currentNestingLevel=this.nestingLevels[this.position],!!this.currentHistoryRun}}class iI{constructor(e,t){this.currentTableIndex=void 0,this.modelManipulator=e,this.subDocument=t}execute(e){var t=e.getIterator(),r=this.subDocument,i=this.subDocument.fields;const n=[];for(;t.moveNext();){var o=t.currentHistoryRun;switch(o.type){case cs.ParagraphRun:{if(!(o instanceof XS))throw new Error("In unpackHistoryRunsToModel type text run = TextRunType.ParagraphRun, but type historyRun != HistoryRunParagraph. historyRun.offsetAtStartDocument = "+o.offsetAtStartDocument+", historyRun.text = "+o.text);let e=o,i=this.getTableForShifting(e.offsetAtStartDocument);this.modelManipulator.paragraph.insertParagraphInner(new Ag(new pu(r,e.offsetAtStartDocument),e.charPropsBundle,e.parPropsBundle,e.applyDirectlyToNewParagraph)),i&&i.nestedLevel>t.currentNestingLevel&&this.shiftTablesToPosition(i,e.offsetAtStartDocument+1,t.currentNestingLevel);break}case cs.SectionRun:if(!(o instanceof GS))throw new Error("In unpackHistoryRunsToModel type text run = TextRunType.SectionRun, but type historyRun != HistoryRunSection. historyRun.offsetAtStartDocument = "+o.offsetAtStartDocument+", historyRun.text = "+o.text);var a=o;this.modelManipulator.section.insertSection(new pu(r,a.offsetAtStartDocument),a.charPropsBundle,a.sectionProperties,!0,a.parPropsBundle,a.applyDirectlyToNewParagraph);break;case cs.InlinePictureRun:{if(!(o instanceof VS))throw new Error("In unpackHistoryRunsToModel type text run = TextRunType.InlinePictureRun, but type historyRun != HistoryRunInlinePicture. historyRun.offsetAtStartDocument = "+o.offsetAtStartDocument+", historyRun.text = "+o.text);const e=o;this.modelManipulator.picture.insertInlinePictureInner(new pu(r,e.offsetAtStartDocument),e.charPropsBundle,e.picInfo,e.options);break}case cs.FieldCodeStartRun:if(!(o instanceof WS))throw new Error("In unpackHistoryRunsToModel type text run = TextRunType.HistoryRunFieldCodeStart, but type historyRun != HistoryRunFieldCodeStart. historyRun.offsetAtStartDocument = "+o.offsetAtStartDocument+", historyRun.text = "+o.text);n.push(o),this.modelManipulator.text.insertTextInner(new op(new pu(r,o.offsetAtStartDocument),o.charPropsBundle,o.type,o.text));break;case cs.FieldResultEndRun:this.modelManipulator.text.insertTextInner(new op(new pu(r,o.offsetAtStartDocument),o.charPropsBundle,o.type,o.text));var s=n.pop(),l=0;i.length>0&&(l=Math.max(0,Md.normedBinaryIndexOf(i,s.startPosition+1)),s.startPosition>i[l].getFieldStartPosition()&&l++);var d=new Md(r.positionManager,l,s.startPosition,s.separatorPosition,s.endPosition,s.showCode,s.hyperlinkInfo?s.hyperlinkInfo.clone():void 0);Md.addField(i,d),this.modelManipulator.notifyModelChanged(new up(r.id,s.startPosition,s.separatorPosition,s.endPosition)),s.hyperlinkInfo&&this.modelManipulator.notifyModelChanged(new vm(r.id,on.FixedInterval.fromPositions(s.separatorPosition+1,s.endPosition-1),on.FixedInterval.fromPositions(s.startPosition+1,s.endPosition),s.hyperlinkInfo));break;case cs.AnchoredPictureRun:{const e=o;this.modelManipulator.picture.insertAnchoredPictureInner(new pu(r,o.offsetAtStartDocument),o.charPropsBundle,e.picInfo);break}case cs.AnchoredTextBoxRun:{const e=o,t=e.textBoxInfo.innerSubDocument;this.modelManipulator.textBox.insertAnchoredTextBox(new pu(r,o.offsetAtStartDocument),o.charPropsBundle,e.textBoxInfo),this.modelManipulator.model.subDocumentsCollection.restore(t.id);break}default:this.modelManipulator.text.insertTextInner(new op(new pu(r,o.offsetAtStartDocument),o.charPropsBundle,o.type,o.text))}}for(let t of e.bookmarkItems)this.modelManipulator.bookmark.createBookmark(r,t,!1);r.bookmarks=r.bookmarks.sort(Sd.comparer)}shiftTablesToPosition(e,t,r){this.modelManipulator.table.changeTableStartPosition(this.subDocument,e,t);var i=this.subDocument.tables[e.index-1];i&&i.nestedLevel>r&&this.shiftTablesToPosition(i,t,r)}getTableForShifting(e){if(void 0===this.currentTableIndex)for(this.currentTableIndex=C.SearchUtils.normedInterpolationIndexOf(this.subDocument.tables,(e=>e.getStartPosition()),e);this.currentTableIndex>-1&&this.subDocument.tables[this.currentTableIndex].nestedLevel>0;)this.currentTableIndex--;for(var t;t=this.subDocument.tables[this.currentTableIndex];)if(e>=t.getEndPosition())this.currentTableIndex++;else{if(e<t.getStartPosition())return null;var r=this.subDocument.tables[this.currentTableIndex+1];if(!r||r.getStartPosition()>e)return t;this.currentTableIndex++}return null}}class nI extends lu{copyIntervalTo(e,t,r){this.history.addTransaction((()=>{fb.create(new mu(e,[t])).insertTo(this.modelManipulator,new pu(e,r))}))}moveIntervalTo(e,t){e.validateInterval(),this.history.beginTransaction();const r=fb.create(new mu(e.subDocument,[e.interval])).insertTo(this.modelManipulator,new pu(e.subDocument,t));return t<e.interval.start?this.removeInterval(new gu(e.subDocument,new on.FixedInterval(e.interval.start+r.length,e.interval.length)),!1,!0):(this.removeInterval(e,!1,!0),r.start-=e.interval.length),this.history.endTransaction(),r}removeIntervalInner(e,t,r){return new ZS(this.modelManipulator,e).execute(t,r,!0)}removeIntervalWithoutHistory(e,t,r){new ZS(this.modelManipulator,e).execute(t,r,!1)}restoreRemovedInterval(e,t){new iI(this.modelManipulator,e).execute(t)}unpackHistoryRunsToModel(e,t){for(var r,i=e.fields,n=[],o=0;r=t[o];o++)switch(r.type){case cs.ParagraphRun:if(!(r instanceof XS))throw new Error("In unpackHistoryRunsToModel type text run = TextRunType.ParagraphRun, but type historyRun != HistoryRunParagraph. historyRun.offsetAtStartDocument = "+r.offsetAtStartDocument+", historyRun.text = "+r.text);var a=r;this.modelManipulator.paragraph.insertParagraphInner(new Ag(new pu(e,a.offsetAtStartDocument),a.charPropsBundle,a.parPropsBundle,a.applyDirectlyToNewParagraph));break;case cs.SectionRun:if(!(r instanceof GS))throw new Error("In unpackHistoryRunsToModel type text run = TextRunType.SectionRun, but type historyRun != HistoryRunSection. historyRun.offsetAtStartDocument = "+r.offsetAtStartDocument+", historyRun.text = "+r.text);var s=r;this.modelManipulator.section.insertSection(new pu(e,s.offsetAtStartDocument),s.charPropsBundle,s.sectionProperties,!0,s.parPropsBundle,s.applyDirectlyToNewParagraph);break;case cs.InlinePictureRun:if(!(r instanceof VS))throw new Error("In unpackHistoryRunsToModel type text run = TextRunType.InlinePictureRun, but type historyRun != HistoryRunInlinePicture. historyRun.offsetAtStartDocument = "+r.offsetAtStartDocument+", historyRun.text = "+r.text);this.modelManipulator.picture.insertInlinePictureInner(new pu(e,r.offsetAtStartDocument),r.charPropsBundle,r.picInfo,r.options);break;case cs.FieldCodeStartRun:if(!(r instanceof WS))throw new Error("In unpackHistoryRunsToModel type text run = TextRunType.HistoryRunFieldCodeStart, but type historyRun != HistoryRunFieldCodeStart. historyRun.offsetAtStartDocument = "+r.offsetAtStartDocument+", historyRun.text = "+r.text);n.push(r),this.modelManipulator.text.insertTextInner(new op(new pu(e,r.offsetAtStartDocument),r.charPropsBundle,r.type,r.text));break;case cs.FieldResultEndRun:this.modelManipulator.text.insertTextInner(new op(new pu(e,r.offsetAtStartDocument),r.charPropsBundle,r.type,r.text));var l=n.pop(),d=0;i.length>0&&(d=Math.max(0,Md.normedBinaryIndexOf(i,l.startPosition+1)),l.startPosition>i[d].getFieldStartPosition()&&d++);var c=new Md(e.positionManager,d,l.startPosition,l.separatorPosition,l.endPosition,l.showCode,l.hyperlinkInfo?l.hyperlinkInfo.clone():void 0);Md.addField(i,c),this.modelManipulator.notifyModelChanged(new up(e.id,l.startPosition,l.separatorPosition,l.endPosition)),l.hyperlinkInfo&&this.modelManipulator.notifyModelChanged(new vm(e.id,on.FixedInterval.fromPositions(l.separatorPosition+1,l.endPosition-1),on.FixedInterval.fromPositions(l.startPosition+1,l.separatorPosition),l.hyperlinkInfo));break;default:this.modelManipulator.text.insertTextInner(new op(new pu(e,r.offsetAtStartDocument),r.charPropsBundle,r.type,r.text))}}removeInterval(e,t,r,i){if(0==e.interval.length)return;this.history.beginTransaction(),this.modelManipulator.table.removeTablesOnInterval(e,t);const n=e.subDocument.getDocumentEndPosition(),o=r&&0===e.interval.start&&e.interval.length===n,a=e.interval.end;if(a==n)e.interval.length-=1;else{const t=e.subDocument.getParagraphIndexByPosition(a);if(t>0){const r=e.subDocument.paragraphs[t],n=e.subDocument.paragraphs[t-1],o=a==r.startLogPosition.value,s=o&&1==e.interval.length,l=o&&!n.getTableCell()&&r.getTableCell();!s&&i&&l&&(e.interval.length-=1)}}var s=C.SearchUtils.binaryIndexOf(e.subDocument.paragraphs,(t=>t.startLogPosition.value-e.interval.start))>=0;this.history.addAndRedo(new Hm(this.modelManipulator,e,s)),o&&(this.history.addAndRedo(new Dt(this.modelManipulator,e.subDocument,0,Lt.createDefault(this.model),this.model.getDefaultParagraphStyle(),-1,-1,new ts)),this.modelManipulator.characterProperties.resetCharacterFormatting(e.subDocument,new on.FixedInterval(0,1))),this.history.endTransaction()}}class oI extends nb{constructor(e,t,r,i){super(e,t,1),this.section=r,this.sectionIndex=i,this.type=pd.SectionInserted}}class aI extends ab{constructor(e,t,r,i,n,o,a){super(e,t),this.charPropsBundle=r,this.parPropsBundle=i,this.sectionProperties=n,this.isInsertPropertiesToCurrentSection=o,this.isInsertPropertiesAndStyleIndexToCurrentParagraph=a}redo(){this.modelManipulator.section.insertSection(this.subDocPos,this.charPropsBundle,this.sectionProperties,this.isInsertPropertiesToCurrentSection,this.parPropsBundle,this.isInsertPropertiesAndStyleIndexToCurrentParagraph)}undo(){this.modelManipulator.range.removeIntervalWithoutHistory(this.boundSubDocument,new on.FixedInterval(this.subDocPos.position,an.specialCharacters.SectionMark.length),!1)}}class sI extends db{insertSectionAndSetStartType(e,t,r){const i=this.model.mainSubDocument;if(e>=i.getDocumentEndPosition())throw"ModelManipulator.insertSectionAndSetStartType position >= documentEndPosition";const n=i.getSectionByPosition(e).sectionProperties.clone();n.startType=t,this.history.beginTransaction(),this.history.addAndRedo(new aI(this.modelManipulator,new pu(i,e),r,new mn(null,null,void 0,void 0),n,!1,!0)),this.history.endTransaction()}insertSection(e,t,r,i,n,o){const a=e.subDocument,s=e.position;if(!a.isMain())throw new Error("Section cannot be inserted in a non-main subDocument");var l=C.SearchUtils.normedInterpolationIndexOf(a.documentModel.sections,(e=>e.startLogPosition.value),s),d=a.documentModel.sections[l],c=s-d.startLogPosition.value+1,h=this.insertRunInternal(e,t,cs.SectionRun,an.specialCharacters.SectionMark),u=C.SearchUtils.normedInterpolationIndexOf(a.paragraphs,(e=>e.startLogPosition.value),s),p=a.paragraphs[u],g=s-p.startLogPosition.value+1,m=p.length-g+1,f=a.positionManager.registerPosition(s+1),b=new ns(a,f,m,null,null);p.length=g,a.paragraphs.splice(u+1,0,b),this.modelManipulator.paragraph.applyParagraphProperties(b,p,o,n);var S,I=h.runIndex+1;e:for(var P=h.chunkIndex;w=a.chunks[P];P++){for(;y=w.textRuns[I];I++)if(y.paragraph=b,y.onCharacterPropertiesChanged(),y.isParagraphOrSectionRun())break e;I=0}I=h.runIndex-1;var w;e:for(P=h.chunkIndex;w=a.chunks[P];P--){for(var y;y=w.textRuns[I];I--){if(y.isParagraphOrSectionRun())break e;y.onCharacterPropertiesChanged()}P>0&&(I=a.chunks[P-1].textRuns.length-1)}a.positionManager.unregisterPosition(d.startLogPosition),r?i?S=r:(S=d.sectionProperties,d.sectionProperties=r):S=d.sectionProperties;var x=new Ch(a.documentModel,a.positionManager.registerPosition(d.startLogPosition.value),c,S);x.headers=d.headers,x.headers.section=x,x.footers=d.footers,x.footers.section=x,d.headers=new fh(d),d.footers=new bh(d),d.startLogPosition=a.positionManager.registerPosition(s+1),d.setLength(a,d.getLength()-c-1+1),a.documentModel.sections.splice(l,0,x),this.modelManipulator.notifyModelChanged(new oI(a.id,s,x,l))}}class lI{constructor(e,t,r,i){this.startSectionIndex=e,this.endSectionIndex=t,this.property=r,this.newState=i,this.type=pd.SectionFormattingChanged}}class dI extends Ze{constructor(e,t,r){super(e),this.newValue=r,this.interval=t}redo(){this.oldState=this.getPropertiesManipulator().setValue(this.interval,this.newValue)}undo(){this.getPropertiesManipulator().restoreValue(this.oldState)}}class cI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.marginLeft}}class hI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.marginTop}}class uI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.marginRight}}class pI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.marginBottom}}class gI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.columnCount}}class mI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.space}}class fI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.equalWidthColumns}}class bI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.columnsInfo}}class CI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.pageWidth}}class SI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.pageHeight}}class II extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.startType}}class PI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.landscape}}class wI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.differentFirstPage}}class yI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.headerOffset}}class xI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.footerOffset}}class TI extends dI{getPropertiesManipulator(){return this.modelManipulator.sectionProperties.paperKind}}class vI{}vI.marginLeft=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=1440}setProp(e,t){e.marginLeft=t}getProp(e){return e.marginLeft}getHistoryItemConstructor(){return cI}getJSONProperty(){return Hc.MarginLeft}},vI.marginTop=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=1440}setProp(e,t){e.marginTop=t}getProp(e){return e.marginTop}getHistoryItemConstructor(){return hI}getJSONProperty(){return Hc.MarginTop}},vI.marginRight=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=1440}setProp(e,t){e.marginRight=t}getProp(e){return e.marginRight}getHistoryItemConstructor(){return uI}getJSONProperty(){return Hc.MarginRight}},vI.marginBottom=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=1440}setProp(e,t){e.marginBottom=t}getProp(e){return e.marginBottom}getHistoryItemConstructor(){return pI}getJSONProperty(){return Hc.MarginBottom}},vI.footerOffset=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=720}setProp(e,t){e.footerOffset=t}getProp(e){return e.footerOffset}getHistoryItemConstructor(){return xI}getJSONProperty(){return Hc.FooterOffset}},vI.headerOffset=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=720}setProp(e,t){e.headerOffset=t}getProp(e){return e.headerOffset}getHistoryItemConstructor(){return yI}getJSONProperty(){return Hc.HeaderOffset}},vI.columnCount=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=1}setProp(e,t){e.columnCount=t}getProp(e){return e.columnCount}getHistoryItemConstructor(){return gI}getJSONProperty(){return Hc.ColumnCount}},vI.space=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=720}setProp(e,t){e.space=t}getProp(e){return e.space}getHistoryItemConstructor(){return mI}getJSONProperty(){return Hc.Space}},vI.equalWidthColumns=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!0}setProp(e,t){e.equalWidthColumns=t}getProp(e){return e.equalWidthColumns}getHistoryItemConstructor(){return fI}getJSONProperty(){return Hc.EqualWidthColumns}},vI.columnsInfo=new class{constructor(){this.binaryEquals=Sh.equalsColumnsInfoBinary,this.defaultValue=[]}setProp(e,t){e.columnsInfo=t}getProp(e){return e.columnsInfo}getHistoryItemConstructor(){return bI}getJSONProperty(){return Hc.ColumnsInfo}},vI.pageWidth=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=11906}setProp(e,t){e.pageWidth=t}getProp(e){return e.pageWidth}getHistoryItemConstructor(){return CI}getJSONProperty(){return Hc.PageWidth}},vI.pageHeight=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=16838}setProp(e,t){e.pageHeight=t}getProp(e){return e.pageHeight}getHistoryItemConstructor(){return SI}getJSONProperty(){return Hc.PageHeight}},vI.startType=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=Vs.NextPage}setProp(e,t){e.startType=t}getProp(e){return e.startType}getHistoryItemConstructor(){return II}getJSONProperty(){return Hc.StartType}},vI.landscape=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.landscape=t}getProp(e){return e.landscape}getHistoryItemConstructor(){return PI}getJSONProperty(){return Hc.Landscape}},vI.differentFirstPage=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=!1}setProp(e,t){e.differentFirstPage=t}getProp(e){return e.differentFirstPage}getHistoryItemConstructor(){return wI}getJSONProperty(){return Hc.DifferentFirstPage}},vI.paperKind=new class{constructor(){this.binaryEquals=Qe.Equals.simpleType,this.defaultValue=Vc.Letter}setProp(e,t){e.paperKind=t}getProp(e){return e.paperKind}getHistoryItemConstructor(){return TI}getJSONProperty(){return Hc.PaperKind}},vI.ALL_FIELDS=[vI.marginLeft,vI.marginTop,vI.marginRight,vI.marginBottom,vI.footerOffset,vI.headerOffset,vI.columnCount,vI.space,vI.equalWidthColumns,vI.columnsInfo,vI.pageWidth,vI.pageHeight,vI.startType,vI.landscape,vI.differentFirstPage,vI.paperKind];class MI extends lu{constructor(e){super(e),this.landscape=new DI(e,vI.landscape),this.marginBottom=new EI(e,vI.marginBottom),this.marginLeft=new EI(e,vI.marginLeft),this.marginRight=new EI(e,vI.marginRight),this.marginTop=new EI(e,vI.marginTop),this.columnCount=new EI(e,vI.columnCount),this.columnsInfo=new EI(e,vI.columnsInfo),this.equalWidthColumns=new EI(e,vI.equalWidthColumns),this.pageHeight=new EI(e,vI.pageHeight),this.pageWidth=new EI(e,vI.pageWidth),this.space=new EI(e,vI.space),this.startType=new EI(e,vI.startType),this.differentFirstPage=new EI(e,vI.differentFirstPage),this.headerOffset=new EI(e,vI.headerOffset),this.footerOffset=new EI(e,vI.footerOffset),this.paperKind=new EI(e,vI.paperKind)}}class EI{constructor(e,t){this.manipulator=e,this.descriptor=t}setValue(e,t){var r=new Sf;if(!Bb.isEnabled(this.manipulator.model.options.sections))return r;for(var i=new Sf,n=Math.max(e.start,e.end-1),o=this.manipulator.model.sections,a=C.SearchUtils.normedInterpolationIndexOf(o,(e=>e.startLogPosition.value),e.start),s=e.length?C.SearchUtils.normedInterpolationIndexOf(o,(e=>e.startLogPosition.value),n):a,l=a;l<=s;l++){var d=o[l];r.register(new Mf(l,this.descriptor.getProp(d.sectionProperties))),i.register(new Mf(l,t)),this.setPropertyValue(d.sectionProperties,t)}return this.manipulator.notifyModelChanged(new lI(a,s,this.descriptor.getJSONProperty(),i)),r}restoreValue(e){if(!Bb.isEnabled(this.manipulator.model.options.sections))return;if(e.isEmpty())return;for(var t,r=this.manipulator.model.sections,i=0;t=e.objects[i];i++){var n=r[t.sectionIndex];this.setPropertyValue(n.sectionProperties,t.value)}const o=e.objects[0].sectionIndex,a=e.lastObject.sectionIndex;this.manipulator.notifyModelChanged(new lI(o,a,this.descriptor.getJSONProperty(),e))}setPropertyValue(e,t){this.descriptor.setProp(e,t)}}class DI extends EI{setPropertyValue(e,t){e.landscape!==t&&(e.landscape=t,[e.pageWidth,e.pageHeight]=[e.pageHeight,e.pageWidth])}}class FI{constructor(e){this.paragraphStyleName=e,this.type=pd.CreateStyleLink}}class RI{constructor(e){this.paragraphStyleName=e,this.type=pd.DeleteStyleLink}}class LI{constructor(e,t){this.subDocumentId=e,this.newState=t,this.type=pd.CharacterStyleApplied}}class BI{constructor(e,t){this.subDocumentId=e,this.newState=t,this.type=pd.ParagraphStyleApplied}}class AI extends Ze{constructor(e,t,r){super(e),this.characterStyle=t,this.paragraphStyle=r}redo(){this.modelManipulator.style.setLinkStyle(this.characterStyle,this.paragraphStyle)}undo(){this.modelManipulator.style.restoreLinkStyle(this.characterStyle,this.paragraphStyle)}}class NI extends lu{setLinkStyle(e,t){this.modelManipulator.model.stylesManager.addCharacterStyle(e),this.modelManipulator.model.stylesManager.registerLink(e,t),this.modelManipulator.notifyModelChanged(new FI(t.styleName))}restoreLinkStyle(e,t){this.modelManipulator.model.stylesManager.removeLastStyle(),this.modelManipulator.model.stylesManager.unregisterLink(e,t),this.modelManipulator.notifyModelChanged(new RI(t.styleName))}setCharacterStyle(e,t,r,i){var n=new If;if(!Bb.isEnabled(e.documentModel.options.characterStyle))return n;for(var o=new If,a=e.getRunIterator(t);a.moveNext();){let t=r;var s=a.currentInterval();if(i){var l=yb.getHyperlinkField(e.fields,s);if(l&&l.isHyperlinkField()){if(a.currentRun.characterStyle.styleName===zl.hyperlinkStyleName)continue;t=e.documentModel.getCharacterStyleByName(zl.hyperlinkStyleName)}}n.register(new xf(s,a.currentRun.characterStyle)),o.register(new xf(s,t)),a.currentRun.characterStyle=t,a.currentRun.onCharacterPropertiesChanged()}return o.isEmpty()||this.modelManipulator.notifyModelChanged(new LI(e.id,o)),n}restoreCharacterStyle(e,t){if(Bb.isEnabled(e.documentModel.options.characterStyle)&&!t.isEmpty()){for(var r,i=0;r=t.objects[i];i++)for(var n=e.getRunIterator(r.interval);n.moveNext();)n.currentRun.characterStyle=r.value,n.currentRun.onCharacterPropertiesChanged();this.modelManipulator.notifyModelChanged(new LI(e.id,t))}}setParagraphStyle(e,t,r){var i=new If;if(!Bb.isEnabled(e.documentModel.options.paragraphStyle))return i;for(var n,o=new If,a=e.getParagraphsByInterval(t),s=0;n=a[s];s++){var l=new on.FixedInterval(n.startLogPosition.value,n.length);i.register(new xf(l,n.paragraphStyle)),o.register(new xf(l,r)),n.paragraphStyle=r,n.onParagraphPropertiesChanged(),this.resetMergedCharacterProperties(e,l)}return this.modelManipulator.notifyModelChanged(new BI(e.id,o)),i}restoreParagraphStyle(e,t){if(Bb.isEnabled(e.documentModel.options.paragraphStyle)){for(var r,i=0;r=t.objects[i];i++)for(var n,o=e.getParagraphsByInterval(r.interval),a=0;n=o[a];a++)n.paragraphStyle=r.value,n.onParagraphPropertiesChanged(),this.resetMergedCharacterProperties(e,new on.FixedInterval(n.startLogPosition.value,n.length));this.modelManipulator.notifyModelChanged(new BI(e.id,t))}}resetMergedCharacterProperties(e,t){for(var r,i=e.getRunsByInterval(t),n=0;r=i[n];n++)r.onCharacterPropertiesChanged()}applyCharacterStyle(e,t,r){return!(!Bb.isEnabled(this.modelManipulator.modelManager.richOptions.control.characterStyle)||!t)&&(this.history.beginTransaction(),this.history.addAndRedo(new At(this.modelManipulator,e,0)),this.history.addAndRedo(new kp(this.modelManipulator,e,t,r)),this.history.endTransaction(),!0)}applyCharacterStyleByName(e,t){let r=this.model.getCharacterStyleByName(t);return r||(r=this.model.stylesManager.addCharacterStyle(Wh.getPresetCharacterStyleByName(t).clone())),this.applyCharacterStyle(e,r,!1)}applyParagraphStyleByName(e,t){let r=this.model.getParagraphStyleByName(t);return r||(r=this.model.stylesManager.addParagraphStyle(Wh.getPresetParagraphStyleByName(t).clone())),this.applyParagraphStyle(e,r)}applyParagraphStyle(e,t){if(!Bb.isEnabled(this.modelManipulator.modelManager.richOptions.control.paragraphStyle)||!t)return!1;const r=this.calculateAffectedParagraphCount(e);if(!(r>0&&Bb.isEnabled(this.modelManipulator.modelManager.richOptions.control.paragraphStyle)))return!!Bb.isEnabled(this.modelManipulator.modelManager.richOptions.control.characterStyle)&&(t.linkedStyle||this.createCharacterStyle(t),this.applyCharacterStyle(e,t.linkedStyle,!1));{const a=C.SearchUtils.normedInterpolationIndexOf(e.subDocument.paragraphs,(e=>e.startLogPosition.value),e.interval.start);this.history.beginTransaction();for(var i=0;i<r;i++){var n=e.subDocument.paragraphs[a+i],o=new on.FixedInterval(n.startLogPosition.value,n.length);this.history.addAndRedo(new Op(this.modelManipulator,new gu(e.subDocument,o),t)),this.history.addAndRedo(new rt(this.modelManipulator,new gu(e.subDocument,o),0)),this.history.addAndRedo(new At(this.modelManipulator,new gu(e.subDocument,o),0))}this.history.endTransaction()}return!0}calculateAffectedParagraphCount(e){const t=e.subDocument.getParagraphsByInterval(e.interval);if(t.length>1)return t.length;const r=t[0],i=e.interval.length>=r.length-1;return e.interval.start===r.startLogPosition.value&&i||0===e.interval.length?1:0}createCharacterStyle(e){const t=new zl(e.styleName+" Char",e.localizedName+" Char",!1,!1,!1,!1,e.maskedCharacterProperties);this.history.addAndRedo(new AI(this.modelManipulator,t,e))}}class kI extends Ze{constructor(e,t,r,i){super(e),this.targetSubDocPos=r,this.sourceSubDocInterval=i,this.options=t}redo(){const e=new gb(this.modelManipulator,this.options,this.targetSubDocPos,this.sourceSubDocInterval);e.insert(),this.newTables=e.newTables,this.insertedInterval=e.insertedInterval,this.insertedSubDocuments=e.insertedSubDocuments}undo(){for(let e,t=0;e=this.newTables[t];t++)this.modelManipulator.table.removeTable(this.targetSubDocPos.subDocument,e);this.modelManipulator.range.removeIntervalWithoutHistory(this.targetSubDocPos.subDocument,new on.FixedInterval(this.targetSubDocPos.position,this.sourceSubDocInterval.interval.length),!0);for(const e of this.insertedSubDocuments)this.modelManipulator.model.subDocumentsCollection.delete(e.id)}}class OI extends lu{insertSubDocument(e,t,r=new pb){const i=new kI(this.modelManipulator,r,e,t);return this.history.addAndRedo(i),{insetedInterval:i.insertedInterval,newSubDocuments:i.insertedSubDocuments}}}class _I{constructor(e,t){this.subDocumentId=e,this.newState=t,this.type=pd.TabDeleted}toJSON(e){return this.newState.toJSON(e)}}class UI{constructor(e,t){this.subDocumentId=e,this.newState=t,this.type=pd.TabInserted}toJSON(e){return this.newState.toJSON(e)}}class HI extends lu{insertTabToParagraph(e,t,r){const i=e.getParagraphsByInterval(t),n=new If,o=new If;for(let e of i)if(this.addTab(e.tabs,r.clone())){const t=e.interval;n.register(new wf(t,r.clone())),o.register(new wf(t,r.clone()))}return o.lastObject&&this.modelManipulator.notifyModelChanged(new UI(e.id,o)),n}deleteTabAtParagraph(e,t,r){const i=e.getParagraphsByInterval(t),n=new If,o=new If;for(let e of i){let t=e.getTabs();if(C.SearchUtils.binaryIndexOf(t.positions,(e=>e.position-r.position))>-1){this.deleteTab(e.tabs,r);const t=e.interval;n.register(new wf(t,r.clone())),o.register(new wf(t,r.clone())),C.SearchUtils.binaryIndexOf(e.paragraphStyle.tabs.tabsInfo,(e=>e.position-r.position))>-1&&(r.deleted=!0,this.addTab(e.tabs,r.clone()))}}return this.modelManipulator.notifyModelChanged(new _I(e.id,o)),n}restoreInsertedTabToParagraph(e,t){if(!t.isEmpty()){for(let r of t.objects){const t=r.value,i=e.getParagraphsByInterval(r.interval);for(let e of i)this.deleteTab(e.tabs,t)}this.modelManipulator.notifyModelChanged(new _I(e.id,t))}}restoreDeletedTabAtParagraph(e,t){if(!t.isEmpty()){for(let r of t.objects){const t=r.value,i=e.getParagraphsByInterval(r.interval);for(let e of i)this.addTab(e.tabs,t.clone())}this.modelManipulator.notifyModelChanged(new UI(e.id,t))}}deleteTab(e,t){let r=e.indexOf(t);return!(r<0)&&(e.deleteByIndex(r),!0)}addTab(e,t){let r=e.indexOf(t);return!(r>=0&&t.equals(e.tabsInfo[r]))&&(e.add(t),!0)}}class VI{constructor(e,t){this.subDocumentId=e,this.newState=t,this.type=pd.TextBufferChanged}}class WI{constructor(e,t,r){this.position=e,this.text=t,this.type=r}merge(e,t,r){return this.position+this.text.length==e&&this.type==r&&(r==lc.Text||r==lc.Dash||r==lc.Space)&&(this.text+=t,!0)}getEndPosition(){return this.position+this.text.length}}class zI{constructor(){this.parts=[]}getLastWordPart(){return this.parts[this.parts.length-1]}}class jI{constructor(){this.words=[]}getLastWord(){return this.words[this.words.length-1]}}class XI{constructor(e,t,r,i){this.currSentence=null,this.currWord=null,this.currWordPart=null,this.isSentenceEnd=!1,this.isWordEnd=!1,this.findEndLastSentence=!1,this.subDocument=e,this.layout=t,this.interval=i,this.sentences=[],this.selection=r}static getBuilder(e,t,r,i,n){const o=e.layout,a=new XI(r,o,t,i);for(;!a.build();)e.forceFormatPage(o.validPageCount);return n&&XI.splitPartsByInterval(a.sentences,i),XI.correctFirstSentence(a.sentences),a}static correctFirstSentence(e){for(var t,r=e[0].words,i=0;t=r[i];i++){var n=t.parts[0].type;if(n!=lc.Space&&n!=lc.LineBreak&&n!=lc.TabSpace)break}if(i>0&&i<r.length){for(var o=new jI;i>0;i--)o.words.push(r.shift());e.unshift(o)}}static splitPartsByInterval(e,t){XI.splitPartsByPosition(e,t.start),XI.splitPartsByPosition(e,t.end)}static splitPartsByPosition(e,t){for(var r,i=e[Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.words[0].parts[0].position),t))],n=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(i.words,(e=>e.parts[0].position),t)),o=i.words[n],a=0;(r=o.parts[a])&&!(r.position>t);a++);a=a>0?a-1:0,t>(r=o.parts[a]).position&&t<r.position+r.text.length&&(o.parts.splice(a+1,0,new WI(t,r.text.substr(t-r.position),r.type)),r.text=r.text.substr(0,t-r.position))}build(){let e=this.subDocument.isMain()?this.layout.getLastValidPage().getEndPosition():this.layout.pages[this.selection.pageIndex].getEndPosition();if(this.findEndLastSentence)this.interval=on.FixedInterval.fromPositions(this.interval.end,e),this.layoutBoxIterator.resetToInterval(this.interval.start,this.interval.end),this.collect();else{if(this.needCalculateMoreLayout())return!1;var t=this.findFirstSentenceStartPosition();this.layoutBoxIterator=this.subDocument.isMain()?new rm(this.subDocument,this.layout,t,this.interval.end):new im(this.subDocument,this.layout,t,this.interval.end,this.selection.pageIndex),this.addNewSentence(),this.addNewWord(),this.collect(),this.findEndLastSentence=!0}return 1==this.currSentence.words.length&&0==this.currWord.parts.length?(this.sentences.pop(),!0):this.interval.end==e?this.layout.isFullyFormatted:this.build()}collect(){for(;this.layoutBoxIterator.moveNext((new cg).setDefault(!1),(new cg).setDefault(!1));){var e=this.layoutBoxIterator.position;if(!this.lastBox||this.lastBox!==e.box)switch(this.lastBox=e.box,e.box.getType()){case lc.Text:for(var t,r=e.box,i=e.charOffset,n=e.getLogPosition()+i;t=r.text[i];i++,n++)switch(t){case".":case";":if(this.isSentenceEnd&&(this.addNewSentence(),this.addNewWord(),this.findEndLastSentence))return;this.addNewWordPart(n,t,lc.Text),this.isSentenceEnd=!0;break;case"!":var o=rn.StringUtils.getSymbolFromEnd(this.currWordPart.text,1);if(this.isSentenceEnd&&o&&"!"!=o&&(this.addNewSentence(),this.addNewWord(),this.findEndLastSentence))return;this.addNewWordPart(n,t,lc.Text),this.isSentenceEnd=!0;break;case"?":o=rn.StringUtils.getSymbolFromEnd(this.currWordPart.text,1);if(this.isSentenceEnd&&(!o||"!"!=o)&&(this.addNewSentence(),this.addNewWord(),this.findEndLastSentence))return;this.addNewWordPart(n,t,lc.Text),this.isSentenceEnd=!0;break;case an.specialCharacters.Dot:case an.specialCharacters.Hyphen:case an.specialCharacters.TrademarkSymbol:case an.specialCharacters.CopyrightSymbol:case an.specialCharacters.RegisteredTrademarkSymbol:case an.specialCharacters.Ellipsis:case an.specialCharacters.LeftDoubleQuote:case an.specialCharacters.LeftSingleQuote:case an.specialCharacters.RightDoubleQuote:case an.specialCharacters.RightSingleQuote:case an.specialCharacters.OpeningDoubleQuotationMark:case an.specialCharacters.OpeningSingleQuotationMark:case an.specialCharacters.ClosingDoubleQuotationMark:case an.specialCharacters.ClosingSingleQuotationMark:case an.specialCharacters.RegisteredTrademarkSymbol:case an.specialCharacters.RegisteredTrademarkSymbol:case",":case"@":case"#":case"$":case"%":case"^":case"&":case"*":case"(":case")":case"=":case"+":case"[":case"]":case"{":case"}":case"\\":case"|":case":":case"'":case'"':case"<":case">":case"/":case"~":case"`":this.isWordEnd&&this.addNewWord(),this.addNewWordPart(n,t,lc.Text),this.isWordEnd=!0;break;default:if(this.isSentenceEnd){if(this.addNewSentence(),this.addNewWord(),this.findEndLastSentence)return;this.isSentenceEnd=!1,this.isWordEnd=!1}else this.isWordEnd&&(this.addNewWord(),this.isWordEnd=!1);this.addNewWordPart(n,t,lc.Text)}break;case lc.SectionMark:case lc.ParagraphMark:if(this.addNewWordPart(e.getLogPosition()," ",e.box.getType()),this.addNewSentence(),this.addNewWord(),this.findEndLastSentence)return;this.isSentenceEnd=!1,this.isWordEnd=!1;break;case lc.Dash:case lc.Space:case lc.TabSpace:this.addNewWordPart(e.getLogPosition()," ",e.box.getType()),this.isWordEnd=!0;break;default:this.currWord.parts.length>0&&this.addNewWord(),this.addNewWordPart(e.getLogPosition()," ",e.box.getType()),this.isSentenceEnd||this.addNewWord()}}}addNewSentence(){this.currSentence=new jI,this.sentences.push(this.currSentence),this.currWord=null,this.currWordPart=null}addNewWord(){this.currWord=new zI,this.currSentence.words.push(this.currWord),this.currWordPart=null}addNewWordPart(e,t,r){this.currWordPart&&this.currWordPart.merge(e,t,r)||(this.currWordPart=new WI(e,t,r),this.currWord.parts.push(this.currWordPart))}needCalculateMoreLayout(){var e=this.subDocument.isMain()?this.layout.getLastValidPage():this.layout.pages[this.selection.pageIndex];return e&&(this.subDocument.isMain()?e.getEndPosition():e.otherPageAreas[this.subDocument.id].getEndPosition())<this.interval.end}findFirstSentenceStartPosition(){for(var e=this.subDocument.isMain()?new rm(this.subDocument,this.layout,0,this.interval.start):new im(this.subDocument,this.layout,0,this.interval.start,this.selection.pageIndex),t=-1,r=!1;e.movePrev((new cg).setDefault(!1),(new cg).setDefault(!0));){var i=e.position;switch(i.box.getType()){case lc.Text:for(var n,o=i.box,a=i.charOffset>0||i.getLogPosition()>=this.interval.start?i.charOffset:o.text.length-1;n=o.text[a];a--){switch(n){case".":case"!":case"?":case";":i.getLogPosition()!=this.interval.start&&(r=!0);break;default:t=i.getLogPosition()}if(r)break}break;case lc.SectionMark:case lc.ParagraphMark:e.moveNext((new cg).setDefault(!1),(new cg).setDefault(!1)),t=e.position.getLogPosition(),r=!0}if(r)break}return t<0?e.position.getLogPosition():t}}class GI extends lu{applyUpperCase(e,t,r,i){return new JI(e,t,r,this.modelManipulator,i).modify()}applyLowerCase(e,t,r,i){return new $I(e,t,r,this.modelManipulator,i).modify()}applyCapitalizeEachWordCase(e,t,r,i){return new YI(e,t,r,this.modelManipulator,i).modify()}applyToggleCase(e,t,r,i){return new QI(e,t,r,this.modelManipulator,i).modify()}applySentenceCase(e,t,r,i){return new ZI(e,t,r,this.modelManipulator,i).modify()}applyBufferState(e,t){for(var r,i=e.chunks,n=0;r=t.objects[n];n++)for(var o,a=r.value,s=r.interval.start,l=C.SearchUtils.normedInterpolationIndexOf(i,(e=>e.startLogPosition.value),s);a.length>0&&(o=i[l]);l++){var d=s-o.startLogPosition.value,c=o.textBuffer.substr(0,d),h=o.textBuffer.substr(d+a.length),u=o.textBuffer.length-d-h.length;o.textBuffer=[c,a.substr(0,u),h].join(""),s+=u,a=a.substr(u)}t.isEmpty()||this.modelManipulator.notifyModelChanged(new VI(e.id,t))}}class KI{constructor(e,t,r,i,n){this.layoutFormatterManager=e,this.selection=t,this.subDocument=r,this.interval=n,this.modelManipulator=i}modify(){this.newState=new If,this.oldState=new If;for(var e,t=XI.getBuilder(this.layoutFormatterManager,this.selection,this.subDocument,this.interval,!0).sentences,r=0;e=t[r];r++)this.modifyCore(e);return this.modelManipulator.textCase.applyBufferState(this.subDocument,this.newState),this.newState.isEmpty()||this.modelManipulator.notifyModelChanged(new VI(this.subDocument.id,this.newState)),this.oldState}}class qI extends KI{modifyCore(e){for(var t,r=0;t=e.words[r];r++)for(var i,n=0;i=t.parts[n];n++)if(!(i.position<this.interval.start)){if(i.position>=this.interval.end)return;if(i.type===lc.Text){this.oldState.register(new yf(i.position,i.text));var o=this.applyModifier(r,n,i.text);this.newState.register(new yf(i.position,o))}}}}class $I extends qI{applyModifier(e,t,r){return r.toLowerCase()}}class JI extends qI{applyModifier(e,t,r){return r.toUpperCase()}}class YI extends qI{applyModifier(e,t,r){return 0==t?r[0].toUpperCase()+r.substr(1).toLowerCase():r.toLowerCase()}}class QI extends qI{applyModifier(e,t,r){for(var i="",n=0;n<r.length;n++){var o=r[n],a=o.toLowerCase();i+=a===o?o.toUpperCase():a}return i}}class ZI extends qI{applyModifier(e,t,r){return 0==e&&0==t?r[0].toUpperCase()+r.substr(1).toLowerCase():r.toLowerCase()}}class eP extends nb{constructor(e,t,r,i,n,o,a){super(e,t,r),this.subDocumentId=e,this.position=t,this.length=r,this.characterProperties=i,this.characterStyle=n,this.runType=o,this.text=a,this.type=pd.SimpleRunInserted}}class tP{constructor(){this.maxChunkSize=4096,this.maxRunSizeCoeff=.25,this.maxRunSize=Math.floor(this.maxRunSizeCoeff*this.maxChunkSize)}correctChunkSizeAtChunkIndex(e,t){this.subDocument=e,this.chunks=e.chunks,this.originChunk=this.chunks[t],this.originChunkIndex=t,this.originChunkRuns=this.originChunk.textRuns,this.startCorrect()}correctChunkSizeAtInsertPosition(e,t){this.subDocument=e,this.chunks=e.chunks;const r=this.subDocument.getRunAndIndexesByPosition(t);this.originChunk=r.chunk,this.originChunkRuns=r.chunk.textRuns,this.originChunkIndex=r.chunkIndex,this.startCorrect()}startCorrect(){if(!(this.originChunk.textBuffer.length<=this.maxChunkSize)){if(this.needMoveLength=this.originChunk.textBuffer.length-this.maxChunkSize,this.needMoveLength<this.maxChunkSize){if(this.isMoveToPrevChunk())return;if(this.isMoveToNextChunk())return}this.moveToNewNextChunks()}}isMoveToPrevChunk(){const e=this.chunks[this.originChunkIndex-1];if(!e)return!1;let t,r=0,i=0;for(;(t=this.originChunkRuns[r])&&(t.getLength()>this.maxRunSize&&this.originChunk.splitRun(r,this.maxRunSize),i+=t.getLength(),!(i>=this.needMoveLength));r++);if(i+e.textBuffer.length>this.maxChunkSize)return!1;let n=e.textBuffer.length;for(;r>=0;r--)t=this.originChunkRuns.shift(),e.textRuns.push(t),t.startOffset=n,n+=t.getLength();return e.textBuffer+=this.originChunk.textBuffer.substr(0,i),this.originChunk.textBuffer=this.originChunk.textBuffer.substr(i),this.subDocument.positionManager.unregisterPosition(this.originChunk.startLogPosition),this.originChunk.startLogPosition=this.subDocument.positionManager.registerPosition(this.originChunk.startLogPosition.value+i),db.moveRunsInChunk(this.originChunk,0,-i),!0}isMoveToNextChunk(){const e=this.chunks[this.originChunkIndex+1];if(!e)return!1;let t,r=this.originChunkRuns.length-1,i=0;for(;t=this.originChunkRuns[r];r--){for(;t.getLength()>this.maxRunSize;)this.originChunk.splitRun(r,this.maxRunSize),t=this.originChunkRuns[++r];if(i+=t.getLength(),i>=this.needMoveLength)break}if(i+e.textBuffer.length>this.maxChunkSize)return!1;db.moveRunsInChunk(e,0,i);let n=i;for(r=this.originChunkRuns.length-r;r>0;r--)t=this.originChunkRuns.pop(),e.textRuns.unshift(t),n-=t.getLength(),t.startOffset=n;const o=this.originChunk.textBuffer.length-i;return e.textBuffer=this.originChunk.textBuffer.substring(o)+e.textBuffer,this.originChunk.textBuffer=this.originChunk.textBuffer.substring(0,o),this.subDocument.positionManager.unregisterPosition(e.startLogPosition),e.startLogPosition=this.subDocument.positionManager.registerPosition(e.startLogPosition.value-i),!0}moveToNewNextChunks(){const e=f.ListUtils.last(this.chunks).isLast;let t,r,i=this.originChunkRuns.length-1,n=0;for(;t=this.originChunkRuns[i];i--){for(;t.getLength()>this.maxRunSize;)this.originChunk.splitRun(i,this.maxRunSize),t=this.originChunkRuns[++i];if(n+=t.getLength(),n>=this.needMoveLength)break}let o=0,a=this.originChunkIndex+1,s=this.originChunk.startLogPosition.value+this.originChunkRuns[i].startOffset;for(let e=i;t=this.originChunkRuns[e];e++)(null==r||o+t.getLength()>this.maxChunkSize)&&(r&&(r.textBuffer=this.originChunk.textBuffer.substr(r.startLogPosition.value-this.originChunk.startLogPosition.value,o)),r=new mo(this.subDocument.positionManager.registerPosition(s),"",!1),this.chunks.splice(a,0,r),a++,o=0),r.textRuns.push(t),t.startOffset=o,s+=t.getLength(),o+=t.getLength();r.textBuffer=this.originChunk.textBuffer.substr(r.startLogPosition.value-this.originChunk.startLogPosition.value,o);const l=this.originChunkRuns[i-1];this.originChunk.textBuffer=this.originChunk.textBuffer.substring(0,l.startOffset+l.getLength()),this.originChunkRuns.splice(i),this.originChunk.isLast=!1,this.chunks[this.chunks.length-1].isLast=e}}class rP{constructor(e,t){this.inserted=e,this.insertedInterval=t}}class iP extends db{constructor(e){super(e),this.chunkSizeCorrector=new tP}insertTextViaHistory(e){return e.correctAndCheckParams()?(this.history.addAndRedo(new nm(this.modelManipulator,e)),new rP(!0,new on.FixedInterval(e.subDocPos.position,e.text.length))):new rP(!1,null)}insertTextInner(e){e.subDocPos.subDocument=e.subDocPos.subDocument.getActualSubDocument();const t=this.insertRunInternal(e.subDocPos,e.charPropsBundle,e.runType,e.text),r=e.subDocPos.subDocument.chunks[t.chunkIndex].textRuns[t.runIndex];r.paragraph.length+=e.text.length,this.chunkSizeCorrector.correctChunkSizeAtInsertPosition(e.subDocPos.subDocument,e.subDocPos.position),this.modelManipulator.notifyModelChanged(new eP(e.subDocPos.subDocument.id,e.subDocPos.position,e.text.length,r.maskedCharacterProperties,r.characterStyle,e.runType,e.text))}getLastModifiableHistoryItem(e){var t;return null===(t=this.getLastModifiableHistoryItemNode(e))||void 0===t?void 0:t.item}getLastModifiableHistoryItemNode(e){const t=this.history;if(!t)return null;const r=t.historyItems,i=t.currentIndex==r.length-1?this.getLastHistoryItemNode(r,null,e):null;return(null==i?void 0:i.empty)?null:i}getLastHistoryItemNode(e,t,r){for(let i,n=e.length-1;i=e[n];n--){if(!i.canBeMerged())return new sP;if(r(i))return new nP(i,t);if(i instanceof et){const e=this.getLastHistoryItemNode(i.historyItems,new oP(i,t),r);if(e.exist)return e}}return new aP}}class nP{constructor(e,t){this.item=e,this.parent=t}get root(){let e=this;for(;e.parent;)e=e.parent;return e}get exist(){return void 0!==this.item}get empty(){return!this.item}}class oP extends nP{constructor(e,t){super(e,t)}}class aP extends nP{constructor(){super(void 0,null)}}class sP extends nP{constructor(){super(null,null)}}class lP{get model(){return this.modelManager.model}constructor(e,t){this.modelListeners=[],this.onFontsChanged=new Nb,this.batchUpdatableObject=t,this.modelManager=e,this.floatingObject=new bC(this),this.numberingList=new cS(this),this.range=new nI(this),this.table=new rb(this),this.bookmark=new du(this),this.rangePermission=new US(this),this.characterProperties=new _b(this),this.documentProperties=new Xb(this),this.documentProtectionProperties=new Jb(this),this.field=new wb(this),this.font=new IC(this),this.header=new EC(this),this.footer=new DC(this),this.inlineObject=new RC(this),this.paragraphProperties=new mS(this),this.sectionProperties=new MI(this),this.style=new NI(this),this.subDocument=new OI(this),this.tab=new HI(this),this.textCase=new GI(this),this.text=new iP(this),this.paragraph=new uS(this),this.picture=new OS(this),this.textBox=new ub(this),this.section=new sI(this),this.documentMerger=new Vb(this)}notifyModelChanged(e){this.modelListeners.forEach((t=>t.modelChanged(e)))}removeModelListener(e){const t=this.modelListeners.indexOf(e);t>=0&&this.modelListeners.splice(t,1)}raiseFontAdded(e){e&&this.onFontsChanged.listeners.forEach((t=>t.NotifyFontAdded(e)))}raiseFontRemoved(e){e&&this.onFontsChanged.listeners.forEach((t=>t.NotifyFontRemoved(e)))}raiseFontListChanged(e){this.onFontsChanged.listeners.forEach((t=>t.NotifyFontListChanged(e)))}clearListeners(){this.onFontsChanged.clear(),this.modelListeners=[]}}class dP{constructor(e,t,r){this.model=e,this.richOptions=t,this.modelManipulator=new lP(this,r),this.history=new Ab(t.control)}}class cP extends dP{get clientMode(){return!0}}class hP{static modifyShadeToTint(e){return e/hP.maxTintValue-1}static calculateTint(e){return 1-e/hP.maxTintValue}static calculateShadeFromColorModelInfoTint(e){return Math.floor((e+1)*hP.maxTintValue)}static calculateTintFromColorModelInfoTint(e){return Math.floor(hP.maxTintValue*(1-e))}}hP.maxTintValue=255;class uP{}uP.ShadingPatternTable=(new Eu).add(re.ThinHorzStripe,"\\bghoriz").add(re.ThinVertStripe,"\\bgvert").add(re.ThinReverseDiagStripe,"\\bgfdiag").add(re.ThinDiagStripe,"\\bgbdiag").add(re.ThinHorzCross,"\\bgcross").add(re.ThinDiagCross,"\\bgdcross").add(re.HorzStripe,"\\bgdkhoriz").add(re.VertStripe,"\\bgdkvert").add(re.ReverseDiagStripe,"\\bgdkfdiag").add(re.DiagStripe,"\\bgdkbdiag").add(re.HorzCross,"\\bgdkcross").add(re.DiagCross,"\\bgdkdcross").get(),uP.RunShadingPatternTable=(new Eu).add(re.ThinHorzStripe,"\\chbghoriz").add(re.ThinVertStripe,"\\chbgvert").add(re.ThinReverseDiagStripe,"\\chbgfdiag").add(re.ThinDiagStripe,"\\chbgbdiag").add(re.ThinHorzCross,"\\chbgcross").add(re.ThinDiagCross,"\\chbgdcross").add(re.HorzStripe,"\\chbgdkhoriz").add(re.VertStripe,"\\chbgdkvert").add(re.ReverseDiagStripe,"\\chbgdkfdiag").add(re.DiagStripe,"\\chbgdkbdiag").add(re.HorzCross,"\\chbgdkcross").add(re.DiagCross,"\\chbgdkdcross").get(),uP.TableCellShadingPatternTable=(new Eu).add(re.ThinHorzStripe,"\\clbghoriz").add(re.ThinVertStripe,"\\clbgvert").add(re.ThinReverseDiagStripe,"\\clbgfdiag").add(re.ThinDiagStripe,"\\clbgbdiag").add(re.ThinHorzCross,"\\clbgcross").add(re.ThinDiagCross,"\\clbgdcross").add(re.HorzStripe,"\\clbgdkhor").add(re.VertStripe,"\\clbgdkvert").add(re.ReverseDiagStripe,"\\clbgdkfdiag").add(re.DiagStripe,"\\clbgdkbdiag").add(re.HorzCross,"\\clbgdkcross").add(re.DiagCross,"\\clbgdkdcross").get(),uP.TableStyleShadingPatternTable=(new Eu).add(re.ThinHorzStripe,"\\tsbghoriz").add(re.ThinVertStripe,"\\tsbgvert").add(re.ThinReverseDiagStripe,"\\tsbgfdiag").add(re.ThinDiagStripe,"\\tsbgbdiag").add(re.ThinHorzCross,"\\tsbgcross").add(re.ThinDiagCross,"\\tsbgdcross").add(re.HorzStripe,"\\tsbgdkhor").add(re.VertStripe,"\\tsbgdkvert").add(re.ReverseDiagStripe,"\\tsbgdkfdiag").add(re.DiagStripe,"\\tsbgdkbdiag").add(re.HorzCross,"\\tsbgdkcross").add(re.DiagCross,"\\tsbgdkdcross").get(),uP.ThemeColorValuesTable=(new Eu).add(z.Dark1,"\\cmaindarkone").add(z.Light1,"\\cmainlightone").add(z.Dark2,"\\cmaindarktwo").add(z.Light2,"\\cmainlighttwo").add(z.Accent1,"\\caccentone").add(z.Accent2,"\\caccenttwo").add(z.Accent3,"\\caccentthree").add(z.Accent4,"\\caccentfour").add(z.Accent5,"\\caccentfive").add(z.Accent6,"\\caccentsix").add(z.Hyperlink,"\\chyperlink").add(z.FollowedHyperlink,"\\cfollowedhyperlink").add(z.Background1,"\\cbackgroundone").add(z.Text1,"\\ctextone").add(z.Background2,"\\cbackgroundtwo").add(z.Text2,"\\ctexttwo").get(),uP.OpenGroup="{",uP.CloseGroup="}",uP.RtfSignature="\\rtf1",uP.DefaultFontIndex="\\deff",uP.StyleTable="\\stylesheet",uP.ColorTable="\\colortbl",uP.FontTable="\\fonttbl",uP.FontCharset="\\fcharset",uP.UserTable="\\*\\protusertbl",uP.ColorSchemeMapping="\\*\\colorschememapping",uP.ThemeData="\\*\\themedata",uP.DocumentInformation="\\info",uP.Password="\\*\\password",uP.PasswordHash="\\*\\passwordhash",uP.EnforceProtection="\\enforceprot",uP.AnnotationProtection="\\annotprot",uP.ReadOnlyProtection="\\readprot",uP.ProtectionLevel="\\protlevel",uP.NoUICompatible="\\nouicompat",uP.UnicodeAndANSIGroup="\\upr",uP.UnicodeGroup="\\*\\ud",uP.Category="\\*\\category",uP.Title="\\title",uP.Subject="\\subject",uP.Author="\\author",uP.Keywords="\\keywords",uP.Description="\\doccomm",uP.LastModifiedBy="\\operator",uP.Created="\\creatim",uP.Modified="\\revtim",uP.LastPrinted="\\printim",uP.Revision="\\version",uP.Year="\\yr",uP.Month="\\mo",uP.Day="\\dy",uP.Hour="\\hr",uP.Minute="\\min",uP.CustomProperties="\\*\\userprops",uP.CustomPropertyName="\\propname",uP.CustomPropertyType="\\proptype",uP.CustomPropertyLinkTarget="\\linkval",uP.CustomPropertyValue="\\staticval",uP.DefaultTabWidth="\\deftab",uP.MirrorMargins="\\margmirror",uP.HyphenateDocument="\\hyphauto",uP.PageFacing="\\facingp",uP.DisplayBackgroundShape="\\viewbksp",uP.RemovePersonalInformation="\\rempersonalinfo",uP.CompatibilityNoColumnBalance="\\nocolbal",uP.CompatibilityDoNotAlignTableRowsIndependently="\\alntblind",uP.CompatibilityDontJustifyLinesEndingInSoftLineBreak="\\expshrtn",uP.CompatibilitySplitPageBreakAndParagraphMark="\\spltpgpar",uP.CompatibilityAllowTablesToExtendIntoMargin="\\nogrowautofit",uP.ColorRed="\\red",uP.ColorGreen="\\green",uP.ColorBlue="\\blue",uP.ThemeColorTint="\\ctint",uP.ThemeColorShade="\\cshade",uP.ResetParagraphProperties="\\pard",uP.FrameHorizontalPosition="\\posx",uP.FrameVerticalPosition="\\posy",uP.FrameNegativeHorizontalPosition="\\posnegx",uP.FrameNegativeVerticalPosition="\\posnegy",uP.FrameWidth="\\absw",uP.FrameHeight="\\absh",uP.FrameVerticalPadding="\\dfrmtxty",uP.FrameHorizontalPadding="\\dfrmtxtx",uP.FrameLockAnchor="\\abslock",uP.FrameNoWrap="\\nowrap",uP.FrameWrapOverlay="\\overlay",uP.FrameWrapDefault="\\wrapdefault",uP.FrameWrapAround="\\wraparound",uP.FrameWrapTight="\\wraptight",uP.FrameWrapThrough="\\wrapthrough",uP.FrameHorizontalPositionAlignmentCenter="\\posxc",uP.FrameHorizontalPositionAlignmentLeft="\\posxl",uP.FrameHorizontalPositionAlignmentRight="\\posxr",uP.FrameHorizontalPositionAlignmentInside="\\posxi",uP.FrameHorizontalPositionAlignmentOutside="\\posxo",uP.FrameVerticalPositionAlignmentCenter="\\posyc",uP.FrameVerticalPositionAlignmentTop="\\posyt",uP.FrameVerticalPositionAlignmentBottom="\\posyb",uP.FrameVerticalPositionAlignmentInside="\\posyin",uP.FrameVerticalPositionAlignmentOutside="\\posyout",uP.TopParagraphBorder="\\brdrt",uP.BottomParagraphBorder="\\brdrb",uP.LeftParagraphBorder="\\brdrl",uP.RightParagraphBorder="\\brdrr",uP.BetweenParagraphBorder="\\brdrbtw",uP.ParagraphHorizontalPositionTypeMargin="\\phmrg",uP.ParagraphHorizontalPositionTypePage="\\phpg",uP.ParagraphHorizontalPositionTypeColumn="\\phcol",uP.ParagraphVerticalPositionTypeMargin="\\pvmrg",uP.ParagraphVerticalPositionTypePage="\\pvpg",uP.ParagraphVerticalPositionTypeLine="\\pvpara",uP.ResetCharacterFormatting="\\plain",uP.EndOfParagraph="\\par",uP.LeftAlignment="\\ql",uP.RightAlignment="\\qr",uP.CenterAlignment="\\qc",uP.JustifyAlignment="\\qj",uP.FirstLineIndentInTwips="\\fi",uP.LeftIndentInTwips="\\li",uP.LeftIndentInTwips_Lin="\\lin",uP.RightIndentInTwips="\\ri",uP.RightIndentInTwips_Rin="\\rin",uP.AutomaticParagraphHyphenation="\\hyphpar",uP.SuppressLineNumbering="\\noline",uP.ContextualSpacing="\\contextualspace",uP.PageBreakBefore="\\pagebb",uP.BeforeAutoSpacing="\\sbauto",uP.AfterAutoSpacing="\\saauto",uP.KeepWithNext="\\keepn",uP.KeepLinesTogether="\\keep",uP.WidowOrphanControlOn="\\widctlpar",uP.WidowOrphanControlOff="\\nowidctlpar",uP.OutlineLevel="\\outlinelevel",uP.ParagraphShading="\\shading",uP.ParagraphFillColor="\\cfpat",uP.ParagraphBackgroundColor="\\cbpat",uP.RtfLineSpacingValue="\\sl",uP.RtfLineSpacingMultiple="\\slmult",uP.SpaceBefore="\\sb",uP.SpaceAfter="\\sa",uP.ListIndex="\\ls",uP.LevelIndex="\\ilvl",uP.AlternativeText="\\listtext",uP.ParagraphNumerationText="\\*\\pntext",uP.CenteredTab="\\tqc",uP.DecimalTab="\\tqdec",uP.FlushRightTab="\\tqr",uP.NumberingTab="\\jclisttab",uP.TabLeaderDots="\\tldot",uP.TabLeaderEqualSign="\\tleq",uP.TabLeaderHyphens="\\tlhyph",uP.TabLeaderMiddleDots="\\tlmdot",uP.TabLeaderThickLine="\\tlth",uP.TabLeaderUnderline="\\tlul",uP.TabPosition="\\tx",uP.AllCapitals="\\caps",uP.SmallCapitals="\\scaps",uP.LangInfo="\\lang",uP.LangInfo1="\\langfe",uP.LangInfo2="\\langnp",uP.LangInfo3="\\langfenp",uP.NoProof="\\noproof",uP.HiddenText="\\v",uP.FontBold="\\b",uP.FontItalic="\\i",uP.FontStrikeout="\\strike",uP.FontDoubleStrikeout="\\striked1",uP.FontUnderline="\\ul",uP.FontUnderlineDotted="\\uld",uP.FontUnderlineDashed="\\uldash",uP.FontUnderlineDashDotted="\\uldashd",uP.FontUnderlineDashDotDotted="\\uldashdd",uP.FontUnderlineDouble="\\uldb",uP.FontUnderlineHeavyWave="\\ulhwave",uP.FontUnderlineLongDashed="\\ulldash",uP.FontUnderlineThickSingle="\\ulth",uP.FontUnderlineThickDotted="\\ulthd",uP.FontUnderlineThickDashed="\\ulthdash",uP.FontUnderlineThickDashDotted="\\ulthdashd",uP.FontUnderlineThickDashDotDotted="\\ulthdashdd",uP.FontUnderlineThickLongDashed="\\ulthldash",uP.FontUnderlineDoubleWave="\\ululdbwave",uP.FontUnderlineWave="\\ulwave",uP.FontUnderlineWordsOnly="\\ulw",uP.FontNumber="\\f",uP.FontSize="\\fs",uP.RunShadingPattern="\\chshdng",uP.RunFillColor="\\chcfpat",uP.RunBackgroundColor="\\chcbpat",uP.RunHighlightColor="\\highlight",uP.RunForegroundColor="\\cf",uP.RunUnderlineColor="\\ulc",uP.RunSuperScript="\\super",uP.RunSubScript="\\sub",uP.Picture="\\pict",uP.PictureWidth="\\picw",uP.PictureHeight="\\pich",uP.PictureDesiredWidth="\\picwgoal",uP.PictureDesiredHeight="\\pichgoal",uP.PictureScaleX="\\picscalex",uP.PictureScaleY="\\picscaley",uP.PictureCropLeft="\\piccropl",uP.PictureCropTop="\\piccropt",uP.PictureCropRight="\\piccropr",uP.PictureCropBottom="\\piccropb",uP.ShapePicture="\\*\\shppict",uP.NonShapePicture="\\nonshppict",uP.DxImageUri="\\*\\dximageuri",uP.PictureProperties="\\*\\picprop",uP.Defshp="\\defshp",uP.PNGPictureKeyword="\\pngblip",uP.JpegPictureKeyword="\\jpegblip",uP.Space=" ",uP.CLRF="\\r\\n",uP.ResetSectionProperties="\\sectd",uP.SectionEndMark="\\sect",uP.SectionMarginsLeft="\\marglsxn",uP.SectionMarginsRight="\\margrsxn",uP.SectionMarginsTop="\\margtsxn",uP.SectionMarginsBottom="\\margbsxn",uP.SectionMarginsHeaderOffset="\\headery",uP.SectionMarginsFooterOffset="\\footery",uP.SectionMarginsGutter="\\guttersxn",uP.SectionFirstPageHeader="\\headerf",uP.SectionOddPageHeader="\\headerr",uP.SectionEvenPageHeader="\\headerl",uP.SectionFirstPageFooter="\\footerf",uP.SectionOddPageFooter="\\footerr",uP.SectionEvenPageFooter="\\footerl",uP.SectionPageWidth="\\pgwsxn",uP.SectionPageHeight="\\pghsxn",uP.SectionPageLandscape="\\lndscpsxn",uP.PaperKind="\\psz",uP.SectionFirstPagePaperSource="\\binfsxn",uP.SectionOtherPagePaperSource="\\binsxn",uP.SectionOnlyAllowEditingOfFormFields="\\sectunlocked",uP.SectionTextFlow="\\stextflow",uP.SectionTitlePage="\\titlepg",uP.VerticalAlignmentBottom="\\vertal\\vertalb",uP.VerticalAlignmentTop="\\vertalt",uP.VerticalAlignmentCenter="\\vertalc",uP.VerticalAlignmentJustify="\\vertalj",uP.SectionBreakTypeNextPage="\\sbkpage",uP.SectionBreakTypeOddPage="\\sbkodd",uP.SectionBreakTypeEvenPage="\\sbkeven",uP.SectionBreakTypeColumn="\\sbkcol",uP.SectionBreakTypeContinuous="\\sbknone",uP.SectionChapterSeparatorHyphen="\\pgnhnsh",uP.SectionChapterSeparatorPeriod="\\pgnhnsp",uP.SectionChapterSeparatorColon="\\pgnhnsc",uP.SectionChapterSeparatorEmDash="\\pgnhnsm",uP.SectionChapterSeparatorEnDash="\\pgnhnsn",uP.SectionChapterHeaderStyle="\\pgnhn",uP.SectionPageNumberingStart="\\pgnstarts",uP.SectionPageNumberingContinuous="\\pgncont",uP.SectionPageNumberingRestart="\\pgnrestart",uP.SectionPageNumberingDecimal="\\pgndec",uP.SectionPageNumberingUpperRoman="\\pgnucrm",uP.SectionPageNumberingLowerRoman="\\pgnlcrm",uP.SectionPageNumberingUpperLetter="\\pgnucltr",uP.SectionPageNumberingLowerLetter="\\pgnlcltr",uP.SectionPageNumberingArabicAbjad="\\pgnbidia",uP.SectionPageNumberingArabicAlpha="\\pgnbidib",uP.SectionPageNumberingChosung="\\pgnchosung",uP.SectionPageNumberingDecimalEnclosedCircle="\\pgncnum",uP.SectionPageNumberingDecimalFullWidth="\\pgndecd",uP.SectionPageNumberingGanada="\\pgnganada",uP.SectionPageNumberingHindiVowels="\\pgnhindia",uP.SectionPageNumberingHindiConsonants="\\pgnhindib",uP.SectionPageNumberingHindiNumbers="\\pgnhindic",uP.SectionPageNumberingHindiDescriptive="\\pgnhindid",uP.SectionPageNumberingThaiLetters="\\pgnthaia",uP.SectionPageNumberingThaiNumbers="\\pgnthaib",uP.SectionPageNumberingThaiDescriptive="\\pgnthaic",uP.SectionPageNumberingVietnameseDescriptive="\\pgnvieta",uP.SectionLineNumberingContinuous="\\linecont",uP.SectionLineNumberingStart="\\linestarts",uP.SectionLineNumberingRestartNewPage="\\lineppage",uP.SectionLineNumberingRestartNewSection="\\linerestart",uP.SectionLineNumberingCountBy="\\linemod",uP.SectionLineNumberingDistance="\\linex",uP.SectionColumnsCount="\\cols",uP.SectionSpaceBetweenColumns="\\colsx",uP.SectionColumnsDrawVerticalSeparator="\\linebetcol",uP.SectionColumnNumber="\\colno",uP.SectionColumnWidth="\\colw",uP.SectionColumnSpace="\\colsr",uP.SectionFootNotePlacementBelowText="\\sftntj",uP.SectionFootNotePlacementPageBottom="\\sftnbj",uP.SectionFootNoteNumberingStart="\\sftnstart",uP.SectionFootNoteNumberingRestartEachPage="\\sftnrstpg",uP.SectionFootNoteNumberingRestartEachSection="\\sftnrestart",uP.SectionFootNoteNumberingRestartContinuous="\\sftnrstcont",uP.SectionFootNoteNumberingFormatDecimal="\\sftnnar",uP.SectionFootNoteNumberingFormatUpperRoman="\\sftnnruc",uP.SectionFootNoteNumberingFormatLowerRoman="\\sftnnrlc",uP.SectionFootNoteNumberingFormatUpperLetter="\\sftnnauc",uP.SectionFootNoteNumberingFormatLowerLetter="\\sftnnalc",uP.SectionFootNoteNumberingFormatChicago="\\sftnnchi",uP.SectionFootNoteNumberingFormatChosung="\\sftnnchosung",uP.SectionFootNoteNumberingFormatDecimalEnclosedCircle="\\sftnncnum",uP.SectionFootNoteNumberingFormatDecimalFullWidth="\\sftnndbar",uP.SectionFootNoteNumberingFormatGanada="\\sftnnganada",uP.SectionEndNoteNumberingStart="\\saftnstart",uP.SectionEndNoteNumberingRestartEachSection="\\saftnrestart",uP.SectionEndNoteNumberingRestartContinuous="\\saftnrstcont",uP.SectionEndNoteNumberingFormatDecimal="\\saftnnar",uP.SectionEndNoteNumberingFormatUpperRoman="\\saftnnruc",uP.SectionEndNoteNumberingFormatLowerRoman="\\saftnnrlc",uP.SectionEndNoteNumberingFormatUpperLetter="\\saftnnauc",uP.SectionEndNoteNumberingFormatLowerLetter="\\saftnnalc",uP.SectionEndNoteNumberingFormatChicago="\\saftnnchi",uP.SectionEndNoteNumberingFormatChosung="\\saftnnchosung",uP.SectionEndNoteNumberingFormatDecimalEnclosedCircle="\\saftnncnum",uP.SectionEndNoteNumberingFormatDecimalFullWidth="\\saftnndbar",uP.SectionEndNoteNumberingFormatGanada="\\saftnnganada",uP.LegacyPaperWidth="\\paperw",uP.LegacyPaperHeight="\\paperh",uP.LegacyLandscape="\\landscape",uP.LegacyPageNumberingStart="\\pgnstart",uP.LegacyMarginsLeft="\\margl",uP.LegacyMarginsRight="\\margr",uP.LegacyMarginsTop="\\margt",uP.LegacyMarginsBottom="\\margb",uP.LegacyMarginsGutter="\\gutter",uP.LegacyMarginsGutterAtRight="\\rtlgutter",uP.FootNotePlacementBelowText="\\ftntj",uP.FootNotePlacementPageBottom="\\ftnbj",uP.FootNoteNumberingStart="\\ftnstart",uP.FootNoteNumberingRestartEachPage="\\ftnrstpg",uP.FootNoteNumberingRestartEachSection="\\ftnrestart",uP.FootNoteNumberingRestartContinuous="\\ftnrstcont",uP.FootNoteNumberingFormatDecimal="\\ftnnar",uP.FootNoteNumberingFormatUpperRoman="\\ftnnruc",uP.FootNoteNumberingFormatLowerRoman="\\ftnnrlc",uP.FootNoteNumberingFormatUpperLetter="\\ftnnauc",uP.FootNoteNumberingFormatLowerLetter="\\ftnnalc",uP.FootNoteNumberingFormatChicago="\\ftnnchi",uP.FootNoteNumberingFormatChosung="\\ftnnchosung",uP.FootNoteNumberingFormatDecimalEnclosedCircle="\\ftnncnum",uP.FootNoteNumberingFormatDecimalFullWidth="\\ftnndbar",uP.FootNoteNumberingFormatGanada="\\ftnnganada",uP.EndNotePlacementEndOfSection="\\aendnotes",uP.EndNotePlacementEndOfDocument="\\aenddoc",uP.EndNoteNumberingStart="\\aftnstart",uP.EndNoteNumberingRestartEachSection="\\aftnrestart",uP.EndNoteNumberingRestartContinuous="\\aftnrstcont",uP.EndNoteNumberingFormatDecimal="\\aftnnar",uP.EndNoteNumberingFormatUpperRoman="\\aftnnruc",uP.EndNoteNumberingFormatLowerRoman="\\aftnnrlc",uP.EndNoteNumberingFormatUpperLetter="\\aftnnauc",uP.EndNoteNumberingFormatLowerLetter="\\aftnnalc",uP.EndNoteNumberingFormatChicago="\\aftnnchi",uP.EndNoteNumberingFormatChosung="\\aftnnchosung",uP.EndNoteNumberingFormatDecimalEnclosedCircle="\\aftnncnum",uP.EndNoteNumberingFormatDecimalFullWidth="\\aftnndbar",uP.EndNoteNumberingFormatGanada="\\aftnnganada",uP.Field="\\field",uP.FieldLocked="\\fldlock",uP.FieldInstructions="\\*\\fldinst",uP.FieldResult="\\fldrslt",uP.FieldCodeView="\\dxfldcodeview",uP.FieldEdit="\\fldedit",uP.FormField="\\*\\formfield",uP.FormFieldType="\\fftype",uP.FormFieldListFieldResult="\\ffres",uP.FormFieldProtected="\\ffprot",uP.FormFieldCheckBoxFieldSizeType="\\ffsize",uP.FormFieldCalculatedOnExit="\\ffrecalc",uP.FormFieldCheckBoxFieldSize="\\ffhps",uP.FormFieldName="\\*\\ffname",uP.FormFieldListFieldDefault="\\ffdefres",uP.FormFieldHelpTextCustom="\\ffownhelp",uP.FormFieldHelpText="\\*\\ffhelptext",uP.FormFieldStatusBarTextCustom="\\ffownstat",uP.FormFieldStatusBarText="\\*\\ffstattext",uP.FormFieldEntryMacro="\\*\\ffentrymcr",uP.FormFieldExitMacro="\\*\\ffexitmcr",uP.FieldMapData="\\*\\mmodsofldmpdata",uP.FieldTypeNull="\\mmfttypenull",uP.FieldTypeColumn="\\mmfttypedbcolumn",uP.FieldTypeAddress="\\mmfttypeaddress",uP.FieldTypeSalutation="\\mmfttypesalutation",uP.FieldTypeMapped="\\mmfttypemapped",uP.FieldTypeBarcode="\\mmfttypebarcode",uP.MailMergeDataSourceObjectName="\\mmodsoname",uP.MailMergeDataSourceObjectMappedName="\\mmodsomappedname",uP.MailMergeDataSourceObjectColumnIndex="\\mmodsofmcolumn",uP.MailMergeDataSourceObjectDynamicAddress="\\mmodsodynaddr",uP.MailMergeDataSourceObjectLanguageId="\\mmodsolid",uP.BookmarkStart="\\*\\bkmkstart",uP.BookmarkEnd="\\*\\bkmkend",uP.RangePermissionStart="\\*\\protstart",uP.RangePermissionEnd="\\*\\protend",uP.CommentStart="\\*\\atrfstart",uP.CommentEnd="\\*\\atrfend",uP.CommentId="\\*\\atnid",uP.CommentAuthor="\\*\\atnauthor",uP.CommentTime="\\*\\atntime",uP.CommentChatn="\\chatn",uP.CommentAnnotation="\\*\\annotation",uP.CommentDate="\\*\\atndate",uP.CommentRef="\\*\\atnref",uP.CommentParent="\\*\\atnparent",uP.HyperlinkFieldType="HYPERLINK",uP.DocumentVariable="\\*\\docvar",uP.FootNote="\\footnote",uP.FootNoteReference="\\chftn",uP.EndNote="\\ftnalt",uP.PageBackground="\\*\\background",uP.Shape="\\shp",uP.ShapeInstance="\\*\\shpinst",uP.ShapeText="\\shptxt",uP.ShapeLeft="\\shpleft",uP.ShapeRight="\\shpright",uP.ShapeTop="\\shptop",uP.ShapeBottom="\\shpbottom",uP.ShapeZOrder="\\shpz",uP.ShapeLegacyHorizontalPositionTypePage="\\shpbxpage",uP.ShapeLegacyHorizontalPositionTypeMargin="\\shpbxmargin",uP.ShapeLegacyHorizontalPositionTypeColumn="\\shpbxcolumn",uP.ShapeIgnoreLegacyHorizontalPositionType="\\shpbxignore",uP.ShapeLegacyVerticalPositionTypePage="\\shpbypage",uP.ShapeLegacyVerticalPositionTypeMargin="\\shpbymargin",uP.ShapeLegacyVerticalPositionTypeParagraph="\\shpbypara",uP.ShapeIgnoreLegacyVerticalPositionType="\\shpbyignore",uP.ShapeWrapTextType="\\shpwr",uP.ShapeWrapTextTypeZOrder="\\shpfblwtxt",uP.ShapeWrapTextSide="\\shpwrk",uP.ShapeLocked="\\shplockanchor",uP.ShapeProperty="\\sp",uP.ShapePropertyName="\\sn",uP.ShapePropertyValue="\\sv",uP.ShapeResult="\\shprslt",uP.ShapeDoNotLay="\\splytwnine",uP.ShapeHyperlink="\\*\\hl",uP.ShapeHyperlinkFrame="\\hlfr",uP.ShapeHyperlinkSource="\\hlsrc",uP.ShapeHyperlinkLocation="\\hlloc",uP.HtmlAutoSpacing="\\htmautsp",uP.CustomRunData="\\*\\dxcustomrundata",uP.ParagraphGroupPropertiesTable="\\*\\pgptbl",uP.ParagraphGroupProperties="\\pgp",uP.ParagraphGroupPropertiesId="\\ipgp",uP.ResetTableProperties="\\trowd",uP.InTableParagraph="\\intbl",uP.TableEndCell="\\cell",uP.NestedTableEndCell="\\nestcell",uP.TableEndRow="\\row",uP.NestedTableEndRow="\\nestrow",uP.NestedTableProperties="\\*\\nesttableprops",uP.NoNestedTable="\\nonesttables",uP.ParagraphNestingLevel="\\itap",uP.TableCellRight="\\cellx",uP.TableCellPreferredWidth="\\clwWidth",uP.TableCellPreferredWidthType="\\clftsWidth",uP.TableCellBottomMargin="\\clpadb",uP.TableCellLeftMargin="\\clpadl",uP.TableCellRightMargin="\\clpadr",uP.TableCellTopMargin="\\clpadt",uP.TableCellBottomMarginType="\\clpadfb",uP.TableCellLeftMarginType="\\clpadfl",uP.TableCellRightMarginType="\\clpadfr",uP.TableCellTopMarginType="\\clpadft",uP.TableRowIndex="\\irow",uP.TableRowBandIndex="\\irowband",uP.TableRowLeftAlignment="\\trql",uP.TableRowRightAlignment="\\trqr",uP.TableRowCenterAlignment="\\trqc",uP.TableIndent="\\tblind",uP.TableIndentType="\\tblindtype",uP.TableCellBottomBorder="\\clbrdrb",uP.TableCellTopBorder="\\clbrdrt",uP.TableCellLeftBorder="\\clbrdrl",uP.TableCellRightBorder="\\clbrdrr",uP.TableCellUpperLeftToLowerRightBorder="\\cldglu",uP.TableCellUpperRightToLowerLeftBorder="\\cldgll",uP.TableCellStartHorizontalMerging="\\clmgf",uP.TableCellContinueHorizontalMerging="\\clmrg",uP.TableCellStartVerticalMerging="\\clvmgf",uP.TableCellContinueVerticalMerging="\\clvmrg",uP.TableCellTextTopAlignment="\\clvertalt",uP.TableCellTextCenterAlignment="\\clvertalc",uP.TableCellTextBottomAlignment="\\clvertalb",uP.TableCellLeftToRightTopToBottomTextDirection="\\cltxlrtb",uP.TableCellTopToBottomRightToLeftTextDirection="\\cltxtbrl",uP.TableCellBottomToTopLeftToRightTextDirection="\\cltxbtlr",uP.TableCellLeftToRightTopToBottomVerticalTextDirection="\\cltxlrtbv",uP.TableCellTopToBottomRightToLeftVerticalTextDirection="\\cltxtbrlv",uP.TableCellFitText="\\clFitText",uP.TableCellNoWrap="\\clNoWrap",uP.TableCellHideMark="\\clhidemark",uP.TableCellBackgroundColor="\\clcbpat",uP.TableCellForegroundColor="\\clcfpat",uP.TableCellShading="\\clshdng",uP.TableTopBorder="\\trbrdrt",uP.TableLeftBorder="\\trbrdrl",uP.TableBottomBorder="\\trbrdrb",uP.TableRightBorder="\\trbrdrr",uP.TableHorizontalBorder="\\trbrdrh",uP.TableVerticalBorder="\\trbrdrv",uP.TableRowBackgroundColor="\\trcbpat",uP.TableRowForegroundColor="\\trcfpat",uP.TableRowShading="\\trshdng",uP.TableRowHorizontalAnchorColumn="\\tphcol",uP.TableRowHorizontalAnchorMargin="\\tphmrg",uP.TableRowHorizontalAnchorPage="\\tphpg",uP.TableRowVerticalAnchorMargin="\\tpvmrg",uP.TableRowVerticalAnchorParagraph="\\tpvpara",uP.TableRowVerticalAnchorPage="\\tpvpg",uP.TableRowHorizontalAlignCenter="\\tposxc",uP.TableRowHorizontalAlignInside="\\tposxi",uP.TableRowHorizontalAlignLeft="\\tposxl",uP.TableRowHorizontalAlignOutside="\\tposxo",uP.TableRowHorizontalAlignRight="\\tposxr",uP.TableRowHorizontalPosition="\\tposx",uP.TableRowHorizontalPositionNeg="\\tposnegx",uP.TableRowVerticalAlignBottom="\\tposyb",uP.TableRowVerticalAlignCenter="\\tposyc",uP.TableRowVerticalAlignInline="\\tposyil",uP.TableRowVerticalAlignInside="\\tposyin",uP.TableRowVerticalAlignOutside="\\tposyout",uP.TableRowVerticalAlignTop="\\tposyt",uP.TableRowVerticalPosition="\\tposy",uP.TableRowVerticalPositionNeg="\\tposnegy",uP.TableRowLeftFromText="\\tdfrmtxtLeft",uP.TableRowBottomFromText="\\tdfrmtxtBottom",uP.TableRowRightFromText="\\tdfrmtxtRight",uP.TableRowTopFromText="\\tdfrmtxtTop",uP.TableNoOverlap="\\tabsnoovrlp",uP.TableHalfSpaceBetweenCells="\\trgaph",uP.TableRowLeft="\\trleft",uP.TableRowHeight="\\trrh",uP.TableRowHeader="\\trhdr",uP.TableRowCantSplit="\\trkeep",uP.TablePreferredWidth="\\trwWidth",uP.TablePreferredWidthType="\\trftsWidth",uP.TableRowWidthBefore="\\trwWidthB",uP.TableRowWidthBeforeType="\\trftsWidthB",uP.TableRowWidthAfter="\\trwWidthA",uP.TableRowWidthAfterType="\\trftsWidthA",uP.TableLayout="\\trautofit",uP.TableCellSpacingBottom="\\trspdb",uP.TableCellSpacingLeft="\\trspdl",uP.TableCellSpacingRight="\\trspdr",uP.TableCellSpacingTop="\\trspdt",uP.TableCellSpacingBottomType="\\trspdfb",uP.TableCellSpacingLeftType="\\trspdfl",uP.TableCellSpacingRightType="\\trspdfr",uP.TableCellSpacingTopType="\\trspdft",uP.TableCellMarginsBottom="\\trpaddb",uP.TableCellMarginsLeft="\\trpaddl",uP.TableCellMarginsRight="\\trpaddr",uP.TableCellMarginsTop="\\trpaddt",uP.TableCellMarginsBottomType="\\trpaddfb",uP.TableCellMarginsLeftType="\\trpaddfl",uP.TableCellMarginsRightType="\\trpaddfr",uP.TableCellMarginsTopType="\\trpaddft",uP.TableApplyFirstRow="\\tbllkhdrrows",uP.TableApplyLastRow="\\tbllklastrow",uP.TableApplyFirstColumn="\\tbllkhdrcols",uP.TableApplyLastColumn="\\tbllklastcol",uP.TableDoNotApplyRowBanding="\\tbllknorowband",uP.TableDoNotApplyColumnBanding="\\tbllknocolband",uP.TableLastRow="\\lastrow",uP.TableStyleResetTableProperties="\\tsrowd",uP.TableStyleCellVerticalAlignmentTop="\\tsvertalt",uP.TableStyleCellVerticalAlignmentCenter="\\tsvertalc",uP.TableStyleCellVerticalAlignmentBottom="\\tsvertalb",uP.TableStyleRowBandSize="\\tscbandsh",uP.TableStyleColumnBandSize="\\tscbandsv",uP.TableStyleCellBackgroundColor="\\tscellcbpat",uP.TableStyleCellForegroundColor="\\tscellcfpat",uP.TableStyleCellShading="\\tscellpct",uP.TableStyleTopCellBorder="\\tsbrdrt",uP.TableStyleLeftCellBorder="\\tsbrdrl",uP.TableStyleBottomCellBorder="\\tsbrdrb",uP.TableStyleRightCellBorder="\\tsbrdrr",uP.TableStyleHorizontalCellBorder="\\tsbrdrh",uP.TableStyleVerticalCellBorder="\\tsbrdrv",uP.TableStyleCellNoWrap="\\tsnowrap",uP.TableStyleTableBottomCellMargin="\\tscellpaddb",uP.TableStyleTableLeftCellMargin="\\tscellpaddl",uP.TableStyleTableRightCellMargin="\\tscellpaddr",uP.TableStyleTableTopCellMargin="\\tscellpaddt",uP.TableStyleTableBottomCellMarginUnitType="\\tscellpaddfb",uP.TableStyleTableLeftCellMarginUnitType="\\tscellpaddfl",uP.TableStyleTableRightCellMarginUnitType="\\tscellpaddfr",uP.TableStyleTableTopCellMarginUnitType="\\tscellpaddft",uP.TableStyleUpperLeftToLowerRightBorder="\\tsbrdrdgl",uP.TableStyleUpperRightToLowerLeftBorder="\\tsbrdrdgr",uP.TableConditionalStyleFirstRow="\\tscfirstrow",uP.TableConditionalStyleLastRow="\\tsclastrow",uP.TableConditionalStyleFirstColumn="\\tscfirstcol",uP.TableConditionalStyleLastColumn="\\tsclastcol",uP.TableConditionalStyleOddRowBanding="\\tscbandhorzodd",uP.TableConditionalStyleEvenRowBanding="\\tscbandhorzeven",uP.TableConditionalStyleOddColumnBanding="\\tscbandvertodd",uP.TableConditionalStyleEvenColumnBanding="\\tscbandverteven",uP.TableConditionalStyleTopLeftCell="\\tscnwcell",uP.TableConditionalStyleTopRightCell="\\tscnecell",uP.TableConditionalStyleBottomLeftCell="\\tscswcell",uP.TableConditionalStyleBottomRightCell="\\tscsecell",uP.NoTableBorder="\\brdrtbl",uP.NoBorder="\\brdrnil",uP.BorderWidth="\\brdrw",uP.BorderColor="\\brdrcf",uP.BorderFrame="\\brdrframe",uP.BorderSpace="\\brsp",uP.BorderArtIndex="\\brdrart",uP.BorderSingleWidth="\\brdrs",uP.BorderDoubleWidth="\\brdrth",uP.BorderShadow="\\brdrsh",uP.BorderDouble="\\brdrdb",uP.BorderDotted="\\brdrdot",uP.BorderDashed="\\brdrdash",uP.BorderSingle="\\brdrhair",uP.BorderDashedSmall="\\brdrdashsm",uP.BorderDotDashed="\\brdrdashd",uP.BorderDotDotDashed="\\brdrdashdd",uP.BorderInset="\\brdrinset",uP.BorderNone="\\brdrnone",uP.BorderOutset="\\brdroutset",uP.BorderTriple="\\brdrtriple",uP.BorderThickThinSmall="\\brdrthtnsg",uP.BorderThinThickSmall="\\brdrtnthsg",uP.BorderThinThickThinSmall="\\brdrtnthtnsg",uP.BorderThickThinMedium="\\brdrthtnmg",uP.BorderThinThickMedium="\\brdrtnthmg",uP.BorderThinThickThinMedium="\\brdrtnthtnmg",uP.BorderThickThinLarge="\\brdrthtnlg",uP.BorderThinThickLarge="\\brdrtnthlg",uP.BorderThinThickThinLarge="\\brdrtnthtnlg",uP.BorderWavy="\\brdrwavy",uP.BorderDoubleWavy="\\brdrwavydb",uP.BorderDashDotStroked="\\brdrdashdotstr",uP.BorderThreeDEmboss="\\brdremboss",uP.BorderThreeDEngrave="\\brdrengrave",uP.NumberingListTable="\\*\\listtable",uP.ListOverrideTable="\\*\\listoverridetable",uP.NumberingList="\\list",uP.NumberingListId="\\listid",uP.NumberingListTemplateId="\\listtemplateid",uP.NumberingListStyleId="\\liststyleid",uP.NumberingListStyleName="\\*\\liststylename ",uP.NumberingListName="\\listname ;",uP.NumberingListHybrid="\\listhybrid",uP.ListLevel="\\listlevel",uP.ListLevelStart="\\levelstartat",uP.ListLevelTentative="\\lvltentative",uP.ListLevelNumberingFormat="\\levelnfc",uP.ListLevelAlignment="\\leveljc",uP.ListLevelNumberingFormatN="\\levelnfcn",uP.ListLevelAlignmentN="\\leveljcn",uP.LisLeveltOld="\\levelold",uP.ListLevelPrev="\\levelprev",uP.ListLevelPrevSpase="\\levelprevspace",uP.ListLevelSpace="\\levelspace",uP.ListLevelIntdent="\\levelindent",uP.ListLevelNumbers="\\levelnumbers",uP.ListLevelText="\\leveltext",uP.LevelTemplateId="\\leveltemplateid",uP.ListLevelFollow="\\levelfollow",uP.ListLevelLegal="\\levellegal",uP.ListLevelNoRestart="\\levelnorestart",uP.ListLevelPicture="\\levelpicture",uP.ListLevelPictureNoSize="\\levelpicturenosize",uP.ListLevelLegacy="\\levelold",uP.ListLevelLegacySpace="\\levelspace",uP.ListLevelLegacyIndent="\\levelindent",uP.ListOverride="\\listoverride",uP.ListOverrideListId="\\listid",uP.ListOverrideCount="\\listoverridecount",uP.ListOverrideLevel="\\lfolevel",uP.ListOverrideFormat="\\listoverrideformat",uP.ListOverrideStart="\\listoverridestartat",uP.ListOverrideStartValue="\\levelstartat",uP.ListOverrideListLevel="\\listlevel",uP.DefaultCharacterProperties="\\*\\defchp",uP.DefaultParagraphProperties="\\*\\defpap",uP.StyleSheet="\\stylesheet",uP.ParagraphStyle="\\s",uP.CharacterStyle="\\*\\cs",uP.CharacterStyleIndex="\\cs",uP.TableStyle="\\*\\ts",uP.TableStyleIndex="\\ts",uP.TableStyleCellIndex="\\yts",uP.ParentStyle="\\sbasedon",uP.LinkedStyle="\\slink",uP.NextStyle="\\snext",uP.QuickFormatStyle="\\sqformat",uP.RTLRun="\\rtlch",uP.LTRRun="\\ltrch",uP.RLTParagraph="\\rtlpar",uP.LTRParagraph="\\ltrpar",uP.RTLRow="\\rtlrow",uP.LTRRow="\\ltrrow",uP.RTLSection="\\rtlsect",uP.LTRSection="\\ltrsect";class pP{constructor(e,t){this.index=e,this.nextKeyPosition=t}}class gP{constructor(e,t){this.object=e,this.index=t}}class mP{constructor(e){this.objects=e}init(){this.clearPublicLists(),this.currObjs=[],this.nextPos=this.objects[0]?new pP(0,this.objects[0].interval.start):new pP(0,Bo.Constants.MAX_SAFE_INTEGER)}hasObjects(e,t){return e<=this.nextPos.nextKeyPosition&&this.nextPos.nextKeyPosition<e+t}update(e){if(this.clearPublicLists(),e<this.nextPos.nextKeyPosition)return!1;this.deleteObjects(e),this.addNewObjects(e);const t=!!this.deletedObjects.length||!!this.addedObjects.length;if(t){const e=this.objects[this.nextPos.index];this.nextPos.nextKeyPosition=e?e.interval.start:Bo.Constants.MAX_SAFE_INTEGER;for(const e of this.currObjs)this.nextPos.nextKeyPosition=Math.min(this.nextPos.nextKeyPosition,e.object.interval.end)}return t}clearPublicLists(){this.deletedObjects=[],this.addedObjects=[]}deleteObjects(e){this.currObjs=f.ListUtils.reducedMap(this.currObjs,(t=>e>=t.object.interval.end?(this.deletedObjects.push(t),null):t))}addNewObjects(e){let t=this.objects[this.nextPos.index];for(;t&&t.interval.start==e;){const e=new gP(t,this.nextPos.index);t.interval.length?this.currObjs.push(e):this.deletedObjects.push(e),this.addedObjects.push(e),this.nextPos.index++,t=this.objects[this.nextPos.index]}}}class fP{constructor(e,t){this.box=e,this.info=t}splitByPosition(e,t){return new fP(this.box.splitBoxByPosition(e,t),this.info)}}class bP{constructor(e,t,r,i){this.pageIndexFromWhichTableWasMoved=null,this.paragraphIndex=e,this.sectionIndex=t,this.tablePosition=r,this.fieldsInfo=i}equalsTablePositions(e){return this.tablePosition?!(!e||this.tablePosition.length!=e.length)&&f.ListUtils.allOf2(this.tablePosition,e,((e,t)=>e.equals(t))):!e}getTableNestedLevel(){return(this.tablePosition?this.tablePosition.length:0)-1}}class CP{constructor(e,t){this.field=e,this.isInCodePart=t}static make(e,t){return new CP(e,e.getCodeIntervalWithBorders().contains(t))}}class SP{constructor(e){this.objects=e}getNextObjectPosition(){return this.nextObjPosition}init(e){this.indexes=[];const t=C.SearchUtils.normedInterpolationIndexOf(this.objects,(e=>this.getStartPosition(e)),e);if(t<0)return void this.setNextInfos(0,e);let r=this.objects[t];for(;e>=this.getEndPosition(r);){const i=this.getParent(r);if(!i)return void this.setNextInfos(t+1,e);r=i}this.collectIndexes(this.getIndex(r),e)}collectIndexes(e,t){const r=this.indexes.length;let i=this.correctBounds(e,t),n=this.objects[i];const o=this.indexes.length?f.ListUtils.last(this.indexes):-1;for(;;){this.indexes.splice(r,0,i);const e=this.getParent(n);if(!e||this.getIndex(e)==o)break;i=this.getIndex(e),n=e}this.setNextInfos(f.ListUtils.last(this.indexes)+1,t)}update(e){if(!this.objects.length)return!1;const t=this.popLastIndexes(e);return e>=this.nextObjPosition?(this.nextObjIndex=this.correctBounds(this.nextObjIndex,e),this.collectIndexes(this.nextObjIndex,e),!0):t}setNextInfos(e,t){this.nextObjIndex=e;const r=this.objects[e];!r||this.getStartPosition(r)>=t?this.nextObjPosition=r?this.getStartPosition(r):Number.MAX_VALUE:this.setNextInfos(e+1,t)}popLastIndexes(e){return!(!this.indexes.length||e<this.getEndPosition(this.objects[f.ListUtils.last(this.indexes)]))&&(this.indexes.pop(),this.popLastIndexes(e),!0)}}class IP extends SP{getStartPosition(e){return e.getStartPosition()}getEndPosition(e){return e.getEndPosition()}getParent(e){return e.getParentTable()}getIndex(e){return e.index}correctBounds(e,t){return Ja.correctBoundTable(this.objects,e,t,(e=>++e)).index}generateInfo(e){return this.indexes.length?f.ListUtils.map(this.indexes,(t=>{const r=this.objects[t],i=C.SearchUtils.normedInterpolationIndexOf(r.rows,(e=>e.getStartPosition()),e),n=C.SearchUtils.normedInterpolationIndexOf(r.rows[i].cells,(e=>e.startParagraphPosition.value),e);return new Qa(r,i,n).init()})):null}}class PP extends SP{getStartPosition(e){return e.getFieldStartPosition()}getEndPosition(e){return e.getFieldEndPosition()}getParent(e){return e.parent}getIndex(e){return e.index}correctBounds(e,t){return e}generateInfo(e){return this.indexes.length?f.ListUtils.map(this.indexes,(t=>CP.make(this.objects[t],e))):null}}!function(e){e[e.Top=0]="Top",e[e.Both=1]="Both",e[e.Center=2]="Center",e[e.Bottom=3]="Bottom"}(Rb||(Rb={}));class wP{copyFrom(e){this.onlyAllowEditingOfFormFields=e.onlyAllowEditingOfFormFields,this.firstPagePaperSource=e.firstPagePaperSource,this.otherPagePaperSource=e.otherPagePaperSource,this.textDirection=e.textDirection,this.verticalTextAlignment=e.verticalTextAlignment,this.rightToLeft=e.rightToLeft}}class yP{static ShouldExportInlinePictureRunCharacterProperties(e,t){return e.hidden||e.fontUnderlineType!=le.None||e.fontStrikeoutType!=se.None||e.highlightColor.toRgb(t)!=y.NO_COLOR||e.shadingInfo.getActualColor(t)!=y.NO_COLOR}}class xP{}xP.Dot=".",xP.EnDash="–",xP.Bullet="•",xP.LeftSingleQuote="‘",xP.RightSingleQuote="’",xP.LeftDoubleQuote="“",xP.RightDoubleQuote="”",xP.PilcrowSign="¶",xP.CurrencySign="¤",xP.CopyrightSymbol="©",xP.TrademarkSymbol="™",xP.OptionalHyphen="­",xP.RegisteredTrademarkSymbol="®",xP.Ellipsis="…",xP.OpeningSingleQuotationMark="‘",xP.ClosingSingleQuotationMark="’",xP.OpeningDoubleQuotationMark="“",xP.ClosingDoubleQuotationMark="”",xP.EmDash="—",xP.SeparatorMark="|",xP.FloatingObjectMark="\b",xP.ColumnBreak="",xP.Colon=":",xP.Underscore="_",xP.EqualSign="=",xP.MiddleDot="·",xP.Dash="-",xP.ParagraphMark="\r",xP.SectionMark="",xP.Hyphen="",xP.TabMark="\t",xP.NonBreakingSpace=" ",xP.Space=" ",xP.EmSpace=" ",xP.EnSpace=" ",xP.QmSpace=" ",xP.ZeroWidthSpace="​",xP.LineBreak="\v",xP.PageBreak="\f",xP.ObjectMark="￼",xP.CanadianSyllabicsChiSign="᙭";class TP{}var vP,MP,EP,DP,FP=__webpack_require__(677);class RP{constructor(){this.rowLengthBound=200,this.init()}clear(){this.init()}init(){this.rtfContent=new FP.T(""),this.unicodeTextBuilder=new FP.T(""),this.isPreviousWriteCommand=!1,this.rowLength=0,this.hexMode=!1}writeCommandCore(e,t){this.rtfContent.addText(e),t(),this.isPreviousWriteCommand=!0,this.increaseRowLength(e.length)}writeCommand(e,t){this.writeCommandCore(e,(()=>{null!=t&&("boolean"==typeof t?this.rtfContent.addText((0,S.boolToString)(t)):this.rtfContent.addText(t.toString()))}))}writeIntegerCommand(e,t){const r=Math.floor(t);if(O.isDebug&&r!==t)throw new Error(R.D.InternalException);this.writeCommandCore(e,(()=>this.rtfContent.addText(r.toString())))}createKeyword(e){return"\\"+e}createOptionalKeyword(e){return"\\*"+e}writeAnsiText(e){const t=e.length;this.isPreviousWriteCommand&&this.rtfContent.addText(uP.Space);for(let r=0;r<t;r++){const t=e[r],i=this.correctAnsiString(t);this.rtfContent.addText(i)}this.isPreviousWriteCommand=!1,this.increaseRowLength(e.length)}writeText(e,t=RP.specialMarks){const r=e.length;for(var i=0;i<r;i++){const r=e[i],n=t[r];n?this.writeTextDirect(n):this.writeChar(r)}}writeTextDirect(e,t=!1){this.isPreviousWriteCommand&&this.rtfContent.addText(uP.Space),t?this.rtfContent.addText(this.getUnicodeCompatibleStringDirect(e)):this.rtfContent.addText(e),this.isPreviousWriteCommand=!1,this.increaseRowLength(e.length)}writeTextDirectUnsafe(e){this.isPreviousWriteCommand&&this.rtfContent.addText(uP.Space);const t=e.textLength;this.rtfContent.addText(e.getText()),this.isPreviousWriteCommand=!1,this.increaseRowLength(t)}writeChar(e){this.isPreviousWriteCommand&&this.rtfContent.addText(uP.Space);const t=this.getUnicodeCompatibleString(e);this.rtfContent.addText(t),this.isPreviousWriteCommand=!1,this.increaseRowLength(t.length)}openGroup(){this.rtfContent.addText(uP.OpenGroup),this.isPreviousWriteCommand=!1,this.increaseRowLength(uP.OpenGroup.length)}closeGroup(){this.rtfContent.addText(uP.CloseGroup),this.isPreviousWriteCommand=!1,this.increaseRowLength(uP.CloseGroup.length)}static isSpecialSymbol(e){return"{"==e||"}"==e||"\\"==e}textHasNonASCIISymbol(e){const t=e.length;for(let r=0;r<t;r++){let t=e.charCodeAt(r);if(!this.isASCII(t))return!0}return!1}isASCII(e){return e>=0&&e<=127}isANSI(e){return e>=0&&e<=255}containsNonAnsiChar(e){return f.ListUtils.anyOf(e.split(""),(e=>!this.isANSI(this.getCode(e))))}correctAnsiString(e){this.unicodeTextBuilder=new FP.T("");const t=this.getCode(e);return this.isANSI(t)?(RP.isSpecialSymbol(e)&&this.unicodeTextBuilder.addText("\\"),this.unicodeTextBuilder.addText(e)):this.unicodeTextBuilder.addText("?"),this.unicodeTextBuilder.getText()}getUnicodeCompatibleString(e){this.unicodeTextBuilder=new FP.T("");const t=this.getCode(e);return this.isASCII(t)?(RP.isSpecialSymbol(e)&&this.unicodeTextBuilder.addText("\\"),this.unicodeTextBuilder.addText(e)):this.appendUnicodeCompatibleCharCore(t,e),this.unicodeTextBuilder.getText()}getUnicodeCompatibleStringDirect(e){this.unicodeTextBuilder=new FP.T("");const t=e.length;for(var r=0;r<t;r++){const t=e[r],i=this.getCode(t);this.isASCII(i)?this.unicodeTextBuilder.addText(t):this.appendUnicodeCompatibleCharCore(i,t)}return this.unicodeTextBuilder.getText()}appendUnicodeCompatibleCharCore(e,t){const r=function(e){for(var t=[],r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(r++,i=65536+((1023&i)<<10|1023&e.charCodeAt(r)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t}(t);this.unicodeTextBuilder.addText(`\\u${e}\\'${RP.byteToHexString[r[0]]}`)}writePictureBytes(e){this.hexMode=!0,this.rtfContent.addText(uP.Space),this.rtfContent.addText(e),this.hexMode=!1}writeByteArrayAsHex(e,t=0,r=e.length){this.isPreviousWriteCommand&&this.rtfContent.addText(uP.Space),this.hexMode=!0;const i=t+r;for(let r=t;r<i;r++)this.rtfContent.addText(Mu(e[r]));this.isPreviousWriteCommand=!0,this.hexMode=!1}writeShapeColorProperty(e,t){this.writeShapeProperty(e,this.getIntColorValue(t).toString())}getIntColorValue(e){return w.i.getRed(e)|w.i.getGreen(e)<<8|w.i.getBlue(e)<<16}writeShapeProperty(e,t){this.openGroup(),this.writeCommand(uP.ShapeProperty),this.writeShapePropertyName(e),this.writeShapePropertyValue(t),this.closeGroup()}writePCDATAShapeProperty(e,t){this.writeShapeProperty(e,(()=>this.writePCData(t)))}writePCData(e){this.writeText(e,RP.specialPCDataMarks)}writeShapePropertyName(e){this.openGroup(),this.writeCommand(uP.ShapePropertyName),this.writeTextDirect(e),this.closeGroup()}writeShapePropertyValue(e){this.openGroup(),this.writeCommand(uP.ShapePropertyValue),"string"==typeof e?this.writeTextDirect(e,!0):e(),this.closeGroup()}writeShapePropertyWithOptionalGroup(e,t,r,i){this.openGroup(),this.writeCommand(uP.ShapeProperty),this.writeShapePropertyName(e),this.writeShapePropertyValue(t),this.openGroup(),this.writeCommand(this.createOptionalKeyword(r)+" "),this.writeCommand(i),this.closeGroup(),this.closeGroup()}writeShapeIntegerProperty(e,t){this.writeShapeProperty(e,Math.round(t).toString())}writeShapeBoolProperty(e,t){this.writeShapeProperty(e,(0,S.boolToString)(t))}increaseRowLength(e){this.rowLength+=e,this.rowLength>=this.rowLengthBound&&this.hexMode&&(this.rtfContent.addText(uP.CLRF),this.isPreviousWriteCommand=!1,this.rowLength=0)}getCode(e){const t=e.charCodeAt(0);return t>32767?t-65536:t}writeDescription(e){let t="";rn.StringUtils.isNullOrEmpty(e.title)?rn.StringUtils.isNullOrEmpty(e.description)||(t=e.description):(t+="Title: "+e.title,rn.StringUtils.isNullOrEmpty(e.description)||(t+=" - Description: "+e.description)),rn.StringUtils.isNullOrEmpty(t)||this.writeShapeProperty("wzDescription",t)}}function LP(e,t,r){e[t]="'"+r[t]}RP.specialMarks=(new Eu).add(xP.EmSpace,"\\u8195\\'3f").add(xP.EnSpace,"\\u8194\\'3f").add(xP.Hyphen,"").add(xP.LineBreak,"\\line ").add(xP.PageBreak,"\\page ").add(xP.ColumnBreak,"\\column ").add(xP.QmSpace,"\\u8197\\'3f").add(xP.TabMark,"\\tab ").get(),RP.byteToHexString=function(){const e=[];for(var t=0;t<256;t++)e[t]=t.toString(16);return e}(),RP.specialPCDataMarks=function(e){const t=(new Eu).get();for(let r=0;r<31;r++)LP(t,r.toString(),e);return LP(t,"\\",e),LP(t,"{",e),LP(t,"}",e),t}(RP.byteToHexString);class BP{constructor(){this.ensurePictureLoadedTimeout=3e3}}class AP extends BP{constructor(){super(),this.exportTheme=!0,this.listExportFormat=vP.RtfFormat,this.exportFinalParagraphMark=MP.Always,this.compatibility=new NP,this.compatibility.backColorExportMode=EP.Default,this.compatibility.duplicateObjectAsMetafile=!1}}class NP{}!function(e){e[e.PlainTextFormat=0]="PlainTextFormat",e[e.RtfFormat=1]="RtfFormat"}(vP||(vP={})),function(e){e[e.Always=0]="Always",e[e.Never=1]="Never",e[e.SelectedOnly=2]="SelectedOnly"}(MP||(MP={})),function(e){e[e.Default=0]="Default",e[e.Chcbpat=1]="Chcbpat",e[e.Highlight=2]="Highlight",e[e.Both=3]="Both"}(EP||(EP={})),function(e){e[e.None=0]="None",e[e.Category=1]="Category",e[e.ContentStatus=2]="ContentStatus",e[e.ContentType=4]="ContentType",e[e.Created=8]="Created",e[e.Creator=16]="Creator",e[e.Description=32]="Description",e[e.Identifier=64]="Identifier",e[e.Keywords=128]="Keywords",e[e.Language=256]="Language",e[e.LastModifiedBy=512]="LastModifiedBy",e[e.LastPrinted=1024]="LastPrinted",e[e.Modified=2048]="Modified",e[e.Revision=4096]="Revision",e[e.Subject=8192]="Subject",e[e.Title=16384]="Title",e[e.Version=32768]="Version",e[e.BuiltinProperties=65535]="BuiltinProperties",e[e.CustomProperties=983040]="CustomProperties",e[e.All=1048575]="All"}(DP||(DP={}));class kP{static createDrawingObjectTextWrapTypeTable(){return(new Eu).add(uc.TopAndBottom,1).add(uc.Square,2).add(uc.None,3).add(uc.Tight,4).add(uc.Through,5).get()}static createDrawingObjectTextWrapSideTable(){return(new Eu).add(pc.Both,0).add(pc.Left,1).add(pc.Right,2).add(pc.Largest,3).get()}static createFloatingObjectHorizontalPositionAlignmentTable(){return(new Eu).add(mc.None,0).add(mc.Left,1).add(mc.Center,2).add(mc.Right,3).add(mc.Inside,4).add(mc.Outside,5).get()}static createFloatingObjectHorizontalPositionTypeTable(){return(new Eu).add(gc.Margin,0).add(gc.Page,1).add(gc.Column,2).add(gc.Character,3).add(gc.LeftMargin,4).add(gc.RightMargin,5).add(gc.InsideMargin,6).add(gc.OutsideMargin,7).get()}static createFloatingObjectVerticalPositionAlignment(){return(new Eu).add(bc.None,0).add(bc.Top,1).add(bc.Center,2).add(bc.Bottom,3).add(bc.Inside,4).add(bc.Outside,5).get()}static createFloatingObjectVerticalPositionType(){return(new Eu).add(fc.Margin,0).add(fc.Page,1).add(fc.Paragraph,2).add(fc.Line,3).add(fc.TopMargin,4).add(fc.BottomMargin,5).add(fc.InsideMargin,6).add(fc.OutsideMargin,7).get()}static createFloatingObjectRelativeWidthType(){return(new Eu).add(cc.Margin,0).add(cc.Page,1).add(cc.LeftMargin,2).add(cc.RightMargin,3).add(cc.InsideMargin,4).add(cc.OutsideMargin,5).get()}static createFloatingObjectRelativeHeightType(){return(new Eu).add(hc.Margin,0).add(hc.Page,1).add(hc.TopMargin,2).add(hc.BottomMargin,3).add(hc.InsideMargin,4).add(hc.OutsideMargin,5).get()}}kP.DXInternalLegacyHorizontalPositionAlignment="_dxInternalLegacyHorizontalPositionAlignment",kP.DXInternalLegacyVerticalPositionAlignment="_dxInternalLegacyVerticalPositionAlignment",kP.DXInternalIsShape="_dxInternalIsShape",kP.Shape="shp",kP.ShapeInstance="shpinst",kP.ShapeGroup="shpgrp",kP.ShapeText="shptxt",kP.ShapeLid="shplid",kP.ShapeLeft="shpleft",kP.ShapeRight="shpright",kP.ShapeTop="shptop",kP.ShapeBottom="shpbottom",kP.ShapeZOrder="shpz",kP.ShapeLegacyHorizontalPositionTypePage="shpbxpage",kP.ShapeLegacyHorizontalPositionTypeMargin="shpbxmargin",kP.ShapeLegacyHorizontalPositionTypeColumn="shpbxcolumn",kP.ShapeIgnoreLegacyHorizontalPositionType="shpbxignore",kP.ShapeLegacyVerticalPositionTypePage="shpbypage",kP.ShapeLegacyVerticalPositionTypeMargin="shpbymargin",kP.ShapeLegacyVerticalPositionTypeParagraph="shpbypara",kP.ShapeIgnoreLegacyVerticalPositionType="shpbyignore",kP.ShapeWrapTextType="shpwr",kP.ShapeWrapTextTypeZOrder="shpfblwtxt",kP.ShapeWrapTextSide="shpwrk",kP.ShapeLocked="shplockanchor",kP.Name="wzName",kP.LockAspectRatio="fLockAspectRatio",kP.Rotation="rotation",kP.Filled="fFilled",kP.FillColor="fillColor",kP.LineWidth="lineWidth",kP.Line="fLine",kP.LineColor="lineColor",kP.CropFromTop="cropFromTop",kP.CropFromBottom="cropFromBottom",kP.CropFromLeft="cropFromLeft",kP.CropFromRight="cropFromRight",kP.FitShapeToText="fFitShapeToText",kP.WrapText="WrapText",kP.LayoutInCell="fLayoutInCell",kP.HorizontalPositionAlignment="posh",kP.HorizontalPositionType="posrelh",kP.VerticalPositionAlignment="posv",kP.VerticalPositionType="posrelv",kP.RelativeHorizontalSizeWidth="pctHoriz",kP.RelativeHorizontalSizeFrom="sizerelh",kP.RelativeVerticalSizeHeight="pctVert",kP.RelativeVerticalSizeFrom="sizerelv",kP.PictureBinaryData="pib",kP.ExternalPictureName="pibName",kP.WrapDistLeft="dxWrapDistLeft",kP.WrapDistRight="dxWrapDistRight",kP.WrapDistTop="dyWrapDistTop",kP.WrapDistBottom="dyWrapDistBottom",kP.Hidden="fHidden",kP.AllowOverlap="fAllowOverlap",kP.BehindDocument="fBehindDocument",kP.TextLeft="dxTextLeft",kP.TextTop="dyTextTop",kP.TextRight="dxTextRight",kP.TextBottom="dyTextBottom",kP.FlipH="fFlipH",kP.FlipV="fFlipV",kP.PctHorizPos="pctHorizPos",kP.PctVertPos="pctVertPos",kP.PseudoInline="fPseudoInline",kP.ShapeType="shapeType",kP.BWMode="bWMode",kP.GeoLeft="geoLeft",kP.GeoTop="geoTop",kP.GeoRight="geoRight",kP.GeoBottom="geoBottom",kP.ShapePath="shapePath",kP.Verticies="pVerticies",kP.SegmentInfo="pSegmentInfo",kP.ConnectionSites="pConnectionSites",kP.ConnectionSitesDir="pConnectionSitesDir",kP.ShadowType="shadowType",kP.ShadowColor="shadowColor",kP.ShadowOpacity="shadowOpacity",kP.ShadowOffsetX="shadowOffsetX",kP.ShadowOffsetY="shadowOffsetY",kP.ShadowScaleXToX="shadowScaleXToX",kP.ShadowScaleYToY="shadowScaleYToY",kP.ShadowScaleYToX="shadowScaleYToX",kP.ShadowScaleXToY="shadowScaleXToY",kP.ShadowOriginX="shadowOriginX",kP.ShadowOriginY="shadowOriginY",kP.Shadow="fShadow",kP.ShadowSoftness="shadowSoftness",kP.PictureBrightness="pictureBrightness",kP.PictureContrast="pictureContrast",kP.PictureGray="pictureGray",kP.PictureTransparent="pictureTransparent",kP.AdjustValue="adjustValue",kP.AdjustFormatStringValue="adjust{0}Value",kP.FillType="fillType",kP.Hsv="hsv",kP.Accent1="caccentone",kP.Accent2="caccenttwo",kP.Accent3="caccentthree",kP.Accent4="caccentfour",kP.Accent5="caccentfive",kP.Accent6="caccentsix",kP.Tint="ctint",kP.Shade="cshade",kP.FillOpacity="fillOpacity",kP.FillBackColor="fillBackColor",kP.FillBackOpacity="fillBackOpacity",kP.FillAngle="fillAngle",kP.FillFocus="fillFocus",kP.FillToBottom="fillToBottom",kP.FillToTop="fillToTop",kP.FillToLeft="fillToLeft",kP.FillToRight="fillToRight",kP.LineMiterLimit="lineMiterLimit",kP.LineStyle="lineStyle",kP.LineDashing="lineDashing",kP.LineStartArrowhead="lineStartArrowhead",kP.LineEndArrowhead="lineEndArrowhead",kP.LineStartArrowWidth="lineStartArrowWidth",kP.LineEndArrowWidth="lineEndArrowWidth",kP.LineStartArrowLength="lineStartArrowLength",kP.LineEndArrowLength="lineEndArrowLength",kP.LineJoinStyle="lineJoinStyle",kP.LineEndCapStyle="lineEndCapStyle",kP.LineType="lineType",kP.LockAgainstGrouping="fLockAgainstGrouping",kP.LockAgainstSelect="fLockAgainstSelect",kP.LockPosition="fLockPosition",kP.LockRotation="fLockRotation",kP.LockVerticies="fLockVerticies",kP.LockAdjustHandles="fLockAdjustHandles",kP.LockShapeType="fLockShapeType",kP.LockText="fLockText",kP.LockAgainstUngrouping="fLockAgainstUngrouping",kP.LockCropping="fLockCropping",kP.FillShadeColors="fillShadeColors",kP.FillBlip="fillBlip",kP.LineFillBlip="lineFillBlip",kP.Description="wzDescription",kP.PihlShape="pihlShape",kP.Tooltip="wzTooltip",kP.ShapeHyperlink="hl",kP.ShapeHyperlinkFrame="hlfr",kP.ShapeHyperlinkSource="hlsrc",kP.ShapeHyperlinkLocation="hlloc",kP.AnchorText="anchorText",kP.TxflTextFlow="txflTextFlow",kP.GroupLeft="groupLeft",kP.GroupRight="groupRight",kP.GroupTop="groupTop",kP.GroupBottom="groupBottom",kP.Dhgt="dhgt",kP.RelLeft="relLeft",kP.RelRight="relRight",kP.RelTop="relTop",kP.RelBottom="relBottom",kP.RelFlipH="fRelFlipH",kP.RelFlipV="fRelFlipV",kP.WrapPolygonVertices="pWrapPolygonVertices",kP.EditedWrap="fEditedWrap",kP.Dgmt="dgmt",kP.PreferRelativeResize="fPreferRelativeResize",kP.XLimo="xLimo",kP.YLimo="yLimo",kP.LineOpacity="lineOpacity",kP.LineBackColor="lineBackColor",kP.PInscribe="pInscribe",kP.IsButton="fIsButton",kP.PatternFillFormatString="{{\\pict\\picscalex-1\\picscaley-1\\piccropl0\\piccropr0\\piccropt0\\piccropb0\\picw212\\pich212\\picwgoal120\\pichgoal120\\wmetafile8\\bliptag{0}\\blipupi96}}",kP.DrawingObjectTextWrapTypeTable=kP.createDrawingObjectTextWrapTypeTable(),kP.DrawingObjectTextWrapSideTable=kP.createDrawingObjectTextWrapSideTable(),kP.DrawingObjectHorizontalPositionAlignmentTable=kP.createFloatingObjectHorizontalPositionAlignmentTable(),kP.DrawingObjectHorizontalPositionTypeTable=kP.createFloatingObjectHorizontalPositionTypeTable(),kP.DrawingObjectVerticalPositionAlignmentTable=kP.createFloatingObjectVerticalPositionAlignment(),kP.DrawingObjectVerticalPositionTypeTable=kP.createFloatingObjectVerticalPositionType(),kP.DrawingObjectRelativeWidthTypeTable=kP.createFloatingObjectRelativeWidthType(),kP.DrawingObjectRelativeHeightTypeTable=kP.createFloatingObjectRelativeHeightType();class OP{constructor(e,t,r){this.rtfBuilder=e,this.base64Uri=r,this.run=t}getPictureSize(){const e=g.u.twipsToHundredthsOfMillimeter(this.run.size.originalSize.width),t=g.u.twipsToHundredthsOfMillimeter(this.run.size.originalSize.height);return new so.Size(e,t)}getImageBytesAsString(){return vu(Du.getBase64DataWithoutPrefix(this.base64Uri))}exportPicture(e){this.rtfBuilder.openGroup(),this.writePictureHeader(e);try{this.rtfBuilder.writePictureBytes(this.getImageBytesAsString())}finally{this.rtfBuilder.closeGroup()}}writePictureShapeProperties(e,t){if(this.run instanceof nh){e.openGroup();try{e.writeCommand(uP.PictureProperties),rn.StringUtils.isNullOrEmpty(t.name)||e.writeShapeProperty(kP.Name,t.name),e.writeDescription(t)}finally{e.closeGroup()}}}writePictureHeader(e){const t=this.getPictureSize(),r=this.run.size.originalSize.clone(),i=this.run.size.scale.clone();for(;r.width>32767||r.height>32767;)r.width/=2,r.height/=2,i.width*=2,i.height*=2,t.width/=2,t.height/=2;this.rtfBuilder.writeCommand(uP.Picture),this.writePictureShapeProperties(this.rtfBuilder,e),this.rtfBuilder.writeCommand(this.getRtfPictureType()),this.rtfBuilder.writeIntegerCommand(uP.PictureWidth,Math.max(t.width,1)),this.rtfBuilder.writeIntegerCommand(uP.PictureHeight,Math.max(t.height,1));const n=Math.max(Math.round(i.width),1),o=Math.max(Math.round(i.height),1),a=r.width/n*i.width-.5,s=r.height/o*i.height-.5;this.rtfBuilder.writeIntegerCommand(uP.PictureDesiredWidth,Math.max(a,1)),this.rtfBuilder.writeIntegerCommand(uP.PictureDesiredHeight,Math.max(s,1)),this.rtfBuilder.writeIntegerCommand(uP.PictureScaleX,n),this.rtfBuilder.writeIntegerCommand(uP.PictureScaleY,o)}}class _P extends OP{getRtfPictureType(){return uP.JpegPictureKeyword}constructor(e,t,r){super(e,t,r)}}class UP extends OP{getRtfPictureType(){return uP.PNGPictureKeyword}constructor(e,t,r){super(e,t,r)}}class HP{static createRtfPictureExporter(e,t,r){const i=t.size.cacheInfo.base64,n=Du.getMimeTypeFromBase64Uri(i);return"jpeg"==Du.convertMimeTypeToExtension(n)?new _P(e,t,i):new UP(e,t,i)}}class VP{export(e,t,r,i){this.exportShapePicturePrefix(e);HP.createRtfPictureExporter(e,t,r).exportPicture(i),this.exportShapePicturePostfix(e)}}class WP extends VP{exportShapePicturePrefix(e){e.openGroup(),e.writeCommand(uP.ShapePicture)}exportShapePicturePostfix(e){e.closeGroup()}}class zP extends VP{exportShapePicturePrefix(e){e.openGroup(),e.writeCommand(uP.ShapeProperty),e.writeShapePropertyName(kP.PictureBinaryData),e.openGroup(),e.writeCommand(uP.ShapePropertyValue)}exportShapePicturePostfix(e){e.closeGroup(),e.closeGroup()}}class jP{static shouldSwapSize(e){let t=e%23592960;return t<0&&(t+=23592960),t>=2949120&&t<8847360||t>=14745600&&t<20643840}}jP.distanceFromText=114305;class XP{constructor(e,t,r,i,n){this.rtfBuilder=e,this.anchorInfo=t,this.shape=r,this.size=i,this.nonVisualDrawingObjectInfo=n}getShapeHorizontalPositionType(e){switch(e){case gc.Page:return uP.ShapeLegacyHorizontalPositionTypePage;case gc.Margin:return uP.ShapeLegacyHorizontalPositionTypeMargin;case gc.Column:return uP.ShapeLegacyHorizontalPositionTypeColumn;default:return uP.ShapeLegacyHorizontalPositionTypeMargin}}getShapeVerticalPositionType(e){switch(e){case fc.Page:return uP.ShapeLegacyVerticalPositionTypePage;case fc.Margin:return uP.ShapeLegacyVerticalPositionTypeMargin;case fc.Paragraph:default:return uP.ShapeLegacyVerticalPositionTypeParagraph}}exportFloatingObjectHorizontalPositionType(e){this.rtfBuilder.writeCommand(this.getShapeHorizontalPositionType(e)),this.rtfBuilder.writeCommand(uP.ShapeIgnoreLegacyHorizontalPositionType)}exportFloatingObjectVerticalPositionType(e){this.rtfBuilder.writeCommand(this.getShapeVerticalPositionType(e)),this.rtfBuilder.writeCommand(uP.ShapeIgnoreLegacyVerticalPositionType)}exportShapeInstanceProperties(){let e=this.anchorInfo.offset.x,t=this.anchorInfo.offset.y;const r=g.u.twipsToFD(this.size.rotation);let i=this.getWidth(),n=this.getHeight();if(jP.shouldSwapSize(r)){const r=i;i=n,n=r,e+=i,t-=i}this.rtfBuilder.writeIntegerCommand(uP.ShapeLeft,e),this.rtfBuilder.writeIntegerCommand(uP.ShapeTop,t),this.rtfBuilder.writeIntegerCommand(uP.ShapeRight,e+i),this.rtfBuilder.writeIntegerCommand(uP.ShapeBottom,t+n),this.rtfBuilder.writeShapeIntegerProperty("lineWidth",g.u.twipsToEmu(this.shape.outlineWidth)),this.exportFloatingObjectTextWrapType(this.anchorInfo.wrapType,this.anchorInfo.isBehindDoc),this.exportFloatingObjectHorizontalPositionType(this.anchorInfo.horizontalPositionType),this.exportFloatingObjectVerticalPositionType(this.anchorInfo.verticalPositionType),0!=this.anchorInfo.zOrder&&this.rtfBuilder.writeIntegerCommand(uP.ShapeZOrder,this.anchorInfo.zOrder),this.anchorInfo.wrapSide&&this.rtfBuilder.writeIntegerCommand(uP.ShapeWrapTextSide,kP.DrawingObjectTextWrapSideTable[this.anchorInfo.wrapSide]),1==this.anchorInfo.locked&&this.rtfBuilder.writeCommand(uP.ShapeLocked)}exportFloatingObjectTextWrapType(e,t){e==uc.None?(this.rtfBuilder.writeCommand(uP.ShapeWrapTextType,"3"),this.rtfBuilder.writeCommand(uP.ShapeWrapTextTypeZOrder,(0,S.boolToString)(t))):this.rtfBuilder.writeIntegerCommand(uP.ShapeWrapTextType,kP.DrawingObjectTextWrapTypeTable[e])}exportFloatingObjectShape(){this.size.rotation&&this.rtfBuilder.writeShapeIntegerProperty("rotation",g.u.twipsToFD(this.size.rotation)),this.rtfBuilder.writeShapeBoolProperty("fLine",!U.isTransparentOrEmptyorNoColor(this.shape.outlineColor)),this.shape.outlineColor!=y.NO_COLOR&&this.shape.outlineWidth>0&&(this.rtfBuilder.writeShapeIntegerProperty("lineWidth",g.u.twipsToEmu(this.shape.outlineWidth)),this.shape.outlineColor&&!U.isTransparentOrEmpty(this.shape.outlineColor)&&this.rtfBuilder.writeShapeColorProperty("lineColor",this.shape.outlineColor));const e=this.shape.fillColor;e&&!U.isTransparentOrEmpty(e)&&e!=y.NO_COLOR?(this.rtfBuilder.writeShapeBoolProperty("fFilled",!0),this.rtfBuilder.writeShapeColorProperty("fillColor",e)):this.rtfBuilder.writeShapeBoolProperty("fFilled",!1)}exportFloatingObjectRelativeSize(){const e=this.anchorInfo.percentOffset;0!=e.x&&this.rtfBuilder.writeShapeIntegerProperty("pctHorizPos",e.x/100),0!=e.y&&this.rtfBuilder.writeShapeIntegerProperty("pctVertPos",e.y/100)}export(){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.Shape),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ShapeInstance),this.exportShapeInstanceProperties(),this.exportFloatingObjectShape(),this.anchorInfo.horizontalPositionAlignment&&this.rtfBuilder.writeShapeIntegerProperty("posh",kP.DrawingObjectHorizontalPositionAlignmentTable[this.anchorInfo.horizontalPositionAlignment]),this.rtfBuilder.writeShapeIntegerProperty("posrelh",kP.DrawingObjectHorizontalPositionTypeTable[this.anchorInfo.horizontalPositionType]),this.anchorInfo.verticalPositionAlignment&&this.rtfBuilder.writeShapeIntegerProperty("posv",kP.DrawingObjectVerticalPositionAlignmentTable[this.anchorInfo.verticalPositionAlignment]),this.rtfBuilder.writeShapeIntegerProperty("posrelv",kP.DrawingObjectVerticalPositionTypeTable[this.anchorInfo.verticalPositionType]),this.rtfBuilder.writeShapeBoolProperty("fLayoutInCell",this.anchorInfo.layoutTableCell),this.rtfBuilder.writeShapeBoolProperty("fAllowOverlap",this.anchorInfo.allowOverlap),this.rtfBuilder.writeShapeBoolProperty("fLockAspectRatio",this.size.lockAspectRatio),this.rtfBuilder.writeShapeBoolProperty("fHidden",this.anchorInfo.hidden),this.rtfBuilder.writeShapeBoolProperty("fBehindDocument",this.anchorInfo.isBehindDoc);const e=g.u.twipsToEmu(this.anchorInfo.leftDistance);e!=jP.distanceFromText&&this.rtfBuilder.writeShapeIntegerProperty("dxWrapDistLeft",e);const t=g.u.twipsToEmu(this.anchorInfo.rightDistance);t!=jP.distanceFromText&&this.rtfBuilder.writeShapeIntegerProperty("dxWrapDistRight",t),this.rtfBuilder.writeShapeIntegerProperty("dyWrapDistTop",g.u.twipsToEmu(this.anchorInfo.topDistance)),this.rtfBuilder.writeShapeIntegerProperty("dyWrapDistBottom",g.u.twipsToEmu(this.anchorInfo.bottomDistance)),this.exportFloatingObjectRelativeSize(),rn.StringUtils.isNullOrEmpty(this.nonVisualDrawingObjectInfo.name)||this.rtfBuilder.writeShapeProperty(kP.Name,this.nonVisualDrawingObjectInfo.name),this.rtfBuilder.writeDescription(this.nonVisualDrawingObjectInfo),this.exportContent(),this.rtfBuilder.closeGroup(),this.rtfBuilder.closeGroup()}}class GP extends XP{getWidth(){return this.size.actualSize.width}getHeight(){return this.size.actualSize.height}constructor(e,t,r){super(e,t.anchorInfo,t.shape,t.size,t.info.containerProperties),this.pictureRun=t,this.imageCache=r}exportContent(){(new zP).export(this.rtfBuilder,this.pictureRun.info,this.imageCache,this.pictureRun.info.containerProperties)}}class KP extends XP{constructor(e,t,r){super(e,t.anchorInfo,t.shape,t.size,t.containerProperties),this.textBoxRun=t,this.exportTextBoxContent=r}getWidth(){return this.textBoxRun.size.absoluteSize.width}getHeight(){return this.textBoxRun.size.absoluteSize.height}exportContent(){this.exportTextBoxProperties(this.textBoxRun.textBoxProperties),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ShapeText),this.exportTextBoxContent(),this.rtfBuilder.closeGroup()}exportTextBoxProperties(e){(0,S.isDefined)(e.leftMargin)&&this.rtfBuilder.writeShapeIntegerProperty("dxTextLeft",g.u.twipsToEmu(e.leftMargin)),(0,S.isDefined)(e.rightMargin)&&this.rtfBuilder.writeShapeIntegerProperty("dxTextRight",g.u.twipsToEmu(e.rightMargin)),(0,S.isDefined)(e.topMargin)&&this.rtfBuilder.writeShapeIntegerProperty("dyTextTop",g.u.twipsToEmu(e.topMargin)),(0,S.isDefined)(e.bottomMargin)&&this.rtfBuilder.writeShapeIntegerProperty("dyTextBottom",g.u.twipsToEmu(e.bottomMargin)),(0,S.isDefined)(e.resizeShapeToFitText)&&this.rtfBuilder.writeShapeBoolProperty("fFitShapeToText",e.resizeShapeToFitText),(0,S.isDefined)(e.wrapText)&&0==e.wrapText&&this.rtfBuilder.writeShapeIntegerProperty("WrapText",2)}exportFloatingObjectRelativeSize(){const e=this.textBoxRun.size;e.useAbsoluteWidth()||(this.rtfBuilder.writeShapeIntegerProperty("sizerelh",kP.DrawingObjectRelativeWidthTypeTable[e.relativeWidthType]),this.rtfBuilder.writeShapeIntegerProperty("pctHoriz",e.relativeSize.width/100)),e.useAbsoluteHeight()||(this.rtfBuilder.writeShapeIntegerProperty("sizerelv",kP.DrawingObjectRelativeHeightTypeTable[e.relativeHeightType]),this.rtfBuilder.writeShapeIntegerProperty("pctVert",e.relativeSize.height/100)),super.exportFloatingObjectRelativeSize()}}class qP{static exportShadingPattern(e,t,r,i){const n=me.calculateShadingPatternValue(r.shadingPattern);if(n>=0){if(U.isTransparentOrEmpty(r.backColor.toRgb(t))&&xe.defaultItem.equals(r.foreColor)&&0==n)return;e.writeIntegerCommand(i,10*n)}}static exportShadingForeColorIndex(e,t,r,i,n){xe.defaultItem.equals(i.foreColor)||qP.exportShadingColorIndexCore(e,t,r,i.foreColor,n)}static exportShadingBackColorIndex(e,t,r,i,n){xe.defaultItem.equals(i.backColor)||qP.exportShadingColorIndexCore(e,t,r,i.backColor,n)}static exportShadingColorIndexCore(e,t,r,i,n){if(xe.defaultItem.equals(i)||U.isTransparentOrEmpty(i.toRgb(r)))return;const o=t.getColorIndex(i);e.writeIntegerCommand(n,o)}}class $P{constructor(e,t,r){this.documentModel=e,this.rtfExportHelper=t,this.rtfBuilder=r}writeBoolCommand(e,t){t?this.rtfBuilder.writeCommand(e):this.rtfBuilder.writeIntegerCommand(e,0)}writeBorderProperties(e){const t=this.documentModel.defaultTableCellProperties.borders.bottom;if(this.writeBorderStyle(e.style),e.style!=de.Nil){if(this.writeBorderWidth(e.width,t.width),e.offset!=t.offset&&this.rtfBuilder.writeIntegerCommand(uP.BorderSpace,e.offset),!t.color.equals(e.color)&&!xe.defaultItem.equals(e.color)){const t=this.rtfExportHelper.getColorIndex(e.color);this.rtfBuilder.writeIntegerCommand(uP.BorderColor,t)}e.frame!=t.frame&&this.rtfBuilder.writeCommand(uP.BorderFrame),e.shadow!=t.shadow&&this.rtfBuilder.writeCommand(uP.BorderShadow)}}writeBorderWidth(e,t){e!=t&&(e>255?(e=Math.min(e/2,255),this.rtfBuilder.writeIntegerCommand(uP.BorderWidth,e),this.rtfBuilder.writeCommand(uP.BorderDoubleWidth)):this.rtfBuilder.writeIntegerCommand(uP.BorderWidth,e))}writeBorderStyle(e){if(e!=de.Single){let t=mw.borderLineStyles[e];t&&this.rtfBuilder.writeCommand(t)}else this.rtfBuilder.writeCommand(uP.BorderSingleWidth)}writeWidthUnit(e,t,r,i=!1){const n=lr.createDefault();if(e.type!=n.type){let o=e.value;switch(e.type){case Je.ModelUnits:this.rtfBuilder.writeIntegerCommand(t,Je.ModelUnits);break;case Je.FiftiethsOfPercent:this.rtfBuilder.writeIntegerCommand(t,Je.FiftiethsOfPercent);break;case Je.Auto:this.rtfBuilder.writeIntegerCommand(t,Je.Auto);break;case Je.Nil:this.rtfBuilder.writeIntegerCommand(t,Je.Nil);break;default:throw new Error(R.D.InternalException)}(e.value!=n.value||i)&&this.rtfBuilder.writeIntegerCommand(r,o)}}writeWidthUnitInTwips(e,t,r){const i=lr.createDefault();if(e.type!=i.type){switch(e.type){case Je.ModelUnits:this.rtfBuilder.writeIntegerCommand(t,Je.ModelUnits);break;case Je.Nil:this.rtfBuilder.writeIntegerCommand(t,Je.Nil);break;default:throw new Error(R.D.InternalException)}e.value!=i.value&&this.rtfBuilder.writeIntegerCommand(r,e.value)}}shouldExportCellMargin(e){return e.type!=Je.Nil||0!=e.value}}class JP extends $P{constructor(e,t,r,i){super(e,t,r),this.emptyColorIndex=-1,this.defaultRtfFontSize=24,this.options=i}exportCharacterStyle(e,t){this.shouldWriteRunCharacterStyle(e,t)&&this.writeCharacterStyle(e)}shouldWriteRunCharacterStyle(e,t){return e.styleName!=zl.defaultParagraphCharacterStyleName&&(t.styleName==es.normalStyleName||(!t.linkedStyle||t.linkedStyle!=e))}writeCharacterStyle(e){const t=this.rtfExportHelper.characterStylesCollectionIndex,r=e.styleName;B.StringMapUtils.containsBy(t,((e,t)=>t==r))&&this.rtfBuilder.writeIntegerCommand(uP.CharacterStyleIndex,t[r])}exportCharacterProperties(e,t=!1,r=!1,i=!1){this.exportCharacterPropertiesCore(e,r,i);const n=e;if(this.writeForegroundColor(n.textColor,t),this.options.compatibility.backColorExportMode==EP.Default)xe.defaultItem.equals(n.highlightColor)||this.writeHighlightColor(n.highlightColor),this.writeRunShading(n.shadingInfo);else{const e=this.calculateColorIndex(n);e!=this.emptyColorIndex&&this.writeBackgroundColor(e,this.options.compatibility.backColorExportMode)}xe.defaultItem.equals(n.underlineColor)||this.writeUnderlineColor(n.underlineColor)}exportCharacterPropertiesCore(e,t,r){if(e.noProof&&this.rtfBuilder.writeCommand(uP.NoProof),e.allCaps&&this.rtfBuilder.writeCommand(uP.AllCapitals),e.smallCaps&&this.rtfBuilder.writeCommand(uP.SmallCapitals),e.hidden&&this.rtfBuilder.writeCommand(uP.HiddenText),e.fontBold&&this.rtfBuilder.writeCommand(uP.FontBold),e.fontItalic&&this.rtfBuilder.writeCommand(uP.FontItalic),e.fontStrikeoutType!=se.None&&this.rtfBuilder.writeCommand(e.fontStrikeoutType==se.Single?uP.FontStrikeout:uP.FontDoubleStrikeout),e.script!=ne.Normal&&this.rtfBuilder.writeCommand(e.script==ne.Subscript?uP.RunSubScript:uP.RunSuperScript),e.underlineWordsOnly&&e.fontUnderlineType==le.Single?this.rtfBuilder.writeCommand(uP.FontUnderlineWordsOnly):e.fontUnderlineType!=le.None&&this.writeFontUnderline(e.fontUnderlineType),!r&&e.fontInfo){const t=this.writeFontName(e.fontInfo.name);t>=0&&this.registerFontCharset(e,t)}!t&&e.fontSize&&this.writeFontSize(2*e.fontSize)}exportParagraphCharacterProperties(e){this.exportCharacterPropertiesCore(e,!1,!1),this.writeForegroundColor(e.textColor)}registerFontCharset(e,t){}writeFontUnderline(e){if(e==le.None)return;let t=JP.defaultUnderlineTypes[e];t&&null!=t&&0!=t.length||(t=JP.defaultUnderlineTypes[le.Single]),this.rtfBuilder.writeCommand(t)}writeFontName(e){let t=this.rtfExportHelper.getFontNameIndex(e);return t==this.rtfExportHelper.defaultFontIndex?-1:(this.rtfBuilder.writeIntegerCommand(uP.FontNumber,t),t)}writeFontSize(e){e!=this.defaultRtfFontSize&&this.rtfBuilder.writeIntegerCommand(uP.FontSize,e)}calculateColorIndex(e){if(!xe.defaultItem.equals(e.highlightColor))return this.rtfExportHelper.getColorIndex(e.highlightColor);const t=e.shadingInfo.backColor;if(!xe.defaultItem.equals(t)){const r=e.shadingInfo.backColor.toRgb(this.documentModel.colorProvider);if(!U.isTransparentOrEmpty(r))return this.rtfExportHelper.getColorIndex(t)}return this.emptyColorIndex}writeBackgroundColor(e,t){t==EP.Chcbpat?this.rtfBuilder.writeIntegerCommand(uP.RunBackgroundColor,e):t==EP.Highlight?this.rtfBuilder.writeIntegerCommand(uP.RunHighlightColor,e):(this.rtfBuilder.writeIntegerCommand(uP.RunHighlightColor,e),this.rtfBuilder.writeIntegerCommand(uP.RunBackgroundColor,e))}writeRunShading(e){qP.exportShadingPattern(this.rtfBuilder,this.documentModel.colorProvider,e,uP.RunShadingPattern);const t=uP.RunShadingPatternTable[e.shadingPattern];t&&this.rtfBuilder.writeCommand(t),qP.exportShadingForeColorIndex(this.rtfBuilder,this.rtfExportHelper,this.documentModel.colorProvider,e,uP.RunFillColor),qP.exportShadingBackColorIndex(this.rtfBuilder,this.rtfExportHelper,this.documentModel.colorProvider,e,uP.RunBackgroundColor)}writeForegroundColor(e,t=!1){const r=this.rtfExportHelper.getColorIndex(e);t&&xe.defaultItem.equals(e)||this.rtfBuilder.writeIntegerCommand(uP.RunForegroundColor,r)}writeHighlightColor(e){const t=this.rtfExportHelper.getColorIndex(e);this.rtfBuilder.writeIntegerCommand(uP.RunHighlightColor,t)}writeUnderlineColor(e){const t=this.rtfExportHelper.getColorIndex(e);this.rtfBuilder.writeIntegerCommand(uP.RunUnderlineColor,t)}}JP.defaultUnderlineTypes=(new Eu).add(le.None,"").add(le.Single,uP.FontUnderline).add(le.Dotted,uP.FontUnderlineDotted).add(le.Dashed,uP.FontUnderlineDashed).add(le.DashDotted,uP.FontUnderlineDashDotted).add(le.DashDotDotted,uP.FontUnderlineDashDotDotted).add(le.Double,uP.FontUnderlineDouble).add(le.HeavyWave,uP.FontUnderlineHeavyWave).add(le.LongDashed,uP.FontUnderlineLongDashed).add(le.ThickSingle,uP.FontUnderlineThickSingle).add(le.ThickDotted,uP.FontUnderlineThickDotted).add(le.ThickDashed,uP.FontUnderlineThickDashed).add(le.ThickDashDotted,uP.FontUnderlineThickDashDotted).add(le.ThickDashDotDotted,uP.FontUnderlineThickDashDotDotted).add(le.ThickLongDashed,uP.FontUnderlineThickLongDashed).add(le.DoubleWave,uP.FontUnderlineDoubleWave).add(le.Wave,uP.FontUnderlineWave).get();const YP=[Zi.Decimal,Zi.UpperRoman,Zi.LowerRoman,Zi.UpperLetter,Zi.LowerLetter,Zi.Ordinal,Zi.CardinalText,Zi.OrdinalText,Zi.None,Zi.None,Zi.None,Zi.None,Zi.AIUEOHiragana,Zi.Iroha,Zi.None,Zi.None,Zi.None,Zi.None,Zi.DecimalEnclosedCircle,Zi.None,Zi.AIUEOFullWidthHiragana,Zi.IrohaFullWidth,Zi.DecimalZero,Zi.Bullet,Zi.Ganada,Zi.Chosung,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.KoreanCounting,Zi.KoreanDigital,Zi.KoreanDigital2,Zi.KoreanLegal,Zi.Hebrew1,Zi.ArabicAlpha,Zi.Hebrew2,Zi.ArabicAbjad,Zi.HindiVowels,Zi.HindiConsonants,Zi.HindiNumbers,Zi.HindiDescriptive,Zi.ThaiLetters,Zi.ThaiNumbers,Zi.ThaiDescriptive,Zi.VietnameseDescriptive,Zi.NumberInDash,Zi.RussianLower,Zi.RussianUpper,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None,Zi.None];class QP{}QP.noNumberingList=cn.NoNumberingListIndex,QP.listIndexNotSetted=cn.NumberingListNotSettedIndex,QP.minValue=0,QP.maxValue=Bo.Constants.MAX_SAFE_INTEGER;class ZP extends $P{constructor(){super(...arguments),this.defaultParagraphFirstLineIndent=0,this.defaultParagraphLeftIndent=0,this.defaultParagraphRightIndent=0,this.defaultSuppressHyphenation=!1,this.defaultPageBreakBefore=!1,this.defaultBeforeAutoSpacing=!1,this.defaultAfterAutoSpacing=!1,this.defaultKeepWithNext=!1,this.defaultKeepLinesTogether=!1,this.defaultWidowOrphanControl=!0,this.doubleIntervalRtfLineSpacingValue=480,this.sesquialteralIntervalRtfLineSpacingValue=360,this.singleIntervalRtfLineSpacingValue=240,this.atLeastLineSpacingMultiple=0,this.exactlyLineSpacingMultiple=0,this.multipleLineSpacing=1,this.defaultParagraphSpacingBefore=0,this.defaultParagraphSpacingAfter=0}exportParagraphProperties(e,t){e.isInList()&&this.exportParagraphNumberingProperties(e),e.paragraphStyle&&e.paragraphStyle.styleName!=es.normalStyleName&&this.writeParagraphStyle(e.paragraphStyle);const r=e.getParagraphMergedProperties();r.topBorder.style!=de.None&&this.writeParagraphBorder(r.topBorder,uP.TopParagraphBorder),r.leftBorder.style!=de.None&&this.writeParagraphBorder(r.leftBorder,uP.LeftParagraphBorder),r.bottomBorder.style!=de.None&&this.writeParagraphBorder(r.bottomBorder,uP.BottomParagraphBorder),r.rightBorder.style!=de.None&&this.writeParagraphBorder(r.rightBorder,uP.RightParagraphBorder),r.betweenBorder.style!=de.None&&this.writeParagraphBorder(r.betweenBorder,uP.BetweenParagraphBorder),this.writeParagraphAlignment(this.getActualAlignment(r)),this.writeParagraphTableProperties(e,t),this.writeParagraphGroupPropertiesId(e),this.writeParagraphIndents(e.getParagraphMergedProperties()),this.writeParagraphSuppressHyphenation(r.suppressHyphenation),this.writeParagraphSuppressLineNumbers(r.suppressLineNumbers),this.writeParagraphContextualSpacing(r.contextualSpacing),this.writeParagraphPageBreakBefore(r.pageBreakBefore),this.writeParagraphBeforeAutoSpacing(r.beforeAutoSpacing),this.writeParagraphAfterAutoSpacing(r.afterAutoSpacing),this.writeParagraphKeepWithNext(r.keepWithNext),this.writeParagraphKeepLinesTogether(r.keepLinesTogether),this.writeParagraphWidowOrphanControl(r.widowOrphanControl),this.writeParagraphOutlineLevel(r.outlineLevel),this.writeParagraphShading(r.shadingInfo),this.writeParagraphLineSpacing(r.lineSpacingType,r.lineSpacing),this.writeParagraphSpacingBefore(r.spacingBefore),this.writeParagraphSpacingAfter(r.spacingAfter),this.writeTabs(e.tabs)}exportParagraphPropertiesCore(e,t=!1){e.topBorder.style!=de.None&&this.writeParagraphBorder(e.topBorder,uP.TopParagraphBorder),e.leftBorder.style!=de.None&&this.writeParagraphBorder(e.leftBorder,uP.LeftParagraphBorder),e.bottomBorder.style!=de.None&&this.writeParagraphBorder(e.bottomBorder,uP.BottomParagraphBorder),e.rightBorder.style!=de.None&&this.writeParagraphBorder(e.rightBorder,uP.RightParagraphBorder),e.betweenBorder.style!=de.None&&this.writeParagraphBorder(e.betweenBorder,uP.BetweenParagraphBorder),t&&this.isDefaultAlignment(e)||this.writeParagraphAlignment(this.getActualAlignment(e)),this.writeParagraphIndents(e),this.writeParagraphSuppressHyphenation(e.suppressHyphenation),this.writeParagraphSuppressLineNumbers(e.suppressLineNumbers),this.writeParagraphContextualSpacing(e.contextualSpacing),this.writeParagraphPageBreakBefore(e.pageBreakBefore),this.writeParagraphBeforeAutoSpacing(e.beforeAutoSpacing),this.writeParagraphAfterAutoSpacing(e.afterAutoSpacing),this.writeParagraphKeepWithNext(e.keepWithNext),this.writeParagraphKeepLinesTogether(e.keepLinesTogether),this.writeParagraphWidowOrphanControl(e.widowOrphanControl),this.writeParagraphOutlineLevel(e.outlineLevel),this.writeParagraphShading(e.shadingInfo),this.writeParagraphLineSpacing(e.lineSpacingType,e.lineSpacing),this.writeParagraphSpacingBefore(e.spacingBefore),this.writeParagraphSpacingAfter(e.spacingAfter)}isDefaultAlignment(e){return e.rightToLeft?e.alignment==Ae.Right:e.alignment==Ae.Left}getActualAlignment(e){if(e.rightToLeft){if(e.alignment==Ae.Left)return Ae.Right;if(e.alignment==Ae.Right)return Ae.Left}return e.alignment}exportParagraphNumberingProperties(e){this.shouldExportParagraphNumbering(e.numberingListIndex,e.listLevelIndex)&&(this.rtfBuilder.writeIntegerCommand(uP.LevelIndex,e.getListLevelIndex()),this.rtfBuilder.writeIntegerCommand(uP.ListIndex,this.documentModel.numberingLists[e.getNumberingListIndex()].getId()))}shouldExportParagraphNumbering(e,t=1){return e==cn.NoNumberingListIndex||e>=QP.minValue||t>0}writeParagraphStyle(e){const t=e.styleName,r=this.rtfExportHelper.paragraphStylesCollectionIndex;B.StringMapUtils.containsBy(r,((e,r)=>r==t))&&this.rtfBuilder.writeIntegerCommand(uP.ParagraphStyle,r[t])}writeParagraphBorder(e,t){this.documentModel.defaultTableProperties.borders.top.equals(e)||(this.rtfBuilder.writeCommand(t),this.writeBorderProperties(e))}writeParagraphAlignment(e){switch(e){case Ae.Left:this.rtfBuilder.writeCommand(uP.LeftAlignment);break;case Ae.Center:this.rtfBuilder.writeCommand(uP.CenterAlignment);break;case Ae.Justify:this.rtfBuilder.writeCommand(uP.JustifyAlignment);break;case Ae.Right:this.rtfBuilder.writeCommand(uP.RightAlignment)}}writeParagraphTableProperties(e,t){t>0&&this.rtfBuilder.writeCommand(uP.InTableParagraph),t>1&&this.rtfBuilder.writeIntegerCommand(uP.ParagraphNestingLevel,t)}writeParagraphGroupPropertiesId(e){this.documentModel.webSettings.isBodyMarginsSet()&&this.rtfBuilder.writeIntegerCommand(uP.ParagraphGroupPropertiesId,1)}writeParagraphIndents(e){const t=this.calcRtfFirstLineIndent(e.firstLineIndentType,e.firstLineIndent);t!=this.defaultParagraphFirstLineIndent&&this.rtfBuilder.writeIntegerCommand(uP.FirstLineIndentInTwips,t);const r=this.calcRtfLeftIndent(e.firstLineIndentType,e.firstLineIndent,e.leftIndent);r!=this.defaultParagraphLeftIndent&&(this.rtfBuilder.writeIntegerCommand(uP.LeftIndentInTwips,r),this.rtfBuilder.writeIntegerCommand(uP.LeftIndentInTwips_Lin,r));const i=e.rightIndent;i!=this.defaultParagraphRightIndent&&(this.rtfBuilder.writeIntegerCommand(uP.RightIndentInTwips,i),this.rtfBuilder.writeIntegerCommand(uP.RightIndentInTwips_Rin,i))}calcRtfFirstLineIndent(e,t){switch(e){case ke.Indented:return t;case ke.Hanging:return-t;case ke.None:default:return 0}}calcRtfLeftIndent(e,t,r){return r}writeParagraphSuppressHyphenation(e){e!=this.defaultSuppressHyphenation&&this.rtfBuilder.writeIntegerCommand(uP.AutomaticParagraphHyphenation,e?0:1)}writeParagraphSuppressLineNumbers(e){e&&this.rtfBuilder.writeCommand(uP.SuppressLineNumbering)}writeParagraphContextualSpacing(e){e&&this.rtfBuilder.writeCommand(uP.ContextualSpacing)}writeParagraphPageBreakBefore(e){e!=this.defaultPageBreakBefore&&this.rtfBuilder.writeIntegerCommand(uP.PageBreakBefore,e?1:0)}writeParagraphBeforeAutoSpacing(e){e!=this.defaultBeforeAutoSpacing&&this.rtfBuilder.writeIntegerCommand(uP.BeforeAutoSpacing,e?1:0)}writeParagraphAfterAutoSpacing(e){e!=this.defaultAfterAutoSpacing&&this.rtfBuilder.writeIntegerCommand(uP.AfterAutoSpacing,e?1:0)}writeParagraphKeepWithNext(e){e!=this.defaultKeepWithNext&&this.rtfBuilder.writeIntegerCommand(uP.KeepWithNext,e?1:0)}writeParagraphKeepLinesTogether(e){e!=this.defaultKeepLinesTogether&&this.rtfBuilder.writeIntegerCommand(uP.KeepLinesTogether,e?1:0)}writeParagraphWidowOrphanControl(e){e!=this.defaultWidowOrphanControl&&(e?this.rtfBuilder.writeCommand(uP.WidowOrphanControlOn):this.rtfBuilder.writeCommand(uP.WidowOrphanControlOff))}writeParagraphOutlineLevel(e){e<0||e>=10||e>0&&this.rtfBuilder.writeIntegerCommand(uP.OutlineLevel,e-1)}writeParagraphLineSpacing(e,t){switch(e){case Ne.AtLeast:this.writeRtfLineSpacing(t,this.atLeastLineSpacingMultiple);break;case Ne.Exactly:this.writeRtfLineSpacing(-t,this.exactlyLineSpacingMultiple);break;case Ne.Double:this.writeRtfLineSpacing(this.doubleIntervalRtfLineSpacingValue,this.multipleLineSpacing);break;case Ne.Sesquialteral:this.writeRtfLineSpacing(this.sesquialteralIntervalRtfLineSpacingValue,this.multipleLineSpacing);break;case Ne.Multiple:this.writeRtfLineSpacing(t*this.singleIntervalRtfLineSpacingValue,this.multipleLineSpacing)}}writeRtfLineSpacing(e,t){this.rtfBuilder.writeIntegerCommand(uP.RtfLineSpacingValue,e),this.rtfBuilder.writeIntegerCommand(uP.RtfLineSpacingMultiple,t)}writeParagraphSpacingBefore(e){e!=this.defaultParagraphSpacingBefore&&this.rtfBuilder.writeIntegerCommand(uP.SpaceBefore,e)}writeParagraphSpacingAfter(e){e!=this.defaultParagraphSpacingAfter&&this.rtfBuilder.writeIntegerCommand(uP.SpaceAfter,e)}writeTabs(e){const t=e.tabsInfo.length;for(let r=0;r<t;r++)this.writeTabInfo(e.tabsInfo[r])}writeTabInfo(e){this.writeTabKind(e.alignment),this.writeTabLeader(e.leader),this.writeTabPosition(e.position)}writeTabKind(e){switch(e){case Ha.Center:this.rtfBuilder.writeCommand(uP.CenteredTab);break;case Ha.Decimal:this.rtfBuilder.writeCommand(uP.DecimalTab);break;case Ha.Right:this.rtfBuilder.writeCommand(uP.FlushRightTab);break;case Ha.Numbering:this.rtfBuilder.writeCommand(uP.NumberingTab);case Ha.Left:}}writeTabLeader(e){switch(e){case Sg.Dots:this.rtfBuilder.writeCommand(uP.TabLeaderDots);break;case Sg.EqualSign:this.rtfBuilder.writeCommand(uP.TabLeaderEqualSign);break;case Sg.Hyphens:this.rtfBuilder.writeCommand(uP.TabLeaderHyphens);break;case Sg.MiddleDots:this.rtfBuilder.writeCommand(uP.TabLeaderMiddleDots);break;case Sg.ThickLine:this.rtfBuilder.writeCommand(uP.TabLeaderThickLine);break;case Sg.Underline:this.rtfBuilder.writeCommand(uP.TabLeaderUnderline);case Sg.None:}}writeTabPosition(e){this.rtfBuilder.writeIntegerCommand(uP.TabPosition,e)}writeParagraphShading(e){qP.exportShadingPattern(this.rtfBuilder,this.documentModel.colorProvider,e,uP.ParagraphShading);const t=uP.RunShadingPatternTable[e.shadingPattern];uP.ShadingPatternTable[t]&&this.rtfBuilder.writeCommand(t),qP.exportShadingForeColorIndex(this.rtfBuilder,this.rtfExportHelper,this.documentModel.colorProvider,e,uP.ParagraphFillColor),qP.exportShadingBackColorIndex(this.rtfBuilder,this.rtfExportHelper,this.documentModel.colorProvider,e,uP.ParagraphBackgroundColor)}}class ew{constructor(e){this.text="",this.number="",this.rtfExporter=e,this.rtfBuilder=e.createRtfBuilder(),this.characterPropertiesExporter=new JP(e.documentModel,e.rtfExportHelper,this.rtfBuilder,e.options),this.paragraphPropertiesExporter=new ZP(e.documentModel,e.rtfExportHelper,this.rtfBuilder)}export(e,t,r){if(e.length<=0)return;const i=this.getAbstractNumberingLists(e,t,r);i.length>0&&this.exportAbstractNumberingLists(i),this.exportListOverrideTable(e,t,r)}getAbstractNumberingLists(e,t,r){const i=[],n=t+(r-1);for(let r=t;r<=n;r++){const t=e[r].getAbstractNumberingList();f.ListUtils.unsafeAnyOf(i,(e=>e.innerId==t.innerId))||i.push(t)}return i}exportAbstractNumberingLists(e){for(let t=0;t<e.length;t++)this.rtfBuilder.clear(),this.exportAbstractNumberingList(e[t])}exportAbstractNumberingList(e){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.NumberingList),this.rtfBuilder.writeIntegerCommand(uP.NumberingListTemplateId,-1),e.isHybridList()&&this.rtfBuilder.writeCommand(uP.NumberingListHybrid),this.exportListLevels(e.levels),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.NumberingListName),this.rtfBuilder.closeGroup(),this.rtfBuilder.writeIntegerCommand(uP.NumberingListId,e.getId()),this.rtfBuilder.closeGroup();const t=new Eu(this.rtfExporter.rtfExportHelper.numberingListCollection);this.rtfExporter.rtfExportHelper.numberingListCollection[e.getId()]||t.add(e.getId(),this.rtfBuilder.rtfContent.getText())}exportListLevels(e){const t=e.length;for(let r=0;r<t;r++)this.exportListLevel(e[r])}exportListOverrideTable(e,t,r){if(e.length<=0)return;const i=t+(r-1);for(let r=t;r<=i;r++)this.rtfBuilder.clear(),this.exportListOverride(e[r])}exportListOverride(e){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ListOverride),this.rtfBuilder.writeIntegerCommand(uP.NumberingListId,e.getAbstractNumberingList().getId());const t=this.getListOverrideCount(e);this.rtfBuilder.writeIntegerCommand(uP.ListOverrideCount,t),this.rtfBuilder.writeIntegerCommand(uP.ListIndex,e.getId()),this.exportListOverrideLevels(e),this.rtfBuilder.closeGroup();const r=this.rtfExporter.rtfExportHelper.listOverrideCollection.length;this.rtfExporter.rtfExportHelper.listOverrideCollection.push(this.rtfBuilder.rtfContent.getText());const i=new Eu(this.rtfExporter.rtfExportHelper.listOverrideCollectionIndex);this.rtfExporter.rtfExportHelper.listOverrideCollectionIndex[e.getId()]||i.add(e.getId(),r)}getListOverrideCount(e){const t=e.levels,r=t.length;let i=0;for(let e=0;e<r;e++)this.isOverrideLevel(t[e])&&i++;return i}isOverrideLevel(e){return e instanceof Qi||e.overrideStart}exportListOverrideLevels(e){const t=e.levels,r=t.length;for(let e=0;e<r;e++)this.isOverrideLevel(t[e])&&this.exportListOverrideLevel(t[e])}exportListOverrideLevel(e){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ListOverrideLevel),e.overrideStart&&this.rtfBuilder.writeCommand(uP.ListOverrideStart);null!=e?(this.rtfBuilder.writeCommand(uP.ListOverrideFormat),this.exportListLevel(e)):this.rtfBuilder.writeIntegerCommand(uP.ListLevelStart,e.getNewStart()),this.rtfBuilder.closeGroup()}exportListLevel(e){const t=e.getListLevelProperties(),r=this.getNumberingListFormat(t.format);this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ListLevel),this.rtfBuilder.writeIntegerCommand(uP.ListLevelNumberingFormat,r),this.rtfBuilder.writeIntegerCommand(uP.ListLevelNumberingFormatN,r),this.rtfBuilder.writeIntegerCommand(uP.ListLevelAlignment,t.alignment),this.rtfBuilder.writeIntegerCommand(uP.ListLevelAlignmentN,t.alignment),this.rtfBuilder.writeIntegerCommand(uP.ListLevelFollow,ew.getListLevelSeparator(t.separator)),this.rtfBuilder.writeIntegerCommand(uP.ListLevelStart,t.start),t.legacy&&(this.rtfBuilder.writeCommand(uP.ListLevelLegacy),this.rtfBuilder.writeIntegerCommand(uP.ListLevelLegacySpace,t.legacySpace),this.rtfBuilder.writeIntegerCommand(uP.ListLevelLegacyIndent,t.legacyIndent)),this.exportListLevelTextAndNumber(t.displayFormatString,t.templateCode),t.convertPreviousLevelNumberingToDecimal?this.rtfBuilder.writeIntegerCommand(uP.ListLevelLegal,1):this.rtfBuilder.writeIntegerCommand(uP.ListLevelLegal,0),t.suppressRestart?this.rtfBuilder.writeIntegerCommand(uP.ListLevelNoRestart,1):this.rtfBuilder.writeIntegerCommand(uP.ListLevelNoRestart,0),this.exportListLevelCharacterAndParagraphProperties(e),this.rtfBuilder.closeGroup()}getNumberingListFormat(e){const t=YP.indexOf(e);return t>=0?t:0}static getListLevelSeparator(e){switch(e){case xP.TabMark:return 0;case" ":return 1;default:return 2}}exportListLevelTextAndNumber(e,t){this.text="",this.number="",this.getTextAndNumber(e),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ListLevelText),0!=t&&this.rtfBuilder.writeIntegerCommand(uP.LevelTemplateId,t),this.rtfBuilder.writeTextDirect(this.rtfExporter.documentModel.simpleFormattersManager.formatString("\\'{0:x2}",this.textLength)),this.rtfBuilder.writeTextDirect(this.text,!0),this.rtfBuilder.writeChar(";"),this.rtfBuilder.closeGroup(),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ListLevelNumbers,this.number+";"),this.rtfBuilder.closeGroup()}getTextAndNumber(e){this.textLength=0;const t=e.length;let r=0;for(;r<t;){const t=e[r];r=RP.isSpecialSymbol(t)?this.addLevelNumber(e,r):this.addChar(t,r)}}addLevelNumber(e,t){return this.doubleBrackets(e,t)?(t=this.addEscapedChar(e[t],t))+1:"\\"==e[t]?this.addEscapedChar(e[t],t):this.addLevelNumberCore(e,t)}addLevelNumberCore(e,t){let r="";return t++,r=e.substr(t,e.indexOf("}",t)-t),this.text+=this.rtfExporter.documentModel.simpleFormattersManager.formatString("\\'{0:x2}",parseInt(r)),this.textLength+=r.length,this.number+=this.rtfExporter.documentModel.simpleFormattersManager.formatString("\\'{0:x2}",this.textLength),t+r.length+1}doubleBrackets(e,t){return"}"==e[t]&&"}"==e[t+1]||"{"==e[t]&&"{"==e[t+1]}addChar(e,t){return this.text+=e,this.textLength++,t+1}addEscapedChar(e,t){const r="\\'"+RP.byteToHexString[e.charCodeAt(0)];return this.text+=r,this.textLength++,t+1}exportListLevelCharacterAndParagraphProperties(e){const t=e.getCharacterProperties(),r=e.getCharacterMergedProperties();this.characterPropertiesExporter.exportCharacterProperties(r,!0,!t.getUseValue(ie.UseDoubleFontSize),!t.getUseValue(ie.UseFontName));const i=e.getParagraphMergedProperties();this.paragraphPropertiesExporter.writeParagraphIndents(i)}}class tw extends $P{exportSectionProperties(e){this.exportSectionMargins(e.sectionProperties.margins),this.exportSectionOffsets(e.sectionProperties),this.exportSectionPage(e.sectionProperties),this.exportSectionGeneralSettings(e.sectionProperties),this.exportSectionColumns(e.sectionProperties),this.exportSectionPageNumbering(e.sectionProperties),this.exportSectionLineNumbering(e.sectionProperties.lineNumbering)}exportSectionPageNumbering(e){e.continueNumbering||(this.rtfBuilder.writeIntegerCommand(uP.SectionPageNumberingStart,e.firstPageNumber),this.rtfBuilder.writeCommand(uP.SectionPageNumberingRestart))}exportSectionMargins(e){this.rtfBuilder.writeIntegerCommand(uP.SectionMarginsLeft,e.left),this.rtfBuilder.writeIntegerCommand(uP.SectionMarginsRight,e.right),this.rtfBuilder.writeIntegerCommand(uP.SectionMarginsTop,e.top),this.rtfBuilder.writeIntegerCommand(uP.SectionMarginsBottom,e.bottom)}exportSectionOffsets(e){this.rtfBuilder.writeIntegerCommand(uP.SectionMarginsHeaderOffset,e.headerOffset),this.rtfBuilder.writeIntegerCommand(uP.SectionMarginsFooterOffset,e.footerOffset)}exportSectionPage(e){this.rtfBuilder.writeIntegerCommand(uP.SectionPageWidth,e.pageWidth),this.rtfBuilder.writeIntegerCommand(uP.SectionPageHeight,e.pageHeight),e.landscape&&this.rtfBuilder.writeCommand(uP.SectionPageLandscape)}exportSectionGeneralSettings(e){const t=new yh;e.startType!=t.startType&&this.writeEnumValueCommand(mw.sectionStartTypes,e.startType,uP.SectionBreakTypeNextPage),e.differentFirstPage!=t.differentFirstPage&&this.rtfBuilder.writeCommand(uP.SectionTitlePage)}exportSectionColumns(e){e.equalWidthColumns?(this.rtfBuilder.writeIntegerCommand(uP.SectionColumnsCount,e.columnCount),this.rtfBuilder.writeIntegerCommand(uP.SectionSpaceBetweenColumns,e.space)):this.exportSectionColumnsDetails(e.columnsInfo)}exportSectionColumnsDetails(e){const t=e.length;t>0&&this.rtfBuilder.writeIntegerCommand(uP.SectionColumnsCount,t);for(let r=0;r<t;r++)this.exportSectionColumn(e[r],r)}exportSectionColumn(e,t){this.rtfBuilder.writeIntegerCommand(uP.SectionColumnNumber,t+1),this.rtfBuilder.writeIntegerCommand(uP.SectionColumnWidth,e.width),this.rtfBuilder.writeIntegerCommand(uP.SectionColumnSpace,e.space)}writeEnumValueCommand(e,t,r){let i=e[t];i||(i=r),this.rtfBuilder.writeCommand(i)}exportSectionLineNumbering(e){e&&e.isDefined&&(this.rtfBuilder.writeIntegerCommand(uP.SectionLineNumberingCountBy,e.countBy),e.distance!==Ph.distance&&this.rtfBuilder.writeIntegerCommand(uP.SectionLineNumberingDistance,e.distance),e.start!==Ph.start&&this.rtfBuilder.writeIntegerCommand(uP.SectionLineNumberingStart,e.start),e.restart!==Ph.restart&&this.exportLineNumberRestartType(e.restart))}exportLineNumberRestartType(e){switch(e){case zs.NewPage:this.rtfBuilder.writeCommand(uP.SectionLineNumberingRestartNewPage);break;case zs.NewSection:this.rtfBuilder.writeCommand(uP.SectionLineNumberingRestartNewSection);break;case zs.Continuous:this.rtfBuilder.writeCommand(uP.SectionLineNumberingContinuous)}}}class rw{constructor(e){this.model=e}}class iw extends rw{constructor(e){super(e)}get defaultProperties(){return this.model.defaultTableCellProperties}getMergedProperties(e){return this.merge(e.properties,e.parentRow.parentTable.style,e,null,e.conditionalFormatting)}getStyleMergedProperties(e,t,r){return this.merge(e.tableCellProperties,t,null,null,r)}merge(e,t,r,i,n){const o=e.clone();if(r){const i=r.parentRow,a=i.parentTable,s=i.tablePropertiesException;o.cellMargins.left=new Hr(a,this.model,s).getProperty(e,t,n,this.defaultProperties),o.cellMargins.right=new Vr(a,this.model,s).getProperty(e,t,n,this.defaultProperties),o.cellMargins.top=new Wr(a,this.model,s).getProperty(e,t,n,this.defaultProperties),o.cellMargins.bottom=new zr(a,this.model,s).getProperty(e,t,n,this.defaultProperties),o.borders.left=new Xr(s,i.cells[0]==r).getProperty(e,t,n,this.defaultProperties),o.borders.right=new Gr(s,f.ListUtils.last(i.cells)==r).getProperty(e,t,n,this.defaultProperties),o.borders.top=new Kr(s,a.rows[0]==i).getProperty(e,t,n,this.defaultProperties),o.borders.bottom=new Kr(s,f.ListUtils.last(a.rows)==i).getProperty(e,t,n,this.defaultProperties),o.borders.topLeftDiagonal=new $r(s).getProperty(e,t,n,this.defaultProperties),o.borders.topRightDiagonal=new Jr(s).getProperty(e,t,n,this.defaultProperties)}return o.shadingInfo=(new Qr).getProperty(e,t,n,this.defaultProperties),o.noWrap=(new Yr).getProperty(e,t,n,this.defaultProperties),o.verticalAlignment=(new Zr).getProperty(e,t,n,this.defaultProperties),o}}class nw extends rw{constructor(e){super(e)}get defaultProperties(){return this.model.defaultTableProperties}getMergedProperties(e){return this.merge(e.properties,e.style,e,null,qe.WholeTable)}getStyleMergedProperties(e,t,r){return this.merge(e.tableProperties,t,null,null,r)}merge(e,t,r,i,n){const o=e.clone();return o.indent=(new Ir).getProperty(e,t,n,this.defaultProperties),o.cellSpacing=(new Pr).getProperty(e,t,n,this.defaultProperties),o.borders.left=(new yr).getProperty(e,t,n,this.defaultProperties),o.borders.right=(new xr).getProperty(e,t,n,this.defaultProperties),o.borders.top=(new Tr).getProperty(e,t,n,this.defaultProperties),o.borders.bottom=(new vr).getProperty(e,t,n,this.defaultProperties),o.borders.insideVertical=(new Mr).getProperty(e,t,n,this.defaultProperties),o.borders.insideHorizontal=(new Er).getProperty(e,t,n,this.defaultProperties),o.cellMargins.left=(new Dr).getProperty(e,t,n,this.defaultProperties),o.cellMargins.right=(new Fr).getProperty(e,t,n,this.defaultProperties),o.cellMargins.top=(new Rr).getProperty(e,t,n,this.defaultProperties),o.cellMargins.bottom=(new Lr).getProperty(e,t,n,this.defaultProperties),o.layoutType=(new Br).getProperty(e,t,n,this.defaultProperties),o.shadingInfo=(new Ar).getProperty(e,t,n,this.defaultProperties),o.tableStyleColumnBandSize=(new Nr).getProperty(e,t,n,this.defaultProperties),o.tableStyleRowBandSize=(new kr).getProperty(e,t,n,this.defaultProperties),o.tableRowAlignment=(new Or).getProperty(e,t,n,this.defaultProperties),o}}class ow extends rw{constructor(e){super(e)}get defaultProperties(){return this.model.defaultTableRowProperties}getMergedProperties(e){return this.merge(e.properties,e.parentTable.style,e,e.tablePropertiesException,qe.WholeTable)}getStyleMergedProperties(e,t,r){return this.merge(e.tableRowProperties,t,null,new mr,r)}merge(e,t,r,i,n){const o=e.clone();return r&&(o.cellSpacing=new Xa(this.model,r.parentTable,i).getProperty(e,t,n,this.defaultProperties)),o.cantSplit=(new Ga).getProperty(e,t,n,this.defaultProperties),o.tableRowAlignment=new Ka(i).getProperty(e,t,n,this.defaultProperties),o.divId=(new qa).getProperty(e,t,n,this.defaultProperties),o}}class aw extends $P{get tableCellBackgroundColor(){return uP.TableCellBackgroundColor}get tableCellForegroundColor(){return uP.TableCellForegroundColor}get tableCellShading(){return uP.TableCellShading}get tableCellShadingPatternTable(){return uP.TableCellShadingPatternTable}get tableCellNoWrap(){return uP.TableCellNoWrap}get tableCellTextTopAlignment(){return uP.TableCellTextTopAlignment}get tableCellTextCenterAlignment(){return uP.TableCellTextCenterAlignment}get tableCellTextBottomAlignment(){return uP.TableCellTextBottomAlignment}get cellTopBorder(){return uP.TableCellTopBorder}get cellLeftBorder(){return uP.TableCellLeftBorder}get cellBottomBorder(){return uP.TableCellBottomBorder}get cellRightBorder(){return uP.TableCellRightBorder}writeCellShading(e){const t=uP.RunShadingPatternTable[e.shadingPattern];t&&this.rtfBuilder.writeCommand(t),qP.exportShadingForeColorIndex(this.rtfBuilder,this.rtfExportHelper,this.documentModel.colorProvider,e,this.tableCellForegroundColor),qP.exportShadingBackColorIndex(this.rtfBuilder,this.rtfExportHelper,this.documentModel.colorProvider,e,this.tableCellBackgroundColor),qP.exportShadingPattern(this.rtfBuilder,this.documentModel.colorProvider,e,this.tableCellShading)}writeCellFitText(e){e!=this.documentModel.defaultTableCellProperties.fitText&&this.writeBoolCommand(uP.TableCellFitText,e)}writeCellNoWrap(e){e!=this.documentModel.defaultTableCellProperties.noWrap&&this.writeBoolCommand(this.tableCellNoWrap,e)}writeCellHideCellMark(e){e!=this.documentModel.defaultTableCellProperties.hideCellMark&&this.writeBoolCommand(uP.TableCellHideMark,e)}writeCellVerticalMerging(e,t){e!=t&&(e==Xe.Restart?this.rtfBuilder.writeCommand(uP.TableCellStartVerticalMerging):e==Xe.Continue&&this.rtfBuilder.writeCommand(uP.TableCellContinueVerticalMerging))}writeCellVerticalAlignment(e){switch(e){case Ke.Top:this.rtfBuilder.writeCommand(this.tableCellTextTopAlignment);break;case Ke.Center:this.rtfBuilder.writeCommand(this.tableCellTextCenterAlignment);break;case Ke.Bottom:this.rtfBuilder.writeCommand(this.tableCellTextBottomAlignment);break;default:throw new Error(R.D.InternalException)}}writeCellTextDirection(e){switch(e){case Ge.LeftToRightTopToBottom:this.rtfBuilder.writeCommand(uP.TableCellLeftToRightTopToBottomTextDirection);break;case Ge.TopToBottomRightToLeft:this.rtfBuilder.writeCommand(uP.TableCellTopToBottomRightToLeftTextDirection);break;case Ge.BottomToTopLeftToRight:this.rtfBuilder.writeCommand(uP.TableCellBottomToTopLeftToRightTextDirection);break;case Ge.LeftToRightTopToBottomRotated:this.rtfBuilder.writeCommand(uP.TableCellLeftToRightTopToBottomVerticalTextDirection);break;case Ge.TopToBottomRightToLeftRotated:this.rtfBuilder.writeCommand(uP.TableCellTopToBottomRightToLeftVerticalTextDirection)}}writeCellBasicBorders(e,t,r,i){this.rtfBuilder.writeCommand(this.cellTopBorder),this.writeBorderProperties(e),this.rtfBuilder.writeCommand(this.cellLeftBorder),this.writeBorderProperties(t),this.rtfBuilder.writeCommand(this.cellBottomBorder),this.writeBorderProperties(i),this.rtfBuilder.writeCommand(this.cellRightBorder),this.writeBorderProperties(r)}writeCellPreferredWidth(e){this.writeWidthUnit(e,uP.TableCellPreferredWidthType,uP.TableCellPreferredWidth)}writeCellMargings(e){const t=e.top,r=e.left,i=e.right,n=e.bottom;this.shouldExportCellMargin(n)&&this.writeWidthUnitInTwips(n,uP.TableCellBottomMarginType,uP.TableCellBottomMargin),this.shouldExportCellMargin(t)&&this.writeWidthUnitInTwips(t,uP.TableCellLeftMarginType,uP.TableCellLeftMargin),this.shouldExportCellMargin(i)&&this.writeWidthUnitInTwips(i,uP.TableCellRightMarginType,uP.TableCellRightMargin),this.shouldExportCellMargin(r)&&this.writeWidthUnitInTwips(r,uP.TableCellTopMarginType,uP.TableCellTopMargin)}writeCellRight(e){this.rtfBuilder.writeIntegerCommand(uP.TableCellRight,e)}}class sw extends aw{get tableCellBackgroundColor(){return uP.TableStyleCellBackgroundColor}get tableCellForegroundColor(){return uP.TableStyleCellForegroundColor}get tableCellShading(){return uP.TableStyleCellShading}get tableCellShadingPatternTable(){return uP.TableStyleShadingPatternTable}get tableCellNoWrap(){return uP.TableStyleCellNoWrap}get tableCellTextTopAlignment(){return uP.TableStyleCellVerticalAlignmentTop}get tableCellTextCenterAlignment(){return uP.TableStyleCellVerticalAlignmentCenter}get tableCellTextBottomAlignment(){return uP.TableStyleCellVerticalAlignmentBottom}get tableCellUpperLeftToLowerRightBorder(){return uP.TableStyleUpperLeftToLowerRightBorder}get tableCellUpperRightToLowerLeftBorder(){return uP.TableStyleUpperRightToLowerLeftBorder}get cellTopBorder(){return uP.TableStyleTopCellBorder}get cellLeftBorder(){return uP.TableStyleLeftCellBorder}get cellBottomBorder(){return uP.TableStyleBottomCellBorder}get cellRightBorder(){return uP.TableStyleRightCellBorder}writeCellBasicBorders(e,t,r,i){const n=this.documentModel.defaultTableCellProperties.borders.top;n.equals(e)||(this.rtfBuilder.writeCommand(this.cellTopBorder),this.writeBorderProperties(e)),n.equals(t)||(this.rtfBuilder.writeCommand(this.cellLeftBorder),this.writeBorderProperties(t)),n.equals(i)||(this.rtfBuilder.writeCommand(this.cellBottomBorder),this.writeBorderProperties(i)),n.equals(r)||(this.rtfBuilder.writeCommand(this.cellRightBorder),this.writeBorderProperties(r))}}class lw extends $P{writeRTLRow(){this.rtfBuilder.writeCommand(uP.RTLRow)}writeRowLeft(e){this.rtfBuilder.writeIntegerCommand(uP.TableRowLeft,e)}writeTableBorders(e){const t=this.documentModel.defaultTableCellProperties.borders.bottom,r=e.top,i=e.left,n=e.bottom,o=e.right,a=e.insideHorizontal,s=e.insideVertical;t.equals(r)||(this.rtfBuilder.writeCommand(uP.TableTopBorder),this.writeBorderProperties(r)),t.equals(i)||(this.rtfBuilder.writeCommand(uP.TableLeftBorder),this.writeBorderProperties(i)),t.equals(n)||(this.rtfBuilder.writeCommand(uP.TableBottomBorder),this.writeBorderProperties(n)),t.equals(o)||(this.rtfBuilder.writeCommand(uP.TableRightBorder),this.writeBorderProperties(o)),t.equals(a)||(this.rtfBuilder.writeCommand(uP.TableHorizontalBorder),this.writeBorderProperties(a)),t.equals(s)||(this.rtfBuilder.writeCommand(uP.TableVerticalBorder),this.writeBorderProperties(s))}writeTableWidth(e){this.writeWidthUnit(e,uP.TablePreferredWidthType,uP.TablePreferredWidth)}writeTableLayout(e){e!=Oe.Fixed&&this.rtfBuilder.writeIntegerCommand(uP.TableLayout,e)}writeTableCellMargins(e){const t=e.left,r=e.right,i=e.bottom,n=e.top;this.shouldExportCellMargin(t)&&this.writeWidthUnitInTwips(t,uP.TableCellMarginsLeftType,uP.TableCellMarginsLeft),this.shouldExportCellMargin(i)&&this.writeWidthUnitInTwips(i,uP.TableCellMarginsBottomType,uP.TableCellMarginsBottom),this.shouldExportCellMargin(r)&&this.writeWidthUnitInTwips(r,uP.TableCellMarginsRightType,uP.TableCellMarginsRight),this.shouldExportCellMargin(n)&&this.writeWidthUnitInTwips(n,uP.TableCellMarginsTopType,uP.TableCellMarginsTop)}writeTableLook(e){this.documentModel.defaultTableProperties,e&_e.ApplyFirstColumn&&this.rtfBuilder.writeCommand(uP.TableApplyFirstColumn),e&_e.ApplyFirstRow&&this.rtfBuilder.writeCommand(uP.TableApplyFirstRow),e&_e.ApplyLastColumn&&this.rtfBuilder.writeCommand(uP.TableApplyLastColumn),e&_e.ApplyLastRow&&this.rtfBuilder.writeCommand(uP.TableApplyLastRow),e&_e.DoNotApplyColumnBanding&&this.rtfBuilder.writeCommand(uP.TableDoNotApplyColumnBanding),e&_e.DoNotApplyRowBanding&&this.rtfBuilder.writeCommand(uP.TableDoNotApplyRowBanding)}writeTableIndent(e){this.writeWidthUnit(e,uP.TableIndentType,uP.TableIndent,!0)}writeBandSizes(e){const t=e.getUseValue(ur.UseTableStyleRowBandSize),r=e.getUseValue(ur.UseTableStyleColBandSize);0!=e.tableStyleRowBandSize&&(t||e.tableStyleRowBandSize>1)&&this.rtfBuilder.writeIntegerCommand(uP.TableStyleRowBandSize,e.tableStyleRowBandSize),0!=e.tableStyleColumnBandSize&&(r||e.tableStyleColumnBandSize>1)&&this.rtfBuilder.writeIntegerCommand(uP.TableStyleColumnBandSize,e.tableStyleColumnBandSize)}}class dw extends $P{writeLastRowMark(){this.rtfBuilder.writeCommand(uP.TableLastRow)}writeHalfSpaceBetweenCells(e){e>0&&this.rtfBuilder.writeIntegerCommand(uP.TableHalfSpaceBetweenCells,e)}writeRowAlignment(e){if(e!=this.documentModel.defaultTableRowProperties.tableRowAlignment)switch(e){case je.Center:this.rtfBuilder.writeCommand(uP.TableRowCenterAlignment);break;case je.Left:this.rtfBuilder.writeCommand(uP.TableRowLeftAlignment);break;case je.Right:this.rtfBuilder.writeCommand(uP.TableRowRightAlignment)}}writeRowHeader(e){e!=this.documentModel.defaultTableRowProperties.header&&this.writeBoolCommand(uP.TableRowHeader,e)}writeRowCantSplit(e){e!=this.documentModel.defaultTableRowProperties.cantSplit&&this.writeBoolCommand(uP.TableRowCantSplit,e)}writeRowHeight(e){const t=dr.createDefault();if(e.type!=t.type)switch(e.type){case $e.Auto:this.rtfBuilder.writeIntegerCommand(uP.TableRowHeight,0);break;case $e.Minimum:this.rtfBuilder.writeIntegerCommand(uP.TableRowHeight,e.value);break;case $e.Exact:this.rtfBuilder.writeIntegerCommand(uP.TableRowHeight,-e.value)}}writeWidthBefore(e){this.writeWidthUnit(e,uP.TableRowWidthBeforeType,uP.TableRowWidthBefore)}writeWidthAfter(e){this.writeWidthUnit(e,uP.TableRowWidthAfterType,uP.TableRowWidthAfter)}writeRowCellSpacing(e){this.writeWidthUnitInTwips(e,uP.TableCellSpacingLeftType,uP.TableCellSpacingLeft),this.writeWidthUnitInTwips(e,uP.TableCellSpacingBottomType,uP.TableCellSpacingBottom),this.writeWidthUnitInTwips(e,uP.TableCellSpacingRightType,uP.TableCellSpacingRight),this.writeWidthUnitInTwips(e,uP.TableCellSpacingTopType,uP.TableCellSpacingTop)}writeRowShading(e){qP.exportShadingForeColorIndex(this.rtfBuilder,this.rtfExportHelper,this.documentModel.colorProvider,e,uP.TableRowForegroundColor),qP.exportShadingBackColorIndex(this.rtfBuilder,this.rtfExportHelper,this.documentModel.colorProvider,e,uP.TableRowBackgroundColor),qP.exportShadingPattern(this.rtfBuilder,this.documentModel.colorProvider,e,uP.TableRowShading);const t=uP.RunShadingPatternTable[e.shadingPattern];t&&this.rtfBuilder.writeCommand(t)}}class cw{constructor(e,t,r,i){this.documentModel=e,this.rtfExportHelper=r,this.rtfBuilder=t,this.characterPropertiesExporter=new JP(e,r,t,i),this.paragraphPropertiesExporter=new ZP(e,r,t)}exportStyleSheet(e,t,r){e.length>0&&this.exportParagraphStyles(e),t.length>0&&this.exportCharacterStyles(t),r.length>0&&this.exportTableStyles(r)}exportParagraphStyles(e){this.rtfBuilder.clear();const t=e.concat();t.sort(((e,t)=>e.parent&&e.parent.equalsByName(t)?1:t.parent&&t.parent.equalsByName(e)?-1:0));const r=[],i=new Eu(this.rtfExportHelper.paragraphStylesCollectionIndex);let n=t.length;for(let e=0;e<n;e++){let n=t[e];if(!n.deleted&&!B.StringMapUtils.containsBy(this.rtfExportHelper.paragraphStylesCollectionIndex,((e,t)=>t==n.styleName))&&(n.getNumberingListIndex()<QP.minValue||n.getNumberingList(this.documentModel))){r.push(n);const e=this.getNextFreeStyleIndex();i.add(n.styleName,e)}}n=r.length;for(let e=0;e<n;e++)this.exportParagraphStyle(r[e],e);this.rtfExportHelper.stylesCollection.push(this.rtfBuilder.rtfContent.getText())}exportParagraphStyle(e,t){const r=this.obtainParagraphStyleIndex(e);if(r<0)return;if(this.rtfBuilder.openGroup(),t>0){this.rtfBuilder.writeIntegerCommand(uP.ParagraphStyle,r);const t=this.obtainParagraphStyleIndex(e.parent);t>=0&&this.rtfBuilder.writeIntegerCommand(uP.ParentStyle,t)}if(null!=e.linkedStyle){const t=this.obtainCharacterStyleIndex(e.linkedStyle);t>=0&&this.rtfBuilder.writeIntegerCommand(uP.LinkedStyle,t)}if(null!=e.nextParagraphStyle){const t=this.obtainParagraphStyleIndex(e.nextParagraphStyle);t>=0&&this.rtfBuilder.writeIntegerCommand(uP.NextStyle,t)}e.primary&&this.rtfBuilder.writeCommand(uP.QuickFormatStyle);const i=new $i;i.mergeParagraphStyle(e),i.mergeMaskedParagraphProperties(this.documentModel.defaultParagraphProperties),this.exportParagraphProperties(i.getMergedProperties()),this.paragraphPropertiesExporter.writeTabs(e.tabs);const n=new Ii;if(n.mergeParagraphStyle(e),n.mergeCharacterProperties(this.documentModel.defaultCharacterProperties),this.exportCharacterProperties(n.getMergedProperties()),e.getNumberingListIndex()>=QP.minValue){this.rtfBuilder.writeIntegerCommand(uP.ListIndex,this.documentModel.numberingLists[e.getNumberingListIndex()].getId());const t=e.getListLevelIndex();t>0&&this.rtfBuilder.writeIntegerCommand(uP.LevelIndex,t)}this.writeStyleName(e.styleName),this.rtfBuilder.closeGroup()}exportCharacterStyles(e){this.rtfBuilder.clear();const t=e.length;for(let r=0;r<t;r++)this.exportCharacterStyle(e[r]);this.rtfExportHelper.stylesCollection.push(this.rtfBuilder.rtfContent.getText())}exportCharacterStyle(e){if(e.deleted)return;if(B.StringMapUtils.containsBy(this.rtfExportHelper.characterStylesCollectionIndex,((t,r)=>r==e.styleName)))return;const t=this.getNextFreeStyleIndex();new Eu(this.rtfExportHelper.characterStylesCollectionIndex).add(e.styleName,t),this.rtfBuilder.openGroup(),this.rtfBuilder.writeIntegerCommand(uP.CharacterStyle,t);const r=this.obtainCharacterStyleIndex(e.parent);if(r>=0&&this.rtfBuilder.writeIntegerCommand(uP.ParentStyle,r),e.linkedStyle){const t=this.obtainParagraphStyleIndex(e.linkedStyle);t>=0&&this.rtfBuilder.writeIntegerCommand(uP.LinkedStyle,t)}e.primary&&this.rtfBuilder.writeCommand(uP.QuickFormatStyle);const i=new Ii;i.mergeCharacterStyle(e),i.mergeCharacterProperties(this.documentModel.defaultCharacterProperties),this.exportCharacterProperties(i.getMergedProperties()),this.writeStyleName(e.styleName),this.rtfBuilder.closeGroup()}exportTableStyles(e){this.rtfBuilder.clear(),this.tablePropertiesExporter=new lw(this.documentModel,this.rtfExportHelper,this.rtfBuilder),this.tableRowPropertiesExporter=new dw(this.documentModel,this.rtfExportHelper,this.rtfBuilder),this.tableCellPropertiesExporter=new sw(this.documentModel,this.rtfExportHelper,this.rtfBuilder);const t=e.length;for(let r=0;r<t;r++)this.exportTableStyle(e[r]);this.rtfExportHelper.stylesCollection.push(this.rtfBuilder.rtfContent.getText())}exportTableStyle(e){if(e.deleted)return;if(B.StringMapUtils.containsBy(this.rtfExportHelper.tableStylesCollectionIndex,((t,r)=>r==e.styleName)))return;const t=this.getNextFreeStyleIndex();new Eu(this.rtfExportHelper.tableStylesCollectionIndex).add(e.styleName,t),this.rtfBuilder.openGroup(),this.rtfBuilder.writeIntegerCommand(uP.TableStyle,t),this.rtfBuilder.writeCommand(uP.TableStyleResetTableProperties);const r=this.obtainTableStyleIndex(e.parent);r>=0&&this.rtfBuilder.writeIntegerCommand(uP.ParentStyle,r),e.primary&&this.rtfBuilder.writeCommand(uP.QuickFormatStyle),this.exportCharacterProperties(this.getTableConditionalStyleMergedCharacterProperties(e.baseConditionalStyle)),this.exportParagraphProperties(this.getTableConditionalStyleMergedParagraphProperties(e.baseConditionalStyle)),this.exportTableProperties(new nw(this.documentModel).getStyleMergedProperties(e.baseConditionalStyle,e,qe.WholeTable)),this.exportTableRowProperties(new ow(this.documentModel).getStyleMergedProperties(e.baseConditionalStyle,e,qe.WholeTable)),this.exportTableCellProperties(new iw(this.documentModel).getStyleMergedProperties(e.baseConditionalStyle,e,qe.WholeTable)),this.writeStyleName(e.styleName),this.rtfBuilder.closeGroup(),b.j.isEmpty(e.conditionalStyles)||b.j.forEach(e.conditionalStyles,((r,i)=>{this.exportTableConditionalStyle(r,e,t,i)}))}exportTableConditionalStyle(e,t,r,i){null!=e&&(this.rtfBuilder.openGroup(),this.rtfBuilder.writeIntegerCommand(uP.TableStyle,r),this.rtfBuilder.writeCommand(uP.TableStyleResetTableProperties),this.exportCharacterProperties(this.getTableConditionalStyleMergedCharacterProperties(e)),this.exportParagraphProperties(this.getTableConditionalStyleMergedParagraphProperties(e)),this.exportTableRowProperties(new ow(this.documentModel).getStyleMergedProperties(e,t,i)),this.exportTableCellProperties(new iw(this.documentModel).getStyleMergedProperties(e,t,i)),this.writeConditionalStyleType(i),this.writeStyleName(t.styleName),this.rtfBuilder.closeGroup())}writeConditionalStyleType(e){let t=mw.conditionalStylesTypes[e];t&&this.rtfBuilder.writeCommand(t)}getTableConditionalStyleMergedCharacterProperties(e){const t=new Ii;return t.mergeCharacterProperties(e.maskedCharacterProperties),t.getMergedProperties()}getTableConditionalStyleMergedParagraphProperties(e){const t=new $i;return t.mergeMaskedParagraphProperties(e.maskedParagraphProperties),t.getMergedProperties()}exportCharacterProperties(e){this.characterPropertiesExporter.exportCharacterProperties(e,!0,!1,!1)}exportParagraphProperties(e){e.topBorder.style!=de.None&&this.paragraphPropertiesExporter.writeParagraphBorder(e.topBorder,uP.TopParagraphBorder),e.leftBorder.style!=de.None&&this.paragraphPropertiesExporter.writeParagraphBorder(e.leftBorder,uP.LeftParagraphBorder),e.bottomBorder.style!=de.None&&this.paragraphPropertiesExporter.writeParagraphBorder(e.bottomBorder,uP.BottomParagraphBorder),e.rightBorder.style!=de.None&&this.paragraphPropertiesExporter.writeParagraphBorder(e.rightBorder,uP.RightParagraphBorder),e.betweenBorder.style!=de.None&&this.paragraphPropertiesExporter.writeParagraphBorder(e.betweenBorder,uP.BetweenParagraphBorder),this.paragraphPropertiesExporter.writeParagraphAlignment(e.alignment),this.paragraphPropertiesExporter.writeParagraphIndents(e),this.paragraphPropertiesExporter.writeParagraphSuppressHyphenation(e.suppressHyphenation),this.paragraphPropertiesExporter.writeParagraphSuppressLineNumbers(e.suppressLineNumbers),this.paragraphPropertiesExporter.writeParagraphContextualSpacing(e.contextualSpacing),this.paragraphPropertiesExporter.writeParagraphPageBreakBefore(e.pageBreakBefore),this.paragraphPropertiesExporter.writeParagraphOutlineLevel(e.outlineLevel),this.paragraphPropertiesExporter.writeParagraphShading(e.shadingInfo),this.paragraphPropertiesExporter.writeParagraphLineSpacing(e.lineSpacingType,e.lineSpacing),this.paragraphPropertiesExporter.writeParagraphSpacingBefore(e.spacingBefore),this.paragraphPropertiesExporter.writeParagraphSpacingAfter(e.spacingAfter)}exportTableProperties(e){this.tablePropertiesExporter.writeBandSizes(e),this.tablePropertiesExporter.writeTableBorders(e.borders),this.tablePropertiesExporter.writeTableCellMargins(e.cellMargins),this.tablePropertiesExporter.writeTableIndent(e.indent)}exportTableRowProperties(e){this.tableRowPropertiesExporter.writeRowAlignment(e.tableRowAlignment),this.tableRowPropertiesExporter.writeRowHeader(e.header),this.tableRowPropertiesExporter.writeRowCantSplit(e.cantSplit),this.tableRowPropertiesExporter.writeRowCellSpacing(e.cellSpacing)}exportTableCellProperties(e){this.tableCellPropertiesExporter.writeCellVerticalAlignment(e.verticalAlignment),this.tableCellPropertiesExporter.writeCellShading(e.shadingInfo),this.tableCellPropertiesExporter.writeCellBasicBorders(e.borders.top,e.borders.left,e.borders.right,e.borders.bottom),this.tableCellPropertiesExporter.writeCellTextDirection(e.textDirection),this.tableCellPropertiesExporter.writeCellFitText(e.fitText),this.tableCellPropertiesExporter.writeCellNoWrap(e.noWrap),this.tableCellPropertiesExporter.writeCellHideCellMark(e.hideCellMark),this.tableCellPropertiesExporter.writeCellMargings(e.cellMargins)}writeStyleName(e){const t=e.length;for(let r=0;r<t;r++)this.rtfBuilder.writeChar(e[r]);this.rtfBuilder.writeChar(";")}getNextFreeStyleIndex(){let e=0;for(;B.StringMapUtils.containsBy(this.rtfExportHelper.characterStylesCollectionIndex,(t=>t==e))||B.StringMapUtils.containsBy(this.rtfExportHelper.paragraphStylesCollectionIndex,(t=>t==e))||B.StringMapUtils.containsBy(this.rtfExportHelper.tableStylesCollectionIndex,(t=>t==e));)e++;return e}obtainParagraphStyleIndex(e){return cw.obtainStyleIndex(e,this.rtfExportHelper.paragraphStylesCollectionIndex)}obtainCharacterStyleIndex(e){return cw.obtainStyleIndex(e,this.rtfExportHelper.characterStylesCollectionIndex)}obtainTableStyleIndex(e){return cw.obtainStyleIndex(e,this.rtfExportHelper.tableStylesCollectionIndex)}static obtainStyleIndex(e,t){if(!e)return-1;const r=t[e.styleName];return null!=r?r:-1}}class hw{constructor(e,t,r){this.rtfExporter=e,this._nestingLevel=r,this.table=t,this.tableRowPropertiesExporter=new dw(e.documentModel,e.rtfExportHelper,e.rtfBuilder),this.tableCellPropertiesExporter=new aw(e.documentModel,e.rtfExportHelper,e.rtfBuilder),this.tablePropertiesExporter=new lw(e.documentModel,e.rtfExportHelper,e.rtfBuilder),this.tableStyleIndex=this.getTableStyleIndex()}get rtfBuilder(){return this.rtfExporter.rtfBuilder}get documentModel(){return this.subDocument.documentModel}get subDocument(){return this.rtfExporter.subDocument}get nestingLevel(){return this._nestingLevel}exportBase(){this.table.rows.forEach(((e,t)=>{this.exportRow(this.table.rows[t],t)}))}getTableStyleIndex(){return this.table.style!==this.documentModel.tableStyles[0]?cw.obtainStyleIndex(this.table.style,this.rtfExporter.rtfExportHelper.tableStylesCollectionIndex):-1}exportRowCells(e,t){for(let r of e.cells)this.exportCellParagraphs(r,t)}exportInTableParagraph(e,t,r,i){const n=this.subDocument.paragraphs[e];this.rtfExporter.exportParagraphCore(n,t,i,this.tableStyleIndex),this.finishParagraph(r)}finishParagraph(e){e?this.writeParagraphEndMark():this.rtfBuilder.writeCommand(uP.EndOfParagraph)}exportCellParagraphs(e,t){const r=this.subDocument.getParagraphIndexByPosition(e.startParagraphPosition.value),i=this.subDocument.getParagraphIndexByPosition(e.endParagrapPosition.value-1);for(let n=r;n<=i;n++){const o=this.subDocument.paragraphs[n].getTableCell(),a=this.exportNestedTable(e,n);if(o!==e){if(n=a,1==this.nestingLevel){const r=e.parentRow;this.exportRowProperties(r,t)}}else{1==this.nestingLevel&&n==r&&e.isFirstCellInRow&&this.exportRowProperties(e.parentRow,t);const o=n==i;this.exportInTableParagraph(n,this.nestingLevel,o,e.conditionalFormatting)}}}exportNestedTable(e,t){const r=this.subDocument.paragraphs[t].getTableCell();if(r===e)return t;let i=r.parentRow.parentTable;for(;e!==i.parentCell;)i=i.parentCell.parentRow.parentTable;return gw.exportNestedTable(this.rtfExporter,i,this.nestingLevel+1)}exportRowProperties(e,t){const r=this.calculateRowLeft(e,e.parentTable.getActualTableIndent(this.documentModel.defaultTableProperties));this.exportOwnRowProperties(e,t,r);let i=e.gridBefore;for(const t of e.cells){i+=t.columnSpan;const e=r+this.getCellWidth(i);this.exportCellProperties(t,e)}}getCellWidth(e){if(e<0)throw new Error(R.D.InternalException);return 10*e}calculateRowLeft(e,t){const r=e.gridBefore>0?this.getCellWidth(e.gridBefore):0;return this.getActualWidth(t)+r-(null!=this.rowLeftOffset?this.rowLeftOffset:this.calculateRowLeftOffset(e))}calculateRowLeftOffset(e){const t=e.cells[0].properties.borders.left.width,r=e.cells[0].properties.cellMargins.left;return this.rowLeftOffset=Math.max(t/2,this.getActualWidth(r)),this.rowLeftOffset}getActualWidth(e){return e.type==Je.ModelUnits?e.value:0}exportOwnRowProperties(e,t,r){this.startNewRow(t),this.tableRowPropertiesExporter.writeRowAlignment(e.properties.tableRowAlignment);const i=e.parentTable,n=new nw(this.documentModel).getMergedProperties(i);this.tablePropertiesExporter.writeTableBorders(n.borders),this.tablePropertiesExporter.writeRowLeft(r),this.tableRowPropertiesExporter.writeRowHeight(e.height);const o=new ow(this.documentModel).getMergedProperties(e);this.tableRowPropertiesExporter.writeRowHeader(o.header),this.tableRowPropertiesExporter.writeRowCantSplit(o.cantSplit),this.tablePropertiesExporter.writeTableWidth(i.preferredWidth),this.tableRowPropertiesExporter.writeWidthBefore(e.widthBefore),this.tableRowPropertiesExporter.writeWidthAfter(e.widthAfter),this.tablePropertiesExporter.writeTableLayout(i.properties.layoutType),this.tableRowPropertiesExporter.writeRowCellSpacing(o.cellSpacing),this.tablePropertiesExporter.writeTableCellMargins(n.cellMargins),this.tablePropertiesExporter.writeTableLook(i.lookTypes),this.tablePropertiesExporter.writeTableIndent(n.indent),this.tablePropertiesExporter.writeBandSizes(i.properties)}startNewRow(e){this.rtfBuilder.writeCommand(uP.ResetTableProperties),this.rtfBuilder.writeIntegerCommand(uP.TableRowIndex,e),(this.table.lookTypes&_e.ApplyFirstRow)>0?this.rtfBuilder.writeIntegerCommand(uP.TableRowBandIndex,e-1):this.rtfBuilder.writeIntegerCommand(uP.TableRowBandIndex,e),e==this.table.rows.length-1&&this.tableRowPropertiesExporter.writeLastRowMark(),this.writeTableStyleIndex(),this.tableRowPropertiesExporter.writeHalfSpaceBetweenCells(this.calcHalfSpaceBetweenCells())}writeTableStyleIndex(){-1!=this.tableStyleIndex&&this.rtfBuilder.writeIntegerCommand(uP.TableStyleIndex,this.tableStyleIndex)}calcHalfSpaceBetweenCells(){const e=this.table.properties.cellMargins.left,t=e.type==Je.ModelUnits?e.value:0,r=this.table.properties.cellMargins.right;return(t+(r.type==Je.ModelUnits?r.value:0))/2}exportCellProperties(e,t){const r=new iw(this.documentModel).getMergedProperties(e);this.tableCellPropertiesExporter.writeCellVerticalMerging(e.verticalMerging,Xe.None),this.tableCellPropertiesExporter.writeCellVerticalAlignment(r.verticalAlignment),this.tableCellPropertiesExporter.writeCellBasicBorders(this.getActualTopBorderInfo(e),this.getActualLeftBorderInfo(e),this.getActualRightBorderInfo(e),this.getActualBottomBorderInfo(e)),this.tableCellPropertiesExporter.writeCellShading(r.shadingInfo),this.tableCellPropertiesExporter.writeCellTextDirection(r.textDirection),this.tableCellPropertiesExporter.writeCellFitText(r.fitText),this.tableCellPropertiesExporter.writeCellNoWrap(r.noWrap),this.tableCellPropertiesExporter.writeCellHideCellMark(r.hideCellMark),this.tableCellPropertiesExporter.writeCellPreferredWidth(e.preferredWidth),this.tableCellPropertiesExporter.writeCellMargings(r.cellMargins),this.tableCellPropertiesExporter.writeCellRight(t)}getActualLeftBorderInfo(e){let t=e.getActualLeftCellBorder(this.documentModel.defaultTableCellProperties);const r=e.parentRow.cells[0]==e&&this.table.properties.cellSpacing.value<=0;return t||(t=this.table.getActualLeftBorder(this.documentModel.defaultTableProperties,r)),this.getActualBorderInfoCore(t)}getActualRightBorderInfo(e){let t=e.getActualRightCellBorder(this.subDocument.documentModel.defaultTableCellProperties);const r=f.ListUtils.last(e.parentRow.cells)==e&&this.table.properties.cellSpacing.value<=0;return t||(t=this.table.getActualRightBorder(this.documentModel.defaultTableProperties,r)),this.getActualBorderInfoCore(t)}getActualTopBorderInfo(e){let t=e.getActualTopCellBorder(this.subDocument.documentModel.defaultTableCellProperties);const r=e.parentRow.parentTable.rows[0]==e.parentRow&&this.table.properties.cellSpacing.value<=0;return t||(t=this.table.getActualTopBorder(this.documentModel.defaultTableProperties,r)),this.getActualBorderInfoCore(t)}getActualBottomBorderInfo(e){let t=e.getActualBottomCellBorder(this.subDocument.documentModel.defaultTableCellProperties);const r=f.ListUtils.last(e.parentRow.parentTable.rows)==e.parentRow&&this.table.properties.cellSpacing.value<=0;return t||(t=this.table.getActualBottomBorder(this.documentModel.defaultTableProperties,r)),this.getActualBorderInfoCore(t)}getActualBorderInfoCore(e){return e&&e.style!=de.Nil?e:new Me}}class uw extends hw{constructor(e,t,r){super(e,t,r)}export(){super.exportBase()}writeParagraphEndMark(){this.rtfBuilder.writeCommand(uP.NestedTableEndCell),this.writeNoNestedTableGroup()}exportRow(e,t){super.exportRowCells(e,t),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.NestedTableProperties),super.exportRowProperties(e,t),this.rtfBuilder.writeCommand(uP.NestedTableEndRow),this.rtfBuilder.closeGroup()}writeNoNestedTableGroup(){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.NoNestedTable),this.rtfBuilder.writeCommand(uP.EndOfParagraph),this.rtfBuilder.closeGroup()}}class pw extends hw{constructor(e,t){super(e,t,1)}export(){super.exportBase()}writeParagraphEndMark(){this.rtfBuilder.writeCommand(uP.TableEndCell)}exportRow(e,t){super.exportRowCells(e,t),super.exportRowProperties(e,t),this.rtfBuilder.writeCommand(uP.TableEndRow)}}class gw{static exportTable(e,t){return new pw(e,t).export(),e.tableIterator.update(t.getEndPosition()),e.subDocument.getParagraphIndexByPosition(t.getEndPosition()-1)}static exportNestedTable(e,t,r){return new uw(e,t,r).export(),e.tableIterator.update(t.getEndPosition()),e.subDocument.getParagraphIndexByPosition(t.getEndPosition()-1)}}class mw{get shouldExportHiddenText(){return!0}constructor(e,t,r){this.shouldFourceUpdateIterators=!1,this.documentModel=e,this.subDocument=this.documentModel.mainSubDocument,this.pieceTableNumberingListCounters=new TP,this.rtfExportHelper=r,this.options=t,this.rtfBuilder=this.createRtfBuilder(),this.paragraphPropertiesExporter=new ZP(e,r,this.rtfBuilder),this.characterPropertiesExporter=new JP(e,r,this.rtfBuilder,t),this.sectionPropertiesExporter=new tw(e,r,this.rtfBuilder),this.runHandlerMap=(new Eu).add(cs.TextRun,this.exportTextRun).add(cs.FieldCodeStartRun,this.fieldCodeStartRunHandler).add(cs.FieldCodeEndRun,this.fieldCodeEndRunHandler).add(cs.FieldResultEndRun,this.fieldResultEndRunHandler).add(cs.InlinePictureRun,this.inlinePictureRunHandler).add(cs.InlineTextBoxRun,this.inlineTextBoxRunHandler).add(cs.AnchoredPictureRun,this.anchoredPictureRunHandler).add(cs.AnchoredTextBoxRun,this.anchoredTextBoxRunHandler).get()}createRtfBuilder(){return new RP}export(){this.exportDefaultCharacterProperties(),this.exportDefaultParagraphProperties(),this.exportStyleTable(),this.options.listExportFormat==vP.RtfFormat&&this.exportNumberingListTable(),this.populateUserTable(),this.rtfBuilder.clear(),this.exportDocumentInformation(),this.exportDocumentSettings(),this.options.wrapContentInGroup&&this.rtfBuilder.openGroup(),this.exportSubDocument(this.documentModel.mainSubDocument,this.exportDocument),this.options.wrapContentInGroup&&this.rtfBuilder.closeGroup()}shouldSplitRuns(){return this.subDocument.bookmarks.length>0}splitRuns(){this.subDocument.bookmarks.forEach((e=>{this.splitRun(e.start),this.splitRun(e.end)}))}splitRun(e){if(e==this.subDocument.getDocumentEndPosition())return;const t=this.subDocument.getRunAndIndexesByPosition(e);t.charOffset>0&&t.chunk.splitRun(t.runIndex,t.charOffset)}initializeSubDocument(e){this.permissionsIterator=this.createPermissionsIterator(),this.bookmarksIterator=this.createBookmarkIterator(),this.tableIterator=new IP(this.subDocument.tables),this.tableIterator.init(0),this.shouldFourceUpdateIterators=!0,this.startSectionParagraphIndex=e}updateIterators(e){this.shouldFourceUpdateIterators&&this.forceUpdateIterators(e)}forceUpdateIterators(e){this.tableIterator.update(e),this.shouldFourceUpdateIterators=!1}exportSubDocument(e,t){const r=this.subDocument,i=this.pieceTableNumberingListCounters,n=this.startSectionParagraphIndex,o=this.permissionsIterator,a=this.bookmarksIterator;this.subDocument=e,this.pieceTableNumberingListCounters=new TP,this.initializeSubDocument(0),t.call(this),null==r?this.subDocument=this.documentModel.mainSubDocument:(this.subDocument=r,this.initializeSubDocument(n)),this.pieceTableNumberingListCounters=i||new TP,this.permissionsIterator=o||this.createPermissionsIterator(),this.bookmarksIterator=a||this.createBookmarkIterator()}createPermissionsIterator(){const e=new mP(this.subDocument.rangePermissions);return e.init(),e}createBookmarkIterator(){const e=new mP(this.subDocument.bookmarks);return e.init(),e}exportDefaultCharacterProperties(){if(!rn.StringUtils.isNullOrEmpty(this.rtfExportHelper.defaultCharacterProperties))return;this.rtfBuilder.clear();const e=this.documentModel.defaultCharacterProperties;if(e){const t=new JP(this.documentModel,this.rtfExportHelper,this.rtfBuilder,this.options),r=e.textColor.toRgb(this.documentModel.colorProvider);U.isTransparentOrEmpty(r)||r==y.BLACK_COLOR||this.rtfExportHelper.getColorIndex(e.textColor),t.exportCharacterProperties(e,!0,!1,!1),this.rtfExportHelper.defaultCharacterProperties=this.rtfBuilder.rtfContent.getText()}}exportDefaultParagraphProperties(){if(!rn.StringUtils.isNullOrEmpty(this.rtfExportHelper.defaultParagraphProperties))return;this.rtfBuilder.clear();const e=this.documentModel.defaultParagraphProperties;if(e){new ZP(this.documentModel,this.rtfExportHelper,this.rtfBuilder).exportParagraphPropertiesCore(e,!0),this.rtfExportHelper.defaultParagraphProperties=this.rtfBuilder.rtfContent.getText()}}exportStyleTable(){new cw(this.documentModel,this.createRtfBuilder(),this.rtfExportHelper,this.options).exportStyleSheet(this.documentModel.paragraphStyles,this.documentModel.characterStyles,this.documentModel.tableStyles)}exportNumberingListTable(){const e=new ew(this),t=this.documentModel.numberingLists;let r=0;r=Math.min(r,this.calculateFirstExportedNumberingListsIndexForStyles(this.documentModel.paragraphStyles));const i=t.length-r;e.export(t,r,i)}calculateFirstExportedNumberingListsIndexForStyles(e){let t=Number.MAX_SAFE_INTEGER;return f.ListUtils.forEach(e,(e=>{const r=e.getNumberingListIndex();r>=0&&(t=Math.min(t,r))})),t}populateUserTable(){this.rtfExportHelper.userCollection=[],b.j.forEach(this.documentModel.subDocuments,(e=>{this.populateUserList(e,this.rtfExportHelper.userCollection)}))}populateUserList(e,t){const r=e.rangePermissions,i=r.length;for(let e=0;e<i;e++){const i=r[e].userName;!rn.StringUtils.isNullOrEmpty(i)&&t.indexOf(i)<0&&t.push(i)}}exportDocumentInformation(){this.shouldExportDocumentInformation()&&(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.DocumentInformation),this.exportDocumentProperties(),this.exportDocumentProtectionPasswordHash(),this.rtfBuilder.closeGroup())}exportDocumentProtectionPasswordHash(){this.shouldExportDocumentProtectionPasswordHash()&&(this.shouldExportDocumentProtectionPasswordHashInWord2007Format()?this.exportDocumentProtectionPasswordHashWord2007():this.exportDocumentProtectionPasswordHashWord2003())}exportDocumentProtectionPasswordHashWord2007(){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.PasswordHash);const e=this.getDocumentProtectionPasswordHashWord2007Bytes();this.rtfBuilder.writeByteArrayAsHex(e),this.rtfBuilder.closeGroup()}getDocumentProtectionPasswordHashWord2007Bytes(){const e=this.documentModel.documentProtectionProperties,t=e.passwordHash,r=e.passwordPrefix?e.passwordPrefix:[],i=[];i.push(1),i.push(40+t.length+r.length),i.push(e.cryptProviderType==Ro.RsaFull?1:24),i.push(32768+e.hashAlgorithmType),i.push(e.hashIterationCount),i.push(t.length),i.push(r.length),i.push(0),i.push(0),i.push(0);const n=new Uint8Array(new Uint32Array(i).buffer),o=new Uint8Array(n.byteLength+t.length+r.length);return o.set(n),o.set(t,n.byteLength),o.set(r,n.byteLength+t.length),o}exportDocumentProtectionPasswordHashWord2003(){const e=this.documentModel.documentProtectionProperties;this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.Password);const t=e.word2003PasswordHash;let r="";if(null==t)r="00000000";else{const e=new DataView(t,0).getInt32(0);r=this.documentModel.simpleFormattersManager.formatString("{0:x8}",e)}this.rtfBuilder.writeTextDirect(r),this.rtfBuilder.closeGroup()}shouldExportDocumentProtectionPasswordHashInWord2007Format(){const e=this.documentModel.documentProtectionProperties;return null!=e.passwordHash&&e.hashAlgorithmType!=Fo.None}shouldExportDocumentInformation(){return this.shouldExportDocumentProtectionPasswordHash()||this.shouldExportDocumentProperties()}shouldExportDocumentProperties(){return this.options.exportedDocumentProperties!=DP.None&&this.options.exportedDocumentProperties!=DP.CustomProperties}shouldExportDocumentProtectionPasswordHash(){const e=this.documentModel.documentProtectionProperties;return!(!e||!e.enforceProtection||null==e.passwordHash&&null==e.word2003PasswordHash)}exportDocumentSettings(){this.exportFormattingFlags(),this.exportCompatibilitySettings(),this.rtfBuilder.writeIntegerCommand(uP.DefaultTabWidth,this.documentModel.defaultTabWidth),this.documentModel.mirrorMargins&&this.rtfBuilder.writeCommand(uP.MirrorMargins),this.documentModel.differentOddAndEvenPages&&this.rtfBuilder.writeCommand(uP.PageFacing),this.documentModel.displayBackgroundShape&&this.rtfBuilder.writeCommand(uP.DisplayBackgroundShape,"1"),U.isTransparentOrEmpty(this.documentModel.pageBackColor)||this.exportPageBackground(),this.exportDocumentProtectionProperties()}exportFormattingFlags(){this.rtfBuilder.writeCommand(uP.NoUICompatible),this.rtfBuilder.writeCommand(uP.ShapeDoNotLay),this.rtfBuilder.writeCommand(uP.HtmlAutoSpacing)}exportDocumentProtectionProperties(){const e=this.documentModel.documentProtectionProperties;e&&e.enforceProtection&&(e.protectionType==Mo.ReadOnly&&(this.rtfBuilder.writeCommand(uP.AnnotationProtection),this.rtfBuilder.writeCommand(uP.ReadOnlyProtection),this.rtfBuilder.writeIntegerCommand(uP.EnforceProtection,1),this.rtfBuilder.writeIntegerCommand(uP.ProtectionLevel,3)),e.protectionType==Mo.AllowComments&&(this.rtfBuilder.writeCommand(uP.AnnotationProtection),this.rtfBuilder.writeIntegerCommand(uP.EnforceProtection,1),this.rtfBuilder.writeIntegerCommand(uP.ProtectionLevel,1)))}exportPageBackground(){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.PageBackground),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.Shape),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ShapeInstance),this.rtfBuilder.writeShapeColorProperty("fillColor",this.documentModel.pageBackColor),this.rtfBuilder.closeGroup(),this.rtfBuilder.closeGroup(),this.rtfBuilder.closeGroup()}exportCompatibilitySettings(){this.documentModel.compatibilitySettings.dontJustifyLinesEndingInSoftLineBreak||this.rtfBuilder.writeCommand(uP.CompatibilityDontJustifyLinesEndingInSoftLineBreak),this.rtfBuilder.writeCommand(uP.CompatibilitySplitPageBreakAndParagraphMark)}exportDocumentProperties(){this.writeDateTimeDocumentProperty(new Date,uP.Created,DP.Created),this.writeDateTimeDocumentProperty(new Date,uP.Modified,DP.Modified)}writeStringDocumentProperty(e,t,r){null!=e&&this.options.exportedDocumentProperties&r&&(this.rtfBuilder.textHasNonASCIISymbol(e)?(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.UnicodeAndANSIGroup),this.writeANSIStringProperty(e,t),this.writeUnicodeStringProperty(e,t),this.rtfBuilder.closeGroup()):this.writeStringProperty(e,t))}writeANSIStringProperty(e,t){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(t),this.rtfBuilder.writeAnsiText(e),this.rtfBuilder.closeGroup()}writeUnicodeStringProperty(e,t){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.UnicodeGroup),this.writeStringProperty(e,t),this.rtfBuilder.closeGroup()}writeStringProperty(e,t){null!=e&&(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(t),this.rtfBuilder.writeText(e),this.rtfBuilder.closeGroup())}writeDateTimeDocumentProperty(e,t,r){null!=e&&this.options.exportedDocumentProperties&r&&(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(t),this.rtfBuilder.writeIntegerCommand(uP.Year,e.getFullYear()),this.rtfBuilder.writeIntegerCommand(uP.Month,e.getMonth()),this.rtfBuilder.writeIntegerCommand(uP.Day,e.getDay()),this.rtfBuilder.writeIntegerCommand(uP.Hour,e.getHours()),this.rtfBuilder.writeIntegerCommand(uP.Minute,e.getMinutes()),this.rtfBuilder.closeGroup())}exportDocument(){for(const e of this.documentModel.sections)this.exportSectionFiltered(e)}exportSectionFiltered(e){this.shouldExportSection(e)&&this.exportSection(e)}shouldExportSection(e){return this.shouldExportHiddenText}exportSection(e){this.startNewSection(e),this.currentSection=e,this.startSectionParagraphIndex=this.subDocument.getParagraphIndexByPosition(this.currentSection.interval.start),this.exportSectionHeadersFootersCore(e),this.updateIterators(e.interval.start),this.exportParagraphs(this.subDocument.getParagraphsByInterval(e.interval))}startNewSection(e){Bb.isEnabled(this.documentModel.options.sections)&&(this.rtfBuilder.writeCommand(uP.ResetSectionProperties),this.sectionPropertiesExporter.exportSectionProperties(e))}exportParagraphs(e){if(!e.length)return;let t;for(let r=0;r<e.length;r++){const i=e[r];r=this.exportParagraphFiltered(i,r),t=i.getEndPosition()}this.bookmarksIterator.update(t)&&this.exportBookmark(this.bookmarksIterator),this.permissionsIterator.update(t)&&this.exportRangePermission(this.permissionsIterator)}exportParagraphFiltered(e,t){return this.exportParagraph(e,t)}exportParagraph(e,t){this.tableIterator.update(e.interval.start);const r=this.tableIterator.generateInfo(e.interval.start);return null==r?(this.exportSingleParagraph(e),t):gw.exportTable(this,r[0].table.getTopLevelParent())-this.startSectionParagraphIndex}exportSingleParagraph(e){this.exportParagraphCore(e,0,0,-1),this.finishParagraph(e)}finishParagraph(e){const t=e.getEndPosition(),r=t==this.subDocument.getDocumentEndPosition();r&&this.supressExportLastParagraph(e)||(r||t!=this.currentSection.getEndPosition()?this.rtfBuilder.writeCommand(uP.EndOfParagraph):this.rtfBuilder.writeCommand(uP.SectionEndMark))}supressExportLastParagraph(e){return!!this.subDocument.isMain()&&this.options.exportFinalParagraphMark==MP.Never}exportParagraphCore(e,t,r,i){this.startNewParagraph(e,t),this.exportParagraphRuns(e),this.exportParagraphCharacterProperties(e)}startNewParagraph(e,t){e.isInList()&&this.writeAlternativeText(e),this.rtfBuilder.writeCommand(uP.ResetParagraphProperties),this.startNewInnerParagraph(e,t)}startNewInnerParagraph(e,t){this.rtfBuilder.writeCommand(uP.ResetCharacterFormatting),this.paragraphPropertiesExporter.exportParagraphProperties(e,t)}writeAlternativeText(e){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.AlternativeText),this.rtfBuilder.writeCommand(uP.ResetParagraphProperties),this.rtfBuilder.writeCommand(uP.ResetCharacterFormatting);const t=this.subDocument.documentModel.getRangeListCounters(e);this.rtfBuilder.writeText(e.getNumberingListTextCore(t));const r=ew.getListLevelSeparator(e.getListLevel().getListLevelProperties().separator);this.rtfBuilder.writeText(r.toString()),this.rtfBuilder.closeGroup()}exportParagraphCharacterProperties(e){const t=this.subDocument.getRunByPosition(e.getEndPosition()-1);this.characterPropertiesExporter.exportParagraphCharacterProperties(t.getCharacterMergedProperties())}exportParagraphRuns(e){const t=new jh(this.subDocument,!1);t.setPosition(e.interval.start);do{this.exportRun(t.run,t.getRunText(),t.getAbsolutePosition())}while(t.moveToNextRun()&&t.getAbsolutePosition()<e.interval.end)}exportRun(e,t,r){this.bookmarksIterator.update(r)&&this.exportBookmark(this.bookmarksIterator),this.permissionsIterator.update(r)&&this.exportRangePermission(this.permissionsIterator);const i=this.runHandlerMap[e.getType()];i&&i.call(this,e,t,r),this.updateIterators(r)}exportTextRun(e,t,r){this.rtfBuilder.openGroup(),this.characterPropertiesExporter.exportCharacterProperties(e.getCharacterMergedProperties()),this.characterPropertiesExporter.exportCharacterStyle(e.characterStyle,e.paragraph.paragraphStyle);const i=e.getLength();if(this.bookmarksIterator.hasObjects(r,i)||this.permissionsIterator.hasObjects(r,i)){let e=0,i=1;const n=()=>{this.rtfBuilder.writeText(t.substr(e,i)),e+=i,i=0};for(;e+i<t.length;){const t=r+e+i;this.bookmarksIterator.update(t)&&(n(),this.exportBookmark(this.bookmarksIterator)),this.permissionsIterator.update(t)&&(n(),this.exportRangePermission(this.permissionsIterator)),i++}i>0&&this.rtfBuilder.writeText(t.substr(e,i))}else this.rtfBuilder.writeText(t);this.rtfBuilder.closeGroup()}exportBookmark(e){for(const t of e.addedObjects)this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.BookmarkStart),this.rtfBuilder.writeText(t.object.name),this.rtfBuilder.closeGroup();for(const t of e.deletedObjects)this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.BookmarkEnd),this.rtfBuilder.writeText(t.object.name),this.rtfBuilder.closeGroup()}exportRangePermission(e){for(const t of e.addedObjects){const e=this.generateRangePermissionData(t.object);if(rn.StringUtils.isNullOrEmpty(e))return;this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.RangePermissionStart),this.rtfBuilder.writeTextDirect(e),this.rtfBuilder.closeGroup()}for(const t of e.deletedObjects){const e=this.generateRangePermissionData(t.object);if(rn.StringUtils.isNullOrEmpty(e))return;this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.RangePermissionEnd),this.rtfBuilder.writeTextDirect(e),this.rtfBuilder.closeGroup()}}generateRangePermissionData(e){const t=this.rtfExportHelper;if(!t)return"";const r=t.getUserIndex(e);if(0==r)return"";const i=this.subDocument.rangePermissions.indexOf(e);return i<0?"":this.intToShortString(r)+"0100"+this.intToShortString(i)+"0000"}intToShortString(e){const t=255&(e&=65535),r=e>>8;return rn.StringUtils.padLeft(t.toString(16),2,"0")+rn.StringUtils.padLeft(r.toString(16),2,"0")}fieldCodeStartRunHandler(e,t,r){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.Field);this.subDocument.fields[Md.binaryIndexOf(this.subDocument.fields,r+1)].locked&&this.rtfBuilder.writeCommand(uP.FieldLocked),this.rtfBuilder.writeCommand(uP.FieldCodeView),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.FieldInstructions)}fieldCodeEndRunHandler(e,t,r){this.rtfBuilder.closeGroup(),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.FieldResult)}fieldResultEndRunHandler(e,t,r){this.rtfBuilder.closeGroup(),this.rtfBuilder.closeGroup()}inlinePictureRunHandler(e,t,r){const i=e.getCharacterMergedProperties(),n=yP.ShouldExportInlinePictureRunCharacterProperties(i,this.documentModel.colorProvider);n&&(this.rtfBuilder.openGroup(),this.characterPropertiesExporter.exportCharacterProperties(i));const o=e;(new WP).export(this.rtfBuilder,o.info,this.documentModel.cache.imageCache,o.info.containerProperties),n&&this.rtfBuilder.closeGroup()}inlineTextBoxRunHandler(e,t,r){throw new Error(R.D.NotImplemented)}anchoredPictureRunHandler(e,t,r){new GP(this.rtfBuilder,e,this.documentModel.cache.imageCache).export()}anchoredTextBoxRunHandler(e,t,r){const i=e;new KP(this.rtfBuilder,i,(()=>{this.exportSubDocument(this.documentModel.subDocuments[i.subDocId],this.exportPieceTable)})).export()}exportSectionHeadersFootersCore(e){if(!Bb.isEnabled(this.documentModel.options.headersFooters))return;const t=e.headers.getObject(Ws.First);t&&this.exportFirstPageHeader(t,e.headers.isLinkedToPrevious(Ws.First));const r=e.headers.getObject(Ws.Odd);r&&this.exportOddPageHeader(r,e.headers.isLinkedToPrevious(Ws.Odd));const i=e.headers.getObject(Ws.Even);i&&this.exportEvenPageHeader(i,e.headers.isLinkedToPrevious(Ws.Even));const n=e.footers.getObject(Ws.First);n&&this.exportFirstPageFooter(n,e.footers.isLinkedToPrevious(Ws.First));const o=e.footers.getObject(Ws.Odd);o&&this.exportOddPageFooter(o,e.footers.isLinkedToPrevious(Ws.Odd));const a=e.footers.getObject(Ws.Even);a&&this.exportEvenPageFooter(a,e.footers.isLinkedToPrevious(Ws.Even))}exportFirstPageHeader(e,t){t||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.SectionFirstPageHeader),this.exportFirstPageHeaderCore(e,t),this.rtfBuilder.closeGroup())}exportOddPageHeader(e,t){t||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.SectionOddPageHeader),this.exportOddPageHeaderCore(e,t),this.rtfBuilder.closeGroup())}exportEvenPageHeader(e,t){t||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.SectionEvenPageHeader),this.exportEvenPageHeaderCore(e,t),this.rtfBuilder.closeGroup())}exportFirstPageFooter(e,t){t||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.SectionFirstPageFooter),this.exportFirstPageFooterCore(e,t),this.rtfBuilder.closeGroup())}exportOddPageFooter(e,t){t||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.SectionOddPageFooter),this.exportOddPageFooterCore(e,t),this.rtfBuilder.closeGroup())}exportEvenPageFooter(e,t){t||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.SectionEvenPageFooter),this.exportEvenPageFooterCore(e,t),this.rtfBuilder.closeGroup())}exportFirstPageHeaderCore(e,t){const r=this.documentModel.subDocuments[e.subDocumentId];this.exportSubDocument(r,this.exportPieceTable)}exportOddPageHeaderCore(e,t){const r=this.documentModel.subDocuments[e.subDocumentId];this.exportSubDocument(r,this.exportPieceTable)}exportEvenPageHeaderCore(e,t){const r=this.documentModel.subDocuments[e.subDocumentId];this.exportSubDocument(r,this.exportPieceTable)}exportFirstPageFooterCore(e,t){const r=this.documentModel.subDocuments[e.subDocumentId];this.exportSubDocument(r,this.exportPieceTable)}exportOddPageFooterCore(e,t){const r=this.documentModel.subDocuments[e.subDocumentId];this.exportSubDocument(r,this.exportPieceTable)}exportEvenPageFooterCore(e,t){const r=this.documentModel.subDocuments[e.subDocumentId];this.exportSubDocument(r,this.exportPieceTable)}exportPieceTable(){this.exportParagraphs(this.subDocument.paragraphs)}}mw.verticalAlignmentTypes=(new Eu).add(Rb.Both,uP.VerticalAlignmentJustify).add(Rb.Bottom,uP.VerticalAlignmentBottom).add(Rb.Center,uP.VerticalAlignmentCenter).add(Rb.Top,uP.VerticalAlignmentTop).get(),mw.sectionStartTypes=(new Eu).add(Vs.Continuous,uP.SectionBreakTypeContinuous).add(Vs.NextPage,uP.SectionBreakTypeNextPage).add(Vs.OddPage,uP.SectionBreakTypeOddPage).add(Vs.EvenPage,uP.SectionBreakTypeEvenPage).add(Vs.Column,uP.SectionBreakTypeColumn).get(),mw.chapterSeparatorTypes=(new Eu).add(xP.Hyphen,uP.SectionChapterSeparatorHyphen).add(".",uP.SectionChapterSeparatorPeriod).add(":",uP.SectionChapterSeparatorColon).add(xP.EmDash,uP.SectionChapterSeparatorEmDash).add(xP.EnDash,uP.SectionChapterSeparatorEnDash).get(),mw.pageNumberingTypes=(new Eu).add(Zi.Decimal,uP.SectionPageNumberingDecimal).add(Zi.UpperRoman,uP.SectionPageNumberingUpperRoman).add(Zi.LowerRoman,uP.SectionPageNumberingLowerRoman).add(Zi.UpperLetter,uP.SectionPageNumberingUpperLetter).add(Zi.LowerLetter,uP.SectionPageNumberingLowerLetter).add(Zi.ArabicAbjad,uP.SectionPageNumberingArabicAbjad).add(Zi.ArabicAlpha,uP.SectionPageNumberingArabicAlpha).add(Zi.Chosung,uP.SectionPageNumberingChosung).add(Zi.DecimalEnclosedCircle,uP.SectionPageNumberingDecimalEnclosedCircle).add(Zi.DecimalFullWidth,uP.SectionPageNumberingDecimalFullWidth).add(Zi.Ganada,uP.SectionPageNumberingGanada).add(Zi.HindiVowels,uP.SectionPageNumberingHindiVowels).add(Zi.HindiConsonants,uP.SectionPageNumberingHindiConsonants).add(Zi.HindiNumbers,uP.SectionPageNumberingHindiNumbers).add(Zi.HindiDescriptive,uP.SectionPageNumberingHindiDescriptive).add(Zi.ThaiLetters,uP.SectionPageNumberingThaiLetters).add(Zi.ThaiNumbers,uP.SectionPageNumberingThaiNumbers).add(Zi.ThaiDescriptive,uP.SectionPageNumberingThaiDescriptive).add(Zi.VietnameseDescriptive,uP.SectionPageNumberingVietnameseDescriptive).get(),mw.sectionFootNoteNumberingTypes=(new Eu).add(Zi.Decimal,uP.SectionFootNoteNumberingFormatDecimal).add(Zi.UpperRoman,uP.SectionFootNoteNumberingFormatUpperRoman).add(Zi.LowerRoman,uP.SectionFootNoteNumberingFormatLowerRoman).add(Zi.UpperLetter,uP.SectionFootNoteNumberingFormatUpperLetter).add(Zi.LowerLetter,uP.SectionFootNoteNumberingFormatLowerLetter).add(Zi.Chicago,uP.SectionFootNoteNumberingFormatChicago).add(Zi.Chosung,uP.SectionFootNoteNumberingFormatChosung).add(Zi.DecimalEnclosedCircle,uP.SectionFootNoteNumberingFormatDecimalEnclosedCircle).add(Zi.DecimalFullWidth,uP.SectionFootNoteNumberingFormatDecimalFullWidth).add(Zi.Ganada,uP.SectionFootNoteNumberingFormatGanada).get(),mw.sectionEndNoteNumberingTypes=(new Eu).add(Zi.Decimal,uP.SectionEndNoteNumberingFormatDecimal).add(Zi.UpperRoman,uP.SectionEndNoteNumberingFormatUpperRoman).add(Zi.LowerRoman,uP.SectionEndNoteNumberingFormatLowerRoman).add(Zi.UpperLetter,uP.SectionEndNoteNumberingFormatUpperLetter).add(Zi.LowerLetter,uP.SectionEndNoteNumberingFormatLowerLetter).add(Zi.Chicago,uP.SectionEndNoteNumberingFormatChicago).add(Zi.Chosung,uP.SectionEndNoteNumberingFormatChosung).add(Zi.DecimalEnclosedCircle,uP.SectionEndNoteNumberingFormatDecimalEnclosedCircle).add(Zi.DecimalFullWidth,uP.SectionEndNoteNumberingFormatDecimalFullWidth).add(Zi.Ganada,uP.SectionEndNoteNumberingFormatGanada).get(),mw.footNoteNumberingTypes=(new Eu).add(Zi.Decimal,uP.FootNoteNumberingFormatDecimal).add(Zi.UpperRoman,uP.FootNoteNumberingFormatUpperRoman).add(Zi.LowerRoman,uP.FootNoteNumberingFormatLowerRoman).add(Zi.UpperLetter,uP.FootNoteNumberingFormatUpperLetter).add(Zi.LowerLetter,uP.FootNoteNumberingFormatLowerLetter).add(Zi.Chicago,uP.FootNoteNumberingFormatChicago).add(Zi.Chosung,uP.FootNoteNumberingFormatChosung).add(Zi.DecimalEnclosedCircle,uP.FootNoteNumberingFormatDecimalEnclosedCircle).add(Zi.DecimalFullWidth,uP.FootNoteNumberingFormatDecimalFullWidth).add(Zi.Ganada,uP.FootNoteNumberingFormatGanada).get(),mw.endNoteNumberingTypes=(new Eu).add(Zi.Decimal,uP.EndNoteNumberingFormatDecimal).add(Zi.UpperRoman,uP.EndNoteNumberingFormatUpperRoman).add(Zi.LowerRoman,uP.EndNoteNumberingFormatLowerRoman).add(Zi.UpperLetter,uP.EndNoteNumberingFormatUpperLetter).add(Zi.LowerLetter,uP.EndNoteNumberingFormatLowerLetter).add(Zi.Chicago,uP.EndNoteNumberingFormatChicago).add(Zi.Chosung,uP.EndNoteNumberingFormatChosung).add(Zi.DecimalEnclosedCircle,uP.EndNoteNumberingFormatDecimalEnclosedCircle).add(Zi.DecimalFullWidth,uP.EndNoteNumberingFormatDecimalFullWidth).add(Zi.Ganada,uP.EndNoteNumberingFormatGanada).get(),mw.borderLineStyles=(new Eu).add(de.DashDotStroked,uP.BorderDashDotStroked).add(de.Dashed,uP.BorderDashed).add(de.DashSmallGap,uP.BorderDashedSmall).add(de.DotDash,uP.BorderDotDashed).add(de.DotDotDash,uP.BorderDotDotDashed).add(de.Dotted,uP.BorderDotted).add(de.Double,uP.BorderDouble).add(de.DoubleWave,uP.BorderDoubleWavy).add(de.Inset,uP.BorderInset).add(de.None,uP.BorderNone).add(de.Nil,uP.NoBorder).add(de.Outset,uP.BorderOutset).add(de.Single,uP.BorderSingle).add(de.ThickThinLargeGap,uP.BorderThickThinLarge).add(de.ThickThinMediumGap,uP.BorderThickThinMedium).add(de.ThickThinSmallGap,uP.BorderThickThinSmall).add(de.ThinThickLargeGap,uP.BorderThinThickLarge).add(de.ThinThickMediumGap,uP.BorderThinThickMedium).add(de.ThinThickSmallGap,uP.BorderThinThickSmall).add(de.ThinThickThinLargeGap,uP.BorderThinThickThinLarge).add(de.ThinThickThinMediumGap,uP.BorderThinThickThinMedium).add(de.ThinThickThinSmallGap,uP.BorderThinThickThinSmall).add(de.ThreeDEmboss,uP.BorderThreeDEmboss).add(de.ThreeDEngrave,uP.BorderThreeDEngrave).add(de.Triple,uP.BorderTriple).add(de.Wave,uP.BorderWavy).get(),mw.conditionalStylesTypes=(new Eu).add(qe.BottomLeftCell,uP.TableConditionalStyleBottomLeftCell).add(qe.BottomRightCell,uP.TableConditionalStyleBottomRightCell).add(qe.EvenColumnBanding,uP.TableConditionalStyleEvenColumnBanding).add(qe.EvenRowBanding,uP.TableConditionalStyleEvenRowBanding).add(qe.FirstColumn,uP.TableConditionalStyleFirstColumn).add(qe.FirstRow,uP.TableConditionalStyleFirstRow).add(qe.LastColumn,uP.TableConditionalStyleLastColumn).add(qe.LastRow,uP.TableConditionalStyleLastRow).add(qe.OddColumnBanding,uP.TableConditionalStyleOddColumnBanding).add(qe.OddRowBanding,uP.TableConditionalStyleOddRowBanding).add(qe.TopLeftCell,uP.TableConditionalStyleTopLeftCell).add(qe.TopRightCell,uP.TableConditionalStyleTopRightCell).get(),mw.predefinedUserGroups=(new Eu).add(65530,Dd.Current_GROUP_NAME).add(65531,Dd.Editors_GROUP_NAME).add(65532,Dd.Owners_GROUP_NAME).add(65533,Dd.Contributors_GROUP_NAME).add(65534,Dd.Administrators_GROUP_NAME).add(65535,Dd.Everyone_GROUP_NAME).get();class fw{constructor(){this.colorCollection=[],this.colorCollection.push(he.empty),this.fontNamesCollection=[],this.numberingListCollection={},this.listOverrideCollectionIndex={},this.listOverrideCollection=[],this.defaultFontIndex=this.getFontNameIndex(_n.defaultFontName),this.paragraphStylesCollectionIndex={},this.characterStylesCollectionIndex={},this.tableStylesCollectionIndex={},this.fontCharsetTable={},this.stylesCollection=[],this.userCollection=[]}getFontNameIndex(e){let t=this.fontNamesCollection.indexOf(e);return t>=0?t:(this.fontNamesCollection.push(e),this.fontNamesCollection.length-1)}getColorIndex(e){let t=f.ListUtils.indexBy(this.colorCollection,(t=>t.equals(e)));return t<0&&(t=this.colorCollection.length,this.colorCollection.push(e)),t}blendColor(e){return U.blend(e,U.white)}getUserIndex(e){let t=this.userCollection.findIndex((t=>0==Qe.Comparers.stringIgnoreCase(t,e.userName)));if(t>=0)return t+1;const r=mw.predefinedUserGroups,i=b.j.keyBy(r,(t=>0==Qe.Comparers.stringIgnoreCase(t,e.group)));return null!=i?i:0}}class bw{get documentModel(){return this.modelManipulator.model}constructor(e,t){this.modelManipulator=e,this.options=t,this.rtfExportHelper=new fw,this.contentExporter=new mw(this.documentModel,t,this.rtfExportHelper),this.rtfBuilder=this.contentExporter.createRtfBuilder()}exportToBlob(e){this.modelManipulator.picture.loader.ensureAllPicturesLoaded(this.options.ensurePictureLoadedTimeout,(t=>{e(new Blob([this.exportAsString()],{type:"application/rtf"}))}))}exportToBase64(e){this.modelManipulator.picture.loader.ensureAllPicturesLoaded(this.options.ensurePictureLoadedTimeout,(t=>{e(btoa(this.exportAsString()))}))}exportAsString(){return this.exportCore(),this.rtfBuilder.rtfContent.getText()}exportCore(){this.contentExporter.export();let e=this.contentExporter.rtfBuilder.rtfContent;this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.RtfSignature),this.rtfBuilder.writeIntegerCommand(uP.DefaultFontIndex,this.rtfExportHelper.defaultFontIndex),this.exportFontTable(),this.exportColorTable(),this.exportDefaultProperties(),this.exportStyleTable(),this.exportListTable(),this.exportListOverrideTable(),this.exportParagraphGroupProperties(),this.exportUsersTable(),this.exportDocumentVariables(),this.rtfBuilder.writeTextDirectUnsafe(e),this.rtfBuilder.closeGroup()}exportListTable(){const e=this.rtfExportHelper.numberingListCollection,t=Object.keys(e);t.length<=0||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.NumberingListTable),t.forEach((t=>{this.rtfBuilder.writeTextDirect(e[t])})),this.rtfBuilder.closeGroup())}exportListOverrideTable(){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ListOverrideTable);const e=this.rtfExportHelper.listOverrideCollection;Object.keys(e).forEach((t=>{this.rtfBuilder.writeTextDirect(e[t])})),this.rtfBuilder.closeGroup()}exportDefaultProperties(){this.exportDefaultCharacterProperties(),this.exportDefaultParagraphProperties()}exportDefaultCharacterProperties(){rn.StringUtils.isNullOrEmpty(this.rtfExportHelper.defaultCharacterProperties)||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.DefaultCharacterProperties),this.rtfBuilder.writeTextDirect(this.rtfExportHelper.defaultCharacterProperties),this.rtfBuilder.closeGroup())}exportDefaultParagraphProperties(){rn.StringUtils.isNullOrEmpty(this.rtfExportHelper.defaultParagraphProperties)||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.DefaultParagraphProperties),this.rtfBuilder.writeTextDirect(this.rtfExportHelper.defaultParagraphProperties),this.rtfBuilder.closeGroup())}exportStyleTable(){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.StyleTable),f.ListUtils.forEach(this.rtfExportHelper.stylesCollection,(e=>{this.rtfBuilder.writeTextDirect(e)})),this.rtfBuilder.closeGroup()}exportUsersTable(){const e=this.rtfExportHelper.userCollection;if(!(e.length<=0)){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.UserTable);for(let t=0;t<e.length;t++)this.rtfBuilder.openGroup(),this.rtfBuilder.writeText(e[t]),this.rtfBuilder.closeGroup();this.rtfBuilder.closeGroup()}}exportDocumentVariables(){this.documentModel.docVariables.foreach(((e,t)=>{(0,S.isDefined)(t)&&"object"!=typeof t&&(t=String(t),rn.StringUtils.isNullOrEmpty(t)||(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.DocumentVariable),this.rtfBuilder.openGroup(),this.rtfBuilder.writeText(e),this.rtfBuilder.closeGroup(),this.rtfBuilder.openGroup(),this.rtfBuilder.writeText(t),this.rtfBuilder.closeGroup(),this.rtfBuilder.closeGroup()))}))}exportParagraphGroupProperties(){const e=this.contentExporter.documentModel.webSettings;e.isBodyMarginsSet()&&(this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ParagraphGroupPropertiesTable),this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ParagraphGroupProperties),this.rtfBuilder.writeIntegerCommand(uP.ParagraphGroupPropertiesId,0),this.rtfBuilder.writeIntegerCommand(uP.LeftIndentInTwips,e.leftMargin),this.rtfBuilder.writeIntegerCommand(uP.RightIndentInTwips,e.rightMargin),this.rtfBuilder.writeIntegerCommand(uP.SpaceBefore,e.topMargin),this.rtfBuilder.writeIntegerCommand(uP.SpaceAfter,e.bottomMargin),this.rtfBuilder.closeGroup(),this.rtfBuilder.closeGroup())}exportColorTable(){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.ColorTable),f.ListUtils.forEach(this.rtfExportHelper.colorCollection,((e,t)=>this.exportColorIndexTableEntry(t))),this.rtfBuilder.closeGroup()}exportColorIndexTableEntry(e){const t=this.rtfExportHelper.colorCollection[e];t.colorType==V.Rgb&&this.exportRgbColor(t.toRgb(this.documentModel.colorProvider)),t.colorType==V.Theme&&(this.options.exportTheme&&this.exportColorInfo(t),this.exportRgbColor(t.toRgb(this.documentModel.colorProvider))),this.rtfBuilder.writeTextDirect(";")}exportRgbColor(e){U.isTransparentOrEmpty(e)||(this.rtfBuilder.writeIntegerCommand(uP.ColorRed,w.i.getRed(e)),this.rtfBuilder.writeIntegerCommand(uP.ColorGreen,w.i.getGreen(e)),this.rtfBuilder.writeIntegerCommand(uP.ColorBlue,w.i.getBlue(e)))}exportColorInfo(e){const t=uP.ThemeColorValuesTable[e.themeValue];t&&this.rtfBuilder.writeCommand(t),e.tint<0&&e.tint>Bo.Int32Constants.MIN_VALUE&&(this.rtfBuilder.writeIntegerCommand(uP.ThemeColorTint,hP.maxTintValue),this.rtfBuilder.writeIntegerCommand(uP.ThemeColorShade,hP.calculateShadeFromColorModelInfoTint(e.tint))),e.tint>0&&e.tint<Bo.Int32Constants.MAX_VALUE&&(this.rtfBuilder.writeIntegerCommand(uP.ThemeColorTint,hP.calculateTintFromColorModelInfoTint(e.tint)),this.rtfBuilder.writeIntegerCommand(uP.ThemeColorShade,hP.maxTintValue))}exportFontTable(){this.rtfBuilder.openGroup(),this.rtfBuilder.writeCommand(uP.FontTable);const e=this.rtfExportHelper.fontNamesCollection,t=e.length;for(let r=0;r<t;r++)this.exportFontTableEntry(e[r],r);this.rtfBuilder.closeGroup()}exportFontTableEntry(e,t){this.rtfBuilder.openGroup(),this.rtfBuilder.writeIntegerCommand(uP.FontNumber,t);const r=this.rtfBuilder.containsNonAnsiChar(e);r&&this.rtfBuilder.openGroup(),this.rtfBuilder.writeText(e),r&&this.rtfBuilder.closeGroup(),this.rtfBuilder.writeTextDirect(";"),this.rtfBuilder.closeGroup()}}var Cw,Sw;!function(e){e[e.OpenAnyway=0]="OpenAnyway",e[e.LoadEmptyDocument=1]="LoadEmptyDocument"}(Cw||(Cw={}));class Iw{constructor(e=e=>{O.isDebug&&console.log(`LoadedFileIsIncorrect: ${e}`)}){this.invalidDocumentMode=Cw.OpenAnyway,this.throwInvalidFile=e}}!function(e){e[e.TxtFileReaderError=0]="TxtFileReaderError",e[e.TxtImportError=1]="TxtImportError",e[e.RtfFileReaderError=2]="RtfFileReaderError",e[e.RtfImportError=3]="RtfImportError",e[e.OpenXmlImportError=4]="OpenXmlImportError",e[e.HtmlFileReaderError=5]="HtmlFileReaderError",e[e.HtmlImportError=6]="HtmlImportError"}(Sw||(Sw={}));class Pw extends Ze{constructor(e,t){super(e),this.abstractNumberingList=t}redo(){this.abstractNumberingListIndex=this.modelManipulator.numberingList.addAbstractNumberingList(this.abstractNumberingList)}undo(){this.modelManipulator.numberingList.deleteAbstractNumberingList(this.abstractNumberingListIndex)}}class ww extends Ze{constructor(e,t){super(e),this.numberingList=t}redo(){this.numberingListIndex=this.modelManipulator.numberingList.addNumberingList(this.numberingList)}undo(){this.modelManipulator.numberingList.deleteNumberingList(this.numberingListIndex)}}class yw extends Ze{constructor(e,t,r,i,n){super(e),this.subDocument=t,this.paragraphIndex=r,this.numberingListIndex=i,this.listLevelIndex=n}redo(){const e=this.subDocument.paragraphs[this.paragraphIndex];this.useValHistItem=new rt(this.modelManipulator,new gu(this.subDocument,this.subDocument.paragraphs[this.paragraphIndex].interval),new pr.Flag(e.maskedParagraphProperties.useValue).set(Be.UseLeftIndent,!1).set(Be.UseFirstLineIndent,!1).getValue()),this.useValHistItem.redo(),this.state=this.modelManipulator.numberingList.setParagraphNumberingList(this.subDocument,this.paragraphIndex,this.numberingListIndex,this.listLevelIndex)}undo(){this.useValHistItem.undo(),this.modelManipulator.numberingList.restoreParagraphNumberingList(this.subDocument,this.state)}}class xw extends Ze{constructor(e,t,r){super(e),this.subDocument=t,this.paragraphIndex=r}redo(){this.state=this.modelManipulator.numberingList.removeNumberingListFromParagraph(this.subDocument,this.paragraphIndex)}undo(){this.modelManipulator.numberingList.restoreParagraphNumberingList(this.subDocument,this.state)}}class Tw{static generateNewTemplateCode(e){for(;;){const t=P.MathUtils.getRandomInt(Tw.templateCodeStart,Tw.templateCodeEnd);if(Tw.isNewTemplateCode(e,t))return t}}static isNewTemplateCode(e,t){return!e.cache.listLevelPropertiesCache.findItemByPredicate((e=>e.templateCode==t))}static getNumberingListTemplateIndex(e,t){for(var r,i=0;r=e.abstractNumberingListTemplates[i];i++)if(r.getListType()===t)return i;return-1}static getNumberingListTemplate(e,t){return e.abstractNumberingListTemplates.find((e=>e.getListType()===t))}static deleteNumberingList(e,t,r){for(let i=r.length-1;i>=0;i--){let n=r[i];t.paragraphs[n].isInList()&&(this.resetParagraphLeftIndent(e,t,n),this.deleteNumberingListCore(e,t,n))}}static resetParagraphLeftIndent(e,t,r){var i=t.paragraphs[r],n=i.getNumberingList().levels[i.getListLevelIndex()],o=i.getParagraphMergedProperties(),a=i.interval;const s=n.getListLevelProperties().originalLeftIndent?n.getListLevelProperties().originalLeftIndent:n.getParagraphProperties().firstLineIndent;var l=o.leftIndent-s;e.history.addAndRedo(new gt(e.modelManipulator,new gu(t,a),ke.None,!0)),e.history.addAndRedo(new pt(e.modelManipulator,new gu(t,a),0,!0)),e.history.addAndRedo(new ft(e.modelManipulator,new gu(t,a),Math.max(0,l),!0))}static deleteNumberingListCore(e,t,r){var i=t.paragraphs[r];i.numberingListIndex>=0?e.history.addAndRedo(new xw(e.modelManipulator,t,r)):(i.numberingListIndex===cn.NumberingListNotSettedIndex&&e.history.addAndRedo(new ft(e.modelManipulator,new gu(t,new on.FixedInterval(i.startLogPosition.value,0)),i.getParagraphMergedProperties().leftIndent,!0)),e.history.addAndRedo(new yw(e.modelManipulator,t,r,cn.NoNumberingListIndex,0)))}}Tw.templateCodeStart=256,Tw.templateCodeEnd=2147483647;class vw{constructor(e){this.options=e}static createTemplateCharProps(e){const t=new Pe;return t.fontInfo=e.cache.fontInfoCache.getItemByName("Calibri"),t}static createDefaultCharProps(e){const t=vw.createTemplateCharProps(e);return t.setAllUse(),t}static createTemplateParProps(){return new Lt}static createDefaultParProps(){const e=vw.createTemplateParProps();return e.useValue=Be.UseAll,e}static createTemplateTableProps(){return new mr}static createDefaultTableProps(){const e=vw.createTemplateTableProps();return e.mask=ur.UseAll,e}static createTemplateTableRowProps(){return new za}static createDefaultTableRowProps(){const e=vw.createTemplateTableRowProps();return e.mask=Ua.UseAll,e}static createTemplateTableCellProps(){return new cr}static createDefaultTableCellProps(){const e=vw.createTemplateTableCellProps();return e.mask=Ye.UseAll,e}static createHyperlinkStyleCharProps(e){const t=vw.createTemplateCharProps(e);return t.setUseValueFull(ie.UseForeColorIndex|ie.UseFontUnderlineType),t.textColor=he.makeByColor(w.i.fromString("#0000ff")),t.fontUnderlineType=le.Single,t}static createTemplateSecProps(){return new yh}static createTemplateTabProps(){return new ts}createModel(e){return this.model=new cm(e,uu.MAIN_SUBDOCUMENT_ID+1),this}setModel(e){return this.model=e,this}fillModel(){const e=this.model,t=e.cache.maskedCharacterPropertiesCache.getItem(vw.createTemplateCharProps(e)),r=e.cache.maskedParagraphPropertiesCache.getItem(vw.createTemplateParProps()),i=vw.createTemplateTableProps(),n=e.cache.tableRowPropertiesCache.getItem(vw.createTemplateTableRowProps()),o=e.cache.tableCellPropertiesCache.getItem(vw.createTemplateTableCellProps()),a=vw.createTemplateTabProps();if(e.pageBackColor=y.AUTOMATIC_COLOR,e.defaultTabWidth=720,e.differentOddAndEvenPages=!1,e.displayBackgroundShape=!1,e.defaultCharacterProperties=e.cache.maskedCharacterPropertiesCache.getItem(vw.createDefaultCharProps(e)),e.defaultParagraphProperties=e.cache.maskedParagraphPropertiesCache.getItem(vw.createDefaultParProps()),e.defaultTableProperties=vw.createDefaultTableProps(),e.defaultTableCellProperties=e.cache.tableCellPropertiesCache.getItem(vw.createDefaultTableCellProps()),e.defaultTableRowProperties=e.cache.tableRowPropertiesCache.getItem(vw.createDefaultTableRowProps()),this.options.fillAbstractNumberingListTemplates&&this.initNumberingListTemplates(),this.options.fillCharStyles&&(e.stylesManager.addCharacterStyle(new zl(zl.defaultParagraphCharacterStyleName,zl.defaultParagraphCharacterStyleName,!1,!1,!1,!0,t,null)),e.stylesManager.addCharacterStyle(new zl(zl.hyperlinkStyleName,zl.hyperlinkStyleName,!1,!1,!1,!0,vw.createHyperlinkStyleCharProps(e),null))),this.options.fillParStyles&&e.stylesManager.addParagraphStyle(new es(es.normalStyleName,es.normalStyleName,!1,!1,!1,!0,t,r,new ts,!1,-1,-1,null)),this.options.fillTableStyles){const s=new Xl(i,n,o,r,t,a);e.stylesManager.addTableStyle(new Vh(Vh.DEFAULT_STYLENAME,Vh.DEFAULT_STYLENAME,!1,!1,!1,!0,{},s,null))}this.options.initOfficeTheme&&this.initOfficeTheme();const s=e.mainSubDocument,l=new mo(s.positionManager.registerPosition(0),"",!0);if(s.chunks=[l],this.options.addParagraph){const i=an.specialCharacters.ParagraphMark.substr(0);s.paragraphs=[new ns(s,s.positionManager.registerPosition(0),i.length,e.getDefaultParagraphStyle(),r)],l.textBuffer=i,l.textRuns=[new Bl(0,s.paragraphs[0],new pn(t,e.characterStyles[0]))]}return this.options.addSection&&(e.sections=[new Ch(e,s.positionManager.registerPosition(0),this.options.addParagraph?1:0,vw.createTemplateSecProps())]),e}initOfficeTheme(){this.model.colorProvider.officeTheme.name="Office",this.model.colorProvider.officeTheme.colors.Accent1=this.getDrawingColorAsRgb(-12291388),this.model.colorProvider.officeTheme.colors.Accent2=this.getDrawingColorAsRgb(-1213135),this.model.colorProvider.officeTheme.colors.Accent3=this.getDrawingColorAsRgb(-5921371),this.model.colorProvider.officeTheme.colors.Accent4=this.getDrawingColorAsRgb(-16384),this.model.colorProvider.officeTheme.colors.Accent5=this.getDrawingColorAsRgb(-10773547),this.model.colorProvider.officeTheme.colors.Accent6=this.getDrawingColorAsRgb(-9392825),this.model.colorProvider.officeTheme.colors.Dark1=this.getDrawingColorAsSystem(xn.ScWindowText),this.model.colorProvider.officeTheme.colors.Dark2=this.getDrawingColorAsSystem(xn.ScWindowText),this.model.colorProvider.officeTheme.colors.Light1=this.getDrawingColorAsSystem(xn.ScWindow),this.model.colorProvider.officeTheme.colors.Light2=this.getDrawingColorAsRgb(-1579290),this.model.colorProvider.officeTheme.colors.FollowedHyperlink=this.getDrawingColorAsRgb(-6992014),this.model.colorProvider.officeTheme.colors.Hyperlink=this.getDrawingColorAsRgb(-16423999),this.initFontScheme()}initFontScheme(){this.model.colorProvider.officeTheme.fontScheme.name="Office";const e=this.model.colorProvider.officeTheme.fontScheme.majorFont,t={Arab:"Times New Roman",Beng:"Vrinda",Cans:"Euphemia",Cher:"Plantagenet Cherokee",Deva:"Mangal",Ethi:"Nyala",Geor:"Sylfaen",Gujr:"Shruti",Guru:"Raavi",Hang:"맑은 고딕",Hans:"等线 Light",Hant:"新細明體",Hebr:"Times New Roman",Jpan:"游ゴシック Light",Khmr:"MoolBoran",Knda:"Tunga",Laoo:"DokChampa",Mlym:"Kartika",Mong:"Mongolian Baiti",Orya:"Kalinga",Sinh:"Iskoola Pota",Syrc:"Estrangelo Edessa",Taml:"Latha",Telu:"Gautami",Thaa:"MV Boli",Thai:"Angsana New",Tibt:"Microsoft Himalaya",Uigh:"Microsoft Uighur",Viet:"Times New Roman",Yiii:"Microsoft Yi Baiti"};e.supplementalFonts=t,e.complexScript.charset=1,e.complexScript.pitchFamily=0,e.complexScript.typeface="",e.complexScript.panose="",e.eastAsian.charset=1,e.eastAsian.pitchFamily=0,e.eastAsian.typeface="",e.eastAsian.panose="",e.latin.charset=1,e.latin.pitchFamily=0,e.latin.typeface="Calibri Light",e.latin.panose="020F0302020204030204";const r=this.model.colorProvider.officeTheme.fontScheme.minorFont,i={Arab:"Arial",Beng:"Vrinda",Cans:"Euphemia",Cher:"Plantagenet Cherokee",Deva:"Mangal",Ethi:"Nyala",Geor:"Sylfaen",Gujr:"Shruti",Guru:"Raavi",Hang:"맑은 고딕",Hans:"等线",Hant:"新細明體",Hebr:"Arial",Jpan:"游明朝",Khmr:"DaunPenh",Knda:"Tunga",Laoo:"DokChampa",Mlym:"Kartika",Mong:"Mongolian Baiti",Orya:"Kalinga",Sinh:"Iskoola Pota",Syrc:"Estrangelo Edessa",Taml:"Latha",Telu:"Gautami",Thaa:"MV Boli",Thai:"Cordia New",Tibt:"Microsoft Himalaya",Uigh:"Microsoft Uighur",Viet:"Arial",Yiii:"Microsoft Yi Baiti"};r.supplementalFonts=i,r.complexScript.charset=1,r.complexScript.pitchFamily=0,r.complexScript.typeface="",r.complexScript.panose="",r.eastAsian.charset=1,r.eastAsian.pitchFamily=0,r.eastAsian.typeface="",r.eastAsian.panose="",r.latin.charset=1,r.latin.pitchFamily=0,r.latin.typeface="Calibri",r.latin.panose="020F0502020204030204"}getDrawingColorAsRgb(e){return new Pp(this.model.cache.drawingColorModelInfoCache.getItem(Bn.createRGB(e)))}getDrawingColorAsSystem(e){return new Pp(this.model.cache.drawingColorModelInfoCache.getItem(Bn.createSystem(e)))}initNumberingListTemplates(){this.model.abstractNumberingListTemplates=[];let e=0;const t=new dn(this.model);f.ListUtils.forEach(t.levels,((t,r)=>{const i=new sn,n=new Lt;n.copyFrom(this.model.defaultParagraphProperties),i.displayFormatString=`{${r}}.`,i.templateCode=Tw.generateNewTemplateCode(this.model),n.firstLineIndent=360,n.firstLineIndentType=ke.Hanging,e+=720,n.leftIndent=e,t.setListLevelProperties(i),t.setParagraphProperties(n)})),this.model.abstractNumberingListTemplates.push(t),e=0;const r=new dn(this.model);f.ListUtils.forEach(r.levels,(t=>{const r=new sn,i=new Lt;i.copyFrom(this.model.defaultParagraphProperties),r.displayFormatString="•",r.format=5,r.templateCode=Tw.generateNewTemplateCode(this.model),t.getCharacterProperties().fontInfo=this.model.cache.fontInfoCache.getItemByName("Arial"),i.firstLineIndent=360,i.firstLineIndentType=ke.Hanging,e+=720,i.leftIndent=e,t.setListLevelProperties(r),t.setParagraphProperties(i)})),this.model.abstractNumberingListTemplates.push(r);const i=new dn(this.model);let n="";const o=[360,792,1224,1728,2232,2736,3240,3744,4320];f.ListUtils.forEach(i.levels,((e,t)=>{const r=new sn,i=new Lt;i.copyFrom(this.model.defaultParagraphProperties),n+=`{${t}}.`,r.displayFormatString=n,e.setListLevelProperties(r);const a=360*t;i.leftIndent=o[t],i.firstLineIndent=i.leftIndent-a,i.firstLineIndentType=ke.Hanging,e.setParagraphProperties(i)})),this.model.abstractNumberingListTemplates.push(i)}}class Mw{constructor(){this.fillCharStyles=!0,this.fillParStyles=!0,this.fillTableStyles=!0,this.addParagraph=!0,this.addSection=!0,this.fillAbstractNumberingListTemplates=!0,this.initOfficeTheme=!0}}class Ew{constructor(e,t,r){this.subDocPos=e,this.options=t,this.run=r}}class Dw{constructor(){this.data=[],this.callbackId=[]}dispose(){this.callbackId.forEach((e=>clearTimeout(e))),clearTimeout(this.timeoutId)}whenAllPicturesLoaded(e,t=3e3){if(!this.data.length)return void(this.callOnImportEnd=()=>e(!0));let r=this.data.length;this.timeoutId=setTimeout((()=>e(!1)),t),this.data.forEach((t=>t.options.imageLoadedEvent.push((()=>{r--,0==r&&(clearTimeout(this.timeoutId),this.callbackId.push(setTimeout((()=>e(!0)),0)))}))))}import(e){this.data.forEach((t=>{const r=t.run.info.cacheInfo;e.picture.loader.sizeUpdater.addSizes(t.subDocPos,t.options,t.run,null),r.isLoaded&&e.picture.loader.sizeUpdater.update(r,!1)})),e.model.cache.imageCache.loadAllPictures(e.picture),this.callOnImportEnd&&this.callOnImportEnd()}registerImageRun(e){this.data.push(e)}}var Fw,Rw=__webpack_require__(9094);!function(e){e[e.default=1250]="default",e[e.GB2315=936]="GB2315",e[e.UTF8=65001]="UTF8",e[e.Russian=1251]="Russian",e[e.Ansi=1252]="Ansi",e[e.Greek=1253]="Greek",e[e.Turkis=1254]="Turkis",e[e.Baltic=1257]="Baltic",e[e.Vietnamese=1258]="Vietnamese",e[e.Hebrew=1255]="Hebrew",e[e.Arabic=1256]="Arabic",e[e.Hangul=949]="Hangul",e[e.Big5=950]="Big5",e[e.MacRoman=1e4]="MacRoman",e[e.MacRussian=10007]="MacRussian"}(Fw||(Fw={}));const Lw=(new Eu).add(0,"갂갃갅갆갋갌갍갎갏갘갞갟갡갢갣갥갦갧갨갩갪갫갮갲갳갴").add(32,"갵갶갷갺갻갽갾갿걁걂걃걄걅걆걇걈걉걊걌걎걏걐걑걒걓걕").add(64,"걖걗걙걚걛걝걞걟걠걡걢걣걤걥걦걧걨걩걪걫걬걭걮걯걲걳걵걶걹걻걼걽걾걿겂겇겈겍겎겏겑겒겓겕겖겗겘겙겚겛겞겢겣겤겥겦겧겫겭겮겱겲겳겴겵겶겷겺겾겿곀곂곃곅곆곇곉곊곋곍곎곏곐곑곒곓곔곖곘곙곚곛곜곝곞곟곢곣곥곦곩곫곭곮곲곴곷곸곹곺곻곾곿괁괂괃괅괇괈괉괊괋괎괐괒괓").add(256,"괔괕괖괗괙괚괛괝괞괟괡괢괣괤괥괦괧괨괪괫괮괯괰괱괲괳").add(288,"괶괷괹괺괻괽괾괿굀굁굂굃굆굈굊굋굌굍굎굏굑굒굓굕굖굗").add(320,"굙굚굛굜굝굞굟굠굢굤굥굦굧굨굩굪굫굮굯굱굲굷굸굹굺굾궀궃궄궅궆궇궊궋궍궎궏궑궒궓궔궕궖궗궘궙궚궛궞궟궠궡궢궣궥궦궧궨궩궪궫궬궭궮궯궰궱궲궳궴궵궶궸궹궺궻궼궽궾궿귂귃귅귆귇귉귊귋귌귍귎귏귒귔귕귖귗귘귙귚귛귝귞귟귡귢귣귥귦귧귨귩귪귫귬귭귮귯귰귱귲귳귴귵귶귷").add(512,"귺귻귽귾긂긃긄긅긆긇긊긌긎긏긐긑긒긓긕긖긗긘긙긚긛긜").add(544,"긝긞긟긠긡긢긣긤긥긦긧긨긩긪긫긬긭긮긯긲긳긵긶긹긻긼").add(576,"긽긾긿깂깄깇깈깉깋깏깑깒깓깕깗깘깙깚깛깞깢깣깤깦깧깪깫깭깮깯깱깲깳깴깵깶깷깺깾깿꺀꺁꺂꺃꺆꺇꺈꺉꺊꺋꺍꺎꺏꺐꺑꺒꺓꺔꺕꺖꺗꺘꺙꺚꺛꺜꺝꺞꺟꺠꺡꺢꺣꺤꺥꺦꺧꺨꺩꺪꺫꺬꺭꺮꺯꺰꺱꺲꺳꺴꺵꺶꺷꺸꺹꺺꺻꺿껁껂껃껅껆껇껈껉껊껋껎껒껓껔껕껖껗껚껛껝껞껟껠껡껢껣껤껥").add(768,"껦껧껩껪껬껮껯껰껱껲껳껵껶껷껹껺껻껽껾껿꼀꼁꼂꼃꼄꼅").add(800,"꼆꼉꼊꼋꼌꼎꼏꼑꼒꼓꼔꼕꼖꼗꼘꼙꼚꼛꼜꼝꼞꼟꼠꼡꼢꼣").add(832,"꼤꼥꼦꼧꼨꼩꼪꼫꼮꼯꼱꼳꼵꼶꼷꼸꼹꼺꼻꼾꽀꽄꽅꽆꽇꽊꽋꽌꽍꽎꽏꽑꽒꽓꽔꽕꽖꽗꽘꽙꽚꽛꽞꽟꽠꽡꽢꽣꽦꽧꽨꽩꽪꽫꽬꽭꽮꽯꽰꽱꽲꽳꽴꽵꽶꽷꽸꽺꽻꽼꽽꽾꽿꾁꾂꾃꾅꾆꾇꾉꾊꾋꾌꾍꾎꾏꾒꾓꾔꾖꾗꾘꾙꾚꾛꾝꾞꾟꾠꾡꾢꾣꾤꾥꾦꾧꾨꾩꾪꾫꾬꾭꾮꾯꾰꾱꾲꾳꾴꾵꾶꾷꾺꾻꾽꾾").add(1024,"꾿꿁꿂꿃꿄꿅꿆꿊꿌꿏꿐꿑꿒꿓꿕꿖꿗꿘꿙꿚꿛꿝꿞꿟꿠꿡").add(1056,"꿢꿣꿤꿥꿦꿧꿪꿫꿬꿭꿮꿯꿲꿳꿵꿶꿷꿹꿺꿻꿼꿽꿾꿿뀂뀃").add(1088,"뀅뀆뀇뀈뀉뀊뀋뀍뀎뀏뀑뀒뀓뀕뀖뀗뀘뀙뀚뀛뀞뀟뀠뀡뀢뀣뀤뀥뀦뀧뀩뀪뀫뀬뀭뀮뀯뀰뀱뀲뀳뀴뀵뀶뀷뀸뀹뀺뀻뀼뀽뀾뀿끀끁끂끃끆끇끉끋끍끏끐끑끒끖끘끚끛끜끞끟끠끡끢끣끤끥끦끧끨끩끪끫끬끭끮끯끰끱끲끳끴끵끶끷끸끹끺끻끾끿낁낂낃낅낆낇낈낉낊낋낎낐낒낓낔낕낖낗낛낝낞낣낤").add(1280,"낥낦낧낪낰낲낶낷낹낺낻낽낾낿냀냁냂냃냆냊냋냌냍냎냏냒").add(1312,"냓냕냖냗냙냚냛냜냝냞냟냡냢냣냤냦냧냨냩냪냫냬냭냮냯냰").add(1344,"냱냲냳냴냵냶냷냸냹냺냻냼냽냾냿넀넁넂넃넄넅넆넇넊넍넎넏넑넔넕넖넗넚넞넟넠넡넢넦넧넩넪넫넭넮넯넰넱넲넳넶넺넻넼넽넾넿녂녃녅녆녇녉녊녋녌녍녎녏녒녓녖녗녙녚녛녝녞녟녡녢녣녤녥녦녧녨녩녪녫녬녭녮녯녰녱녲녳녴녵녶녷녺녻녽녾녿놁놃놄놅놆놇놊놌놎놏놐놑놕놖놗놙놚놛놝").add(1536,"놞놟놠놡놢놣놤놥놦놧놩놪놫놬놭놮놯놰놱놲놳놴놵놶놷놸").add(1568,"놹놺놻놼놽놾놿뇀뇁뇂뇃뇄뇅뇆뇇뇈뇉뇊뇋뇍뇎뇏뇑뇒뇓뇕").add(1600,"뇖뇗뇘뇙뇚뇛뇞뇠뇡뇢뇣뇤뇥뇦뇧뇪뇫뇭뇮뇯뇱뇲뇳뇴뇵뇶뇷뇸뇺뇼뇾뇿눀눁눂눃눆눇눉눊눍눎눏눐눑눒눓눖눘눚눛눜눝눞눟눡눢눣눤눥눦눧눨눩눪눫눬눭눮눯눰눱눲눳눵눶눷눸눹눺눻눽눾눿뉀뉁뉂뉃뉄뉅뉆뉇뉈뉉뉊뉋뉌뉍뉎뉏뉐뉑뉒뉓뉔뉕뉖뉗뉙뉚뉛뉝뉞뉟뉡뉢뉣뉤뉥뉦뉧뉪뉫뉬뉭뉮").add(1792,"뉯뉰뉱뉲뉳뉶뉷뉸뉹뉺뉻뉽뉾뉿늀늁늂늃늆늇늈늊늋늌늍늎").add(1824,"늏늒늓늕늖늗늛늜늝늞늟늢늤늧늨늩늫늭늮늯늱늲늳늵늶늷").add(1856,"늸늹늺늻늼늽늾늿닀닁닂닃닄닅닆닇닊닋닍닎닏닑닓닔닕닖닗닚닜닞닟닠닡닣닧닩닪닰닱닲닶닼닽닾댂댃댅댆댇댉댊댋댌댍댎댏댒댖댗댘댙댚댛댝댞댟댠댡댢댣댤댥댦댧댨댩댪댫댬댭댮댯댰댱댲댳댴댵댶댷댸댹댺댻댼댽댾댿덀덁덂덃덄덅덆덇덈덉덊덋덌덍덎덏덐덑덒덓덗덙덚덝덠덡덢덣").add(2048,"덦덨덪덬덭덯덲덳덵덶덷덹덺덻덼덽덾덿뎂뎆뎇뎈뎉뎊뎋뎍").add(2080,"뎎뎏뎑뎒뎓뎕뎖뎗뎘뎙뎚뎛뎜뎝뎞뎟뎢뎣뎤뎥뎦뎧뎩뎪뎫뎭").add(2112,"뎮뎯뎰뎱뎲뎳뎴뎵뎶뎷뎸뎹뎺뎻뎼뎽뎾뎿돀돁돂돃돆돇돉돊돍돏돑돒돓돖돘돚돜돞돟돡돢돣돥돦돧돩돪돫돬돭돮돯돰돱돲돳돴돵돶돷돸돹돺돻돽돾돿됀됁됂됃됄됅됆됇됈됉됊됋됌됍됎됏됑됒됓됔됕됖됗됙됚됛됝됞됟됡됢됣됤됥됦됧됪됬됭됮됯됰됱됲됳됵됶됷됸됹됺됻됼됽됾됿둀둁둂둃둄").add(2304,"둅둆둇둈둉둊둋둌둍둎둏둒둓둕둖둗둙둚둛둜둝둞둟둢둤둦").add(2336,"둧둨둩둪둫둭둮둯둰둱둲둳둴둵둶둷둸둹둺둻둼둽둾둿뒁뒂").add(2368,"뒃뒄뒅뒆뒇뒉뒊뒋뒌뒍뒎뒏뒐뒑뒒뒓뒔뒕뒖뒗뒘뒙뒚뒛뒜뒞뒟뒠뒡뒢뒣뒥뒦뒧뒩뒪뒫뒭뒮뒯뒰뒱뒲뒳뒴뒶뒸뒺뒻뒼뒽뒾뒿듁듂듃듅듆듇듉듊듋듌듍듎듏듑듒듓듔듖듗듘듙듚듛듞듟듡듢듥듧듨듩듪듫듮듰듲듳듴듵듶듷듹듺듻듼듽듾듿딀딁딂딃딄딅딆딇딈딉딊딋딌딍딎딏딐딑딒딓딖딗딙딚딝").add(2560,"딞딟딠딡딢딣딦딫딬딭딮딯딲딳딵딶딷딹딺딻딼딽딾딿땂땆").add(2592,"땇땈땉땊땎땏땑땒땓땕땖땗땘땙땚땛땞땢땣땤땥땦땧땨땩땪").add(2624,"땫땬땭땮땯땰땱땲땳땴땵땶땷땸땹땺땻땼땽땾땿떀떁떂떃떄떅떆떇떈떉떊떋떌떍떎떏떐떑떒떓떔떕떖떗떘떙떚떛떜떝떞떟떢떣떥떦떧떩떬떭떮떯떲떶떷떸떹떺떾떿뗁뗂뗃뗅뗆뗇뗈뗉뗊뗋뗎뗒뗓뗔뗕뗖뗗뗙뗚뗛뗜뗝뗞뗟뗠뗡뗢뗣뗤뗥뗦뗧뗨뗩뗪뗫뗭뗮뗯뗰뗱뗲뗳뗴뗵뗶뗷뗸뗹뗺뗻뗼뗽뗾뗿").add(2816,"똀똁똂똃똄똅똆똇똈똉똊똋똌똍똎똏똒똓똕똖똗똙똚똛똜똝").add(2848,"똞똟똠똡똢똣똤똦똧똨똩똪똫똭똮똯똰똱똲똳똵똶똷똸똹똺").add(2880,"똻똼똽똾똿뙀뙁뙂뙃뙄뙅뙆뙇뙉뙊뙋뙌뙍뙎뙏뙐뙑뙒뙓뙔뙕뙖뙗뙘뙙뙚뙛뙜뙝뙞뙟뙠뙡뙢뙣뙥뙦뙧뙩뙪뙫뙬뙭뙮뙯뙰뙱뙲뙳뙴뙵뙶뙷뙸뙹뙺뙻뙼뙽뙾뙿뚀뚁뚂뚃뚄뚅뚆뚇뚈뚉뚊뚋뚌뚍뚎뚏뚐뚑뚒뚓뚔뚕뚖뚗뚘뚙뚚뚛뚞뚟뚡뚢뚣뚥뚦뚧뚨뚩뚪뚭뚮뚯뚰뚲뚳뚴뚵뚶뚷뚸뚹뚺뚻뚼뚽뚾뚿뛀뛁뛂").add(3072,"뛃뛄뛅뛆뛇뛈뛉뛊뛋뛌뛍뛎뛏뛐뛑뛒뛓뛕뛖뛗뛘뛙뛚뛛뛜뛝").add(3104,"뛞뛟뛠뛡뛢뛣뛤뛥뛦뛧뛨뛩뛪뛫뛬뛭뛮뛯뛱뛲뛳뛵뛶뛷뛹뛺").add(3136,"뛻뛼뛽뛾뛿뜂뜃뜄뜆뜇뜈뜉뜊뜋뜌뜍뜎뜏뜐뜑뜒뜓뜔뜕뜖뜗뜘뜙뜚뜛뜜뜝뜞뜟뜠뜡뜢뜣뜤뜥뜦뜧뜪뜫뜭뜮뜱뜲뜳뜴뜵뜶뜷뜺뜼뜽뜾뜿띀띁띂띃띅띆띇띉띊띋띍띎띏띐띑띒띓띖띗띘띙띚띛띜띝띞띟띡띢띣띥띦띧띩띪띫띬띭띮띯띲띴띶띷띸띹띺띻띾띿랁랂랃랅랆랇랈랉랊랋랎랓랔랕랚랛랝랞").add(3328,"랟랡랢랣랤랥랦랧랪랮랯랰랱랲랳랶랷랹랺랻랼랽랾랿럀럁").add(3360,"럂럃럄럅럆럈럊럋럌럍럎럏럐럑럒럓럔럕럖럗럘럙럚럛럜럝").add(3392,"럞럟럠럡럢럣럤럥럦럧럨럩럪럫럮럯럱럲럳럵럶럷럸럹럺럻럾렂렃렄렅렆렊렋렍렎렏렑렒렓렔렕렖렗렚렜렞렟렠렡렢렣렦렧렩렪렫렭렮렯렰렱렲렳렶렺렻렼렽렾렿롁롂롃롅롆롇롈롉롊롋롌롍롎롏롐롒롔롕롖롗롘롙롚롛롞롟롡롢롣롥롦롧롨롩롪롫롮롰롲롳롴롵롶롷롹롺롻롽롾롿뢀뢁뢂뢃뢄").add(3584,"뢅뢆뢇뢈뢉뢊뢋뢌뢎뢏뢐뢑뢒뢓뢔뢕뢖뢗뢘뢙뢚뢛뢜뢝뢞뢟").add(3616,"뢠뢡뢢뢣뢤뢥뢦뢧뢩뢪뢫뢬뢭뢮뢯뢱뢲뢳뢵뢶뢷뢹뢺뢻뢼뢽").add(3648,"뢾뢿룂룄룆룇룈룉룊룋룍룎룏룑룒룓룕룖룗룘룙룚룛룜룞룠룢룣룤룥룦룧룪룫룭룮룯룱룲룳룴룵룶룷룺룼룾룿뤀뤁뤂뤃뤅뤆뤇뤈뤉뤊뤋뤌뤍뤎뤏뤐뤑뤒뤓뤔뤕뤖뤗뤙뤚뤛뤜뤝뤞뤟뤡뤢뤣뤤뤥뤦뤧뤨뤩뤪뤫뤬뤭뤮뤯뤰뤱뤲뤳뤴뤵뤶뤷뤸뤹뤺뤻뤾뤿륁륂륃륅륆륇륈륉륊륋륍륎륐륒륓륔륕륖륗").add(3840,"륚륛륝륞륟륡륢륣륤륥륦륧륪륬륮륯륰륱륲륳륶륷륹륺륻륽").add(3872,"륾륿릀릁릂릃릆릈릋릌릏릐릑릒릓릔릕릖릗릘릙릚릛릜릝릞").add(3904,"릟릠릡릢릣릤릥릦릧릨릩릪릫릮릯릱릲릳릵릶릷릸릹릺릻릾맀맂맃맄맅맆맇맊맋맍맓맔맕맖맗맚맜맟맠맢맦맧맩맪맫맭맮맯맰맱맲맳맶맻맼맽맾맿먂먃먄먅먆먇먉먊먋먌먍먎먏먐먑먒먓먔먖먗먘먙먚먛먜먝먞먟먠먡먢먣먤먥먦먧먨먩먪먫먬먭먮먯먰먱먲먳먴먵먶먷먺먻먽먾먿멁멃멄멅멆").add(4096,"멇멊멌멏멐멑멒멖멗멙멚멛멝멞멟멠멡멢멣멦멪멫멬멭멮멯").add(4128,"멲멳멵멶멷멹멺멻멼멽멾멿몀몁몂몆몈몉몊몋몍몎몏몐몑몒").add(4160,"몓몔몕몖몗몘몙몚몛몜몝몞몟몠몡몢몣몤몥몦몧몪몭몮몯몱몳몴몵몶몷몺몼몾몿뫀뫁뫂뫃뫅뫆뫇뫉뫊뫋뫌뫍뫎뫏뫐뫑뫒뫓뫔뫕뫖뫗뫚뫛뫜뫝뫞뫟뫠뫡뫢뫣뫤뫥뫦뫧뫨뫩뫪뫫뫬뫭뫮뫯뫰뫱뫲뫳뫴뫵뫶뫷뫸뫹뫺뫻뫽뫾뫿묁묂묃묅묆묇묈묉묊묋묌묎묐묒묓묔묕묖묗묙묚묛묝묞묟묡묢묣묤묥묦묧").add(4352,"묨묪묬묭묮묯묰묱묲묳묷묹묺묿뭀뭁뭂뭃뭆뭈뭊뭋뭌뭎뭑뭒").add(4384,"뭓뭕뭖뭗뭙뭚뭛뭜뭝뭞뭟뭠뭢뭤뭥뭦뭧뭨뭩뭪뭫뭭뭮뭯뭰뭱").add(4416,"뭲뭳뭴뭵뭶뭷뭸뭹뭺뭻뭼뭽뭾뭿뮀뮁뮂뮃뮄뮅뮆뮇뮉뮊뮋뮍뮎뮏뮑뮒뮓뮔뮕뮖뮗뮘뮙뮚뮛뮜뮝뮞뮟뮠뮡뮢뮣뮥뮦뮧뮩뮪뮫뮭뮮뮯뮰뮱뮲뮳뮵뮶뮸뮹뮺뮻뮼뮽뮾뮿믁믂믃믅믆믇믉믊믋믌믍믎믏믑믒믔믕믖믗믘믙믚믛믜믝믞믟믠믡믢믣믤믥믦믧믨믩믪믫믬믭믮믯믰믱믲믳믴믵믶믷믺믻믽믾밁").add(4608,"밃밄밅밆밇밊밎밐밒밓밙밚밠밡밢밣밦밨밪밫밬밮밯밲밳밵").add(4640,"밶밷밹밺밻밼밽밾밿뱂뱆뱇뱈뱊뱋뱎뱏뱑뱒뱓뱔뱕뱖뱗뱘뱙").add(4672,"뱚뱛뱜뱞뱟뱠뱡뱢뱣뱤뱥뱦뱧뱨뱩뱪뱫뱬뱭뱮뱯뱰뱱뱲뱳뱴뱵뱶뱷뱸뱹뱺뱻뱼뱽뱾뱿벀벁벂벃벆벇벉벊벍벏벐벑벒벓벖벘벛벜벝벞벟벢벣벥벦벩벪벫벬벭벮벯벲벶벷벸벹벺벻벾벿볁볂볃볅볆볇볈볉볊볋볌볎볒볓볔볖볗볙볚볛볝볞볟볠볡볢볣볤볥볦볧볨볩볪볫볬볭볮볯볰볱볲볳볷볹볺볻볽").add(4864,"볾볿봀봁봂봃봆봈봊봋봌봍봎봏봑봒봓봕봖봗봘봙봚봛봜봝").add(4896,"봞봟봠봡봢봣봥봦봧봨봩봪봫봭봮봯봰봱봲봳봴봵봶봷봸봹").add(4928,"봺봻봼봽봾봿뵁뵂뵃뵄뵅뵆뵇뵊뵋뵍뵎뵏뵑뵒뵓뵔뵕뵖뵗뵚뵛뵜뵝뵞뵟뵠뵡뵢뵣뵥뵦뵧뵩뵪뵫뵬뵭뵮뵯뵰뵱뵲뵳뵴뵵뵶뵷뵸뵹뵺뵻뵼뵽뵾뵿붂붃붅붆붋붌붍붎붏붒붔붖붗붘붛붝붞붟붠붡붢붣붥붦붧붨붩붪붫붬붭붮붯붱붲붳붴붵붶붷붹붺붻붼붽붾붿뷀뷁뷂뷃뷄뷅뷆뷇뷈뷉뷊뷋뷌뷍뷎뷏뷐뷑").add(5120,"뷒뷓뷖뷗뷙뷚뷛뷝뷞뷟뷠뷡뷢뷣뷤뷥뷦뷧뷨뷪뷫뷬뷭뷮뷯뷱").add(5152,"뷲뷳뷵뷶뷷뷹뷺뷻뷼뷽뷾뷿븁븂븄븆븇븈븉븊븋븎븏븑븒븓").add(5184,"븕븖븗븘븙븚븛븞븠븡븢븣븤븥븦븧븨븩븪븫븬븭븮븯븰븱븲븳븴븵븶븷븸븹븺븻븼븽븾븿빀빁빂빃빆빇빉빊빋빍빏빐빑빒빓빖빘빜빝빞빟빢빣빥빦빧빩빫빬빭빮빯빲빶빷빸빹빺빾빿뺁뺂뺃뺅뺆뺇뺈뺉뺊뺋뺎뺒뺓뺔뺕뺖뺗뺚뺛뺜뺝뺞뺟뺠뺡뺢뺣뺤뺥뺦뺧뺩뺪뺫뺬뺭뺮뺯뺰뺱뺲뺳뺴뺵뺶뺷").add(5376,"뺸뺹뺺뺻뺼뺽뺾뺿뻀뻁뻂뻃뻄뻅뻆뻇뻈뻉뻊뻋뻌뻍뻎뻏뻒뻓").add(5408,"뻕뻖뻙뻚뻛뻜뻝뻞뻟뻡뻢뻦뻧뻨뻩뻪뻫뻭뻮뻯뻰뻱뻲뻳뻴뻵").add(5440,"뻶뻷뻸뻹뻺뻻뻼뻽뻾뻿뼀뼂뼃뼄뼅뼆뼇뼊뼋뼌뼍뼎뼏뼐뼑뼒뼓뼔뼕뼖뼗뼚뼞뼟뼠뼡뼢뼣뼤뼥뼦뼧뼨뼩뼪뼫뼬뼭뼮뼯뼰뼱뼲뼳뼴뼵뼶뼷뼸뼹뼺뼻뼼뼽뼾뼿뽂뽃뽅뽆뽇뽉뽊뽋뽌뽍뽎뽏뽒뽓뽔뽖뽗뽘뽙뽚뽛뽜뽝뽞뽟뽠뽡뽢뽣뽤뽥뽦뽧뽨뽩뽪뽫뽬뽭뽮뽯뽰뽱뽲뽳뽴뽵뽶뽷뽸뽹뽺뽻뽼뽽뽾뽿뾀뾁뾂").add(5632,"뾃뾄뾅뾆뾇뾈뾉뾊뾋뾌뾍뾎뾏뾐뾑뾒뾓뾕뾖뾗뾘뾙뾚뾛뾜뾝").add(5664,"뾞뾟뾠뾡뾢뾣뾤뾥뾦뾧뾨뾩뾪뾫뾬뾭뾮뾯뾱뾲뾳뾴뾵뾶뾷뾸").add(5696,"뾹뾺뾻뾼뾽뾾뾿뿀뿁뿂뿃뿄뿆뿇뿈뿉뿊뿋뿎뿏뿑뿒뿓뿕뿖뿗뿘뿙뿚뿛뿝뿞뿠뿢뿣뿤뿥뿦뿧뿨뿩뿪뿫뿬뿭뿮뿯뿰뿱뿲뿳뿴뿵뿶뿷뿸뿹뿺뿻뿼뿽뿾뿿쀀쀁쀂쀃쀄쀅쀆쀇쀈쀉쀊쀋쀌쀍쀎쀏쀐쀑쀒쀓쀔쀕쀖쀗쀘쀙쀚쀛쀜쀝쀞쀟쀠쀡쀢쀣쀤쀥쀦쀧쀨쀩쀪쀫쀬쀭쀮쀯쀰쀱쀲쀳쀴쀵쀶쀷쀸쀹쀺쀻쀽쀾쀿").add(5888,"쁀쁁쁂쁃쁄쁅쁆쁇쁈쁉쁊쁋쁌쁍쁎쁏쁐쁒쁓쁔쁕쁖쁗쁙쁚쁛").add(5920,"쁝쁞쁟쁡쁢쁣쁤쁥쁦쁧쁪쁫쁬쁭쁮쁯쁰쁱쁲쁳쁴쁵쁶쁷쁸쁹").add(5952,"쁺쁻쁼쁽쁾쁿삀삁삂삃삄삅삆삇삈삉삊삋삌삍삎삏삒삓삕삖삗삙삚삛삜삝삞삟삢삤삦삧삨삩삪삫삮삱삲삷삸삹삺삻삾샂샃샄샆샇샊샋샍샎샏샑샒샓샔샕샖샗샚샞샟샠샡샢샣샦샧샩샪샫샭샮샯샰샱샲샳샶샸샺샻샼샽샾샿섁섂섃섅섆섇섉섊섋섌섍섎섏섑섒섓섔섖섗섘섙섚섛섡섢섥섨섩섪섫섮").add(6144,"섲섳섴섵섷섺섻섽섾섿셁셂셃셄셅셆셇셊셎셏셐셑셒셓셖셗").add(6176,"셙셚셛셝셞셟셠셡셢셣셦셪셫셬셭셮셯셱셲셳셵셶셷셹셺셻").add(6208,"셼셽셾셿솀솁솂솃솄솆솇솈솉솊솋솏솑솒솓솕솗솘솙솚솛솞솠솢솣솤솦솧솪솫솭솮솯솱솲솳솴솵솶솷솸솹솺솻솼솾솿쇀쇁쇂쇃쇅쇆쇇쇉쇊쇋쇍쇎쇏쇐쇑쇒쇓쇕쇖쇙쇚쇛쇜쇝쇞쇟쇡쇢쇣쇥쇦쇧쇩쇪쇫쇬쇭쇮쇯쇲쇴쇵쇶쇷쇸쇹쇺쇻쇾쇿숁숂숃숅숆숇숈숉숊숋숎숐숒숓숔숕숖숗숚숛숝숞숡숢숣").add(6400,"숤숥숦숧숪숬숮숰숳숵숶숷숸숹숺숻숼숽숾숿쉀쉁쉂쉃쉄쉅").add(6432,"쉆쉇쉉쉊쉋쉌쉍쉎쉏쉒쉓쉕쉖쉗쉙쉚쉛쉜쉝쉞쉟쉡쉢쉣쉤쉦").add(6464,"쉧쉨쉩쉪쉫쉮쉯쉱쉲쉳쉵쉶쉷쉸쉹쉺쉻쉾슀슂슃슄슅슆슇슊슋슌슍슎슏슑슒슓슔슕슖슗슙슚슜슞슟슠슡슢슣슦슧슩슪슫슮슯슰슱슲슳슶슸슺슻슼슽슾슿싀싁싂싃싄싅싆싇싈싉싊싋싌싍싎싏싐싑싒싓싔싕싖싗싘싙싚싛싞싟싡싢싥싦싧싨싩싪싮싰싲싳싴싵싷싺싽싾싿쌁쌂쌃쌄쌅쌆쌇쌊쌋쌎쌏").add(6656,"쌐쌑쌒쌖쌗쌙쌚쌛쌝쌞쌟쌠쌡쌢쌣쌦쌧쌪쌫쌬쌭쌮쌯쌰쌱쌲").add(6688,"쌳쌴쌵쌶쌷쌸쌹쌺쌻쌼쌽쌾쌿썀썁썂썃썄썆썇썈썉썊썋썌썍").add(6720,"썎썏썐썑썒썓썔썕썖썗썘썙썚썛썜썝썞썟썠썡썢썣썤썥썦썧썪썫썭썮썯썱썳썴썵썶썷썺썻썾썿쎀쎁쎂쎃쎅쎆쎇쎉쎊쎋쎍쎎쎏쎐쎑쎒쎓쎔쎕쎖쎗쎘쎙쎚쎛쎜쎝쎞쎟쎠쎡쎢쎣쎤쎥쎦쎧쎨쎩쎪쎫쎬쎭쎮쎯쎰쎱쎲쎳쎴쎵쎶쎷쎸쎹쎺쎻쎼쎽쎾쎿쏁쏂쏃쏄쏅쏆쏇쏈쏉쏊쏋쏌쏍쏎쏏쏐쏑쏒쏓쏔쏕쏖쏗쏚").add(6912,"쏛쏝쏞쏡쏣쏤쏥쏦쏧쏪쏫쏬쏮쏯쏰쏱쏲쏳쏶쏷쏹쏺쏻쏼쏽쏾").add(6944,"쏿쐀쐁쐂쐃쐄쐅쐆쐇쐉쐊쐋쐌쐍쐎쐏쐑쐒쐓쐔쐕쐖쐗쐘쐙쐚").add(6976,"쐛쐜쐝쐞쐟쐠쐡쐢쐣쐥쐦쐧쐨쐩쐪쐫쐭쐮쐯쐱쐲쐳쐵쐶쐷쐸쐹쐺쐻쐾쐿쑀쑁쑂쑃쑄쑅쑆쑇쑉쑊쑋쑌쑍쑎쑏쑐쑑쑒쑓쑔쑕쑖쑗쑘쑙쑚쑛쑜쑝쑞쑟쑠쑡쑢쑣쑦쑧쑩쑪쑫쑭쑮쑯쑰쑱쑲쑳쑶쑷쑸쑺쑻쑼쑽쑾쑿쒁쒂쒃쒄쒅쒆쒇쒈쒉쒊쒋쒌쒍쒎쒏쒐쒑쒒쒓쒕쒖쒗쒘쒙쒚쒛쒝쒞쒟쒠쒡쒢쒣쒤쒥쒦쒧쒨쒩").add(7168,"쒪쒫쒬쒭쒮쒯쒰쒱쒲쒳쒴쒵쒶쒷쒹쒺쒻쒽쒾쒿쓀쓁쓂쓃쓄쓅").add(7200,"쓆쓇쓈쓉쓊쓋쓌쓍쓎쓏쓐쓑쓒쓓쓔쓕쓖쓗쓘쓙쓚쓛쓜쓝쓞쓟").add(7232,"쓠쓡쓢쓣쓤쓥쓦쓧쓨쓪쓫쓬쓭쓮쓯쓲쓳쓵쓶쓷쓹쓻쓼쓽쓾씂씃씄씅씆씇씈씉씊씋씍씎씏씑씒씓씕씖씗씘씙씚씛씝씞씟씠씡씢씣씤씥씦씧씪씫씭씮씯씱씲씳씴씵씶씷씺씼씾씿앀앁앂앃앆앇앋앏앐앑앒앖앚앛앜앟앢앣앥앦앧앩앪앫앬앭앮앯앲앶앷앸앹앺앻앾앿얁얂얃얅얆얈얉얊얋얎얐얒얓얔").add(7424,"얖얙얚얛얝얞얟얡얢얣얤얥얦얧얨얪얫얬얭얮얯얰얱얲얳얶").add(7456,"얷얺얿엀엁엂엃엋엍엏엒엓엕엖엗엙엚엛엜엝엞엟엢엤엦엧").add(7488,"엨엩엪엫엯엱엲엳엵엸엹엺엻옂옃옄옉옊옋옍옎옏옑옒옓옔옕옖옗옚옝옞옟옠옡옢옣옦옧옩옪옫옯옱옲옶옸옺옼옽옾옿왂왃왅왆왇왉왊왋왌왍왎왏왒왖왗왘왙왚왛왞왟왡왢왣왤왥왦왧왨왩왪왫왭왮왰왲왳왴왵왶왷왺왻왽왾왿욁욂욃욄욅욆욇욊욌욎욏욐욑욒욓욖욗욙욚욛욝욞욟욠욡욢욣욦").add(7680,"욨욪욫욬욭욮욯욲욳욵욶욷욻욼욽욾욿웂웄웆웇웈웉웊웋웎").add(7712,"웏웑웒웓웕웖웗웘웙웚웛웞웟웢웣웤웥웦웧웪웫웭웮웯웱웲").add(7744,"웳웴웵웶웷웺웻웼웾웿윀윁윂윃윆윇윉윊윋윍윎윏윐윑윒윓윖윘윚윛윜윝윞윟윢윣윥윦윧윩윪윫윬윭윮윯윲윴윶윸윹윺윻윾윿읁읂읃읅읆읇읈읉읋읎읐읙읚읛읝읞읟읡읢읣읤읥읦읧읩읪읬읭읮읯읰읱읲읳읶읷읹읺읻읿잀잁잂잆잋잌잍잏잒잓잕잙잛잜잝잞잟잢잧잨잩잪잫잮잯잱잲잳잵잶잷").add(7936,"잸잹잺잻잾쟂쟃쟄쟅쟆쟇쟊쟋쟍쟏쟑쟒쟓쟔쟕쟖쟗쟙쟚쟛쟜").add(7968,"쟞쟟쟠쟡쟢쟣쟥쟦쟧쟩쟪쟫쟭쟮쟯쟰쟱쟲쟳쟴쟵쟶쟷쟸쟹쟺").add(8e3,"쟻쟼쟽쟾쟿젂젃젅젆젇젉젋젌젍젎젏젒젔젗젘젙젚젛젞젟젡젢젣젥젦젧젨젩젪젫젮젰젲젳젴젵젶젷젹젺젻젽젾젿졁졂졃졄졅졆졇졊졋졎졏졐졑졒졓졕졖졗졘졙졚졛졜졝졞졟졠졡졢졣졤졥졦졧졨졩졪졫졬졭졮졯졲졳졵졶졷졹졻졼졽졾졿좂좄좈좉좊좎좏좐좑좒좓좕좖좗좘좙좚좛좜좞좠좢좣좤").add(8192,"좥좦좧좩좪좫좬좭좮좯좰좱좲좳좴좵좶좷좸좹좺좻좾좿죀죁").add(8224,"죂죃죅죆죇죉죊죋죍죎죏죐죑죒죓죖죘죚죛죜죝죞죟죢죣죥").add(8256,"죦죧죨죩죪죫죬죭죮죯죰죱죲죳죴죶죷죸죹죺죻죾죿줁줂줃줇줈줉줊줋줎　、。·‥…¨〃­―∥＼∼‘’“”〔〕〈〉《》「」『』【】±×÷≠≤≥∞∴°′″℃Å￠￡￥♂♀∠⊥⌒∂∇≡≒§※☆★○●◎◇◆□■△▲▽▼→←↑↓↔〓≪≫√∽∝∵∫∬∈∋⊆⊇⊂⊃∪∩∧∨￢").add(8448,"줐줒줓줔줕줖줗줙줚줛줜줝줞줟줠줡줢줣줤줥줦줧줨줩줪줫").add(8480,"줭줮줯줰줱줲줳줵줶줷줸줹줺줻줼줽줾줿쥀쥁쥂쥃쥄쥅쥆쥇").add(8512,"쥈쥉쥊쥋쥌쥍쥎쥏쥒쥓쥕쥖쥗쥙쥚쥛쥜쥝쥞쥟쥢쥤쥥쥦쥧쥨쥩쥪쥫쥭쥮쥯⇒⇔∀∃´～ˇ˘˝˚˙¸˛¡¿ː∮∑∏¤℉‰◁◀▷▶♤♠♡♥♧♣⊙◈▣◐◑▒▤▥▨▧▦▩♨☏☎☜☞¶†‡↕↗↙↖↘♭♩♪♬㉿㈜№㏇™㏂㏘℡€®").add(8704,"쥱쥲쥳쥵쥶쥷쥸쥹쥺쥻쥽쥾쥿즀즁즂즃즄즅즆즇즊즋즍즎즏").add(8736,"즑즒즓즔즕즖즗즚즜즞즟즠즡즢즣즤즥즦즧즨즩즪즫즬즭즮").add(8768,"즯즰즱즲즳즴즵즶즷즸즹즺즻즼즽즾즿짂짃짅짆짉짋짌짍짎짏짒짔짗짘짛！＂＃＄％＆＇（）＊＋，－．／０１２３４５６７８９：；＜＝＞？＠ＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺ［￦］＾＿｀ａｂｃｄｅｆｇｈｉｊｋｌｍｎｏｐｑｒｓｔｕｖｗｘｙｚ｛｜｝￣").add(8960,"짞짟짡짣짥짦짨짩짪짫짮짲짳짴짵짶짷짺짻짽짾짿쨁쨂쨃쨄").add(8992,"쨅쨆쨇쨊쨎쨏쨐쨑쨒쨓쨕쨖쨗쨙쨚쨛쨜쨝쨞쨟쨠쨡쨢쨣쨤쨥").add(9024,"쨦쨧쨨쨪쨫쨬쨭쨮쨯쨰쨱쨲쨳쨴쨵쨶쨷쨸쨹쨺쨻쨼쨽쨾쨿쩀쩁쩂쩃쩄쩅쩆ㄱㄲㄳㄴㄵㄶㄷㄸㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅃㅄㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎㅏㅐㅑㅒㅓㅔㅕㅖㅗㅘㅙㅚㅛㅜㅝㅞㅟㅠㅡㅢㅣㅤㅥㅦㅧㅨㅩㅪㅫㅬㅭㅮㅯㅰㅱㅲㅳㅴㅵㅶㅷㅸㅹㅺㅻㅼㅽㅾㅿㆀㆁㆂㆃㆄㆅㆆㆇㆈㆉㆊㆋㆌㆍㆎ").add(9216,"쩇쩈쩉쩊쩋쩎쩏쩑쩒쩓쩕쩖쩗쩘쩙쩚쩛쩞쩢쩣쩤쩥쩦쩧쩩쩪").add(9248,"쩫쩬쩭쩮쩯쩰쩱쩲쩳쩴쩵쩶쩷쩸쩹쩺쩻쩼쩾쩿쪀쪁쪂쪃쪅쪆").add(9280,"쪇쪈쪉쪊쪋쪌쪍쪎쪏쪐쪑쪒쪓쪔쪕쪖쪗쪙쪚쪛쪜쪝쪞쪟쪠쪡쪢쪣쪤쪥쪦쪧ⅰⅱⅲⅳⅴⅵⅶⅷⅸⅹ").add(9327,"ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩ").add(9344,"ΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩ").add(9376,"αβγδεζηθικλμνξοπρστυφχψω").add(9472,"쪨쪩쪪쪫쪬쪭쪮쪯쪰쪱쪲쪳쪴쪵쪶쪷쪸쪹쪺쪻쪾쪿쫁쫂쫃쫅").add(9504,"쫆쫇쫈쫉쫊쫋쫎쫐쫒쫔쫕쫖쫗쫚쫛쫜쫝쫞쫟쫡쫢쫣쫤쫥쫦쫧").add(9536,"쫨쫩쫪쫫쫭쫮쫯쫰쫱쫲쫳쫵쫶쫷쫸쫹쫺쫻쫼쫽쫾쫿쬀쬁쬂쬃쬄쬅쬆쬇쬉쬊─│┌┐┘└├┬┤┴┼━┃┏┓┛┗┣┳┫┻╋┠┯┨┷┿┝┰┥┸╂┒┑┚┙┖┕┎┍┞┟┡┢┦┧┩┪┭┮┱┲┵┶┹┺┽┾╀╁╃╄╅╆╇╈╉╊").add(9728,"쬋쬌쬍쬎쬏쬑쬒쬓쬕쬖쬗쬙쬚쬛쬜쬝쬞쬟쬢쬣쬤쬥쬦쬧쬨쬩").add(9760,"쬪쬫쬬쬭쬮쬯쬰쬱쬲쬳쬴쬵쬶쬷쬸쬹쬺쬻쬼쬽쬾쬿쭀쭂쭃쭄").add(9792,"쭅쭆쭇쭊쭋쭍쭎쭏쭑쭒쭓쭔쭕쭖쭗쭚쭛쭜쭞쭟쭠쭡쭢쭣쭥쭦쭧쭨쭩쭪쭫쭬㎕㎖㎗ℓ㎘㏄㎣㎤㎥㎦㎙㎚㎛㎜㎝㎞㎟㎠㎡㎢㏊㎍㎎㎏㏏㎈㎉㏈㎧㎨㎰㎱㎲㎳㎴㎵㎶㎷㎸㎹㎀㎁㎂㎃㎄㎺㎻㎼㎽㎾㎿㎐㎑㎒㎓㎔Ω㏀㏁㎊㎋㎌㏖㏅㎭㎮㎯㏛㎩㎪㎫㎬㏝㏐㏓㏃㏉㏜㏆").add(9984,"쭭쭮쭯쭰쭱쭲쭳쭴쭵쭶쭷쭺쭻쭼쭽쭾쭿쮀쮁쮂쮃쮄쮅쮆쮇쮈").add(10016,"쮉쮊쮋쮌쮍쮎쮏쮐쮑쮒쮓쮔쮕쮖쮗쮘쮙쮚쮛쮝쮞쮟쮠쮡쮢쮣").add(10048,"쮤쮥쮦쮧쮨쮩쮪쮫쮬쮭쮮쮯쮰쮱쮲쮳쮴쮵쮶쮷쮹쮺쮻쮼쮽쮾쮿쯀쯁쯂쯃쯄ÆÐªĦ").add(10085,"Ĳ").add(10087,"ĿŁØŒºÞŦŊ").add(10096,"㉠㉡㉢㉣㉤㉥㉦㉧㉨㉩㉪㉫㉬㉭㉮㉯㉰㉱㉲㉳㉴㉵㉶㉷㉸㉹㉺㉻ⓐⓑⓒⓓⓔⓕⓖⓗⓘⓙⓚⓛⓜⓝⓞⓟⓠⓡⓢⓣⓤⓥⓦⓧⓨⓩ①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮½⅓⅔¼¾⅛⅜⅝⅞").add(10240,"쯅쯆쯇쯈쯉쯊쯋쯌쯍쯎쯏쯐쯑쯒쯓쯕쯖쯗쯘쯙쯚쯛쯜쯝쯞쯟").add(10272,"쯠쯡쯢쯣쯥쯦쯨쯪쯫쯬쯭쯮쯯쯰쯱쯲쯳쯴쯵쯶쯷쯸쯹쯺쯻쯼").add(10304,"쯽쯾쯿찀찁찂찃찄찅찆찇찈찉찊찋찎찏찑찒찓찕찖찗찘찙찚찛찞찟찠찣찤æđðħıĳĸŀłøœßþŧŋŉ㈀㈁㈂㈃㈄㈅㈆㈇㈈㈉㈊㈋㈌㈍㈎㈏㈐㈑㈒㈓㈔㈕㈖㈗㈘㈙㈚㈛⒜⒝⒞⒟⒠⒡⒢⒣⒤⒥⒦⒧⒨⒩⒪⒫⒬⒭⒮⒯⒰⒱⒲⒳⒴⒵⑴⑵⑶⑷⑸⑹⑺⑻⑼⑽⑾⑿⒀⒁⒂¹²³⁴ⁿ₁₂₃₄").add(10496,"찥찦찪찫찭찯찱찲찳찴찵찶찷찺찿챀챁챂챃챆챇챉챊챋챍챎").add(10528,"챏챐챑챒챓챖챚챛챜챝챞챟챡챢챣챥챧챩챪챫챬챭챮챯챱챲").add(10560,"챳챴챶챷챸챹챺챻챼챽챾챿첀첁첂첃첄첅첆첇첈첉첊첋첌첍첎첏첐첑첒첓ぁあぃいぅうぇえぉおかがきぎくぐけげこごさざしじすずせぜそぞただちぢっつづてでとどなにぬねのはばぱひびぴふぶぷへべぺほぼぽまみむめもゃやゅゆょよらりるれろゎわゐゑをん").add(10752,"첔첕첖첗첚첛첝첞첟첡첢첣첤첥첦첧첪첮첯첰첱첲첳첶첷첹").add(10784,"첺첻첽첾첿쳀쳁쳂쳃쳆쳈쳊쳋쳌쳍쳎쳏쳑쳒쳓쳕쳖쳗쳘쳙쳚").add(10816,"쳛쳜쳝쳞쳟쳠쳡쳢쳣쳥쳦쳧쳨쳩쳪쳫쳭쳮쳯쳱쳲쳳쳴쳵쳶쳷쳸쳹쳺쳻쳼쳽ァアィイゥウェエォオカガキギクグケゲコゴサザシジスズセゼソゾタダチヂッツヅテデトドナニヌネノハバパヒビピフブプヘベペホボポマミムメモャヤュユョヨラリルレロヮワヰヱヲンヴヵヶ").add(11008,"쳾쳿촀촂촃촄촅촆촇촊촋촍촎촏촑촒촓촔촕촖촗촚촜촞촟촠").add(11040,"촡촢촣촥촦촧촩촪촫촭촮촯촰촱촲촳촴촵촶촷촸촺촻촼촽촾").add(11072,"촿쵀쵁쵂쵃쵄쵅쵆쵇쵈쵉쵊쵋쵌쵍쵎쵏쵐쵑쵒쵓쵔쵕쵖쵗쵘쵙쵚쵛쵝쵞쵟АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ").add(11152,"абвгдеёжзийклмнопрстуфхцчшщъыьэюя").add(11264,"쵡쵢쵣쵥쵦쵧쵨쵩쵪쵫쵮쵰쵲쵳쵴쵵쵶쵷쵹쵺쵻쵼쵽쵾쵿춀").add(11296,"춁춂춃춄춅춆춇춉춊춋춌춍춎춏춐춑춒춓춖춗춙춚춛춝춞춟").add(11328,"춠춡춢춣춦춨춪춫춬춭춮춯춱춲춳춴춵춶춷춸춹춺춻춼춽춾춿췀췁췂췃췅").add(11520,"췆췇췈췉췊췋췍췎췏췑췒췓췔췕췖췗췘췙췚췛췜췝췞췟췠췡").add(11552,"췢췣췤췥췦췧췩췪췫췭췮췯췱췲췳췴췵췶췷췺췼췾췿츀츁츂").add(11584,"츃츅츆츇츉츊츋츍츎츏츐츑츒츓츕츖츗츘츚츛츜츝츞츟츢츣츥츦츧츩츪츫").add(11776,"츬츭츮츯츲츴츶츷츸츹츺츻츼츽츾츿칀칁칂칃칄칅칆칇칈칉").add(11808,"칊칋칌칍칎칏칐칑칒칓칔칕칖칗칚칛칝칞칢칣칤칥칦칧칪칬").add(11840,"칮칯칰칱칲칳칶칷칹칺칻칽칾칿캀캁캂캃캆캈캊캋캌캍캎캏캒캓캕캖캗캙").add(12032,"캚캛캜캝캞캟캢캦캧캨캩캪캫캮캯캰캱캲캳캴캵캶캷캸캹캺").add(12064,"캻캼캽캾캿컀컂컃컄컅컆컇컈컉컊컋컌컍컎컏컐컑컒컓컔컕").add(12096,"컖컗컘컙컚컛컜컝컞컟컠컡컢컣컦컧컩컪컭컮컯컰컱컲컳컶컺컻컼컽컾컿가각간갇갈갉갊감갑값갓갔강갖갗같갚갛개객갠갤갬갭갯갰갱갸갹갼걀걋걍걔걘걜거걱건걷걸걺검겁것겄겅겆겉겊겋게겐겔겜겝겟겠겡겨격겪견겯결겸겹겻겼경곁계곈곌곕곗고곡곤곧골곪곬곯곰곱곳공곶과곽관괄괆").add(12288,"켂켃켅켆켇켉켊켋켌켍켎켏켒켔켖켗켘켙켚켛켝켞켟켡켢켣").add(12320,"켥켦켧켨켩켪켫켮켲켳켴켵켶켷켹켺켻켼켽켾켿콀콁콂콃콄").add(12352,"콅콆콇콈콉콊콋콌콍콎콏콐콑콒콓콖콗콙콚콛콝콞콟콠콡콢콣콦콨콪콫콬괌괍괏광괘괜괠괩괬괭괴괵괸괼굄굅굇굉교굔굘굡굣구국군굳굴굵굶굻굼굽굿궁궂궈궉권궐궜궝궤궷귀귁귄귈귐귑귓규균귤그극근귿글긁금급긋긍긔기긱긴긷길긺김깁깃깅깆깊까깍깎깐깔깖깜깝깟깠깡깥깨깩깬깰깸").add(12544,"콭콮콯콲콳콵콶콷콹콺콻콼콽콾콿쾁쾂쾃쾄쾆쾇쾈쾉쾊쾋쾍").add(12576,"쾎쾏쾐쾑쾒쾓쾔쾕쾖쾗쾘쾙쾚쾛쾜쾝쾞쾟쾠쾢쾣쾤쾥쾦쾧쾩").add(12608,"쾪쾫쾬쾭쾮쾯쾱쾲쾳쾴쾵쾶쾷쾸쾹쾺쾻쾼쾽쾾쾿쿀쿁쿂쿃쿅쿆쿇쿈쿉쿊쿋깹깻깼깽꺄꺅꺌꺼꺽꺾껀껄껌껍껏껐껑께껙껜껨껫껭껴껸껼꼇꼈꼍꼐꼬꼭꼰꼲꼴꼼꼽꼿꽁꽂꽃꽈꽉꽐꽜꽝꽤꽥꽹꾀꾄꾈꾐꾑꾕꾜꾸꾹꾼꿀꿇꿈꿉꿋꿍꿎꿔꿜꿨꿩꿰꿱꿴꿸뀀뀁뀄뀌뀐뀔뀜뀝뀨끄끅끈끊끌끎끓끔끕끗끙").add(12800,"쿌쿍쿎쿏쿐쿑쿒쿓쿔쿕쿖쿗쿘쿙쿚쿛쿜쿝쿞쿟쿢쿣쿥쿦쿧쿩").add(12832,"쿪쿫쿬쿭쿮쿯쿲쿴쿶쿷쿸쿹쿺쿻쿽쿾쿿퀁퀂퀃퀅퀆퀇퀈퀉퀊").add(12864,"퀋퀌퀍퀎퀏퀐퀒퀓퀔퀕퀖퀗퀙퀚퀛퀜퀝퀞퀟퀠퀡퀢퀣퀤퀥퀦퀧퀨퀩퀪퀫퀬끝끼끽낀낄낌낍낏낑나낙낚난낟날낡낢남납낫났낭낮낯낱낳내낵낸낼냄냅냇냈냉냐냑냔냘냠냥너넉넋넌널넒넓넘넙넛넜넝넣네넥넨넬넴넵넷넸넹녀녁년녈념녑녔녕녘녜녠노녹논놀놂놈놉놋농높놓놔놘놜놨뇌뇐뇔뇜뇝").add(13056,"퀮퀯퀰퀱퀲퀳퀶퀷퀹퀺퀻퀽퀾퀿큀큁큂큃큆큈큊큋큌큍큎큏").add(13088,"큑큒큓큕큖큗큙큚큛큜큝큞큟큡큢큣큤큥큦큧큨큩큪큫큮큯").add(13120,"큱큲큳큵큶큷큸큹큺큻큾큿킀킂킃킄킅킆킇킈킉킊킋킌킍킎킏킐킑킒킓킔뇟뇨뇩뇬뇰뇹뇻뇽누눅눈눋눌눔눕눗눙눠눴눼뉘뉜뉠뉨뉩뉴뉵뉼늄늅늉느늑는늘늙늚늠늡늣능늦늪늬늰늴니닉닌닐닒님닙닛닝닢다닥닦단닫달닭닮닯닳담답닷닸당닺닻닿대댁댄댈댐댑댓댔댕댜더덕덖던덛덜덞덟덤덥").add(13312,"킕킖킗킘킙킚킛킜킝킞킟킠킡킢킣킦킧킩킪킫킭킮킯킰킱킲").add(13344,"킳킶킸킺킻킼킽킾킿탂탃탅탆탇탊탋탌탍탎탏탒탖탗탘탙탚").add(13376,"탛탞탟탡탢탣탥탦탧탨탩탪탫탮탲탳탴탵탶탷탹탺탻탼탽탾탿턀턁턂턃턄덧덩덫덮데덱덴델뎀뎁뎃뎄뎅뎌뎐뎔뎠뎡뎨뎬도독돈돋돌돎돐돔돕돗동돛돝돠돤돨돼됐되된될됨됩됫됴두둑둔둘둠둡둣둥둬뒀뒈뒝뒤뒨뒬뒵뒷뒹듀듄듈듐듕드득든듣들듦듬듭듯등듸디딕딘딛딜딤딥딧딨딩딪따딱딴딸").add(13568,"턅턆턇턈턉턊턋턌턎턏턐턑턒턓턔턕턖턗턘턙턚턛턜턝턞턟").add(13600,"턠턡턢턣턤턥턦턧턨턩턪턫턬턭턮턯턲턳턵턶턷턹턻턼턽턾").add(13632,"턿텂텆텇텈텉텊텋텎텏텑텒텓텕텖텗텘텙텚텛텞텠텢텣텤텥텦텧텩텪텫텭땀땁땃땄땅땋때땍땐땔땜땝땟땠땡떠떡떤떨떪떫떰떱떳떴떵떻떼떽뗀뗄뗌뗍뗏뗐뗑뗘뗬또똑똔똘똥똬똴뙈뙤뙨뚜뚝뚠뚤뚫뚬뚱뛔뛰뛴뛸뜀뜁뜅뜨뜩뜬뜯뜰뜸뜹뜻띄띈띌띔띕띠띤띨띰띱띳띵라락란랄람랍랏랐랑랒랖랗").add(13824,"텮텯텰텱텲텳텴텵텶텷텸텹텺텻텽텾텿톀톁톂톃톅톆톇톉톊").add(13856,"톋톌톍톎톏톐톑톒톓톔톕톖톗톘톙톚톛톜톝톞톟톢톣톥톦톧").add(13888,"톩톪톫톬톭톮톯톲톴톶톷톸톹톻톽톾톿퇁퇂퇃퇄퇅퇆퇇퇈퇉퇊퇋퇌퇍퇎퇏래랙랜랠램랩랫랬랭랴략랸럇량러럭런럴럼럽럿렀렁렇레렉렌렐렘렙렛렝려력련렬렴렵렷렸령례롄롑롓로록론롤롬롭롯롱롸롼뢍뢨뢰뢴뢸룀룁룃룅료룐룔룝룟룡루룩룬룰룸룹룻룽뤄뤘뤠뤼뤽륀륄륌륏륑류륙륜률륨륩").add(14080,"퇐퇑퇒퇓퇔퇕퇖퇗퇙퇚퇛퇜퇝퇞퇟퇠퇡퇢퇣퇤퇥퇦퇧퇨퇩퇪").add(14112,"퇫퇬퇭퇮퇯퇰퇱퇲퇳퇵퇶퇷퇹퇺퇻퇼퇽퇾퇿툀툁툂툃툄툅툆").add(14144,"툈툊툋툌툍툎툏툑툒툓툔툕툖툗툘툙툚툛툜툝툞툟툠툡툢툣툤툥툦툧툨툩륫륭르륵른를름릅릇릉릊릍릎리릭린릴림립릿링마막만많맏말맑맒맘맙맛망맞맡맣매맥맨맬맴맵맷맸맹맺먀먁먈먕머먹먼멀멂멈멉멋멍멎멓메멕멘멜멤멥멧멨멩며멱면멸몃몄명몇몌모목몫몬몰몲몸몹못몽뫄뫈뫘뫙뫼").add(14336,"툪툫툮툯툱툲툳툵툶툷툸툹툺툻툾퉀퉂퉃퉄퉅퉆퉇퉉퉊퉋퉌").add(14368,"퉍퉎퉏퉐퉑퉒퉓퉔퉕퉖퉗퉘퉙퉚퉛퉝퉞퉟퉠퉡퉢퉣퉥퉦퉧퉨").add(14400,"퉩퉪퉫퉬퉭퉮퉯퉰퉱퉲퉳퉴퉵퉶퉷퉸퉹퉺퉻퉼퉽퉾퉿튂튃튅튆튇튉튊튋튌묀묄묍묏묑묘묜묠묩묫무묵묶문묻물묽묾뭄뭅뭇뭉뭍뭏뭐뭔뭘뭡뭣뭬뮈뮌뮐뮤뮨뮬뮴뮷므믄믈믐믓미믹민믿밀밂밈밉밋밌밍및밑바박밖밗반받발밝밞밟밤밥밧방밭배백밴밸뱀뱁뱃뱄뱅뱉뱌뱍뱐뱝버벅번벋벌벎범법벗").add(14592,"튍튎튏튒튓튔튖튗튘튙튚튛튝튞튟튡튢튣튥튦튧튨튩튪튫튭").add(14624,"튮튯튰튲튳튴튵튶튷튺튻튽튾틁틃틄틅틆틇틊틌틍틎틏틐틑").add(14656,"틒틓틕틖틗틙틚틛틝틞틟틠틡틢틣틦틧틨틩틪틫틬틭틮틯틲틳틵틶틷틹틺벙벚베벡벤벧벨벰벱벳벴벵벼벽변별볍볏볐병볕볘볜보복볶본볼봄봅봇봉봐봔봤봬뵀뵈뵉뵌뵐뵘뵙뵤뵨부북분붇불붉붊붐붑붓붕붙붚붜붤붰붸뷔뷕뷘뷜뷩뷰뷴뷸븀븃븅브븍븐블븜븝븟비빅빈빌빎빔빕빗빙빚빛빠빡빤").add(14848,"틻틼틽틾틿팂팄팆팇팈팉팊팋팏팑팒팓팕팗팘팙팚팛팞팢팣").add(14880,"팤팦팧팪팫팭팮팯팱팲팳팴팵팶팷팺팾팿퍀퍁퍂퍃퍆퍇퍈퍉").add(14912,"퍊퍋퍌퍍퍎퍏퍐퍑퍒퍓퍔퍕퍖퍗퍘퍙퍚퍛퍜퍝퍞퍟퍠퍡퍢퍣퍤퍥퍦퍧퍨퍩빨빪빰빱빳빴빵빻빼빽뺀뺄뺌뺍뺏뺐뺑뺘뺙뺨뻐뻑뻔뻗뻘뻠뻣뻤뻥뻬뼁뼈뼉뼘뼙뼛뼜뼝뽀뽁뽄뽈뽐뽑뽕뾔뾰뿅뿌뿍뿐뿔뿜뿟뿡쀼쁑쁘쁜쁠쁨쁩삐삑삔삘삠삡삣삥사삭삯산삳살삵삶삼삽삿샀상샅새색샌샐샘샙샛샜생샤").add(15104,"퍪퍫퍬퍭퍮퍯퍰퍱퍲퍳퍴퍵퍶퍷퍸퍹퍺퍻퍾퍿펁펂펃펅펆펇").add(15136,"펈펉펊펋펎펒펓펔펕펖펗펚펛펝펞펟펡펢펣펤펥펦펧펪펬펮").add(15168,"펯펰펱펲펳펵펶펷펹펺펻펽펾펿폀폁폂폃폆폇폊폋폌폍폎폏폑폒폓폔폕폖샥샨샬샴샵샷샹섀섄섈섐섕서석섞섟선섣설섦섧섬섭섯섰성섶세섹센셀셈셉셋셌셍셔셕션셜셤셥셧셨셩셰셴셸솅소속솎손솔솖솜솝솟송솥솨솩솬솰솽쇄쇈쇌쇔쇗쇘쇠쇤쇨쇰쇱쇳쇼쇽숀숄숌숍숏숑수숙순숟술숨숩숫숭").add(15360,"폗폙폚폛폜폝폞폟폠폢폤폥폦폧폨폩폪폫폮폯폱폲폳폵폶폷").add(15392,"폸폹폺폻폾퐀퐂퐃퐄퐅퐆퐇퐉퐊퐋퐌퐍퐎퐏퐐퐑퐒퐓퐔퐕퐖").add(15424,"퐗퐘퐙퐚퐛퐜퐞퐟퐠퐡퐢퐣퐤퐥퐦퐧퐨퐩퐪퐫퐬퐭퐮퐯퐰퐱퐲퐳퐴퐵퐶퐷숯숱숲숴쉈쉐쉑쉔쉘쉠쉥쉬쉭쉰쉴쉼쉽쉿슁슈슉슐슘슛슝스슥슨슬슭슴습슷승시식신싣실싫심십싯싱싶싸싹싻싼쌀쌈쌉쌌쌍쌓쌔쌕쌘쌜쌤쌥쌨쌩썅써썩썬썰썲썸썹썼썽쎄쎈쎌쏀쏘쏙쏜쏟쏠쏢쏨쏩쏭쏴쏵쏸쐈쐐쐤쐬쐰").add(15616,"퐸퐹퐺퐻퐼퐽퐾퐿푁푂푃푅푆푇푈푉푊푋푌푍푎푏푐푑푒푓").add(15648,"푔푕푖푗푘푙푚푛푝푞푟푡푢푣푥푦푧푨푩푪푫푬푮푰푱푲").add(15680,"푳푴푵푶푷푺푻푽푾풁풃풄풅풆풇풊풌풎풏풐풑풒풓풕풖풗풘풙풚풛풜풝쐴쐼쐽쑈쑤쑥쑨쑬쑴쑵쑹쒀쒔쒜쒸쒼쓩쓰쓱쓴쓸쓺쓿씀씁씌씐씔씜씨씩씬씰씸씹씻씽아악안앉않알앍앎앓암압앗았앙앝앞애액앤앨앰앱앳앴앵야약얀얄얇얌얍얏양얕얗얘얜얠얩어억언얹얻얼얽얾엄업없엇었엉엊엌엎").add(15872,"풞풟풠풡풢풣풤풥풦풧풨풪풫풬풭풮풯풰풱풲풳풴풵풶풷풸").add(15904,"풹풺풻풼풽풾풿퓀퓁퓂퓃퓄퓅퓆퓇퓈퓉퓊퓋퓍퓎퓏퓑퓒퓓퓕").add(15936,"퓖퓗퓘퓙퓚퓛퓝퓞퓠퓡퓢퓣퓤퓥퓦퓧퓩퓪퓫퓭퓮퓯퓱퓲퓳퓴퓵퓶퓷퓹퓺퓼에엑엔엘엠엡엣엥여역엮연열엶엷염엽엾엿였영옅옆옇예옌옐옘옙옛옜오옥온올옭옮옰옳옴옵옷옹옻와왁완왈왐왑왓왔왕왜왝왠왬왯왱외왹왼욀욈욉욋욍요욕욘욜욤욥욧용우욱운울욹욺움웁웃웅워웍원월웜웝웠웡웨").add(16128,"퓾퓿픀픁픂픃픅픆픇픉픊픋픍픎픏픐픑픒픓픖픘픙픚픛픜픝").add(16160,"픞픟픠픡픢픣픤픥픦픧픨픩픪픫픬픭픮픯픰픱픲픳픴픵픶픷").add(16192,"픸픹픺픻픾픿핁핂핃핅핆핇핈핉핊핋핎핐핒핓핔핕핖핗핚핛핝핞핟핡핢핣웩웬웰웸웹웽위윅윈윌윔윕윗윙유육윤율윰윱윳융윷으윽은을읊음읍읏응읒읓읔읕읖읗의읜읠읨읫이익인일읽읾잃임입잇있잉잊잎자작잔잖잗잘잚잠잡잣잤장잦재잭잰잴잼잽잿쟀쟁쟈쟉쟌쟎쟐쟘쟝쟤쟨쟬저적전절젊").add(16384,"핤핦핧핪핬핮핯핰핱핲핳핶핷핹핺핻핽핾핿햀햁햂햃햆햊햋").add(16416,"햌햍햎햏햑햒햓햔햕햖햗햘햙햚햛햜햝햞햟햠햡햢햣햤햦햧").add(16448,"햨햩햪햫햬햭햮햯햰햱햲햳햴햵햶햷햸햹햺햻햼햽햾햿헀헁헂헃헄헅헆헇점접젓정젖제젝젠젤젬젭젯젱져젼졀졈졉졌졍졔조족존졸졺좀좁좃종좆좇좋좌좍좔좝좟좡좨좼좽죄죈죌죔죕죗죙죠죡죤죵주죽준줄줅줆줌줍줏중줘줬줴쥐쥑쥔쥘쥠쥡쥣쥬쥰쥴쥼즈즉즌즐즘즙즛증지직진짇질짊짐집짓").add(16640,"헊헋헍헎헏헑헓헔헕헖헗헚헜헞헟헠헡헢헣헦헧헩헪헫헭헮").add(16672,"헯헰헱헲헳헶헸헺헻헼헽헾헿혂혃혅혆혇혉혊혋혌혍혎혏혒").add(16704,"혖혗혘혙혚혛혝혞혟혡혢혣혥혦혧혨혩혪혫혬혮혯혰혱혲혳혴혵혶혷혺혻징짖짙짚짜짝짠짢짤짧짬짭짯짰짱째짹짼쨀쨈쨉쨋쨌쨍쨔쨘쨩쩌쩍쩐쩔쩜쩝쩟쩠쩡쩨쩽쪄쪘쪼쪽쫀쫄쫌쫍쫏쫑쫓쫘쫙쫠쫬쫴쬈쬐쬔쬘쬠쬡쭁쭈쭉쭌쭐쭘쭙쭝쭤쭸쭹쮜쮸쯔쯤쯧쯩찌찍찐찔찜찝찡찢찧차착찬찮찰참찹찻").add(16896,"혽혾혿홁홂홃홄홆홇홊홌홎홏홐홒홓홖홗홙홚홛홝홞홟홠홡").add(16928,"홢홣홤홥홦홨홪홫홬홭홮홯홲홳홵홶홷홸홹홺홻홼홽홾홿횀").add(16960,"횁횂횄횆횇횈횉횊횋횎횏횑횒횓횕횖횗횘횙횚횛횜횞횠횢횣횤횥횦횧횩횪찼창찾채책챈챌챔챕챗챘챙챠챤챦챨챰챵처척천철첨첩첫첬청체첵첸첼쳄쳅쳇쳉쳐쳔쳤쳬쳰촁초촉촌촐촘촙촛총촤촨촬촹최쵠쵤쵬쵭쵯쵱쵸춈추축춘출춤춥춧충춰췄췌췐취췬췰췸췹췻췽츄츈츌츔츙츠측츤츨츰츱츳층").add(17152,"횫횭횮횯횱횲횳횴횵횶횷횸횺횼횽횾횿훀훁훂훃훆훇훉훊훋").add(17184,"훍훎훏훐훒훓훕훖훘훚훛훜훝훞훟훡훢훣훥훦훧훩훪훫훬훭").add(17216,"훮훯훱훲훳훴훶훷훸훹훺훻훾훿휁휂휃휅휆휇휈휉휊휋휌휍휎휏휐휒휓휔치칙친칟칠칡침칩칫칭카칵칸칼캄캅캇캉캐캑캔캘캠캡캣캤캥캬캭컁커컥컨컫컬컴컵컷컸컹케켁켄켈켐켑켓켕켜켠켤켬켭켯켰켱켸코콕콘콜콤콥콧콩콰콱콴콸쾀쾅쾌쾡쾨쾰쿄쿠쿡쿤쿨쿰쿱쿳쿵쿼퀀퀄퀑퀘퀭퀴퀵퀸퀼").add(17408,"휕휖휗휚휛휝휞휟휡휢휣휤휥휦휧휪휬휮휯휰휱휲휳휶휷휹").add(17440,"휺휻휽휾휿흀흁흂흃흅흆흈흊흋흌흍흎흏흒흓흕흚흛흜흝흞").add(17472,"흟흢흤흦흧흨흪흫흭흮흯흱흲흳흵흶흷흸흹흺흻흾흿힀힂힃힄힅힆힇힊힋큄큅큇큉큐큔큘큠크큭큰클큼큽킁키킥킨킬킴킵킷킹타탁탄탈탉탐탑탓탔탕태택탠탤탬탭탯탰탱탸턍터턱턴털턺텀텁텃텄텅테텍텐텔템텝텟텡텨텬텼톄톈토톡톤톨톰톱톳통톺톼퇀퇘퇴퇸툇툉툐투툭툰툴툼툽툿퉁퉈퉜").add(17664,"힍힎힏힑힒힓힔힕힖힗힚힜힞힟힠힡힢힣").add(17760,"퉤튀튁튄튈튐튑튕튜튠튤튬튱트특튼튿틀틂틈틉틋틔틘틜틤틥티틱틴틸팀팁팃팅파팍팎판팔팖팜팝팟팠팡팥패팩팬팰팸팹팻팼팽퍄퍅퍼퍽펀펄펌펍펏펐펑페펙펜펠펨펩펫펭펴편펼폄폅폈평폐폘폡폣포폭폰폴폼폽폿퐁").add(18016,"퐈퐝푀푄표푠푤푭푯푸푹푼푿풀풂품풉풋풍풔풩퓌퓐퓔퓜퓟퓨퓬퓰퓸퓻퓽프픈플픔픕픗피픽핀필핌핍핏핑하학한할핥함합핫항해핵핸핼햄햅햇했행햐향허헉헌헐헒험헙헛헝헤헥헨헬헴헵헷헹혀혁현혈혐협혓혔형혜혠").add(18272,"혤혭호혹혼홀홅홈홉홋홍홑화확환활홧황홰홱홴횃횅회획횐횔횝횟횡효횬횰횹횻후훅훈훌훑훔훗훙훠훤훨훰훵훼훽휀휄휑휘휙휜휠휨휩휫휭휴휵휸휼흄흇흉흐흑흔흖흗흘흙흠흡흣흥흩희흰흴흼흽힁히힉힌힐힘힙힛힝").add(18784,"伽佳假價加可呵哥嘉嫁家暇架枷柯歌珂痂稼苛茄街袈訶賈跏軻迦駕刻却各恪慤殼珏脚覺角閣侃刊墾奸姦干幹懇揀杆柬桿澗癎看磵稈竿簡肝艮艱諫間乫喝曷渴碣竭葛褐蝎鞨勘坎堪嵌感憾戡敢柑橄減甘疳監瞰紺邯鑑鑒龕").add(19040,"匣岬甲胛鉀閘剛堈姜岡崗康强彊慷江畺疆糠絳綱羌腔舡薑襁講鋼降鱇介价個凱塏愷愾慨改槪漑疥皆盖箇芥蓋豈鎧開喀客坑更粳羹醵倨去居巨拒据據擧渠炬祛距踞車遽鉅鋸乾件健巾建愆楗腱虔蹇鍵騫乞傑杰桀儉劍劒檢").add(19296,"瞼鈐黔劫怯迲偈憩揭擊格檄激膈覡隔堅牽犬甄絹繭肩見譴遣鵑抉決潔結缺訣兼慊箝謙鉗鎌京俓倞傾儆勁勍卿坰境庚徑慶憬擎敬景暻更梗涇炅烱璟璥瓊痙硬磬竟競絅經耕耿脛莖警輕逕鏡頃頸驚鯨係啓堺契季屆悸戒桂械").add(19552,"棨溪界癸磎稽系繫繼計誡谿階鷄古叩告呱固姑孤尻庫拷攷故敲暠枯槁沽痼皐睾稿羔考股膏苦苽菰藁蠱袴誥賈辜錮雇顧高鼓哭斛曲梏穀谷鵠困坤崑昆梱棍滾琨袞鯤汨滑骨供公共功孔工恐恭拱控攻珙空蚣貢鞏串寡戈果瓜").add(19808,"科菓誇課跨過鍋顆廓槨藿郭串冠官寬慣棺款灌琯瓘管罐菅觀貫關館刮恝括适侊光匡壙廣曠洸炚狂珖筐胱鑛卦掛罫乖傀塊壞怪愧拐槐魁宏紘肱轟交僑咬喬嬌嶠巧攪敎校橋狡皎矯絞翹膠蕎蛟較轎郊餃驕鮫丘久九仇俱具勾").add(20064,"區口句咎嘔坵垢寇嶇廐懼拘救枸柩構歐毆毬求溝灸狗玖球瞿矩究絿耉臼舅舊苟衢謳購軀逑邱鉤銶駒驅鳩鷗龜國局菊鞠鞫麴君窘群裙軍郡堀屈掘窟宮弓穹窮芎躬倦券勸卷圈拳捲權淃眷厥獗蕨蹶闕机櫃潰詭軌饋句晷歸貴").add(20320,"鬼龜叫圭奎揆槻珪硅窺竅糾葵規赳逵閨勻均畇筠菌鈞龜橘克剋劇戟棘極隙僅劤勤懃斤根槿瑾筋芹菫覲謹近饉契今妗擒昑檎琴禁禽芩衾衿襟金錦伋及急扱汲級給亘兢矜肯企伎其冀嗜器圻基埼夔奇妓寄岐崎己幾忌技旗旣").add(20576,"朞期杞棋棄機欺氣汽沂淇玘琦琪璂璣畸畿碁磯祁祇祈祺箕紀綺羈耆耭肌記譏豈起錡錤飢饑騎騏驥麒緊佶吉拮桔金喫儺喇奈娜懦懶拏拿癩羅蘿螺裸邏那樂洛烙珞落諾酪駱亂卵暖欄煖爛蘭難鸞捏捺南嵐枏楠湳濫男藍襤拉").add(20832,"納臘蠟衲囊娘廊朗浪狼郎乃來內奈柰耐冷女年撚秊念恬拈捻寧寗努勞奴弩怒擄櫓爐瑙盧老蘆虜路露駑魯鷺碌祿綠菉錄鹿論壟弄濃籠聾膿農惱牢磊腦賂雷尿壘屢樓淚漏累縷陋嫩訥杻紐勒肋凜凌稜綾能菱陵尼泥匿溺多茶").add(21088,"丹亶但單團壇彖斷旦檀段湍短端簞緞蛋袒鄲鍛撻澾獺疸達啖坍憺擔曇淡湛潭澹痰聃膽蕁覃談譚錟沓畓答踏遝唐堂塘幢戇撞棠當糖螳黨代垈坮大對岱帶待戴擡玳臺袋貸隊黛宅德悳倒刀到圖堵塗導屠島嶋度徒悼挑掉搗桃").add(21344,"棹櫂淘渡滔濤燾盜睹禱稻萄覩賭跳蹈逃途道都鍍陶韜毒瀆牘犢獨督禿篤纛讀墩惇敦旽暾沌焞燉豚頓乭突仝冬凍動同憧東桐棟洞潼疼瞳童胴董銅兜斗杜枓痘竇荳讀豆逗頭屯臀芚遁遯鈍得嶝橙燈登等藤謄鄧騰喇懶拏癩羅").add(21600,"蘿螺裸邏樂洛烙珞絡落諾酪駱丹亂卵欄欒瀾爛蘭鸞剌辣嵐擥攬欖濫籃纜藍襤覽拉臘蠟廊朗浪狼琅瑯螂郞來崍徠萊冷掠略亮倆兩凉梁樑粮粱糧良諒輛量侶儷勵呂廬慮戾旅櫚濾礪藜蠣閭驢驪麗黎力曆歷瀝礫轢靂憐戀攣漣").add(21856,"煉璉練聯蓮輦連鍊冽列劣洌烈裂廉斂殮濂簾獵令伶囹寧岺嶺怜玲笭羚翎聆逞鈴零靈領齡例澧禮醴隷勞怒撈擄櫓潞瀘爐盧老蘆虜路輅露魯鷺鹵碌祿綠菉錄鹿麓論壟弄朧瀧瓏籠聾儡瀨牢磊賂賚賴雷了僚寮廖料燎療瞭聊蓼").add(22112,"遼鬧龍壘婁屢樓淚漏瘻累縷蔞褸鏤陋劉旒柳榴流溜瀏琉瑠留瘤硫謬類六戮陸侖倫崙淪綸輪律慄栗率隆勒肋凜凌楞稜綾菱陵俚利厘吏唎履悧李梨浬犁狸理璃異痢籬罹羸莉裏裡里釐離鯉吝潾燐璘藺躪隣鱗麟林淋琳臨霖砬").add(22368,"立笠粒摩瑪痲碼磨馬魔麻寞幕漠膜莫邈万卍娩巒彎慢挽晩曼滿漫灣瞞萬蔓蠻輓饅鰻唜抹末沫茉襪靺亡妄忘忙望網罔芒茫莽輞邙埋妹媒寐昧枚梅每煤罵買賣邁魅脈貊陌驀麥孟氓猛盲盟萌冪覓免冕勉棉沔眄眠綿緬面麵滅").add(22624,"蔑冥名命明暝椧溟皿瞑茗蓂螟酩銘鳴袂侮冒募姆帽慕摸摹暮某模母毛牟牡瑁眸矛耗芼茅謀謨貌木沐牧目睦穆鶩歿沒夢朦蒙卯墓妙廟描昴杳渺猫竗苗錨務巫憮懋戊拇撫无楙武毋無珷畝繆舞茂蕪誣貿霧鵡墨默們刎吻問文").add(22880,"汶紊紋聞蚊門雯勿沕物味媚尾嵋彌微未梶楣渼湄眉米美薇謎迷靡黴岷悶愍憫敏旻旼民泯玟珉緡閔密蜜謐剝博拍搏撲朴樸泊珀璞箔粕縛膊舶薄迫雹駁伴半反叛拌搬攀斑槃泮潘班畔瘢盤盼磐磻礬絆般蟠返頒飯勃拔撥渤潑").add(23136,"發跋醱鉢髮魃倣傍坊妨尨幇彷房放方旁昉枋榜滂磅紡肪膀舫芳蒡蚌訪謗邦防龐倍俳北培徘拜排杯湃焙盃背胚裴裵褙賠輩配陪伯佰帛柏栢白百魄幡樊煩燔番磻繁蕃藩飜伐筏罰閥凡帆梵氾汎泛犯範范法琺僻劈壁擘檗璧癖").add(23392,"碧蘗闢霹便卞弁變辨辯邊別瞥鱉鼈丙倂兵屛幷昞昺柄棅炳甁病秉竝輧餠騈保堡報寶普步洑湺潽珤甫菩補褓譜輔伏僕匐卜宓復服福腹茯蔔複覆輹輻馥鰒本乶俸奉封峯峰捧棒烽熢琫縫蓬蜂逢鋒鳳不付俯傅剖副否咐埠夫婦").add(23648,"孚孵富府復扶敷斧浮溥父符簿缶腐腑膚艀芙莩訃負賦賻赴趺部釜阜附駙鳧北分吩噴墳奔奮忿憤扮昐汾焚盆粉糞紛芬賁雰不佛弗彿拂崩朋棚硼繃鵬丕備匕匪卑妃婢庇悲憊扉批斐枇榧比毖毗毘沸泌琵痺砒碑秕秘粃緋翡肥").add(23904,"脾臂菲蜚裨誹譬費鄙非飛鼻嚬嬪彬斌檳殯浜濱瀕牝玭貧賓頻憑氷聘騁乍事些仕伺似使俟僿史司唆嗣四士奢娑寫寺射巳師徙思捨斜斯柶査梭死沙泗渣瀉獅砂社祀祠私篩紗絲肆舍莎蓑蛇裟詐詞謝賜赦辭邪飼駟麝削數朔索").add(24160,"傘刪山散汕珊産疝算蒜酸霰乷撒殺煞薩三參杉森渗芟蔘衫揷澁鈒颯上傷像償商喪嘗孀尙峠常床庠廂想桑橡湘爽牀狀相祥箱翔裳觴詳象賞霜塞璽賽嗇塞穡索色牲生甥省笙墅壻嶼序庶徐恕抒捿敍暑曙書栖棲犀瑞筮絮緖署").add(24416,"胥舒薯西誓逝鋤黍鼠夕奭席惜昔晳析汐淅潟石碩蓆釋錫仙僊先善嬋宣扇敾旋渲煽琁瑄璇璿癬禪線繕羨腺膳船蘚蟬詵跣選銑鐥饍鮮卨屑楔泄洩渫舌薛褻設說雪齧剡暹殲纖蟾贍閃陝攝涉燮葉城姓宬性惺成星晟猩珹盛省筬").add(24672,"聖聲腥誠醒世勢歲洗稅笹細說貰召嘯塑宵小少巢所掃搔昭梳沼消溯瀟炤燒甦疏疎瘙笑篠簫素紹蔬蕭蘇訴逍遡邵銷韶騷俗屬束涑粟續謖贖速孫巽損蓀遜飡率宋悚松淞訟誦送頌刷殺灑碎鎖衰釗修受嗽囚垂壽嫂守岫峀帥愁").add(24928,"戍手授搜收數樹殊水洙漱燧狩獸琇璲瘦睡秀穗竪粹綏綬繡羞脩茱蒐蓚藪袖誰讐輸遂邃酬銖銹隋隧隨雖需須首髓鬚叔塾夙孰宿淑潚熟琡璹肅菽巡徇循恂旬栒楯橓殉洵淳珣盾瞬筍純脣舜荀蓴蕣詢諄醇錞順馴戌術述鉥崇崧").add(25184,"嵩瑟膝蝨濕拾習褶襲丞乘僧勝升承昇繩蠅陞侍匙嘶始媤尸屎屍市弑恃施是時枾柴猜矢示翅蒔蓍視試詩諡豕豺埴寔式息拭植殖湜熄篒蝕識軾食飾伸侁信呻娠宸愼新晨燼申神紳腎臣莘薪藎蜃訊身辛辰迅失室實悉審尋心沁").add(25440,"沈深瀋甚芯諶什十拾雙氏亞俄兒啞娥峨我牙芽莪蛾衙訝阿雅餓鴉鵝堊岳嶽幄惡愕握樂渥鄂鍔顎鰐齷安岸按晏案眼雁鞍顔鮟斡謁軋閼唵岩巖庵暗癌菴闇壓押狎鴨仰央怏昻殃秧鴦厓哀埃崖愛曖涯碍艾隘靄厄扼掖液縊腋額").add(25696,"櫻罌鶯鸚也倻冶夜惹揶椰爺耶若野弱掠略約若葯蒻藥躍亮佯兩凉壤孃恙揚攘敭暘梁楊樣洋瀁煬痒瘍禳穰糧羊良襄諒讓釀陽量養圄御於漁瘀禦語馭魚齬億憶抑檍臆偃堰彦焉言諺孼蘖俺儼嚴奄掩淹嶪業円予余勵呂女如廬").add(25952,"旅歟汝濾璵礖礪與艅茹輿轝閭餘驪麗黎亦力域役易曆歷疫繹譯轢逆驛嚥堧姸娟宴年延憐戀捐挻撚椽沇沿涎涓淵演漣烟然煙煉燃燕璉硏硯秊筵緣練縯聯衍軟輦蓮連鉛鍊鳶列劣咽悅涅烈熱裂說閱厭廉念捻染殮炎焰琰艶苒").add(26208,"簾閻髥鹽曄獵燁葉令囹塋寧嶺嶸影怜映暎楹榮永泳渶潁濚瀛瀯煐營獰玲瑛瑩瓔盈穎纓羚聆英詠迎鈴鍈零霙靈領乂倪例刈叡曳汭濊猊睿穢芮藝蘂禮裔詣譽豫醴銳隸霓預五伍俉傲午吾吳嗚塢墺奧娛寤悟惡懊敖旿晤梧汚澳").add(26464,"烏熬獒筽蜈誤鰲鼇屋沃獄玉鈺溫瑥瘟穩縕蘊兀壅擁瓮甕癰翁邕雍饔渦瓦窩窪臥蛙蝸訛婉完宛梡椀浣玩琓琬碗緩翫脘腕莞豌阮頑曰往旺枉汪王倭娃歪矮外嵬巍猥畏了僚僥凹堯夭妖姚寥寮尿嶢拗搖撓擾料曜樂橈燎燿瑤療").add(26720,"窈窯繇繞耀腰蓼蟯要謠遙遼邀饒慾欲浴縟褥辱俑傭冗勇埇墉容庸慂榕涌湧溶熔瑢用甬聳茸蓉踊鎔鏞龍于佑偶優又友右宇寓尤愚憂旴牛玗瑀盂祐禑禹紆羽芋藕虞迂遇郵釪隅雨雩勖彧旭昱栯煜稶郁頊云暈橒殞澐熉耘芸蕓").add(26976,"運隕雲韻蔚鬱亐熊雄元原員圓園垣媛嫄寃怨愿援沅洹湲源爰猿瑗苑袁轅遠阮院願鴛月越鉞位偉僞危圍委威尉慰暐渭爲瑋緯胃萎葦蔿蝟衛褘謂違韋魏乳侑儒兪劉唯喩孺宥幼幽庾悠惟愈愉揄攸有杻柔柚柳楡楢油洧流游溜").add(27232,"濡猶猷琉瑜由留癒硫紐維臾萸裕誘諛諭踰蹂遊逾遺酉釉鍮類六堉戮毓肉育陸倫允奫尹崙淪潤玧胤贇輪鈗閏律慄栗率聿戎瀜絨融隆垠恩慇殷誾銀隱乙吟淫蔭陰音飮揖泣邑凝應膺鷹依倚儀宜意懿擬椅毅疑矣義艤薏蟻衣誼").add(27488,"議醫二以伊利吏夷姨履已弛彛怡易李梨泥爾珥理異痍痢移罹而耳肄苡荑裏裡貽貳邇里離飴餌匿溺瀷益翊翌翼謚人仁刃印吝咽因姻寅引忍湮燐璘絪茵藺蚓認隣靭靷鱗麟一佚佾壹日溢逸鎰馹任壬妊姙恁林淋稔臨荏賃入卄").add(27744,"立笠粒仍剩孕芿仔刺咨姉姿子字孜恣慈滋炙煮玆瓷疵磁紫者自茨蔗藉諮資雌作勺嚼斫昨灼炸爵綽芍酌雀鵲孱棧殘潺盞岑暫潛箴簪蠶雜丈仗匠場墻壯奬將帳庄張掌暲杖樟檣欌漿牆狀獐璋章粧腸臟臧莊葬蔣薔藏裝贓醬長").add(28e3,"障再哉在宰才材栽梓渽滓災縡裁財載齋齎爭箏諍錚佇低儲咀姐底抵杵楮樗沮渚狙猪疽箸紵苧菹著藷詛貯躇這邸雎齟勣吊嫡寂摘敵滴狄炙的積笛籍績翟荻謫賊赤跡蹟迪迹適鏑佃佺傳全典前剪塡塼奠專展廛悛戰栓殿氈澱").add(28256,"煎琠田甸畑癲筌箋箭篆纏詮輾轉鈿銓錢鐫電顚顫餞切截折浙癤竊節絶占岾店漸点粘霑鮎點接摺蝶丁井亭停偵呈姃定幀庭廷征情挺政整旌晶晸柾楨檉正汀淀淨渟湞瀞炡玎珽町睛碇禎程穽精綎艇訂諪貞鄭酊釘鉦鋌錠霆靖").add(28512,"靜頂鼎制劑啼堤帝弟悌提梯濟祭第臍薺製諸蹄醍除際霽題齊俎兆凋助嘲弔彫措操早晁曺曹朝條棗槽漕潮照燥爪璪眺祖祚租稠窕粗糟組繰肇藻蚤詔調趙躁造遭釣阻雕鳥族簇足鏃存尊卒拙猝倧宗從悰慫棕淙琮種終綜縱腫").add(28768,"踪踵鍾鐘佐坐左座挫罪主住侏做姝胄呪周嗾奏宙州廚晝朱柱株注洲湊澍炷珠疇籌紂紬綢舟蛛註誅走躊輳週酎酒鑄駐竹粥俊儁准埈寯峻晙樽浚準濬焌畯竣蠢逡遵雋駿茁中仲衆重卽櫛楫汁葺增憎曾拯烝甑症繒蒸證贈之只").add(29024,"咫地址志持指摯支旨智枝枳止池沚漬知砥祉祗紙肢脂至芝芷蜘誌識贄趾遲直稙稷織職唇嗔塵振搢晉晋桭榛殄津溱珍瑨璡畛疹盡眞瞋秦縉縝臻蔯袗診賑軫辰進鎭陣陳震侄叱姪嫉帙桎瓆疾秩窒膣蛭質跌迭斟朕什執潗緝輯").add(29280,"鏶集徵懲澄且侘借叉嗟嵯差次此磋箚茶蹉車遮捉搾着窄錯鑿齪撰澯燦璨瓚竄簒纂粲纘讚贊鑽餐饌刹察擦札紮僭參塹慘慙懺斬站讒讖倉倡創唱娼廠彰愴敞昌昶暢槍滄漲猖瘡窓脹艙菖蒼債埰寀寨彩採砦綵菜蔡采釵冊柵策").add(29536,"責凄妻悽處倜刺剔尺慽戚拓擲斥滌瘠脊蹠陟隻仟千喘天川擅泉淺玔穿舛薦賤踐遷釧闡阡韆凸哲喆徹撤澈綴輟轍鐵僉尖沾添甛瞻簽籤詹諂堞妾帖捷牒疊睫諜貼輒廳晴淸聽菁請靑鯖切剃替涕滯締諦逮遞體初剿哨憔抄招梢").add(29792,"椒楚樵炒焦硝礁礎秒稍肖艸苕草蕉貂超酢醋醮促囑燭矗蜀觸寸忖村邨叢塚寵悤憁摠總聰蔥銃撮催崔最墜抽推椎楸樞湫皺秋芻萩諏趨追鄒酋醜錐錘鎚雛騶鰍丑畜祝竺筑築縮蓄蹙蹴軸逐春椿瑃出朮黜充忠沖蟲衝衷悴膵萃").add(30048,"贅取吹嘴娶就炊翠聚脆臭趣醉驟鷲側仄厠惻測層侈値嗤峙幟恥梔治淄熾痔痴癡稚穉緇緻置致蚩輜雉馳齒則勅飭親七柒漆侵寢枕沈浸琛砧針鍼蟄秤稱快他咤唾墮妥惰打拖朶楕舵陀馱駝倬卓啄坼度托拓擢晫柝濁濯琢琸託").add(30304,"鐸呑嘆坦彈憚歎灘炭綻誕奪脫探眈耽貪塔搭榻宕帑湯糖蕩兌台太怠態殆汰泰笞胎苔跆邰颱宅擇澤撑攄兎吐土討慟桶洞痛筒統通堆槌腿褪退頹偸套妬投透鬪慝特闖坡婆巴把播擺杷波派爬琶破罷芭跛頗判坂板版瓣販辦鈑").add(30560,"阪八叭捌佩唄悖敗沛浿牌狽稗覇貝彭澎烹膨愎便偏扁片篇編翩遍鞭騙貶坪平枰萍評吠嬖幣廢弊斃肺蔽閉陛佈包匍匏咆哺圃布怖抛抱捕暴泡浦疱砲胞脯苞葡蒲袍褒逋鋪飽鮑幅暴曝瀑爆輻俵剽彪慓杓標漂瓢票表豹飇飄驃").add(30816,"品稟楓諷豊風馮彼披疲皮被避陂匹弼必泌珌畢疋筆苾馝乏逼下何厦夏廈昰河瑕荷蝦賀遐霞鰕壑學虐謔鶴寒恨悍旱汗漢澣瀚罕翰閑閒限韓割轄函含咸啣喊檻涵緘艦銜陷鹹合哈盒蛤閤闔陜亢伉姮嫦巷恒抗杭桁沆港缸肛航").add(31072,"行降項亥偕咳垓奚孩害懈楷海瀣蟹解該諧邂駭骸劾核倖幸杏荇行享向嚮珦鄕響餉饗香噓墟虛許憲櫶獻軒歇險驗奕爀赫革俔峴弦懸晛泫炫玄玹現眩睍絃絢縣舷衒見賢鉉顯孑穴血頁嫌俠協夾峽挾浹狹脅脇莢鋏頰亨兄刑型").add(31328,"形泂滎瀅灐炯熒珩瑩荊螢衡逈邢鎣馨兮彗惠慧暳蕙蹊醯鞋乎互呼壕壺好岵弧戶扈昊晧毫浩淏湖滸澔濠濩灝狐琥瑚瓠皓祜糊縞胡芦葫蒿虎號蝴護豪鎬頀顥惑或酷婚昏混渾琿魂忽惚笏哄弘汞泓洪烘紅虹訌鴻化和嬅樺火畵").add(31584,"禍禾花華話譁貨靴廓擴攫確碻穫丸喚奐宦幻患換歡晥桓渙煥環紈還驩鰥活滑猾豁闊凰幌徨恍惶愰慌晃晄榥況湟滉潢煌璜皇篁簧荒蝗遑隍黃匯回廻徊恢悔懷晦會檜淮澮灰獪繪膾茴蛔誨賄劃獲宖橫鐄哮嚆孝效斅曉梟涍淆").get();class Bw{static get cptable(){if(!Bw._cptable){const e={};b.j.forEach(Lw,((t,r)=>{f.ListUtils.forEach(t.split(""),((t,i)=>{e[r+i]=t}))})),Bw._cptable=e}return Bw._cptable}static getChars(e){const t=Bw.cptable,r=[];let i=0;const n=e.length;for(let o=0;o<n;o+=i){let a;i=2,o+1<n&&(a=t[(e[o].charCodeAt(0)<<8)+e[o+1].charCodeAt(0)-33089]),a||(i=1,a=t[e[o].charCodeAt(0)-33089]),r.push(null!=a?a:e[o])}return r}}class Aw{static decode(e,t){if(null==e)return null;let r="";for(let i=0;i<e.length;i++){const n=e.charCodeAt(i),o=t[n],a=void 0!==o?o:n;r+=String.fromCharCode(a)}return r}}const Nw=(new Eu).add(128,8364).add(130,8218).add(132,8222).add(133,8230).add(134,8224).add(135,8225).add(137,8240).add(138,352).add(139,8249).add(140,346).add(141,356).add(142,381).add(143,377).add(145,8216).add(146,8217).add(147,8220).add(148,8221).add(149,8226).add(150,8211).add(151,8212).add(153,8482).add(154,353).add(155,8250).add(156,347).add(157,357).add(158,382).add(159,378).add(160,160).add(161,711).add(162,728).add(163,321).add(164,164).add(165,260).add(166,166).add(167,167).add(168,168).add(169,169).add(170,350).add(171,171).add(172,172).add(173,173).add(174,174).add(175,379).add(176,176).add(177,177).add(178,731).add(179,322).add(180,180).add(181,181).add(182,182).add(183,183).add(184,184).add(185,261).add(186,351).add(187,187).add(188,317).add(189,733).add(190,318).add(191,380).add(192,340).add(193,193).add(194,194).add(195,258).add(196,196).add(197,313).add(198,262).add(199,199).add(200,268).add(201,201).add(202,280).add(203,203).add(204,282).add(205,205).add(206,206).add(207,270).add(208,272).add(209,323).add(210,327).add(211,211).add(212,212).add(213,336).add(214,214).add(215,215).add(216,344).add(217,366).add(218,218).add(219,368).add(220,220).add(221,221).add(222,354).add(223,223).add(224,341).add(225,225).add(226,226).add(227,259).add(228,228).add(229,314).add(230,263).add(231,231).add(232,269).add(233,233).add(234,281).add(235,235).add(236,283).add(237,237).add(238,238).add(239,271).add(240,273).add(241,324).add(242,328).add(243,243).add(244,244).add(245,337).add(246,246).add(247,247).add(248,345).add(249,367).add(250,250).add(251,369).add(252,252).add(253,253).add(254,355).add(255,729).get(),kw=(new Eu).add(128,8364).add(130,8218).add(131,402).add(132,8222).add(133,8230).add(134,8224).add(135,8225).add(136,710).add(137,8240).add(138,352).add(139,8249).add(140,338).add(142,381).add(145,8216).add(146,8217).add(147,8220).add(148,8221).add(149,8226).add(150,8211).add(151,8212).add(152,732).add(153,8482).add(154,353).add(155,8250).add(156,339).add(158,382).add(159,376).get(),Ow=(new Eu).add(128,8364).add(130,8218).add(131,402).add(132,8222).add(133,8230).add(134,8224).add(135,8225).add(137,8240).add(139,8249).add(145,8216).add(146,8217).add(147,8220).add(148,8221).add(149,8226).add(150,8211).add(151,8212).add(153,8482).add(155,8250).add(161,901).add(162,902).add(175,8213).add(180,900).add(184,904).add(185,905).add(186,906).add(188,908).add(190,910).add(191,911).add(192,912).add(193,913).add(194,914).add(195,915).add(196,916).add(197,917).add(198,918).add(199,919).add(200,920).add(201,921).add(202,922).add(203,923).add(204,924).add(205,925).add(206,926).add(207,927).add(208,928).add(209,929).add(211,931).add(212,932).add(213,933).add(214,934).add(215,935).add(216,936).add(217,937).add(218,938).add(219,939).add(220,940).add(221,941).add(222,942).add(223,943).add(224,944).add(225,945).add(226,946).add(227,947).add(228,948).add(229,949).add(230,950).add(231,951).add(232,952).add(233,953).add(234,954).add(235,955).add(236,956).add(237,957).add(238,958).add(239,959).add(240,960).add(241,961).add(242,962).add(243,963).add(244,964).add(245,965).add(246,966).add(247,967).add(248,968).add(249,969).add(250,970).add(251,971).add(252,972).add(253,973).add(254,974).get(),_w=(new Eu).add(128,8364).add(130,8218).add(131,402).add(132,8222).add(133,8230).add(134,8224).add(135,8225).add(136,710).add(137,8240).add(138,352).add(139,8249).add(140,338).add(145,8216).add(146,8217).add(147,8220).add(148,8221).add(149,8226).add(150,8211).add(151,8212).add(152,732).add(153,8482).add(154,353).add(155,8250).add(156,339).add(159,376).add(208,286).add(221,304).add(222,350).add(240,287).add(253,305).add(254,351).get(),Uw=(new Eu).add(128,8364).add(130,8218).add(131,402).add(132,8222).add(133,8230).add(134,8224).add(135,8225).add(136,710).add(137,8240).add(139,8249).add(145,8216).add(146,8217).add(147,8220).add(148,8221).add(149,8226).add(150,8211).add(151,8212).add(152,732).add(153,8482).add(155,8250).add(164,8362).add(170,215).add(186,247).add(192,1456).add(193,1457).add(194,1458).add(195,1459).add(196,1460).add(197,1461).add(198,1462).add(199,1463).add(200,1464).add(201,1465).add(202,1466).add(203,1467).add(204,1468).add(205,1469).add(206,1470).add(207,1471).add(208,1472).add(209,1473).add(210,1474).add(211,1475).add(212,1520).add(213,1521).add(214,1522).add(215,1523).add(216,1524).add(224,1488).add(225,1489).add(226,1490).add(227,1491).add(228,1492).add(229,1493).add(230,1494).add(231,1495).add(232,1496).add(233,1497).add(234,1498).add(235,1499).add(236,1500).add(237,1501).add(238,1502).add(239,1503).add(240,1504).add(241,1505).add(242,1506).add(243,1507).add(244,1508).add(245,1509).add(246,1510).add(247,1511).add(248,1512).add(249,1513).add(250,1514).add(253,8206).add(254,8207).get(),Hw=(new Eu).add(128,8364).add(129,1662).add(130,8218).add(131,402).add(132,8222).add(133,8230).add(134,8224).add(135,8225).add(136,710).add(137,8240).add(138,1657).add(139,8249).add(140,338).add(141,1670).add(142,1688).add(143,1672).add(144,1711).add(145,8216).add(146,8217).add(147,8220).add(148,8221).add(149,8226).add(150,8211).add(151,8212).add(152,1705).add(153,8482).add(154,1681).add(155,8250).add(156,339).add(157,8204).add(158,8205).add(159,1722).add(161,1548).add(170,1726).add(186,1563).add(191,1567).add(192,1729).add(193,1569).add(194,1570).add(195,1571).add(196,1572).add(197,1573).add(198,1574).add(199,1575).add(200,1576).add(201,1577).add(202,1578).add(203,1579).add(204,1580).add(205,1581).add(206,1582).add(207,1583).add(208,1584).add(209,1585).add(210,1586).add(211,1587).add(212,1588).add(213,1589).add(214,1590).add(216,1591).add(217,1592).add(218,1593).add(219,1594).add(220,1600).add(221,1601).add(222,1602).add(223,1603).add(225,1604).add(227,1605).add(228,1606).add(229,1607).add(230,1608).add(236,1609).add(237,1610).add(240,1611).add(241,1612).add(242,1613).add(243,1614).add(245,1615).add(246,1616).add(248,1617).add(250,1618).add(253,8206).add(254,8207).add(255,1746).get(),Vw=(new Eu).add(128,8364).add(130,8218).add(132,8222).add(133,8230).add(134,8224).add(135,8225).add(137,8240).add(139,8249).add(141,168).add(142,711).add(143,184).add(156,175).add(157,731).get(),Ww=(new Eu).add(128,8364).add(130,8218).add(131,402).add(132,8222).add(133,8230).add(134,8224).add(135,8225).add(136,710).add(137,8240).add(139,8249).add(140,338).add(145,8216).add(146,8217).add(147,8220).add(148,8221).add(149,8226).add(150,8211).add(151,8212).add(152,732).add(153,8482).add(155,8250).add(156,339).add(159,376).add(195,258).add(204,768).add(208,272).add(210,777).add(213,416).add(221,431).add(222,771).add(227,259).add(236,769).add(240,273).add(242,803).add(245,417).add(253,432).add(254,8363).get(),zw="a1e800A4a1ec00A7a1a700A8a1e300B0a1c000B1a1c100D7a8a400E0a8a200E1a8a800E8a8a600E9a8ba00EAa8ac00ECa8aa00EDa8b000F2a8ae00F3a1c200F7a8b400F9a8b200FAa8b900FCa8a10101a8a50113a8a7011Ba8a9012Ba8ad014Da8b1016Ba8a301CEa8ab01D0a8af01D2a8b301D4a8b501D6a8b601D8a8b701DAa8b801DCa1a602C7a1a502C9a6a10391a6a20392a6a30393a6a40394a6a50395a6a60396a6a70397a6a80398a6a90399a6aa039Aa6ab039Ba6ac039Ca6ad039Da6ae039Ea6af039Fa6b003A0a6b103A1a6b203A3a6b303A4a6b403A5a6b503A6a6b603A7a6b703A8a6b803A9a6c103B1a6c203B2a6c303B3a6c403B4a6c503B5a6c603B6a6c703B7a6c803B8a6c903B9a6ca03BAa6cb03BBa6cc03BCa6cd03BDa6ce03BEa6cf03BFa6d003C0a6d103C1a6d203C3a6d303C4a6d403C5a6d503C6a6d603C7a6d703C8a6d803C9a7a70401a7a10410a7a20411a7a30412a7a40413a7a50414a7a60415a7a80416a7a90417a7aa0418a7ab0419a7ac041Aa7ad041Ba7ae041Ca7af041Da7b0041Ea7b1041Fa7b20420a7b30421a7b40422a7b50423a7b60424a7b70425a7b80426a7b90427a7ba0428a7bb0429a7bc042Aa7bd042Ba7be042Ca7bf042Da7c0042Ea7c1042Fa7d10430a7d20431a7d30432a7d40433a7d50434a7d60435a7d80436a7d90437a7da0438a7db0439a7dc043Aa7dd043Ba7de043Ca7df043Da7e0043Ea7e1043Fa7e20440a7e30441a7e40442a7e50443a7e60444a7e70445a7e80446a7e90447a7ea0448a7eb0449a7ec044Aa7ed044Ba7ee044Ca7ef044Da7f0044Ea7f1044Fa7d70451a1aa2015a1ac2016a1ae2018a1af2019a1b0201Ca1b1201Da1ad2026a1eb2030a1e42032a1e52033a1f9203Ba1e62103a1ed2116a2f12160a2f22161a2f32162a2f42163a2f52164a2f62165a2f72166a2f82167a2f92168a2fa2169a2fb216Aa2fc216Ba1fb2190a1fc2191a1fa2192a1fd2193a1ca2208a1c7220Fa1c62211a1cc221Aa1d8221Da1de221Ea1cf2220a1ce2225a1c42227a1c52228a1c92229a1c8222Aa1d2222Ba1d3222Ea1e02234a1df2235a1c32236a1cb2237a1d7223Da1d62248a1d5224Ca1d92260a1d42261a1dc2264a1dd2265a1da226Ea1db226Fa1d12299a1cd22A5a1d02312a2d92460a2da2461a2db2462a2dc2463a2dd2464a2de2465a2df2466a2e02467a2e12468a2e22469a2c52474a2c62475a2c72476a2c82477a2c92478a2ca2479a2cb247Aa2cc247Ba2cd247Ca2ce247Da2cf247Ea2d0247Fa2d12480a2d22481a2d32482a2d42483a2d52484a2d62485a2d72486a2d82487a2b12488a2b22489a2b3248Aa2b4248Ba2b5248Ca2b6248Da2b7248Ea2b8248Fa2b92490a2ba2491a2bb2492a2bc2493a2bd2494a2be2495a2bf2496a2c02497a2c12498a2c22499a2c3249Aa2c4249Ba9a42500a9a52501a9a62502a9a72503a9a82504a9a92505a9aa2506a9ab2507a9ac2508a9ad2509a9ae250Aa9af250Ba9b0250Ca9b1250Da9b2250Ea9b3250Fa9b42510a9b52511a9b62512a9b72513a9b82514a9b92515a9ba2516a9bb2517a9bc2518a9bd2519a9be251Aa9bf251Ba9c0251Ca9c1251Da9c2251Ea9c3251Fa9c42520a9c52521a9c62522a9c72523a9c82524a9c92525a9ca2526a9cb2527a9cc2528a9cd2529a9ce252Aa9cf252Ba9d0252Ca9d1252Da9d2252Ea9d3252Fa9d42530a9d52531a9d62532a9d72533a9d82534a9d92535a9da2536a9db2537a9dc2538a9dd2539a9de253Aa9df253Ba9e0253Ca9e1253Da9e2253Ea9e3253Fa9e42540a9e52541a9e62542a9e72543a9e82544a9e92545a9ea2546a9eb2547a9ec2548a9ed2549a9ee254Aa9ef254Ba1f625A0a1f525A1a1f825B2a1f725B3a1f425C6a1f325C7a1f025CBa1f225CEa1f125CFa1ef2605a1ee2606a1e22640a1e12642a1a13000a1a23001a1a33002a1a83003a1a93005a1b43008a1b53009a1b6300Aa1b7300Ba1b8300Ca1b9300Da1ba300Ea1bb300Fa1be3010a1bf3011a1fe3013a1b23014a1b33015a1bc3016a1bd3017a4a13041a4a23042a4a33043a4a43044a4a53045a4a63046a4a73047a4a83048a4a93049a4aa304Aa4ab304Ba4ac304Ca4ad304Da4ae304Ea4af304Fa4b03050a4b13051a4b23052a4b33053a4b43054a4b53055a4b63056a4b73057a4b83058a4b93059a4ba305Aa4bb305Ba4bc305Ca4bd305Da4be305Ea4bf305Fa4c03060a4c13061a4c23062a4c33063a4c43064a4c53065a4c63066a4c73067a4c83068a4c93069a4ca306Aa4cb306Ba4cc306Ca4cd306Da4ce306Ea4cf306Fa4d03070a4d13071a4d23072a4d33073a4d43074a4d53075a4d63076a4d73077a4d83078a4d93079a4da307Aa4db307Ba4dc307Ca4dd307Da4de307Ea4df307Fa4e03080a4e13081a4e23082a4e33083a4e43084a4e53085a4e63086a4e73087a4e83088a4e93089a4ea308Aa4eb308Ba4ec308Ca4ed308Da4ee308Ea4ef308Fa4f03090a4f13091a4f23092a4f33093a5a130A1a5a230A2a5a330A3a5a430A4a5a530A5a5a630A6a5a730A7a5a830A8a5a930A9a5aa30AAa5ab30ABa5ac30ACa5ad30ADa5ae30AEa5af30AFa5b030B0a5b130B1a5b230B2a5b330B3a5b430B4a5b530B5a5b630B6a5b730B7a5b830B8a5b930B9a5ba30BAa5bb30BBa5bc30BCa5bd30BDa5be30BEa5bf30BFa5c030C0a5c130C1a5c230C2a5c330C3a5c430C4a5c530C5a5c630C6a5c730C7a5c830C8a5c930C9a5ca30CAa5cb30CBa5cc30CCa5cd30CDa5ce30CEa5cf30CFa5d030D0a5d130D1a5d230D2a5d330D3a5d430D4a5d530D5a5d630D6a5d730D7a5d830D8a5d930D9a5da30DAa5db30DBa5dc30DCa5dd30DDa5de30DEa5df30DFa5e030E0a5e130E1a5e230E2a5e330E3a5e430E4a5e530E5a5e630E6a5e730E7a5e830E8a5e930E9a5ea30EAa5eb30EBa5ec30ECa5ed30EDa5ee30EEa5ef30EFa5f030F0a5f130F1a5f230F2a5f330F3a5f430F4a5f530F5a5f630F6a1a430FBa8c53105a8c63106a8c73107a8c83108a8c93109a8ca310Aa8cb310Ba8cc310Ca8cd310Da8ce310Ea8cf310Fa8d03110a8d13111a8d23112a8d33113a8d43114a8d53115a8d63116a8d73117a8d83118a8d93119a8da311Aa8db311Ba8dc311Ca8dd311Da8de311Ea8df311Fa8e03120a8e13121a8e23122a8e33123a8e43124a8e53125a8e63126a8e73127a8e83128a8e93129a2e53220a2e63221a2e73222a2e83223a2e93224a2ea3225a2eb3226a2ec3227a2ed3228a2ee3229d2bb4E00b6a14E01c6df4E03cdf24E07d5c94E08c8fd4E09c9cf4E0Acfc24E0Bd8a24E0Cb2bb4E0Dd3eb4E0Ed8a44E10b3f34E11d7a84E13c7d24E14d8a74E15cac04E16c7f04E18b1fb4E19d2b54E1Ab4d44E1Bb6ab4E1Ccbbf4E1Dd8a94E1Eb6aa4E22c1bd4E24d1cf4E25c9a54E27d8ad4E28b8f64E2Ad1be4E2Be3dc4E2Cd6d04E2Db7e14E30b4ae4E32c1d94E34d8bc4E36cde84E38b5a44E39ceaa4E3Ad6f74E3Bc0f64E3Dbed94E3Ed8af4E3Fc4cb4E43bec34E45d8b14E47c3b44E48d2e54E49d6ae4E4Bceda4E4Cd5a74E4Dbaf54E4Eb7a64E4Fc0d64E50c6b94E52c5d24E53c7c74E54b9d44E56b3cb4E58d2d24E59d8bf4E5Cbec54E5Dc6f24E5Ed2b24E5Fcfb04E60cfe74E61cae94E66d8c04E69c2f24E70c2d24E71c8e94E73c7ac4E7Ec1cb4E86d3e84E88d5f94E89cac24E8Bb6fe4E8Cd8a14E8Dd3da4E8Ebff74E8Fd4c64E91bba54E92d8c14E93cee54E94beae4E95d8a84E98d1c74E9Ad0a94E9Bd8bd4E9Fd9ef4EA0cdf64EA1bfba4EA2bdbb4EA4baa54EA5d2e04EA6b2fa4EA7bae04EA8c4b64EA9cfed4EABbea94EACcda44EADc1c14EAEc7d74EB2d9f14EB3d9f44EB5c8cb4EBAd8e94EBBd2da4EBFcab24EC0c8ca4EC1d8ec4EC2d8ea4EC3d8c64EC4bdf64EC5c6cd4EC6b3f04EC7d8eb4EC9bdf14ECAbde94ECBc8d44ECDb4d34ECEc2d84ED1b2d64ED3d7d04ED4cacb4ED5cbfb4ED6d5cc4ED7b8b64ED8cfc94ED9d9da4EDDd8f04EDEc7aa4EDFd8ee4EE1b4fa4EE3c1ee4EE4d2d44EE5d8ed4EE8d2c74EEAd8ef4EEBc3c74EECd1f64EF0d6d94EF2d8f24EF3d8f54EF5bcfe4EF6bcdb4EF7c8ce4EFBb7dd4EFDb7c24EFFc6f34F01d8f84F09d2c14F0Acee94F0Dbcbf4F0Eb7fc4F0Fb7a54F10d0dd4F11d6da4F17d3c54F18bbef4F19bbe14F1Ad8f14F1Bc9a14F1Eceb04F1Fb4ab4F20d8f34F22c9cb4F24d8f64F25c2d74F26d8f74F27ceb14F2Ad8f94F2Bb2ae4F2Fb9c04F30d9a34F32b0e94F34c1e64F36c9ec4F38cbc54F3Acbc64F3Cd9a44F3Db5e84F43b5ab4F46cebb4F4Db5cd4F4Ed7a14F4Fd7f44F50d3d34F51cce54F53bace4F55d9a24F57d9dc4F58d3e04F59d8fd4F5Ab7f04F5Bd7f74F5Cd8fe4F5Dd8fa4F5Ed9a14F5Fc4e34F60d3b64F63d8f44F64d9dd4F65d8fb4F67c5e54F69c0d04F6Cd1f04F6Fb0db4F70bcd14F73d9a64F74d9a54F76d9ac4F7Bd9ae4F7Cd9ab4F7Ecab94F7Fd9a94F83d6b64F84b3de4F88d9a84F89c0fd4F8Bcacc4F8Dd9aa4F8Fd9a74F91d9b04F94b6b14F97b9a94F9Bd2c04F9Dcfc04FA0c2c24FA3bdc44FA5d5ec4FA6b2e04FA7c7c84FA8bfeb4FA9d9ad4FAAd9af4FACceea4FAEbaee4FAFc7d64FB5b1e34FBFb4d94FC3b6ed4FC4d9b44FC5bfa14FCAd9de4FCEc7ce4FCFc0fe4FD0d9b84FD1cbd74FD7b7fd4FD8d9b54FDAd9b74FDCb1a34FDDd3e14FDEd9b94FDFd0c54FE1d9b64FE3d9b14FE6d9b24FE8c1a94FE9d9b34FEAbcf34FEDd0de4FEEb8a94FEFbee34FF1d9bd4FF3d9ba4FF8b0b34FFAd9c24FFEd9c4500Cb1b6500Dd9bf500Fb5b95012bef35014ccc85018baf25019d2d0501Ad9c3501Cbde8501Fb3ab5021d9c55025beeb5026d9c65028d9bb5029c4df502Ad9be502Cd9c1502Dd9c0502Ed5ae503Ad6b5503Cc7e3503Ed9c85043bcd95047d9ca5048d9bc504Cd9cb504Ec6ab504Fd9c95055d7f6505Acda3505Cbda15065d9cc506Cc5bc5076cdb55077d9cd507Bd9c7507Eb3a5507Fbffe5080b8b55085c0fc5088b0f8508Db4f650A3d9ce50A5d9cf50A7b4a250A8d9d050A9b4df50ACb0c150B2d9d150BAc9b550BBcff150CFd9d250D6c1c550DAd9d650E6c9ae50E7d9d550ECd9d450EDd9d750EEcbdb50F3bda950F5c6a750FBd9d35106d9d85107d9d9510Bc8e55112c0dc5121b6f9513Fd8a35140d4ca5141d4aa5143d0d65144b3e45145d5d75146cfc85148b9e25149bfcb514Bc3e2514Db6d25151cdc35154d9ee5155d9f05156b5b3515Ab6b5515Cbea45162c8eb5165c8ab5168b0cb516Bb9ab516Cc1f9516Dd9e2516Ec0bc5170b9b25171b9d85173d0cb5174b1f85175c6e45176bedf5177b5e45178d7c85179d1f8517Bbce6517Ccade517Dbcbd5180d9e65181d8e75182c4da5185b8d45188c8bd5189b2e1518Cd4d9518Dc3b05192c3e15195daa25196c8df5197d0b45199befc519Bc5a9519Cb9da51A0daa351A2d4a951A4daa451A5d9fb51ABb6ac51ACb7eb51AFb1f951B0d9fc51B1b3e551B2bef651B3bff651B5d2b151B6c0e451B7b6b351BBd9fe51BCd9fd51BDbebb51C0c6e051C4d7bc51C6daa151C7c1b951C9b5f251CBc1e851CCbcf551CFb4d551D1c1dd51DBc4fd51DDbcb851E0b7b251E1b7ef51E4d9ec51EBc6be51EDbfad51EFbbcb51F0b5ca51F3dbc951F5d0d751F6cdb951F8b0bc51F9b3f651FAbbf751FBdbca51FCbaaf51FDd4e451FFb5b65200b5f35201d8d65202c8d05203b7d65206c7d05207d8d75208bfaf520Adbbb520Dd8d8520Ed0cc5211bbae5212ebbe5216c1d05217c1f55218d4f25219b8d5521Ab4b4521Bb3f5521Dc9be5220c5d05224c5d95228c0fb5229b1f0522Bd8d9522Db9ce522Eb5bd5230d8da5233d6c65236cba25237c8af5238c9b25239b4cc523Abfcc523Bb9f4523Dd8db523Fd8dc5240b6e75241bcc15242ccea5243cff7524Ad8dd524Cc7b0524Db9d05250bda35251ccde5254c6ca5256d8e0525Cd8de525Ed8df5261b0fe5265bee75267caa35269bcf4526Ab8b1526Fb8ee5272d8e2527Dbdcb527Fd8e45281d8e35282c5fc5288d8e55290d8e65293c1a6529Bc8b0529Db0ec529Eb9a6529Fbcd352A0cef152A1dbbd52A2c1d352A3b6af52A8d6fa52A9c5ac52AAbdd952ABdbbe52ACdbbf52ADc0f852B1bea252B2c0cd52B3dbc052BEcac652BFb2aa52C3d3c252C7c3e352C9d1ab52CBdbc252D0c0d552D2dbc352D6bfb152D8c4bc52DFc7da52E4dbc452F0d9e852F9c9d752FAb9b452FEcef052FFd4c85300b0fc5305b4d25306d0d95308d9e9530Ddecb530Fd9eb5310d8b05315bbaf5316b1b15317b3d75319d8ce531Ad4d1531Dbdb35320bfef5321cfbb5323d8d05326b7cb532Ad8d1532Ec6a55339c7f8533Ad2bd533Bd8d2533Ec4e4533Fcaae5341c7a75343d8a65345c9fd5347cee75348bbdc5349b0eb534Abbaa534Ed0ad534Fb1b05351d7e45352d7bf5353b5a55355c2f45356c4cf5357b2a9535Ab2b7535Cb1e5535Edfb2535Fd5bc5360bfa85361c2ac5362d8d55363c2b15364d8d45366ced45367dae05369cec0536Bd8b4536Ec3ae536Fd3a15370cea35371bcb45373c8b45374c2d15375beed5377d0b65378dae1537Ac7e4537Fb3a75382b6f25384ccfc5385c0fa5386c0f75389d1b9538Bd1e1538Cd8c7538Db2de5395c0e55398baf1539Ad8c8539Dd4ad539Fcfe153A2d8c953A3d8ca53A5cfc353A6b3f853A8bec753A9d8cb53AEdbcc53B6c8a553BBcfd853BFc8fe53C1b2ce53C2d3d653C8b2e653C9bcb053CAd3d153CBcbab53CCb7b453CDb7a253D1cae553D4c8a153D6cadc53D7b1e453D8d0f053D9c5d153DBdbc553DFb5fe53E0bfda53E3b9c553E4bee453E5c1ed53E6dfb653E8dfb553E9d6bb53EAbdd053EBd5d953ECb0c853EDb6a353EEbfc953EFcca853F0dfb353F1cab753F2d3d253F3d8cf53F5d2b653F6bac553F7cbbe53F8ccbe53F9dfb753FBb5f053FCdfb453FDd3f55401b3d45403b8f75404dfba5406bacf5408bcaa5409b5f5540Acdac540Cc3fb540Dbaf3540Ec0f4540Fcdc25410cff25411dfb85412cfc55413c2c05415dfb95416c2f05417befd541Bc1df541Dcdcc541Ed2f7541Fb7cd5420dfc15421dfc45423b7f15426b0c95427b6d65428b7d45429baac542Bccfd542Cbfd4542Dcbb1542Ec6f4542Fd6a85431dfc55432cee25434b3b35435cefc5438b4b55439cec7543Bbaf0543Ccee1543Ed1bd5440dfc05443b4f45446b3ca5448b8e6544Adfbb544Bc4c55450dfbc5452dfbd5453dfbe5454c5bb5455dfbf5456dfc25457d4b15458dfc35459c7ba545Bced8545Cc4d85462dfca5464dfcf5466d6dc5468dfc95471dfda5472ceb65473bac75475dfce5476dfc85477c5de5478c9eb547Bbaf4547Cc3fc547Dbed75480dfc65482dfcd5484c5d85486d5a6548Bbacd548Cbecc548Ed3bd548Fb8c05490d6e45492dfc75494b9be5495bfa75496c1fc5499dfcb549Adfcc549Bdfd0549Ddfdb54A3dfe554A4dfd754A6dfd654A7d7c954A8dfe354A9dfe454AAe5eb54ABd2a754ACdfd254ADbfa954AFd4db54B1bfc854B3dfd454B4cfcc54B8dfdd54BBd1ca54BDdfde54BFb0a754C0c6b754C1dfd354C2bae554C4b6df54C6cddb54C7b9fe54C8d4d554C9dfdf54CCcfec54CDb0a554CEdfe754CFdfd154D0d1c654D1dfd554D2dfd854D3dfd954D4dfdc54D5bba954D7dfe054D9dfe154DAdfe254DCdfe654DDdfe854DEd3b454DFb8e754E5c5b654E6dfea54E7c9da54E8c1a854E9c4c454EAbfde54EDcff854EEd5dc54F2dfee54F3b2b854FAbadf54FCdfec54FDdbc154FFd1e45501cbf45506b4bd5507b0a65509dff1550Fccc65510dff25511dfed5514dfe9551Bdfeb5520dfef5522dff05523bbbd5524dff35527dff4552Abba3552Ccadb552Ecea8552Fe0a75530b3aa5531e0a65533e0a15537dffe553Ccdd9553Edffc553Fdffa5541bfd05543d7c45544c9cc5546dff85549b0a1554Adffd5550dffb5555e0a25556e0a8555Cb7c85561c6a15564c9b65565c0b25566dff55567c5be556Ad8c4556Cdff9556Dc4f6556Ee0a35575e0a45576e0a55577d0a55578e0b4557Bcce4557Ce0b1557Ebfa65580e0af5581ceb95582e0ab5583c9c65584c0ae5587e0ae5588baed5589bab0558Ae0a9558Bdff6558Fe0b35591e0b85594b4ad5598e0b95599cfb2559Cbac8559De0b0559Fd0fa55A7e0ac55B1d4fb55B3dff755B5c5e755B7e0ad55B9d3f755BBe0b655BDe0b755BEe0c455C4d0e155C5e0bc55C9e0c955CCe0ca55CDe0be55D1e0aa55D2c9a455D3e0c155D4e0b255D6cac855DCe0c355DDe0b555DFcecb55E1cbc355E3e0cd55E4e0c655E5e0c255E6e0cb55E8e0ba55EAe0bf55EBe0c055ECe0c555EFe0c755F2e0c855F3e0cc55F5e0bb55F7cbd455FDe0d555FEe0d65600e0d25601e0d05608bcce5609e0d1560Cb8c2560Ed8c5560Fd0ea5618c2ef561Be0cf561Ee0bd561Fe0d45623e0d35624e0d75627e0dc562Ce0d8562Dd6f65631b3b05632d7ec5634cbbb5636e0da5639cefb563Bbad9563Fe0e1564Ce0dd564Dd2ad564Ee0e25654e0db5657e0d95658e0df5659e0e0565Ce0de5662e0e45664c6f75668d8ac5669d4eb566Ae0e6566Bcac9566Ce0e55671b8c15676e0e7567Be0e8567Ce0e95685e0e35686babf568Ecce7568Fe0ea5693cff956A3e0eb56AFc8c256B7bdc056BCc4d256CAe0ec56D4e0ed56D7c7f456DAcbc456DBe0ee56DDbbd856DEd8b656DFd2f256E0e0ef56E1cdc556E2b6da56E4e0f156EBd4b056EDc0a756F0b4d156F1cea756F4e0f056F5e0f256F9b9cc56FAb9fa56FDcdbc56FEe0f356FFc6d45703e0f45704d4b25706c8a65708e0f65709e0f5570Ae0f7571Ccdc1571Fcaa55723d4da5728dbd75729dbd9572Adbd8572Cb9e7572Ddbdc572Edbdd572Fb5d85730dbda5733dbdb5739b3a1573Adbdf573Bbbf8573Ed6b75740dbe05742bef95747b7bb574Adbd0574Cccae574Dbfb2574Ebbb5574Fd7f85750bfd35751bfe95757bce1575Accb3575Bdbde575Cb0d3575Dceeb575Eb7d8575Fd7b95760c6c25761c0a45764ccb95766dbe75768dbe15769c6ba576Adbe3576Bdbe8576Dc5f7576Fdbea5773dbe95776bfc05777dbe6577Bdbe5577Cb4b95782c0ac5783c2a25784dbe25785dbe45786d0cd578Bdbed578Cc0dd5792dbf25793b6e2579Bdbf357A0dbd257A1b9b857A2d4ab57A3dbec57A4bfd157A6dbf057A7dbd157A9b5e657ABdbeb57ADbfe557AEdbee57B2dbf157B4dbf957B8b9a157C2b0a357C3c2f157CBb3c757CEdbef57CFdbf857D2c6d257D4dbf457D5dbf557D8dbf757D9dbf657DAdbfe57DDd3f257DFb2ba57E0dbfd57E4dca457EDdbfb57EFdbfa57F4dbfc57F8c5e057F9bbf957FAdca357FDdca55800ccc35802b6d15806ddc05807dca1580Bdca2580Dc7b55811b6e95815dca75819dca6581Edca95820b1a45821b5cc5824bfb0582Ad1df5830b6c25835dca85844cbfa584Cebf3584Dcbdc5851cbfe5854ccc15858c8fb585Edcaa5865ccee586Bdcab586Cdbd3587Edcaf5880dcac5881beb35883cafb5885dcad5889c9ca5892c4b95893c7bd5899dcae589Ad4f6589Ed0e6589Fc4ab58A8b6d558A9dbd458BCb1da58C1dbd558C5dbd658D1babe58D5c8c058E4cabf58EBc8c958ECd7b358EEc9f958F0bfc758F3baf858F6d2bc58F9e2ba5902b4a65904b1b85907b8b4590Dcfc4590Fd9e75914cfa65915cde25916d9ed5919b6e0591Ad2b9591Cb9bb591Fe2b95924e2b75925b4f35927ccec5929ccab592Ab7f2592Bd8b2592Dd1eb592Ebabb592Fcaa75931cdb75934d2c45937bfe45938bcd05939b6e1593Adec5593Cdec65941dbbc5942d1d95944c6e65947c4ce5948b7ee5949b7dc594Bbffc594Ed7e0594Fc6f55951b1bc5954dec85955bdb15956ccd75957deca5958dec9595Ab5ec5960c9dd5962b0c25965c5ae5973c5ab5974c4cc5976bce95978cbfd5979bac3597De5f95981c8e75982e5fa5983cdfd5984d7b15986b8be5987c2e85988c8d1598Ae5fb598Db6ca5992bccb5993d1fd5996e6a15997c3ee5999e6a4599Ee5fe59A3e6a559A4cdd759A5b7c159A8e5fc59A9e5fd59AAe6a359ABc4dd59AEe6a859AFe6a759B2c3c359B9c6de59BBe6aa59BEc4b759C6e6a259CAcabc59CBbde359D0b9c359D1e6a659D2d0d559D3ceaf59D4e6a959D7e6b059D8d2a659DAbdaa59DCe6ad59DDe6af59E3c0d159E5d2cc59E8bca759ECe6b159F9d2f659FBd7cb59FFcdfe5A01cdde5A03c2a65A04e6ab5A05e6ac5A06bdbf5A07e6ae5A08e6b35A09e6b25A0Ce6b65A11e6b85A13c4ef5A18c4c85A1Cbeea5A1Fc9ef5A20e6b75A23b6f05A25c3e45A29d3e95A31e6b45A32e6b55A34c8a25A36e6bd5A3Ce6b95A40c6c55A46cdf15A49e6bb5A4Ae6bc5A55bbe95A5Ae6be5A62e6ba5A67c0b75A6Ad3a45A74e6bf5A75c9f45A76e6c35A77e6c45A7Ad0f65A7Fc3bd5A92c3c45A9Ae6c25A9Be6c15AAAe6c75AB2cfb15AB3ebf45AB5e6ca5AB8e6c55ABEbcde5AC1c9a95AC2bcb55AC9cfd35ACCe6c85AD2e6c95AD4e6ce5AD6e6d05AD8e6d15ADCe6cb5AE0b5d55AE1e6cc5AE3e6cf5AE6c4db5AE9e6c65AEBe6cd5AF1e6d25B09e6d45B16e6d35B17e6d55B32d9f85B34e6d65B37e6d75B40d7d35B50e6dd5B51e6de5B53bfd75B54d4d05B55d7d65B57b4e65B58cbef5B59e6da5B5Ad8c35B5Bd7ce5B5Cd0a25B5Dc3cf5B5Fe6df5B62bcbe5B63b9c25B64e6db5B65d1a75B66baa25B69c2cf5B6Ad8ab5B6Ccaeb5B70e5ee5B71e6dc5B73b7f55B75c8e65B7Ac4f55B7De5b25B80c4fe5B81cbfc5B83e5b35B84d5ac5B85d3ee5B87cad85B88b0b25B89cbce5B8Bcdea5B8Cbaea5B8Fe5b55B93e5b45B95d7da5B97b9d95B98d6e65B99b6a85B9Acdf05B9Bd2cb5B9Cb1a65B9Dcab55B9Eb3e85BA0c9f35BA1bfcd5BA2d0fb5BA3cad25BA4e5b65BA5bbc25BA6cfdc5BAAb9ac5BABd4d75BB0baa65BB3d1e75BB4cffc5BB5bcd25BB6e5b75BB8c8dd5BB9bfed5BBDb1f65BBEcbde5BBFbcc55BC2bcc45BC4d2fa5BC5c3dc5BC6bfdc5BC7b8bb5BCCc3c25BD0baae5BD2d4a25BD3c7de5BDDc4af5BDEb2ec5BDFb9d15BE1e5bb5BE4c1c85BE5d5af5BE8e5bc5BEEe5be5BF0b4e75BF8b6d45BF9cbc25BFAd1b05BFBb5bc5BFCcad95BFFb7e25C01c9e45C04bdab5C06cebe5C09d7f05C0Ad0a15C0Fc9d95C11b6fb5C14e6d85C15bce25C16b3be5C18c9d05C1Ae6d95C1Cb3a25C1Ddecc5C22d3c85C24decd5C25d2a25C27dece5C2Cbecd5C31decf5C34caac5C38d2fc5C39b3df5C3Ae5ea5C3Bc4e15C3Cbea15C3Dceb25C3Ec4f25C3Fbed65C40c6a85C41b2e35C42bed35C45c7fc5C48cceb5C49bdec5C4Acedd5C4Bcaba5C4Ec6c15C4Fe5ec5C50d0bc5C51d5b95C55e5ed5C59caf45C5Ecdc05C60c2c55C61e5ef5C63c2c45C65e5f05C66e5f85C6Ecdcd5C6Fc9bd5C71d2d95C79e1a85C7Ad3ec5C7Fcbea5C81c6f15C82e1ac5C88e1a75C8Ce1a95C8De1aa5C90e1af5C91b2ed5C94e1ab5C96b8da5C97e1ad5C98e1ae5C99e1b05C9Ab5ba5C9Be1b15C9Ce1b35CA2e1b85CA3d1d25CA9e1b65CABe1b55CACc1eb5CADe1b75CB1d4c05CB3e1b25CB5e1ba5CB7b0b65CB8e1b45CBDbff95CBFe1b95CC1e1bb5CC4e1be5CCBe1bc5CD2d6c55CD9cfbf5CE1e1bd5CE4e1bf5CE5c2cd5CE6b6eb5CE8d3f85CEAc7cd5CEDb7e55CF0befe5CFBe1c05D02e1c15D03e1c75D06b3e75D07c6e95D0Eb4de5D14d1c25D16e1c85D1Be1c65D1Ee1c55D24e1c35D26e1c25D27b1c05D29d5b85D2De1c45D2Ee1cb5D34e1cc5D3De1ca5D3Eeffa5D47e1d35D4Ae1d25D4Bc7b65D4Ce1c95D58e1ce5D5Be1d05D5De1d45D69e1d15D6Be1cd5D6Ce1cf5D6Fe1d55D74e1d65D82e1d75D99e1d85D9De1da5DB7e1db5DC5cea15DCDe7dd5DDBb4a85DDDd6dd5DDEd1b25DE1b3b25DE2b9a45DE5d7f35DE6c7c95DE7bede5DE8b9ae5DE9ced75DEBb2ee5DEEdbcf5DEFbcba5DF1d2d15DF2cbc85DF3b0cd5DF4cfef5DF7d9e35DFDbded5DFEb1d25E01cad05E02b2bc5E03cba75E05b7ab5E06caa65E08cfa35E0Ce0f85E0Fd5ca5E10e0fb5E11e0fa5E14c5c15E15ccfb5E16c1b15E18e0f95E19d6e35E1Ab2af5E1Bd6c45E1Cb5db5E1Db4f85E26d6a15E27cfaf5E2Db0ef5E2Ee0fc5E31e1a15E37b3a35E38e0fd5E3Be0fe5E3Cc3b15E3Dc3dd5E42e1a25E44b7f95E45bbcf5E4Ce1a35E54c4bb5E55e1a45E5Be1a55E5Ee1a65E61b4b15E62b8c95E72c6bd5E73c4ea5E74b2a25E76d0d25E78e7db5E7Abbc35E7Bd3d75E7Cd3c45E7Db9e35E7Fe2cf5E80d7af5E84c7ec5E86b1d35E87b4b25E8Ae2d15E8Bd0f25E8Fc2ae5E90e2d05E91bfe25E93d3a65E94b5d75E95e2d25E96b5ea5E97c3ed5E99b8fd5E9Ab8ae5E9Cc5d35E9Eb7cf5E9Fe2d45EA0e2d35EA5b6c85EA6d7f95EA7cda55EADe2d85EB3e2d65EB5cafc5EB6bfb55EB7d3b95EB8e2d55EB9e2d75EBEc1ae5EC9c0c85ECAe2db5ED1e2da5ED2c0aa5ED3c1ce5ED6e2dc5EDBe2dd5EE8e2de5EEAdbc85EF4d1d35EF6cda25EF7bda85EFAdec35EFEd8a55EFFbfaa5F00dbcd5F01d2ec5F02c6fa5F03c5aa5F04dec45F08b1d75F0Adfae5F0Bcabd5F0Fdfb15F11b9ad5F13d2fd5F15b8a55F17baeb5F18b3da5F1Bb5dc5F1Fd5c55F20c3d65F25cfd25F26bba15F27e5f35F29e5f25F2Ae5f45F2Dcde45F2Fc8f55F31b5af5F39c7bf5F3Ae5f65F3Cecb05F40e5e65F50b9e95F52b5b15F53c2bc5F55e5e85F56e5e75F57e5e95F58d2cd5F5De1ea5F61d0ce5F62cdae5F64d1e55F66b2ca5F69b1eb5F6Ab1f25F6Cc5ed5F6Dd5c35F70d3b05F71e1dc5F73e1dd5F77d2db5F79b3b95F7Bb1cb5F7Ccdf95F80d5f75F81e1de5F82beb65F84b4fd5F85e1df5F87badc5F88e1e05F89bbb25F8Ac2c95F8Be1e15F8Cd0ec5F90cdbd5F92e1e25F95b5c35F97c5c75F98e1e35F99e1e45F9Cd3f95FA1e1e55FA8d1ad5FAAe1e65FADcea25FAEe1e75FB5b5c25FB7e1e85FBCbbd55FBDd0c45FC3e2e05FC4b1d85FC5d2e45FC6e2e15FC9bcc95FCCc8cc5FCDe2e35FCFecfe5FD0ecfd5FD1dfaf5FD2e2e25FD6d6be5FD7cdfc5FD8c3a65FD9e3c35FDDd6d25FE0e2e75FE1e2e85FE4d3c75FE7e2ec5FEAbfec5FEBe2ed5FEDe2e55FEEb3c05FF1c4ee5FF5e2ee5FF8d0c35FFBbaf65FFDe2e95FFEb7de5FFFbbb36000ccac6001cbcb6002e2e46003e2e66004e2ea6005e2eb6006e2f7600Ae2f4600Dd4f5600Ee2f3600Fc5ad6012d5fa6014c5c26015b2c06016e2ef6019e2f2601Bc1af601Ccbbc601Db5a16020e2f96021bcb16025e2f16026d0d46027d4b96028e2f56029b9d6602Ae2f6602Bc7d3602Fe2f06035d7dc603Beda1603Ce2f8603Feda56041e2fe6042cad16043c1b5604Bbbd0604Dbfd66050bae36052cba16055eda66059eda3605Aeda2605Dbbd66062eda76063d0f46064eda46067bade6068b6f76069e3a1606Ab6b2606Bccf1606Cb9a7606Dcfa2606Fc7a16070bfd26073b6f16076e2fa6078e2fb6079e2fd607Ae2fc607Bc4d5607Ce3a2607Dd3c1607Fe3a76083c7c46084cfa46089e3a9608Cbab7608De3a86092bbda6094e3a36096e3a4609Ae3aa609Be3a6609Dcef2609Fd3c660A0bbbc60A3d4c360A6c4fa60A8eda860ABd0fc60ACe3a560ADc3f560AFe3ad60B1b1af60B2e3b260B4bcc260B8e3ac60BBb5bf60BCc7e960C5e3b060C6beaa60CAcdef60CBbbf360D1cce860D5e3af60D8e3b160DAcfa760DCe3ae60DDcea960DFbbdd60E0b5eb60E6bee560E7b2d260E8b3cd60E9b1b960EBe3ab60ECb2d160EDb5ac60EEb9df60EFb6e860F0cfeb60F3e3b760F4bbcc60F6c8c760F9d0ca60FAe3b86100b3ee6101eda96106d3fa6108d3e46109edaa610De3b9610Ed2e2610Fe3b56115d3de611Ab8d0611Fe3b36120e3b66123b7df6124e3b46126c0a26127e3ba612Bd4b8613Fb4c86148e3bb614Abbc5614Cc9f7614Ec9e56151c4bd6155edab615Dc2fd6162bbdb6167bfae6168cebf6170e3bc6175bfb66177b1ef618Bd4f7618Ee3be6194edad619De3bf61A7baa961A8edac61A9e3bd61ACe3c061B7bab661BEb6ae61C2d0b861C8b0c361CAedae61CBedaf61D1c0c161D2e3c161D4c5b361E6e3c261F5dcb261FFedb06206b8ea6208ceec620Aeaa7620Bd0e7620Ccaf9620Dc8d6620Ecfb7620Fb3c96210ced26211bde46212e3de6215bbf26216eaa86217d5bd6218c6dd621Aeaa9621Beaaa621Feaac6221eaab6222eaae6224eaad6225bdd8622Aeaaf622Cc2be622Eb4c16233b4f76234bba76237ece6623Dece5623Eb7bf623Fcbf96240b1e26241ece76243c9c86247ece86248ece96249cad6624Bded0624Cb2c5624Dd4fa624Ec6cb6251b0c76252b4f26253c8d36254cdd06258bfb8625Bbfdb6263c7a46266d6b46267c0a96269ded1626Ac9a8626Bd1ef626Cc5a4626Db0e7626Eb3b6626Fc8c56270b0e26273b7f66276c5fa6279b6f3627Cd5d2627Eb3d0627Fbcbc6280b3ad6284bef16289b0d1628Ad2d66291cae36292d7a56293cdb66295b6b66296bfb96297d5db6298b8a7629Ac5d7629Bded2629Fbfd962A0c2d562A1c7c062A2bba462A4b1a862A5c5ea62A8c5fb62ABcca762ACb1a762B1b5d662B5c4a862B9ded362BBd1ba62BCb3e962BDc3f262BFb7f762C2d6f462C4b5a362C5b2f062C6c4b462C7c4e962C8c0ad62C9ded462CAb0e862CCc5c462CDc1e062CEb9d562D0bedc62D2cdd862D3b0ce62D4cdcf62D6ded662D7bed062D8d7be62D9ded562DAd5d062DBb0dd62DCc4e262DFc2a362E2bcf062E3d3b562E5c0b962E6c5a162E7b2a662E8d4f162E9c0a862ECcac362EDded762EEd5fc62EFb9b062F1c8ad62F3cba962F4ded962F6bfbd62F7c6b462FCd7a762FDcab062FEc4c362FFb3d66301b9d26302d6b86307eafc6308b0b46309bfe6630Eccf46311cdda6316d6bf631Ac2ce631Bcece631Dcca2631Ed0ae631Fc4d36320b5b26321ded86322d5f56323bcb76324bbd36325b0a46328c5b2632Ab4ec632Bd5f1632Feafd6332deda6339cda6633Acdec633Dcee66342dedc6343cdb16345c0a66346d7bd6349dedb634Bb0c6634Cbab4634Dc9d3634Ec4f3634Fbee86350b2b66355c0cc635Ecbf0635Fbcf16361bbbb6362b5b76363c5f56367dee66369dee3636Dbedd636Ededf6371b4b76376bddd6377dee0637Ac4ed637Bcfc66380b5e06382b6de6387cada6388b5f46389dee5638Ad5c6638Cdee1638Ecccd638Fc6fe6390c5c56392d2b46396bef26398c2d363A0ccbd63A2b3b863A3bdd363A5bfd863A7cdc663A8d1da63A9b4eb63AAdee463ACdedd63ADdee763AEeafe63B0c2b063B3dee263B4d6c063B7b5a763B8b2f463BAdee863BCdef263BEdeed63C4def163C6c8e063C9d7e163CDdeef63CEc3e863CFcce163D0b2e563D2d2be63D6deee63DEdeeb63E0ced563E1b4a763E3bfab63E9bebe63EAbdd263EDdee963F2d4ae63F4dede63F6deea63F8c0bf63FDdeec63FFb2f36400b8e96401c2a76402bdc16405def5640Bdef8640Cb2ab640Fb4a46410b4ea6413c9a66414def6641Bcbd1641Cb8e3641Edef76420defa6421def96426ccc2642Ab0e1642Cb4ee642De5ba6434d0af643Ab2eb643Deba1643Fdef46441c9e36444def36445b0da6446d2a16447b1f76448ccaf644Adef06452cba46454d5aa6458defb645Eb4dd6467c4a66469defd646Dc3fe6478c4a16479dfa1647Ac1cc6482defc6484beef6485c6b26487b3c56491c8f66492cbba6495defe6496dfa46499d7b2649Eb3b764A4c1c364A9c7cb64ACb2a564ADb4e964AEd7ab64B0c4ec64B5dfa264B7dfa364B8dfa564BAbab364BCdfa664C0c0de64C2c9c364C5b2d964CDc7e664CEdfa764D0c7dc64D2dfa864D7eba264D8cbd364DEdfaa64E2dfa964E4b2c164E6c5ca6500dfab6509d4dc6512c8c16518dfac6525bef0652Bdfad652Ed6a7652Feab76534ebb66535cad56536d8fc6538b8c46539b9a5653Bb7c5653Ed5fe653Fb9ca6545d0a76548f4cd6549b5d0654Cc3f4654Fbec86551ebb76555b0bd6556bdcc6559c1b2655Bb1d6655Db3a8655Eb8d26562c9a26563b6d86566ebb8656Bbeb4656Ccafd6570c7c36572d5fb6574b7f36577cec46587d5ab658Bb1f3658Cecb36590b0df6591ecb56593b6b76597c1cf6599f5fa659Bd0b1659Cd5e5659Fced365A1bdef65A4b3e265A5b8ab65A7d5b665A9edbd65ABb6cf65ADcbb965AFd0c265B0b7bd65B9ecb665BCcaa965BDc5d465C1ecb965C3ecb865C4c2c365C5ecb765C6d0fd65CBecba65CCecbb65CEd7e565CFecbc65D2ecbd65D6c6ec65D7cede65E0bcc865E2c8d565E5b5a965E6bec965E7d6bc65E8d4e765E9d1ae65ECd0f165EDeab865EEeab965EFeaba65F0bab565F1cab165F6bff565F7cdfa65FAeac06600b0ba6602eabe6603c0a56606eabb660Ab2fd660Cc3f7660Ebbe8660Fd2d76613cef46614eabf6615eabc6619eac3661Dd0c7661Fd3b36620b4ba6625c3c16627d7f26628d5d1662Dcac7662Feac56631eac46634eac76635eac66636d6e7663Ccfd4663Eeacb6641bbce6643bdfa664Bc9ce664Ceacc664Fc9b96652cffe6653eaca6654d4ce6655eacd6656eacf6657cded665Aeac9665Feace6661ceee6664bbde6666b3bf6668c6d5666Ebeb0666Fcefa6670c7e76674bea76676ead06677d6c7667Ac1c0667Ed4dd6682ead16684cfbe6687ead2668Ccaee6691c5af6696b0b56697ead4669Dead366A7f4df66A8c4ba66AEb1a966B4e5df66B9ead566BEcaef66D9ead666DBead766DCc6d866DDead866E6ead966E9d4bb66F0c7fa66F2d2b766F3b8fc66F4eac266F7b2dc66F9c2fc66FCd4f866FEcce666FFd7ee6700d4c26708d3d06709ebc3670Ac5f3670Bb7fe670Debd46710cbb76714ebde6715c0ca6717cdfb671Bb3af671Dc6da671Febfc6726c4be6728ceb4672Ac4a9672Bb1be672Cd4fd672Dcaf5672Fd6ec6731c6d36734b6e46735bbfa673Ad0e0673Dc9b16740d4d36742c8a86743b8cb6746e8be6748c9bc6749e8bb674Cc0ee674Ed0d3674Fb2c46750b4e56751e8bc6753d5c86756b6c5675Ce8bd675Ecaf8675Fb8dc6760ccf56761c0b46765d1ee6768e8bf6769e8c2676Ababc676Db1ad676Fbddc6770eabd6772e8c36773e8c66775e8cb6777e8cc677Ccbc9677Eb0e5677Fbcab6781b9b96784e8c16787cdf76789e8ca678Bcef66790d5ed6795c1d66797e8c46798c3b6679Ab9fb679Cd6a6679De8c8679Ecae067A2d4e667A3e8c067A5e8c567A7e8c767A8c7b967AAb7e367ABe8c967ADbfdd67AFe8d267B0e8d767B3e8d567B5bcdc67B6bccf67B7e8db67B8e8de67C1e8da67C3b1fa67C4b0d867CFc4b367D0b8cc67D1c6e267D2c8be67D3c8e167D4e8cf67D8e8d467D9e8d667DAb9f167DCe8d867DDd7f567DEc4fb67E0e8dc67E2b2e967E5e8d167E9bced67ECbfc267EFe8cd67F0d6f967F1c1f867F3b2f167F4e8df67FDcac167FFe8d96800d5a46805b1ea6807d5bb6808e8ce6809e8d0680Ab6b0680Be8d3680Ce8dd680Ec0b8680Fcaf76811cba86813c6dc6816c0f56817e8e9681Dd0a36821e8f26829d6ea682Ae8e06832e8e16833d1f96837bacb6838b8f96839b8f1683Cd4d4683De8ef683Ee8ee6840e8ec6841b9f06842ccd26843e8e66844cea66845bff26846b0b86848e8f16849e8f0684Ad7c0684Ce8e4684Ecda96850c9a36851bbb86853bddb6854e8ea6855e8e26860e8e36861e8e56862b5b56863e8e76864c7c56865e8eb6866e8ed6867bdb06868d7ae6869e8f8686Be8f56874cdb06876e8f66877c1ba6881e8e86883c3b76885b0f06886e8f4688Fe8f76893b9a36897c9d268A2c3ce68A6cee068A7c0e668A8cbf368ADccdd68AFd0b568B0cae168B3e8f368B5bcec68C0e8f968C2c3de68C9c6e568CBb9f768CDb0f468D2d7d868D5bcac68D8c5ef68DAccc468E0e9a668E3c9ad68EEe9a268F0c0e268F1bfc368F5e8fe68F9b9d768FAe8fb68FCe9a46901d2ce6905e9a3690Bd6b2690Dd7b5690Ee9a76910bdb76912e8fc691Fe8fd6920e9a16924cdd6692Dd2ac6930e9b26934e9a96939b4aa693Db4bb693Fe9ab6942d0a86954e9a56957b3fe695Ae9ac695Dc0e3695Ee9aa6960e9b96963e9b86966e9ae696Be8fa696Ee9a86971bfac6977e9b16978e9ba6979c2a5697Ce9af6980b8c56982e9ad6984d3dc6986e9b46987e9b56988e9b76989e9c7698Dc0c66994e9c56995e9b06998e9bb699Bb0f1699Ce9bc69A7d5a569A8e9be69ABe9bf69ADe9c169B1c1f169B4c8b669B7e9bd69BBe9c269C1e9c369CAe9b369CCe9b669CEbbb169D0e9c069D4bcf769DBe9c469DFe9c669E0e9ca69EDe9ce69F2b2db69FDe9c869FFb7ae6A0Ae9cb6A17e9cc6A18d5c16A1Fc4a36A21e9d86A28bae16A2Ae9c96A2Fd3a36A31e9d46A35e9d76A3De9d06A3Ee9cf6A44c7c16A47e9d26A50e9d96A58b3c86A59e9d36A5Bcff06A61e9cd6A65b3f76A71e9d66A79e9da6A7Cccb46A80cfad6A84e9d56A8Ee9dc6A90e9db6A91e9de6A97e9d16AA0e9dd6AA9e9df6AABc3ca6AACc7b76B20b4ce6B21bbb66B22d0c06B23eca36B24c5b76B27d3fb6B32eca46B37eca56B39c6db6B3Abfee6B3Eeca66B43eca76B46d0aa6B47c7b86B49b8e86B4Ceca86B59d6b96B62d5fd6B63b4cb6B64b2bd6B65cee46B66c6e76B67cde16B6Ab4f56B79cbc06B7Bbcdf6B7Ce9e26B81e9e36B82d1ea6B83e9e56B84b4f96B86e9e46B87d1b36B89cae26B8Ab2d06B8Be9e86B8De9e66B92e9e76B93d6b36B96e9e96B9Ae9ea6B9Be9eb6BA1e9ec6BAAecaf6BB3c5b96BB4b6ce6BB5d2f36BB7b5ee6BBFbbd96BC1ecb16BC2d2e36BC5cee36BCBc4b86BCDc3bf6BCFb6be6BD2d8b96BD3b1c86BD4b1cf6BD5b1d16BD6c5fe6BD7b1d06BD9c3ab6BDBd5b16BE1eba46BEAbac16BEBccba6BEFeba56BF3eba76BF5eba86BF9eba66BFDeba96C05ebab6C06ebaa6C07ebac6C0Dcacf6C0Fd8b56C10c3f16C11c3a56C13c6f86C14ebad6C15c4ca6C16ebae6C18ebaf6C19ebb06C1Ab7d56C1Bb7fa6C1Febb16C21c7e26C22ebb36C24baa46C26d1f56C27b0b16C28ebb26C29ebb46C2Ab5aa6C2Ec2c86C2Fc7e86C30ebb56C32cbae6C34e3df6C35d3c06C38d9db6C3Dcda16C40d6ad6C41c7f36C42d9e06C46bbe36C47baba6C49e3e26C4Acfab6C50e3e06C54c9c76C55bab96C57d1b46C5Be3e16C5Cc8ea6C5Db9af6C5Ebdad6C5Fb3d86C60cedb6C61ccc06C64e3e86C68e3e96C69cdf46C6Accad6C70bcb36C72e3ea6C74e3eb6C76d0da6C79c6fb6C7Db7da6C7Ec7df6C81d2ca6C82ced66C83e3e46C85e3ec6C86c9f26C88b3c16C89e3e76C8Cc6e36C8Fe3e56C90edb36C93e3e66C94c9b36C99c5e66C9Bb9b56C9Fc3bb6CA1e3e36CA3c5bd6CA4c1a46CA5c2d96CA6b2d76CA7e3ed6CA9bba66CAAc4ad6CABe3f06CADbeda6CAEe3fb6CB1e3f56CB2bad36CB3b7d06CB8d3cd6CB9d6ce6CBBd5d36CBCb9c16CBDd5b46CBEd1d86CBFd0b96CC4c7f66CC5c8aa6CC9b2b46CCAc3da6CCCe3ee6CD0e3fc6CD3e3ef6CD4b7a86CD5e3f76CD6e3f46CD7b7ba6CDBc5a26CDEe3f66CE0c5dd6CE1b2a86CE2c6fc6CE3c4e06CE5d7a26CE8c0e16CEAe3f96CEBe3fa6CEEe3fd6CEFcca96CF0e3f36CF1d3be6CF3b1c36CF5edb46CF6e3f16CF7e3f26CF8e3f86CFAd0ba6CFBc6c36CFCd4f36CFDe3fe6CFEbde06D01e4a76D04e4a66D07d1f36D0Be4a36D0Ce4a96D0Ec8f76D12cfb46D17e4a86D19e4ae6D1Ac2e56D1Bb6b46D1Ebdf26D25e4a26D27bae96D2Ae4aa6D2Be4ac6D2Eb6fd6D31d6de6D32e4b26D33e4ad6D35e4a16D39bbee6D3Bcddd6D3Cc7a26D3Dc5c96D3Ec1f76D41e4a46D43c7b36D45bdac6D46bdbd6D47e4a56D48d7c76D4Ab2e26D4Be4ab6D4Dbcc36D4Ee4af6D4Fbbeb6D51e4b06D52c5a86D53e4b16D54d5e36D59bfa36D5Ae4ba6D5Ce4b76D5Ee4bb6D60e4bd6D63c6d66D66bac66D69c0cb6D6Ab8a16D6Ee4b46D6Fd4a16D74baa36D77bdfe6D78e4bc6D7Ccdbf6D82c4f96D85cffb6D88c9e66D89d3bf6D8Ccfd16D8Ee4b36D91e4b86D93e4b96D94cce96D95ccce6D9Bc0d46D9De4b56D9Ec1b06D9Fe4b66DA0ced06DA1bbc16DA3b5d36DA4c8f36DA6bda76DA7d5c76DA8c9ac6DA9b8a26DAAe4ca6DABe4cc6DAEd1c46DAFd2ba6DB2baad6DB5bad46DB8e4c36DBFb5ed6DC0d7cd6DC4e4c06DC5cffd6DC6e4bf6DC7c1dc6DCBccca6DCCcae76DD1c4d76DD6ccd46DD8e4c86DD9e4c76DDDe4c16DDEe4c46DE0b5ad6DE1d3d96DE4e4c66DE6d2f96DEBb4e36DECbbb46DEEc9ee6DF1b4be6DF3bbec6DF7d1cd6DF9cced6DFBedb56DFCc7e56E05d4a86E0Ae4cb6E0Cd7d56E0De4c26E0Ebda56E10e4c56E11d3e66E14e4c96E16c9f86E17e4be6E1Ad3e56E1Dc7fe6E20b6c96E21d4fc6E23b2b36E24e4d76E25cec26E29e4cd6E2Bcebc6E2Db8db6E2Fe4d66E32bfca6E34d3ce6E38c3ec6E3Ac5c86E43e4d86E44cdc46E4De4cf6E4Ee4d46E53e4d56E54bafe6E56cfe66E58d5bf6E5Be4d26E5Fe4d06E6Be4ce6E6Ecde56E7Ecaaa6E7Fc0a36E83bda66E85e4d36E86b8c86E89e4e76E8Fd4b46E90e4db6E98c1ef6E9Ce4e96E9Fd2e76EA2e4df6EA5e4e06EA7cfaa6EAAcbdd6EAFe4da6EB1e4d16EB2e4e56EB4c8dc6EB6e4e36EB7c4e76EBAe4e26EBBe4e16EBDb3fc6EC1e4e86EC2b5e16EC7d7cc6ECBe4e66ECFbbac6ED1d7d26ED3cccf6ED4ebf86ED5e4e46ED7b9f66EDAd6cd6EDEe4d96EDFe4dc6EE0c2fa6EE1e4de6EE2c2cb6EE4c0c46EE5c2d06EE6b1f56EE8ccb26EE9b5ce6EF4e4ef6EF9c6af6F02c6e16F06e4f56F09c2a96F0Fc0ec6F13d1dd6F14e4ee6F15c4ae6F20e4ed6F24e4f66F29e4f46F2Ac2fe6F2Be4dd6F2De4f06F2Fcafe6F31d5c46F33e4f16F36d1fa6F3Ee4eb6F46e4ec6F47e4f26F4Bceab6F4Dc5cb6F58c7b16F5Cc2ba6F5Ee4ea6F62c1ca6F66ccb66F6Db3b16F6Ee4fb6F72e4f36F74e4fa6F78e4fd6F7Ae4fc6F7Cb3ce6F84b3ba6F88e4f76F89e4f96F8Ce4f86F8Dc5ec6F8Ec0bd6F9Cd4e86FA1e5a26FA7b0c46FB3e5a46FB6e5a36FB9bca46FC0e5a56FC2e5a16FC9e4fe6FD1b1f46FD2e5a86FDEe5a96FE0e5a66FE1e5a76FEEe5aa6FEFc6d97011e5ab701Ae5ad701Be5ac7023e5af7035e5ae7039b9e0704Ce5b0704Fe5b1705Ebbf0706Bece1706Cc3f0706Db5c6706Fbbd27070c1e97075d4ee7076bec47078d7c6707Cd4d6707Eb2d3707Fecbe7080eac17085c2af7089b4b6708Ad1d7708Eb3b47092c8b27094bfbb7095ecc07096d6cb7099ecbf709Cecc1709Decc570ABbee670ACccbf70ADc5da70AEbebc70AFecc670B1b1fe70B3ecc470B7d5a870B8b5e370B9ecc270BBc1b670BCb3e370BDecc370C0cbb870C1c0c370C2ccfe70C3c1d270C8ecc870CAbae670D8c0d370D9d6f270DBd1cc70DFbfbe70E4b7b370E6c9d570E7ecc770E8bbe270E9cccc70EBbdfd70ECc8c870EDcfa970EFcde970F7c5eb70F9b7e970FDd1c97109bab8710Aecc97110ecca7113bbc07115eccb7116ece27118b1ba7119b7d9711Abdb97126eccc712Fd1e67130eccd7131c8bb7136ecd17145ecd3714Abbcd714Cbce5714Eeccf715Cc9b7715Ec3ba7164ece37166d5d57167ecd07168d6f3716Eecd27172ecce7173ecd47178ecd5717Ac9bf717Dcfa87184d0dc718Ad1ac718Fc8db7194ecd67198cef57199caec719Fecda71A0ecd971A8b0be71ACecd771B3ecd871B5ece471B9c8bc71C3c1c771CEecdc71D4d1e071D5ecdb71E0d4ef71E5ecdd71E7dbc671EEecde71F9b1ac7206ecdf721Dece07228d7a6722Ac5c0722Cebbc7230b0ae7231bef47235b8b87236d2af7237b0d67238b5f97239d8b3723Bcbac723De3dd723Fc6ac7247b0e67248c5c6724Cebb9724Debba7252ebbb7256d1c07259c5a3725Beaf2725Dc4b2725Fc4b57261c0ce7262eaf37266c4c17267ceef7269eaf0726Eeaf4726Fc9fc7272c7a37275ccd87279cefe727Aeaf5727Eeaf6727Fcfac7280c0e77281eaf77284b6bf728Aeaf8728Beaf9728Deafa728Feafb7292eaf1729Fc8ae72ACe1eb72ADb7b872AFe1ec72B0e1ed72B4d7b472B6e1ee72B7e1ef72B8d3cc72B9e1f172C1bff172C2e1f072C3b5d272C4b1b772C8e1f372CDe1f272CEbafc72D0e1f472D2b9b772D7bed172D9c4fc72DEbadd72E0bdc672E1e1f572E8e1f772E9b6c072ECcfc172EDcaa872EEe1f672EFd5f872F0d3fc72F1e1f872F2e1fc72F3e1f972F4e1fa72F7c0ea72F8e1fe72FAe2a172FBc0c772FCe1fb7301e1fd7303e2a5730Ac1d4730Ee2a37313e2a87315b2fe7316e2a27317c3cd731Bb2c2731Ce2a7731De2a6731Ee2a47321e2a97322e2ab7325d0c97329d6ed732Ac3a8732Be2ac732Ccfd7732Ee2ae7331baef7334e9e07337e2ad7338e2aa7339bbab733Ed4b3733Fe2b0734De2af7350e9e17352e2b17357e2b27360e2b3736Ccca1736De2b4736Fe2b5737Ed0fe7384c2ca7387d3f17389cdf5738Be7e0738Ee7e17391bec17396c2ea739Be7e4739Fe7e373A2cde673A9c3b573ABe7e273AEbbb773AFcfd673B0c1e173B2e7e973B3e7e873B7e7f473BAb2a373BBe7ea73C0e7e673C2e7ec73C8e7eb73C9c9ba73CAd5e473CDe7e573CFb7a973D0e7e773D1e7ee73D9e7f373DEd6e973E0e7ed73E5e7f273E7e7f173E9b0e073EDe7f573F2c7f27403c0c57405c0ed7406c1f07409e7f0740Ae7f6740Fcbf67410e8a2741Ae8a1741Bd7c17422e7fa7425e7f97426e7fb7428e7f7742Ae7fe742Ce7fd742Ee7fc7430c1d57433c7d97434c5fd7435c5c37436c7ed743Ce8a37441e8a67455e8a57457e8a77459baf7745Ae7f8745Be8a4745Cc8f0745Ec9aa745Fe8a9746Db9e57470d1fe7476e8a87477e8aa747Ee8ad7480e8ae7481c1a77483e8af7487e8b0748Be8ac748Ee8b47490e8ab749Ce8b1749Ee8b574A7e8b274A8e8b374A9e8b774BAe8b674D2b9cf74DCf0ac74DEf0ad74E0c6b074E2b0ea74E3c8bf74E4cddf74E6cecd74EEeab174EFeab274F4c6bf74F6b4c974F7eab374FFd5e77504ddf9750Deab4750Feab57511eab67513b8ca7518dfb07519c9f5751Accf0751Cc9fa751Fc9fb7525d3c37528cba67529b8a6752Bf0ae752Cb1c2752De5b8752Fccef7530d3c97531bcd77532c9ea7533b5e77535c4d07537b5e97538eeae753Abbad753Be7de753Eeeaf7540b3a97545eeb27548eeb1754Bbde7754Ceeb0754Eceb7754Fc5cf7554c1f47559dbce755Aeeb3755Bd0f3755Cc2d47565c6e87566b7ac756Aeeb47572b3eb7574bbfb7578eeb57579e7dc757Feeb67583bdae7586f1e2758Bcae8758Fd2c97591f0da7592f0db7594f0dc7596c1c67597b8ed7599bece759Af0de759Dc5b1759Ff0dd75A0d1f175A1f0e075A3b0cc75A4bdea75A5d2df75ABf0df75ACb4af75AEb7e875AFf0e675B0f0e575B1c6a375B2f0e175B3f0e275B4b4c375B5f0e375B8d5ee75B9ccdb75BCbed275BDbcb275BEf0e875C2f0e775C3f0e475C4b2a175C5d6a275C7d3b875C8beb775C9c8ac75CAf0ea75CDd1f775D2d6cc75D4badb75D5f0e975D6b6bb75D8cdb475DBc6a675DEc1a175E2f0eb75E3f0ee75E4f0ed75E6f0f075E7f0ec75E8bbbe75EAf0ef75EBccb575F0f0f275F1b3d575F4b1d475F9f0f375FCf0f475FFf0f67600b4e17601f0f17603f0f77605f0fa760Af0f8760Cf0f57610f0fd7615f0f97617f0fc7618f0fe7619f1a1761Bcec1761Ff1a47620f1a37622c1f67624f0fb7625cadd7626b4f17629b1f1762Accb1762Bf1a6762Df1a77630f1ac7633d5ce7634f1a97635c8b37638f1a2763Cf1ab763Ef1a8763Ff1a57640f1aa7643b0a9764Cf1ad764Df1af7654f1b17656f1b0765Cf1ae765Ed1a27663f1b2766Bf1b3766Fb9ef7678b5c7767Bb0d7767Db0d9767Ed4ed7682b5c47684bdd47686bbca7687f0a77688b8de768Bf0a8768Eb0a87691f0a97693cdee7696f0aa7699f0ab76A4c6a476AEd6e576B1f1e476B2f1e576B4c3f376BFd3db76C2d6d176C5c5e876C6d3af76C8d2e676CAeec176CDb0bb76CEd5b576CFd1ce76D0bce076D1bad076D2bff876D4b8c776D6b5c176D7c5cc76D8caa276DBc3cb76DFeec276E5c4bf76EEb6a276EFedec76F1c3a476F2d6b176F4cfe076F8edef76F9c5ce76FCb6dc76FEcaa17701eded7704edf07707edf17708c3bc7709bfb4770Bedee770Dedf47719edf2771Ad5e6771Fc3df7720edf37722edf67726d5a37728d1a37729edf5772Dc3d0772Fedf77735bff47736beec7737edf87738ccf7773Ad1db773Cd7c57740d5f67741edfc7743edfb7747edf97750edfa7751edfd775Abea6775Bcbaf7761eea17762b6bd7763eea27765c4c07766edfe7768bdde776Bb2c7776Cb6c37779eea5777Dd8ba777Eeea3777Feea67780c3e97784b3f27785eea7778Ceea4778Dcfb9778Eeea87791c2f77792eea9779Feeaa77A0deab77A2c6b377A5c7c677A7d6f577A9b5c977AAcbb277ACeeab77B0cdab77B3eeac77B5d5b077BBeead77BDf6c477BFdbc777CDb4a377D7c3ac77DBf1e677DCcab877E2d2d377E3d6aa77E5eff277E7bed877E9bdc377EBeff377ECb6cc77EDb0ab77EEcaaf77F3edb677F6edb777F8cef977FDb7af77FEbff377FFedb87800c2eb7801c9b07802edb97809c6f6780Cbfb3780Dedbc7811c5f87812d1d07814d7a97816edba7817edbb7818d1e2781Aedbf781Cedc0781Dedc4781Fedc87823edc67825edce7826d5e87827edc97829edc7782Cedbe782Dc5e97830c6c67834c9e97837d4d27838edc17839edc2783Aedc3783Bedc5783Cc0f9783Eb4a17840b9e87845edd07847edd1784Cedca784Eedcf7850cef87852cbb67855edcc7856edcd7857cff5785Dedd2786Ac1f2786Bd3b2786Cedcb786Dc8b7786Ebcef7877c5f0787Cedd67887b5ef7889c2b5788Cb0ad788Dcbe9788Eb1ae7891edd47893cdeb7897b5e27898edd5789Aedd3789Bedd7789Cb5fa789Fedd878A1edd978A3eddc78A5b1cc78A7c5f678B0bcee78B1edda78B2ccbc78B3b2ea78B4eddb78B9c4eb78BEb4c578C1b0f578C5eddf78C9c0da78CAb4e878CBc5cd78D0eddd78D4bfc478D5edde78D9c4a578E8ede078ECede178F2ede378F4c1d778F7bbc778FAbdb87901ede27905ede47913ede6791Eede57924ede77934cabe793Aecea793Bc0f1793Cc9e7793Eeceb7940c6ee7941ecec7946c6ed7948eced7949ecf07953d7e67956ecf37957ecf1795Aecee795Becef795Cd7a3795Dc9f1795Ecbee795Fecf47960ecf27962cfe97965ecf67967c6b17968bcc0796Decf5796Fb5bb7977bbf67978ecf7797Ad9f77980bdfb7981c2bb7984ecf87985ecf9798Ab8a3798Fecfa799Aecfb79A7ecfc79B3d3ed79B9d8ae79BAc0eb79BBc7dd79BDbacc79BEd0e379C0cbbd79C1cdba79C3b8d179C6b1fc79C9c7ef79CBd6d679CDbfc679D1c3eb79D2eff579D5c3d879D8d7e279DFeff779E3b3d379E4c7d879E6d1ed79E7d6c879E9eff879EBeff679EDbbfd79EFb3c679F0bdd579F8d2c679FBbbe079FDcfa17A00effc7A02effb7A03eff97A06b3cc7A0Bc9d47A0Dcbb07A0Eeffe7A14b0de7A17d6c97A1Aeffd7A1Eb3ed7A20f6d57A23cec87A33f0a27A37f0a17A39b5be7A3Bbcda7A3Cbbfc7A3Db8e57A3Fc4c27A46f0a37A51cbeb7A57f0a67A70d1a87A74bebf7A76c7ee7A77f1b67A78f1b77A79bfd57A7Ab4a97A7Ff1b87A80cdbb7A81c7d47A83d5ad7A84f1b97A86f1ba7A88c7cf7A8Dd2a47A91d6cf7A92f1bb7A95bdd17A96b4b07A97bebd7A98b4dc7A9Cced17A9Dbfdf7A9Ff1bd7AA0bffa7AA5f1bc7AA6f1bf7AA8f1be7AACf1c07AADf1c17AB3c1fe7ABFc1a27ACBcafa7AD6d5be7AD9beba7ADEbeb97ADFd5c27AE0bfa27AE3cdaf7AE5f1b57AE6bddf7AEDb6cb7AEFd6f17AF9f3c37AFAf3c47AFDb8cd7AFFf3c67B03f3c77B04b0ca7B06f3c57B08f3c97B0Acbf17B0Bf3cb7B0Fd0a67B11b1ca7B14f3c87B15f3cf7B19b5d17B1Bf3d77B1Ef3d27B20f3d47B24f3d37B25b7fb7B26b1bf7B28f3ce7B2Af3ca7B2Bb5da7B2Cf3d07B2Ef3d17B31f3d57B33f3cd7B38bce37B3Ac1fd7B3Cf3d67B3Ef3da7B45f3cc7B47b5c87B49bdee7B4Bf3dc7B4Cb7a47B4Fbff07B50d6fe7B51cdb27B52b4f07B54b2df7B56f3d87B58f3d97B5Ac9b87B5Bf3dd7B5Df3de7B60f3e17B62f3df7B6Ef3e37B71f3e27B72f3db7B75bfea7B77b3ef7B79f3e07B7Bc7a97B7Ebcf27B80f3eb7B85b9bf7B8Df3e47B90b2ad7B94bbfe7B95cbe37B97f3ed7B9Cf3e97B9Db9dc7BA1f3ee7BA2f3e57BA6f3e67BA7f3ea7BA8c2e17BA9f3ec7BAAf3ef7BABf3e87BACbcfd7BADcfe47BB1f3f07BB4f3e77BB8f3f27BC1d7ad7BC6c6aa7BC7f3f37BCCf3f17BD1c2a87BD3b8dd7BD9f3f57BDAf3f47BDDb4db7BE1f3f67BE5f3f77BE6f3f87BEAc0ba7BEEc0e97BF1c5f17BF7f3fb7BFCf3fa7BFEb4d87C07f3fe7C0Bf3f97C0Cf3fc7C0Ff3fd7C16f4a17C1Ff4a37C26bbc97C27f4a27C2Af4a47C38b2be7C3Ff4a67C40f4a57C41bcae7C4Dc3d77C73d9e17C74c0e07C7Bf4cc7C7Cd7d17C7Db7db7C89f4ce7C91c1a37C92c6c97C95b4d67C97d5b37C98f4d07C9Cf4cf7C9Df4d17C9Ecbda7C9Ff4d27CA2d4c17CA4d6e07CA5b7e07CAAc1b87CAEc1bb7CB1f4d37CB2beac7CB3b4e27CB9f4d47CBCf4d57CBDbeab7CBEf4d67CC1f4db7CC5f4d77CC7f4da7CC8bafd7CCAf4d87CCCf4d97CCDb8e27CD5ccc77CD6f4dc7CD7b2da7CD9c3d37CDCd4e37CDFbfb77CE0f4dd7CE8c5b47CEFf4e97CF8cfb57CFBcec97D0Acbd87D20cbf77D22bdf47D27d7cf7D2Bc0db7D2Fd0f57D6Ef4ea7D77f4eb7DA6f4ec7DAEf7e37E3Bb7b17E41f4ed7E47d7eb7E82f4ee7E9Be6f97E9Fbec07EA0e6fa7EA1baec7EA2e6fb7EA3cfcb7EA4e6fc7EA5d4bc7EA6bcb67EA7e6fd7EA8e6fe7EA9bccd7EAAc8d27EABceb37EACe7a17EADb4bf7EAFe7a27EB0c9b47EB1b8d97EB2c4c97EB3d7dd7EB5c2da7EB6b7d77EB7d6bd7EB8cec67EB9b7c47EBAc5a67EBDe7a37EBEcfdf7EBFe7a47EC0e7a57EC1e7a67EC2c1b77EC3d7e97EC4c9f07EC5cfb87EC6d6af7EC7d6d57EC8e7a77EC9b0ed7ECAe7a87ECBe7a97ECCc9dc7ECDd2ef7ECEbead7ECFe7aa7ED0b0f37ED1c8de7ED2bde17ED3e7ab7ED4c8c67ED5e7ac7ED7bbe67ED8b8f87ED9d1a47EDAe7ad7EDBc2e77EDCbef87EDDbdca7EDEcdb37EDFe7ae7EE0e7af7EE1beee7EE2d0e57EE3cbe77EE5ccd07EE6bccc7EE7e7b07EE8bca87EE9d0f77EEAe7b17EEBd0f87EEDe7b27EEEe7b37EEFb4c27EF0e7b47EF1e7b57EF2c9fe7EF3ceac7EF4c3e07EF5e7b77EF6b1c17EF7b3f17EF8e7b87EFAe7b97EFBd7db7EFCd5c07EFDe7ba7EFEc2cc7EFFd7ba7F00e7bb7F01e7bc7F02e7bd7F03bcea7F04c3e57F05c0c27F06e7be7F07e7bf7F08bca97F09e7c07F0Be7c17F0Ce7b67F0Db6d07F0Ee7c27F0Fe7c37F11e7c47F12bbba7F13b5de7F14c2c67F15b1e07F16e7c57F17d4b57F18e7c67F19b8bf7F1Ae7c87F1Be7c77F1Cb7ec7F1De7c97F1Fb2f87F20e7ca7F21e7cb7F22e7cc7F23e7cd7F24e7ce7F25e7cf7F26e7d07F27d3a77F28cbf57F29e7d17F2Ae7d27F2Be7d37F2Ce7d47F2Dc9c97F2Ee7d57F2Fe7d67F30e7d77F31e7d87F32e7d97F33bdc97F34e7da7F35f3be7F36b8d77F38c8b17F3Af3bf7F42f3c07F44f3c17F45b9de7F50cdf87F51d8e87F54bab17F55c2de7F57eeb77F58b7a37F5Aeeb97F5Feeb87F61b0d57F62eebb7F68d5d67F69d7ef7F6Ad6c37F6Eeebd7F71caf07F72eebc7F74eebe7F79eec07F7Eeebf7F81d1f27F8Ac7bc7F8Cc3c07F8Eb8e17F94c1e77F9Af4c67F9Dd0df7F9Ef4c77F9Fcfdb7FA1c8ba7FA4f4c87FA7f4c97FAFf4ca7FB0f4cb7FB2d9fa7FB8b8fe7FB9e5f17FBCd3f07FBDf4e07FBFcecc7FC1b3e17FC5f1b47FCAd2ee7FCCf4e17FCEcfe87FD4f4e27FD5c7cc7FD8b5d47FDFb4e47FE0f4e47FE1f4e37FE5f4e57FE6f4e67FE9f4e77FEEbab27FF0b0bf7FF1f4e87FF3b7ad7FFBd2ed7FFCd2ab8000c0cf8001bfbc8003eba38004d5df8005eac88006f1f3800Bb6f8800Ccba3800Dc4cd8010f1e78012f1e88014b8fb8015f1e98016bac48017d4c58018b0d28019f1ea801Cf1eb8020f1ec8022f1ed8025f1ee8026f1ef8027f1f18028f1f08029c5d5802Af1f28031b6fa8033f1f48035d2ae8036dec78037cbca8038b3dc803Bb5a2803Db9a2803Fc4f48042f1f58043f1f68046c1c4804Ac1fb804Bd6b0804Cf1f7804Df1f88052c1aa8054c6b88058bedb805Af1f98069b4cf806Af1fa8071edb2807Fedb18080cbe08083d2de8084cbc18086d5d88087c8e28089c0df808Bbca1808Cebc18093d0a48096d6e28098b6c7809Ab8d8809Bebc0809Cb8ce809Debbf809Fb3a680A0b9c980A1d6ab80A2b7f480A4b7ca80A5bce780A9b7be80AAebc680ABebc780ADb0b980AEbfcf80AFebc580B1d3fd80B2ebc880B4ebc980B7b7ce80BAebc280BCebc480BDc9f680BEd6d780BFd5cd80C0d0b280C1ebcf80C2ceb880C3ebd080C4b5a880C6b1b380CCebd280CDcca580CEc5d680D6ebd380D7ebd180D9c5df80DAebce80DBcaa480DCebd580DDb0fb80DEbafa80E1d8b780E4f1e380E5ebca80E7ebcb80E8ebcc80E9ebcd80EAebd680EBe6c080ECebd980EDbfe880EFd2c880F0ebd780F1ebdc80F2b8ec80F3ebd880F4bdba80F6d0d880F8b0b780FAebdd80FCc4dc80FDd6ac8102b4e08106c2f68109bcb9810Aebda810Debdb810Ed4e0810Fc6ea8110c4d48111ebdf8112c5a78113d9f58114b2b18116ebe48118bdc5811Aebe2811Eebe3812Cb8ac812Fcdd18131ebe58132ebe18136c1b38138c6a2813Eccf38146ebe68148c0b0814Ad2b8814Bebe7814Cb8af8150b8ad8151ebe88153c7bb8154cdf38155ebea8159ebeb815Aebed8160d0c88165ebf28167ebee8169ebf1816Dc8f9816Ed1fc8170ebec8171ebe98174b8b98179cfd9817Ac4e5817Bebef817Cebf0817Dccda817Ecdc8817Fb0f28180ebf68182ebf58188b2b2818Ab8e0818Febf78191b1ec8198ccc5819Bc4a4819Ccfa5819Debf981A3eca281A6c5f281A8ebfa81AAc9c581B3e2df81BAebfe81BBcdce81C0eca181C1b1db81C2d3b781C3d2dc81C6ebfd81CAebfb81CCb3bc81E3eab081E7d7d481EAf4ab81ECb3f481EDd6c181F3d6c281F4d5e981FBbeca81FCf4a781FEd2a88200f4a88201f4a98202f4aa8204becb8205d3df8206c9e0820Cc9e1820Df3c28210cae68212ccf28214e2b6821Bcbb4821Ccee8821Ed6db821Ff4ad8221f4ae8222f4af8223f4b28228babd822Af4b3822Bb0e3822Cf4b0822Df4b1822Fbda28230b2d58231f4b68233f4b78234b6e68235b2b08236cfcf8237f4b48238b4ac8239f4b5823Bf4b8823Ef4b98244cda78247f4ba8249f4bb824Bf4bc824Fcbd28258f4bd825Af4be825Ff4bf8268f4de826Ec1bc826Fbce88270c9ab8272d1de8273e5f58274dcb38279d2d5827Adcb4827Db0ac827Edcb5827Fbdda8282dcb98284d8c28288dcb7828Ad3f3828Bc9d6828Ddcba828Edcb6828Fdcbb8291c3a28292dcbc8297dcc58298dcbd8299cedf829Cd6a5829Ddccf829Fdccd82A1dcd282A4bde682A5c2ab82A6dcb882A8dccb82A9dcce82AAdcbe82ABb7d282ACb0c582ADdcc782AEd0be82AFdcc182B0bba882B1b7bc82B3dccc82B4dcc682B7dcbf82B8c7db82B9d1bf82BDdcc082BEdcca82C1dcd082C4cead82C7dcc282C8dcc382CAdcc882CBdcc982CCb2d482CDdcd182CEcbd582CFd4b782D1dcdb82D2dcdf82D3cca682D4dce682D5c3e782D7dcdc82D8bfc182DBdcd982DCb0fa82DEb9b682DFdce582E0dcd382E1dcc482E3dcd682E4c8f482E5bfe082E6c9bb82EBb1bd82EFd3a282F1dcda82F4dcd582F7c6bb82F9dcde82FBd7c28301c3af8302b7b68303c7d18304c3a98305dce28306dcd88307dceb8308dcd48309dcdd830Cbea5830Edcd7830Fdce08311dce38314dce48315dcf88317dce1831Adda2831Bdce7831Cbceb8327b4c48328c3a3832Bb2e7832Cdcfa832Ddcf2832Fdcef8331dcfc8333dcee8334d2f08335b2e88336c8d78338c8e38339dcfb833Adced833Cdcf78340dcf58343bea38346dcf48347b2dd8349dcf3834Fbcf68350dce88351bbc48352c0f38354bcd4835Adce9835Bdcea835Cdcf1835Edcf6835Fdcf98360b5b48361c8d98363bbe78364dcfe8365dcfd8366d3ab8367dda18368dda38369dda5836Ad2f1836Bdda4836Cdda6836Ddda7836Ed2a9836Fbac98377dda98378ddb6837Bddb1837Cddb4837Dddb08385c6ce8386c0f28389c9af838Edcec8392ddae8393ddb78398dcf0839Bddaf839Cddb8839Eddac83A0ddb983A8ddb383A9ddad83AAc4aa83ABdda883B0c0b383B1c1ab83B2ddaa83B3ddab83B4ddb283B6bbf183B7ddb583B8d3a883B9ddba83BAddbb83BCc3a783BDddd283C0ddbc83C1ddd183C5b9bd83C7bed583CAbefa83CCbaca83CFddca83D4ddc583D6ddbf83D8b2cb83DCddc383DDddcb83DFb2a483E0ddd583E1ddbe83E5c6d083E9ddd083EAddd483F0c1e283F1b7c683F2ddce83F8ddcf83F9ddc483FDddbd8401ddcd8403ccd18404ddc98406ddc2840Bc3c8840Cc6bc840Dceae840Eddcc840Fddc88411ddc18418ddc6841Cc2dc841Dd3a98424d3aa8425ddd38426cff48427c8f88428dde68431ddc78438dde0843Cc2e4843Ddde18446ddd78451d6f88457ddd98459ddd8845Ab8f0845Bddd6845Cc6cf8461b6ad8463dde28469baf9846Bd4e1846Cdde7846Db4d08471ddda8473bffb8475dde38476dddf8478dddd847Ab5d98482dddb8487dddc8488ddde8489bdaf848Bdde4848Cdde5848Eddf58497c3c98499cbe2849Cddf284A1d8e184AFc6d184B2ddf484B4d5f484B8ddf384B9ddf084BAddec84BDddef84BFdde884C1d0ee84C4c8d884C9ddee84CAdde984CDddea84D0cbf284D1dded84D3b1cd84D6c0b684DDbcbb84DFddf184E0ddf784E3ddf684E5ddeb84E6c5ee84ECddfb84F0dea484FCdea384FFddf8850Cc3ef8511c2fb8513d5e18517ceb5851Addfd851Fb2cc8521c4e8852Bcadf852Cc7be8537ddfa8538ddfc8539ddfe853Adea2853Bb0aa853Cb1ce853Ddeac8543dea68548bdb68549c8ef854Adea18556dea58559dea9855Edea88564dea78568dead8572d4cc8574deb38579deaa857Adeae857Bc0d9857Eb1a18584deb68585deb18587deb2858Fd1a6859Bdeb5859Cdeaf85A4deb085A8d0bd85AAdeb485AEcaed85AFdeb985B0deb885B7deb785B9debb85C1bde585C9b2d885CFc3ea85D0deba85D3c5ba85D5debc85DCccd985E4b7aa85E9d4e585FBdebd85FFdebf8605c4a28611dec18616debe8627dec08629d5ba8638dec2863Cf2ae864Dbba2864Ec2b2864Fc5b08650c2c78651f2af8654d0e9865Ad3dd865Eebbd8662b3e6866Bf2b0866Cf2b1866Ecaad8671bae78679f2b3867Af2b5867Bf2b4867Ccbe4867Dcfba867Ef2b2867Fcab48680d2cf8681c2ec8682cec3868Af2b8868Bb0f6868Cf2b7868Df2be8693b2cf8695d1c1869Cf2ba869Df2bc86A3d4e986A4f2bb86A7f2b686A8f2bf86A9f2bd86AAf2b986ACf2c786AFf2c486B0f2c686B1f2ca86B4f2c286B5f2c086B6f2c586BAd6fb86C0f2c186C4c7f986C6c9df86C7f2c886C9b9c686CAb5b086CBf2c386CEf2c986CFf2d086D0f2d686D1bbd786D4f2d586D8cddc86D9d6eb86DBf2d286DEf2d486DFb8f286E4f2cb86E9f2ce86EDc2f986EEd5dd86F0f2cc86F1f2cd86F2f2cf86F3f2d386F4f2d986F8d3bc86F9b6ea86FEcaf18700b7e48702f2d78703f2d88707f2da8708f2dd8709f2db870Af2dc870Dd1d18712f2d18713cdc98715cecf8717d6a98718f2e3871Ac3db871Cf2e0871Ec0af8721f2ec8722f2de8723f2e18725f2e88729f2e2872Ef2e78731f2e68734f2e98737f2df873Bf2e4873Ef2ea873Fd3ac8747f2e58748b2f58749f2f2874Cd0ab874Ef2f58753bbc88757f2f98759f2f08760f2f68763f2f88764f2fa8765f2f3876Ef2f18770bafb8774b5fb8776f2ef877Bf2f7877Cf2ed877Df2ee877Ef2eb8782f3a68783f3a38785f3a28788f2f4878Bc8da878Df2fb8793f3a58797c3f8879Ff2fd87A8f3a787ABf3a987ACf3a487ADf2fc87AFf3ab87B3f3aa87B5c2dd87BAf3ae87BDf3b087C0f3a187C6f3b187CAf3ac87CBf3af87D1f2fe87D2f3ad87D3f3b287DBf3b487E0f3a887E5f3b387EAf3b587EEd0b787F9f3b887FEd9f98803f3b9880Af3b78813c8e48815f3b68816f3ba881Bf3bb8821b4c08822eec38832f3bc8839f3bd883Cd1aa8840f4ac8844d0c68845d0d0884Cd1dc884Dcfce8854bdd68857d1c38859bae28861e1e98862d2c28863f1c28864b2b98865b1ed8868f1c38869c9c0886Bb3c4886Cd9f2886Ecba58870f1c48872d6d48877f1c5887Df4c0887Ef1c6887Fd4ac8881f1c78882b0c08884f4c18885f4c28888b4fc888Bc5db888Dccbb8892d0e48896cde0889Cf1c888A2d9f388A4b1bb88ABcfae88ADb8a488B1f1ca88B7f1cb88BCb2c388C1c1d188C2d7b088C5f1c988C6f1cc88C9f1ce88CEd9f688D2d2e188D4d4a388D5f4c388D8c8b988D9f4c488DFf1cd88E2f1cf88E3bfe388E4f1d088E5f1d488E8f1d688F0f1d188F1c9d188F3c5e188F4c2e388F8b9fc88F9f1d388FCf1d588FEb9d38902f1db890Abad68910b0fd8912f1d98913f1d88919f1d2891Af1da891Bf1d78921c8ec8925cdca892Af1dd892Be5bd8930f1dc8934f1de8936f1df8941cfe58944f4c5895Ebdf3895Ff1e08966f1e1897Bcef7897Fd2aa8981f1fb8983b8b28986bcfb89C1b9db89C2b9e689C4c3d989C5cad389C6eae889C7c0c089C8bef589C9eae989CAeaea89CBeaeb89CCeaec89CEeaed89CFeaee89D0eaef89D1bdc789D2f5fb89D6f5fd89DAf5fe89DCf5fc89DEbde289E3f6a189E5b4a589E6f6a289EBf6a389EFecb289F3d1d48A00d9ea8A07f6a48A3Eeeba8A48d5b28A79d3fe8A89ccdc8A8Acac48A93e5c08B07f6a58B26beaf8B66c6a98B6Cdaa58BA0bcc68BA1b6a98BA2b8bc8BA3c8cf8BA4bca58BA5daa68BA6daa78BA7ccd68BA8c8c38BA9daa88BAAc6fd8BABd1b58BADd2e98BAEd1b68BAFbcc78BB0bdb28BB2bbe48BB3daa98BB4daaa8BB5d1c88BB6daab8BB7d0ed8BB8b6ef8BB9c2db8BBAcbcf8BBCb7ed8BBDc9e88BBEb7c38BBFbef78BC0d6a48BC1daac8BC2daad8BC3c6c08BC4d7e78BC5cab68BC6d5a98BC8cbdf8BC9d5ef8BCAdaae8BCBd6df8BCCb4ca8BCDdab08BCEdaaf8BCFd2eb8BD1dab18BD2dab28BD3dab38BD4cad48BD5dab48BD6caab8BD7dab58BD8dab68BD9b3cf8BDAd6ef8BDBdab78BDCbbb08BDDb5ae8BDEdab88BDFdab98BE0b9ee8BE1d1af8BE2d2e88BE3daba8BE4b8c38BE5cfea8BE6b2ef8BE7dabb8BE8dabc8BE9bdeb8BEBcedc8BECd3ef8BEDdabd8BEEcef38BEFdabe8BF0d3d58BF1bbe58BF2dabf8BF3cbb58BF4cbd08BF5dac08BF6c7eb8BF7d6ee8BF8dac18BF9c5b58BFAb6c18BFBdac28BFCb7cc8BFDbfce8BFEdac38BFFdac48C00cbad8C01dac58C02b5f78C03dac68C04c1c28C05d7bb8C06dac78C07ccb88C08d2ea8C0Ac4b18C0Bdac88C0Cb5fd8C0Dbbd18C0Edac98C0Fd0b38C10daca8C11dacb8C12cebd8C13dacc8C14dacd8C15dace8C16b2f78C17dad18C18dacf8C19d1e88C1Adad08C1Bc3d58C1Cdad28C1Ddad38C1Fdad48C20dad58C21d0bb8C22d2a58C23b0f98C24dad68C25c7ab8C26dad78C27bdf78C28c3a18C29dad88C2Adad98C2Bc3fd8C2Cccb78C2Ddada8C2Edadb8C2Fc0be8C30c6d78C31dadc8C32dadd8C33c7b48C34dade8C35dadf8C36b9c88C37bbed8C41b6b98C46f4f88C47f4f98C49cde38C4Cf5b98C55ebe08C5Acff38C61bbbf8C62bac08C6Ad4a58C6Be1d98C73f5f48C78b1aa8C79b2f28C7Af5f58C82f5f78C85bad18C89f5f68C8Ac3b28C8Cf5f98C94f5f88C98b1b48D1Dd5ea8D1Eb8ba8D1Fb9b18D21b2c68D22d4f08D23cfcd8D24b0dc8D25d5cb8D26bbf58D27d6ca8D28b7b78D29ccb08D2Ac6b68D2Bb1e18D2Cb9ba8D2Dd6fc8D2Eb9e18D2Fb7a18D30bcfa8D31eada8D32eadb8D33ccf98D34b9f38D35eadc8D36b4fb8D37c3b38D38b7d18D39bad88D3Aeadd8D3Bd4f48D3Ceade8D3Dbcd68D3Ebbdf8D3Feadf8D40c1de8D41c2b88D42d4df8D43d7ca8D44eae08D45eae18D46eae48D47eae28D48eae38D49c9de8D4Ab8b38D4Bb6c48D4Ceae58D4Dcaea8D4Ec9cd8D4Fb4cd8D50e2d98D53c5e28D54eae68D55c0b58D56d7b88D58eae78D59d7ac8D5Ac8fc8D5Bd8d38D5Cd8cd8D5Dd4de8D5Ed4f98D60c9c48D61d3ae8D62b8d38D63b3e08D64c9e28D66f4f68D67bad58D6Bf4f78D6Dd7df8D70f4f18D73b8b08D74d5d48D75b8cf8D76c6f08D77b3c38D81f4f28D84b3ac8D85d4bd8D8Ac7f78D8Bf4f48D91f4f38D94cccb8D9Fc8a48DA3f4f58DB1d7e38DB3c5bf8DB4f5c08DB5f5bb8DB8f5c38DBAf5c28DBCd6ba8DBEf5c18DBFd4be8DC3f5c48DC4f5cc8DC6b0cf8DCBb5f88DCCf5c98DCEf5ca8DCFc5dc8DD1f5c58DD6f5c68DD7f5c78DDAf5cb8DDBbee08DDDf5c88DDEb8fa8DDFf5d08DE3f5d38DE4bfe78DE8b9f28DEAf5bc8DEBf5cd8DECc2b78DEFccf88DF3bcf98DF5f5ce8DF7f5cf8DF8f5d18DF9b6e58DFAf5d28DFBf5d58DFDf5bd8E05f5d48E09d3bb8E0Ab3ec8E0Ccca48E0Ff5d68E14f5d78E1Dbee18E1Ef5d88E1Fccdf8E22f5db8E23b2c88E29d7d98E2Af5d98E2Cf5da8E2Ef5dc8E2Ff5e28E31f5e08E35f5df8E39f5dd8E3Af5e18E3Df5de8E40f5e48E41f5e58E42cce38E44e5bf8E47b5b88E48f5e38E49f5e88E4Acca38E4Bf5e68E51f5e78E52f5be8E59b1c48E66f5bf8E69b5c58E6Cb2e48E6Df5ec8E6Ff5e98E70b6d78E72f5ed8E74f5ea8E76f5eb8E7Cb4da8E7Fd4ea8E81f5ee8E85b3f98E87f5ef8E8Ff5f18E90f5f08E94f5f28E9Cf5f38E9Ec9ed8EABb9aa8EACc7fb8EAFb6e38EB2ccc98EBAeaa68ECEb3b58F66d4fe8F67b9ec8F68d0f98F69e9ed8F6Bd7aa8F6Ce9ee8F6Dc2d68F6Ec8ed8F6Fbae48F70e9ef8F71e9f08F72e9f18F73d6e18F74e9f28F75e9f38F76e9f58F77e9f48F78e9f68F79e9f78F7Ac7e18F7Be9f88F7Cd4d88F7De9f98F7Ebdce8F7Fe9fa8F81e9fb8F82bdcf8F83e9fc8F84b8a88F85c1be8F86e9fd8F87b1b28F88bbd48F89b9f58F8Ae9fe8F8Beaa18F8Deaa28F8Eeaa38F8Fb7f88F90bcad8F91cae48F93e0ce8F94d4af8F95cfbd8F96d5b78F97eaa48F98d5de8F99eaa58F9Ad0c18F9Bb9bc8F9Cb4c78F9Eb1d98F9Fc0b18FA3b1e68FA8b1e78FA9b1e88FABb3bd8FB0c8e88FB1e5c18FB6b1df8FB9c1c98FBDb4ef8FBEc7a88FC1d3d88FC2c6f98FC4d1b88FC5b9fd8FC7c2f58FC8d3ad8FCEd4cb8FD0bdfc8FD1e5c28FD3b7b58FD4e5c38FD5bbb98FD8d5e28FD9bdf88FDBd4b68FDCcea58FDDc1ac8FDEb3d98FDFccf68FE2e5c68FE4e5c48FE5e5c88FE6e5ca8FE8e5c78FE9b5cf8FEAc6c88FEBb5fc8FEDe5c58FEEcaf68FF0e5c98FF3c3d48FF7b1c58FF8bca38FF9d7b78FFDcdcb9000cbcd9001caca9002ccd39003e5cc9004e5cb9005c4e69006d1a19009d1b7900Ae5cd900Be5d0900Dcdb8900Fd6f09010e5cf9011b5dd9012cdbe9014e5d19016b6ba9017cda8901Ab9e4901Bcac5901Db3d1901Ecbd9901Fd4ec9020e5d29021b7ea9022e5ce9026e5d5902Db4fe902Ee5d6902Fe5d39035e5d49036d2dd9038c2df903Bb1c6903Cd3e2903Eb6dd9041cbec9042e5d79044d3f69047b1e9904Db6f4904Fe5da9050e5d89051e5d99052b5c09053d2c59057e5dc9058e5de905Be5dd9062c7b29063d2a39065e5db9068d4e2906Dd5da906Ee5e09074d7f19075e5e1907Db1dc907Fd1fb9080e5e29082e5e49083e5e39088e5e5908Bd2d89091b5cb9093e7df9095daf59097daf89099daf6909Bdaf7909Ddafa90A1d0cf90A2c4c790A3b0ee90A6d0b090AAdaf990ACd3ca90AEbaaa90AFdba290B0c7f190B1dafc90B3dafb90B4c9db90B5dafd90B6dba190B8d7de90B9dafe90BAc1da90BBdba590BEd3f490C1dba790C4dba490C5dba890C7bdbc90CAc0c990CEdba390CFdba690D0d6a390D1dba990D3dbad90D7dbae90DBdbac90DCbac290DDbfa490E1dbab90E2dbaa90E6d4c790E7b2bf90E8dbaf90EBb9f990EDdbb090EFb3bb90F4b5a690F8b6bc90FDdbb190FEb6f59102dbb29104b1c99119dbb4911Edbb39122dbb59123dbb7912Fdbb69131dbb89139dbb99143dbba9146d3cf9149f4fa914Ac7f5914Bd7c3914Cc5e4914Df4fc914Ef4fd914Ff4fb9150bec69152d0ef9157b7d3915Ad4cd915Dccaa915Ef5a29161f5a19162baa89163f4fe9164cbd69165f5a49169c0d2916Ab3ea916Ccdaa916Ef5a5916Ff5a39170bdb49171f5a89172f5a99174bdcd9175c3b89176bfe19177cbe19178f5aa9179f5a6917Df5a7917Ec4f0917Ff5ac9185b4bc9187d7ed9189b4d7918Bf5ab918Cf5ae918Df5ad9190f5af9191d0d19192c3d1919Ac8a9919Bf5b091A2f5b191A3f5b291AAf5b391ADf5b491AEf5b591AFf5b791B4f5b691B5f5b891BAb2c991C7d3d491C9cacd91CAc0ef91CCd6d891CDd2b091CEc1bf91CFbdf091D1b8aa91DCbcf89274f6c6928Ef6c792AEf6c892C8f6c9933Ef6ca936Af6cc938Ff6cb93CAf7e993D6f6cd943Ef6ce946Beec49485eec59486eec69487d5eb9488b6a49489eec8948Aeec7948Beec9948Ceeca948Dc7a5948Eeecb948Feecc9490b7b09492b5f69493eecd9494eecf9495eece9497b8c69499eed0949Aeed1949Beed2949Cb6db949Db3ae949Ed6d3949Fc4c694A0b1b594A1b8d694A2eed394A3eed494A4d4bf94A5c7d594A6befb94A7ced994A8b9b394A9eed694AAeed594ABeed894ACeed794ADc5a594AEeed994AFeeda94B0c7ae94B1eedb94B2c7af94B3eedc94B4b2a794B5eedd94B6eede94B7eedf94B8eee094B9eee194BAd7ea94BBeee294BCeee394BDbcd894BEeee494BFd3cb94C0ccfa94C1b2ac94C2c1e594C3eee594C4c7a694C5c3ad94C6eee694C8eee794C9eee894CAeee994CBeeea94CCeeeb94CDeeec94CEeeed94D0eeee94D1eeef94D2eef094D5eef194D6eef294D7eef494D8eef394D9eef594DBcdad94DCc2c194DDeef694DEeef794DFeef894E0d5a194E1eef994E2cfb394E3eefa94E4eefb94E5eefc94E7eefd94E8efa194E9eefe94EAefa294EBb8f594ECc3fa94EDefa394EEefa494EFbdc294F0d2bf94F1b2f994F2efa594F3efa694F4efa794F5d2f894F6efa894F7d6fd94F8efa994F9c6cc94FAefaa94FCefab94FDc1b494FEefac94FFcffa9500cbf89501efae9502efad9503b3fa9504b9f89505efaf9506efb09507d0e29508efb19509efb2950Ab7e6950Bd0bf950Cefb3950Defb4950Eefb5950Fc8f19510cce09511efb69512efb79513efb89514efb99515efba9516d5e09517efbb9518b4ed9519c3aa951Aefbc951Befbd951Defbe951Eefbf951Fcefd9521efc09522c2e09523b4b89524d7b69525bdf59526cfc79528efc39529efc1952Aefc2952Befc4952Cb6a7952Dbcfc952Ebee2952Fc3cc9530efc59531efc69532efc79534efcf9535efc89536efc99537efca9538c7c29539eff1953Ab6cd953Befcb953Cefcc953Eefcd953Fb6c69540c3be9541efce9542efd09544efd19545efd29546d5f29547efd39549c4f7954Aefd4954Cc4f8954Defd5954Eefd6954Fb8e49550b0f79551efd79552efd89553efd99554efda9556efdb9557efdc9558efdd9559efde955Bbeb5955Cefe1955Defdf955Eefe0955Fefe29561efe39562c1cd9563efe49564efe59565efe69566efe79567efe89568efe99569efea956Aefeb956Befec956Cc0d8956Defed956Fc1ad9570efee9571efef9572eff09573cfe29576b3a4957Fc3c595E8e3c595E9c9c195EAe3c695EBb1d595EDceca95EEb4b395EFc8f295F0e3c795F1cfd095F2e3c895F3bce495F4e3c995F5e3ca95F6c3c695F7d5a295F8c4d695F9b9eb95FAcec595FBe3cb95FCc3f695FDe3cc95FEb7a79600b8f39601bad29602e3cd9603e3ce9604d4c49605e3cf9606e3d09608d1cb9609e3d1960Ae3d2960Be3d3960Ce3d4960Dd1d6960Ee3d5960Fb2fb9610c0bb9611e3d69612c0ab9614e3d79615e3d89616e3d99617e3da9619e3db961Ab8b7961Cdae2961Db6d3961Fdae49621dae39622dae6962Ac8ee962Edae59631b7c09632d1f49633d2f59634d5f39635bdd79636d7e8963Bdae8963Cdae7963Db0a2963Fcdd39640dae99642b8bd9644bcca9645c2bd9646c2a49647b3c29648daea9649c2aa964Bc4b0964Cbdb5964Dcfde9650daeb9654c9c29655b1dd965Bdaec965Fb6b89661d4ba9662b3fd9664daed9667d4c99668cfd59669c5e3966Adaee966Cdaef9672daf09674c1ea9675ccd59676cfdd9677d3e79685c2a19686daf19688cbe5968Bdaf2968Dcbe6968Fd2fe9690b8f49694daf39697b0af9698cfb69699d5cf969Ccbed96A7daf496B0e3c496B3c1a596B6f6bf96B9f6c096BCf6c196BDc4d196BEc8b896C0d1e396C1d0db96C4d1c596C5bcaf96C6b9cd96C7eff496C9b4c696CCd3ba96CDf6c296CEb3fb96CFf6c396D2b5f196D5f6c596E0d3ea96E8f6a796E9d1a996EAf6a996EFf6a896F3c1e396F6c0d796F7b1a296F9ceed96FEd0e89700f6ab9701cff69704f6aa9706d5f09707f6ac9708c3b99709bbf4970Df6ae970Ef6ad970Fc4de9713c1d89716cbaa971Ccfbc971Ef6af972Af6b0972Df6b19730c2b69732b0d49738c5f99739f6b2973Ec7e09752f6a69753beb89756beb29759b5e5975Bb7c7975Ebfbf9760c3d29761c3e69762d8cc9765b8ef9769bdf99773d1a59774b0d09776f7b0977Cf7b19785d0ac978Bb0b0978Df7b29791f7b39792f7b49794c7ca9798becf97A0f7b797A3f7b697ABb1de97ADf7b597AFf7b897B2f7b997B4cea497E6c8cd97E7baab97E9e8b897EAe8b997EBe8ba97ECbec297EDd2f497F3d4cf97F5c9d897F6d2b39875b6a59876c7ea9877f1fc9878cfee9879cbb3987Ad0eb987Be7ef987Ccde7987Db9cb987Eb6d9987Ff1fd9880b0e49881cbcc9882f1fe9883d4a49884c2ad9885c1ec9886c6c49887beb19888f2a19889bcd5988Af2a2988Cf2a3988Df2a4988Fd2c39890c6b59891cdc79893f2a59894d3b19896bfc59897cce29898f2a6989Af2a7989Bd1d5989Cb6ee989Df2a8989Ef2a9989Fb5df98A0f2aa98A1f2ab98A2b2fc98A4f2ac98A5f2ad98A6c8a798A7b7e798CEeca998D1ecaa98D2ecab98D3ecac98D5c6ae98D8ecad98D9ecae98DAb7c998DEcab398DFe2b898E7f7cf98E8f7d0990Db2cd9910f7d1992Ef7d39954f7d29955e2bb9963bca29965e2bc9967e2bd9968e2be9969e2bf996Ae2c0996Be2c1996Cb7b9996Dd2fb996Ebda4996Fcace9970b1a59971cbc79972e2c29974b6fc9975c8c49976e2c39977bdc8997Ab1fd997Ce2c4997Db6f6997Fe2c59980c4d99981e2c69984cfda9985b9dd9986e2c79987c0a19988e2c8998Ab2f6998Be2c9998Dc1f3998Fe2ca9990e2cb9991c2f89992e2cc9993e2cd9994e2ce9995cad79996d8b89997d9e59998cfe39999f0a599A5dcb099A8c2ed9A6Cd4a69A6Dcdd49A6Ed1b19A6Fb3db9A70c7fd9A71b2b59A73c2bf9A74e6e09A75cabb9A76e6e19A77e6e29A78bed49A79e6e39A7Ad7a49A7Bcdd59A7Ce6e59A7Dbcdd9A7Ee6e49A7Fe6e69A80e6e79A81c2ee9A82bdbe9A84e6e89A85c2e69A86baa79A87e6e99A88e6ea9A8Ab3d29A8Bd1e99A8Cbfa59A8Fe6eb9A90c6ef9A91e6ec9A92e6ed9A93e6ee9A96c6ad9A97e6ef9A98c9a79A9Ae6f09A9Be6f19A9Ce6f29A9De5b99A9Ee6f39A9Fe6f49AA0c2e29AA1e6f59AA2e6f69AA3d6e89AA4e6f79AA5e6f89AA7b9c79AA8f7bb9AB0f7ba9AB1f7be9AB6f7bc9AB7baa19AB8f7bf9ABAf7c09ABCf7c29AC0f7c19AC1f7c49AC2f7c39AC5f7c59ACBf7c69ACCf7c79AD1cbe89AD3b8df9AD8f7d49ADFf7d59AE1f7d69AE6f7d89AEBf7da9AEDf7d79AEFf7db9AF9f7d99AFBd7d79B03f7dc9B08f7dd9B0Ff7de9B13f7df9B1Ff7e09B23dbcb9B2Fd8aa9B32e5f79B3Bb9ed9B3Cbffd9B41bbea9B42f7c99B43c6c79B44f7c89B45f7ca9B47f7cc9B48f7cb9B49f7cd9B4Dceba9B4Ff7ce9B51c4a79B54d3e39C7Cf6cf9C7Fc2b39C81f6d09C82f6d19C85f6d29C86f6d39C87f6d49C88f6d69C8Bb1ab9C8Df6d79C8Ef6d89C90f6d99C91f6da9C92f6db9C94f6dc9C95f6dd9C9Af6de9C9Bcfca9C9Cf6df9C9Ef6e09C9Ff6e19CA0f6e29CA1f6e39CA2f6e49CA3c0f09CA4f6e59CA5f6e69CA6f6e79CA7f6e89CA8f6e99CA9f6ea9CABf6eb9CADf6ec9CAEf6ed9CB0f6ee9CB1f6ef9CB2f6f09CB3f6f19CB4f6f29CB5f6f39CB6f6f49CB7bea89CB8f6f59CBAf6f69CBBf6f79CBCf6f89CBDc8fa9CC3f6f99CC4f6fa9CC5f6fb9CC6f6fc9CC7f6fd9CCAf6fe9CCBf7a19CCCf7a29CCDf7a39CCEf7a49CCFf7a59CD0f7a69CD3f7a79CD4f7a89CD5b1ee9CD6f7a99CD7f7aa9CD8f7ab9CD9f7ac9CDCf7ad9CDDc1db9CDEf7ae9CDFf7af9CE2c4f19E1Ff0af9E20bca69E21f0b09E22c3f99E23c5b89E25d1bb9E26f0b19E28f0b29E29f0b39E2Af0b49E2Bf0b59E2Cd1bc9E2Dd1ec9E2Ff0b79E31f0b69E32d4a79E33cdd29E35f0b89E36f0ba9E37f0b99E38f0bb9E39f0bc9E3Ab8eb9E3Df0bd9E3Ebae89E3Ff0be9E41f0bf9E42bee99E43f0c09E44b6ec9E45f0c19E46f0c29E47f0c39E48f0c49E49c8b59E4Af0c59E4Bf0c69E4Cf0c79E4Ec5f49E4Ff0c89E51f0c99E55f0ca9E57f7bd9E58f0cb9E5Af0cc9E5Bf0cd9E5Cf0ce9E5Ef0cf9E63bad79E64f0d09E66f0d19E67f0d29E68f0d39E69f0d49E6Af0d59E6Bf0d69E6Cf0d89E6Dd3a59E70f0d79E71f0d99E73f5ba9E7Ec2b99E7Ff7e49E82f7e59E87f7e69E88f7e79E8Bf7e89E92c2b49E93f7ea9E9Df7eb9E9Fc2f39EA6f4f09EB4f4ef9EB8c2e99EBBf7e19EBDf7e29EBEbbc69EC4d9e49EC9caf29ECDc0e89ECEf0a49ECFbada9ED1c7ad9ED4c4ac9ED8f7ec9EDBf7ed9EDCf7ee9EDDf7f09EDFf7ef9EE0f7f19EE2f7f49EE5f7f39EE7f7f29EE9f7f59EEAf7f69EEFede99EF9edea9EFBedeb9EFCf6bc9EFEf6bd9F0Bf6be9F0Db6a69F0Ed8be9F10b9c49F13d8bb9F17dcb19F19caf39F20f7f79F22f7f89F2Cf7f99F2Ff7fb9F37f7fa9F39b1c79F3Bf7fc9F3Df7fd9F3Ef7fe9F44c6eb9F50ecb49F51b3dd9F7Ff6b39F80f6b49F83c1e49F84f6b59F85f6b69F86f6b79F87f6b89F88f6b99F89f6ba9F8Ac8a39F8Bf6bb9F8Cc1fa9F99b9a89F9Aede89F9Bb9ea9F9Fd9df9FA0a3a1FF01a3a2FF02a3a3FF03a1e7FF04a3a5FF05a3a6FF06a3a7FF07a3a8FF08a3a9FF09a3aaFF0Aa3abFF0Ba3acFF0Ca3adFF0Da3aeFF0Ea3afFF0Fa3b0FF10a3b1FF11a3b2FF12a3b3FF13a3b4FF14a3b5FF15a3b6FF16a3b7FF17a3b8FF18a3b9FF19a3baFF1Aa3bbFF1Ba3bcFF1Ca3bdFF1Da3beFF1Ea3bfFF1Fa3c0FF20a3c1FF21a3c2FF22a3c3FF23a3c4FF24a3c5FF25a3c6FF26a3c7FF27a3c8FF28a3c9FF29a3caFF2Aa3cbFF2Ba3ccFF2Ca3cdFF2Da3ceFF2Ea3cfFF2Fa3d0FF30a3d1FF31a3d2FF32a3d3FF33a3d4FF34a3d5FF35a3d6FF36a3d7FF37a3d8FF38a3d9FF39a3daFF3Aa3dbFF3Ba3dcFF3Ca3ddFF3Da3deFF3Ea3dfFF3Fa3e0FF40a3e1FF41a3e2FF42a3e3FF43a3e4FF44a3e5FF45a3e6FF46a3e7FF47a3e8FF48a3e9FF49a3eaFF4Aa3ebFF4Ba3ecFF4Ca3edFF4Da3eeFF4Ea3efFF4Fa3f0FF50a3f1FF51a3f2FF52a3f3FF53a3f4FF54a3f5FF55a3f6FF56a3f7FF57a3f8FF58a3f9FF59a3faFF5Aa3fbFF5Ba3fcFF5Ca3fdFF5Da1abFF5Ea1e9FFE0a1eaFFE1a3feFFE3a3a4FFE5";class jw{static get specifiedPairSymbols(){if(!jw._specifiedPairSymbols){const e=zw.match(/.{1,4}/g),t={};let r;f.ListUtils.forEach(e,(e=>{r?(t[r.toLowerCase()]=parseInt(e,16),r=null):r=e})),jw._specifiedPairSymbols=t}return jw._specifiedPairSymbols}static getChars(e){const t=[];let r=0;const i=e.length;return f.ListUtils.forEach(e,((e,n)=>{const o=i-1==n;if(r<128)r=e.charCodeAt(0),(r<128||o)&&t.push(e);else{const i=os.numberToHex(e.charCodeAt(0)),n=jw.specifiedPairSymbols[os.numberToHex(r)+i];t.push(n?String.fromCharCode(n):""),r=0}})),t}}jw._specifiedPairSymbols=null;class Xw{static decode(e){if(null==e)return null;const t=[];for(let r=0;r<e.length;r++){const i=e.charCodeAt(r),n=Xw.map[i];n?t.push(String.fromCharCode(n)):t.push(String.fromCharCode(i))}return t.join("")}}Xw.map={128:1026,129:1027,130:8218,131:1107,132:8222,133:8230,134:8224,135:8225,136:8364,137:8240,138:1033,139:8249,140:1034,141:1036,142:1035,143:1039,144:1106,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,153:8482,154:1113,155:8250,156:1114,157:1116,158:1115,159:1119,160:160,161:1038,162:1118,163:1032,164:164,165:1168,166:166,167:167,168:1025,169:169,170:1028,171:171,172:172,173:173,174:174,175:1031,176:176,177:177,178:1030,179:1110,180:1169,181:181,182:182,183:183,184:1105,185:8470,186:1108,187:187,188:1112,189:1029,190:1109,191:1111,192:1040,193:1041,194:1042,195:1043,196:1044,197:1045,198:1046,199:1047,200:1048,201:1049,202:1050,203:1051,204:1052,205:1053,206:1054,207:1055,208:1056,209:1057,210:1058,211:1059,212:1060,213:1061,214:1062,215:1063,216:1064,217:1065,218:1066,219:1067,220:1068,221:1069,222:1070,223:1071,224:1072,225:1073,226:1074,227:1075,228:1076,229:1077,230:1078,231:1079,232:1080,233:1081,234:1082,235:1083,236:1084,237:1085,238:1086,239:1087,240:1088,241:1089,242:1090,243:1091,244:1092,245:1093,246:1094,247:1095,248:1096,249:1097,250:1098,251:1099,252:1100,253:1101,254:1102,255:1103};class Gw{static decode(e,t){return t==Fw.Russian?Xw.decode(e):t==Fw.default?Aw.decode(e,Nw):t==Fw.Ansi?Aw.decode(e,kw):t==Fw.Greek?Aw.decode(e,Ow):t==Fw.Turkis?Aw.decode(e,_w):t==Fw.Hebrew?Aw.decode(e,Uw):t==Fw.Arabic?Aw.decode(e,Hw):t==Fw.Baltic?Aw.decode(e,Vw):t==Fw.Vietnamese?Aw.decode(e,Ww):e}static getChars(e,t){return t==Fw.GB2315?jw.getChars(e):t==Fw.Hangul?Bw.getChars(e):e}}class Kw{}class qw extends Kw{constructor(e){super(),this.codePage=e,this._bytes=[]}processChar(e,t){this._bytes.length==qw.capacity&&this.flush(e),this._bytes.push(t)}flushByChar(e,t){const r=t.length;for(let i=0;i<r;i++)e.processChar(t[i])}flushByString(e,t){e.destination.processText(t.join(""))}flush(e){if(this._bytes.length>0){const t=Gw.getChars(this._bytes,this.codePage);!e.destination.canAppendText||t.length<=1?this.flushByChar(e,t):this.flushByString(e,t),this._bytes=[]}}}qw.capacity=2048;class $w extends qw{constructor(){super(Fw.default)}processChar(e,t){}flush(e){}}var Jw,Yw,Qw,Zw,ey,ty,ry,iy,ny,oy,ay,sy,ly,dy,cy,hy,uy,py,gy,my,fy,by,Cy,Sy,Iy,Py;!function(e){e[e.ShapePictureDestination=0]="ShapePictureDestination",e[e.SectionHeaderFooterDestinationBase=1]="SectionHeaderFooterDestinationBase",e[e.ShapePropertiesDestinationBase=2]="ShapePropertiesDestinationBase",e[e.ShapeDestinationBase=3]="ShapeDestinationBase",e[e.HyperlinkPropertyValueDestination=4]="HyperlinkPropertyValueDestination",e[e.RangePermissionDestinationBase=5]="RangePermissionDestinationBase",e[e.DestinationOldParagraphNumberingBase=6]="DestinationOldParagraphNumberingBase",e[e.FieldSubDestination=7]="FieldSubDestination",e[e.UnicodeStringValueDestination=8]="UnicodeStringValueDestination",e[e.StringValueDestinationBase=9]="StringValueDestinationBase",e[e.StringValueDestination=10]="StringValueDestination",e[e.HexContentDestination=11]="HexContentDestination",e[e.BookmarkDestinationBase=12]="BookmarkDestinationBase",e[e.EmptyDestination=13]="EmptyDestination",e[e.UnicodeDestination=14]="UnicodeDestination",e[e.SkipDestination=15]="SkipDestination",e[e.DestinationRevisionAuthorTable=16]="DestinationRevisionAuthorTable",e[e.UserTableDestination=17]="UserTableDestination",e[e.FontTableDestination=18]="FontTableDestination",e[e.ColorTableDestination=19]="ColorTableDestination",e[e.PictureDestination=20]="PictureDestination",e[e.DefaultDestination=21]="DefaultDestination",e[e.FormFieldNameDestination=22]="FormFieldNameDestination",e[e.TableContentFieldDestination=23]="TableContentFieldDestination",e[e.FormFieldHelpTextDestination=24]="FormFieldHelpTextDestination",e[e.FieldStatusBarTextDestination=25]="FieldStatusBarTextDestination",e[e.FormFieldEntryMacroDestination=26]="FormFieldEntryMacroDestination",e[e.FormFieldExitMacroDestination=27]="FormFieldExitMacroDestination",e[e.InfoDestination=28]="InfoDestination",e[e.CustomPropertiesDestination=29]="CustomPropertiesDestination",e[e.StringPropertyDestination=30]="StringPropertyDestination",e[e.MailMergeDestination=31]="MailMergeDestination",e[e.StringPropertyBaseDestination=32]="StringPropertyBaseDestination",e[e.FieldMapDataDestination=33]="FieldMapDataDestination",e[e.BookmarkStartDestination=34]="BookmarkStartDestination",e[e.BookmarkEndDestination=35]="BookmarkEndDestination",e[e.RangePermissionStartDestination=36]="RangePermissionStartDestination",e[e.RangePermissionEndDestination=37]="RangePermissionEndDestination",e[e.DocumentVariableDestination=38]="DocumentVariableDestination",e[e.TextBeforeDestination=39]="TextBeforeDestination",e[e.TextAfterDestination=40]="TextAfterDestination",e[e.DestinationOldSectionNumberingLevel=41]="DestinationOldSectionNumberingLevel",e[e.DestinationOldParagraphNumbering=42]="DestinationOldParagraphNumbering",e[e.SkipNestedTableDestination=43]="SkipNestedTableDestination",e[e.CodeFieldDestination=44]="CodeFieldDestination",e[e.FieldDestination=45]="FieldDestination",e[e.FormFieldDestination=46]="FormFieldDestination",e[e.ResultFieldDestination=47]="ResultFieldDestination",e[e.DestinationSubDocument=48]="DestinationSubDocument",e[e.StyleSheetDestination=49]="StyleSheetDestination",e[e.CharacterStyleDestination=50]="CharacterStyleDestination",e[e.TableStyleDestination=51]="TableStyleDestination",e[e.PageBackgroundDestination=52]="PageBackgroundDestination",e[e.ShapeInstanceDestination=53]="ShapeInstanceDestination",e[e.ShapeDestination=54]="ShapeDestination",e[e.SectionPageFooterDestination=55]="SectionPageFooterDestination",e[e.SectionPageHeaderDestination=56]="SectionPageHeaderDestination",e[e.ListTableDestination=57]="ListTableDestination",e[e.ListNameDestination=58]="ListNameDestination",e[e.ListStyleNameDestination=59]="ListStyleNameDestination",e[e.ListLevelDestination=60]="ListLevelDestination",e[e.ListLevelTextDestination=61]="ListLevelTextDestination",e[e.ListLevelNumbersDestination=62]="ListLevelNumbersDestination",e[e.ListOverrideTableDestination=63]="ListOverrideTableDestination",e[e.ListOverrideLevelDestination=64]="ListOverrideLevelDestination",e[e.DefaultCharacterPropertiesDestination=65]="DefaultCharacterPropertiesDestination",e[e.DefaultParagraphPropertiesDestination=66]="DefaultParagraphPropertiesDestination",e[e.ShapePropertyNameDestination=67]="ShapePropertyNameDestination",e[e.ShapePropertyDestination=68]="ShapePropertyDestination",e[e.ShapePropertyValueDestination=69]="ShapePropertyValueDestination",e[e.ShapeTextDestination=70]="ShapeTextDestination",e[e.ShapePropertyHyperlinkDestination=71]="ShapePropertyHyperlinkDestination",e[e.ShapePropertyHsvValueDestination=72]="ShapePropertyHsvValueDestination",e[e.HyperlinkSourceValueDestination=73]="HyperlinkSourceValueDestination",e[e.HyperlinkLocationValueDestination=74]="HyperlinkLocationValueDestination"}(Jw||(Jw={}));class wy{constructor(){this.charset=-1,this.name="",this._shouldLoad=!1}get shouldLoad(){return this._shouldLoad}get cachedInfo(){return this._cachedInfo}getCoreObjectByName(e){return this._cachedInfo||(this._cachedInfo=e.cache.fontInfoCache.getItemByName(this.name),this._cachedInfo||(this._shouldLoad=!0,this._cachedInfo=e.cache.fontInfoCache.addFont(this.name,this.name))),this._cachedInfo}static createDefaultRtfFontInfo(){const e=new wy;return e.name="Times New Roman",e.id=Bo.Constants.MAX_SAFE_INTEGER,e}static getFontInfo(e,t){const r=e.getItemByName(t);return r||e.addFont(t,t)}}class yy{static setUnicodeFontName(e,t,r){const i=this.calculateCharType(t);(r.useDoubleByteCharactersFontName||r.useLowAnsiCharactersFontName||r.useHighAnsiCharactersFontName)&&yy.setUnicodeFontNameByCharType(e,i,r)}static setUnicodeFontNameByCharType(e,t,r){const i=r.coreProperties;(r.useDoubleByteCharactersFontName||r.useLowAnsiCharactersFontName||r.useHighAnsiCharactersFontName)&&(r.useDoubleByteCharactersFontName&&t==Yw.DoubleByteCharacter?i.setValue(ir.fontInfo,wy.getFontInfo(e,r.doubleByteCharactersFontName)):r.useLowAnsiCharactersFontName&&t==Yw.LowAnsiCharacter?i.setValue(ir.fontInfo,wy.getFontInfo(e,r.lowAnsiCharactersFontName)):r.useHighAnsiCharactersFontName&&t==Yw.HighAnsiCharacter&&i.setValue(ir.fontInfo,wy.getFontInfo(e,r.highAnsiCharactersFontName)))}static isLowAnsiCharacter(e){var t=e.charCodeAt(0);return t>=yy.lowAnsiCharactersStart&&t<=yy.lowAnsiCharactersEnd}static isDoubleByteChar(e){const t=e.charCodeAt(0);return!(t<yy.lowLatinExtendedAdditional)&&(!(t>=yy.lowLatinExtendedAdditional&&t<=yy.highLatinExtendedAdditional)&&(!(t>=yy.lowGeneralPunctuation&&t<=yy.highGeneralPunctuation)&&(!(t>=yy.lowCurrencySymbols&&t<=yy.highCurrencySymbols)&&(!(t>=yy.lowLetterlikeSymbols&&t<=yy.highLetterlikeSymbols)&&(!(t>=yy.lowNumberForms&&t<=yy.highNumberForms)&&(!(t>=yy.lowMathematicalOperations&&t<=yy.highMathematicalOperations)&&!(t>=yy.privateUseAreaStart&&t<=yy.privateUseAreaEnd)))))))}static calculateCharType(e){return yy.isLowAnsiCharacter(e)?Yw.LowAnsiCharacter:yy.isDoubleByteChar(e)?Yw.DoubleByteCharacter:Yw.HighAnsiCharacter}static isHighSurrogate(e){if(!(0,S.isDefined)(e)||e.length>1)return!1;const t=e.charCodeAt(0);return 55296<=t&&t<=56319}static isLowSurrogate(e){if(!(0,S.isDefined)(e)||e.length>1)return!1;const t=e.charCodeAt(0);return 56320<=t&&t<=57343}}yy.highestCyrillic=1279,yy.lowLatinExtendedAdditional=7680,yy.highLatinExtendedAdditional=7929,yy.lowGeneralPunctuation=8192,yy.highGeneralPunctuation=8303,yy.lowCurrencySymbols=8352,yy.highCurrencySymbols=8367,yy.lowLetterlikeSymbols=8448,yy.highLetterlikeSymbols=8506,yy.lowNumberForms=8531,yy.highNumberForms=8579,yy.lowMathematicalOperations=8704,yy.highMathematicalOperations=8945,yy.lowAnsiCharactersStart=0,yy.lowAnsiCharactersEnd=127,yy.highAnsiCharactersStart=128,yy.highAnsiCharactersEnd=255,yy.privateUseAreaStart=57344,yy.privateUseAreaEnd=63743,function(e){e[e.LowAnsiCharacter=0]="LowAnsiCharacter",e[e.DoubleByteCharacter=1]="DoubleByteCharacter",e[e.HighAnsiCharacter=2]="HighAnsiCharacter",e[e.ComplexScriptCharacter=3]="ComplexScriptCharacter"}(Yw||(Yw={}));class xy extends Kw{constructor(){super(...arguments),this._chars=[]}processChar(e,t){this._chars.length>=xy.capacity&&this.flush(e),this._chars.push(t)}flush(e){if(this._chars.length>0){if(!this.canAppendText(e)||this._chars.length<=1)this.flushByChar(e,this._chars);else{const t=this._chars.join("").normalize();this.flushByString(e,t)}this._chars=[]}}canAppendText(e){return e.destination.canAppendText}flushByChar(e,t){const r=[];for(let e=0;e<t.length;e++){const i=t[e],n=t[e+1];n&&yy.isLowSurrogate(n)?(yy.isHighSurrogate(i)?r.push(i+n):r.push(i,n),e++):r.push(i)}for(const t of r)e.processChar(t)}flushByString(e,t){e.destination.processText(t)}}xy.capacity=1024;class Ty{constructor(){this._unicodeCharacterByteCount=1,this._codePage=Fw.default,this.codePageDecoder=new qw(this.codePage),this.unicodeDecoder=new xy,this.activeDecoder=this.codePageDecoder}get unicodeCharacterByteCount(){return this._unicodeCharacterByteCount}set unicodeCharacterByteCount(e){e<0&&aM.throwInvalidRtfFile(),this._unicodeCharacterByteCount=e}get codePage(){return this._codePage}set codePage(e){this._codePage!=e&&(this._codePage=e,this.onCodePageChanged())}onCodePageChanged(){this.codePageDecoder.codePage=this.codePage}clone(){const e=this.createEmptyClone();return e.copyFrom(this),e}createEmptyClone(){return new Ty}copyFrom(e){this.unicodeCharacterByteCount=e.unicodeCharacterByteCount,this.codePage=e.codePage,this.deleted=e.deleted}}!function(e){e[e.Normal=0]="Normal",e[e.BinData=1]="BinData",e[e.HexData=2]="HexData"}(Qw||(Qw={})),function(e){e[e.Text=1]="Text",e[e.LowMetric=2]="LowMetric",e[e.HighMetric=3]="HighMetric",e[e.LowEnglish=4]="LowEnglish",e[e.HighEnglish=5]="HighEnglish",e[e.Twips=6]="Twips",e[e.Isotropic=7]="Isotropic",e[e.Anisotropic=8]="Anisotropic"}(Zw||(Zw={}));class vy{static get empty(){return My._empty}constructor(e){if(e){this.importer=e,this.subDocument=e.subDocument;const t=this.createRtfFormattingInfo();t.copyFrom(e.importers.character.characterFormatting.rtfFormattingInfo),e.importers.character.characterFormatting.rtfFormattingInfo=t}}createRtfFormattingInfo(){return new Ty}get keywordHT(){return this.importer.keywordHTHolder.getHt(this.destinationType)}equals(e){return e.destinationType==this.destinationType}static onSwitchToHexChar(e,t){e.parsingState=Qw.HexData}static onEscapedChar(e,t){e.flushDecoder(),e.destination.processChar(t)}static onUnicodeKeyword(e,t,r){const i=String.fromCharCode(65535&t);e.parseUnicodeChar(i)}static onOptionalGroupChar(e,t){e.destination.nonEmpty||(e.flushDecoder(),e.optionalGroupLevel=e.savedStatesCount)}static onBinKeyword(e,t,r){r&&0!=t?(e.binCharCount=t,e.parsingState=Qw.BinData):e.decreaseSkipCount()}static onAnsiKeyword(e,t,r){e.setCodePage(Fw.default)}static onMacKeyword(e,t,r){e.documentProperties.defaultCodePage=vy.macCodePage,e.setCodePage(vy.macCodePage)}static onPcKeyword(e,t,r){e.documentProperties.defaultCodePage=vy.pcCodePage,e.setCodePage(vy.pcCodePage)}static onPcaKeyword(e,t,r){e.documentProperties.defaultCodePage=vy.pcaCodePage,e.setCodePage(vy.pcaCodePage)}static onAnsiCodePageKeyword(e,t,r){r&&(e.documentProperties.defaultCodePage=t,e.setCodePage(t))}static onHyphAutoKeyword(e,t,r){}static onUnicodeCountKeyword(e,t,r){e.importers.character.characterFormatting.rtfFormattingInfo.unicodeCharacterByteCount=t}get canAppendText(){return!1}canProcessSpecialHexChar(){return!1}processControlChar(e){this.processControlCharCore(e),this.nonEmpty=!0}processKeyword(e,t,r){const i=this.processKeywordCore(e,t,r);return this.nonEmpty=!0,i}processChar(e){this.processCharCore(e),this.nonEmpty=!0}processText(e){this.processTextCore(e),this.nonEmpty=!0}processBinChar(e){this.processBinCharCore(e),this.nonEmpty=!0}processSpecialHexChar(e){this.processSpecialHexCharCore(e),this.nonEmpty=!0}processControlCharCore(e){let t=null;null!=this.controlCharHT&&(t=this.controlCharHT[e]),null==t&&(t=vy.defaultControlCharHT[e]),null!=t&&t(this.importer,e)}processKeywordCore(e,t,r){let i=null;const n=this.keywordHT;return n&&(i=n[e]),null==i&&(i=this.importer.keywordHTHolder.defaultKeywords[e]),null!=i&&(i(this.importer,t,r),!0)}processCharCore(e){}processTextCore(e){}processSpecialHexCharCore(e){}processBinCharCore(e){}beforePopRtfState(){}afterPopRtfState(){}increaseGroupLevel(){}beforeNestedGroupFinished(e){this.beforeNestedGroupFinishedCore(e),this.nonEmpty=!0}beforeNestedGroupFinishedCore(e){}nestedGroupFinished(e){}afterNestedGroupFinished(e){}clone(){return this.createClone()}}vy.macCodePage=1e4,vy.pcCodePage=437,vy.pcaCodePage=850,vy.defaultControlCharHT=(new Eu).add("'",vy.onSwitchToHexChar).add("*",vy.onOptionalGroupChar).get();class My extends vy{get destinationType(){return Jw.EmptyDestination}get controlCharHT(){return{}}get keywordHT(){return{}}createClone(){return new My}}My._empty=new My;class Ey extends vy{get destinationType(){return Jw.SkipDestination}get controlCharHT(){return null}constructor(e){super(e);const t=this.importer.importers.character.characterFormatting.rtfFormattingInfo;this.oldDecoder=t.activeDecoder,t.activeDecoder=new $w}beforePopRtfState(){this.importer.importers.character.characterFormatting.rtfFormattingInfo.activeDecoder=this.oldDecoder,super.beforePopRtfState()}processControlCharCore(e){}processKeywordCore(e,t,r){const i=this.keywordHT[e];return!!i&&(i(this.importer,t,r),!0)}processCharCore(e){}createClone(){return new Ey(this.importer)}}!function(e){e[e.Unknown=0]="Unknown",e[e.Hybrid=1]="Hybrid",e[e.Simple=2]="Simple"}(ey||(ey={}));class Dy{constructor(){this.levels=[],this.numberingListType=ey.Unknown}}class Fy{constructor(e){this.styleCrossTable={},this.importer=e}get documentModel(){return this.importer.documentModel}convert(e,t){this.createAbstractNumberingLists(e),this.fixBrokenListStyles(),this.createNumberingListsCore(t,e)}fixBrokenListStyles(){f.ListUtils.forEach(this.documentModel.numberingListStyles,((e,t)=>{const r=this.findAbstractNumberingListByStyle(t);e.numberingListIndex<QP.minValue&&-1!=r&&(this.documentModel.numberingLists.push(new cn(this.documentModel,r)),e.numberingListIndex=this.documentModel.numberingLists.length-1)}))}findAbstractNumberingListByStyle(e){return-1}createNumberingListsCore(e,t){const r=e.length,i=this.documentModel.abstractNumberingLists;for(let t=0;t<r;t++){const r=e[t],n=this.getListIndex(r.listId,i);if(n<0)continue;const o=new cn(this.documentModel,n),a=r.id;this.documentModel.numberingLists.push(o),this.convertRtfOverrideToNumbering(o,r);const s=this.documentModel.numberingLists.length-1;this.importer.importers.numbering.listOverrideIndexToNumberingListIndexMap[a]=s,o.innerId=this.documentModel.numberingLists.length}}createAbstractNumberingLists(e){e.forEach((e=>{this.createAbstractNumberingList(e)}))}createAbstractNumberingList(e){let t=f.ListUtils.elementBy(this.documentModel.abstractNumberingLists,(t=>t.innerId==e.id));return-1!=e.id&&t||(t=new dn(this.documentModel),this.convertRtfListToNumberingList(e.levels,t),this.isHybridList(e)&&this.setHybridListType(t),t.innerId=e.id,this.documentModel.abstractNumberingLists.push(t)),t}isHybridList(e){if(e.numberingListType!=ey.Unknown)return!0;const t=e.levels;for(let e of t)if(0!=e.listLevelProperties.templateCode)return!0;return!1}setHybridListType(e){e.levels.forEach((e=>{e.changeListLevelProperties((e=>{0===e.templateCode&&(e.templateCode=Tw.generateNewTemplateCode(this.documentModel))}))}))}getListIndex(e,t){for(let r=0;r<t.length;r++)if(t[r].getId()==e)return r;return-1}convertRtfOverrideToNumbering(e,t){t.levels.forEach(((r,i)=>{const n=r.overrideStartAt;if(r.overrideFormat){this.convertPropertyRtfToNumbering(r.level,r.level.listLevelProperties,!0,!0);const t=new Qi(this.documentModel,r.level.characterProperties,r.level.paragraphProperties,r.level.listLevelProperties);e.levels[i]=t,n&&(t.overrideStart=!0)}else if(n){const r=e.levels[i];r.overrideStart=!0,r.setNewStart(t.levels[i].startAt)}}))}convertRtfListToNumberingList(e,t){e.forEach(((e,r)=>{const i=t.createLevel(r);t.levels[r]=i,i.setParagraphProperties(e.paragraphProperties),i.setCharacterProperties(e.characterProperties),i.changeListLevelProperties((t=>{this.convertPropertyRtfToNumbering(e,t,!0,!0)}))}))}convertPropertyRtfToNumbering(e,t,r,i){const n=e.listLevelProperties;1==r&&(t.start=n.start),1==i&&(t.format=n.format,t.alignment=n.alignment,t.suppressBulletResize=n.suppressBulletResize,t.suppressRestart=n.suppressRestart,t.separator=n.separator,t.convertPreviousLevelNumberingToDecimal=n.convertPreviousLevelNumberingToDecimal,t.displayFormatString=e.createDisplayFormatString(),t.templateCode=n.templateCode),n.legacy&&(t.legacy=n.legacy,t.legacySpace=n.legacySpace,t.legacyIndent=n.legacyIndent)}}class Ry extends vy{get destinationType(){return Jw.CustomPropertiesDestination}get controlCharHT(){return null}createClone(){return new Ry(this.importer)}static onPropname(e,t,r){}static onStaticval(e,t,r){}static onProptType(e,t,r){}static onLinkval(e,t,r){}}class Ly extends vy{constructor(){super(...arguments),this.firstPosition=!0}get destinationType(){return Jw.HexContentDestination}get controlCharHT(){return null}processCharCore(e){this.processBinChar(e)}}class By extends Ly{constructor(e,t){super(e),this.dataStream=t}processBinCharCore(e){this.dataStream.push(e)}getNumberArray(){let e=!0,t=0;const r=[];return this.dataStream.forEach((i=>{if(" "==i)return;const n=this.importer.hexToInt(i,!1);e?t=n<<4:(t+=n,r.push(t),t=0),e=!e})),r}}class Ay extends By{constructor(e,t=[]){super(e,t)}createClone(){return new Ay(this.importer,this.dataStream)}afterPopRtfState(){const e=this.getNumberArray(),t=[];for(let r=3;r>=0;r--)t.push(e[r]);this.importer.documentModel.documentProtectionProperties.word2003PasswordHash=new Uint8Array(t)}}class Ny extends By{constructor(e,t=[]){super(e,t)}createClone(){return new Ny(this.importer,this.dataStream)}afterPopRtfState(){const e=new Uint8Array(this.getNumberArray()),t=new Uint32Array(e.buffer),r=this.importer.documentModel.documentProtectionProperties;r.cryptProviderType=24==t[2]?Ro.RsaAES:Ro.RsaFull,r.hashAlgorithmType=t[3]-32768,r.hashIterationCount=t[4];const i=t[5],n=t[6];r.passwordHash=e.subarray(40,40+i);const o=40+i;r.passwordPrefix=e.subarray(o,o+n)}}class ky extends vy{get destinationType(){return Jw.InfoDestination}get controlCharHT(){return null}createClone(){return new ky(this.importer)}static onLegacyPasswordHash(e,t,r){e.destination=new Ay(e)}static onPasswordHash(e,t,r){e.destination=new Ny(e)}static onCategoryKeyword(e,t,r){}static onCreatedKeyword(e,t,r){}static onDescriptionKeyword(e,t,r){}static onCreatorKeyword(e,t,r){}static onKeywordsKeyword(e,t,r){}static onLastModifiedByKeyword(e,t,r){}static onLastPrintedKeyword(e,t,r){}static onModifiedKeyword(e,t,r){}static onRevisionKeyword(e,t,r){}static onSubjectKeyword(e,t,r){}static onTitleKeyword(e,t,r){}static getStringDocumentPropertyDestinationBase(e,t){}static getDateTimeDocumentPropertyDestinationBase(e,t){}}class Oy{constructor(){this.levels=[]}}class _y{static removeSpecialSymbols(e){if(!_y.containsSpecialSymbols(e))return e;let t="",r=e.length;for(let i=0;i<r;i++){const r=e[i],n=e.charCodeAt(i);n>_y.lastLowSpecial&&n<_y.firstHighSpecial?t+=r:n!=_y.horizontalTabulationCharCode&&n!=_y.newLineCharCode&&n!=_y.carriageReturnCharCode||(t+=r)}return t}static replaceParagraphMarksWithLineBreaks(e){if(!this.containsParagraphMarksOrUnitSeparators(e))return e;const t=[],r=e.length;for(let i=0;i<r;i++){const n=e[i],o=e.charCodeAt(i);if(o!=_y.newLineCharCode&&o!=_y.carriageReturnCharCode&&o!=_y.unitSeparatorCharCode&&o!=_y.recordSeparatorCharCode)t.push(n);else if(o!=_y.unitSeparatorCharCode&&o!=_y.recordSeparatorCharCode){if(t.push(an.specialCharacters.LineBreak),i!=r-1){const t=e[i+1],r=e.charCodeAt(i+1);r!=_y.newLineCharCode&&r!=_y.carriageReturnCharCode||t==n||i++}}else o==_y.recordSeparatorCharCode&&t.push(an.specialCharacters.Dash)}return t.join("")}static containsParagraphMarksOrUnitSeparators(e){const t=e.length;for(let r=0;r<t;r++){const t=e.charCodeAt(r);if(t==_y.newLineCharCode||t==_y.carriageReturnCharCode||t==_y.unitSeparatorCharCode||t==_y.recordSeparatorCharCode)return!0}return!1}static containsSpecialSymbols(e){let t=e.length;for(var r=0;r<t;r++){const t=e.charCodeAt(r);if((t<=_y.lastLowSpecial||t>=_y.firstHighSpecial)&&t!=_y.horizontalTabulationCharCode&&t!=_y.newLineCharCode&&t!=_y.carriageReturnCharCode)return!0}return!1}}_y.lastLowSpecial=31,_y.firstHighSpecial=65535,_y.horizontalTabulationCharCode=9,_y.newLineCharCode=10,_y.carriageReturnCharCode=13,_y.recordSeparatorCharCode=30,_y.unitSeparatorCharCode=31;class Uy{static createDisplayFormatStringCore(e,t){var r=[];let i=Uy.getTextRange(e,0,t);i&&r.push(i);for(let i=1;i<e.length-1;i++){const n=e[i];if(t.length<=n)break;r.push("{"),r.push(t.charCodeAt(n).toString()),r.push("}"),r.push(Uy.getTextRange(e,i,t))}return r.join("")}static getTextRange(e,t,r){var i=e[t]+1,n=r.substr(i,e[t+1]-i);return n=(n=n.replace("{","{{")).replace("}","}}")}}class Hy{constructor(){this.text="",this.numbers="",this.initialize(),this.listLevelProperties.start=1,this.listLevelProperties.separator=an.specialCharacters.TabMark,this.listLevelProperties.displayFormatString="{0}.",this.listLevelProperties.relativeRestartLevel=0}initialize(){this.characterProperties=new Pe,this.paragraphProperties=new Lt,this.listLevelProperties=new sn}createDisplayFormatString(){const e=this.createPlaceholderIndices();return 0==this.text.length?"":_y.removeSpecialSymbols(this.createDisplayFormatStringCore(e))}createPlaceholderIndices(){var e=Math.min(9,this.numbers.length),t=new Array;t.push(0);for(let r=0;r<e;r++)this.numbers.charCodeAt(r)<=this.text.length&&t.push(this.numbers.charCodeAt(r));return t.push(this.text.length),t}createDisplayFormatStringCore(e){return Uy.createDisplayFormatStringCore(e,this.text)}}class Vy{constructor(){this.startAt=Bo.Int32Constants.MAX_VALUE,this.level=new Hy}}class Wy extends vy{get destinationType(){return Jw.StringValueDestination}get controlCharHT(){return Wy.controlCharHT}}Wy.controlCharHT=(new Eu).add("'",Wy.onSwitchToHexChar).add("\\",Wy.onEscapedChar).get();class zy extends Wy{constructor(){super(...arguments),this._value=""}get destinationType(){return Jw.StringValueDestination}get value(){return rn.StringUtils.trimEnd(this._value,[";"])}processCharCore(e){this._value+=e}createClone(){const e=this.createEmptyClone();return e._value=this._value,e}}class jy extends zy{get destinationType(){return Jw.ListLevelNumbersDestination}createEmptyClone(){return new jy(this.importer)}}class Xy extends zy{constructor(){super(...arguments),this.levelTemplateId=0}get destinationType(){return Jw.ListLevelTextDestination}get controlCharHT(){return null}createEmptyClone(){return new Xy(this.importer)}createClone(){const e=super.createClone();return e.levelTemplateId=this.levelTemplateId,e}beforeNestedGroupFinished(e){super.beforeNestedGroupFinished(e),this._value=e.value}static onListLevelTemplateIdKeyword(e,t,r){e.destination.levelTemplateId=r?Xy.fixLevelTemplateId(t):0}static fixLevelTemplateId(e){return Math.abs(e)}}class Gy extends vy{constructor(){super(...arguments),this.level=new Hy}get destinationType(){return Jw.ListLevelDestination}get controlCharHT(){return null}nestedGroupFinished(e){this.tryToHandleFinishOfListLevelTextDestination(e),this.tryToHandleFinishOfListLevelNumbersDestination(e)}beforePopRtfState(){this.applyListLevelParagraphProperties(),this.applyListLevelCharacterProperties()}tryToHandleFinishOfListLevelTextDestination(e){const t=this.importer.destination;e instanceof Xy&&(t.level.text=e.value,t.level.listLevelProperties.templateCode=e.levelTemplateId)}tryToHandleFinishOfListLevelNumbersDestination(e){const t=this.importer.destination;e instanceof jy&&(t.level.numbers=e.value)}applyListLevelParagraphProperties(){this.importer.destination.level.paragraphProperties=this.importer.importers.paragraph.paragraphFormatting.getCoreProperties()}applyListLevelCharacterProperties(){const e=this.importer.destination,t=e.level.text;t.length>1&&yy.setUnicodeFontName(this.importer.documentModel.cache.fontInfoCache,t[1],this.importer.importers.character.characterFormatting),e.level.characterProperties.copyFrom(this.importer.importers.character.characterFormatting.coreProperties)}static onListLevelStartAtKeyword(e,t,r){const i=e.destination;r&&(i.level.listLevelProperties.start=t)}static onListLevelTentativeKeyword(e,t,r){}static onListLevelNumberingFormatKeyword(e,t,r){const i=e.destination;r&&t>=0&&t<YP.length&&(i.level.listLevelProperties.format=YP[t])}static onListLevelAlignmentKeyword(e,t,r){const i=e.destination;r&&(i.level.listLevelProperties.alignment=t)}static onListLevelOldKeyword(e,t,r){if(!r||0!=t){e.destination.level.listLevelProperties.legacy=!0}}static onListLevelPrevKeyword(e,t,r){}static onListLevelPrevspaceKeyword(e,t,r){}static onListLevelIndentKeyword(e,t,r){if(r){e.destination.level.listLevelProperties.legacyIndent=t}}static onListLevelSpaceKeyword(e,t,r){if(r){e.destination.level.listLevelProperties.legacySpace=t}}static onListLevelTextKeyword(e,t,r){e.destination=new Xy(e)}static onListLevelNumbersKeyword(e,t,r){e.destination=new jy(e)}static onListLevelFollowKeyword(e,t,r){const i=e.destination;r&&(i.level.listLevelProperties.separator=0==t?an.specialCharacters.TabMark:1==t?" ":"\0")}static onListLevelLegalKeyword(e,t,r){const i=e.destination;r&&(i.level.listLevelProperties.convertPreviousLevelNumberingToDecimal=0!=t)}static onListLevelNoRestartKeyword(e,t,r){const i=e.destination;i.level.listLevelProperties.suppressRestart=!r||0!=t}static onListLevelPictureKeyword(e,t,r){}static onListLevelPictureNoSizeKeyword(e,t,r){e.destination.level.listLevelProperties.suppressBulletResize=!0}static onParagraphStyleKeyword(e,t,r){}processControlCharCore(e){}processKeywordCore(e,t,r){const i=this.keywordHT[e];return!!i&&(i(this.importer,t,r),!0)}processCharCore(e){}createClone(){const e=new Gy(this.importer);return e.level=this.level,e}}class Ky extends vy{constructor(){super(...arguments),this.overrideLevel=new Vy}get destinationType(){return Jw.ListOverrideLevelDestination}get controlCharHT(){return null}static onListOverrideFormatKeyword(e,t,r){e.destination.overrideLevel.overrideFormat=!0}static onListOverrideStartAtKeyword(e,t,r){e.destination.overrideLevel.overrideStartAt=!0}static onListOverrideStartAtValueKeyword(e,t,r){const i=e.destination;i.overrideLevel.startAt=r?t:0}static onListOverrideListLevelKeyword(e,t,r){const i=e.destination;if(i.overrideLevel.overrideFormat){const t=new Gy(e);e.destination=t,i.overrideLevel.level=t.level}}createClone(){const e=new Ky(this.importer);return e.overrideLevel=this.overrideLevel,e}}class qy extends vy{get destinationType(){return Jw.ListOverrideTableDestination}get controlCharHT(){return null}static onListOverrideKeyword(e,t,r){const i=e.destination;i.currentOverride=new Oy,e.documentProperties.listOverrideTable.push(i.currentOverride)}static onListOverrideListIdKeyword(e,t,r){const i=e.destination;null!=i.currentOverride&&r&&(i.currentOverride.listId=t)}static onListOverrideCountKeyword(e,t,r){}static onListOverrideIdKeyword(e,t,r){const i=e.destination;null!=i.currentOverride&&r&&(i.currentOverride.id=t)}static onListOverrideLevelKeyword(e,t,r){const i=e.destination,n=new Ky(e);e.destination=n,null!=i.currentOverride&&i.currentOverride.levels.push(n.overrideLevel)}createClone(){const e=new qy(this.importer);return e.currentOverride=this.currentOverride,e}}class $y extends zy{get destinationType(){return Jw.ListNameDestination}createEmptyClone(){return new $y(this.importer)}}class Jy extends zy{get destinationType(){return Jw.ListStyleNameDestination}createEmptyClone(){return new Jy(this.importer)}}class Yy extends vy{get destinationType(){return Jw.ListTableDestination}get controlCharHT(){return null}nestedGroupFinished(e){this.tryToHandleFinishOfListNameDestination(e),this.tryToHandleFinishOfListStyleNameDestination(e),this.tryToHandleFinishOfListLevelDestination(e)}tryToHandleFinishOfListNameDestination(e){const t=this.importer.destination;e instanceof $y&&(t.currentList.name=e.value)}tryToHandleFinishOfListStyleNameDestination(e){const t=this.importer.destination;e instanceof Jy&&(t.currentList.styleName=e.value)}tryToHandleFinishOfListLevelDestination(e){const t=this.importer.destination;e instanceof Gy&&t.currentList.levels.push(e.level)}static onListKeyword(e,t,r){const i=e.destination;i.currentList=new Dy,e.documentProperties.listTable.push(i.currentList)}static onListIdKeyword(e,t,r){const i=e.destination;null!=i.currentList&&r&&(i.currentList.id=t)}static onListTemplatIdKeyword(e,t,r){}static onListStyleIdKeyword(e,t,r){const i=e.destination;null!=i.currentList&&r&&(i.currentList.parentStyleId=t)}static onListStyleNameKeyword(e,t,r){e.destination=new Jy(e)}static onListNameKeyword(e,t,r){e.destination=new $y(e)}static onListHybridKeyword(e,t,r){e.destination.currentList.numberingListType=ey.Hybrid}static onListRestartAtEachSectionKeyword(e,t,r){}static onListTemplateIdKeyword(e,t,r){}static onListSimpleKeyword(e,t,r){}static onListLevelKeyword(e,t,r){const i=new Gy(e);e.importers.character.characterFormatting.coreProperties.resetAllUse(),e.destination=i}processKeywordCore(e,t,r){const i=this.keywordHT[e];return!!i&&(i(this.importer,t,r),!0)}processCharCore(e){}createClone(){const e=new Yy(this.importer);return e.currentList=this.currentList,e}}class Qy{static getColorProperty(e){return U.fromRgb(255&e,(65280&e)>>8,(16711680&e)>>16)}}class Zy{constructor(){this.shapeComplexProperties={}}addProperty(e,t){this.shapeComplexProperties[e]=t}trySetProperty(e,t){return this.setIfPropertyExist(e,(e=>this.getPropertyOrNull(e)),t)}getProperty(e,t){const r=this.getPropertyOrNull(e);return r||t}getNullableColorProperty(e){const t=this.getPropertyOrNull(e);return"number"==typeof t?null===t?null:Qy.getColorProperty(t):null===t?null:Qy.getColorProperty(t.intColor)}getPropertyOrNull(e){const t=this.shapeComplexProperties[e];return void 0===t?null:"boolean"==typeof t?!!t:t}setIfPropertyExist(e,t,r){const i=t(e);return null!=i&&(r(i),!0)}}!function(e){e[e.Page=0]="Page",e[e.Line=1]="Line",e[e.Paragraph=2]="Paragraph",e[e.Margin=3]="Margin",e[e.TopMargin=4]="TopMargin",e[e.BottomMargin=5]="BottomMargin",e[e.InsideMargin=6]="InsideMargin",e[e.OutsideMargin=7]="OutsideMargin"}(ty||(ty={})),function(e){e[e.Page=0]="Page",e[e.Character=1]="Character",e[e.Column=2]="Column",e[e.Margin=3]="Margin",e[e.LeftMargin=4]="LeftMargin",e[e.RightMargin=5]="RightMargin",e[e.InsideMargin=6]="InsideMargin",e[e.OutsideMargin=7]="OutsideMargin"}(ry||(ry={}));class ex{constructor(){this.collection=[]}getRtfColorIndexById(e){return e<0||e>=this.collection.length?xe.defaultItem:this.collection[e]}}class tx{}class rx extends vy{get destinationType(){return Jw.ShapePropertyHsvValueDestination}get controlCharHT(){return null}constructor(e,t=new tx){super(e),this.hsvInfo=t}static getThis(e){return e.destination}static onAccentOneKeyword(e,t,r){rx.getThis(e).hsvInfo.schemeColor=yn.Accent1}static onAccentTwoKeyword(e,t,r){rx.getThis(e).hsvInfo.schemeColor=yn.Accent2}static onAccentThreeKeyword(e,t,r){rx.getThis(e).hsvInfo.schemeColor=yn.Accent3}static onAccentFourKeyword(e,t,r){rx.getThis(e).hsvInfo.schemeColor=yn.Accent4}static onAccentFiveKeyword(e,t,r){rx.getThis(e).hsvInfo.schemeColor=yn.Accent5}static onAccentSixKeyword(e,t,r){rx.getThis(e).hsvInfo.schemeColor=yn.Accent6}static onTintKeyword(e,t,r){r&&(rx.getThis(e).hsvInfo.tint=t)}static onShadeKeyword(e,t,r){r&&(rx.getThis(e).hsvInfo.shade=t)}createClone(){return new rx(this.importer,this.hsvInfo)}}class ix extends zy{get destinationType(){return Jw.ShapePropertyNameDestination}createEmptyClone(){return new ix(this.importer)}}class nx{static getShortValue(e){return 32767&e}static isShortValue(e){return e==nx.getShortValue(e)}static getUInt16(e){return 65535&e}}class ox extends Kw{constructor(){super()}processChar(e,t){e.destination.processChar(t)}flush(e){}}!function(e){e[e.Page=0]="Page",e[e.Paragraph=1]="Paragraph",e[e.Margin=2]="Margin"}(iy||(iy={})),function(e){e[e.Page=0]="Page",e[e.Column=1]="Column",e[e.Margin=2]="Margin"}(ny||(ny={})),function(e){e[e.Auto=0]="Auto",e[e.Around=1]="Around",e[e.None=2]="None",e[e.NotBeside=3]="NotBeside",e[e.Through=4]="Through",e[e.Tight=5]="Tight"}(oy||(oy={})),function(e){e[e.None=0]="None",e[e.Bmp=1]="Bmp",e[e.Emf=2]="Emf",e[e.Exif=3]="Exif",e[e.Gif=4]="Gif",e[e.Icon=5]="Icon",e[e.Jpeg=6]="Jpeg",e[e.MemoryBmp=7]="MemoryBmp",e[e.Png=8]="Png",e[e.Tiff=9]="Tiff",e[e.Wmf=10]="Wmf"}(ay||(ay={})),function(e){e[e.Emf=0]="Emf",e[e.Png=1]="Png",e[e.Jpeg=2]="Jpeg",e[e.Mac=3]="Mac",e[e.PmmMetafile=4]="PmmMetafile",e[e.Wmf=5]="Wmf",e[e.WindowsDib=6]="WindowsDib",e[e.WindowsBmp=7]="WindowsBmp"}(sy||(sy={}));class ax{constructor(){this.pictureSourceType=sy.WindowsBmp,this.wmfMapMode=Zw.Text,this.bmpBitsPerPixel=1,this.bmpColorPlanes=1,this.pictureWidth=-1,this.pictureHeight=-1,this.desiredPictureWidth=-1,this.desiredPictureHeight=-1,this.scaleX=100,this.scaleY=100,this.imageUri="",this.leftCrop=0,this.topCrop=0,this.rightCrop=0,this.bottomCrop=0,this.dataStream=[],this.properties=new Zy}get dataCrc32(){return 0}}class sx{}class lx{}class dx extends Ly{get destinationType(){return Jw.PictureDestination}get controlCharHT(){return null}constructor(e){super(e),this.info=new ax,this.oldDecoder=this.importer.importers.character.characterFormatting.rtfFormattingInfo.activeDecoder,this.importer.importers.character.characterFormatting.rtfFormattingInfo.activeDecoder=new ox}static getThis(e){return e.destination}static onEmfFileKeyword(e,t,r){e.destination.info.pictureSourceType=sy.Emf}static onPngFileKeyword(e,t,r){e.destination.info.pictureSourceType=sy.Png}static onJpegFileKeyword(e,t,r){e.destination.info.pictureSourceType=sy.Jpeg}static onMacFileKeyword(e,t,r){e.destination.info.pictureSourceType=sy.Mac}static onWindowsMetafileKeyword(e,t,r){const i=e.destination;i.info.pictureSourceType=sy.Wmf,r&&(i.info.wmfMapMode=t)}static onDeviceIndependentBitmapFileKeyword(e,t,r){r&&0!=t&&e.throwInvalidRtfFile();e.destination.info.pictureSourceType=sy.WindowsDib}static onDeviceDependentBitmapFileKeyword(e,t,r){r&&0!=t&&e.throwInvalidRtfFile();e.destination.info.pictureSourceType=sy.WindowsBmp}static onBitmapBitsPerPixelKeyword(e,t,r){r||(t=1);1==t||4==t||8==t||16==t||24==t||32==t||e.throwInvalidRtfFile();e.destination.info.bmpBitsPerPixel=t}static onBitmapPlanesKeyword(e,t,r){r||e.throwInvalidRtfFile(),1!=t&&e.throwInvalidRtfFile();e.destination.info.bmpColorPlanes=t}static onBitmapBytesInLineKeyword(e,t,r){e.destination.info.bmpBytesInLine=t}static onPictureWidthKeyword(e,t,r){r||e.throwInvalidRtfFile();const i=e.destination;let n=t;t<0&&nx.isShortValue(t)&&(n=dx.fillBytesToConvertFromShortIntToLongInt(nx.getShortValue(t))),i.info.pictureWidth=n}static onPictureHeightKeyword(e,t,r){r||e.throwInvalidRtfFile();const i=e.destination;let n=t;dx.checkIfParameterStoredAsShortIntegerInsteadLongInt(t)&&(n=dx.fillBytesToConvertFromShortIntToLongInt(nx.getShortValue(t))),i.info.pictureHeight=n}static checkIfParameterStoredAsShortIntegerInsteadLongInt(e){return e<0&&nx.isShortValue(e)}static fillBytesToConvertFromShortIntToLongInt(e){return nx.getUInt16(e)}static onPictureGoalWidthKeyword(e,t,r){r||e.throwInvalidRtfFile();e.destination.info.desiredPictureWidth=t}static onPictureGoalHeightKeyword(e,t,r){r||e.throwInvalidRtfFile();e.destination.info.desiredPictureHeight=t}static onHorizontalScalingKeyword(e,t,r){r||e.throwInvalidRtfFile();e.destination.info.scaleX=t}static onVerticalScalingKeyword(e,t,r){r||e.throwInvalidRtfFile();e.destination.info.scaleY=t}static onPicScaledKeyword(e,t,r){}static onTopCropKeyword(e,t,r){e.destination.info.topCrop=t}static onBottomCropKeyword(e,t,r){e.destination.info.bottomCrop=t}static onLeftCropKeyword(e,t,r){e.destination.info.leftCrop=t}static onRightCropKeyword(e,t,r){e.destination.info.rightCrop=t}static onBitmapMetafileKeyword(e,t,r){e.destination=new Ey(e)}static onBitsPerPixelBitmapMetafileKeyword(e,t,r){e.destination=new Ey(e)}static onDxImageUri(e,t,r){e.destination=new Ey(e)}static onShapePropertiesKeyword(e,t,r){e.destination=new mx(e,e.destination.info.properties)}static onBlipTag(e,t,r){r||e.throwInvalidRtfFile();e.destination.info.blipTag=t}static onShapePropertyKeyword(e,t,r){e.destination=new mx(e,dx.getThis(e).info.properties)}createClone(){const e=new dx(this.importer);return e.info=this.info,e}beforePopRtfState(){this.importer.importers.character.characterFormatting.rtfFormattingInfo.activeDecoder=this.oldDecoder,super.beforePopRtfState()}processBinCharCore(e){this.info.dataStream.push(e)}validateImageSize(e){this.info.pictureWidth<0&&(this.info.pictureWidth=0),this.info.pictureHeight<0&&(this.info.pictureHeight=0)}loadMetafile(e){}loadBitmap(e){}loadDib(e){}loadImageInUnits(e,t){this.importer.importers.image.scale=new so.Size(this.info.scaleX,this.info.scaleY),this.importer.importers.image.desireSize=new so.Size(this.info.desiredPictureWidth,this.info.desiredPictureHeight),this.applyVisibleSize(e)}applyVisibleSize(e){this.info.scaleX<=0&&(this.info.scaleX=100),this.info.scaleY<=0&&(this.info.scaleY=100);const t=Math.max(1,this.info.desiredPictureWidth-this.info.leftCrop-this.info.rightCrop),r=Math.max(1,this.info.desiredPictureHeight-this.info.topCrop-this.info.bottomCrop);e.actualSize=new so.Size((t*this.info.scaleX+50)/100,(r*this.info.scaleY+50)/100)}loadMetafileImageInUnits(e){}applySourceRect(e,t,r){}getFractionInThousandthOfPercent(e,t){return 0}loadPicture(){const e=new sx;return this.info.dataStream.length>0&&this.loadPictureCore(e),e}loadPictureCore(e){e.base64=this.getPrefix(this.info.pictureSourceType)+Tu(this.info.dataStream.join("")),this.validateImageSize(e.base64),this.loadImageInUnits(e,dx.rtfHundredthsOfMillimeterConverter)}getPrefix(e){return"data:"+this.getPictureFormat(e)+";base64,"}getPictureFormat(e){return e===sy.Jpeg?"image/jpeg":"image/png"}getImageInfo(){const e=this.loadPicture();return null!=e&&this.info.properties.trySetProperty(kP.PseudoInline,(t=>e.pseudoInline=t)),e.blipTag=this.info.blipTag,e}dispose(e){}}dx.rtfHundredthsOfMillimeterConverter=new class extends lx{unitsToTwips(e){return Math.round(1440*e/2540)}unitsToModelUnits(e){return g.u.hundredthsOfMillimeterToTwipsRound(e)}},dx.rtfPixelsConverter=new class extends lx{constructor(e){super(),this.dpi=e}unitsToTwips(e){return Math.round(1440*e/this.dpi)}unitsToModelUnits(e){return g.u.pixelsToTwipsCustomDpi(e,this.dpi)}}(96);class cx extends Wy{constructor(){super(...arguments),this._value=[]}get destinationType(){return Jw.HyperlinkPropertyValueDestination}get value(){return rn.StringUtils.trim(this._value.join(""))}processCharCore(e){this._value.push(e)}createClone(){const e=this.createEmptyClone();return e._value=this._value,e}}class hx extends cx{get destinationType(){return Jw.HyperlinkLocationValueDestination}createEmptyClone(){return new hx(this.importer)}}class ux extends cx{get destinationType(){return Jw.HyperlinkSourceValueDestination}createEmptyClone(){return new ux(this.importer)}}class px extends vy{constructor(){super(...arguments),this.hyperlinkInfo=new xd("","","",!1)}get destinationType(){return Jw.ShapePropertyHyperlinkDestination}get controlCharHT(){return null}nestedGroupFinished(e){e instanceof hx?this.hyperlinkInfo.anchor=e.value:e instanceof ux&&(this.hyperlinkInfo.uri=e.value)}createClone(){const e=new px(this.importer);return e.hyperlinkInfo=this.hyperlinkInfo,e}}class gx extends vy{constructor(){super(...arguments),this.buffer=[]}get destinationType(){return Jw.ShapePropertyValueDestination}get controlCharHT(){return null}processCharCore(e){this.buffer.push(e)}beforePopRtfState(){const e=this.buffer.join("");if(rn.StringUtils.isNullOrEmpty(e))return;const t=+e;isNaN(t)?this.value=e:this.value=t}nestedGroupFinished(e){e instanceof dx?this.value=e.getImageInfo():e instanceof px&&(this.value=e.hyperlinkInfo)}createClone(){const e=new gx(this.importer);return e.buffer=this.buffer,e}}class mx extends vy{get destinationType(){return Jw.ShapePropertyDestination}get controlCharHT(){return null}constructor(e,t){super(e),this.properties=t}processControlCharCore(e){}processKeywordCore(e,t,r){const i=this.keywordHT[e];return!!i&&(i(this.importer,t,r),!0)}processCharCore(e){}createClone(){const e=new mx(this.importer,this.properties);return e.propertyName=this.propertyName,e}nestedGroupFinished(e){if(e instanceof ix)this.propertyName=e.value;else if(e instanceof gx)this.value=e.value;else if(e instanceof rx){const t=e.hsvInfo;return"number"==typeof this.value&&(t.intColor=this.value),void(this.value=t)}}beforePopRtfState(){rn.StringUtils.isNullOrEmpty(this.propertyName)||(this.value,this.properties.addProperty(this.propertyName,this.value))}}class fx{}fx.cantSplit=new class{setProp(e,t){e.cantSplit=t}getProp(e){return e.cantSplit}maskValue(){return Ua.UseCantSplit}},fx.cellSpacing=new class{setProp(e,t){e.cellSpacing=t}getProp(e){return e.cellSpacing}maskValue(){return Ua.UseCellSpacing}},fx.divId=new class{setProp(e,t){e.divId=t}getProp(e){return e.divId}maskValue(){return Ua.UseDivId}},fx.header=new class{setProp(e,t){e.header=t}getProp(e){return e.header}maskValue(){return Ua.UseHeader}},fx.hideCellMark=new class{setProp(e,t){e.hideCellMark=t}getProp(e){return e.hideCellMark}maskValue(){return Ua.UseHideCellMark}},fx.rowAlignment=new class{setProp(e,t){e.tableRowAlignment=t}getProp(e){return e.tableRowAlignment}maskValue(){return Ua.UseTableRowAlignment}},fx.ALL_FIELDS=[fx.cantSplit,fx.cellSpacing,fx.divId,fx.header,fx.hideCellMark,fx.rowAlignment];class bx{static getBorderArtIndex(e){const t=bx.mapBorderLineStyleToIndex[e];return void 0!==t?t:0}static getBorderLineStyle(e){const t=bx.mapIndexToBorderLineStyle[e];return void 0!==t?t:de.None}static initStatics(){const e=[de.Apples,de.ArchedScallops,de.BabyPacifier,de.BabyRattle,de.Balloons3Colors,de.BalloonsHotAir,de.BasicBlackDashes,de.BasicBlackDots,de.BasicBlackSquares,de.BasicThinLines,de.BasicWhiteDashes,de.BasicWhiteDots,de.BasicWhiteSquares,de.BasicWideInline,de.BasicWideMidline,de.BasicWideOutline,de.Bats,de.Birds,de.BirdsFlight,de.Cabins,de.CakeSlice,de.CandyCorn,de.CelticKnotwork,de.CertificateBanner,de.ChainLink,de.ChampagneBottle,de.CheckedBarBlack,de.CheckedBarColor,de.Checkered,de.ChristmasTree,de.CirclesLines,de.CirclesRectangles,de.ClassicalWave,de.Clocks,de.Compass,de.Confetti,de.ConfettiGrays,de.ConfettiOutline,de.ConfettiStreamers,de.ConfettiWhite,de.CornerTriangles,de.CouponCutoutDashes,de.CouponCutoutDots,de.CrazyMaze,de.CreaturesButterfly,de.CreaturesFish,de.CreaturesInsects,de.CreaturesLadyBug,de.CrossStitch,de.Cup,de.DecoArch,de.DecoArchColor,de.DecoBlocks,de.DiamondsGray,de.DoubleD,de.DoubleDiamonds,de.Earth1,de.Earth2,de.EclipsingSquares1,de.EclipsingSquares2,de.EggsBlack,de.Fans,de.Film,de.Firecrackers,de.FlowersBlockPrint,de.FlowersDaisies,de.FlowersModern1,de.FlowersModern2,de.FlowersPansy,de.FlowersRedRose,de.FlowersRoses,de.FlowersTeacup,de.FlowersTiny,de.Gems,de.GingerbreadMan,de.Gradient,de.Handmade1,de.Handmade2,de.HeartBalloon,de.HeartGray,de.Hearts,de.HeebieJeebies,de.Holly,de.HouseFunky,de.Hypnotic,de.IceCreamCones,de.LightBulb,de.Lightning1,de.Lightning2,de.MapPins,de.MapleLeaf,de.MapleMuffins,de.Marquee,de.MarqueeToothed,de.Moons,de.Mosaic,de.MusicNotes,de.Northwest,de.Ovals,de.Packages,de.PalmsBlack,de.PalmsColor,de.PaperClips,de.Papyrus,de.PartyFavor,de.PartyGlass,de.Pencils,de.People,de.PeopleWaving,de.PeopleHats,de.Poinsettias,de.PostageStamp,de.Pumpkin1,de.PushPinNote2,de.PushPinNote1,de.Pyramids,de.PyramidsAbove,de.Quadrants,de.Rings,de.Safari,de.Sawtooth,de.SawtoothGray,de.ScaredCat,de.Seattle,de.ShadowedSquares,de.SharksTeeth,de.ShorebirdTracks,de.Skyrocket,de.SnowflakeFancy,de.Snowflakes,de.Sombrero,de.Southwest,de.Stars,de.StarsTop,de.Stars3d,de.StarsBlack,de.StarsShadowed,de.Sun,de.Swirligig,de.TornPaper,de.TornPaperBlack,de.Trees,de.TriangleParty,de.Triangles,de.Tribal1,de.Tribal2,de.Tribal3,de.Tribal4,de.Tribal5,de.Tribal6,de.TwistedLines1,de.TwistedLines2,de.Vine,de.Waveline,de.WeavingAngles,de.WeavingBraid,de.WeavingRibbon,de.WeavingStrips,de.WhiteFlowers,de.Woodwork,de.XIllusions,de.ZanyTriangles,de.ZigZag,de.ZigZagStitch];return bx.mapBorderLineStyleToIndex={},bx.mapIndexToBorderLineStyle={},f.ListUtils.forEach(e,((e,t)=>{bx.mapBorderLineStyleToIndex[e]=t+1,bx.mapIndexToBorderLineStyle[t+1]=e})),bx.mapIndexToBorderLineStyle}}bx.mapIndexToBorderLineStyle=bx.initStatics(),function(e){e[e.Undefined=0]="Undefined",e[e.DoubleByteCharactersFont=1]="DoubleByteCharactersFont",e[e.LowAnsiCharactersFont=2]="LowAnsiCharactersFont",e[e.HighAnsiCharactersFont=3]="HighAnsiCharactersFont"}(ly||(ly={})),function(e){e[e.Default=0]="Default",e[e.Roman=1]="Roman",e[e.Swiss=2]="Swiss",e[e.Modern=3]="Modern",e[e.Script=4]="Script",e[e.Decor=5]="Decor",e[e.Tech=6]="Tech",e[e.Bidi=7]="Bidi"}(dy||(dy={})),function(e){e[e.Ansi=0]="Ansi",e[e.Mac=1]="Mac",e[e.PC=2]="PC",e[e.Pca=3]="Pca"}(cy||(cy={}));class Cx{static createDefaultInfo(){return new Cx}clone(){return new Cx}}!function(e){e[e.Auto=0]="Auto",e[e.AtLeast=1]="AtLeast",e[e.Exact=2]="Exact"}(hy||(hy={})),function(e){e[e.Inline=0]="Inline",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Top=3]="Top",e[e.Inside=4]="Inside",e[e.Outside=5]="Outside",e[e.None=6]="None"}(uy||(uy={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Inside=3]="Inside",e[e.Outside=4]="Outside",e[e.None=5]="None"}(py||(py={})),function(e){e[e.Page=0]="Page",e[e.Column=1]="Column",e[e.Margin=2]="Margin"}(gy||(gy={}));class Sx{constructor(){this.coreProperties=new Lt,this.paragraphListInfo=un.default,this.tabs=new ts,this.tabAlignment=Ha.Left,this.tabLeader=Sg.None,this.rtfLineSpacingType=0,this.rtfLineSpacingMultiplier=1,this.useLineSpacingMultiplier=!1,this.inTableParagraph=!1,this.nestingLevel=0,this.styleLink=-1,this.nextStyle=-1,this.processedBorder=new Me,this.paragraphFrameFormattingInfo=null}get numberingListIndex(){return this.paragraphListInfo.numberingListIndex}get listLevelIndex(){return this.paragraphListInfo.listLevelIndex}set shadingPattern(e){this.coreProperties.setValue(Ft.shadingInfo,new fe(e,this.coreProperties.shadingInfo.backColor,this.coreProperties.shadingInfo.foreColor))}set backColor(e){this.coreProperties.setValue(Ft.shadingInfo,new fe(this.coreProperties.shadingInfo.shadingPattern,e,this.coreProperties.shadingInfo.foreColor))}set foreColor(e){this.coreProperties.setValue(Ft.shadingInfo,new fe(this.coreProperties.shadingInfo.shadingPattern,this.coreProperties.shadingInfo.backColor,e))}getCoreProperties(){return this.applyLineSpacing(),this.coreProperties}applyLineSpacing(){this.coreProperties.setValue(Ft.lineSpacingType,this.calcLineSpacingType()),this.coreProperties.setValue(Ft.lineSpacing,this.calcLineSpacing())}calcLineSpacingType(){return this.rtfLineSpacingType<0?Ne.Exactly:this.rtfLineSpacingType>0?0==this.rtfLineSpacingMultiplier?Ne.AtLeast:240==this.rtfLineSpacingType?Ne.Single:360==this.rtfLineSpacingType?Ne.Sesquialteral:480==this.rtfLineSpacingType?Ne.Double:Ne.Multiple:0==this.rtfLineSpacingMultiplier&&this.useLineSpacingMultiplier?Ne.AtLeast:Ne.Single}calcLineSpacing(){return 0==this.rtfLineSpacingMultiplier?0==this.rtfLineSpacingType&&this.useLineSpacingMultiplier?240:0!=this.rtfLineSpacingType?Math.max(Math.abs(this.rtfLineSpacingType),1):0:this.rtfLineSpacingType<0?Math.max(Math.abs(this.rtfLineSpacingType),1):this.rtfLineSpacingType/240}clone(){const e=new Sx;return e.copyFrom(this),e}copyFrom(e){this.coreProperties=e.coreProperties.clone(),this.paragraphListInfo=e.paragraphListInfo.clone(),this.tabs=e.tabs.clone(),this.tabAlignment=e.tabAlignment,this.tabLeader=e.tabLeader,this.rtfLineSpacingType=e.rtfLineSpacingType,this.rtfLineSpacingMultiplier=e.rtfLineSpacingMultiplier,this.useLineSpacingMultiplier=e.useLineSpacingMultiplier,this.inTableParagraph=e.inTableParagraph,this.nestingLevel=e.nestingLevel,this.styleLink=e.styleLink?e.styleLink:null,this.nextStyle=e.nextStyle?e.nextStyle:null,this.processedBorder=e.processedBorder?e.processedBorder.clone():null,this.rtfTableStyleIndexForRowOrCell=e.rtfTableStyleIndexForRowOrCell,this.paragraphFrameFormattingInfo=e.paragraphFrameFormattingInfo?e.paragraphFrameFormattingInfo.clone():null}}class Ix extends zy{get destinationType(){return Jw.TextAfterDestination}createEmptyClone(){return new Ix(this.importer)}}class Px extends zy{get destinationType(){return Jw.TextBeforeDestination}createEmptyClone(){return new Px(this.importer)}}class wx{}wx.NotPrimitive=0,wx.Rectangle=1,wx.RoundRect=2,wx.Ellipse=3,wx.Diamond=4,wx.IsocelesTriangle=5,wx.RightTriangle=6,wx.Parallelogram=7,wx.Trapezoid=8,wx.Hexagon=9,wx.Octagon=10,wx.Plus=11,wx.Star=12,wx.Arrow=13,wx.ThickArrow=14,wx.HomePlate=15,wx.Cube=16,wx.Balloon=17,wx.Seal=18,wx.Arc=19,wx.Line=20,wx.Plaque=21,wx.Can=22,wx.Donut=23,wx.TextSimple=24,wx.TextOctagon=25,wx.TextHexagon=26,wx.TextCurve=27,wx.TextWave=28,wx.TextRing=29,wx.TextOnCurve=30,wx.TextOnRing=31,wx.StraightConnector1=32,wx.BentConnector2=33,wx.BentConnector3=34,wx.BentConnector4=35,wx.BentConnector5=36,wx.CurvedConnector2=37,wx.CurvedConnector3=38,wx.CurvedConnector4=39,wx.CurvedConnector5=40,wx.Callout1=41,wx.Callout2=42,wx.Callout3=43,wx.AccentCallout1=44,wx.AccentCallout2=45,wx.AccentCallout3=46,wx.BorderCallout1=47,wx.BorderCallout2=48,wx.BorderCallout3=49,wx.AccentBorderCallout1=50,wx.AccentBorderCallout2=51,wx.AccentBorderCallout3=52,wx.Ribbon=53,wx.Ribbon2=54,wx.Chevron=55,wx.Pentagon=56,wx.NoSmoking=57,wx.Seal8=58,wx.Seal16=59,wx.Seal32=60,wx.WedgeRectCallout=61,wx.WedgeRRectCallout=62,wx.WedgeEllipseCallout=63,wx.Wave=64,wx.FoldedCorner=65,wx.LeftArrow=66,wx.DownArrow=67,wx.UpArrow=68,wx.LeftRightArrow=69,wx.UpDownArrow=70,wx.IrregularSeal1=71,wx.IrregularSeal2=72,wx.LightningBolt=73,wx.Heart=74,wx.PictureFrame=75,wx.QuadArrow=76,wx.LeftArrowCallout=77,wx.RightArrowCallout=78,wx.UpArrowCallout=79,wx.DownArrowCallout=80,wx.LeftRightArrowCallout=81,wx.UpDownArrowCallout=82,wx.QuadArrowCallout=83,wx.Bevel=84,wx.LeftBracket=85,wx.RightBracket=86,wx.LeftBrace=87,wx.RightBrace=88,wx.LeftUpArrow=89,wx.BentUpArrow=90,wx.BentArrow=91,wx.Seal24=92,wx.StripedRightArrow=93,wx.NotchedRightArrow=94,wx.BlockArc=95,wx.SmileyFace=96,wx.VerticalScroll=97,wx.HorizontalScroll=98,wx.CircularArrow=99,wx.NotchedCircularArrow=100,wx.UturnArrow=101,wx.CurvedRightArrow=102,wx.CurvedLeftArrow=103,wx.CurvedUpArrow=104,wx.CurvedDownArrow=105,wx.CloudCallout=106,wx.EllipseRibbon=107,wx.EllipseRibbon2=108,wx.FlowChartProcess=109,wx.FlowChartDecision=110,wx.FlowChartInputOutput=111,wx.FlowChartPredefinedProcess=112,wx.FlowChartInternalStorage=113,wx.FlowChartDocument=114,wx.FlowChartMultidocument=115,wx.FlowChartTerminator=116,wx.FlowChartPreparation=117,wx.FlowChartManualInput=118,wx.FlowChartManualOperation=119,wx.FlowChartConnector=120,wx.FlowChartPunchedCard=121,wx.FlowChartPunchedTape=122,wx.FlowChartSummingJunction=123,wx.FlowChartOr=124,wx.FlowChartCollate=125,wx.FlowChartSort=126,wx.FlowChartExtract=127,wx.FlowChartMerge=128,wx.FlowChartOfflineStorage=129,wx.FlowChartOnlineStorage=130,wx.FlowChartMagneticTape=131,wx.FlowChartMagneticDisk=132,wx.FlowChartMagneticDrum=133,wx.FlowChartDisplay=134,wx.FlowChartDelay=135,wx.TextPlainText=136,wx.TextStop=137,wx.TextTriangle=138,wx.TextTriangleInverted=139,wx.TextChevron=140,wx.TextChevronInverted=141,wx.TextRingInside=142,wx.TextRingOutside=143,wx.TextArchUpCurve=144,wx.TextArchDownCurve=145,wx.TextCircleCurve=146,wx.TextButtonCurve=147,wx.TextArchUpPour=148,wx.TextArchDownPour=149,wx.TextCirclePour=150,wx.TextButtonPour=151,wx.TextCurveUp=152,wx.TextCurveDown=153,wx.TextCascadeUp=154,wx.TextCascadeDown=155,wx.TextWave1=156,wx.TextWave2=157,wx.TextWave3=158,wx.TextWave4=159,wx.TextInflate=160,wx.TextDeflate=161,wx.TextInflateBottom=162,wx.TextDeflateBottom=163,wx.TextInflateTop=164,wx.TextDeflateTop=165,wx.TextDeflateInflate=166,wx.TextDeflateInflateDeflate=167,wx.TextFadeRight=168,wx.TextFadeLeft=169,wx.TextFadeUp=170,wx.TextFadeDown=171,wx.TextSlantUp=172,wx.TextSlantDown=173,wx.TextCanUp=174,wx.TextCanDown=175,wx.FlowChartAlternateProcess=176,wx.FlowChartOffpageConnector=177,wx.Callout90=178,wx.AccentCallout90=179,wx.BorderCallout90=180,wx.AccentBorderCallout90=181,wx.LeftRightUpArrow=182,wx.Sun=183,wx.Moon=184,wx.BracketPair=185,wx.BracePair=186,wx.Seal4=187,wx.DoubleWave=188,wx.ActionButtonBlank=189,wx.ActionButtonHome=190,wx.ActionButtonHelp=191,wx.ActionButtonInformation=192,wx.ActionButtonForwardNext=193,wx.ActionButtonBackPrevious=194,wx.ActionButtonEnd=195,wx.ActionButtonBeginning=196,wx.ActionButtonReturn=197,wx.ActionButtonDocument=198,wx.ActionButtonSound=199,wx.ActionButtonMovie=200,wx.HostControl=201,wx.Textbox=202;class yx extends vy{get destinationType(){return Jw.ShapePictureDestination}get controlCharHT(){return null}static onPictKeyword(e,t,r){e.destination=new dx(e)}createClone(){return new yx(this.importer)}nestedGroupFinished(e){e instanceof dx&&(this.imageInfo=e.getImageInfo(),this.shapeProperties=e.info.properties)}beforePopRtfState(){this.prepareInfo(),this.importer.importers.image.insertImageShape(this.imageInfo,this.shapeProperties)}prepareInfo(){this.imageInfo&&this.imageInfo.actualSize&&(this.shapeProperties.addProperty(kP.ShapeLeft,0),this.shapeProperties.addProperty(kP.ShapeRight,this.imageInfo.actualSize.width),this.shapeProperties.addProperty(kP.ShapeTop,0),this.shapeProperties.addProperty(kP.ShapeBottom,this.imageInfo.actualSize.height),this.shapeProperties.addProperty(kP.ShapeType,wx.PictureFrame),this.shapeProperties.addProperty(kP.PseudoInline,yx.trueIntValue),this.shapeProperties.addProperty(kP.PictureBinaryData,this.imageInfo))}}yx.trueIntValue=1;class xx extends vy{get destinationType(){return Jw.DestinationSubDocument}get controlCharHT(){return xx.controlCharHT}constructor(e,t){super(e),this.subDocument=t}get canAppendText(){return!0}canProcessSpecialHexChar(){return!0}get documentModel(){return this.subDocument.documentModel}static onParChar(e,t){e.flushDecoder(),e.importers.paragraph.insertParagraph(),e.importers.table.tableReader.onEndParagraph()}static onNonBreakingSpaceChar(e,t){e.flushDecoder(),e.parseCharWithoutDecoding(an.specialCharacters.NonBreakingSpace)}static onNonBreakingHyphenChar(e,t){e.flushDecoder(),e.parseCharWithoutDecoding("-")}static onOptionalHyphenChar(e,t){}static onNonShapePictureKeyword(e,t,r){e.destination=new Ey(e)}static onShapeGroupKeyword(e,t,r){e.destination=new Ey(e)}static onTabKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.TabMark)}static onEmDashKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.EmDash)}static onEnDashKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.EnDash)}static onBulletKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.Bullet)}static onLeftSingleQuoteKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.LeftSingleQuote)}static onRightSingleQuoteKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.RightSingleQuote)}static onLeftDoubleQuoteKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.LeftDoubleQuote)}static onRightDoubleQuoteKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.RightDoubleQuote)}static onEmSpaceKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.EmSpace)}static onEnSpaceKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.EnSpace)}static onQmSpaceKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.QmSpace)}static onShapePictureKeyword(e,t,r){e.destination=new yx(e)}static onShapeKeyword(e,t,r){e.destination=e.createShapeDestination()}static onLineBreakKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.LineBreak)}static onTableOfContentsEntryKeyword(e,t,r){e.importers.field.startField(),e.destination=e.createTableContentFieldDestination(!0)}static onTableOfContentsEntryLevelNumberKeyword(e,t,r){e.destination.tableOfContentsEntryLevelNumberKeyword(t,r)}static onTableOfContentsEntryTypeTableKeyword(e,t,r){e.destination.tableOfContentsEntryTypeTableKeyword(t,r)}tableOfContentsEntryLevelNumberKeyword(e,t){this.insertTextCore(` \\l ${e}`)}tableOfContentsEntryTypeTableKeyword(e,t){let r="";t&&e>=32&&e<=255&&(r+=String.fromCharCode(e)),this.insertTextCore(` \\f ${r}`)}static onFieldStartKeyword(e,t,r){e.destination.startNewField()}static onDxCustomRunDataKeyword(e,t,r){}static onZeroWidthJoiner(e,t,r){xx.insertSpecialCharacterCore(e,"‍")}static onZeroWidthNonJoiner(e,t,r){xx.insertSpecialCharacterCore(e,"‌")}static onZeroWidthBreakOpportunity(e,t,r){xx.insertSpecialCharacterCore(e,"‌")}static onZeroWidthNonBreakOpportunity(e,t,r){xx.insertSpecialCharacterCore(e,"‍")}static insertSpecialCharacterCore(e,t){e.importers.character.insertText(t)}static onParKeyword(e,t,r){e.importers.paragraph.insertParagraph(),e.importers.table.tableReader.onEndParagraph()}static onParagraphStyleIndex(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.style.paragraph.rtfStyleIndex=t)}static onTableStyleIndexForRowOrCell(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.table.tableReader.rtfTableStyleIndexForRowOrCell=t)}static onAlignLeftKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.coreProperties.rightToLeft?e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.alignment,Ae.Right):e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.alignment,Ae.Left))}static onAlignCenterKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.alignment,Ae.Center)}static onAlignRightKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.coreProperties.rightToLeft?e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.alignment,Ae.Left):e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.alignment,Ae.Right))}static onAlignJustifyKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.alignment,Ae.Justify)}static onLeftIndentKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&t<=31681&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.leftIndent,t)}static onRightIndentKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.rightIndent,t)}static onFirstLineIndentKeyword(e,t,r){const i=e.importers.paragraph.paragraphFormatting;if(!xx.shouldApplyParagraphFormatting(e))return i.coreProperties.setValue(Ft.firstLineIndentType,ke.None),void i.coreProperties.setValue(Ft.firstLineIndent,0);const n=t;n>0?(i.coreProperties.setValue(Ft.firstLineIndentType,ke.Indented),i.coreProperties.setValue(Ft.firstLineIndent,n)):n<0?(i.coreProperties.setValue(Ft.firstLineIndentType,ke.Hanging),i.coreProperties.setValue(Ft.firstLineIndent,-n)):(i.coreProperties.setValue(Ft.firstLineIndentType,ke.None),i.coreProperties.setValue(Ft.firstLineIndent,0))}static onSpacingBeforeKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.spacingBefore,t)}static onLeftToRightParagraphKeyword(e,t,r){e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.rightToLeft,!1)}static onRightToLeftParagraphKeyword(e,t,r){e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.rightToLeft,!0)}static shouldApplyParagraphStyle(e){return Bb.isEnabled(e.richOptions.control.paragraphStyle)}static shouldApplyParagraphFormatting(e){return Bb.isEnabled(e.richOptions.control.paragraphFormatting)}static onSpacingAfterKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.spacingAfter,t)}static onLineSpacingTypeKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.rtfLineSpacingType=t,e.importers.paragraph.paragraphFormatting.rtfLineSpacingMultiplier=0,e.importers.paragraph.paragraphFormatting.useLineSpacingMultiplier=!1)}static onLineSpacingMultiplierKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.rtfLineSpacingMultiplier=Math.max(0,t),e.importers.paragraph.paragraphFormatting.useLineSpacingMultiplier=!0)}static onHyphenateParagraphKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(r&&0==t?e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.suppressHyphenation,!0):e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.suppressHyphenation,!1))}static onSuppressLineNumbersKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.suppressLineNumbers,!0)}static onContextualSpacingKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.contextualSpacing,!0)}static onPageBreakBeforeKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(r||(t=1),e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.pageBreakBefore,0!=t))}static onBeforeAutoSpacingKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.beforeAutoSpacing,0!=t),0!=t&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.spacingBefore,0))}static onAfterAutoSpacingKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.afterAutoSpacing,0!=t),0!=t&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.spacingAfter,0))}static onKeepWithNextKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(r||(t=1),e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.keepWithNext,0!=t))}static onKeepLinesTogetherKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(r||(t=1),e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.keepLinesTogether,0!=t))}static onWidowOrphanControlOnKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.widowOrphanControl,!0)}static onWidowOrphanControlOffKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.widowOrphanControl,!1)}static onParagraphShadingKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=xx.calculateShadingPattern(t))}static calculateShadingPattern(e){if(e>0){if(e>1e4)return re.Solid;const t=Math.floor(e/250);return me.getShadingPattern(t)}return re.Clear}static onParagraphVerticalBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.ThinVertStripe)}static onParagraphHorizontalBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.ThinHorzStripe)}static onParagraphForwardDiagonalBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.ThinReverseDiagStripe)}static onParagraphBackwardDiagonalBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.ThinDiagStripe)}static onParagraphCrossBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.ThinHorzCross)}static onParagraphDiagonalCrossBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.ThinDiagCross)}static onParagraphDarkHorizontalBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.HorzStripe)}static onParagraphDarkVerticalBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.VertStripe)}static onParagraphDarkForwardDiagonalBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.ReverseDiagStripe)}static onParagraphDarkBackwardDiagonalBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.DiagStripe)}static onParagraphDarkCrossBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.HorzCross)}static onParagraphDarkDiagonalCrossBackgroundPatternKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.shadingPattern=re.DiagCross)}static onParagraphFillColorKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.foreColor=xx.getColorIndex(e,t))}static getColorIndex(e,t){return e.documentProperties.colorIndexes.getRtfColorIndexById(t)}static onParagraphBackgroundKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&(e.importers.paragraph.paragraphFormatting.backColor=xx.getColorIndex(e,t))}static onOutlineLevelKeyword(e,t,r){if(!xx.shouldApplyParagraphFormatting(e))return;let i=t;i<0||i>8?i=0:i++,r||(i=0),e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.outlineLevel,i)}static onResetParagraphPropertiesKeyword(e,t,r){e.importers.table.tableReader.rtfTableStyleIndexForRowOrCell=0,xx.shouldApplyParagraphStyle(e)?(e.importers.paragraph.paragraphFormatting=new Sx,e.importers.style.paragraph.rtfStyleIndex=0):(e.importers.paragraph.paragraphFormatting.paragraphListInfo.numberingListIndex=QP.listIndexNotSetted,e.importers.paragraph.paragraphFormatting.paragraphListInfo.listLevelIndex=0,e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.firstLineIndent,0),e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.firstLineIndentType,ke.None),e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.leftIndent,0))}static onTopParagraphBorderKeyword(e,t,r){const i=new Me;e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.topBorder,i),e.importers.paragraph.paragraphFormatting.processedBorder=i}static onBottomParagraphBorderKeyword(e,t,r){const i=new Me;e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.bottomBorder,i),e.importers.paragraph.paragraphFormatting.processedBorder=i}static onLeftParagraphBorderKeyword(e,t,r){const i=new Me;e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.leftBorder,i),e.importers.paragraph.paragraphFormatting.processedBorder=i}static onRightParagraphBorderKeyword(e,t,r){const i=new Me;e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.rightBorder,i),e.importers.paragraph.paragraphFormatting.processedBorder=i}static onBetweenParagraphBorderKeyword(e,t,r){const i=new Me;e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.betweenBorder,i),e.importers.paragraph.paragraphFormatting.processedBorder=i}static onBarParagraphBorderKeyword(e,t,r){const i=new Me;e.importers.paragraph.paragraphFormatting.coreProperties.setValue(Ft.leftBorder,i),e.importers.paragraph.paragraphFormatting.processedBorder=i}static ensureFramePropertiesExists(e){return!1}static createDefaultFrameFormattingInfo(){return Cx.createDefaultInfo()}static onFrameHorizontalPositionKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.x=t+1)}static onFrameHorizontalPositionNegativeKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.x=t+1)}static onFrameHorizontalAlignmentCenterKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPositionAlignment=py.Center)}static onFrameHorizontalAlignmentLeftKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPositionAlignment=py.Left)}static onFrameHorizontalAlignmentRightKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPositionAlignment=py.Right)}static onFrameHorizontalAlignmentInsideKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPositionAlignment=py.Inside)}static onFrameHorizontalAlignmentOutsideKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPositionAlignment=py.Outside)}static onFrameVerticalPositionKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.y=t+1)}static onFrameVerticalPositionNegativeKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.y=t+1)}static onFrameVerticalAlignmentInlineKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionAlignment=uy.Inline)}static onFrameVerticalAlignmentTopKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionAlignment=uy.Top)}static onFrameVerticalAlignmentCenterKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionAlignment=uy.Center)}static onFrameVerticalAlignmentBottomKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionAlignment=uy.Bottom)}static onFrameVerticalAlignmentInsideKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionAlignment=uy.Inside)}static onFrameVerticalAlignmentOutsideKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionAlignment=uy.Outside)}static onFrameWidthKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.width=Math.abs(t))}static onFrameHeightKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.height=Math.abs(t),t<0&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalRule=hy.Exact),t>0&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalRule=hy.AtLeast))}static onFramePaddingKeyword(e,t,r){if(xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)){const r=t;e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPadding=r,e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPadding=r}}static onFrameVerticalPaddingKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPadding=t)}static onFrameHorizontalPaddingKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPadding=t)}static onParagraphHorizontalPositionTypeMarginKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPositionType=ny.Margin)}static onParagraphHorizontalPositionTypePageKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPositionType=ny.Page)}static onParagraphHorizontalPositionTypeColumnKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.horizontalPositionType=ny.Column)}static onParagraphVerticalPositionTypeMarginKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionType=iy.Margin)}static onParagraphVerticalPositionTypePageKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionType=iy.Page)}static onParagraphVerticalPositionTypeLineKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.verticalPositionType=iy.Paragraph)}static onFrameNoWrapKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.textWrapType=oy.NotBeside)}static onFrameWrapOverlayKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.textWrapType=oy.None)}static onFrameWrapDefaultKeyword(e,t,r){}static onFrameWrapAroundKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.textWrapType=oy.Around)}static onFrameWrapTightKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.textWrapType=oy.Tight)}static onFrameWrapThroughKeyword(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.textWrapType=oy.Through)}static onFrameLockAnchor(e,t,r){xx.shouldApplyParagraphFormatting(e)&&xx.ensureFramePropertiesExists(e)&&(e.importers.paragraph.paragraphFormatting.paragraphFrameFormattingInfo.lockFrameAnchorToParagraph=!!r&&0!=t)}static onCharacterStyleIndex(e,t,r){Bb.isEnabled(e.richOptions.control.characterStyle)&&(e.importers.style.character.rtfStyleIndex=t)}static onBoldKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.bold,i)}static onDeletedKeyword(e,t,r){}static onItalicKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.italic,i)}static onUnderlineKeywordCore(e,t,r,i){const n=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.underlineType,n?i:le.None)}static onUnderlineSingleKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.Single)}static onUnderlineDottedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.Dotted)}static onUnderlineDashedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.Dashed)}static onUnderlineDashDottedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.DashDotted)}static onUnderlineDashDotDottedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.DashDotDotted)}static onUnderlineDoubleKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.Double)}static onUnderlineHeavyWaveKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.HeavyWave)}static onUnderlineLongDashedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.LongDashed)}static onUnderlineThickSingleKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.ThickSingle)}static onUnderlineThickDottedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.ThickDotted)}static onUnderlineThickDashedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.ThickDashed)}static onUnderlineThickDashDottedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.ThickDashDotted)}static onUnderlineThickDashDotDottedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.ThickDashDotDotted)}static onUnderlineThickLongDashedKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.ThickLongDashed)}static onUnderlineDoubleWaveKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.DoubleWave)}static onUnderlineWaveKeyword(e,t,r){xx.onUnderlineKeywordCore(e,t,r,le.Wave)}static onUnderlineNoneKeyword(e,t,r){e.importers.character.characterFormatting.coreProperties.setValue(ir.underlineType,le.None)}static onUnderlineWordsOnlyKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.underlineType,i?le.Single:le.None),e.importers.character.characterFormatting.coreProperties.setValue(ir.underlineWordsOnly,i)}static onUnderlineColorKeyword(e,t,r){r||(t=0),e.importers.character.characterFormatting.coreProperties.setValue(ir.underlineColor,xx.getColorIndex(e,t))}static onStrikeoutKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.strikeoutType,i?se.Single:se.None)}static onDoubleStrikeoutKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.strikeoutType,i?se.Double:se.None)}static onSubscriptKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.script,i?ne.Subscript:ne.Normal)}static onSuperscriptKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.script,i?ne.Superscript:ne.Normal)}static onNoSuperAndSubScriptKeyword(e,t,r){e.importers.character.characterFormatting.coreProperties.setValue(ir.script,ne.Normal)}static onLanguageKeyword(e,t,r){xx.onLanguageNpKeyword(e,t,r),e.importers.character.characterFormatting.coreProperties.setValue(ir.noProof,!1)}static onLanguageEastAsianKeyword(e,t,r){xx.onLanguageEastAsianNpKeyword(e,t,r),e.importers.character.characterFormatting.coreProperties.setValue(ir.noProof,!1)}static onLanguageNpKeyword(e,t,r){xx.checkLanguageParameter(t,r)}static onLanguageEastAsianNpKeyword(e,t,r){xx.checkLanguageParameter(t,r)}static checkLanguageParameter(e,t){return t&&0!=e&&1024!=e}static onNoProofKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.noProof,i)}static onCapsKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.allCaps,i)}static onSmallCapsKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.smallCaps,i)}static onHiddenTextKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.setValue(ir.hidden,i)}static onFontSizeKeyword(e,t,r){r||(t=24),e.importers.character.characterFormatting.coreProperties.setValue(ir.size,Math.max(an.minFontSize,t/2))}static onDoubleByteCharactersKeyword(e,t,r){e.importers.character.characterFormatting.fontType=ly.DoubleByteCharactersFont}static onLowAnsiFontNameKeyword(e,t,r){e.importers.character.characterFormatting.fontType=ly.LowAnsiCharactersFont}static onHighAnsiFontNameKeyword(e,t,r){e.importers.character.characterFormatting.fontType=ly.HighAnsiCharactersFont}static onAssociatedFontNameKeyword(e,t,r){e.importers.character.characterFormatting.fontType!=ly.Undefined&&xx.onFontNameKeyword(e,t,r)}static onFontNameKeyword(e,t,r){r||(t=e.importers.font.defaultFontNumber),e.importers.font.setFont(e.importers.font.fonts.getRtfFontInfoById(t))}static onShadingKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(xx.calculateShadingPattern(t),i.backColor,i.foreColor))}static onVerticalBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.ThinVertStripe,i.backColor,i.foreColor))}static onHorizontalBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.ThinHorzStripe,i.backColor,i.foreColor))}static onForwardDiagonalBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.ThinReverseDiagStripe,i.backColor,i.foreColor))}static onBackwardDiagonalBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.ThinDiagStripe,i.backColor,i.foreColor))}static onCrossBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.ThinHorzCross,i.backColor,i.foreColor))}static onDiagonalCrossBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.ThinDiagCross,i.backColor,i.foreColor))}static onDarkHorizontalBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.HorzStripe,i.backColor,i.foreColor))}static onDarkVerticalBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.VertStripe,i.backColor,i.foreColor))}static onDarkForwardDiagonalBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.ReverseDiagStripe,i.backColor,i.foreColor))}static onDarkBackwardDiagonalBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.DiagStripe,i.backColor,i.foreColor))}static onDarkCrossBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.HorzCross,i.backColor,i.foreColor))}static onDarkDiagonalCrossBackgroundPatternKeyword(e,t,r){const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(re.DiagCross,i.backColor,i.foreColor))}static onFillColorKeyword(e,t,r){r||(t=0);const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(i.shadingPattern,i.backColor,xx.getColorIndex(e,t)))}static onForeColorKeyword(e,t,r){r||(t=0),e.importers.character.characterFormatting.coreProperties.setValue(ir.textColor,xx.getColorIndex(e,t))}static onHighlightColorKeyword(e,t,r){r||(t=0),e.importers.character.characterFormatting.coreProperties.setValue(ir.highlightColor,xx.getColorIndex(e,t))}static onBackColorKeyword(e,t,r){r||(t=0);const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.setValue(ir.shadingInfo,new fe(i.shadingPattern,xx.getColorIndex(e,t),i.foreColor))}static onPlainKeyword(e,t,r){e.importers.character.onPlainKeyword()}static onRTLRunKeyword(e,t,r){}static onLTRRunKeyword(e,t,r){}static onListOverride(e,t,r){let i=e.importers.numbering.listOverrideIndexToNumberingListIndexMap[t];void 0!==i&&(e.importers.paragraph.paragraphFormatting.paragraphListInfo.numberingListIndex=i)}static onListLevel(e,t,r){e.importers.paragraph.paragraphFormatting.paragraphListInfo.listLevelIndex=t}static onListText(e,t,r){e.destination=new Ey(e)}static onTabRightKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabAlignment=Ha.Right)}static onTabCenterKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabAlignment=Ha.Center)}static onTabDecimalKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabAlignment=Ha.Decimal)}static onTabLeaderDotsKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabLeader=Sg.Dots)}static onTabLeaderMiddleDotsKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabLeader=Sg.MiddleDots)}static onTabLeaderHyphensKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabLeader=Sg.Hyphens)}static onTabLeaderUnderlineKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabLeader=Sg.Underline)}static onTabLeaderThickLineKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabLeader=Sg.ThickLine)}static onTabLeaderEqualSignKeyword(e,t,r){xx.shouldApplyParagraphStyle(e)&&(e.importers.paragraph.paragraphFormatting.tabLeader=Sg.EqualSign)}static onTabPositionKeyword(e,t,r){const i=e.importers.paragraph.paragraphFormatting;if(r&&Math.abs(t)<=31681){const e=new rs(t,i.tabAlignment,i.tabLeader,!1,!1);i.tabs.tabsInfo.push(e)}i.tabAlignment=Ha.Left,i.tabLeader=Sg.None}static onBarTabKeyword(e,t,r){const i=e.importers.paragraph.paragraphFormatting;i.tabAlignment=Ha.Left,i.tabLeader=Sg.None}static onTableRowDefaultsKeyword(e,t,r){e.importers.table.tableReader.onTableRowDefaults()}static onTableStyleKeyword(e,t,r){e.importers.table.tableReader.tableProperties.style=e.importers.style.table.getModelIndex(t)}static onInTableParagraphKeyword(e,t,r){e.importers.paragraph.paragraphFormatting.inTableParagraph=!r||0!=t}static onRowKeyword(e,t,r){e.importers.table.tableReader.onEndRow()}static onCellKeyword(e,t,r){e.importers.paragraph.insertParagraph(),e.importers.table.tableReader.onEndCell()}static onNestedCellKeyword(e,t,r){e.importers.paragraph.insertParagraph(),e.importers.table.tableReader.onEndNestedCell()}static onNestedRowKeyword(e,t,r){e.importers.table.tableReader.onEndNestedRow()}static onNestedTablePropertiesKeyword(e,t,r){e.importers.table.tableReader.onStartNestedTableProperties()}static onItapKeyword(e,t,r){!r||t<0||(e.importers.paragraph.paragraphFormatting.nestingLevel=t)}startNewField(){this.importer.importers.field.startField(),this.importer.destination=this.importer.createFieldDestination()}nestedGroupFinished(e){e instanceof dx&&this.importer.importers.image.insertImage(e.getImageInfo());const t=this.importer.importers.numbering.currentOldSimpleList?this.importer.importers.numbering.currentOldSimpleListIndex:this.importer.importers.numbering.currentOldMultiLevelListIndex;if(t>=QP.minValue){const r=this.importer.importers.numbering.currentOldSimpleList?0:this.importer.importers.numbering.currentOldListLevelNumber,i=this.importer.documentModel.numberingLists[t].levels[r];if(e instanceof Px)return void(i.getListLevelProperties().displayFormatString=e.value+i.getListLevelProperties().displayFormatString);if(e instanceof Ix)return void(i.getListLevelProperties().displayFormatString=i.getListLevelProperties().displayFormatString+e.value)}}processCharCore(e){const t=this.importer.importers.character.characterFormatting;this.importer.importers.character.characterFormatting.rtfFormattingInfo.deleted||(t.useDoubleByteCharactersFontName||t.useLowAnsiCharactersFontName||t.useHighAnsiCharactersFontName?this.importer.importers.character.appendChar(e):this.importer.importers.character.insertText(e))}processTextCore(e){this.insertTextCore(e)}insertTextCore(e){const t=this.importer.importers.character.characterFormatting;this.importer.importers.character.characterFormatting.rtfFormattingInfo.deleted||(t.useDoubleByteCharactersFontName||t.useLowAnsiCharactersFontName||t.useHighAnsiCharactersFontName?this.importer.importers.character.splitByCharTypeAndInsertText(e):this.importer.importers.character.insertText(e))}processSpecialHexCharCore(e){"\r"==e?xx.onParKeyword(this.importer,0,!1):super.processSpecialHexCharCore(e)}findParentComment(e,t){return null}findParenCommentInPieceTable(e){return null}static onCellxKeyword(e,t,r){e.importers.table.tableReader.onCellxProperty(t)}static onCellPreferredWidthKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.cellProperties.preferredWidth.value=t)}static onWidthUnitTypeKeyword(e,t,r){r&&(e.importers.table.tableReader.cellProperties.preferredWidth.type=xx.getWidthUnitType(t))}static getWidthUnitType(e){let t=Je.Auto;switch(e){case 1:t=Je.Auto;break;case 2:t=Je.FiftiethsOfPercent;break;case 3:t=Je.ModelUnits;break;default:t=Je.Nil}return t}static onFirstHorizontalMergedCellKeyword(e,t,r){e.importers.table.tableReader.cellProperties.horizontalMerging==Xe.None&&(e.importers.table.tableReader.cellProperties.horizontalMerging=Xe.Restart)}static onNextHorizontalMergedCellKeyword(e,t,r){e.importers.table.tableReader.cellProperties.horizontalMerging=Xe.Continue}static onFirstVerticalMergedCellKeyword(e,t,r){e.importers.table.tableReader.cellProperties.verticalMerging=Xe.Restart}static onNextVerticalMergedCellKeyword(e,t,r){e.importers.table.tableReader.cellProperties.verticalMerging=Xe.Continue}static onRowLeftKeyword(e,t,r){e.importers.table.tableReader.rowProperties.left=t}static onRowHeaderKeyword(e,t,r){r&&0==t||e.importers.table.tableReader.rowProperties.coreProperties.setValue(fx.header,!0)}static onRowHeightKeyword(e,t,r){if(!r)return;const i=t,n=e.importers.table.tableReader.rowProperties;n.height.value=Math.abs(i),n.height.type=t<0?$e.Exact:t>0?$e.Minimum:$e.Auto}static onRowKeepKeyword(e,t,r){r&&0==t||e.importers.table.tableReader.rowProperties.coreProperties.setValue(fx.cantSplit,!0)}static onTableRightAlignmentKeyword(e,t,r){e.importers.table.tableReader.rowProperties.coreProperties.setValue(fx.rowAlignment,je.Right)}static onTableLeftAlignmentKeyword(e,t,r){e.importers.table.tableReader.rowProperties.coreProperties.setValue(fx.rowAlignment,je.Left)}static onTableCenterAlignmentKeyword(e,t,r){e.importers.table.tableReader.rowProperties.coreProperties.setValue(fx.rowAlignment,je.Center)}static onSpaceBetweenCellsKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.halfSpace=t)}static onTableBottomCellMarginKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseBottomMargin,!0),e.importers.table.tableReader.tableProperties.coreProperties.cellMargins.bottom.value=t)}static onTableLeftCellMarginKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseLeftMargin,!0),e.importers.table.tableReader.tableProperties.coreProperties.cellMargins.left.value=t)}static onTableRightCellMarginKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseRightMargin,!0),e.importers.table.tableReader.tableProperties.coreProperties.cellMargins.right.value=t)}static onTableTopCellMarginKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseTopMargin,!0),e.importers.table.tableReader.tableProperties.coreProperties.cellMargins.top.value=t)}static onTableBottomCellMarginUnitTypeKeyword(e,t,r){r&&(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseBottomMargin,!0),xx.assignWidthUnitInfo(e.importers.table.tableReader.tableProperties.coreProperties.cellMargins.bottom,t))}static assignWidthUnitInfo(e,t){3==t?e.type=Je.ModelUnits:0==t&&(e.type=Je.Nil)}static onTableLeftCellMarginUnitTypeKeyword(e,t,r){r&&(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseLeftMargin,!0),xx.assignWidthUnitInfo(e.importers.table.tableReader.tableProperties.coreProperties.cellMargins.left,t))}static onTableRightCellMarginUnitTypeKeyword(e,t,r){r&&(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseRightMargin,!0),xx.assignWidthUnitInfo(e.importers.table.tableReader.tableProperties.coreProperties.cellMargins.right,t))}static onTableTopCellMarginUnitTypeKeyword(e,t,r){r&&(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseTopMargin,!0),xx.assignWidthUnitInfo(e.importers.table.tableReader.tableProperties.coreProperties.cellMargins.top,t))}static onTableBottomCellSpacingKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseCellSpacing,!0),e.importers.table.tableReader.tableProperties.coreProperties.cellSpacing.value=t)}static onTableLeftCellSpacingKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseCellSpacing,!0),e.importers.table.tableReader.tableProperties.coreProperties.cellSpacing.value=t)}static onTableRightCellSpacingKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseCellSpacing,!0),e.importers.table.tableReader.tableProperties.coreProperties.cellSpacing.value=t)}static onTableTopCellSpacingKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseCellSpacing,!0),e.importers.table.tableReader.tableProperties.coreProperties.cellSpacing.value=t)}static onTableBottomCellSpacingUnitTypeKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseCellSpacing,!0),xx.assignWidthUnitInfo(e.importers.table.tableReader.tableProperties.coreProperties.cellSpacing,t))}static onTableLeftCellSpacingUnitTypeKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseCellSpacing,!0),xx.assignWidthUnitInfo(e.importers.table.tableReader.tableProperties.coreProperties.cellSpacing,t))}static onTableRightCellSpacingUnitTypeKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseCellSpacing,!0),xx.assignWidthUnitInfo(e.importers.table.tableReader.tableProperties.coreProperties.cellSpacing,t))}static onTableTopCellSpacingUnitTypeKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseCellSpacing,!0),xx.assignWidthUnitInfo(e.importers.table.tableReader.tableProperties.coreProperties.cellSpacing,t))}static onTablePreferredWidthKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.preferredWidth.value=t)}static onTablePreferredWidthUnitTypeKeyword(e,t,r){e.importers.table.tableReader.tableProperties.preferredWidth.type=xx.getWidthUnitType(t)}static onWidthBeforeKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.rowProperties.widthBefore.value=t)}static onWidthBeforeUnitTypeKeyword(e,t,r){e.importers.table.tableReader.rowProperties.widthBefore.type=xx.getWidthUnitType(t)}static onWidthAfterKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.rowProperties.widthAfter.value=t)}static onWidthAfterUnitTypeKeyword(e,t,r){e.importers.table.tableReader.rowProperties.widthAfter.type=xx.getWidthUnitType(t)}static onRowBackgroundColorKeyword(e,t,r){const i=e.documentProperties.colorIndexes;!r||t>i.collection.length-1||(e.importers.table.tableReader.rowProperties.backColor=xx.getColorIndex(e,t))}static onRowForegroundColorKeyword(e,t,r){const i=e.documentProperties.colorIndexes;!r||t>i.collection.length-1||(e.importers.table.tableReader.rowProperties.foreColor=xx.getColorIndex(e,t))}static onRowPatternKeyword(e,t,r){r&&(e.importers.table.tableReader.rowProperties.shadingPattern=xx.calculateShadingPattern(t))}static onRowShadingKeyword(e,t,r){r&&(e.importers.table.tableReader.rowProperties.shadingPattern=xx.calculateShadingPattern(t))}static onRowVerticalPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.ThinVertStripe}static onRowHorizontalPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.ThinHorzStripe}static onRowForwardDiagonalPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.ThinReverseDiagStripe}static onRowBackwardDiagonalPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.ThinDiagStripe}static onRowCrossPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.ThinHorzCross}static onRowDiagonalCrossPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.ThinDiagCross}static onRowDarkHorizontalPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.HorzStripe}static onRowDarkVerticalPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.VertStripe}static onRowDarkForwardDiagonalPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.ReverseDiagStripe}static onRowDarkBackwardDiagonalPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.DiagStripe}static onRowDarkCrossPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.HorzCross}static onRowDarkDiagonalCrossPatternKeyword(e,t,r){e.importers.table.tableReader.rowProperties.shadingPattern=re.DiagCross}static onTableIndentKeyword(e,t,r){r&&(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseTableIndent,!0),e.importers.table.tableReader.tableProperties.coreProperties.indent.value=t)}static onTableIndentUnitType(e,t,r){r&&(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseTableIndent,!0),e.importers.table.tableReader.tableProperties.coreProperties.indent.type=xx.getWidthUnitType(t))}static onCellFitTextKeyword(e,t,r){r&&0==t||e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.fitText,!0)}static onCellNoWrapKeyword(e,t,r){r&&0==t||e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.noWrap,!0)}static onCellVerticalAlignmentTopKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.vertivalAlignment,Ke.Top)}static onCellVerticalAlignmentCenterKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.vertivalAlignment,Ke.Center)}static onCellVerticalAlignmentBottomKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.vertivalAlignment,Ke.Bottom)}static onCellHideMarkKeyword(e,t,r){r&&0==t||e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.hideCellMark,!0)}static onCellBottomCellMarginKeyword(e,t,r){t<0||!r||e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.bottomMargin,lr.create(t,Je.ModelUnits))}static onCellLeftCellMarginKeyword(e,t,r){t<0||!r||e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.topMargin,lr.create(t,Je.ModelUnits))}static onCellRightCellMarginKeyword(e,t,r){t<0||!r||e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.rightMargin,lr.create(t,Je.ModelUnits))}static onCellTopCellMarginKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.cellProperties.coreProperties.cellMargins.left.value=t)}static onCellBottomCellMarginUnitTypeKeyword(e,t,r){r&&xx.assignWidthUnitInfo(e.importers.table.tableReader.cellProperties.coreProperties.cellMargins.bottom,t)}static onCellLeftCellMarginUnitTypeKeyword(e,t,r){r&&xx.assignWidthUnitInfo(e.importers.table.tableReader.cellProperties.coreProperties.cellMargins.top,t)}static onCellRightCellMarginUnitTypeKeyword(e,t,r){r&&xx.assignWidthUnitInfo(e.importers.table.tableReader.cellProperties.coreProperties.cellMargins.right,t)}static onCellTopCellMarginUnitTypeKeyword(e,t,r){r&&xx.assignWidthUnitInfo(e.importers.table.tableReader.cellProperties.coreProperties.cellMargins.left,t)}static onTableOverlapKeyword(e,t,r){r&&0==t||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseIsTableOverlap,!0),e.importers.table.tableReader.tableProperties.coreProperties.isTableOverlap=!1)}static onTableLeftFromTextKeyword(e,t,r){r&&(e.importers.table.tableReader.rowProperties.floatingPosition.leftFromText=t)}static onTableRightFromTextKeyword(e,t,r){r&&(e.importers.table.tableReader.rowProperties.floatingPosition.rightFromText=t)}static onTableTopFromTextKeyword(e,t,r){r&&(e.importers.table.tableReader.rowProperties.floatingPosition.topFromText=t)}static onTableBottomFromTextKeyword(e,t,r){r&&(e.importers.table.tableReader.rowProperties.floatingPosition.bottomFromText=t)}static onColHorizontalAnchorKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.horizontalAnchor=Ve.Column}static onMarginHorizontalAnchorKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.textWrapping=ze.Around,e.importers.table.tableReader.rowProperties.floatingPosition.horizontalAnchor=Ve.Margin}static onPageHorizontalAnchorKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.textWrapping=ze.Around,e.importers.table.tableReader.rowProperties.floatingPosition.horizontalAnchor=Ve.Page}static onTableHorizontalPositionKeyword(e,t,r){r&&0!=t&&(e.importers.table.tableReader.rowProperties.floatingPosition.textWrapping=ze.Around)}static onTableVerticalPositionKeyword(e,t,r){r&&(0!=t&&(e.importers.table.tableReader.rowProperties.floatingPosition.textWrapping=ze.Around),e.importers.table.tableReader.rowProperties.floatingPosition.tableVerticalPosition=t)}static onCenterTableHorizontalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.horizontalAlign=Ue.Center}static onInsideTableHorizontalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.horizontalAlign=Ue.Inside}static onLeftTableHorizontalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.horizontalAlign=Ue.Left}static onOutsideTableHorizontalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.horizontalAlign=Ue.Outside}static onRightTableHorizontalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.horizontalAlign=Ue.Right}static onBottomTableVerticalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.verticalAlign=He.Bottom}static onCenterTableVerticalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.verticalAlign=He.Center}static onInlineTableVerticalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.verticalAlign=He.Inline}static onInsideTableVerticalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.verticalAlign=He.Inside}static onOutsideTableVerticalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.verticalAlign=He.Outside}static onTopTableVerticalAlignKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.verticalAlign=He.Top}static onMarginVerticalAnchorKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.verticalAnchor=We.Margin}static onParagraphVerticalAnchorKeword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.textWrapping=ze.Around,e.importers.table.tableReader.rowProperties.floatingPosition.verticalAnchor=We.Paragraph}static onPageVerticalAnchorKeyword(e,t,r){e.importers.table.tableReader.rowProperties.floatingPosition.textWrapping=ze.Around,e.importers.table.tableReader.rowProperties.floatingPosition.verticalAnchor=We.Page}static onTopTableBorderKeyword(e,t,r){e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseTopBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.tableProperties.coreProperties.borders.top}static onLeftTableBorderKeyword(e,t,r){e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseLeftBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.tableProperties.coreProperties.borders.left}static onBottomTableBorderKeword(e,t,r){e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseBottomBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.tableProperties.coreProperties.borders.bottom}static onRightTableBorderKeyword(e,t,r){e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseRightBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.tableProperties.coreProperties.borders.right}static onHorizontalTableBorderKeyword(e,t,r){e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseInsideHorizontalBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.tableProperties.coreProperties.borders.insideHorizontal}static onVerticalTableBorderKeyword(e,t,r){e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseInsideVerticalBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.tableProperties.coreProperties.borders.insideVertical}static onNoTableBorderKeyword(e,t,r){null!=e.importers.table.tableReader.processedBorder&&(e.importers.table.tableReader.processedBorder.style=de.None,e.importers.table.tableReader.processedBorder=null)}static onBottomCellBorderKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setUseValue(Ye.UseBottomBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.cellProperties.coreProperties.borders.bottom}static onTopCellBorderKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setUseValue(Ye.UseTopBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.cellProperties.coreProperties.borders.top}static onLeftCellBorderKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setUseValue(Ye.UseLeftBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.cellProperties.coreProperties.borders.left}static onRightCellBorderKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setUseValue(Ye.UseRightBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.cellProperties.coreProperties.borders.right}static onUpperLeftToLowerRightBorderKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setUseValue(Ye.UseTopLeftDiagonalBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.cellProperties.coreProperties.borders.topLeftDiagonal}static onUpperRightToLowerLeftBorderKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setUseValue(Ye.UseTopRightDiagonalBorder,!0),e.importers.table.tableReader.processedBorder=e.importers.table.tableReader.cellProperties.coreProperties.borders.topRightDiagonal}static onCellTextTopAlignmentKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.vertivalAlignment,Ke.Top)}static onCellTextCenterVerticalAlignmentKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.vertivalAlignment,Ke.Center)}static onCellTextBottomAlignmentKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.setValue(hr.vertivalAlignment,Ke.Bottom)}static onCellLeftToRightTopToBottomTextDirectionKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.textDirection=Ge.LeftToRightTopToBottom}static onCellTopToBottomRightToLeftTextDirectionKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.textDirection=Ge.TopToBottomRightToLeft}static onCellBottomToTopLeftToRightTextDirectionKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.textDirection=Ge.BottomToTopLeftToRight}static onCellLeftToRightTopToBottomVerticalTextDirectionKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.textDirection=Ge.LeftToRightTopToBottomRotated}static onCellTopToBottomRightToLeftVerticalTextDirectionKeyword(e,t,r){e.importers.table.tableReader.cellProperties.coreProperties.textDirection=Ge.TopToBottomRightToLeftRotated}static onCellBackgroundColorKeyword(e,t,r){const i=e.documentProperties.colorIndexes;!r||t>i.collection.length-1||(e.importers.table.tableReader.cellProperties.backColor=xx.getColorIndex(e,t))}static onCellForegroundColorKeyword(e,t,r){const i=e.documentProperties.colorIndexes;!r||t>i.collection.length-1||(e.importers.table.tableReader.cellProperties.foreColor=xx.getColorIndex(e,t))}static onCellShadingKeyword(e,t,r){r&&(e.importers.table.tableReader.cellProperties.shadingPattern=xx.calculateShadingPattern(t))}static onCellNoShadingKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.Nil}static onCellVerticalBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.ThinVertStripe}static onCellHorizontalBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.ThinHorzStripe}static onCellForwardDiagonalBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.ThinReverseDiagStripe}static onCellBackwardDiagonalBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.ThinDiagStripe}static onCellCrossBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.ThinHorzCross}static onCellDiagonalCrossBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.ThinDiagCross}static onCellDarkHorizontalBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.HorzStripe}static onCellDarkVerticalBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.VertStripe}static onCellDarkForwardDiagonalBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.ReverseDiagStripe}static onCellDarkBackwardDiagonalBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.DiagStripe}static onCellDarkCrossBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.HorzCross}static onCellDarkDiagonalCrossBackgroundPatternKeyword(e,t,r){e.importers.table.tableReader.cellProperties.shadingPattern=re.DiagCross}static onTableAutoFitKeyword(e,t,r){const i=Math.abs(t);i>1||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseTableLayout,!0),e.importers.table.tableReader.tableProperties.coreProperties.layoutType=1==i?Oe.Autofit:Oe.Fixed)}static onApplyFirstRowConditionalFormattingKeyword(e,t,r){e.importers.table.tableReader.tableProperties.lookTypes|=_e.ApplyFirstRow}static onApplyLastRowConditionalFormattingKeyword(e,t,r){e.importers.table.tableReader.tableProperties.lookTypes|=_e.ApplyLastRow}static onApplyFirstColumnContitionalFormattingKeyword(e,t,r){e.importers.table.tableReader.tableProperties.lookTypes|=_e.ApplyFirstColumn}static onApplyLastColumnConditionalFormattingKeyword(e,t,r){e.importers.table.tableReader.tableProperties.lookTypes|=_e.ApplyLastColumn}static onDoNotApplyRowBandingConditionalFormattingKeyword(e,t,r){e.importers.table.tableReader.tableProperties.lookTypes|=_e.DoNotApplyRowBanding}static onDoNotApplyColumnBandingConditionalFormattingKeyword(e,t,r){e.importers.table.tableReader.tableProperties.lookTypes|=_e.DoNotApplyColumnBanding}static onRowBandSizeKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseTableStyleRowBandSize,!0),e.importers.table.tableReader.tableProperties.coreProperties.tableStyleRowBandSize=t)}static onColumnBandSizeKeyword(e,t,r){t<0||!r||(e.importers.table.tableReader.tableProperties.coreProperties.setUseValue(ur.UseTableStyleColBandSize,!0),e.importers.table.tableReader.tableProperties.coreProperties.tableStyleColumnBandSize=t)}static onLtrRow(e,t,r){e.importers.table.tableReader.tableProperties.rightToLeft=!1}static onRtlRow(e,t,r){e.importers.table.tableReader.tableProperties.rightToLeft=!0}static onNoBorderKeyword(e,t,r){xx.setNoBorderType(e,de.Nil)}static onBorderSpaceKeyword(e,t,r){if(!r||t<0)return;const i=e.importers.table.tableReader.processedBorder;i&&(i.offset=t);const n=e.importers.paragraph.paragraphFormatting.processedBorder;n&&(n.offset=t)}static assignDefaultBorderWidth(e){}static setBorderType(e,t){const r=e.importers.table.tableReader.processedBorder;r&&(xx.assignDefaultBorderWidth(r),r.style=t);const i=e.importers.paragraph.paragraphFormatting.processedBorder;i&&(i.style=t)}static setNoBorderType(e,t){const r=e.importers.table.tableReader.processedBorder;r&&(r.style=t),e.importers.table.tableReader.processedBorder=null;const i=e.importers.paragraph.paragraphFormatting.processedBorder;i&&(i.style=t),e.importers.paragraph.paragraphFormatting.processedBorder=null}static onSingleThicknessBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.Single)}static onDoubleThicknessBorderTypeKeyword(e,t,r){const i=e.importers.table.tableReader.processedBorder;i&&(xx.assignDefaultBorderWidth(i),i.width*=2,i.style=de.Single);const n=e.importers.paragraph.paragraphFormatting.processedBorder;n&&(n.width*=2,n.style=de.Single)}static onBorderWidthKeyword(e,t,r){const i=e.importers.table.tableReader.processedBorder,n=e.importers.paragraph.paragraphFormatting.processedBorder;if(!i&&!n)return;const o=t>0?t>255?255:t:0;i&&(i.width=o>0?o:1),n&&(n.width=o>0?o:1)}static onBorderColorKeyword(e,t,r){if(!r||t<0)return;const i=e.importers.table.tableReader.processedBorder,n=e.importers.paragraph.paragraphFormatting.processedBorder;if(!i&&!n)return;const o=e.documentProperties.colorIndexes;if(t>o.collection.length-1)return;const a=o.getRtfColorIndexById(t);i&&(i.color=a),n&&(n.color=a)}static onDoubleBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.Double)}static onDottedBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.Dotted)}static onDashedBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.Dashed)}static onHairlineBorderTypeKeyword(e,t,r){const i=e.importers.table.tableReader.processedBorder;i&&(i.style=de.Single,i.width=1);const n=e.importers.paragraph.paragraphFormatting.processedBorder;n&&(n.style=de.Single,n.width=1)}static onSmallDashedBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.DashSmallGap)}static onDotDashedBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.DotDash)}static onDotDotDashedBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.DotDotDash)}static onInsetBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.Inset)}static onNoneBorderTypeKeyword(e,t,r){xx.setNoBorderType(e,de.None)}static onNilBorderTypeKeyword(e,t,r){xx.setNoBorderType(e,de.Nil)}static onOutsetBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.Outset)}static onTripletBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.Triple)}static onSmallThickThinBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThickThinSmallGap)}static onSmallThinThickThinBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThinThickThinSmallGap)}static onMediumThickThinBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThickThinMediumGap)}static onMediumThinThickBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThinThickMediumGap)}static onMediumThinThickThinBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThinThickThinMediumGap)}static onLargeThickThinBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThickThinLargeGap)}static onLargeThinThickBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThinThickLargeGap)}static onLargeThinThickThinBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThinThickThinLargeGap)}static onWavyBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.Wave)}static onDoubleWavyBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.DoubleWave)}static onStripedBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.DashDotStroked)}static onEmbossedBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThreeDEmboss)}static onEngravedBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThreeDEngrave)}static onSmallThinThickBorderTypeKeyword(e,t,r){xx.setBorderType(e,de.ThinThickSmallGap)}static onBorderArtIndex(e,t,r){xx.setBorderType(e,bx.getBorderLineStyle(t))}static onFrameBorderKeyword(e,t,r){const i=e.importers.table.tableReader.processedBorder,n=e.importers.paragraph.paragraphFormatting.processedBorder;(i||n)&&(r&&0==t||(i&&(i.frame=!0),n&&(n.frame=!0)))}static onShadowedBorderTypeKeyword(e,t,r){const i=e.importers.table.tableReader.processedBorder,n=e.importers.paragraph.paragraphFormatting.processedBorder;(i||n)&&(r&&0==t||(i&&(i.shadow=!0),n&&(n.shadow=!0)))}}xx.controlCharHT=(new Eu).add("\r",xx.onParChar).add("\n",xx.onParChar).add("\\",xx.onEscapedChar).add("{",xx.onEscapedChar).add("}",xx.onEscapedChar).add("~",xx.onNonBreakingSpaceChar).add("_",xx.onNonBreakingHyphenChar).add("-",xx.onOptionalHyphenChar).get();class Tx extends xx{get destinationType(){return Jw.ShapeTextDestination}createClone(){return new Tx(this.importer,this.subDocument)}}class vx extends vy{get destinationType(){return Jw.ShapePropertiesDestinationBase}get controlCharHT(){return null}constructor(e,t=new Zy){super(e),this.shapeProperties=t}static getThis(e){return e.destination}static onShapeId(e,t,r){}static onShapeTextKeyword(e,t,r){const i=vx.getThis(e),n=e.documentModel.createSubDocument(yo.TextBox,e.subDocument.id,!0);n.chunks=[new mo(n.positionManager.registerPosition(0),"",!0)],i.shapeProperties.addProperty(kP.ShapeText,n.id),i.markAsShape(),e.destination=new Tx(e,n)}static onShapePropertyKeyword(e,t,r){e.destination=new mx(e,vx.getThis(e).shapeProperties)}static onShapeResultKeyword(e,t,r){e.destination=new Ey(e)}static onShapeLockedKeyword(e,t,r){vx.getThis(e).shapeProperties.addProperty(kP.ShapeLocked,vx.trueIntValue)}static onShapeWrapTextSideKeyword(e,t,r){r&&vx.getThis(e).shapeProperties.addProperty(kP.ShapeWrapTextSide,t)}static onShapeWrapTextTypeZOrderKeyword(e,t,r){if(r){const r=vx.getThis(e),i=r.shapeProperties.getPropertyOrNull(kP.ShapeWrapTextType);null!==i&&i==uc.None&&r.shapeProperties.addProperty(kP.ShapeWrapTextTypeZOrder,t)}}static onShapeWrapTextTypeKeyword(e,t,r){if(r){const r=vx.convertDrawingObjectTextWrapType(t);if(r==uc.None)return;vx.getThis(e).shapeProperties.addProperty(kP.ShapeWrapTextType,r)}}static convertDrawingObjectTextWrapType(e){let t=uc.None;return b.j.forEach(kP.DrawingObjectTextWrapTypeTable,((r,i)=>{e==r&&(t=i)})),t}static onShapeHorizontalPositionTypePageKeyword(e,t,r){vx.setDrawingObjectHorizontalPositionType(vx.getThis(e).shapeProperties,ry.Page)}static onShapeHorizontalPositionTypeMarginKeyword(e,t,r){vx.setDrawingObjectHorizontalPositionType(vx.getThis(e).shapeProperties,ry.Margin)}static onShapeHorizontalPositionTypeColumnKeyword(e,t,r){vx.setDrawingObjectHorizontalPositionType(vx.getThis(e).shapeProperties,ry.Column)}static onShapeHorizontalPositionTypeIgnoreKeyword(e,t,r){vx.getThis(e).shapeProperties.addProperty(kP.ShapeIgnoreLegacyHorizontalPositionType,vx.trueIntValue)}static onShapeVerticalPositionTypePageKeyword(e,t,r){vx.setDrawingObjectVerticalPositionType(vx.getThis(e).shapeProperties,ty.Page)}static onShapeVerticalPositionTypeMarginKeyword(e,t,r){vx.setDrawingObjectVerticalPositionType(vx.getThis(e).shapeProperties,ty.Margin)}static onShapeVerticalPositionTypeParagraphKeyword(e,t,r){vx.setDrawingObjectVerticalPositionType(vx.getThis(e).shapeProperties,ty.Paragraph)}static onShapeVerticalPositionTypeIgnoreKeyword(e,t,r){vx.getThis(e).shapeProperties.addProperty(kP.ShapeIgnoreLegacyVerticalPositionType,vx.trueIntValue)}static onShapeLeftKeyword(e,t,r){r&&vx.getThis(e).onShapeLeftKeyword(t)}static onShapeTopKeyword(e,t,r){r&&vx.getThis(e).onShapeTopKeyword(t)}static onShapeRightKeyword(e,t,r){r&&vx.getThis(e).onShapeRightKeyword(t)}static onShapeBottomKeyword(e,t,r){r&&vx.getThis(e).onShapeBottomKeyword(t)}static onShapeZOrderKeyword(e,t,r){r&&vx.getThis(e).shapeProperties.addProperty(kP.ShapeZOrder,Math.max(0,t))}static setDrawingObjectVerticalPositionType(e,t){e.addProperty(kP.DXInternalLegacyVerticalPositionAlignment,t)}static setDrawingObjectHorizontalPositionType(e,t){e.addProperty(kP.DXInternalLegacyHorizontalPositionAlignment,t)}processControlCharCore(e){}processCharCore(e){}processKeywordCore(e,t,r){const i=this.keywordHT[e];return void 0!==i&&(i(this.importer,t,r),!0)}hasColorProperty(e){return null!=this.shapeProperties.getPropertyOrNull(e)}getColorPropertyValue(e){const t=this.shapeProperties.getNullableColorProperty(e);return null!=t?t:U.empty}onShapeLeftKeyword(e){this.shapeProperties.addProperty(kP.ShapeLeft,e),this.markAsShape()}onShapeTopKeyword(e){this.shapeProperties.addProperty(kP.ShapeTop,e),this.markAsShape()}onShapeRightKeyword(e){this.shapeProperties.addProperty(kP.ShapeRight,e),this.markAsShape()}onShapeBottomKeyword(e){this.shapeProperties.addProperty(kP.ShapeBottom,e),this.markAsShape()}markAsShape(){this.shapeProperties.addProperty(kP.DXInternalIsShape,vx.trueIntValue)}}vx.distanceFromText=114305,vx.trueIntValue=1;class Mx extends vx{get destinationType(){return Jw.ShapeInstanceDestination}createClone(){return new Mx(this.importer,this.shapeProperties)}nestedGroupFinished(e){}}class Ex extends vy{get destinationType(){return Jw.PageBackgroundDestination}get controlCharHT(){return null}createClone(){return new Ex(this.importer)}beforeNestedGroupFinishedCore(e){super.beforeNestedGroupFinishedCore(e),this.importer.destination instanceof Mx&&this.importer.destination.hasColorProperty("fillColor")&&(this.importer.documentModel.pageBackColor=this.importer.destination.getColorPropertyValue("fillColor"))}}class Dx extends xx{get destinationType(){return Jw.DefaultCharacterPropertiesDestination}get controlCharHT(){return null}constructor(e){super(e,e.subDocument),this.importer.importers.character.characterFormatting.coreProperties.setValue(ir.size,10)}get canAppendText(){return!1}beforePopRtfState(){this.documentModel.defaultCharacterProperties=this.importer.importers.character.characterFormatting.coreProperties.clone(),this.importer.importers.character.characterFormatting.coreProperties.setUseValue(ie.UseDoubleFontSize,!1)}createClone(){return new Dx(this.importer)}processCharCore(e){}finalizeSubDocumentCreation(){}}class Fx extends xx{get destinationType(){return Jw.DefaultParagraphPropertiesDestination}get controlCharHT(){return null}constructor(e){super(e,e.subDocument)}get canAppendText(){return!1}beforePopRtfState(){}createClone(){return new Fx(this.importer)}processCharCore(e){}finalizeSubDocumentCreation(){}}class Rx{static shouldInsertNumbering(e){return!0}static shouldInsertMultiLevelNumbering(e){return!0}}class Lx{constructor(e){this.data=e}get documentModel(){return this.data.documentModel}get subDocument(){return this.data.subDocument}applyState(e,t){e.pop(),e.push(t)}}class Bx{constructor(e){this.paragraphFormatting=e}}class Ax extends Lx{get paragraph(){return this.data.positionStates.last.paragraph}set paragraph(e){this.data.positionStates.last.paragraph=e}get paragraphFormatting(){return this.states.last.paragraphFormatting}set paragraphFormatting(e){this.states.last.paragraphFormatting=e}constructor(e){super(e),this.states=new Rw.K,this.states.push(new Bx(new Sx))}static getOnlyOwnCharacterProperties(e,t){const r=new $i;r.mergeParagraphStyle(t);const i=new $i;return i.mergeOnlyOwnCharacterProperties(e,r.innerProperties),i.innerProperties}createEmptyParagraph(){return new ns(this.subDocument,null,0,null,null)}fixLastParagraph(){this.subDocument.isMain()&&this.data.importers.section.applySectionFormatting(!0)}insertParagraph(e=!1){const t=this.data.importers.character,r=this.paragraph,i=f.ListUtils.last(this.subDocument.paragraphs),n=i?i.getEndPosition():0,o=this.subDocument.positionManager.registerPosition(n),a=t.logPosition-n+1;return this.data.importers.style.paragraph.ensureStyleExist(),r.subDocument=this.subDocument,r.startLogPosition=o,r.length=a,this.applyParagraphFormatting(r,e),t.addRun(new(e?Ll:Bl)(t.logPosition,r,t.getPropsBundle()),e?an.specialCharacters.SectionMark:an.specialCharacters.ParagraphMark),this.subDocument.paragraphs.push(r),this.paragraph=this.createEmptyParagraph(),r}ensureLastParagraph(){const e=f.ListUtils.last(f.ListUtils.last(this.subDocument.chunks).textRuns);e&&e.isParagraphOrSectionRun()||this.insertParagraph()}applyParagraphFormatting(e,t){const r=this.paragraphFormatting;if(this.applyParagraphFormattingCore(e,r),Rx.shouldInsertNumbering(this.documentModel)){const i=r.paragraphListInfo.numberingListIndex;i>=0||i==QP.noNumberingList?t&&e.isEmpty||(r.paragraphListInfo.numberingListIndex=Math.max(i,QP.minValue),this.data.importers.numbering.addNumberingListToParagraph(e,r.paragraphListInfo)):this.data.importers.numbering.currentOldListSkipNumbering||(this.data.importers.numbering.currentOldMultiLevelListIndex=QP.listIndexNotSetted,this.data.importers.numbering.currentOldSimpleListIndex=QP.listIndexNotSetted)}e.tabs=r.tabs}applyParagraphFormattingCore(e,t){e.paragraphStyle=this.data.importers.style.paragraph.style,e.maskedParagraphProperties=Ax.getOnlyOwnCharacterProperties(t.getCoreProperties(),e.paragraphStyle)}pushState(){this.states.push(new Bx(this.paragraphFormatting.clone()))}popState(){this.states.count>1&&this.states.pop()}startImportSubDocument(){}finalizeSubDocument(){const e=this.subDocument.getLastChunk().textRuns;(!e.length||f.ListUtils.last(e).getType()!=cs.ParagraphRun)&&this.insertParagraph(),this.fixLastParagraph()}}class Nx{constructor(){this.coreProperties=new Pe,this.parentStyleIndex=-1,this.fontType=ly.Undefined,this.rtfFormattingInfo=new Ty}setFont(e,t){const r=e.name;this.coreProperties.setValue(ir.fontInfo,t),this.fontType==ly.Undefined?this.resetUseAssociatedProperties():(this.fontType==ly.DoubleByteCharactersFont?this.doubleByteCharactersFontName=r:this.fontType==ly.HighAnsiCharactersFont?this.highAnsiCharactersFontName=r:this.fontType==ly.LowAnsiCharactersFont&&(this.lowAnsiCharactersFontName=r),this.recalcUseAssociatedProperties(),this.fontType=ly.Undefined)}resetUseAssociatedProperties(){this.highAnsiCharactersFontName="",this.lowAnsiCharactersFontName="",this.doubleByteCharactersFontName="",this.useHighAnsiCharactersFontName=!1,this.useLowAnsiCharactersFontName=!1,this.useDoubleByteCharactersFontName=!1}recalcUseAssociatedProperties(){this.useHighAnsiCharactersFontName=!rn.StringUtils.isNullOrEmpty(this.highAnsiCharactersFontName),this.useLowAnsiCharactersFontName=!rn.StringUtils.isNullOrEmpty(this.lowAnsiCharactersFontName),this.useDoubleByteCharactersFontName=!rn.StringUtils.isNullOrEmpty(this.doubleByteCharactersFontName)}clone(){const e=new Nx;return e.copyFrom(this),e}copyFrom(e){this.coreProperties=e.coreProperties.clone(),this.parentStyleIndex=e.parentStyleIndex,this.fontType=e.fontType,this.doubleByteCharactersFontName=e.doubleByteCharactersFontName,this.lowAnsiCharactersFontName=e.lowAnsiCharactersFontName,this.highAnsiCharactersFontName=e.highAnsiCharactersFontName,this.useDoubleByteCharactersFontName=e.useDoubleByteCharactersFontName,this.useLowAnsiCharactersFontName=e.useLowAnsiCharactersFontName,this.useHighAnsiCharactersFontName=e.useHighAnsiCharactersFontName,this.rtfFormattingInfo=e.rtfFormattingInfo.clone()}}class kx{constructor(e){this.characterFormatting=e}}class Ox extends Lx{get characterFormatting(){return this.states.last.characterFormatting}constructor(e){super(e),this.states=new Rw.K;const t=new Nx;t.coreProperties=this.data.documentModel.defaultCharacterProperties,this.states.push(new kx(t)),this.logPosition=0}static getOnlyOwnCharacterProperties(e,t){const r=new Ii;r.mergeCharacterStyle(t);const i=new Ii;return i.innerProperties.fontInfo=e.fontInfo,i.mergeOnlyOwnCharacterProperties(e,r.innerProperties),i.innerProperties}getPropsBundle(){return new pn(Ox.getOnlyOwnCharacterProperties(this.characterFormatting.coreProperties,this.data.importers.style.character.style),this.data.importers.style.character.style)}insertText(e){this.addRun(new ch(this.logPosition,e.length,this.data.importers.paragraph.paragraph,this.getPropsBundle()),e)}setFontNameAndInsertText(e,t){yy.setUnicodeFontNameByCharType(this.data.documentModel.cache.fontInfoCache,t,this.characterFormatting),this.insertText(e)}getLastRunProperties(){const e=f.ListUtils.last(f.ListUtils.last(this.subDocument.chunks).textRuns);return e?e.getCharPropsBundle(this.documentModel):this.getPropsBundle()}addSimpleRun(e,t,r){const i=r?this.getLastRunProperties():this.getPropsBundle(),n=new e(this.logPosition,this.data.importers.paragraph.paragraph,i);return this.addRun(n,t)}addRun(e,t){const r=f.ListUtils.last(this.subDocument.chunks);return r.textRuns.push(e),r.textBuffer+=t,this.logPosition+=e.getLength(),e}insertSpace(){this.data.importers.character.characterFormatting.rtfFormattingInfo.deleted||this.insertText(" ")}splitByCharTypeAndInsertText(e){if(!e)return;const t=this.characterFormatting.coreProperties.fontInfo;let r=e.charAt(0),i=yy.calculateCharType(r);for(let t=1;t<e.length;t++){const n=e.charAt(t),o=yy.calculateCharType(n);i!=o&&(this.setFontNameAndInsertText(r,i),r=""),r+=n,i=o}this.setFontNameAndInsertText(r,i),this.characterFormatting.coreProperties.setValue(ir.fontInfo,t)}appendChar(e){const t=this.characterFormatting.coreProperties.fontInfo;yy.setUnicodeFontName(this.data.documentModel.cache.fontInfoCache,e,this.characterFormatting),this.insertText(e),this.characterFormatting.coreProperties.setValue(ir.fontInfo,t)}onPlainKeyword(){this.applyDefaultCharacterProperties()}applyDefaultCharacterProperties(){const e=this.documentModel.defaultCharacterProperties,t=this.characterFormatting.coreProperties;t.fontInfo=this.data.importers.font.fonts.getRtfFontInfoById(this.data.importers.font.defaultFontNumber).getCoreObjectByName(this.documentModel),this.data.importers.character.characterFormatting.resetUseAssociatedProperties(),t.fontSize=12,t.fontBold=e.fontBold,t.fontItalic=e.fontItalic,t.fontStrikeoutType=e.fontStrikeoutType,t.fontUnderlineType=e.fontUnderlineType,t.allCaps=e.allCaps,t.smallCaps=e.smallCaps,t.hidden=e.hidden,t.underlineWordsOnly=e.underlineWordsOnly,t.strikeoutWordsOnly=e.strikeoutWordsOnly,t.highlightColor=e.highlightColor,t.underlineColor=e.underlineColor,t.strikeoutColor=e.strikeoutColor,t.shadingInfo=fe.auto,t.shadingInfo=e.shadingInfo,t.script=e.script,t.textColor=e.textColor,this.data.setCodePage(this.data.documentProperties.defaultCodePage)}pushState(){this.states.push(new kx(this.characterFormatting.clone()))}popState(){this.states.count>1&&this.states.pop()}startImportSubDocument(){this.logPosition=this.subDocument.getLastChunk().getEndPosition()}finalizeSubDocument(){}}class _x extends xx{get destinationType(){return Jw.CharacterStyleDestination}get controlCharHT(){return null}static onParentStyleIndex(e,t,r){e.importers.style.character.rtfParentStyleIndex=t}static onStyleLinkKeyword(e,t,r){e.importers.paragraph.paragraphFormatting.styleLink=t}static onStyleQFormatKeyword(e,t,r){e.destination.qFormat=!0,e.importers.style.character.rtfParentStyleIndex=t}constructor(e,t){super(e,e.subDocument),e.importers.style.character.rtfStyleIndex=t,this.styleName=""}get canAppendText(){return!1}beforePopRtfState(){const e=Hx.getPrimaryStyleName(this.styleName);if(!this.importer.importers.style.character.mapRtfIndexToModelIndex[this.importer.importers.style.character.rtfStyleIndex]){const t=this.importer.importers.style.character.getOrCreateStyleByName(e);t.primary=this.qFormat;const r=this.importer.importers.paragraph.paragraphFormatting.styleLink;r>=0&&null!=this.importer.importers.style.linkParagraphStyleIndexToCharacterStyleIndex[r]&&(this.importer.importers.style.linkParagraphStyleIndexToCharacterStyleIndex[r]=this.importer.importers.style.character.rtfStyleIndex),e!=zl.defaultParagraphCharacterStyleName&&(t.maskedCharacterProperties=Ox.getOnlyOwnCharacterProperties(this.importer.importers.character.characterFormatting.coreProperties,t.parent))}}createClone(){return new _x(this.importer,this.importer.importers.style.character.rtfStyleIndex)}processCharCore(e){";"!=e&&(this.styleName+=e)}finalizePieceTableCreation(){}}class Ux extends xx{get destinationType(){return Jw.TableStyleDestination}get controlCharHT(){return null}static onStyleQFormatKeyword(e,t,r){Ux.getThis(e).qFormat=!0}static onParentStyleIndex(e,t,r){e.importers.style.table.rtfParentStyleIndex=t}static onConditionalStyleFirstRow(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.FirstRow}static onConditionalStyleLastRow(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.LastRow}static onConditionalStyleFirstColumn(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.FirstColumn}static onConditionalStyleLastColumn(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.LastColumn}static onConditionalStyleOddRowBanding(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.OddRowBanding}static onConditionalStyleEvenRowBanding(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.EvenRowBanding}static onConditionalStyleOddColumnBanding(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.OddColumnBanding}static onConditionalStyleEvenColumnBanding(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.EvenColumnBanding}static onConditionalStyleTopLeftCell(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.TopLeftCell}static onConditionalStyleTopRightCell(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.TopRightCell}static onConditionalStyleBottomLeftCell(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.BottomLeftCell}static onConditionalStyleBottomRightCell(e,t,r){Ux.getThis(e).conditionalTableStyleFormattingType=qe.BottomRightCell}static getThis(e){return e.destination}get canAppendText(){return!1}get rtfStyleIndex(){return this.importer.importers.style.table.rtfStyleIndex}set rtfStyleIndex(e){this.importer.importers.style.table.rtfStyleIndex=e}get rtfParentStyleIndex(){return this.importer.importers.style.table.rtfParentStyleIndex}constructor(e,t){super(e,e.subDocument),this.conditionalTableStyleFormattingType=qe.WholeTable,this.styleName="",this.rtfStyleIndex=t,this.importer.importers.character.characterFormatting.coreProperties.setUseValue(ie.UseAll,!1)}beforePopRtfState(){const e=this.styleName.trim();let t=null;const r=this.conditionalTableStyleFormattingType!=qe.WholeTable;let i;if(r)t=this.addConditionalStyle(),i=t;else{this.importer.importers.character.characterFormatting.coreProperties.setUseValue(ie.UseAll,!0);const r=this.importer.importers.style.table.mapRtfIndexToModelIndex[this.rtfStyleIndex];t=null==r?this.importer.importers.style.table.getOrCreateStyleByName(e):this.documentModel.tableStyles[r],i=t.baseConditionalStyle}if(null==t)return;const n=t,o=t;if(null!=n&&(n.primary=this.qFormat),e!=Vh.DEFAULT_STYLENAME){var a;let e;if(r?null==(a=t.parent)&&(a=this.importer.documentModel.tableStyles[0]):a=this.importer.importers.style.table.parentStyle,r)o.maskedCharacterProperties.copyFrom(this.importer.importers.character.characterFormatting.coreProperties),e=o.maskedParagraphProperties;else{const t=new Ii;t.mergeCharacterProperties(n.baseConditionalStyle.maskedCharacterProperties),t.mergeMergedCharacterProperties(a.baseConditionalStyle.maskedCharacterProperties),n.baseConditionalStyle.maskedCharacterProperties=t.innerProperties;const r=new $i;r.mergeMaskedParagraphProperties(n.baseConditionalStyle.maskedParagraphProperties),r.mergeMaskedParagraphProperties(a.baseConditionalStyle.maskedParagraphProperties),e=r.innerProperties}const s=this.importer.importers.paragraph.paragraphFormatting,l=new $i;l.mergeMaskedParagraphProperties(s.getCoreProperties()),l.mergeMaskedParagraphProperties(e),i.maskedParagraphProperties=l.innerProperties,i.tableProperties=this.importer.importers.table.tableReader.tableProperties.coreProperties,i.tableProperties=new nw(this.importer.documentModel).getStyleMergedProperties(i,n,this.conditionalTableStyleFormattingType),i.tableRowProperties=this.importer.importers.table.tableReader.rowProperties.coreProperties,i.tableRowProperties=new ow(this.importer.documentModel).getStyleMergedProperties(i,n,this.conditionalTableStyleFormattingType),i.tableCellProperties=this.importer.importers.table.tableReader.cellProperties.coreProperties,i.tableCellProperties=new iw(this.importer.documentModel).getStyleMergedProperties(i,n,this.conditionalTableStyleFormattingType)}}addConditionalStyle(){if(null==this.importer.importers.style.table.mapRtfIndexToModelIndex[this.rtfStyleIndex])return null;return this.importer.documentModel.tableStyles[this.importer.importers.style.table.getModelIndex(this.rtfStyleIndex)].conditionalStyles[this.conditionalTableStyleFormattingType]}createClone(){return new Ux(this.importer,this.rtfStyleIndex)}processCharCore(e){";"!=e&&(this.styleName+=e)}finalizePieceTableCreation(){}}class Hx extends xx{get destinationType(){return Jw.StyleSheetDestination}get controlCharHT(){return null}get canAppendText(){return!1}constructor(e){super(e,e.subDocument),this.styleName="",e.rtfDocumentModelType=sM.WithStyle}static onStyleQFormatKeyword(e,t,r){e.destination.qFormat=!0}static onParagraphStyle(e,t,r){e.importers.style.paragraph.rtfStyleIndex=t}static onParentStyleIndex(e,t,r){e.importers.style.paragraph.rtfParentStyleIndex=t}static onStyleLinkKeyword(e,t,r){e.importers.paragraph.paragraphFormatting.styleLink=t}static onNextStyleIndex(e,t,r){e.importers.paragraph.paragraphFormatting.nextStyle=t}static onCharacterStyle(e,t,r){e.destination=new _x(e,t)}static onTableStyle(e,t,r){e.destination=new Ux(e,t)}static onStyleListOverride(e,t,r){e.importers.paragraph.paragraphFormatting.paragraphListInfo.numberingListIndex=t}static onStyleListLevel(e,t,r){e.importers.paragraph.paragraphFormatting.paragraphListInfo.listLevelIndex=t}nestedGroupFinished(e){if(e instanceof Hx){const t=this.importer.importers.paragraph.paragraphFormatting;this.importer.importers.style.paragraph.ensureStyleExist();const r=this.importer.importers.style.paragraph.getOrCreateStyleByName(Hx.getPrimaryStyleName(e.styleName));if(t.styleLink&&void 0===this.importer.importers.style.linkParagraphStyleIndexToCharacterStyleIndex[this.importer.importers.style.paragraph.rtfStyleIndex]&&(this.importer.importers.style.linkParagraphStyleIndexToCharacterStyleIndex[this.importer.importers.style.paragraph.rtfStyleIndex]=t.styleLink),t.nextStyle&&t.nextStyle>=0&&(this.importer.importers.style.nextParagraphStyleIndexTable[this.importer.importers.style.paragraph.rtfStyleIndex]=t.nextStyle),r.styleName!=es.normalStyleName){const e=new Ii;e.mergeParagraphStyle(r.parent);const t=new Ii;t.mergeOnlyOwnCharacterProperties(this.importer.importers.character.characterFormatting.coreProperties,e.innerProperties),r.maskedCharacterProperties=t.innerProperties,r.maskedParagraphProperties=Ax.getOnlyOwnCharacterProperties(this.importer.importers.paragraph.paragraphFormatting.getCoreProperties(),r.parent)}if(t.paragraphListInfo.numberingListIndex>=0){const e=this.importer.importers.style.paragraph.rtfStyleIndex;void 0===this.importer.importers.numbering.paragraphStyleListOverrideIndexMap[e]&&(this.importer.importers.numbering.paragraphStyleListOverrideIndexMap[e]=t.paragraphListInfo)}r.primary=e.qFormat,this.qFormat=!1}}static getPrimaryStyleName(e){for(let t of e.split(","))if(!rn.StringUtils.isNullOrEmpty(t))return rn.StringUtils.trim(t);return""}createClone(){const e=new Hx(this.importer);return e.styleName=this.styleName,e}processCharCore(e){";"!=e&&(this.styleName+=e)}finalizeSubDocumentCreation(){}processSpecialHexCharCore(e){}}class Vx extends xx{get destinationType(){return Jw.DefaultDestination}static onDeffKeyword(e,t,r){e.importers.font.defaultFontNumber=t}static onInfoKeyword(e,t,r){e.destination=new ky(e)}static onUserPropKeyword(e,t,r){e.destination=new Ry(e)}static onDefaultCharacterPropertiesKeyword(e,t,r){e.destination=new Dx(e)}static onDefaultParagraphPropertiesKeyword(e,t,r){e.destination=new Fx(e)}static onPageBackground(e,t,r){e.destination=new Ex(e)}static onThemeData(e,t,r){e.destination=new Ey(e)}static onColorsSchemeMapping(e,t,r){e.destination=new Ey(e)}static onNoFeatureThrottle(e,t,r){e.importerOptions.enableNotCompatibleUIFunctionality=1==t}static onNoUICompat(e,t,r){e.documentModel.compatibilitySettings.compatibilityMode=yg.Word2007,e.importerOptions.enableNotCompatibleUIFunctionality=!0}static onDefaultTabKeyword(e,t,r){(!r||t<=0)&&(t=720),e.documentModel.defaultTabWidth=t}static onMirrorMargins(e,t,r){r||(t=1),e.documentModel.mirrorMargins=0!=t}static onRemovePersonalInformation(e,t,r){}static onEnforceDocumentProtection(e,t,r){}static onFormProtection(e,t,r){const i=e.documentModel.documentProtectionProperties;i.enforceProtection=!0,i.protectionType=Mo.ReadOnly}static onRevisionProtection(e,t,r){const i=e.documentModel.documentProtectionProperties;i.enforceProtection=!0,i.protectionType=Mo.TrackedChanges}static onAnnotationProtection(e,t,r){const i=e.documentModel.documentProtectionProperties;i.enforceProtection=!0,i.protectionType=Mo.AllowComments}static onReadOnlyProtection(e,t,r){const i=e.documentModel.documentProtectionProperties;i.enforceProtection&&(i.protectionType=Mo.ReadOnly)}static onDocumentProtectionLevel(e,t,r){const i=e.documentModel.documentProtectionProperties;if(r&&i.protectionType==Mo.None)switch(t){case 0:i.protectionType=Mo.TrackedChanges;break;case 1:i.protectionType=Mo.AllowComments;break;case 2:case 3:i.protectionType=Mo.ReadOnly;break;case 7:i.protectionType=Mo.None}}static onPageBreakKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.PageBreak)}static onColumnBreakKeyword(e,t,r){e.parseCharWithoutDecoding(an.specialCharacters.ColumnBreak)}static onPaperWidthKeyword(e,t,r){r||(t=12240);const i=t;e.importers.section.defaultSectionProperties.coreProperties.pageWidth=i,e.importers.section.currentProperties.coreProperties.pageWidth=i}static onPaperHeightKeyword(e,t,r){r||(t=15840);const i=t;e.importers.section.defaultSectionProperties.coreProperties.pageHeight=i,e.importers.section.currentProperties.coreProperties.pageHeight=i}static onPaperSizeKeyword(e,t,r){}static onLandscapeKeyword(e,t,r){e.importers.section.defaultSectionProperties.coreProperties.landscape=!0,e.importers.section.currentProperties.coreProperties.landscape=!0}static onGutterKeyword(e,t,r){}static onLeftMarginKeyword(e,t,r){r||(t=1800);const i=t;e.importers.section.defaultSectionProperties.coreProperties.marginLeft=i,e.importers.section.currentProperties.coreProperties.marginLeft=i}static onRightMarginKeyword(e,t,r){r||(t=1800);const i=t;e.importers.section.defaultSectionProperties.coreProperties.marginRight=i,e.importers.section.currentProperties.coreProperties.marginRight=i}static onTopMarginKeyword(e,t,r){r||(t=1440);const i=t;e.importers.section.defaultSectionProperties.coreProperties.marginTop=i,e.importers.section.currentProperties.coreProperties.marginTop=i}static onBottomMarginKeyword(e,t,r){r||(t=1440);const i=t;e.importers.section.defaultSectionProperties.coreProperties.marginBottom=i,e.importers.section.currentProperties.coreProperties.marginBottom=i}static onGutterAtRight(e,t,r){}static onPageNumberingStart(e,t,r){}static onPageFacing(e,t,r){e.documentModel.differentOddAndEvenPages=!0}static onNoColumnBalance(e,t,r){}static onDoNotAlignTableRowsIndependently(e,t,r){}static onDoNotExpandShiftReturn(e,t,r){}static onSplitPageBreakAndParagraphMark(e,t,r){}static onAllowTablesToExtendIntoMargin(e,t,r){}static onDisplayBackgroundShape(e,t,r){e.documentModel.displayBackgroundShape=1==t}static onPageNumberingDecimal(e,t,r){}static onPageNumberingUpperRoman(e,t,r){}static onPageNumberingLowerRoman(e,t,r){}static onPageNumberingUpperLetter(e,t,r){}static onPageNumberingLowerLetter(e,t,r){}static onPageNumberingArabicAbjad(e,t,r){}static onPageNumberingArabicAlpha(e,t,r){}static onPageNumberingChosung(e,t,r){}static onPageNumberingDecimalEnclosedCircle(e,t,r){}static onPageNumberingDecimalFullWidth(e,t,r){}static onPageNumberingGanada(e,t,r){}static onPageNumberingHindiVowels(e,t,r){}static onPageNumberingHindiConsonants(e,t,r){}static onPageNumberingHindiNumbers(e,t,r){}static onPageNumberingHindiDescriptive(e,t,r){}static onPageNumberingThaiLetters(e,t,r){}static onPageNumberingThaiNumbers(e,t,r){}static onPageNumberingThaiDescriptive(e,t,r){}static onPageNumberingVietnameseDescriptive(e,t,r){}static onPageNumberingChapterHeaderStyle(e,t,r){}static onPageNumberingChapterSeparatorHyphen(e,t,r){}static onPageNumberingChapterSeparatorPeriod(e,t,r){}static onPageNumberingChapterSeparatorColon(e,t,r){}static onPageNumberingChapterSeparatorEmDash(e,t,r){}static onPageNumberingChapterSeparatorEnDash(e,t,r){}static onVerticalTextAlignmentBottom(e,t,r){}static onVerticalTextAlignmentTop(e,t,r){}static onVerticalTextAlignmentCenter(e,t,r){}static onVerticalTextAlignmentJustify(e,t,r){}static onSectionPageNumberingStart(e,t,r){r||(t=1),e.importers.section.currentProperties.pageNumbering.firstPageNumber=t,e.importers.section.currentProperties.pageNumbering.continueNumbering=!1}static onSectionPageNumberingContinuous(e,t,r){e.importers.section.currentProperties.restartPageNumbering=!1}static onSectionPageNumberingRestart(e,t,r){e.importers.section.currentProperties.restartPageNumbering=!0}static onSectionTextFlow(e,t,r){}static onLineNumberingStep(e,t,r){}static onLineNumberingDistance(e,t,r){}static onLineNumberingStartingLineNumber(e,t,r){}static onLineNumberingRestart(e,t,r){}static onLineNumberingRestartOnEachPage(e,t,r){}static onLineNumberingContinuous(e,t,r){}static onSectionPaperWidth(e,t,r){e.importers.section.currentProperties.coreProperties.pageWidth=t}static onSectionPaperHeight(e,t,r){e.importers.section.currentProperties.coreProperties.pageHeight=t}static onSectionLandscape(e,t,r){e.importers.section.currentProperties.coreProperties.landscape=!0}static onSectionLeftMargin(e,t,r){e.importers.section.currentProperties.coreProperties.marginLeft=t}static onSectionRightMargin(e,t,r){e.importers.section.currentProperties.coreProperties.marginRight=t}static onSectionTopMargin(e,t,r){e.importers.section.currentProperties.coreProperties.marginTop=t}static onSectionBottomMargin(e,t,r){e.importers.section.currentProperties.coreProperties.marginBottom=t}static onSectionGutter(e,t,r){}static onSectionHeaderOffset(e,t,r){r||(t=720),e.importers.section.currentProperties.coreProperties.headerOffset=t}static onSectionFooterOffset(e,t,r){r||(t=720),e.importers.section.currentProperties.coreProperties.footerOffset=t}static onSectionFirstPagePaperSource(e,t,r){}static onSectionOtherPagePaperSource(e,t,r){}static onOnlyAllowEditingOfFormFields(e,t,r){}static onSectionColumnCount(e,t,r){(!r||t<1)&&(t=1),e.importers.section.currentProperties.coreProperties.columnCount=t,e.importers.section.currentProperties.coreProperties.equalWidthColumns=!0}static onSectionColumnSpace(e,t,r){r||(t=720),e.importers.section.currentProperties.coreProperties.space=t,e.importers.section.currentProperties.coreProperties.equalWidthColumns=!0}static onSectionCurrentColumnIndex(e,t,r){e.importers.section.currentProperties.currentColumnIndex=t-1,e.importers.section.currentProperties.coreProperties.equalWidthColumns=!1}static onSectionCurrentColumnSpace(e,t,r){e.importers.section.currentProperties.setCurrentColumnSpace(t),e.importers.section.currentProperties.coreProperties.equalWidthColumns=!1}static onSectionCurrentColumnWidth(e,t,r){e.importers.section.currentProperties.setCurrentColumnWidth(t),e.importers.section.currentProperties.coreProperties.equalWidthColumns=!1}static onSectionDrawVerticalSeparator(e,t,r){}static onSectionBreakNone(e,t,r){e.importers.section.currentProperties.coreProperties.startType=Vs.Continuous}static onSectionBreakColumn(e,t,r){e.importers.section.currentProperties.coreProperties.startType=Vs.Column}static onSectionBreakPage(e,t,r){e.importers.section.currentProperties.coreProperties.startType=Vs.NextPage}static onSectionBreakEvenPage(e,t,r){e.importers.section.currentProperties.coreProperties.startType=Vs.EvenPage}static onSectionBreakOddPage(e,t,r){e.importers.section.currentProperties.coreProperties.startType=Vs.OddPage}static onSectionDefault(e,t,r){e.importers.section.currentProperties.copyFrom(e.importers.section.defaultSectionProperties)}static onNewSection(e,t,r){e.importers.section.insertSection(),e.importers.table.tableReader.resetState()}static onHeaderKeyword(e,t,r){e.importers.section.insertHeaderFooter(!0,Ws.Odd)}static onHeaderForLeftPagesKeyword(e,t,r){e.importers.section.insertHeaderFooter(!0,Ws.Even)}static onHeaderForRightPagesKeyword(e,t,r){e.importers.section.insertHeaderFooter(!0,Ws.Odd)}static onHeaderForFirstPageKeyword(e,t,r){e.importers.section.insertHeaderFooter(!0,Ws.First)}static onFooterKeyword(e,t,r){e.importers.section.insertHeaderFooter(!1,Ws.Odd)}static onFooterForLeftPagesKeyword(e,t,r){e.importers.section.insertHeaderFooter(!1,Ws.Even)}static onFooterForRightPagesKeyword(e,t,r){e.importers.section.insertHeaderFooter(!1,Ws.Odd)}static onFooterForFirstPageKeyword(e,t,r){e.importers.section.insertHeaderFooter(!1,Ws.First)}static onSectionDifferentFirstPage(e,t,r){e.importers.section.currentProperties.coreProperties.differentFirstPage=!0}static onListTableKeyword(e,t,r){e.destination=new Yy(e),e.importers.character.characterFormatting.coreProperties.resetAllUse()}static onListOverrideTableKeyword(e,t,r){e.destination=new qy(e),e.importers.character.characterFormatting.coreProperties.resetAllUse()}static onLtrSectionKeyword(e,t,r){}static onRtlSectionKeyword(e,t,r){}static onSectionFootNotePlacementBelowText(e,t,r){}static onSectionFootNotePlacementPageBottom(e,t,r){}static onSectionFootNoteNumberingStart(e,t,r){}static onSectionFootNoteNumberingRestartEachPage(e,t,r){}static onSectionFootNoteNumberingRestartEachSection(e,t,r){}static onSectionFootNoteNumberingRestartContinuous(e,t,r){}static onSectionFootNoteNumberingDecimal(e,t,r){}static onSectionFootNoteNumberingLowerCaseLetter(e,t,r){}static onSectionFootNoteNumberingUpperCaseLetter(e,t,r){}static onSectionFootNoteNumberingLowerCaseRoman(e,t,r){}static onSectionFootNoteNumberingUpperCaseRoman(e,t,r){}static onSectionFootNoteNumberingChicago(e,t,r){}static onSectionFootNoteNumberingChosung(e,t,r){}static onSectionFootNoteNumberingDecimalEnclosedCircle(e,t,r){}static onSectionFootNoteNumberingDecimalFullWidth(e,t,r){}static onSectionFootNoteNumberingGanada(e,t,r){}static onSectionEndNoteNumberingStart(e,t,r){}static onSectionEndNoteNumberingRestartEachSection(e,t,r){}static onSectionEndNoteNumberingRestartContinuous(e,t,r){}static onSectionEndNoteNumberingDecimal(e,t,r){}static onSectionEndNoteNumberingLowerCaseLetter(e,t,r){}static onSectionEndNoteNumberingUpperCaseLetter(e,t,r){}static onSectionEndNoteNumberingLowerCaseRoman(e,t,r){}static onSectionEndNoteNumberingUpperCaseRoman(e,t,r){}static onSectionEndNoteNumberingChicago(e,t,r){}static onSectionEndNoteNumberingChosung(e,t,r){}static onSectionEndNoteNumberingDecimalEnclosedCircle(e,t,r){}static onSectionEndNoteNumberingDecimalFullWidth(e,t,r){}static onSectionEndNoteNumberingGanada(e,t,r){}static onSectionLineNumberingCountBy(e,t,r){r&&(e.importers.section.currentProperties.lineNumbering.countBy=Math.max(0,t))}static onSectionLineNumberingDistance(e,t,r){r&&t>=0&&(e.importers.section.currentProperties.lineNumbering.distance=Math.max(0,t))}static onSectionLineNumberingStart(e,t,r){r&&(e.importers.section.currentProperties.lineNumbering.start=Math.max(1,t))}static onSectionLineNumberingNewSection(e,t,r){e.importers.section.currentProperties.lineNumbering.restart=zs.NewSection}static onSectionLineNumberingNewPage(e,t,r){e.importers.section.currentProperties.lineNumbering.restart=zs.NewPage}static onSectionLineNumberingContinuous(e,t,r){e.importers.section.currentProperties.lineNumbering.restart=zs.Continuous}static onFootNotePlacementEndOfSection(e,t,r){}static onFootNotePlacementEndOfDocument(e,t,r){}static onFootNotePlacementBelowText(e,t,r){}static onFootNotePlacementPageBottom(e,t,r){}static onFootNoteNumberingStart(e,t,r){}static onFootNoteNumberingRestartEachPage(e,t,r){}static onFootNoteNumberingRestartEachSection(e,t,r){}static onFootNoteNumberingRestartContinuous(e,t,r){}static onFootNoteNumberingDecimal(e,t,r){}static onFootNoteNumberingLowerCaseLetter(e,t,r){}static onFootNoteNumberingUpperCaseLetter(e,t,r){}static onFootNoteNumberingLowerCaseRoman(e,t,r){}static onFootNoteNumberingUpperCaseRoman(e,t,r){}static onFootNoteNumberingChicago(e,t,r){}static onFootNoteNumberingChosung(e,t,r){}static onFootNoteNumberingDecimalEnclosedCircle(e,t,r){}static onFootNoteNumberingDecimalFullWidth(e,t,r){}static onFootNoteNumberingGanada(e,t,r){}static onEndNotePlacementEndOfSection(e,t,r){}static onEndNotePlacementEndOfDocument(e,t,r){}static onEndNotePlacementBelowText(e,t,r){}static onEndNotePlacementPageBottom(e,t,r){}static onEndNoteNumberingStart(e,t,r){}static onEndNoteNumberingRestartEachSection(e,t,r){}static onEndNoteNumberingRestartContinuous(e,t,r){}static onEndNoteNumberingDecimal(e,t,r){}static onEndNoteNumberingLowerCaseLetter(e,t,r){}static onEndNoteNumberingUpperCaseLetter(e,t,r){}static onEndNoteNumberingLowerCaseRoman(e,t,r){}static onEndNoteNumberingUpperCaseRoman(e,t,r){}static onEndNoteNumberingChicago(e,t,r){}static onEndNoteNumberingChosung(e,t,r){}static onEndNoteNumberingDecimalEnclosedCircle(e,t,r){}static onEndNoteNumberingDecimalFullWidth(e,t,r){}static onEndNoteNumberingGanada(e,t,r){}static onFootNoteKeyword(e,t,r){e.destination=new Ey(e)}static onCommentStartPositionKeyword(e,t,r){e.destination=new Ey(e)}static onCommentEndPositionKeyword(e,t,r){e.destination=new Ey(e)}static onCommentIdKeyword(e,t,r){e.destination=new Ey(e)}static onCommentAuthorKeyword(e,t,r){e.destination=new Ey(e)}static onCommentAnnotationKeyword(e,t,r){e.destination=new Ey(e)}beforeNestedGroupFinishedCore(e){}nestedGroupFinished(e){if(super.nestedGroupFinished(e),e instanceof Yy&&(this.importer.documentProperties.listTableComplete=!0),e instanceof qy&&(this.importer.documentProperties.listOverrideTableComplete=!0),this.importer.documentProperties.listOverrideTableComplete&&this.importer.documentProperties.listTableComplete){new Fy(this.importer).convert(this.importer.documentProperties.listTable,this.importer.documentProperties.listOverrideTable),this.importer.documentProperties.listTableComplete=!1,this.importer.documentProperties.listOverrideTableComplete=!1}e instanceof Hx&&this.importer.importers.style.applyStyleLinks()}afterNestedGroupFinished(e){}createClone(){return new Vx(this.importer,this.subDocument)}}class Wx extends Vx{get destinationType(){return Jw.FieldSubDestination}constructor(e){super(e,e.subDocument),this.nestedGroupLevel=1}createClone(){const e=this.createInstance();return e.nestedGroupLevel=this.nestedGroupLevel,e}beforePopRtfState(){super.beforePopRtfState(),this.nestedGroupLevel--,0==this.nestedGroupLevel&&this.onDestinationClose()}increaseGroupLevel(){super.increaseGroupLevel(),this.nestedGroupLevel++}onDestinationClose(){}}class zx extends Wx{get destinationType(){return Jw.CodeFieldDestination}get currentInfo(){return this.importer.importers.field.currentField}createInstance(){return new zx(this.importer)}processTextCore(e){this.currentInfo.instruction+=e,this.importer.importers.field.ensureStartMarkAdded(),super.processTextCore(e)}processCharCore(e){this.currentInfo.instruction+=e,this.importer.importers.field.ensureStartMarkAdded(),super.processCharCore(e)}onDestinationClose(){const e=this.getCurrentFieldType();this.currentInfo.isShapeField="shape"==e;const t=this.importer.importers.field;t.ensureStartMarkAdded(),t.ensureSeparatorMarkAdded()}getCurrentFieldType(){let e=this.currentInfo.instruction.split(/\s+/).filter((e=>""!==e))[0];return e?e.toLowerCase():e}}class jx extends Wx{get destinationType(){return Jw.ResultFieldDestination}constructor(e){super(e)}createInstance(){return new jx(this.importer)}}class Xx extends Wx{get destinationType(){return Jw.FieldDestination}get controlCharHT(){return null}static onFieldInstructionStartKeyword(e,t,r){e.destination.nestedGroupLevel<=1&&e.throwInvalidRtfFile(),e.destination=new zx(e)}static onFieldResultStartKeyword(e,t,r){e.destination.nestedGroupLevel<=1&&e.throwInvalidRtfFile(),e.destination=Xx.createFieldResultDestination(e)}static createFieldResultDestination(e){return new jx(e)}static onFieldLockKeyword(e,t,r){e.importers.field.fields.last.locked=!0}static onFieldCodeViewKeyword(e,t,r){e.importers.field.updateFieldsOnPaste||(e.importers.field.fields.last.isCodeView=!0)}static onFieldEditKeyword(e,t,r){}static onFieldDirtyKeyword(e,t,r){}static onFieldPrivateKeyword(e,t,r){}startNewField(){}onDestinationClose(){this.importer.importers.field.endField()}createInstance(){return new Xx(this.importer)}}!function(e){e[e.None=0]="None",e[e.QuotesOpened=2]="QuotesOpened",e[e.QuotesClosed=4]="QuotesClosed"}(my||(my={}));class Gx extends Wx{get destinationType(){return Jw.TableContentFieldDestination}constructor(e,t){super(e),t&&this.insertTextCore(Gx.tcFieldName)}tableOfContentsEntryLevelNumberKeyword(e,t){this.closeQuotes(),super.tableOfContentsEntryLevelNumberKeyword(e,t),this.insertSpace()}tableOfContentsEntryTypeTableKeyword(e,t){this.closeQuotes(),super.tableOfContentsEntryTypeTableKeyword(e,t),this.insertSpace()}processTextCore(e){this.openQuotes(),super.processTextCore(e)}createInstance(){return this.importer.createTableContentFieldDestination(!1)}onDestinationClose(){this.openQuotes(),this.closeQuotes();this.importer.importers.field.fields.pop().insertInstructionBeforeFieldCode=!this.importer.importers.character.characterFormatting.coreProperties.hidden,this.importer.importers.field.TCFieldState=my.None}openQuotes(){this.importer.importers.field.TCFieldState==my.None&&(this.importer.importers.field.TCFieldState=my.QuotesOpened,this.insertTextCore(Gx.quote))}closeQuotes(){this.importer.importers.field.TCFieldState==my.QuotesOpened&&(this.insertTextCore(Gx.quote),this.importer.importers.field.TCFieldState=my.QuotesClosed)}insertSpace(){this.importer.importers.field.TCFieldState==my.None&&this.insertTextCore(Gx.space)}}Gx.tcFieldName="tc ",Gx.quote='"',Gx.space=" ";class Kx extends vx{get destinationType(){return Jw.ShapeDestinationBase}get controlCharHT(){return null}constructor(e,t){super(e,t)}static getThis(e){return e.destination}static onShapeInstanceKeyword(e,t,r){e.destination=new Mx(e,Kx.getThis(e).shapeProperties)}processControlCharCore(e){}processCharCore(e){}}class qx extends Kx{get destinationType(){return Jw.ShapeDestination}constructor(e,t=new Zy){super(e,t)}createClone(){return new qx(this.importer,this.shapeProperties)}beforePopRtfState(){super.beforePopRtfState();const e=this.shapeProperties.getPropertyOrNull(kP.PictureBinaryData);e&&e.base64?this.importer.importers.image.insertImageShape(e,this.shapeProperties,!1):this.importer.importers.shape.insertShape(this.importer,this.shapeProperties)}}class $x{constructor(){this.start=-1,this.end=-1}validate(e){if(this.start<0||this.end<0)return!1;if(this.start>this.end){const e=this.start;this.start=this.end,this.end=e}const t=e.getDocumentEndPosition()+1;return this.start>t&&(this.start=t),this.end>t&&(this.end=t),!0}}class Jx extends $x{validate(e){return!(!this.skipNameValidation&&!this.validateBookmarkName(e))&&super.validate(e)}validateBookmarkName(e){return!rn.StringUtils.isNullOrEmpty(this.name)&&!f.ListUtils.elementBy(e.bookmarks,(e=>e.name==this.name))}}class Yx extends Lx{get bookmarks(){return this.data.positionStates.last.bookmarks}constructor(e){super(e)}getBookmarkByName(e){let t=this.bookmarks[e];return t||(t=new Jx,t.name=e,this.bookmarks[e]=t),t}insertBookmarks(){B.StringMapUtils.forEach(this.bookmarks,((e,t)=>{e.validate(this.subDocument)&&this.subDocument.bookmarks.push(new Cd(this.subDocument.positionManager,new Cn.e(e.start,e.end),t))}))}pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){this.insertBookmarks()}}class Qx extends Lx{constructor(e){super(e)}insertComments(){}pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){this.insertComments()}}class Zx{constructor(){this.startPos=-1,this.separatorPos=-1,this.endPos=-1,this.locked=!1,this.isHyperlink=!1,this.isShapeField=!1,this.isCodeView=!1,this.insertInstructionBeforeFieldCode=!1,this.instruction=""}}class eT extends Lx{get fields(){return this.data.positionStates.last.fields}get currentField(){return this.fields.last}constructor(e){super(e),this.updateFieldsOnPaste=!0}startField(){this.fields.push(new Zx)}ensureStartMarkAdded(){-1==this.currentField.startPos&&(this.currentField.startPos=this.data.importers.character.logPosition,this.currentField.startRun=this.addMarkRun(Al,an.specialCharacters.FieldCodeStartRun))}ensureSeparatorMarkAdded(){-1==this.currentField.separatorPos&&(this.currentField.separatorPos=this.data.importers.character.logPosition,this.currentField.separatorRun=this.addMarkRun(Nl,an.specialCharacters.SeparatorMark))}ensureEndMarkAdded(){-1==this.currentField.endPos&&(this.currentField.endRun=this.addMarkRun(kl,an.specialCharacters.FieldResultEndRun),this.currentField.endPos=this.data.importers.character.logPosition)}addMarkRun(e,t){const r=this.data.importers.character,i=this.currentField.startRun;if(!i)return r.addSimpleRun(e,t,!1);const n=new e(r.logPosition,this.data.importers.paragraph.paragraph,i.getCharPropsBundle(this.documentModel));return r.addRun(n,t)}endField(){const e=this.fields.last;e.isShapeField,this.ensureStartMarkAdded(),this.ensureSeparatorMarkAdded(),this.ensureEndMarkAdded(),this.createFieldWithResult(e),this.fields.pop()}getFormattingSourceRun(e){return null}setFieldRunFormatting(e,t){}calculateFieldIndex(e,t){for(let r=e.length-1;r>=0;r--)if(e[r].getFieldStartPosition()<t)return r+1;return 0}createFieldWithResult(e){const t=this.data.subDocument,r=this.calculateFieldIndex(t.fields,e.startPos),i=new Md(t.positionManager,r,e.startPos,e.separatorPos,e.endPos,e.isCodeView,null);Md.addField(t.fields,i)}processShapeFieldContentCore(e,t,r){null!=e&&null!=t&&e.Inline}processMixedShapeFieldContent(){this.subDocument.chunks[0].textRuns.length}processShapeFieldContent(){this.subDocument.chunks[0].textRuns.length}pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){}}class tT{static codePageFromCharset(e){const t=tT.charsetToCodepageMapping[e];return t||Fw.default}}tT.charsetToCodepageMapping=(new Eu).add(0,Fw.Ansi).add(134,Fw.GB2315).add(129,Fw.Hangul).add(136,Fw.Big5).add(161,Fw.Greek).add(162,Fw.Turkis).add(163,Fw.Vietnamese).add(177,Fw.Hebrew).add(178,Fw.Arabic).add(186,Fw.Baltic).add(204,Fw.Russian).add(238,Fw.default).add(77,Fw.MacRoman).add(89,Fw.MacRussian).get();class rT{constructor(){this.defaultRtfFontInfo=wy.createDefaultRtfFontInfo(),this.collection=[]}getRtfFontInfoById(e){const t=f.ListUtils.elementBy(this.collection,(t=>t.id==e));return t||this.defaultRtfFontInfo}}class iT extends Lx{constructor(e){super(e),this.defaultFontNumber=0,this.fonts=new rT}addRtfFontInfo(e){e.name=_y.removeSpecialSymbols(e.name),0==e.name.length&&(e.name=this.data.documentModel.defaultCharacterProperties.fontInfo.name),this.fonts.collection.push(e)}setFont(e){this.data.importers.character.characterFormatting.setFont(e,e.getCoreObjectByName(this.documentModel));const t=this.codePageFromCharset(e.charset);this.data.setCodePage(t)}codePageFromCharset(e){return e>=0?tT.codePageFromCharset(e):this.data.documentProperties.defaultCodePage}pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){}}class nT{constructor(e){this.shapePropertiesInfo=e}applyTransform2DAndGetActualSize(e,t){const r=this.getPosition(this.leftKeyword,0),i=this.getPosition(this.topKeyword,0),n=this.getPosition(this.rightKeyword,0),o=this.getPosition(this.bottomKeyword,0),a=new so.Size(Math.max(0,n-r),Math.max(0,o-i));return e.offset.x=r,e.offset.y=i,this.shapePropertiesInfo.trySetProperty(kP.Rotation,(e=>t.rotation=g.u.fdToTwips(e))),this.checkRotationAndSwapBox(e,a,t.rotation),a}getPositionCore(e){throw new Error("not implemented")}getPosition(e,t){const r=this.shapePropertiesInfo.getPropertyOrNull(e);return r?this.getPositionCore(r):t}checkRotationAndSwapBox(e,t,r){if(!this.needToSwap(r))return;const i=t.width,n=t.height,o=(g.u.twipsToEmu(n)-g.u.twipsToEmu(i))/2,a=g.u.emuToTwips(o);e.offset.x+=a,e.offset.y-=a,t.width=n,t.height=i}needToSwap(e){let t=e%(180*_.OnePositiveFixedAngle);return t<0&&(t+=180*_.OnePositiveFixedAngle),t>=45*_.OnePositiveFixedAngle&&t<135*_.OnePositiveFixedAngle}}class oT extends nT{constructor(e){super(e)}get bottomKeyword(){return kP.ShapeBottom}get leftKeyword(){return kP.ShapeLeft}get rightKeyword(){return kP.ShapeRight}get topKeyword(){return kP.ShapeTop}get flipHKeyword(){return kP.FlipH}get flipVKeyword(){return kP.FlipV}getPositionCore(e){return e}}class aT{constructor(e){this.shapeProperties=e}applyProperties(e,t){this.processLeftDistance(e),this.processRightDistance(e),this.processLocked(e),this.processHorizontalPositionType(e),this.processVerticalPositionType(e),this.processZOrder(e),this.processDrawingObjectHorizontalPositionAlignment(e),this.processDrawingObjectHorizontalPositionType(e),this.processDrawingObjectVerticalPositionAlignment(e),this.processDrawingObjectVerticalPositionType(e),this.processPercentHorizontalOffset(e),this.processPercentVerticalOffset(e),this.processLayoutInTableCell(e),this.processAllowOverlap(e),this.processDisplayBehindDocumentText(e),this.processTopDistance(e),this.processBottomDistance(e),t&&(this.processRelativeHorizontalSize(t),this.processRelativeVerticalSize(t))}processLocked(e){this.shapeProperties.trySetProperty(kP.ShapeLocked,(t=>e.locked=t))}processHorizontalPositionType(e){this.shapeProperties.trySetProperty(kP.DXInternalLegacyHorizontalPositionAlignment,(t=>e.horizontalPositionType=t))}processVerticalPositionType(e){this.shapeProperties.trySetProperty(kP.DXInternalLegacyVerticalPositionAlignment,(t=>e.verticalPositionType=t))}processZOrder(e){this.shapeProperties.trySetProperty(kP.Dhgt,(t=>e.zOrder=t))||this.shapeProperties.trySetProperty(kP.ShapeZOrder,(t=>e.zOrder=t))}processDrawingObjectHorizontalPositionAlignment(e){this.shapeProperties.trySetProperty(kP.HorizontalPositionAlignment,(t=>this.importDrawingObjectHorizontalPositionAlignment(e,t)))}processDrawingObjectHorizontalPositionType(e){this.shapeProperties.getPropertyOrNull(kP.ShapeIgnoreLegacyHorizontalPositionType)&&(e.horizontalPositionType=gc.Column),this.shapeProperties.trySetProperty(kP.HorizontalPositionType,(t=>this.importDrawingObjectHorizontalPositionType(e,t)))}processPercentHorizontalOffset(e){this.shapeProperties.trySetProperty(kP.PctHorizPos,(t=>e.percentOffset.x=100*t))}processPercentVerticalOffset(e){this.shapeProperties.trySetProperty(kP.PctVertPos,(t=>e.percentOffset.y=100*t))}processDrawingObjectVerticalPositionAlignment(e){this.shapeProperties.trySetProperty(kP.VerticalPositionAlignment,(t=>this.importDrawingObjectVerticalPositionAlignment(e,t)))}processDrawingObjectVerticalPositionType(e){this.shapeProperties.getPropertyOrNull(kP.ShapeIgnoreLegacyVerticalPositionType)&&(e.verticalPositionType=fc.Paragraph),this.shapeProperties.trySetProperty(kP.VerticalPositionType,(t=>this.importDrawingObjectVerticalPositionType(e,t)))}processLayoutInTableCell(e){this.shapeProperties.trySetProperty(kP.LayoutInCell,(t=>e.layoutTableCell=t))}processAllowOverlap(e){this.shapeProperties.trySetProperty(kP.AllowOverlap,(t=>e.allowOverlap=t))}processDisplayBehindDocumentText(e){this.shapeProperties.trySetProperty(kP.ShapeWrapTextTypeZOrder,(t=>e.isBehindDoc=!!t))||this.shapeProperties.trySetProperty(kP.BehindDocument,(t=>e.isBehindDoc=!!t))}processLeftDistance(e){this.shapeProperties.getPropertyOrNull(kP.PseudoInline)||(e.leftDistance=g.u.emuToTwips(this.shapeProperties.getProperty(kP.WrapDistLeft,vx.distanceFromText)))}processRightDistance(e){this.shapeProperties.getPropertyOrNull(kP.PseudoInline)||(e.rightDistance=g.u.emuToTwips(this.shapeProperties.getProperty(kP.WrapDistRight,vx.distanceFromText)))}processTopDistance(e){this.shapeProperties.trySetProperty(kP.WrapDistTop,(t=>e.topDistance=g.u.emuToTwips(t)))}processBottomDistance(e){this.shapeProperties.trySetProperty(kP.WrapDistBottom,(t=>e.bottomDistance=g.u.emuToTwips(t)))}processRelativeHorizontalSize(e){const t=this.shapeProperties.getPropertyOrNull(kP.RelativeHorizontalSizeWidth);null!=t&&(e.relativeSize.width=100*t,e.relativeWidthType=this.getDrawingObjectRelativeFromHorizontal(),e.setUseAbsoluteWidth(!1))}processRelativeVerticalSize(e){var t=this.shapeProperties.getPropertyOrNull(kP.RelativeVerticalSizeHeight);null!=t&&(e.relativeSize.height=100*t,e.relativeHeightType=this.getDrawingObjectRelativeFromVertical(),e.setUseAbsoluteHeight(!1))}getDrawingObjectRelativeFromHorizontal(){var e=this.shapeProperties.getPropertyOrNull(kP.RelativeHorizontalSizeFrom);return null==e?cc.Page:e}getDrawingObjectRelativeFromVertical(){var e=this.shapeProperties.getPropertyOrNull(kP.RelativeVerticalSizeFrom);return null==e?hc.Page:e}importDrawingObjectHorizontalPositionAlignment(e,t){e.horizontalPositionAlignment=t}importDrawingObjectHorizontalPositionType(e,t){const r=kP.DrawingObjectHorizontalPositionTypeTable,i=b.j.keyBy(r,(e=>e==t));(0,S.isDefined)(i)&&(e.horizontalPositionType=i)}importDrawingObjectVerticalPositionAlignment(e,t){e.verticalPositionAlignment=t}importDrawingObjectVerticalPositionType(e,t){const r=kP.DrawingObjectVerticalPositionTypeTable,i=b.j.keyBy(r,(e=>e==t));(0,S.isDefined)(i)&&(e.verticalPositionType=i)}}class sT{constructor(e){this.shapeProperties=e}applyProperties(e){this.applyTextWrap(e)}applyTextWrap(e){this.shapeProperties.trySetProperty(kP.ShapeWrapTextType,(t=>e.wrapType=t)),this.shapeProperties.trySetProperty(kP.ShapeWrapTextSide,(t=>e.wrapSide=t))}}class lT{constructor(e){this.shapePropertiesInfo=e}applyProperties(e){this.processInsetLeft(e),this.processInsertRight(e),this.processInsertTop(e),this.processInsetBottom(e),this.processFitShapeToText(e),this.processWrapText(e)}processInsetLeft(e){this.shapePropertiesInfo.trySetProperty(kP.TextLeft,(t=>e.leftMargin=g.u.emuToTwips(t)))}processInsertRight(e){this.shapePropertiesInfo.trySetProperty(kP.TextRight,(t=>e.rightMargin=g.u.emuToTwips(t)))}processInsertTop(e){this.shapePropertiesInfo.trySetProperty(kP.TextTop,(t=>e.topMargin=g.u.emuToTwips(t)))}processInsetBottom(e){this.shapePropertiesInfo.trySetProperty(kP.TextBottom,(t=>e.bottomMargin=g.u.emuToTwips(t)))}processFitShapeToText(e){const t=this.shapePropertiesInfo.getPropertyOrNull(kP.FitShapeToText);(0,S.isDefined)(t)?e.resizeShapeToFitText=0!=t:e.resizeShapeToFitText=!1}processWrapText(e){this.shapePropertiesInfo.trySetProperty(kP.WrapText,(t=>e.wrapText=t))}}class dT{constructor(e){this.shapePropertiesInfo=e}applyProperties(e){this.shapePropertiesInfo.getPropertyOrNull(kP.Line)&&(this.processOutlineWidth(e),this.processOutlineFill(e))}processOutlineWidth(e){e.outlineWidth=g.u.emuToTwips(this.shapePropertiesInfo.getProperty(kP.LineWidth,9525))}processOutlineFill(e){const t=this.shapePropertiesInfo.getNullableColorProperty(kP.LineColor);e.outlineColor=t||y.BLACK_COLOR}}class cT{constructor(e){this.shapeProperties=e}setDefaults(e){e.horizontalPositionType=gc.Margin,e.verticalPositionType=fc.Margin,e.wrapType=uc.None,e.horizontalPositionAlignment=mc.None,e.verticalPositionAlignment=bc.None}applyDrawingObjectRunProperties(e,t,r){this.setDefaults(e),this.applyRunProperties(e),this.applyContainerProperties(e,r),this.applyNonVisualDrawingObjectProperties(e,t)}applyAnchoredTextBoxRunProperties(e){this.applyBodyProperties(e.textBoxProperties),this.applyNonVisualDrawingObjectProperties(e.anchorInfo,e.containerProperties),this.applyShapeProperties(e.shape),this.applyDrawingObjectRunProperties(e.anchorInfo,e.containerProperties,e.size)}applyAnchoredPictureRunProperties(e){this.applyNonVisualDrawingObjectProperties(e.anchorInfo,e.info.containerProperties),this.applyShapeProperties(e.shape),this.applyDrawingObjectRunProperties(e.anchorInfo,e.info.nonVisualDrawingProperties,null)}applyInlinePictureRunProperties(e){this.applyNonVisualDrawingObjectPropertiesCore(e.info.containerProperties),this.applyShapeProperties(e.shape),this.applyNonVisualDrawingObjectPropertiesCore(e.info.nonVisualDrawingProperties)}applyRunProperties(e){new sT(this.shapeProperties).applyProperties(e)}applyContainerProperties(e,t){new aT(this.shapeProperties).applyProperties(e,t)}applyNonVisualDrawingObjectProperties(e,t){this.applyNonVisualDrawingObjectPropertiesCore(t),this.shapeProperties.trySetProperty(kP.Hidden,(t=>e.hidden=t))}applyNonVisualDrawingObjectPropertiesCore(e){this.shapeProperties.trySetProperty(kP.Name,(t=>e.name=t)),this.shapeProperties.trySetProperty(kP.Description,(t=>e.description=t))}applyShapeProperties(e){const t=this.shapeProperties.getNullableColorProperty(kP.Filled),r=this.shapeProperties.getNullableColorProperty(kP.FillColor);t&&r&&(e.fillColor=r),new dT(this.shapeProperties).applyProperties(e)}applyBodyProperties(e){new lT(this.shapeProperties).applyProperties(e)}}class hT extends Lx{constructor(e){super(e),this.imageId=1,this.scale=new so.Size(100,100)}isShapeFieldContent(){return this.data.importers.field.currentField&&this.data.importers.field.currentField.isShapeField}isInlineTextBox(){return this.isShapeFieldContent()&&f.ListUtils.last(this.data.subDocument.chunks[0].textRuns)instanceof sh}insertImage(e){if(!e||!e.base64)return void(this.isShapeFieldContent()||this.data.importers.character.insertSpace());if(this.isInlineTextBox())return;const t=this.documentModel.cache.imageCache.createUnloadedInfoByBase64(e.base64),r=new so.Size(this.desireSize.width*this.scale.width/100,this.desireSize.height*this.scale.height/100),i=this.data.importers.character,n=i.logPosition,o=new lh(n,this.data.importers.paragraph.paragraph,i.getPropsBundle(),nh.defaultInfo(t,this.scale));i.addRun(o,an.specialCharacters.ObjectMark),this.data.formatImagesImporter.registerImageRun(new Ew(new pu(this.data.subDocument,n),Mb.initByActualSize(r),o))}insertImageShape(e,t,r=!0){if(null==e)return;const i=this.documentModel.cache.imageCache.createUnloadedInfoByBase64(e.base64);let n=new so.Size(this.desireSize.width*this.scale.width/100,this.desireSize.height*this.scale.height/100);const o=this.data.importers.character,a=o.logPosition;let s;r?(s=new lh(a,this.data.importers.paragraph.paragraph,o.getPropsBundle(),nh.defaultInfo(i,this.scale)),o.addRun(s,an.specialCharacters.ObjectMark),new cT(t).applyInlinePictureRunProperties(s),n=new oT(t).applyTransform2DAndGetActualSize(new Jc,s.size)):(s=new ah(a,this.data.importers.paragraph.paragraph,o.getPropsBundle(),oh.defaultInfo(i,this.scale),-1),o.addRun(s,an.specialCharacters.FloatingObjectMark),new cT(t).applyAnchoredPictureRunProperties(s),n=new oT(t).applyTransform2DAndGetActualSize(s.anchorInfo,s.size)),this.data.formatImagesImporter.registerImageRun(new Ew(new pu(this.data.subDocument,a),Mb.initByActualSize(n),s))}pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){}}class uT{clone(){const e=new uT;return e.copyFrom(this),e}copyFrom(e){this.skipNumbering=e.skipNumbering,this.includeInformationFromPreviousLevel=e.includeInformationFromPreviousLevel,this.characterProperties=e.characterProperties.clone(),this.listLevelProperties=e.listLevelProperties.clone(),this.textBefore=e.textBefore,this.textAfter=e.textAfter,this.indent=e.indent}constructor(){this.characterProperties=new Pe,this.characterProperties.fontInfo=new En,this.characterProperties.fontSize=12,this.characterProperties.setAllUse(),this.listLevelProperties=new sn,this.textBefore="",this.textAfter="",this.indent=0}}class pT{constructor(){this.listLevelInfo=[]}getByIndex(e){return this.listLevelInfo.length<=e&&this.ensureLevelIndex(e),this.listLevelInfo[e]}ensureLevelIndex(e){for(let t=this.listLevelInfo.length;t<=e;t++)this.listLevelInfo.push(new uT)}}class gT extends Lx{constructor(e){super(e),this.listOverrideIndexToNumberingListIndexMap={},this.numberingListToOldListLevelInfoMap={},this.paragraphStyleListOverrideIndexMap={},this.oldListLevelInfoCollection=new pT}ensureNumberingListLevelValid(e){return P.MathUtils.restrictValue(e,0,8)}addNumberingListToParagraph(e,t){e.numberingListIndex=t.numberingListIndex,e.listLevelIndex=this.ensureNumberingListLevelValid(t.listLevelIndex)}linkParagraphStylesWithNumberingLists(){for(let e of this.documentModel.paragraphStyles){const t=this.paragraphStyleListOverrideIndexMap[e.styleName];if(!t)return;const r=this.listOverrideIndexToNumberingListIndexMap[t.numberingListIndex];if(null==r||r<0||r>=this.documentModel.numberingLists.length)return;e.numberingListIndex=r,e.listLevelIndex=this.ensureNumberingListLevelValid(t.listLevelIndex)}}pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){this.subDocument.isMain()&&this.linkParagraphStylesWithNumberingLists()}}class mT{constructor(){this.authors=[]}getAuthor(e){return e<0||e>=this.authors.length?mT.unknownAuthor:this.authors[e]}}mT.unknownAuthor="Unknown";class fT extends Lx{get rangePermissions(){return this.data.positionStates.last.rangePermissions}constructor(e){super(e),this.revisionAuthors=new mT,this.userNames=[]}insertRangePermissions(){B.StringMapUtils.forEach(this.data.importers.rangePermission.rangePermissions,((e,t)=>{e.validate(this.subDocument)&&this.subDocument.rangePermissions.push(new Dd(this.subDocument.positionManager,new Cn.e(e.start,e.end),e.userName,e.group))})),this.data.subDocument.rangePermissions.sort(((e,t)=>e.start!=t.start?e.start-t.start:e.end-t.end))}getUserNameById(e){const t=this.userNames[e-1];return void 0!==t?t:""}pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){this.insertRangePermissions()}}class bT{static fixLastSection(e){if(!f.ListUtils.last(e.sections).interval.length){e.sections.pop();const t=e.mainSubDocument.getLastChunk(),r=t.textRuns,i=f.ListUtils.last(r);if(i.getType()==cs.SectionRun){const n=i.startOffset,o=an.specialCharacters.ParagraphMark;t.textBuffer=[t.textBuffer.substr(0,n),o].join(""),r.pop(),i.paragraph.listLevelIndex=Math.max(0,i.paragraph.listLevelIndex),r.push(new Bl(n,i.paragraph,i.getCharPropsBundle(e)))}}}}class CT extends xx{get destinationType(){return Jw.SectionHeaderFooterDestinationBase}constructor(e,t,r){super(e,r),this.section=t}}class ST extends CT{get destinationType(){return Jw.SectionPageFooterDestination}createClone(){return new ST(this.importer,this.section,this.subDocument)}}class IT extends CT{get destinationType(){return Jw.SectionPageHeaderDestination}createClone(){return new IT(this.importer,this.section,this.subDocument)}}!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Bottom=3]="Bottom"}(fy||(fy={}));class PT{copyFrom(e){this.gutter=e.gutter,this.gutterAlignment=e.gutterAlignment}}class wT{constructor(){this.chapterSeparator="",this.numberingFormat=Zi.None,this.firstPageNumber=-1,this.continueNumbering=!0}copyFrom(e){this.chapterSeparator=e.chapterSeparator,this.chapterHeaderStyle=e.chapterHeaderStyle,this.numberingFormat=e.numberingFormat,this.firstPageNumber=e.firstPageNumber,this.continueNumbering=e.continueNumbering}}class yT{constructor(){this.coreProperties=new yh,this.margins=new PT,this.pageNumbering=new wT,this.generalSectionInfo=new wP,this.lineNumbering=new wh,this.restartPageNumbering=!1,this.drawVerticalSeparator=!1,this.paperKind=Vc.A4,this.currentColumnIndex=0}ensureCurrentColumnExists(){for(;this.coreProperties.columnsInfo.length<=this.currentColumnIndex;)this.coreProperties.columnsInfo.push(new Sh(1,1))}setCurrentColumnSpace(e){this.ensureCurrentColumnExists(),this.coreProperties.columnsInfo[this.currentColumnIndex].space=e}setCurrentColumnWidth(e){this.ensureCurrentColumnExists(),this.coreProperties.columnsInfo[this.currentColumnIndex].width=e}validatePaperKind(){}clone(){const e=new yT;return e.copyFrom(this),e}copyFrom(e){this.coreProperties=e.coreProperties.clone(),this.margins.copyFrom(e.margins),this.pageNumbering.copyFrom(e.pageNumbering),this.generalSectionInfo.copyFrom(e.generalSectionInfo),this.lineNumbering.copyFrom(e.lineNumbering),this.restartPageNumbering=e.restartPageNumbering,this.currentColumnIndex=e.currentColumnIndex,this.drawVerticalSeparator=e.drawVerticalSeparator}}class xT extends Lx{get states(){return this.data.positionStates.last.sectionProperties}get currentProperties(){return this.states.count||this.states.push(new yT),this.states.last}constructor(e){super(e),this.defaultSectionProperties=new yT}insertSection(){const e=this.data.importers.paragraph.paragraphFormatting;e.coreProperties.setValue(Ft.lineSpacing,e.calcLineSpacing()),e.coreProperties.setValue(Ft.lineSpacingType,e.calcLineSpacingType());const t=this.data.importers.paragraph.insertParagraph(!0);this.data.importers.paragraph.applyParagraphFormatting(t,!0),this.applySectionFormatting();const r=f.ListUtils.last(this.documentModel.sections);this.setLastSectionLength(r);const i=this.documentModel.mainSubDocument.positionManager.registerPosition(r.getEndPosition()),n=this.createSection(i);this.documentModel.sections.push(n)}createSection(e){const t=new Ch(this.documentModel,e,0,this.currentProperties.coreProperties),r=this.data.documentModel.sections.length;if(r>0){const e=this.data.documentModel.sections[r-1];t.headers.copyFrom(e.headers),t.footers.copyFrom(e.footers)}return t}setLastSectionLength(e=f.ListUtils.last(this.documentModel.sections)){e.setLength(this.documentModel.mainSubDocument,this.data.importers.character.logPosition-e.startLogPosition.value)}applySectionFormatting(e=!1){const t=this.data.documentModel.sections,r=f.ListUtils.last(t);this.currentProperties.validatePaperKind(),r.sectionProperties=this.currentProperties.coreProperties.clone();const i=this.data.importers.paragraph.paragraphFormatting,n=this.data.importers.paragraph.paragraph;!e&&this.data.importers.paragraph.paragraphFormatting.numberingListIndex>=0&&(n.isInList()||this.data.importers.numbering.addNumberingListToParagraph(n,i.paragraphListInfo));const o=this.data.importers.section.currentProperties;1!=t.length&&!o.restartPageNumbering||o.pageNumbering.continueNumbering?(r.sectionProperties.firstPageNumber=-1,r.sectionProperties.continueNumbering=!0):(r.sectionProperties.firstPageNumber=o.pageNumbering.firstPageNumber,r.sectionProperties.continueNumbering=!1),r.sectionProperties.lineNumbering.copyFrom(o.lineNumbering)}insertHeaderFooter(e,t){const r=f.ListUtils.last(this.data.documentModel.sections),i=this.createSubDocument(e?yo.Header:yo.Footer,t);i.chunks=[new mo(i.positionManager.registerPosition(0),"",!0)],this.data.destination=e?new IT(this.data,r,i):new ST(this.data,r,i)}createSubDocument(e,t){const r=f.ListUtils.last(this.documentModel.sections),i=this.documentModel.createSubDocument(e,-1,!0);return e==yo.Header?r.headers.setObjectIndex(t,this.documentModel.headers.push(i.info)-1):r.footers.setObjectIndex(t,this.documentModel.footers.push(i.info)-1),i}pushState(){this.states.push(this.states.count?this.currentProperties.clone():new yT)}popState(){this.states.count>1&&this.states.pop()}startImportSubDocument(){this.subDocument.isMain()||this.popState()}finalizeSubDocument(){this.subDocument.isMain()&&bT.fixLastSection(this.data.documentModel)}}class TT extends Lx{pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){}insertShape(e,t){const r=t.getPropertyOrNull(kP.ShapeText);if(!r)return;const i=e.importers.character.logPosition,n=e.importers.paragraph.paragraph,o=e.importers.style.character.style,a=e.importers.character.characterFormatting.coreProperties,s=new Jc;s.wrapType=uc.None,s.horizontalPositionAlignment=mc.None,s.verticalPositionAlignment=bc.None;const l=new sh(i,n,new pn(a,o),new th,r,new eh(!0,0,new so.Size(Bo.Constants.MIN_SAFE_INTEGER,Bo.Constants.MIN_SAFE_INTEGER),new so.Size(0,0),cc.Margin,hc.Margin,!0,!0),s,-1,new ph(new jc.m(144,144,72,72)));e.importers.character.addRun(l,an.specialCharacters.ObjectMark),new cT(t).applyAnchoredTextBoxRunProperties(l),l.size.absoluteSize=new oT(t).applyTransform2DAndGetActualSize(l.anchorInfo,l.size)}}class vT{constructor(e,t){this.rtfStyleIndex=e,this.rtfParentStyleIndex=t,this.rtfStyleIndex=e,this.rtfParentStyleIndex=t}}class MT extends Lx{constructor(e,t){super(e),this.mapRtfIndexToModelIndex={},this.states=new Rw.K,this.states.push(new vT(0,0)),this.resetStates=t,this.mapRtfIndexToModelIndex[0]=0}get rtfStyleIndex(){return this.states.last.rtfStyleIndex}set rtfStyleIndex(e){this.states.last.rtfStyleIndex=e}get rtfParentStyleIndex(){return this.states.last.rtfParentStyleIndex}set rtfParentStyleIndex(e){this.states.last.rtfParentStyleIndex=e}get styleExists(){return null!=this.mapRtfIndexToModelIndex[this.rtfStyleIndex]}get style(){return this.styleCollection[this.getModelIndex(this.rtfStyleIndex)]}get parentStyleExists(){return null!=this.mapRtfIndexToModelIndex[this.rtfParentStyleIndex]}get parentStyle(){return this.styleCollection[this.getModelIndex(this.rtfParentStyleIndex)]}getModelIndex(e){const t=this.mapRtfIndexToModelIndex[e];return void 0!==t?t:0}getOrCreateStyleByName(e){const t=f.ListUtils.indexBy(this.styleCollection,(t=>t.styleName==e));if(t>=0)return this.mapRtfIndexToModelIndex[this.rtfStyleIndex]=t,this.styleCollection[t];const r=this.createEmpty();r.styleName=e,r.parent=this.parentStyleExists?this.parentStyle:null;const i=this.addStyle(r);return this.mapRtfIndexToModelIndex[this.rtfStyleIndex]=f.ListUtils.indexBy(this.styleCollection,(t=>t.styleName==e)),i}pushState(){this.states.push(new vT(this.rtfStyleIndex,this.rtfParentStyleIndex))}popState(){if(this.states.count<=1)return;const e=this.states.pop();this.resetStates||this.applyState(this.states,e)}startImportSubDocument(){}finalizeSubDocument(){}}class ET extends MT{get styleCollection(){return this.data.documentModel.characterStyles}constructor(e){super(e,!0)}addStyle(e){const t=this.documentModel.stylesManager.addCharacterStyle(e);return t.localizedName=Wh.getPresetCharacterStyleLocalizedName(e.styleName),t}createEmpty(){return new zl("","",!1,!1,!1,!1,new Pe,"")}}class DT extends MT{addStyle(e){const t=this.documentModel.stylesManager.addParagraphStyle(e);return t.localizedName=Wh.getPresetParagraphStyleLocalizedName(e.styleName),t}ensureStyleExist(){this.rtfStyleIndex=Math.max(0,this.rtfStyleIndex),this.rtfParentStyleIndex=Math.max(0,this.rtfParentStyleIndex)}constructor(e){super(e,!1),this.paragraphTableStyles={}}get styleCollection(){return this.data.documentModel.paragraphStyles}createEmpty(){return new es("","",!1,!1,!1,!1,new Pe,new Lt,new ts,!1,QP.listIndexNotSetted,-1,"")}}class FT extends MT{get styleCollection(){return this.data.documentModel.tableStyles}constructor(e){super(e,!0)}createEmpty(){return new Vh("","",!1,!1,!1,!1,{},new Xl(null,null,null,null,null,new ts),"")}addStyle(e){const t=this.documentModel.stylesManager.addTableStyle(e);return t.localizedName=Wh.getPresetTableStyleLocalizedName(e.styleName),t}}class RT extends Lx{constructor(e){super(e),this.linkParagraphStyleIndexToCharacterStyleIndex={},this.nextParagraphStyleIndexTable={},this.paragraph=new DT(e),this.paragraph.mapRtfIndexToModelIndex[0]=0,this.character=new ET(e),this.table=new FT(e),this.importers=[this.paragraph,this.character,this.table]}applyStyleLinks(){b.j.forEach(this.linkParagraphStyleIndexToCharacterStyleIndex,((e,t)=>{if(void 0!==this.paragraph.mapRtfIndexToModelIndex[t]&&void 0!==this.character.mapRtfIndexToModelIndex[e]){const r=this.paragraph.getModelIndex(t),i=this.character.getModelIndex(e);this.documentModel.stylesManager.registerLink(this.documentModel.characterStyles[i],this.documentModel.paragraphStyles[r])}})),b.j.forEach(this.nextParagraphStyleIndexTable,((e,t)=>{if(void 0!==this.paragraph.mapRtfIndexToModelIndex[t]&&void 0!==this.paragraph.mapRtfIndexToModelIndex[e]){const r=this.paragraph.getModelIndex(t),i=this.paragraph.getModelIndex(e);this.documentModel.paragraphStyles[r].nextParagraphStyle=this.documentModel.paragraphStyles[i]}}))}pushState(){for(let e of this.importers)e.pushState()}popState(){f.ListUtils.reverseForEach(this.importers,(e=>e.popState()))}startImportSubDocument(){for(let e of this.importers)e.startImportSubDocument()}finalizeSubDocument(){}}class LT{static paragraphMarkBetween(e){b.j.forEach(e.subDocuments,(e=>{for(let t of e.tablesByLevels){let r=t[0];if(r)for(let i,n=1;i=t[n];)i.getStartPosition()-r.getEndPosition()==0?LT.joinTables(e,[r,i]):(r=i,n++)}}))}static joinTables(e,t){if(t.length<2)throw new Error("tables.length should be > 2");const r=t[0];f.ListUtils.forEach(t,(e=>{const t=r.properties.equals(e.properties);for(let i of e.rows)i.parentTable=r,r.rows.push(i),t||(i.tablePropertiesException=e.properties)}),1),f.ListUtils.forEach(t,(t=>rb.removeTableCore(t,e.tables,e.tablesByLevels)),1);const i=r.getTotalVirtualColumnsCount();for(let e of r.rows)e.gridAfter+=i-e.getTotalCellsInRowConsiderGrid()}static fixAllTables(e){b.j.forEach(e.subDocuments,(e=>{LT.fixTables(e)}))}static fixTables(e){e.tables.forEach((t=>{LT.fixTable(t,e)}))}static fixLastParagraphs(e){b.j.forEach(e.subDocuments,(e=>{LT.fixLastParagraph(e)}))}static fixLastParagraph(e){const t=e.interval.end;f.ListUtils.elementBy(e.tables,(e=>e.getEndPosition()==t))&&LT.insertParagraphInSubDocumentEnd(e)}static insertParagraphInSubDocumentEnd(e){uS.insertParagraphInEnd(e,e.getDocumentEndPosition(),e.getLastRun().getCharPropsBundle(e.documentModel))}static fixTable(e,t){LT.normalize(e),LT.normalizeRows(e,t),LT.normalizeTableGrid(e),rb.normalizeCellColumnSpansWithoutHistory(e,!0)}static normalizeRows(e,t){f.ListUtils.reverseForEach(e.rows,((r,i)=>{if(f.ListUtils.allOf(r.cells,(e=>e.verticalMerging==Xe.Continue))&&i>0){const n=i-1;r.height.type!=$e.Auto&&(e.rows[n].height.value+=r.height.value),rb.removeRowCore(t,e,i);const o=new Iu(e).tableCellInfos;f.ListUtils.forEach(e.rows[n].cells,((e,t)=>{const r=o[n][t];e.verticalMerging==Xe.Restart&&r.getStartRowIndex()==r.getEndRowIndex()-1&&(e.verticalMerging=Xe.None)}))}}))}static normalizeTableGrid(e){const t=e.getTotalVirtualColumnsCount();e.rows.forEach((e=>{const r=t-e.getTotalCellsInRowConsiderGrid();r&&(e.gridAfter+=r)}))}static normalize(e){1!=e.rows.length?e.rows.forEach(((e,t)=>{for(var r=0;r<e.cells.length;r++){var i=e.cells[r],n=i.verticalMerging;n!=Xe.None&&(n==Xe.Continue?LT.actualizeVerticalMergingForContinueCell(i,t):LT.actualizeVerticalMergingForRestartCell(i,t))}})):LT.removeInvalidVerticalSpansFromTableWithOneRow(e.rows)}static getCellColumnIndexConsiderRowGrid(e){return oc.getStartColumnIndex(e)}static getAbsoluteCellIndexInRow(e,t,r){if(0==e.cells.length)throw new Error(R.D.InternalException);const i=e.cells,n=i.length;let o=0;for(t-=e.gridBefore;t>0&&o<n;){var a=i[o];(t-=a.columnSpan)>=0&&o++}return o}static getLowerCell(e,t,r){return LT.getCell(e,t+1,r)}static getUpperCell(e,t,r){return LT.getCell(e,t-1,r)}static getCell(e,t,r){const i=e[t];if(null==i)return null;var n=LT.getAbsoluteCellIndexInRow(i,r,!1);return i.cells.length<=n?LT.getCell(e,t-1,r):i.cells[n]}static actualizeVerticalMergingForContinueCellCore(e,t,r){if(e.parentRow.isLastRowInTable)e.verticalMerging=Xe.None;else{var i=LT.getLowerCell(e.parentRow.parentTable.rows,t,r);null==i||i.verticalMerging!=Xe.Continue?e.verticalMerging=Xe.None:e.verticalMerging=Xe.Restart}}static actualizeVerticalMergingForContinueCell(e,t){const r=LT.getCellColumnIndexConsiderRowGrid(e);if(0==t)return void LT.actualizeVerticalMergingForContinueCellCore(e,t,r);const i=LT.getUpperCell(e.parentRow.parentTable.rows,t,r);if(null==i||i.verticalMerging==Xe.None)LT.actualizeVerticalMergingForContinueCellCore(e,t,r);else if(null!=i){const t=LT.getCellColumnIndexConsiderRowGrid(i),r=t+i.columnSpan,n=LT.getCellColumnIndexConsiderRowGrid(e),o=n+e.columnSpan;t==n&&r==o||(e.verticalMerging=Xe.None)}}static actualizeVerticalMergingForRestartCell(e,t){if(e.parentRow.isLastRowInTable)e.verticalMerging=Xe.None;else{var r=LT.getCellColumnIndexConsiderRowGrid(e),i=LT.getLowerCell(e.parentRow.parentTable.rows,t,r);if(null==i||i.verticalMerging!=Xe.Continue||e.columnSpan!=i.columnSpan)e.verticalMerging=Xe.None;else LT.getCellColumnIndexConsiderRowGrid(i)!=r&&(e.verticalMerging=Xe.None)}}static removeInvalidVerticalSpansFromTableWithOneRow(e){e[0].cells.forEach((e=>{e.verticalMerging=Xe.None}))}}class BT{constructor(e,t){this.drawingCompoundArray=[],this.compoundArray=e,this.widthDivider=t,this.lineCount=Math.floor(e.length/2),this.widthMultiplier=this.compoundArray[this.compoundArray.length-1];for(let e of this.compoundArray)this.drawingCompoundArray.push(e/this.widthMultiplier)}getActualWidth(e){return e*this.widthMultiplier/this.widthDivider}}class AT{static getPowerfulBorder(e,t,r){if(!t)return r;if(!r)return t;const i=AT.getWeight(t),n=AT.getWeight(r);if(i>n)return t;if(n>i)return r;const o=t.style,a=r.style;if(o>a)return t;if(a>o)return r;const s=e.getRgbaFromModelColor(t.color),l=e.getRgbaFromModelColor(r.color);let d=AT.getBrightnessLevelOne(s),c=AT.getBrightnessLevelOne(l);return d==c&&(d=AT.getBrightnessLevelTwo(s),c=AT.getBrightnessLevelTwo(l),d==c&&(d=AT.getBrightnessLevelThree(s),c=AT.getBrightnessLevelThree(l))),d<c?t:c<d?r:t}static getActualWidth(e){const{info:t}=AT.getActualBorderLineStyle(e.style);return t?t.getActualWidth(e.width):0}static getBrightnessLevelOne(e){return w.i.getRed(e)+AT.getBrightnessLevelTwo(e)}static getBrightnessLevelTwo(e){return w.i.getBlue(e)+2*w.i.getGreen(e)}static getBrightnessLevelThree(e){return w.i.getGreen(e)}static getWeight(e){const t=e.style,{info:r}=AT.getActualBorderLineStyle(t);return r?r.lineCount*t:t==de.Disabled?Number.MAX_VALUE:0}static getActualBorderLineStyle(e){if(e==de.None||e==de.Nil||e==de.Disabled)return{actualLineStyle:e,info:null};const t=AT.lineStyleInfo[e];return t?{actualLineStyle:e,info:t}:{actualLineStyle:de.Single,info:null}}}AT.lineStyleInfo={[de.Single]:new BT([0,1],1),[de.Thick]:new BT([0,1],1),[de.Double]:new BT([0,1,2,3],1),[de.Dotted]:new BT([0,1],1),[de.Dashed]:new BT([0,1],1),[de.DotDash]:new BT([0,1],1),[de.DotDotDash]:new BT([0,1],1),[de.Triple]:new BT([0,1,2,3,4,5],1),[de.ThinThickSmallGap]:new BT([0,1,2,10],8),[de.ThickThinSmallGap]:new BT([0,8,9,10],8),[de.ThinThickThinSmallGap]:new BT([0,1,2,10,11,12],8),[de.ThinThickMediumGap]:new BT([0,1,2,4],2),[de.ThickThinMediumGap]:new BT([0,2,3,4],2),[de.ThinThickThinMediumGap]:new BT([0,1,2,4,5,6],2),[de.ThinThickLargeGap]:new BT([0,1,9,11],8),[de.ThickThinLargeGap]:new BT([0,2,10,11],8),[de.ThinThickThinLargeGap]:new BT([0,1,9,11,19,20],8),[de.Wave]:new BT([0,1],1),[de.DoubleWave]:new BT([0,1,1,2],1),[de.DashSmallGap]:new BT([0,1],1),[de.DashDotStroked]:new BT([0,1],1),[de.ThreeDEmboss]:new BT([0,1,1,5,6],4),[de.ThreeDEngrave]:new BT([0,1,1,5,6],4),[de.Outset]:new BT([0,1],1),[de.Inset]:new BT([0,1],1)};class NT{constructor(){this.collection=[]}get first(){return this.collection.length>0?this[0]:-1}get last(){return this.collection.length>0?this[this.collection.length-1]:-1}binarySearchRight(e){let t=C.SearchUtils.normedInterpolationIndexOf(this.collection,(e=>e),e);if(t<=0)return t;let r=t+1;for(;r<this.collection.length&&this.collection[r]==this.collection[t];)t=r,r++;return t}binarySearchLeft(e){let t=C.SearchUtils.normedInterpolationIndexOf(this.collection,(e=>e),e);if(t<=0)return t;let r=t-1;for(;r>=0&&this.collection[r]==this.collection[t];)t=r,r--;return t}}class kT{calculate(e,t){if(!e)throw Error("table is Null!");let r=new NT;return r.collection.push(t),e.rows.forEach((e=>{const t=this.getRowColumns(e);r=this.merge(t.collection,r.collection)})),r}merge(e,t){const r=new NT;let i=0,n=0;for(;i<e.length&&n<t.length;)e[i]<=t[n]?(r.collection.push(e[i]),e[i]==t[n]&&n++,i++):(r.collection.push(t[n]),n++);if(n<t.length)for(;n<t.length;n++)r.collection.push(t[n]);else if(i<e.length)for(;i<e.length;i++)r.collection.push(e[i]);return r}getRowColumns(e){const t=new NT;let r=e.properties.left;return t.collection.push(r),e.cells.forEach((e=>{const i=e.properties.right;i<=r?t.collection.push(r):(t.collection.push(i),r=i)})),t}}class OT{constructor(e){this.rtfCellMap={},this.tableReader=e,this.rtfCellMap={}}get subDocument(){return this.tableReader.data.subDocument}convertTables(e,t){b.j.clear(this.rtfCellMap),this.tablesQueue=f.ListUtils.shallowCopy(e);let r=0;for(;this.tablesQueue.length>0;){const e=this.tablesQueue[0];this.tablesQueue.shift(),this.convertTable(e,r),r++}}convertTable(e,t){if(!this.rtfTableIsValid(e))return;let r=null;null!=e.parentCell&&(r=this.rtfCellMap[e.parentCell.idForParentCellMap]),this.prepareRtfTable(e);const i=e.createTable(t,r,this.tableReader.data.documentModel);this.convertTableCore(i,e),this.subDocument.tables.push(i)}rtfTableIsValid(e){if(0==e.rows.length)return!1;return f.ListUtils.last(e.rows).cells.length>0||(e.rows.splice(e.rows.length-1,1),this.rtfTableIsValid(e))}prepareRtfTable(e){this.shouldUseFloatingPosition(e);const t=e.properties.preferredWidth;if(t.type==Je.Nil&&(t.type=Je.Auto,t.value=0),!e.properties.coreProperties.getUseValue(ur.UseRightMargin)&&!e.properties.coreProperties.getUseValue(ur.UseLeftMargin)&&e.properties.useHalfSpace){const t=e.properties.halfSpace;e.properties.coreProperties.cellMargins.left.type=Je.ModelUnits,e.properties.coreProperties.cellMargins.left.value=t,e.properties.coreProperties.cellMargins.right.type=Je.ModelUnits,e.properties.coreProperties.cellMargins.right.value=t}e.indent=this.calculateTableLeftOffset(e);const r=e.properties.coreProperties.indent;r.type!=Je.ModelUnits&&(r.value=this.calculateTableIndent(e),r.type=Je.ModelUnits)}shouldUseFloatingPosition(e){return!1}calculateTableLeftOffset(e){const t=e.rows;let r=t[0].properties.left;const i=t.length;for(let e=1;e<i;e++)r=Math.min(r,t[e].properties.left);return r}calculateTableIndent(e){const t=e.rows[0].cells[0].properties.coreProperties.borders.left,r=this.getCellLeftMargin(e),i=AT.getActualWidth(t);return Math.max(i/2,this.getActualWidth(r))+e.indent}getCellLeftMargin(e){const t=e.rows[0].cells[0].properties;return t.coreProperties.cellMargins.left.type==Je.ModelUnits?t.coreProperties.cellMargins.left:e.properties.coreProperties.cellMargins.left}getActualWidth(e){return e.type==Je.ModelUnits?e.value:0}convertTableCore(e,t){const r=this.calculateTableGrid(t),i=e.rows,n=e.properties.layoutType;t.rows.forEach((t=>{this.prepareRtfRow(t,r,n);const o=t.createTableRow(e);i.push(o),this.convertRow(o,t)}))}calculateTableGrid(e){return(new kT).calculate(e,e.indent)}prepareRtfRow(e,t,r){const i=t.binarySearchLeft(e.properties.left);e.properties.gridBefore=i,0==e.properties.widthBefore.value&&i>0&&(e.properties.widthBefore.value=e.offset,e.properties.widthBefore.type=Je.ModelUnits),this.prepareRtfRowCells(e,t,i,r);const n=t.collection.length-1,o=n-this.calculateRowColumnSpan(e);if(e.properties.gridAfter=o,0==e.properties.widthAfter.value&&o>0){let r=1;r=e.properties.widthAfter.type==Je.ModelUnits?this.calculateWidthAfter(e):t.collection[n]-t.collection[n-o],e.properties.widthAfter.value=r,e.properties.widthAfter.type=Je.ModelUnits}}calculateWidthAfter(e){const t=this.calculateTotalRowWidth(e);if(t<0)return 1;const r=e.table.rows;let i=0;for(let t=0;t<r.length;t++){const n=r[t];if(n===e)continue;const o=this.calculateTotalRowWidth(n);o>0&&(i=Math.max(i,o))}return Math.max(1,t-i)}calculateTotalRowWidth(e){let t=0;const r=e.cells,i=r.length;for(let e=0;e<i;e++){const i=r[e].properties.preferredWidth;if(i.type!=Je.ModelUnits)return-1;t+=i.value}return t}prepareRtfRowCells(e,t,r,i){let n=r,o=t.collection[r];for(let r=0;r<e.cells.length;r++){const a=e.cells[r],s=a.properties.right>o?a.properties.right:o,l=t.binarySearchRight(s)-this.calculateEquidistantCellOrder(e.cells,r,s),d=l-n;a.columnSpan=Math.max(1,d);const c=a.properties.preferredWidth;(c.type==Je.Nil||c.type==Je.Auto&&i!=Oe.Autofit)&&(c.value=t.collection[l]-t.collection[n],c.type=Je.ModelUnits),n=Math.max(l,n),o=s}}calculateEquidistantCellOrder(e,t,r){const i=e.length;let n=0;for(let o=t+1;o<i&&!(e[o].properties.right>r);o++)n++;return n}calculateRowColumnSpan(e){let t=e.properties.gridBefore;const r=e.cells.length;for(let i=0;i<r;i++)t+=e.cells[i].columnSpan;return t}convertRow(e,t){const r=t.cells;for(let t=0;t<r.length;t++)this.convertCell(e,r[t])}convertCell(e,t){t.properties.horizontalMerging==Xe.Restart&&this.mergeCells(t);const r=t.createCell(e,this.subDocument);e.cells.push(r),this.rtfCellMap[t.idForParentCellMap]=r}mergeCells(e){const t=e.index+1,r=e.row.cells;for(;t<r.length&&r[t].properties.horizontalMerging==Xe.Continue;){const i=r[t],n=this.tableReader.parentCellMap,o=n[i.idForParentCellMap];if(void 0!==o){for(let e of o)f.ListUtils.remove(this.tablesQueue,e);delete n[i.idForParentCellMap]}e.columnSpan+=i.columnSpan,this.removeCell(r,i)}}removeCell(e,t){f.ListUtils.remove(e,t);const r=e.length;for(let i=t.index;i<r;i++)e[i].index--;const i=on.FixedInterval.fromPositions(t.startPos,t.endPos);this.tableReader.data.intervalsToDelete.push(new gu(this.subDocument,i))}recalcParagraphIndexes(e){}recalcParagraphIndexesInRow(e,t,r){}recalcParagraphIndexesInTable(e,t,r,i){}recalcParagraphIndexesInTables(e,t){const r=this.tablesQueue.length;for(let i=0;i<r;i++)this.recalcParagraphIndexesInTable(this.tablesQueue[i],0,e,t)}}class _T extends Lx{get tableReader(){return this.data.positionStates.last.tableReader}constructor(e){super(e)}insertTables(){0!=this.tableReader.tables.length&&new OT(this.tableReader).convertTables(this.tableReader.tables,!1)}pushState(){}popState(){}startImportSubDocument(){}finalizeSubDocument(){this.insertTables(),Ja.fillTableByLevels(this.subDocument),LT.fixTables(this.subDocument),LT.fixLastParagraph(this.subDocument),this.subDocument.isMain()&&LT.paragraphMarkBetween(this.subDocument.documentModel)}}class UT{constructor(e){this.importers=[],this.style=new RT(e),this.paragraph=new Ax(e),this.section=new xT(e),this.numbering=new gT(e),this.character=new Ox(e),this.image=new hT(e),this.field=new eT(e),this.bookmark=new Yx(e),this.rangePermission=new fT(e),this.comment=new Qx(e),this.font=new iT(e),this.table=new _T(e),this.shape=new TT(e),this.importers=[this.style,this.paragraph,this.section,this.numbering,this.character,this.image,this.field,this.bookmark,this.rangePermission,this.comment,this.font,this.table,this.shape]}pushState(){for(let e of this.importers)e.pushState()}popState(){f.ListUtils.reverseForEach(this.importers,(e=>e.popState()))}startImportSubDocument(){for(let e of this.importers)e.startImportSubDocument()}finalizeSubDocument(){for(let e of this.importers)e.finalizeSubDocument()}}class HT extends vy{get destinationType(){return Jw.UnicodeDestination}get controlCharHT(){return null}constructor(e,t){super(e),this.lastDestination=t}createClone(){return new HT(this.importer,this.lastDestination)}static onUdKeyword(e,t,r){const i=e.destination;e.destination=i.lastDestination}}class VT extends vy{get destinationType(){return Jw.StringPropertyBaseDestination}get controlCharHT(){return VT.controlCharHT}constructor(e,t){super(e),this.value=[],this.modifier=t}processCharCore(e){this.value.push(e)}afterPopRtfState(){const e=rn.StringUtils.trim(this.value.join(""),['"',"\\s"]);this.modifier(e)}createClone(){return new VT(this.importer,this.modifier)}}VT.controlCharHT=(new Eu).add("\\",vy.onEscapedChar).get(),function(e){e[e.Null=0]="Null",e[e.DbColumn=1]="DbColumn"}(by||(by={}));class WT{}class zT extends vy{constructor(){super(...arguments),this.fieldsMapData=[]}get destinationType(){return Jw.FieldMapDataDestination}get controlCharHT(){return null}static getFieldMapDataForEdit(e){const t=e.destination.fieldsMapData;return 0==t.length&&t.push(new WT),t[t.length-1]}static onNullFieldTypeKeyword(e,t,r){zT.getFieldMapDataForEdit(e).fieldType=by.Null}static onColumnFieldTypeKeyword(e,t,r){zT.getFieldMapDataForEdit(e).fieldType=by.DbColumn}static onAddressFieldTypeKeyword(e,t,r){}static onSalutationFieldTypeKeyword(e,t,r){}static onMappedFieldTypeKeyword(e,t,r){}static onBarcodeFieldTypeKeyword(e,t,r){}static onColumnNameKeyword(e,t,r){const i=zT.getFieldMapDataForEdit(e);e.destination=new VT(e,(e=>{i.columnName=e}))}static onMappedNameKeyword(e,t,r){const i=zT.getFieldMapDataForEdit(e);e.destination=new VT(e,(e=>{i.mappedName=e}))}static onColumnIndexKeyword(e,t,r){zT.getFieldMapDataForEdit(e).columnIndex=r?t:-1}static onDynamicAddressKeyword(e,t,r){r||(t=1);const i=zT.getFieldMapDataForEdit(e);i.dynamicAddress=0!=t}static onLanguageIdKeyword(e,t,r){(!r||t<0)&&(t=0);zT.getFieldMapDataForEdit(e).mergeFieldNameLanguageId=t}createClone(){return new zT(this.importer)}}!function(e){e[e.Unchecked=0]="Unchecked",e[e.Checked=1]="Checked",e[e.Undefined=25]="Undefined"}(Cy||(Cy={})),function(e){e[e.Auto=0]="Auto",e[e.Exact=1]="Exact"}(Sy||(Sy={})),function(e){e[e.Auto=0]="Auto",e[e.Custom=1]="Custom"}(Iy||(Iy={}));class jT{calculateHash(){return P.MathUtils.somePrimes[0]*this.size^P.MathUtils.somePrimes[1]*this.sizeType}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}equals(e){return e&&this.checkBoxState==e.checkBoxState&&this.defaultState==e.defaultState&&this.size==e.size&&this.sizeType==e.sizeType}copyFrom(e){e.checkBoxState=this.checkBoxState,e.defaultState=this.defaultState,e.size=this.size,e.sizeType=this.sizeType,e.hash=this.hash}clone(){const e=new jT;return e.copyFrom(this),e}}!function(e){e[e.UseNone=0]="UseNone",e[e.UseState=4]="UseState",e[e.UseDefaultState=8]="UseDefaultState",e[e.UseSize=16]="UseSize",e[e.UseSizeMode=32]="UseSizeMode",e[e.UseAll=2147483647]="UseAll"}(Py||(Py={}));class XT extends Wy{constructor(){super(...arguments),this._value=[]}get destinationType(){return Jw.UnicodeStringValueDestination}get value(){return rn.StringUtils.trimEnd(this._value.join(""),[";"])}processCharCore(e){e!=XT.emptyChar?this._value.push(e):this._value.push(XT.lowbar)}createClone(){const e=this.createEmptyClone();return e._value=this._value,e}}XT.emptyChar="\0",XT.lowbar="_";class GT extends XT{get destinationType(){return Jw.FieldStatusBarTextDestination}afterPopRtfState(){this.importer.importers.field.fields.last.formFieldProperties.statusText=rn.StringUtils.trim(this.value)}createEmptyClone(){return new GT(this.importer)}}class KT extends XT{get destinationType(){return Jw.FormFieldEntryMacroDestination}afterPopRtfState(){this.importer.importers.field.fields.peek().formFieldProperties.entryMacro=rn.StringUtils.trim(this.value)}createEmptyClone(){return new KT(this.importer)}}class qT extends XT{get destinationType(){return Jw.FormFieldExitMacroDestination}afterPopRtfState(){this.importer.importers.field.fields.peek().formFieldProperties.exitMacro=rn.StringUtils.trim(this.value)}createEmptyClone(){return new qT(this.importer)}}class $T extends XT{get destinationType(){return Jw.FormFieldHelpTextDestination}afterPopRtfState(){this.importer.importers.field.fields.peek().formFieldProperties.helpText=rn.StringUtils.trim(this.value)}createEmptyClone(){return new $T(this.importer)}}class JT extends XT{get destinationType(){return Jw.FormFieldNameDestination}afterPopRtfState(){this.importer.importers.field.fields.peek().formFieldProperties.name=rn.StringUtils.trim(this.value)}createEmptyClone(){return new JT(this.importer)}}class YT extends Wx{get destinationType(){return Jw.FormFieldDestination}createInstance(){return new YT(this.importer)}static getFormFieldProperties(e){return e.importers.field.fields.peek().formFieldProperties}static getCheckBoxProperties(e){return e.importers.field.fields.peek().checkBoxProperties}static onFormFieldTypeKeyword(e,t,r){1==t&&(e.importers.field.fields.peek().checkBoxProperties=new jT)}static onFormFieldListFieldResultKeyword(e,t,r){const i=YT.getCheckBoxProperties(e);null!=i&&(i.checkBoxState=t)}static onFormFieldProtectedKeyword(e,t,r){YT.getFormFieldProperties(e).enabled=!1}static onFormFieldCheckBoxFieldSizeTypeKeyword(e,t,r){const i=YT.getCheckBoxProperties(e);null!=i&&(i.sizeType=t)}static onFormFieldCalculatedOnExitKeyword(e,t,r){YT.getFormFieldProperties(e).calculateOnExit=!0}static onFormFieldCheckBoxFieldSizeKeyword(e,t,r){const i=YT.getCheckBoxProperties(e);null!=i&&(i.size=t)}static onFormFieldNameKeyword(e,t,r){e.destination=new JT(e)}static onFormFieldListFieldDefaultKeyword(e,t,r){const i=YT.getCheckBoxProperties(e);null!=i&&(i.defaultState=0!=t)}static onFormFieldHelpTextCustomKeyword(e,t,r){YT.getFormFieldProperties(e).helpTextType=Iy.Custom}static onFormFieldHelpTextKeyword(e,t,r){e.destination=new $T(e)}static onFormFieldStatusBarTextCustomKeyword(e,t,r){YT.getFormFieldProperties(e).statusTextType=Iy.Custom}static onFormFieldStatusBarTextKeyword(e,t,r){e.destination=new GT(e)}static onFormFieldEntryMacroKeyword(e,t,r){e.destination=new KT(e)}static onFormFieldExitMacroKeyword(e,t,r){e.destination=new qT(e)}}class QT{}class ZT extends vy{constructor(){super(...arguments),this.mmProps=new QT}get destinationType(){return Jw.MailMergeDestination}get controlCharHT(){return null}static onConnectionStringKeyword(e,t,r){const i=e.destination.mmProps;e.destination=new VT(e,(e=>{i.connectionString=e}))}static onQueryKeyword(e,t,r){const i=e.destination.mmProps;e.destination=new VT(e,(e=>{i.query=e}))}static onDataSourceKeyword(e,t,r){const i=e.destination.mmProps;e.destination=new VT(e,(e=>{i.dataSource=e}))}static onFieldMapDataKeyword(e,t,r){e.destination=new zT(e)}createClone(){return new ZT(this.importer)}}class ev extends Ey{get destinationType(){return Jw.SkipNestedTableDestination}static onParKeyword(e,t,r){e.destination=e.createDefaultDestination()}createClone(){return new ev(this.importer)}}const tv=(new Eu).add("deleted",xx.onDeletedKeyword).add("b",xx.onBoldKeyword).add("i",xx.onItalicKeyword).add("ul",xx.onUnderlineSingleKeyword).add("uld",xx.onUnderlineDottedKeyword).add("uldash",xx.onUnderlineDashedKeyword).add("uldashd",xx.onUnderlineDashDottedKeyword).add("uldashdd",xx.onUnderlineDashDotDottedKeyword).add("uldb",xx.onUnderlineDoubleKeyword).add("ulhwave",xx.onUnderlineHeavyWaveKeyword).add("ulldash",xx.onUnderlineLongDashedKeyword).add("ulth",xx.onUnderlineThickSingleKeyword).add("ulthd",xx.onUnderlineThickDottedKeyword).add("ulthdash",xx.onUnderlineThickDashedKeyword).add("ulthdashd",xx.onUnderlineThickDashDottedKeyword).add("ulthdashdd",xx.onUnderlineThickDashDotDottedKeyword).add("ulthldash",xx.onUnderlineThickLongDashedKeyword).add("ululdbwave",xx.onUnderlineDoubleWaveKeyword).add("ulwave",xx.onUnderlineWaveKeyword).add("ulw",xx.onUnderlineWordsOnlyKeyword).add("ulnone",xx.onUnderlineNoneKeyword).add("ulc",xx.onUnderlineColorKeyword).add("strike",xx.onStrikeoutKeyword).add("striked",xx.onDoubleStrikeoutKeyword).add("sub",xx.onSubscriptKeyword).add("super",xx.onSuperscriptKeyword).add("nosupersub",xx.onNoSuperAndSubScriptKeyword).add("lang",xx.onLanguageKeyword).add("langfe",xx.onLanguageEastAsianKeyword).add("langfenp",xx.onLanguageEastAsianNpKeyword).add("langnp",xx.onLanguageNpKeyword).add("noproof",xx.onNoProofKeyword).add("caps",xx.onCapsKeyword).add("scaps",xx.onSmallCapsKeyword).add("v",xx.onHiddenTextKeyword).add("fs",xx.onFontSizeKeyword).add("f",xx.onFontNameKeyword).add("af",xx.onAssociatedFontNameKeyword).add("cf",xx.onForeColorKeyword).add("highlight",xx.onHighlightColorKeyword).add("chshdng",xx.onShadingKeyword).add("chbghoriz",xx.onHorizontalBackgroundPatternKeyword).add("chbgvert",xx.onVerticalBackgroundPatternKeyword).add("chbgfdiag",xx.onForwardDiagonalBackgroundPatternKeyword).add("chbgbdiag",xx.onBackwardDiagonalBackgroundPatternKeyword).add("chbgcross",xx.onCrossBackgroundPatternKeyword).add("chbgdcross",xx.onDiagonalCrossBackgroundPatternKeyword).add("chbgdkhoriz",xx.onDarkHorizontalBackgroundPatternKeyword).add("chbgdkvert",xx.onDarkVerticalBackgroundPatternKeyword).add("chbgdkfdiag",xx.onDarkForwardDiagonalBackgroundPatternKeyword).add("chbgdkbdiag",xx.onDarkBackwardDiagonalBackgroundPatternKeyword).add("chbgdkcross",xx.onDarkCrossBackgroundPatternKeyword).add("chbgdkdcross",xx.onDarkDiagonalCrossBackgroundPatternKeyword).add("chcfpat",xx.onFillColorKeyword).add("chcbpat",xx.onBackColorKeyword).add("dbch",xx.onDoubleByteCharactersKeyword).add("loch",xx.onLowAnsiFontNameKeyword).add("hich",xx.onHighAnsiFontNameKeyword).add("rtlch",xx.onRTLRunKeyword).add("ltrch",xx.onLTRRunKeyword).get();class rv{static calculateThemeColorIndex(e){const t=rv.richEditThemeColorValuesToSchemeColorValuesTranslationTable[e],r=bo.schemeColorValuesToThemeColorIndexTranslationTable[t];if(void 0!==t&&void 0!==r)return r;const i=rv.richEditThemeColorValuesToThemeColorIndexTranslationTable[e];return void 0!==i?i:ce.None}}rv.richEditThemeColorValuesToSchemeColorValuesTranslationTable=(new Eu).add(z.Accent1,yn.Accent1).add(z.Accent2,yn.Accent2).add(z.Accent3,yn.Accent3).add(z.Accent4,yn.Accent4).add(z.Accent5,yn.Accent5).add(z.Accent6,yn.Accent6).add(z.Background1,yn.Background1).add(z.Background2,yn.Background2).add(z.Dark1,yn.Text1).add(z.Dark2,yn.Text2).add(z.FollowedHyperlink,yn.FollowedHyperlink).add(z.Hyperlink,yn.Hyperlink).add(z.Light1,yn.Background1).add(z.Light2,yn.Background2).add(z.Text1,yn.Text1).add(z.Text2,yn.Text2).get(),rv.richEditThemeColorValuesToThemeColorIndexTranslationTable=(new Eu).add(z.Accent1,ce.Accent1).add(z.Accent2,ce.Accent2).add(z.Accent3,ce.Accent3).add(z.Accent4,ce.Accent4).add(z.Accent5,ce.Accent5).add(z.Accent6,ce.Accent6).add(z.Background1,ce.Light1).add(z.Background2,ce.Light2).add(z.Dark1,ce.Dark1).add(z.Dark2,ce.Dark2).add(z.FollowedHyperlink,ce.FollowedHyperlink).add(z.Hyperlink,ce.Hyperlink).add(z.Light1,ce.Light1).add(z.Light2,ce.Light2).add(z.Text1,ce.Dark1).add(z.Text2,ce.Dark2).add(z.None,ce.None).get();class iv extends vy{constructor(){super(...arguments),this.themeColorValue=z.None,this.tint=iv.maxTintValue,this.shade=iv.maxTintValue}get destinationType(){return Jw.ColorTableDestination}get controlCharHT(){return null}get cache(){return this.importer.documentModel.cache.colorModelInfoCache}reset(){this.r=this.g=this.b=0,this.wasColor=!1,this.themeColorValue=z.None,this.tint=this.shade=iv.maxTintValue}processKeywordCore(e,t,r){switch(0==r&&(t=0),e){case"bin":return super.processKeywordCore(e,t,r);case"red":this.r=t,this.wasColor=!0;break;case"green":this.g=t,this.wasColor=!0;break;case"blue":this.b=t,this.wasColor=!0;break;case"ctint":this.tint=this.calculateTintOrShade(t),this.wasColor=!0;break;case"cshade":this.shade=this.calculateTintOrShade(t),this.wasColor=!0;break;case"cmaindarkone":this.themeColorValue=z.Dark1,this.wasColor=!0;break;case"cmainlightone":this.themeColorValue=z.Light1,this.wasColor=!0;break;case"cmaindarktwo":this.themeColorValue=z.Dark2,this.wasColor=!0;break;case"cmainlighttwo":this.themeColorValue=z.Light2,this.wasColor=!0;break;case"caccentone":this.themeColorValue=z.Accent1,this.wasColor=!0;break;case"caccenttwo":this.themeColorValue=z.Accent2,this.wasColor=!0;break;case"caccentthree":this.themeColorValue=z.Accent3,this.wasColor=!0;break;case"caccentfour":this.themeColorValue=z.Accent4,this.wasColor=!0;break;case"caccentfive":this.themeColorValue=z.Accent5,this.wasColor=!0;break;case"caccentsix":this.themeColorValue=z.Accent6,this.wasColor=!0;break;case"chyperlink":this.themeColorValue=z.Hyperlink,this.wasColor=!0;break;case"cfollowedhyperlink":this.themeColorValue=z.FollowedHyperlink,this.wasColor=!0;break;case"cbackgroundone":this.themeColorValue=z.Background1,this.wasColor=!0;break;case"ctextone":this.themeColorValue=z.Text1,this.wasColor=!0;break;case"cbackgroundtwo":this.themeColorValue=z.Background2,this.wasColor=!0;break;case"ctexttwo":this.themeColorValue=z.Text2,this.wasColor=!0;break;default:return!1}return!0}createClone(){return new iv(this.importer)}isColorValid(){return this.r>=0&&this.r<=255&&this.g>=0&&this.g<=255&&this.b>=0&&this.b<=255||this.themeColorValue!=z.None}calculateTintOrShade(e){return e>255?iv.maxTintValue:e<0?iv.minTintValue:e}processCharCore(e){if(";"==e){if(this.wasColor)if(this.isColorValid()){const e=w.i.fromArgbNumber(255,this.r,this.g,this.b);this.importer.documentProperties.colorIndexes.collection.push(this.cache.getItem(nv.createColorModelInfo(e,this.tint,this.shade,this.themeColorValue)))}else this.importer.throwInvalidRtfFile();else this.importer.documentProperties.colorIndexes.collection.push(this.cache.getItem(he.makeByColor(U.empty)));this.reset()}}}iv.maxTintValue=255,iv.minTintValue=0,iv.autoColor=U.empty;class nv{static createColorModelInfo(e,t,r,i){const n=he.makeByColor(e);if(i!=z.None){const e=rv.richEditThemeColorValuesToThemeColorIndexTranslationTable[i];e!=ce.None&&(n.themeColorIndex=e,t==hP.maxTintValue?n.tint=hP.modifyShadeToTint(r):n.tint=hP.calculateTint(t))}return n}}class ov extends vy{constructor(){super(...arguments),this.author=""}get destinationType(){return Jw.DestinationRevisionAuthorTable}get controlCharHT(){return null}get keywordHT(){return null}processCharCore(e){";"==e?(this.importer.importers.rangePermission.revisionAuthors.authors.push(this.author),this.author=""):this.author+=e}createClone(){return new ov(this.importer)}}class av extends vy{get destinationType(){return Jw.FontTableDestination}get controlCharHT(){return null}get keywordHT(){return null}constructor(e,t=!1){super(e),this.nestedState=t,this.fontInfo=new wy,this.emptyFontInfo=!0}processKeywordCore(e,t,r){switch(r||(t=0),this.emptyFontInfo=!1,e){case"f":this.fontInfo.id=t;break;case"fcharset":this.onFontCharset(t);break;case"bin":return super.processKeywordCore(e,t,r);default:return!1}return!0}createClone(){return new av(this.importer,!0)}addFontInfo(){this.nestedState&&this.emptyFontInfo||(this.importer.importers.font.addRtfFontInfo(this.fontInfo),this.fontInfo=new wy,this.emptyFontInfo=!0)}processCharCore(e){";"==e?(this.addFontInfo(),this.importer.setCodePage(this.importer.documentProperties.defaultCodePage)):(this.fontInfo.name.length<256&&(this.fontInfo.name+=e),this.emptyFontInfo=!1)}onFontCharset(e){this.fontInfo.charset=e,this.fontInfo.charset>=0&&this.importer.setCodePage(tT.codePageFromCharset(this.fontInfo.charset))}beforePopRtfState(){this.nestedState&&!this.emptyFontInfo&&this.addFontInfo(),super.beforePopRtfState()}afterPopRtfState(){const e=this.importer.importers.font.fonts.getRtfFontInfoById(this.importer.importers.font.defaultFontNumber);this.importer.importers.character.characterFormatting.coreProperties.fontInfo=e.getCoreObjectByName(this.importer.documentModel),e!=this.importer.importers.font.fonts.defaultRtfFontInfo&&e.charset>=0&&(this.importer.documentProperties.defaultCodePage=tT.codePageFromCharset(e.charset)),this.importer.setCodePage(this.importer.documentProperties.defaultCodePage)}}class sv extends zy{get destinationType(){return Jw.UserTableDestination}nestedGroupFinished(e){if(super.nestedGroupFinished(e),e instanceof sv){const t=rn.StringUtils.trim(e.value);this.importer.importers.rangePermission.userNames.push(t)}}createEmptyClone(){return new sv(this.importer)}}const lv=(new Eu).add("bin",vy.onBinKeyword).add("colortbl",(e=>e.destination=new iv(e))).add("fonttbl",(e=>e.destination=new av(e))).add("protusertbl",(e=>e.destination=new sv(e))).add("ansi",vy.onAnsiKeyword).add("mac",vy.onMacKeyword).add("pc",vy.onPcKeyword).add("pca",vy.onPcaKeyword).add("ansicpg",vy.onAnsiCodePageKeyword).add("hyphauto",vy.onHyphAutoKeyword).add("upr",(e=>e.destination=new HT(e,e.destination))).add("uc",vy.onUnicodeCountKeyword).add("revtbl",(e=>e.destination=new ov(e))).add("u",vy.onUnicodeKeyword).get(),dv=(new Eu).add("category",ky.onCategoryKeyword).add("creatim",ky.onCreatedKeyword).add("doccomm",ky.onDescriptionKeyword).add("author",ky.onCreatorKeyword).add("keywords",ky.onKeywordsKeyword).add("operator",ky.onLastModifiedByKeyword).add("printim",ky.onLastPrintedKeyword).add("revtim",ky.onModifiedKeyword).add("version",ky.onRevisionKeyword).add("subject",ky.onSubjectKeyword).add("title",ky.onTitleKeyword).get();class cv extends vy{constructor(){super(...arguments),this.textBefore="",this.textAfter=""}get destinationType(){return Jw.DestinationOldParagraphNumberingBase}get controlCharHT(){return null}static setNumberingListFormat(e,t){e.importers.numbering.oldListLevelInfo.listLevelProperties.format=t}static setUnderlineType(e,t){e.importers.character.characterFormatting.coreProperties.fontUnderlineType=t}static onCardinalKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.CardinalText)}static onDecimalKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.Decimal)}static onUpperCaseAlphabeticalKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.UpperLetter)}static onUpperCaseRomanKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.UpperRoman)}static onLowerCaseAlphabeticalKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.LowerLetter)}static onLowerCaseRomanKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.LowerRoman)}static onOrdinalKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.Ordinal)}static onOrdinalTextKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.OrdinalText)}static onNumberingInCircleKeyword(e,t,r){cv.setNumberingListFormat(e,Zi.DecimalEnclosedCircle)}static onDashedUndrelineKeyword(e,t,r){cv.setUnderlineType(e,le.Dashed)}static onDashDottedUnderlineKeyword(e,t,r){cv.setUnderlineType(e,le.DashDotted)}static onDashDotDottedUnderlineKeyword(e,t,r){cv.setUnderlineType(e,le.DashDotDotted)}static onHairlineUnderlineKeyword(e,t,r){cv.setUnderlineType(e,le.ThickSingle)}static onThickUnderlineKeyword(e,t,r){cv.setUnderlineType(e,le.ThickSingle)}static onWaveUnderlineKeyword(e,t,r){cv.setUnderlineType(e,le.Wave)}static onDottedUnderlineKeyword(e,t,r){cv.setUnderlineType(e,le.Dotted)}static onDoubleUnderlineKeyword(e,t,r){cv.setUnderlineType(e,le.Double)}static onNoneUnderlineKeyword(e,t,r){cv.setUnderlineType(e,le.None)}static onContinuousUnderlineKeyword(e,t,r){e.importers.character.characterFormatting.coreProperties.underlineWordsOnly=!1}static onWordUnderlineKeyword(e,t,r){e.importers.character.characterFormatting.coreProperties.underlineWordsOnly=!0}static onFontNumberKeyword(e,t,r){const i=e.importers.font;r||(t=i.defaultFontNumber),i.setFont(i.fonts.getRtfFontInfoById(t))}static onFontBoldKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.fontBold=i}static onItalicKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.fontItalic=i}static onAllCapsKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.allCaps=i}static onSmallCapsKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.smallCaps=!i}static onStrikeKeyword(e,t,r){const i=!r||0!=t;e.importers.character.characterFormatting.coreProperties.fontStrikeoutType=i?se.Single:se.None}static onForegroundColorKeyword(e,t,r){r||(t=0);const i=e.importers.character.characterFormatting.coreProperties.shadingInfo;e.importers.character.characterFormatting.coreProperties.shadingInfo=new fe(i.shadingPattern,i.backColor,xx.getColorIndex(e,t))}static onIndentKeyword(e,t,r){const i=e.importers.paragraph.paragraphFormatting;t<0?(i.coreProperties.firstLineIndent=-t,i.coreProperties.firstLineIndentType=ke.Hanging):(i.coreProperties.firstLineIndent=t,i.coreProperties.firstLineIndentType=ke.Indented)}static onSpaceKeyword(e,t,r){}static onUsePrevKeyword(e,t,r){e.importers.numbering.oldListLevelInfo.includeInformationFromPreviousLevel=!0}static onStartAtKeyword(e,t,r){e.importers.numbering.oldListLevelInfo.listLevelProperties.start=t}static onHangingIndentKeyword(e,t,r){e.importers.paragraph.paragraphFormatting.coreProperties.firstLineIndentType=ke.Hanging}static onRestartOnSectionBreakKeyword(e,t,r){}static onCenterAlignmentKeyword(e,t,r){e.importers.numbering.oldListLevelInfo.listLevelProperties.alignment=en.Center}static onLeftAlignmentKeyword(e,t,r){e.importers.numbering.oldListLevelInfo.listLevelProperties.alignment=en.Left}static onRightAlignmentKeyword(e,t,r){e.importers.numbering.oldListLevelInfo.listLevelProperties.alignment=en.Right}static onTextBeforeKeyword(e,t,r){e.destination=new Px(e)}static onTextAfterKeyword(e,t,r){e.destination=new Ix(e)}nestedGroupFinished(e){super.nestedGroupFinished(e),e instanceof Px?this.textBefore=e.value:e instanceof Ix&&(this.textAfter=e.value)}beforePopRtfState(){super.beforePopRtfState(),this.importer.importers.numbering.oldListLevelInfo.textAfter=this.textAfter,this.importer.importers.numbering.oldListLevelInfo.textBefore=this.textBefore}}class hv extends cv{get destinationType(){return Jw.DestinationOldParagraphNumbering}constructor(e){super(e),this.oldLevelNumber=-1,null==e.importers.numbering.oldListLevelInfo&&(e.importers.numbering.oldListLevelInfo=new uT),e.importers.character.characterFormatting.coreProperties.setAllUse(),this.multiLevelListIndex=QP.listIndexNotSetted,this.simpleListIndex=QP.listIndexNotSetted}static onParagraphLevelKeyword(e,t,r){r&&10==t?hv.onSimpleNumberingKeyword(e,0,!1):(e.destination.oldLevelNumber=t,e.destination.simpleList=!1)}static onBulletedParagraphKeyword(e,t,r){e.importers.numbering.oldListLevelInfo.listLevelProperties.format=Zi.Bullet}static onSimpleNumberingKeyword(e,t,r){e.destination.simpleList=!0}static onSkipNumberingKeyword(e,t,r){e.importers.numbering.oldListLevelInfo.skipNumbering=!0}static onListOverrideKeyword(e,t,r){const i=e.importers.numbering.listOverrideIndexToNumberingListIndexMap[t];void 0!==i&&(e.importers.paragraph.paragraphFormatting.paragraphListInfo.numberingListIndex=i),e.destination.explicitNumberingListIndex=!0}static onListLevelKeyword(e,t,r){e.importers.paragraph.paragraphFormatting.paragraphListInfo.listLevelIndex=t,e.destination.explicitListLevelIndex=!0}createClone(){return new hv(this.importer)}beforePopRtfState(){super.beforePopRtfState(),this.shouldCreateNewList()?this.createNewList():(this.skipNumbering=this.isSkipNumbering(),this.simpleListIndex=this.importer.importers.numbering.currentOldSimpleListIndex,this.multiLevelListIndex=this.importer.importers.numbering.currentOldMultiLevelListIndex),this.explicitNumberingListIndex&&this.explicitListLevelIndex?(this.listLevelIndex=this.importer.importers.paragraph.paragraphFormatting.listLevelIndex,this.numberingListIndex=this.importer.importers.paragraph.paragraphFormatting.numberingListIndex):this.listLevelIndex=this.oldLevelNumber>=0?this.oldLevelNumber-1:0}afterPopRtfState(){super.afterPopRtfState(),this.importer.importers.paragraph.paragraphFormatting.paragraphListInfo.listLevelIndex=this.listLevelIndex;const e=this.isSimpleList()?this.simpleListIndex:this.multiLevelListIndex;this.importer.importers.numbering.currentOldListSkipNumbering=this.skipNumbering,this.isOldNumberingListCreated&&(this.importer.importers.numbering.currentOldMultiLevelListIndex=this.multiLevelListIndex,this.importer.importers.numbering.currentOldSimpleListIndex=this.simpleListIndex,this.importer.importers.numbering.currentOldSimpleList=this.simpleList),this.explicitListLevelIndex&&this.explicitNumberingListIndex?(this.importer.importers.paragraph.paragraphFormatting.paragraphListInfo.numberingListIndex=this.numberingListIndex,this.importer.importers.paragraph.paragraphFormatting.paragraphListInfo.listLevelIndex=this.listLevelIndex):this.importer.importers.paragraph.paragraphFormatting.paragraphListInfo.numberingListIndex=this.skipNumbering?QP.noNumberingList:e}createNewList(){const e=this.importer.importers.numbering.oldListLevelInfo;this.simpleList?(this.createSimpleNumberingListLevels(),this.simpleListIndex=this.importer.documentModel.numberingLists.length-1,this.multiLevelListIndex=this.importer.importers.numbering.currentOldMultiLevelListIndex):e.listLevelProperties.format==Zi.Bullet?(this.createBulletedListLevels(),this.multiLevelListIndex=this.importer.documentModel.numberingLists.length-1,this.simpleListIndex=this.importer.importers.numbering.currentOldSimpleListIndex):(this.createMultilevelListLevels(),this.multiLevelListIndex=this.importer.documentModel.numberingLists.length-1,this.simpleListIndex=this.importer.importers.numbering.currentOldSimpleListIndex)}createMultilevelListLevels(){const e=this.importer.documentModel,t=new dn(e);e.abstractNumberingLists.push(t);for(let e=0;e<t.levels.length;e++){const r=this.importer.importers.numbering.oldListLevelInfoCollection.getByIndex(e+1),i=t.levels[e],n=r.indent,o=i.getListLevelProperties().clone();i.setListLevelProperties(o),this.setFirstLineIndent(t.levels[e],n),i.getCharacterProperties().copyFrom(this.importer.importers.character.characterFormatting.coreProperties);let a=`${r.textBefore}{${e}}${r.textAfter}`;e>0&&r.includeInformationFromPreviousLevel&&(a=t.levels[e-1].getListLevelProperties().displayFormatString+a),this.setDisplayFormatString(i,a),this.setLegacyProperties(i,0,0)}this.isOldNumberingListCreated=!0,e.numberingLists.push(new cn(e,e.abstractNumberingLists.length-1))}createBulletedListLevels(){const e=this.importer.documentModel,t=g.u.documentsToTwips(150),r=new dn(e);e.abstractNumberingLists.push(r);for(let i=0;i<r.levels.length;i++){const n=r.levels[i],o=n.getListLevelProperties().clone();n.setListLevelProperties(o),n.getCharacterProperties().copyFrom(this.importer.importers.character.characterFormatting.coreProperties),n.getListLevelProperties().format=Zi.Bullet;const a=t*i+this.importer.importers.paragraph.paragraphFormatting.coreProperties.firstLineIndent;this.setFirstLineIndent(n,a),this.setDisplayFormatString(n,this.importer.importers.numbering.oldListLevelInfo.textBefore+this.importer.importers.numbering.oldListLevelInfo.textAfter),this.setTemplateCode(n,Tw.generateNewTemplateCode(e)),this.setLegacyProperties(n,0,0)}this.isOldNumberingListCreated=!0,e.numberingLists.push(new cn(e,e.abstractNumberingLists.length-1))}createSimpleNumberingListLevels(){const e=this.importer.documentModel,t=this.shouldCreateNewAbstractSimpleList(),r=t.existingNumberingListIndex;if(t.isSecceed){const t=new dn(e);e.abstractNumberingLists.push(t);for(let r=0;r<t.levels.length;r++){const i=t.levels[r],n=i.getListLevelProperties().clone();i.setListLevelProperties(n),i.getCharacterProperties().copyFrom(this.importer.importers.character.characterFormatting.coreProperties);const o=this.importer.importers.paragraph.paragraphFormatting.coreProperties.firstLineIndent+150*r;this.setFirstLineIndent(i,o),this.setDisplayFormatString(i,`${this.importer.importers.numbering.oldListLevelInfo.textBefore}{${r}}${this.importer.importers.numbering.oldListLevelInfo.textAfter}`),this.setTemplateCode(i,Tw.generateNewTemplateCode(e)),this.setLegacyProperties(i,0,0);const a=this.importer.importers.numbering.oldListLevelInfo.listLevelProperties.start;a>0&&(i.getListLevelProperties().start=a);const s=this.importer.importers.numbering.oldListLevelInfo.listLevelProperties.format;s!=Zi.Decimal&&(i.getListLevelProperties().format=s)}this.isOldNumberingListCreated=!0,e.numberingLists.push(new cn(e,e.abstractNumberingLists.length-1)),this.importer.importers.numbering.numberingListToOldListLevelInfoMap[e.numberingLists.length-1]=this.importer.importers.numbering.oldListLevelInfo.clone()}else{const t=e.numberingLists[r].abstractNumberingListIndex,i=f.ListUtils.last(e.numberingLists),n=new cn(e,t),o=n.levels[0],a=this.importer.importers.numbering.oldListLevelInfo.listLevelProperties.start;a>=0&&(o.getListLevelProperties().start=a);const s=this.importer.importers.numbering.oldListLevelInfo.listLevelProperties.format;s!=Zi.Decimal&&(o.getListLevelProperties().format=s),null!=i&&i.levels[0].getListLevelProperties().format!=o.getListLevelProperties().format&&(o.overrideStart=!0),o.getCharacterProperties().copyFrom(this.importer.importers.character.characterFormatting.coreProperties);const l=this.importer.importers.paragraph.paragraphFormatting.coreProperties.firstLineIndent;this.setFirstLineIndent(o,l),this.setDisplayFormatString(o,`${this.importer.importers.numbering.oldListLevelInfo.textBefore}{0}${this.importer.importers.numbering.oldListLevelInfo.textAfter}`),this.setTemplateCode(o,Tw.generateNewTemplateCode(e)),this.setLegacyProperties(o,0,0),e.numberingLists.push(n),this.importer.importers.numbering.numberingListToOldListLevelInfoMap[e.numberingLists.length-1]=this.importer.importers.numbering.oldListLevelInfo.clone()}}shouldCreateNewAbstractSimpleList(){let e;if(this.importer.importers.numbering.currentOldSimpleList&&this.importer.importers.numbering.currentOldSimpleListIndex>=QP.minValue){e=this.importer.importers.numbering.currentOldSimpleListIndex;let t=this.importer.importers.numbering.numberingListToOldListLevelInfoMap[e];return t?{isSecceed:!this.areSameInfo(t,this.importer.importers.numbering.oldListLevelInfo),existingNumberingListIndex:e}:{isSecceed:!0,existingNumberingListIndex:e}}e=QP.listIndexNotSetted;let t=this.importer.subDocument.paragraphs.length-1-1;for(;t>=0;t--){const r=this.importer.subDocument.paragraphs[t];if(!r.isInList()){if(r.numberingListIndex==QP.noNumberingList)continue;return{isSecceed:!0,existingNumberingListIndex:e}}const i=r.numberingListIndex,n=this.importer.importers.numbering.numberingListToOldListLevelInfoMap[i];return n&&this.areSameInfo(n,this.importer.importers.numbering.oldListLevelInfo)?(e=i,{isSecceed:!1,existingNumberingListIndex:e}):{isSecceed:!0,existingNumberingListIndex:e}}return{isSecceed:!0,existingNumberingListIndex:e}}setLegacyProperties(e,t,r){e.getListLevelProperties().legacy=!0,e.getListLevelProperties().legacySpace=t,e.getListLevelProperties().legacyIndent=r}setDisplayFormatString(e,t){e.getListLevelProperties().displayFormatString=t}setFirstLineIndent(e,t){e.getParagraphProperties().leftIndent=t}setTemplateCode(e,t){e.getListLevelProperties().templateCode=t}shouldCreateNewList(){return!this.isNewListLevelInfoPresent()&&(this.isMultilevelList()?!this.sectionMultiLevelListCreated():!!this.isSimpleList()||!this.isSkipNumbering())}isNewListLevelInfoPresent(){if(this.explicitListLevelIndex&&this.explicitNumberingListIndex)return!0;if(this.isSimpleList()){if(this.simpleListIndex<QP.minValue)return!1;const e=this.importer.importers.numbering.numberingListToOldListLevelInfoMap[this.simpleListIndex];return!!e&&this.areSameInfo(e,this.importer.importers.numbering.oldListLevelInfo)}return this.multiLevelListIndex>=QP.minValue}areSameInfo(e,t){return e.textAfter===t.textAfter&&e.textBefore===t.textBefore&&e.listLevelProperties.format===t.listLevelProperties.format}isSimpleList(){return this.simpleList}isMultilevelList(){return this.oldLevelNumber>=0&&!this.simpleList}sectionMultiLevelListCreated(){return this.importer.importers.numbering.currentOldMultiLevelListIndex>=QP.minValue}isSkipNumbering(){return this.importer.importers.numbering.oldListLevelInfo.skipNumbering}}const uv=(new Eu).add("pncard",cv.onCardinalKeyword).add("pndec",cv.onDecimalKeyword).add("pnucltr",cv.onUpperCaseAlphabeticalKeyword).add("pnucrm",cv.onUpperCaseRomanKeyword).add("pnlcltr",cv.onLowerCaseAlphabeticalKeyword).add("pnlcrm",cv.onLowerCaseRomanKeyword).add("pnord",cv.onOrdinalKeyword).add("pnordt",cv.onOrdinalTextKeyword).add("pncnum",cv.onNumberingInCircleKeyword).add("pnuldash",cv.onDashedUndrelineKeyword).add("pnuldashd",cv.onDashDottedUnderlineKeyword).add("pnuldashdd",cv.onDashDotDottedUnderlineKeyword).add("pnulhair",cv.onHairlineUnderlineKeyword).add("pnulth",cv.onThickUnderlineKeyword).add("pnulwave",cv.onWaveUnderlineKeyword).add("pnul",cv.onContinuousUnderlineKeyword).add("pnuld",cv.onDottedUnderlineKeyword).add("pnuldb",cv.onDoubleUnderlineKeyword).add("pnulnone",cv.onNoneUnderlineKeyword).add("pnulw",cv.onWordUnderlineKeyword).add("pnf",cv.onFontNumberKeyword).add("pnfs",xx.onFontSizeKeyword).add("pnb",cv.onFontBoldKeyword).add("pni",cv.onItalicKeyword).add("pncaps",cv.onAllCapsKeyword).add("pnscaps",cv.onSmallCapsKeyword).add("pnstrike",cv.onStrikeKeyword).add("pncf",cv.onForegroundColorKeyword).add("pnindent",cv.onIndentKeyword).add("pnsp",cv.onSpaceKeyword).add("pnprev",cv.onUsePrevKeyword).add("pnstart",cv.onStartAtKeyword).add("pnhang",cv.onHangingIndentKeyword).add("pnrestart",cv.onRestartOnSectionBreakKeyword).add("pnqc",cv.onCenterAlignmentKeyword).add("pnql",cv.onLeftAlignmentKeyword).add("pnqr",cv.onRightAlignmentKeyword).add("pntxtb",cv.onTextBeforeKeyword).add("pntxta",cv.onTextAfterKeyword).add("pnlvlbody",hv.onSimpleNumberingKeyword).add("pnlvlblt",hv.onBulletedParagraphKeyword).get(),pv=(new Eu).add("brdrt",xx.onTopParagraphBorderKeyword).add("brdrb",xx.onBottomParagraphBorderKeyword).add("brdrl",xx.onLeftParagraphBorderKeyword).add("brdrr",xx.onRightParagraphBorderKeyword).add("brdrbtw",xx.onBetweenParagraphBorderKeyword).add("brdrbar",xx.onBarParagraphBorderKeyword).add("posx",xx.onFrameHorizontalPositionKeyword).add("posnegx",xx.onFrameHorizontalPositionNegativeKeyword).add("posxc",xx.onFrameHorizontalAlignmentCenterKeyword).add("posxi",xx.onFrameHorizontalAlignmentInsideKeyword).add("posxo",xx.onFrameHorizontalAlignmentOutsideKeyword).add("posxr",xx.onFrameHorizontalAlignmentRightKeyword).add("posxl",xx.onFrameHorizontalAlignmentLeftKeyword).add("posy",xx.onFrameVerticalPositionKeyword).add("posnegy",xx.onFrameVerticalPositionNegativeKeyword).add("posyil",xx.onFrameVerticalAlignmentInlineKeyword).add("posyt",xx.onFrameVerticalAlignmentTopKeyword).add("posyc",xx.onFrameVerticalAlignmentCenterKeyword).add("posyb",xx.onFrameVerticalAlignmentBottomKeyword).add("posyin",xx.onFrameVerticalAlignmentInsideKeyword).add("posyout",xx.onFrameVerticalAlignmentOutsideKeyword).add("absw",xx.onFrameWidthKeyword).add("absh",xx.onFrameHeightKeyword).add("dxfrtext",xx.onFramePaddingKeyword).add("dfrmtxty",xx.onFrameVerticalPaddingKeyword).add("dfrmtxtx",xx.onFrameHorizontalPaddingKeyword).add("phmrg",xx.onParagraphHorizontalPositionTypeMarginKeyword).add("phpg",xx.onParagraphHorizontalPositionTypePageKeyword).add("phcol",xx.onParagraphHorizontalPositionTypeColumnKeyword).add("pvmrg",xx.onParagraphVerticalPositionTypeMarginKeyword).add("pvpg",xx.onParagraphVerticalPositionTypePageKeyword).add("pvpara",xx.onParagraphVerticalPositionTypeLineKeyword).add("nowrap",xx.onFrameNoWrapKeyword).add("overlay",xx.onFrameWrapOverlayKeyword).add("wrapdefault",xx.onFrameWrapDefaultKeyword).add("wraparound",xx.onFrameWrapAroundKeyword).add("wraptight",xx.onFrameWrapTightKeyword).add("wrapthrough",xx.onFrameWrapThroughKeyword).add("abslock",xx.onFrameLockAnchor).add("ql",xx.onAlignLeftKeyword).add("qc",xx.onAlignCenterKeyword).add("qr",xx.onAlignRightKeyword).add("qd",xx.onAlignJustifyKeyword).add("qj",xx.onAlignJustifyKeyword).add("li",xx.onLeftIndentKeyword).add("lin",xx.onLeftIndentKeyword).add("ri",xx.onRightIndentKeyword).add("fi",xx.onFirstLineIndentKeyword).add("rin",xx.onRightIndentKeyword).add("sb",xx.onSpacingBeforeKeyword).add("sa",xx.onSpacingAfterKeyword).add("sl",xx.onLineSpacingTypeKeyword).add("slmult",xx.onLineSpacingMultiplierKeyword).add("hyphpar",xx.onHyphenateParagraphKeyword).add("noline",xx.onSuppressLineNumbersKeyword).add("contextualspace",xx.onContextualSpacingKeyword).add("pagebb",xx.onPageBreakBeforeKeyword).add("sbauto",xx.onBeforeAutoSpacingKeyword).add("saauto",xx.onAfterAutoSpacingKeyword).add("keepn",xx.onKeepWithNextKeyword).add("keep",xx.onKeepLinesTogetherKeyword).add("widctlpar",xx.onWidowOrphanControlOnKeyword).add("nowidctlpar",xx.onWidowOrphanControlOffKeyword).add("outlinelevel",xx.onOutlineLevelKeyword).add("shading",xx.onParagraphShadingKeyword).add("bghoriz",xx.onParagraphHorizontalBackgroundPatternKeyword).add("bgvert",xx.onParagraphVerticalBackgroundPatternKeyword).add("bgfdiag",xx.onParagraphForwardDiagonalBackgroundPatternKeyword).add("bgbdiag",xx.onParagraphBackwardDiagonalBackgroundPatternKeyword).add("bgcross",xx.onParagraphCrossBackgroundPatternKeyword).add("bgdcross",xx.onParagraphDiagonalCrossBackgroundPatternKeyword).add("bgdkhoriz",xx.onParagraphDarkHorizontalBackgroundPatternKeyword).add("bgdkvert",xx.onParagraphDarkVerticalBackgroundPatternKeyword).add("bgdkfdiag",xx.onParagraphDarkForwardDiagonalBackgroundPatternKeyword).add("bgdkbdiag",xx.onParagraphDarkBackwardDiagonalBackgroundPatternKeyword).add("bgdkcross",xx.onParagraphDarkCrossBackgroundPatternKeyword).add("bgdkdcross",xx.onParagraphDarkDiagonalCrossBackgroundPatternKeyword).add("cfpat",xx.onParagraphFillColorKeyword).add("cbpat",xx.onParagraphBackgroundKeyword).get(),gv=(new Eu).add(kP.ShapeLeft,vx.onShapeLeftKeyword).add(kP.ShapeTop,vx.onShapeTopKeyword).add(kP.ShapeBottom,vx.onShapeBottomKeyword).add(kP.ShapeRight,vx.onShapeRightKeyword).add(kP.ShapeLid,vx.onShapeId).add(kP.ShapeZOrder,vx.onShapeZOrderKeyword).add(kP.ShapeLegacyHorizontalPositionTypePage,vx.onShapeHorizontalPositionTypePageKeyword).add(kP.ShapeLegacyHorizontalPositionTypeMargin,vx.onShapeHorizontalPositionTypeMarginKeyword).add(kP.ShapeLegacyHorizontalPositionTypeColumn,vx.onShapeHorizontalPositionTypeColumnKeyword).add(kP.ShapeIgnoreLegacyHorizontalPositionType,vx.onShapeHorizontalPositionTypeIgnoreKeyword).add(kP.ShapeLegacyVerticalPositionTypePage,vx.onShapeVerticalPositionTypePageKeyword).add(kP.ShapeLegacyVerticalPositionTypeMargin,vx.onShapeVerticalPositionTypeMarginKeyword).add(kP.ShapeLegacyVerticalPositionTypeParagraph,vx.onShapeVerticalPositionTypeParagraphKeyword).add(kP.ShapeIgnoreLegacyVerticalPositionType,vx.onShapeVerticalPositionTypeIgnoreKeyword).add(kP.ShapeWrapTextType,vx.onShapeWrapTextTypeKeyword).add(kP.ShapeWrapTextSide,vx.onShapeWrapTextSideKeyword).add(kP.ShapeWrapTextTypeZOrder,vx.onShapeWrapTextTypeZOrderKeyword).add(kP.ShapeLocked,vx.onShapeLockedKeyword).add(kP.ShapeText,vx.onShapeTextKeyword).add("sp",vx.onShapePropertyKeyword).add("shprslt",vx.onShapeResultKeyword).add("bin",vy.onBinKeyword).get();class mv{calculateHash(){return rn.StringUtils.stringHashCode(this.name)^P.MathUtils.somePrimes[0]*this.statusTextType}equals(e){return e&&this.name==e.name&&this.enabled==e.enabled&&this.calculateOnExit==e.calculateOnExit&&this.helpTextType==e.helpTextType&&this.helpText==e.helpText&&this.statusTextType==e.statusTextType&&this.statusText==e.statusText&&this.entryMacro==e.entryMacro&&this.exitMacro==e.exitMacro}getHashCode(){return void 0===this.hash?this.hash=this.calculateHash():this.hash}copyFrom(e){e.name=this.name,e.enabled=this.enabled,e.calculateOnExit=this.calculateOnExit,e.helpTextType=this.helpTextType,e.helpText=this.helpText,e.statusTextType=this.statusTextType,e.statusText=this.statusText,e.entryMacro=this.entryMacro,e.exitMacro=this.exitMacro,e.hash=this.hash}clone(){const e=new mv;return e.copyFrom(this),e}}var fv;!function(e){e[e.UseNone=0]="UseNone",e[e.UseName=4]="UseName",e[e.UseEnabled=8]="UseEnabled",e[e.UseCalculateOnExit=16]="UseCalculateOnExit",e[e.UseHelpTextType=32]="UseHelpTextType",e[e.UseHelpText=64]="UseHelpText",e[e.UseStatusTextType=128]="UseStatusTextType",e[e.UseStatusText=256]="UseStatusText",e[e.UseEntryMacro=512]="UseEntryMacro",e[e.UseExitMacro=1024]="UseExitMacro",e[e.UseAll=2147483647]="UseAll"}(fv||(fv={}));class bv extends XT{get destinationType(){return Jw.HexContentDestination}afterPopRtfState(){const e=rn.StringUtils.trim(this.value);rn.StringUtils.isNullOrEmpty(e)||this.assignBookmarkPosition(this.importer.importers.bookmark.getBookmarkByName(e))}}class Cv extends bv{get destinationType(){return Jw.BookmarkEndDestination}createEmptyClone(){return new Cv(this.importer)}assignBookmarkPosition(e){e.end=this.importer.importers.character.logPosition}}class Sv extends bv{get destinationType(){return Jw.BookmarkStartDestination}createEmptyClone(){return new Sv(this.importer)}assignBookmarkPosition(e){e.start=this.importer.importers.character.logPosition}}class Iv extends zy{constructor(){super(...arguments),this.isNameRead=!0}get destinationType(){return Jw.DocumentVariableDestination}createEmptyClone(){return new Iv(this.importer)}afterPopRtfState(){super.afterPopRtfState(),rn.StringUtils.isNullOrEmpty(this.name)||rn.StringUtils.isNullOrEmpty(this.ownValue)||this.importer.documentModel.docVariables.addValue(this.name,this.ownValue)}nestedGroupFinished(e){if(super.nestedGroupFinished(e),!(e instanceof Iv))return;const t=rn.StringUtils.trim(e.value);this.isNameRead?(this.name=t,this.isNameRead=!1):this.ownValue=t}}class Pv extends cv{get destinationType(){return Jw.DestinationOldSectionNumberingLevel}constructor(e,t){super(e),e.importers.numbering.oldListLevelInfo=new uT,this.levelNumber=t}createClone(){return new Pv(this.importer,this.levelNumber)}beforePopRtfState(){super.beforePopRtfState(),this.importer.importers.numbering.oldListLevelInfoCollection.getByIndex(this.levelNumber).copyFrom(this.createRtfOldListLevelInfo())}createRtfOldListLevelInfo(){return new uT}}class wv{static createPredefinedUserGroups(){return(new Eu).add(65530,Dd.Current_GROUP_NAME).add(65531,Dd.Editors_GROUP_NAME).add(65532,Dd.Owners_GROUP_NAME).add(65533,Dd.Contributors_GROUP_NAME).add(65534,Dd.Administrators_GROUP_NAME).add(65535,Dd.Everyone_GROUP_NAME).get()}}wv.predefinedUserGroups=wv.createPredefinedUserGroups();class yv extends $x{constructor(){super(),this.columnFirst=-1,this.columnLast=-1}validate(e){return(!rn.StringUtils.isNullOrEmpty(this.userName)||!rn.StringUtils.isNullOrEmpty(this.group))&&(!(this.end-this.start<0)&&((!(this.columnFirst>=0||this.columnLast>=0)||!(this.columnFirst<0||this.columnLast<0||null==Ja))&&super.validate(e)))}}class xv extends zy{get destinationType(){return Jw.RangePermissionDestinationBase}afterPopRtfState(){const e=rn.StringUtils.trim(this.value);if(!rn.StringUtils.isNullOrEmpty(e)&&16==e.length){let t=this.importer.importers.rangePermission.rangePermissions[e];t||(t=new yv,t.userName=this.obtainUserName(e),t.group=this.obtainGroupName(e),this.importer.importers.rangePermission.rangePermissions[e]=t),this.assignRangePermissionPosition(t)}}obtainUserName(e){const t=this.obtainUserId(e);return this.importer.importers.rangePermission.getUserNameById(t)}obtainGroupName(e){const t=this.obtainUserId(e);let r=wv.predefinedUserGroups[t];return null!=r?r:""}obtainUserId(e){const t=parseInt(e.substr(0,2),16);if(isNaN(t))return Bo.Constants.MIN_SAFE_INTEGER;const r=parseInt(e.substr(2,2),16);return isNaN(r)?Bo.Constants.MIN_SAFE_INTEGER:r<<8|t}}class Tv extends xv{get destinationType(){return Jw.RangePermissionEndDestination}createEmptyClone(){return new Tv(this.importer)}assignRangePermissionPosition(e){e.end=this.importer.importers.character.logPosition+1}}class vv extends xv{get destinationType(){return Jw.RangePermissionStartDestination}createEmptyClone(){return new vv(this.importer)}assignRangePermissionPosition(e){e.start=this.importer.importers.character.logPosition}}const Mv=(new Eu).add("trowd",xx.onTableRowDefaultsKeyword).add("ts",xx.onTableStyleKeyword).add("cellx",xx.onCellxKeyword).add("clwWidth",xx.onCellPreferredWidthKeyword).add("clftsWidth",xx.onWidthUnitTypeKeyword).add("clmgf",xx.onFirstHorizontalMergedCellKeyword).add("clmrg",xx.onNextHorizontalMergedCellKeyword).add("clvmgf",xx.onFirstVerticalMergedCellKeyword).add("clvmrg",xx.onNextVerticalMergedCellKeyword).add("clFitText",xx.onCellFitTextKeyword).add("clNoWrap",xx.onCellNoWrapKeyword).add("tsvertalt",xx.onCellVerticalAlignmentTopKeyword).add("tsvertalc",xx.onCellVerticalAlignmentCenterKeyword).add("tsvertalb",xx.onCellVerticalAlignmentBottomKeyword).add("clhidemark",xx.onCellHideMarkKeyword).add("clpadb",xx.onCellBottomCellMarginKeyword).add("clpadl",xx.onCellLeftCellMarginKeyword).add("clpadr",xx.onCellRightCellMarginKeyword).add("clpadt",xx.onCellTopCellMarginKeyword).add("clpadfb",xx.onCellBottomCellMarginUnitTypeKeyword).add("clpadfl",xx.onCellLeftCellMarginUnitTypeKeyword).add("clpadfr",xx.onCellRightCellMarginUnitTypeKeyword).add("clpadft",xx.onCellTopCellMarginUnitTypeKeyword).add("clvertalt",xx.onCellTextTopAlignmentKeyword).add("clvertalc",xx.onCellTextCenterVerticalAlignmentKeyword).add("clvertalb",xx.onCellTextBottomAlignmentKeyword).add("cltxlrtb",xx.onCellLeftToRightTopToBottomTextDirectionKeyword).add("cltxtbrl",xx.onCellTopToBottomRightToLeftTextDirectionKeyword).add("cltxbtlr",xx.onCellBottomToTopLeftToRightTextDirectionKeyword).add("cltxlrtbv",xx.onCellLeftToRightTopToBottomVerticalTextDirectionKeyword).add("cltxtbrlv",xx.onCellTopToBottomRightToLeftVerticalTextDirectionKeyword).add("clcbpat",xx.onCellBackgroundColorKeyword).add("clcbpatraw",xx.onCellBackgroundColorKeyword).add("tscellcbpat",xx.onCellBackgroundColorKeyword).add("clcfpat",xx.onCellForegroundColorKeyword).add("clcfpatraw",xx.onCellForegroundColorKeyword).add("clshdng",xx.onCellShadingKeyword).add("clshdngraw",xx.onCellShadingKeyword).add("clshdrawnil",xx.onCellNoShadingKeyword).add("clbghoriz",xx.onCellHorizontalBackgroundPatternKeyword).add("rawclbghoriz",xx.onCellHorizontalBackgroundPatternKeyword).add("clbgvert",xx.onCellVerticalBackgroundPatternKeyword).add("rawclbgvert",xx.onCellVerticalBackgroundPatternKeyword).add("clbgfdiag",xx.onCellForwardDiagonalBackgroundPatternKeyword).add("rawclbgfdiag",xx.onCellForwardDiagonalBackgroundPatternKeyword).add("clbgbdiag",xx.onCellBackwardDiagonalBackgroundPatternKeyword).add("rawclbgbdiag",xx.onCellBackwardDiagonalBackgroundPatternKeyword).add("clbgcross",xx.onCellCrossBackgroundPatternKeyword).add("rawclbgcross",xx.onCellCrossBackgroundPatternKeyword).add("clbgdcross",xx.onCellDiagonalCrossBackgroundPatternKeyword).add("rawclbgdcross",xx.onCellDiagonalCrossBackgroundPatternKeyword).add("clbgdkhor",xx.onCellDarkHorizontalBackgroundPatternKeyword).add("rawclbgdkhor",xx.onCellDarkHorizontalBackgroundPatternKeyword).add("clbgdkvert",xx.onCellDarkVerticalBackgroundPatternKeyword).add("rawclbgdkvert",xx.onCellDarkVerticalBackgroundPatternKeyword).add("clbgdkfdiag",xx.onCellDarkForwardDiagonalBackgroundPatternKeyword).add("rawclbgdkfdiag",xx.onCellDarkForwardDiagonalBackgroundPatternKeyword).add("clbgdkbdiag",xx.onCellDarkBackwardDiagonalBackgroundPatternKeyword).add("rawclbgdkbdiag",xx.onCellDarkBackwardDiagonalBackgroundPatternKeyword).add("clbgdkcross",xx.onCellDarkCrossBackgroundPatternKeyword).add("rawclbgdkcross",xx.onCellDarkCrossBackgroundPatternKeyword).add("clbgdkdcross",xx.onCellDarkDiagonalCrossBackgroundPatternKeyword).add("rawclbgdkdcross",xx.onCellDarkDiagonalCrossBackgroundPatternKeyword).add("tscellcfpat",xx.onCellForegroundColorKeyword).add("tscellpct",xx.onCellShadingKeyword).add("tsbgbdiag",xx.onCellBackwardDiagonalBackgroundPatternKeyword).add("tsbgfdiag",xx.onCellForwardDiagonalBackgroundPatternKeyword).add("tsbgdkbdiag",xx.onCellDarkBackwardDiagonalBackgroundPatternKeyword).add("tsbgdkfdiag",xx.onCellDarkForwardDiagonalBackgroundPatternKeyword).add("tsbgcross",xx.onCellCrossBackgroundPatternKeyword).add("tsbgdcross",xx.onCellDiagonalCrossBackgroundPatternKeyword).add("tsbgdkcross",xx.onCellDarkCrossBackgroundPatternKeyword).add("tsbgdkdcross",xx.onCellDarkDiagonalCrossBackgroundPatternKeyword).add("tsbghoriz",xx.onCellHorizontalBackgroundPatternKeyword).add("tsbgvert",xx.onCellVerticalBackgroundPatternKeyword).add("tsbgdkhor",xx.onCellDarkHorizontalBackgroundPatternKeyword).add("tsbgdkvert",xx.onCellDarkVerticalBackgroundPatternKeyword).add("brdrtbl",xx.onNoTableBorderKeyword).add("clbrdrb",xx.onBottomCellBorderKeyword).add("clbrdrt",xx.onTopCellBorderKeyword).add("clbrdrl",xx.onLeftCellBorderKeyword).add("clbrdrr",xx.onRightCellBorderKeyword).add("cldglu",xx.onUpperLeftToLowerRightBorderKeyword).add("cldgll",xx.onUpperRightToLowerLeftBorderKeyword).add("trleft",xx.onRowLeftKeyword).add("trhdr",xx.onRowHeaderKeyword).add("trrh",xx.onRowHeightKeyword).add("trkeep",xx.onRowKeepKeyword).add("trqr",xx.onTableRightAlignmentKeyword).add("trql",xx.onTableLeftAlignmentKeyword).add("trqc",xx.onTableCenterAlignmentKeyword).add("trwWidthB",xx.onWidthBeforeKeyword).add("trftsWidthB",xx.onWidthBeforeUnitTypeKeyword).add("trwWidthA",xx.onWidthAfterKeyword).add("trftsWidthA",xx.onWidthAfterUnitTypeKeyword).add("trcbpat",xx.onRowBackgroundColorKeyword).add("trcfpat",xx.onRowForegroundColorKeyword).add("trpat",xx.onRowPatternKeyword).add("trshdng",xx.onRowShadingKeyword).add("trbgbdiag",xx.onRowBackwardDiagonalPatternKeyword).add("trbgcross",xx.onRowCrossPatternKeyword).add("trbgdcross",xx.onRowDiagonalCrossPatternKeyword).add("trbgdkbdiag",xx.onRowDarkBackwardDiagonalPatternKeyword).add("trbgdkcross",xx.onRowDarkCrossPatternKeyword).add("trbgdkdcross",xx.onRowDarkDiagonalCrossPatternKeyword).add("trbgdkfdiag",xx.onRowDarkForwardDiagonalPatternKeyword).add("trbgdkhor",xx.onRowDarkHorizontalPatternKeyword).add("trbgdkvert",xx.onRowDarkVerticalPatternKeyword).add("trbgfdiag",xx.onRowForwardDiagonalPatternKeyword).add("trbghoriz",xx.onRowHorizontalPatternKeyword).add("trbgvert",xx.onRowVerticalPatternKeyword).add("trgaph",xx.onSpaceBetweenCellsKeyword).add("trpaddb",xx.onTableBottomCellMarginKeyword).add("trpaddl",xx.onTableLeftCellMarginKeyword).add("trpaddr",xx.onTableRightCellMarginKeyword).add("trpaddt",xx.onTableTopCellMarginKeyword).add("trpaddfb",xx.onTableBottomCellMarginUnitTypeKeyword).add("trpaddfl",xx.onTableLeftCellMarginUnitTypeKeyword).add("trpaddfr",xx.onTableRightCellMarginUnitTypeKeyword).add("trpaddft",xx.onTableTopCellMarginUnitTypeKeyword).add("trspdb",xx.onTableBottomCellSpacingKeyword).add("trspdl",xx.onTableLeftCellSpacingKeyword).add("trspdr",xx.onTableRightCellSpacingKeyword).add("trspdt",xx.onTableTopCellSpacingKeyword).add("trspdfb",xx.onTableBottomCellSpacingUnitTypeKeyword).add("trspdfl",xx.onTableLeftCellSpacingUnitTypeKeyword).add("trspdfr",xx.onTableRightCellSpacingUnitTypeKeyword).add("trspdft",xx.onTableTopCellSpacingUnitTypeKeyword).add("trwWidth",xx.onTablePreferredWidthKeyword).add("trftsWidth",xx.onTablePreferredWidthUnitTypeKeyword).add("tblind",xx.onTableIndentKeyword).add("tblindtype",xx.onTableIndentUnitType).add("tabsnoovrlp",xx.onTableOverlapKeyword).add("tdfrmtxtLeft",xx.onTableLeftFromTextKeyword).add("tdfrmtxtRight",xx.onTableRightFromTextKeyword).add("tdfrmtxtTop",xx.onTableTopFromTextKeyword).add("tdfrmtxtBottom",xx.onTableBottomFromTextKeyword).add("tphcol",xx.onColHorizontalAnchorKeyword).add("tphmrg",xx.onMarginHorizontalAnchorKeyword).add("tphpg",xx.onPageHorizontalAnchorKeyword).add("tpvmrg",xx.onMarginVerticalAnchorKeyword).add("tpvpara",xx.onParagraphVerticalAnchorKeword).add("tpvpg",xx.onPageVerticalAnchorKeyword).add("tposx",xx.onTableHorizontalPositionKeyword).add("tposnegx",xx.onTableHorizontalPositionKeyword).add("tposy",xx.onTableVerticalPositionKeyword).add("tposnegy",xx.onTableVerticalPositionKeyword).add("tposxc",xx.onCenterTableHorizontalAlignKeyword).add("tposxi",xx.onInsideTableHorizontalAlignKeyword).add("tposxl",xx.onLeftTableHorizontalAlignKeyword).add("tposxo",xx.onOutsideTableHorizontalAlignKeyword).add("tposxr",xx.onRightTableHorizontalAlignKeyword).add("tposyb",xx.onBottomTableVerticalAlignKeyword).add("tposyc",xx.onCenterTableVerticalAlignKeyword).add("tposyil",xx.onInlineTableVerticalAlignKeyword).add("tposyin",xx.onInsideTableVerticalAlignKeyword).add("tposyout",xx.onOutsideTableVerticalAlignKeyword).add("tposyt",xx.onTopTableVerticalAlignKeyword).add("trautofit",xx.onTableAutoFitKeyword).add("tscbandsh",xx.onRowBandSizeKeyword).add("tscbandsv",xx.onColumnBandSizeKeyword).add("tsbrdrt",xx.onTopCellBorderKeyword).add("tsbrdrl",xx.onLeftCellBorderKeyword).add("tsbrdrb",xx.onBottomCellBorderKeyword).add("tsbrdrr",xx.onRightCellBorderKeyword).add("tsnowrap",xx.onCellNoWrapKeyword).add("tscellpaddb",xx.onTableBottomCellMarginKeyword).add("tscellpaddl",xx.onTableLeftCellMarginKeyword).add("tscellpaddr",xx.onTableRightCellMarginKeyword).add("tscellpaddt",xx.onTableTopCellMarginKeyword).add("tscellpaddfb",xx.onTableBottomCellMarginUnitTypeKeyword).add("tscellpaddfl",xx.onTableLeftCellMarginUnitTypeKeyword).add("tscellpaddfr",xx.onTableRightCellMarginUnitTypeKeyword).add("tscellpaddft",xx.onTableTopCellMarginUnitTypeKeyword).add("tsbrdrdgl",xx.onUpperLeftToLowerRightBorderKeyword).add("tsbrdrdgr",xx.onUpperRightToLowerLeftBorderKeyword).add("tsrowd",xx.onTableRowDefaultsKeyword).add("trbrdrt",xx.onTopTableBorderKeyword).add("trbrdrl",xx.onLeftTableBorderKeyword).add("trbrdrb",xx.onBottomTableBorderKeword).add("trbrdrr",xx.onRightTableBorderKeyword).add("trbrdrh",xx.onHorizontalTableBorderKeyword).add("trbrdrv",xx.onVerticalTableBorderKeyword).add("tbllkhdrrows",xx.onApplyFirstRowConditionalFormattingKeyword).add("tbllklastrow",xx.onApplyLastRowConditionalFormattingKeyword).add("tbllkhdrcols",xx.onApplyFirstColumnContitionalFormattingKeyword).add("tbllklastcol",xx.onApplyLastColumnConditionalFormattingKeyword).add("tbllknorowband",xx.onDoNotApplyRowBandingConditionalFormattingKeyword).add("tbllknocolband",xx.onDoNotApplyColumnBandingConditionalFormattingKeyword).add("ltrrow",xx.onLtrRow).add("rtlrow",xx.onRtlRow).add("brdrnil",xx.onNoBorderKeyword).add("brdrw",xx.onBorderWidthKeyword).add("brdrcf",xx.onBorderColorKeyword).add("brdrframe",xx.onFrameBorderKeyword).add("brsp",xx.onBorderSpaceKeyword).add("brdrs",xx.onSingleThicknessBorderTypeKeyword).add("brdrth",xx.onDoubleThicknessBorderTypeKeyword).add("brdrsh",xx.onShadowedBorderTypeKeyword).add("brdrdb",xx.onDoubleBorderTypeKeyword).add("brdrdot",xx.onDottedBorderTypeKeyword).add("brdrdash",xx.onDashedBorderTypeKeyword).add("brdrhair",xx.onHairlineBorderTypeKeyword).add("brdrdashsm",xx.onSmallDashedBorderTypeKeyword).add("brdrdashd",xx.onDotDashedBorderTypeKeyword).add("brdrdashdd",xx.onDotDotDashedBorderTypeKeyword).add("brdrdashdot",xx.onDotDashedBorderTypeKeyword).add("brdrdashdotdot",xx.onDotDotDashedBorderTypeKeyword).add("brdrinset",xx.onInsetBorderTypeKeyword).add("brdrnone",xx.onNoneBorderTypeKeyword).add("brdroutset",xx.onOutsetBorderTypeKeyword).add("brdrtriple",xx.onTripletBorderTypeKeyword).add("brdrthtnsg",xx.onSmallThickThinBorderTypeKeyword).add("brdrtnthsg",xx.onSmallThinThickBorderTypeKeyword).add("brdrtnthtnsg",xx.onSmallThinThickThinBorderTypeKeyword).add("brdrthtnmg",xx.onMediumThickThinBorderTypeKeyword).add("brdrtnthmg",xx.onMediumThinThickBorderTypeKeyword).add("brdrtnthtnmg",xx.onMediumThinThickThinBorderTypeKeyword).add("brdrthtnlg",xx.onLargeThickThinBorderTypeKeyword).add("brdrtnthlg",xx.onLargeThinThickBorderTypeKeyword).add("brdrtnthtnlg",xx.onLargeThinThickThinBorderTypeKeyword).add("brdrwavy",xx.onWavyBorderTypeKeyword).add("brdrwavydb",xx.onDoubleWavyBorderTypeKeyword).add("brdrdashdotstr",xx.onStripedBorderTypeKeyword).add("brdremboss",xx.onEmbossedBorderTypeKeyword).add("brdrengrave",xx.onEngravedBorderTypeKeyword).add("brdrart",xx.onBorderArtIndex).get(),Ev=(new Eu).add("intbl",xx.onInTableParagraphKeyword).add("row",xx.onRowKeyword).add("cell",xx.onCellKeyword).add("nestcell",xx.onNestedCellKeyword).add("nestrow",xx.onNestedRowKeyword).add("nesttableprops",xx.onNestedTablePropertiesKeyword).add("nonesttables",(e=>e.destination=new ev(e))).add("itap",xx.onItapKeyword).append(Mv).get(),Dv=(new Eu).add("pict",(e=>e.destination=new dx(e))).add("shp",xx.onShapeKeyword).add("shppict",xx.onShapePictureKeyword).add("nonshppict",xx.onNonShapePictureKeyword).add(kP.ShapeGroup,xx.onShapeGroupKeyword).add("line",xx.onLineBreakKeyword).add("u",xx.onUnicodeKeyword).add("tab",xx.onTabKeyword).add("emdash",xx.onEmDashKeyword).add("endash",xx.onEnDashKeyword).add("lquote",xx.onLeftSingleQuoteKeyword).add("rquote",xx.onRightSingleQuoteKeyword).add("ldblquote",xx.onLeftDoubleQuoteKeyword).add("rdblquote",xx.onRightDoubleQuoteKeyword).add("bullet",xx.onBulletKeyword).add("emspace",xx.onEmSpaceKeyword).add("enspace",xx.onEnSpaceKeyword).add("qmspace",xx.onQmSpaceKeyword).add("field",xx.onFieldStartKeyword).add("formfield",(e=>{e.importers.field.fields.count>0&&(e.importers.field.fields.peek().formFieldProperties=new mv,e.destination=new YT(e))})).add("tc",xx.onTableOfContentsEntryKeyword).add("tcl",xx.onTableOfContentsEntryLevelNumberKeyword).add("tcf",xx.onTableOfContentsEntryTypeTableKeyword).add("mailmerge",(e=>e.destination=new ZT(e))).add("bkmkstart",(e=>e.destination=new Sv(e))).add("bkmkend",(e=>e.destination=new Cv(e))).add("protstart",(e=>e.destination=new vv(e))).add("protend",(e=>e.destination=new Tv(e))).add("docvar",(e=>e.destination=new Iv(e))).add("dxcustomrundata",xx.onDxCustomRunDataKeyword).add("zwj",xx.onZeroWidthJoiner).add("zwnj",xx.onZeroWidthNonJoiner).add("zwbo",xx.onZeroWidthBreakOpportunity).add("zwnbo",xx.onZeroWidthNonBreakOpportunity).get(),Fv=(new Eu).add("ls",xx.onListOverride).add("ilvl",xx.onListLevel).add("listtext",xx.onListText).add("pntext",xx.onListText).add("pnseclvl",((e,t)=>e.destination=new Pv(e,t))).add("pn",(e=>e.destination=new hv(e))).add("pntxta",(e=>e.destination=new Ix(e))).add("pntxtb",(e=>e.destination=new Px(e))).get(),Rv=(new Eu).add("tqr",xx.onTabRightKeyword).add("tqc",xx.onTabCenterKeyword).add("tqdec",xx.onTabDecimalKeyword).add("tldot",xx.onTabLeaderDotsKeyword).add("tlmdot",xx.onTabLeaderMiddleDotsKeyword).add("tlhyph",xx.onTabLeaderHyphensKeyword).add("tlul",xx.onTabLeaderUnderlineKeyword).add("tlth",xx.onTabLeaderThickLineKeyword).add("tleq",xx.onTabLeaderEqualSignKeyword).add("tx",xx.onTabPositionKeyword).add("tb",xx.onBarTabKeyword).get(),Lv=(new Eu).add("plain",xx.onPlainKeyword).add("cs",xx.onCharacterStyleIndex).append(tv).get(),Bv=(new Eu).add("par",xx.onParKeyword).add("pard",xx.onResetParagraphPropertiesKeyword).add("s",xx.onParagraphStyleIndex).add("yts",xx.onTableStyleIndexForRowOrCell).add("ltrpar",xx.onLeftToRightParagraphKeyword).add("rtlpar",xx.onRightToLeftParagraphKeyword).append(pv).get(),Av=(new Eu).append(Lv).append(Bv).append(Dv).append(Rv).append(Fv).append(Ev).get(),Nv=(new Eu).add("paperw",Vx.onPaperWidthKeyword).add("paperh",Vx.onPaperHeightKeyword).add("psz",Vx.onPaperSizeKeyword).add("landscape",Vx.onLandscapeKeyword).add("gutter",Vx.onGutterKeyword).add("margl",Vx.onLeftMarginKeyword).add("margr",Vx.onRightMarginKeyword).add("margt",Vx.onTopMarginKeyword).add("margb",Vx.onBottomMarginKeyword).add("rtlgutter",Vx.onGutterAtRight).add("pgnstart",Vx.onPageNumberingStart).add("facingp",Vx.onPageFacing).add("endnotes",Vx.onFootNotePlacementEndOfSection).add("enddoc",Vx.onFootNotePlacementEndOfDocument).add("ftntj",Vx.onFootNotePlacementBelowText).add("ftnbj",Vx.onFootNotePlacementPageBottom).add("ftnstart",Vx.onFootNoteNumberingStart).add("ftnrstpg",Vx.onFootNoteNumberingRestartEachPage).add("ftnrestart",Vx.onFootNoteNumberingRestartEachSection).add("ftnrstcont",Vx.onFootNoteNumberingRestartContinuous).add("ftnnar",Vx.onFootNoteNumberingDecimal).add("ftnnalc",Vx.onFootNoteNumberingLowerCaseLetter).add("ftnnauc",Vx.onFootNoteNumberingUpperCaseLetter).add("ftnnrlc",Vx.onFootNoteNumberingLowerCaseRoman).add("ftnnruc",Vx.onFootNoteNumberingUpperCaseRoman).add("ftnnchi",Vx.onFootNoteNumberingChicago).add("ftnnchosung",Vx.onFootNoteNumberingChosung).add("ftnncnum",Vx.onFootNoteNumberingDecimalEnclosedCircle).add("ftnndbar",Vx.onFootNoteNumberingDecimalFullWidth).add("ftnnganada",Vx.onFootNoteNumberingGanada).add("aendnotes",Vx.onEndNotePlacementEndOfSection).add("aenddoc",Vx.onEndNotePlacementEndOfDocument).add("aftntj",Vx.onEndNotePlacementBelowText).add("aftnbj",Vx.onEndNotePlacementPageBottom).add("aftnstart",Vx.onEndNoteNumberingStart).add("aftnrestart",Vx.onEndNoteNumberingRestartEachSection).add("aftnrstcont",Vx.onEndNoteNumberingRestartContinuous).add("aftnnar",Vx.onEndNoteNumberingDecimal).add("aftnnalc",Vx.onEndNoteNumberingLowerCaseLetter).add("aftnnauc",Vx.onEndNoteNumberingUpperCaseLetter).add("aftnnrlc",Vx.onEndNoteNumberingLowerCaseRoman).add("aftnnruc",Vx.onEndNoteNumberingUpperCaseRoman).add("aftnnchi",Vx.onEndNoteNumberingChicago).add("aftnnchosung",Vx.onEndNoteNumberingChosung).add("aftnncnum",Vx.onEndNoteNumberingDecimalEnclosedCircle).add("aftnndbar",Vx.onEndNoteNumberingDecimalFullWidth).add("aftnnganada",Vx.onEndNoteNumberingGanada).add("viewbksp",Vx.onDisplayBackgroundShape).get(),kv=(new Eu).add("nocolbal",Vx.onNoColumnBalance).add("alntblind",Vx.onDoNotAlignTableRowsIndependently).add("expshrtn",Vx.onDoNotExpandShiftReturn).add("spltpgpar",Vx.onSplitPageBreakAndParagraphMark).add("nogrowautofit",Vx.onAllowTablesToExtendIntoMargin).get(),Ov=(new Eu).add("formprot",Vx.onFormProtection).add("revprot",Vx.onRevisionProtection).add("annotprot",Vx.onAnnotationProtection).add("readprot",Vx.onReadOnlyProtection).add("enforceprot",Vx.onEnforceDocumentProtection).add("protlevel",Vx.onDocumentProtectionLevel).get(),_v=(new Eu).add("pgndec",Vx.onPageNumberingDecimal).add("pgnucrm",Vx.onPageNumberingUpperRoman).add("pgnlcrm",Vx.onPageNumberingLowerRoman).add("pgnucltr",Vx.onPageNumberingUpperLetter).add("pgnlcltr",Vx.onPageNumberingLowerLetter).add("pgnbidia",Vx.onPageNumberingArabicAbjad).add("pgnbidib",Vx.onPageNumberingArabicAlpha).add("pgnchosung",Vx.onPageNumberingChosung).add("pgncnum",Vx.onPageNumberingDecimalEnclosedCircle).add("pgndecd",Vx.onPageNumberingDecimalFullWidth).add("pgnganada",Vx.onPageNumberingGanada).add("pgnhindia",Vx.onPageNumberingHindiVowels).add("pgnhindib",Vx.onPageNumberingHindiConsonants).add("pgnhindic",Vx.onPageNumberingHindiNumbers).add("pgnhindid",Vx.onPageNumberingHindiDescriptive).add("pgnthaia",Vx.onPageNumberingThaiLetters).add("pgnthaib",Vx.onPageNumberingThaiNumbers).add("pgnthaic",Vx.onPageNumberingThaiDescriptive).add("pgnvieta",Vx.onPageNumberingVietnameseDescriptive).add("pgnhn",Vx.onPageNumberingChapterHeaderStyle).add("pgnhnsh",Vx.onPageNumberingChapterSeparatorHyphen).add("pgnhnsp",Vx.onPageNumberingChapterSeparatorPeriod).add("pgnhnsc",Vx.onPageNumberingChapterSeparatorColon).add("pgnhnsm",Vx.onPageNumberingChapterSeparatorEmDash).add("pgnhnsn",Vx.onPageNumberingChapterSeparatorEnDash).add("vertal",Vx.onVerticalTextAlignmentBottom).add("vertalb",Vx.onVerticalTextAlignmentBottom).add("vertalt",Vx.onVerticalTextAlignmentTop).add("vertalc",Vx.onVerticalTextAlignmentCenter).add("vertalj",Vx.onVerticalTextAlignmentJustify).add("pgnstarts",Vx.onSectionPageNumberingStart).add("pgncont",Vx.onSectionPageNumberingContinuous).add("pgnrestart",Vx.onSectionPageNumberingRestart).add("stextflow",Vx.onSectionTextFlow).add("linemod",Vx.onLineNumberingStep).add("linex",Vx.onLineNumberingDistance).add("linestarts",Vx.onLineNumberingStartingLineNumber).add("linerestart",Vx.onLineNumberingRestart).add("lineppage",Vx.onLineNumberingRestartOnEachPage).add("linecont",Vx.onLineNumberingContinuous).add("pgwsxn",Vx.onSectionPaperWidth).add("pghsxn",Vx.onSectionPaperHeight).add("lndscpsxn",Vx.onSectionLandscape).add("marglsxn",Vx.onSectionLeftMargin).add("margrsxn",Vx.onSectionRightMargin).add("margtsxn",Vx.onSectionTopMargin).add("margbsxn",Vx.onSectionBottomMargin).add("guttersxn",Vx.onSectionGutter).add("headery",Vx.onSectionHeaderOffset).add("footery",Vx.onSectionFooterOffset).add("binfsxn",Vx.onSectionFirstPagePaperSource).add("binsxn",Vx.onSectionOtherPagePaperSource).add("sectunlocked",Vx.onOnlyAllowEditingOfFormFields).add("cols",Vx.onSectionColumnCount).add("colsx",Vx.onSectionColumnSpace).add("colno",Vx.onSectionCurrentColumnIndex).add("colsr",Vx.onSectionCurrentColumnSpace).add("colw",Vx.onSectionCurrentColumnWidth).add("linebetcol",Vx.onSectionDrawVerticalSeparator).add("sbknone",Vx.onSectionBreakNone).add("sbkcol",Vx.onSectionBreakColumn).add("sbkpage",Vx.onSectionBreakPage).add("sbkeven",Vx.onSectionBreakEvenPage).add("sbkodd",Vx.onSectionBreakOddPage).add("sectd",Vx.onSectionDefault).add("sect",Vx.onNewSection).add("titlepg",Vx.onSectionDifferentFirstPage).add("header",Vx.onHeaderKeyword).add("headerl",Vx.onHeaderForLeftPagesKeyword).add("headerr",Vx.onHeaderForRightPagesKeyword).add("headerf",Vx.onHeaderForFirstPageKeyword).add("footer",Vx.onFooterKeyword).add("footerl",Vx.onFooterForLeftPagesKeyword).add("footerr",Vx.onFooterForRightPagesKeyword).add("footerf",Vx.onFooterForFirstPageKeyword).add("ltrsect",Vx.onLtrSectionKeyword).add("rtlsect",Vx.onRtlSectionKeyword).add("sftntj",Vx.onSectionFootNotePlacementBelowText).add("sftnbj",Vx.onSectionFootNotePlacementPageBottom).add("sftnstart",Vx.onSectionFootNoteNumberingStart).add("sftnrstpg",Vx.onSectionFootNoteNumberingRestartEachPage).add("sftnrestart",Vx.onSectionFootNoteNumberingRestartEachSection).add("sftnrstcont",Vx.onSectionFootNoteNumberingRestartContinuous).add("sftnnar",Vx.onSectionFootNoteNumberingDecimal).add("sftnnalc",Vx.onSectionFootNoteNumberingLowerCaseLetter).add("sftnnauc",Vx.onSectionFootNoteNumberingUpperCaseLetter).add("sftnnrlc",Vx.onSectionFootNoteNumberingLowerCaseRoman).add("sftnnruc",Vx.onSectionFootNoteNumberingUpperCaseRoman).add("sftnnchi",Vx.onSectionFootNoteNumberingChicago).add("sftnnchosung",Vx.onSectionFootNoteNumberingChosung).add("sftnncnum",Vx.onSectionFootNoteNumberingDecimalEnclosedCircle).add("sftnndbar",Vx.onSectionFootNoteNumberingDecimalFullWidth).add("sftnnganada",Vx.onSectionFootNoteNumberingGanada).add("saftnstart",Vx.onSectionEndNoteNumberingStart).add("saftnrestart",Vx.onSectionEndNoteNumberingRestartEachSection).add("saftnrstcont",Vx.onSectionEndNoteNumberingRestartContinuous).add("saftnnar",Vx.onSectionEndNoteNumberingDecimal).add("saftnnalc",Vx.onSectionEndNoteNumberingLowerCaseLetter).add("saftnnauc",Vx.onSectionEndNoteNumberingUpperCaseLetter).add("saftnnrlc",Vx.onSectionEndNoteNumberingLowerCaseRoman).add("saftnnruc",Vx.onSectionEndNoteNumberingUpperCaseRoman).add("saftnnchi",Vx.onSectionEndNoteNumberingChicago).add("saftnnchosung",Vx.onSectionEndNoteNumberingChosung).add("saftnncnum",Vx.onSectionEndNoteNumberingDecimalEnclosedCircle).add("saftnndbar",Vx.onSectionEndNoteNumberingDecimalFullWidth).add("saftnnganada",Vx.onSectionEndNoteNumberingGanada).add("linemod",Vx.onSectionLineNumberingCountBy).add("linex",Vx.onSectionLineNumberingDistance).add("linestarts",Vx.onSectionLineNumberingStart).add("linerestart",Vx.onSectionLineNumberingNewSection).add("lineppage",Vx.onSectionLineNumberingNewPage).add("linecont",Vx.onSectionLineNumberingContinuous).get(),Uv=(new Eu).add("footnote",Vx.onFootNoteKeyword).get(),Hv=(new Eu).add("atrfstart",Vx.onCommentStartPositionKeyword).add("atrfend",Vx.onCommentEndPositionKeyword).add("atnid",Vx.onCommentIdKeyword).add("atnauthor",Vx.onCommentAuthorKeyword).add("annotation",Vx.onCommentAnnotationKeyword).get(),Vv=(new Eu).add("rtf",(()=>{})).add("deff",Vx.onDeffKeyword).add("info",Vx.onInfoKeyword).add("userprops",Vx.onUserPropKeyword).add("stylesheet",(e=>e.destination=new Hx(e))).add("defchp",Vx.onDefaultCharacterPropertiesKeyword).add("defpap",Vx.onDefaultParagraphPropertiesKeyword).add("page",Vx.onPageBreakKeyword).add("column",Vx.onColumnBreakKeyword).add("deftab",Vx.onDefaultTabKeyword).add("margmirror",Vx.onMirrorMargins).add("rempersonalinfo",Vx.onRemovePersonalInformation).add("listtable",Vx.onListTableKeyword).add("listoverridetable",Vx.onListOverrideTableKeyword).add("background",Vx.onPageBackground).add("themedata",Vx.onThemeData).add("colorschememapping",Vx.onColorsSchemeMapping).add("nouicompat",Vx.onNoUICompat).add("nofeaturethrottle",Vx.onNoFeatureThrottle).append(Ov).append(Fv).append(Rv).append(kv).append(Lv).append(Bv).append(Ev).append(Nv).append(_v).append(Uv).append(Hv).append(Dv).get();class Wv{constructor(){this.stringValueDestinationKeywordHT=(new Eu).add("u",Wy.onUnicodeKeyword).get(),this.mapByDestinations=(new Eu).add(Jw.DestinationSubDocument,Av).add(Jw.SectionHeaderFooterDestinationBase,Av).add(Jw.SectionPageHeaderDestination,Av).add(Jw.SectionPageFooterDestination,Av).add(Jw.DefaultDestination,Vv).add(Jw.FieldSubDestination,Vv).add(Jw.CodeFieldDestination,Vv).add(Jw.ResultFieldDestination,Vv).add(Jw.TableContentFieldDestination,Vv).add(Jw.FormFieldDestination,(new Eu).add("fftype",YT.onFormFieldTypeKeyword).add("ffres",YT.onFormFieldListFieldResultKeyword).add("ffprot",YT.onFormFieldProtectedKeyword).add("ffsize",YT.onFormFieldCheckBoxFieldSizeTypeKeyword).add("ffrecalc",YT.onFormFieldCalculatedOnExitKeyword).add("ffhps",YT.onFormFieldCheckBoxFieldSizeKeyword).add("ffname",YT.onFormFieldNameKeyword).add("ffdefres",YT.onFormFieldListFieldDefaultKeyword).add("ffownhelp",YT.onFormFieldHelpTextCustomKeyword).add("ffhelptext",YT.onFormFieldHelpTextKeyword).add("ffownstat",YT.onFormFieldStatusBarTextCustomKeyword).add("ffstattext",YT.onFormFieldStatusBarTextKeyword).add("ffentrymcr",YT.onFormFieldEntryMacroKeyword).add("ffexitmcr",YT.onFormFieldExitMacroKeyword).get()).add(Jw.FieldDestination,(new Eu).add("fldinst",Xx.onFieldInstructionStartKeyword).add("fldrslt",Xx.onFieldResultStartKeyword).add("fldlock",Xx.onFieldLockKeyword).add("fldedit",Xx.onFieldEditKeyword).add("flddirty",Xx.onFieldDirtyKeyword).add("fldpriv",Xx.onFieldPrivateKeyword).add("dxfldcodeview",Xx.onFieldCodeViewKeyword).get()).add(Jw.SkipNestedTableDestination,(new Eu).add("par",ev.onParKeyword).get()).add(Jw.PictureDestination,(new Eu).add("emfblip",dx.onEmfFileKeyword).add("pngblip",dx.onPngFileKeyword).add("jpegblip",dx.onJpegFileKeyword).add("macpict",dx.onMacFileKeyword).add("wmetafile",dx.onWindowsMetafileKeyword).add("dibitmap",dx.onDeviceIndependentBitmapFileKeyword).add("wbitmap",dx.onDeviceDependentBitmapFileKeyword).add("wbmbitspixel",dx.onBitmapBitsPerPixelKeyword).add("wbmplanes",dx.onBitmapPlanesKeyword).add("wbmwidthbytes",dx.onBitmapBytesInLineKeyword).add("picw",dx.onPictureWidthKeyword).add("pich",dx.onPictureHeightKeyword).add("picwgoal",dx.onPictureGoalWidthKeyword).add("pichgoal",dx.onPictureGoalHeightKeyword).add("picscalex",dx.onHorizontalScalingKeyword).add("picscaley",dx.onVerticalScalingKeyword).add("picscaled",dx.onPicScaledKeyword).add("piccropt",dx.onTopCropKeyword).add("piccropb",dx.onBottomCropKeyword).add("piccropr",dx.onRightCropKeyword).add("piccropl",dx.onLeftCropKeyword).add("picbmp",dx.onBitmapMetafileKeyword).add("picbpp",dx.onBitsPerPixelBitmapMetafileKeyword).add("dximageuri",dx.onDxImageUri).add("picprop",dx.onShapePropertiesKeyword).add("bliptag",dx.onBlipTag).add("sp",dx.onShapePropertyKeyword).get()).add(Jw.PageBackgroundDestination,(new Eu).add("shp",(e=>e.destination=new Mx(e))).get()).add(Jw.CustomPropertiesDestination,(new Eu).add("propname",Ry.onPropname).add("proptype",Ry.onProptType).add("linkval",Ry.onLinkval).add("staticval",Ry.onStaticval).get()).add(Jw.StyleSheetDestination,(new Eu).add("s",Hx.onParagraphStyle).add("sqformat",Hx.onStyleQFormatKeyword).add("sbasedon",Hx.onParentStyleIndex).add("cs",Hx.onCharacterStyle).add("ts",Hx.onTableStyle).add("slink",Hx.onStyleLinkKeyword).add("snext",Hx.onNextStyleIndex).add("ls",Hx.onStyleListOverride).add("ilvl",Hx.onStyleListLevel).append(pv).append(tv).append(Rv).get()).add(Jw.CharacterStyleDestination,(new Eu).add("sbasedon",_x.onParentStyleIndex).add("slink",_x.onStyleLinkKeyword).add("sqformat",_x.onStyleQFormatKeyword).append(tv).get()).add(Jw.TableStyleDestination,(new Eu).add("sbasedon",Ux.onParentStyleIndex).add("sqformat",Ux.onStyleQFormatKeyword).add("tscfirstrow",Ux.onConditionalStyleFirstRow).add("tsclastrow",Ux.onConditionalStyleLastRow).add("tscfirstcol",Ux.onConditionalStyleFirstColumn).add("tsclastcol",Ux.onConditionalStyleLastColumn).add("tscbandhorzodd",Ux.onConditionalStyleOddRowBanding).add("tscbandhorzeven",Ux.onConditionalStyleEvenRowBanding).add("tscbandvertodd",Ux.onConditionalStyleOddColumnBanding).add("tscbandverteven",Ux.onConditionalStyleEvenColumnBanding).add("tscnwcell",Ux.onConditionalStyleTopLeftCell).add("tscnecell",Ux.onConditionalStyleTopRightCell).add("tscswcell",Ux.onConditionalStyleBottomLeftCell).add("tscsecell",Ux.onConditionalStyleBottomRightCell).append(tv).append(pv).append(Mv).get()).add(Jw.DefaultParagraphPropertiesDestination,pv).add(Jw.DefaultCharacterPropertiesDestination,tv).add(Jw.ShapePropertyValueDestination,(new Eu).add("pict",(e=>e.destination=new dx(e))).add("hl",(e=>e.destination=new px(e))).get()).add(Jw.ShapeTextDestination,(new Eu).append(Lv).append(Bv).append(Dv).append(Rv).append(Fv).append(Ev).add("stylesheet",(e=>e.destination=new Hx(e))).get()).add(Jw.ShapePropertyHyperlinkDestination,(new Eu).add("hlloc",(e=>e.destination=new hx(e))).add("hlsrc",(e=>e.destination=new ux(e))).get()).add(Jw.ShapePropertyHsvValueDestination,(new Eu).add(kP.Accent1,rx.onAccentOneKeyword).add(kP.Accent2,rx.onAccentTwoKeyword).add(kP.Accent3,rx.onAccentThreeKeyword).add(kP.Accent4,rx.onAccentFourKeyword).add(kP.Accent5,rx.onAccentFiveKeyword).add(kP.Accent6,rx.onAccentSixKeyword).add(kP.Tint,rx.onTintKeyword).add(kP.Shade,rx.onShadeKeyword).get()).add(Jw.ShapePropertyDestination,(new Eu).add("bin",vy.onBinKeyword).add("sn",(e=>e.destination=new ix(e))).add("sv",(e=>e.destination=new gx(e))).add("hsv",(e=>e.destination=new rx(e))).get()).add(Jw.ShapePropertiesDestinationBase,gv).add(Jw.ShapeInstanceDestination,gv).add(Jw.ShapeDestination,(new Eu).append(gv).add(kP.ShapeInstance,Kx.onShapeInstanceKeyword).get()).add(Jw.ListTableDestination,(new Eu).add("list",Yy.onListKeyword).add("listid",Yy.onListIdKeyword).add("listtemplateid",Yy.onListTemplateIdKeyword).add("liststyleid",Yy.onListStyleIdKeyword).add("liststylename",Yy.onListStyleNameKeyword).add("listname",Yy.onListNameKeyword).add("listhybrid",Yy.onListHybridKeyword).add("listrestarthdn",Yy.onListRestartAtEachSectionKeyword).add("listsimple",Yy.onListSimpleKeyword).add("listlevel",Yy.onListLevelKeyword).get()).add(Jw.ListOverrideTableDestination,(new Eu).add("listoverride",qy.onListOverrideKeyword).add("listid",qy.onListOverrideListIdKeyword).add("listoverridecount",qy.onListOverrideCountKeyword).add("ls",qy.onListOverrideIdKeyword).add("lfolevel",qy.onListOverrideLevelKeyword).get()).add(Jw.ListOverrideLevelDestination,(new Eu).add("listoverrideformat",Ky.onListOverrideFormatKeyword).add("listoverridestartat",Ky.onListOverrideStartAtKeyword).add("levelstartat",Ky.onListOverrideStartAtValueKeyword).add("listlevel",Ky.onListOverrideListLevelKeyword).get()).add(Jw.ListLevelDestination,(new Eu).add("levelstartat",Gy.onListLevelStartAtKeyword).add("lvltentative",Gy.onListLevelTentativeKeyword).add("levelnfc",Gy.onListLevelNumberingFormatKeyword).add("leveljc",Gy.onListLevelAlignmentKeyword).add("levelnfcn",Gy.onListLevelNumberingFormatKeyword).add("leveljcn",Gy.onListLevelAlignmentKeyword).add("levelold",Gy.onListLevelOldKeyword).add("levelprev",Gy.onListLevelPrevKeyword).add("levelprevspace",Gy.onListLevelPrevspaceKeyword).add("levelindent",Gy.onListLevelIndentKeyword).add("levelspace",Gy.onListLevelSpaceKeyword).add("leveltext",Gy.onListLevelTextKeyword).add("levelnumbers",Gy.onListLevelNumbersKeyword).add("levelfollow",Gy.onListLevelFollowKeyword).add("levellegal",Gy.onListLevelLegalKeyword).add("levelnorestart",Gy.onListLevelNoRestartKeyword).add("levelpicture",Gy.onListLevelPictureKeyword).add("levelpicturenosize",Gy.onListLevelPictureNoSizeKeyword).add("s",Gy.onParagraphStyleKeyword).append(pv).append(tv).get()).add(Jw.DestinationOldSectionNumberingLevel,uv).add(Jw.DestinationOldParagraphNumbering,uv).add(Jw.InfoDestination,(new Eu).add("password",ky.onLegacyPasswordHash).add("passwordhash",ky.onPasswordHash).append(dv).get()).add(Jw.MailMergeDestination,{mmconnectstr:ZT.onConnectionStringKeyword,mmquery:ZT.onQueryKeyword,mmdatasource:ZT.onDataSourceKeyword,mmodsofldmpdata:ZT.onFieldMapDataKeyword}).add(Jw.FieldMapDataDestination,{mmfttypenull:zT.onNullFieldTypeKeyword,mmfttypedbcolumn:zT.onColumnFieldTypeKeyword,mmfttypeaddress:zT.onAddressFieldTypeKeyword,mmfttypesalutation:zT.onSalutationFieldTypeKeyword,mmfttypemapped:zT.onMappedFieldTypeKeyword,mmfttypebarcode:zT.onBarcodeFieldTypeKeyword,mmodsoname:zT.onColumnNameKeyword,mmodsomappedname:zT.onMappedNameKeyword,mmodsofmcolumn:zT.onColumnIndexKeyword,mmodsodynaddr:zT.onDynamicAddressKeyword,mmodsolid:zT.onLanguageIdKeyword}).add(Jw.SkipDestination,{bin:vy.onBinKeyword}).add(Jw.StringValueDestination,this.stringValueDestinationKeywordHT).add(Jw.UnicodeDestination,{ud:HT.onUdKeyword}).add(Jw.ListLevelTextDestination,(new Eu).append(this.stringValueDestinationKeywordHT).add("leveltemplateid",Xy.onListLevelTemplateIdKeyword).get()).add(Jw.ShapePictureDestination,{pict:yx.onPictKeyword}).get(),this.defaultKeywords=lv}getHt(e){return this.mapByDestinations[e]}}class zv{constructor(){this.charset=cy.Ansi,this.defaultCodePage=Fw.default,this.colorIndexes=new ex,this.listTable=[],this.listOverrideTable=[]}}class jv{constructor(){this.horizontalMerging=Xe.None,this.shadingPattern=re.Clear,this.preferredWidth=lr.createDefault(),this.coreProperties=new cr}copyFrom(e){this.coreProperties.copyFrom(e.coreProperties),this.right=e.right,this.horizontalMerging=e.horizontalMerging,this.shadingPattern=e.shadingPattern,this.foreColor=e.foreColor,this.backColor=e.backColor,this.verticalMerging=e.verticalMerging,this.preferredWidth=e.preferredWidth}apply(e){this.verticalMerging&&(e.verticalMerging=this.verticalMerging),(this.backColor||this.foreColor)&&e.properties.setValue(hr.shadingInfo,new fe(this.shadingPattern,this.backColor?this.backColor:e.properties.shadingInfo.backColor,this.foreColor?this.foreColor:e.properties.shadingInfo.foreColor)),e.preferredWidth=this.preferredWidth}}class Xv{constructor(){this.style=0,this.preferredWidth=lr.createDefault(),this.lookTypes=_e.None,this.coreProperties=new mr,this.coreProperties.layoutType=Oe.Fixed,this.coreProperties.setUseValue(ur.UseTableLayout,!0)}get halfSpace(){return this._halfSpace}set halfSpace(e){this._halfSpace=e,this.useHalfSpace=!0}isChanged(){return this.useHalfSpace||this.coreProperties.layoutType==Oe.Autofit||this.coreProperties.getUseValue(ur.UseLeftMargin)||this.coreProperties.getUseValue(ur.UseRightMargin)||this.coreProperties.getUseValue(ur.UseTopMargin)||this.coreProperties.getUseValue(ur.UseBottomMargin)||this.coreProperties.getUseValue(ur.UseCellSpacing)||this.coreProperties.getUseValue(ur.UseIsTableOverlap)||this.coreProperties.getUseValue(ur.UseTableIndent)||this.coreProperties.getUseValue(ur.UseTableStyleColBandSize)||this.coreProperties.getUseValue(ur.UseTableStyleRowBandSize)||this.coreProperties.getUseValue(ur.UseBottomBorder)||this.coreProperties.getUseValue(ur.UseInsideHorizontalBorder)||this.coreProperties.getUseValue(ur.UseInsideVerticalBorder)||this.coreProperties.getUseValue(ur.UseLeftBorder)||this.coreProperties.getUseValue(ur.UseRightBorder)||this.coreProperties.getUseValue(ur.UseTopBorder)}copyFrom(e){this.coreProperties.copyFrom(e.coreProperties),this._halfSpace=e._halfSpace,this.useHalfSpace=e.useHalfSpace,this.rightToLeft=e.rightToLeft,this.style=e.style,this.preferredWidth=e.preferredWidth,this.lookTypes=e.lookTypes}apply(e){e.lookTypes=this.lookTypes,e.preferredWidth=this.preferredWidth}}class Gv{}class Kv{constructor(){this.left=0,this.widthBefore=lr.createDefault(),this.widthAfter=lr.createDefault(),this.gridBefore=0,this.gridAfter=0,this.height=dr.createDefault(),this.coreProperties=new za,this.cellSpacing=lr.createDefault(),this.floatingPosition=new Gv}copyFrom(e){this.coreProperties.copyFrom(e.coreProperties),this.left=e.left,this.foreColorIndex=e.foreColorIndex,this.backColorIndex=e.backColorIndex,this.cellSpacing.copyFrom(e.cellSpacing),this.floatingPosition=e.floatingPosition,this.shadingPattern=e.shadingPattern,this.foreColor=e.foreColor,this.backColor=e.backColor,this.widthAfter=e.widthAfter,this.widthBefore=e.widthBefore,this.gridBefore=e.gridBefore,this.gridAfter=e.gridAfter,this.height=e.height}apply(e){e.widthBefore=this.widthBefore,e.widthAfter=this.widthAfter,e.gridBefore=this.gridBefore,e.gridAfter=this.gridAfter,e.height=this.height}}class qv{constructor(e=null){this.indent=0,this.properties=new Xv,this.rows=[],this.parentCell=e}get nestingLevel(){return this.getNestedLevel()}getNestedLevel(){let e=1,t=this.parentCell;for(;null!=t;){t=t.row.table.parentCell,e++}return e}createTable(e,t,r){const i=new Ja(this.properties.coreProperties,r.tableStyles[this.properties.style]);return i.index=e,i.nestedLevel=this.nestingLevel-1,i.parentCell=t,this.properties.apply(i),i}}class $v{constructor(e){this.offset=0,this.index=-1,this.properties=new Kv,this.table=e,this.cells=[]}get right(){const e=f.ListUtils.last(this.cells);return e?e.properties.right:0}createTableRow(e){const t=new Ld(e,this.properties.coreProperties);return this.properties.apply(t),t}}class Jv{constructor(e,t=0){this.startPos=-1,this.endPos=-1,this.index=-1,this.columnSpan=0,this.idForParentCellMap=Jv.__id++,this.row=e,this.properties=new jv}get isEmpty(){return-1==this.startPos||-1==this.endPos}createCell(e,t){const r=new Rd(e,this.properties.coreProperties),i=t.getParagraphByPosition(this.startPos);r.startParagraphPosition=t.positionManager.registerPosition(i.startLogPosition.value);const n=this.endPos-1;if(n<=this.startPos)r.endParagrapPosition=t.positionManager.registerPosition(i.getEndPosition());else{const e=t.getParagraphByPosition(n);r.endParagrapPosition=t.positionManager.registerPosition(e.getEndPosition())}return r.columnSpan=this.columnSpan,this.properties.apply(r),r}}Jv.__id=0;class Yv{constructor(e){this.rowController=e}startNewCell(){const e=this.rowController.currentRow;this.currentCell=new Jv(e)}isCurrentCellNotComplete(){return!f.ListUtils.elementBy(this.rowController.currentRow.cells,(e=>e==this.currentCell))&&!this.currentCell.isEmpty}assignLastCellAsCurrent(){this.currentCell=f.ListUtils.last(this.rowController.currentRow.cells)}finishCell(){const e=this.rowController.currentRow.cells;0!=e.length&&f.ListUtils.last(e)==this.currentCell||(this.currentCell.index=e.length,e.push(this.currentCell))}setCharacterInterval(e){this.setIntervalCore(this.currentCell,e),this.setParagraphIntervalToParentCell(e)}setParagraphIntervalToParentCell(e){let t=this.rowController.tableController.currentTable.parentCell;for(;null!=t;)this.setIntervalCore(t,e),t=t.row.table.parentCell}setIntervalCore(e,t){e.startPos<0&&(e.startPos=t.start),e.endPos=t.end}reset(){this.currentCell=null}}class Qv{constructor(e){this.tableController=e,this.cellController=this.createCellController()}createCellController(){return new Yv(this)}startNewRow(){const e=this.tableController.currentTable;this.currentRow=new $v(e),this.cellController.startNewCell()}isCurrentRowNotComplete(){return!f.ListUtils.elementBy(this.tableController.currentTable.rows,(e=>e==this.currentRow))&&(this.currentRow.cells.length>0||this.cellController.isCurrentCellNotComplete())}isCurrentRowValid(){return f.ListUtils.elementBy(this.tableController.currentTable.rows,(e=>e==this.currentRow))&&this.currentRow.cells.length>0}assignLastRowAsCurrent(){this.currentRow=f.ListUtils.last(this.tableController.currentTable.rows),this.cellController.assignLastCellAsCurrent()}finishRow(){this.finishRowCore(),this.assignRowProperties()}finishRowCore(){const e=this.tableController.currentTable;this.splitTables(e);const t=this.tableController.currentTable.rows;0!=t.length&&f.ListUtils.last(t)==this.currentRow||(this.currentRow.index=t.length,t.push(this.currentRow))}splitTables(e){const t=e.rows;0!=t.length&&f.ListUtils.last(t)!=this.currentRow&&e.properties.style!=this.tableController.reader.tableProperties.style&&(this.tableController.changeCurrentTable(),this.currentRow.table=this.tableController.currentTable)}assignRowProperties(){const e=this.tableController.reader,t=this.tableController.currentTable.properties;t.isChanged()||t.copyFrom(e.tableProperties),t.style=e.tableProperties.style;const r=e.rowProperties;this.currentRow.properties.copyFrom(r),this.assignCellProperties()}assignCellProperties(){const e=this.tableController.reader,t=e.cellPropertiesCollection.length;0==t&&aM.throwInvalidRtfFile();const r=this.currentRow.cells;for(;r.length>t&&r.length>1;)r[1].startPos=r[0].startPos,r.shift();r.forEach(((t,r)=>{t.properties.copyFrom(e.cellPropertiesCollection[r])}))}reset(){this.currentRow=null,this.cellController.reset()}}class Zv{constructor(e,t){this.table=e,this.tableProperties=t.tableProperties,this.rowProperties=t.rowProperties,this.cellPropertiesCollection=t.cellPropertiesCollection}}class eM{constructor(e){this.reader=e,this.rowController=this.createRowController()}createRowController(){return new Qv(this)}changeTable(e){const t=e-this.currentTable.nestingLevel;t>0?this.createNestedTable(t):t<0?this.popParentTable(t):(this.finishTable(),this.createCurrentTable())}popParentTable(e){const t=Math.abs(e);let r=null;for(let e=0;e<t&&this.reader.tableStack.count>0;e++)r=this.reader.tableStack.pop();null!=r&&(this.currentTable=r.table,this.reader.restoreProperties(r),this.rowController.assignLastRowAsCurrent())}createNestedTable(e){for(let t=0;t<e;t++)this.finishTable(),this.reader.tableStack.push(new Zv(this.currentTable,this.reader)),this.createCurrentTable()}createCurrentTable(){this.changeCurrentTable();const e=this.rowController.cellController.currentCell;if(this.currentTable.parentCell=e,null!=e){let t=this.reader.parentCellMap[e.idForParentCellMap];void 0===t&&(t=[],this.reader.parentCellMap[e.idForParentCellMap]=t),t.push(this.currentTable)}this.rowController.startNewRow()}changeCurrentTable(){this.currentTable=new qv,this.reader.tables.push(this.currentTable)}finishTable(){this.rowController.cellController.finishCell(),this.rowController.finishRowCore()}reset(){this.currentTable=null,this.rowController.reset()}}class tM{constructor(e){this.reader=e}get data(){return this.reader.data}get documentModel(){return this.data.documentModel}get tableController(){return this.reader.tableController}}class rM extends tM{constructor(e){super(e),e.tableController.createCurrentTable()}onEndParagraph(e){this.isParagraphInTable(e)||this.isCurrentTableNotComplete()?this.onEndInTableParagraph(e.nestingLevel):(this.validateCurrentTable(),this.reader.resetState())}validateCurrentTable(){const e=this.tableController.currentTable;if(0==e.rows.length){const t=this.reader.tables.findIndex((t=>t==e));return void(t>=0&&this.reader.tables.splice(t,1))}f.ListUtils.last(e.rows).cells.length>0||(e.rows.splice(e.rows.length-1),this.validateCurrentTable())}onEndInTableParagraph(e){const t=this.reader.tableController;t.currentTable.nestingLevel!=e&&t.changeTable(e);const r=f.ListUtils.last(this.data.subDocument.paragraphs);t.rowController.cellController.setCharacterInterval(r.interval),0!=this.reader.rtfTableStyleIndexForRowOrCell&&(this.data.importers.style.paragraph.paragraphTableStyles[r.interval.end]=this.reader.rtfTableStyleIndexForRowOrCell)}isParagraphInTable(e){return e.inTableParagraph||e.nestingLevel>0}isCurrentTableNotComplete(){return this.reader.tableController.rowController.isCurrentRowNotComplete()||this.reader.tableController.rowController.isCurrentRowValid()&&this.reader.tableController.rowController.currentRow.cells.length<this.reader.cellPropertiesCollection.length}onEndRow(){this.tableController.currentTable.nestingLevel>1&&aM.throwInvalidRtfFile(),this.onEndRowCore()}onEndRowCore(){const e=this.reader.tableController.rowController;e.finishRow(),e.startNewRow()}onEndCell(){this.onEndCellCore(1)}onEndCellCore(e){const t=this.reader.tableController.rowController.cellController;this.onEndInTableParagraph(e),t.finishCell(),t.startNewCell()}onEndNestedRow(){1==this.tableController.currentTable.nestingLevel&&aM.throwInvalidRtfFile(),this.onEndRowCore()}onEndNestedCell(){this.onEndCellCore(this.data.importers.paragraph.paragraphFormatting.nestingLevel)}onStartNestedTableProperties(){}onTableRowDefaults(){const e=this.reader.tableController.currentTable;!this.reader.isNestedTableProperetiesReading&&null!=e&&e.nestingLevel>1&&this.tableController.changeTable(1)}}class iM extends tM{constructor(){super(...arguments),this.defaultNestingLevel=1}onEndParagraph(e){if(!e.inTableParagraph)return;this.changeState().onEndParagraph(e)}onStartNestedTableProperties(){aM.throwInvalidRtfFile()}onEndRow(){aM.throwInvalidRtfFile()}onEndCell(){this.changeState().onEndCell()}onEndNestedRow(){aM.throwInvalidRtfFile()}onEndNestedCell(){this.changeState().onEndNestedCell()}onTableRowDefaults(){}changeState(){const e=new rM(this.reader);return this.reader.changeState(e),e}}class nM{constructor(e){this.isNestedTableProperetiesReading=!1,this._state=new iM(this),this.data=e,this.tableStack=new Rw.K,this.tables=[],this.tableController=this.createTableController(),this.parentCellMap={},this.resetProperties()}get state(){return this._state}get tableProperties(){return null==this._tableProperties&&(this._tableProperties=new Xv),this._tableProperties}get rowProperties(){return null==this._rowProperties&&(this._rowProperties=new Kv),this._rowProperties}get cellProperties(){return null==this._cellProperties&&this.createCellProperties(),this._cellProperties}createCellProperties(){this._cellProperties=new jv}restoreProperties(e){this._tableProperties=e.tableProperties,this._rowProperties=e.rowProperties,this.cellPropertiesCollection=e.cellPropertiesCollection,this.cellPropertiesCollection.length>0?this._cellProperties=f.ListUtils.last(this.cellPropertiesCollection):this.createCellProperties()}resetProperties(){this._tableProperties=null,this._rowProperties=null,this._cellProperties=null,this.cellPropertiesCollection=[],this.processedBorder=null}createTableController(){return new eM(this)}onStartNestedTableProperties(){this.isNestedTableProperetiesReading=!0,this.state.onStartNestedTableProperties()}onEndParagraph(){this.state.onEndParagraph(this.data.importers.paragraph.paragraphFormatting)}onEndRow(){this.state.onEndRow()}onEndCell(){this.state.onEndCell()}onEndNestedRow(){this.isNestedTableProperetiesReading=!1,this.state.onEndNestedRow()}onEndNestedCell(){this.state.onEndNestedCell()}onTableRowDefaults(){this.state.onTableRowDefaults(),this.resetProperties()}onCellxProperty(e){this.cellProperties.right=e,0!=this.cellPropertiesCollection.length&&f.ListUtils.last(this.cellPropertiesCollection)==this.cellProperties||this.cellPropertiesCollection.push(this.cellProperties),this.createCellProperties(),this.processedBorder=null}resetState(){this.changeState(new iM(this)),this.tableController.reset()}changeState(e){this._state=e}}class oM{constructor(e,t,r,i,n,o,a){this.subDocument=e,this.paragraph=t,this.fields=r,this.bookmarks=i,this.rangePermissions=n,this.sectionProperties=o,this.tableReader=a}}class aM{get destination(){return this._destination}set destination(e){e.subDocument!==this.destination.subDocument&&(this.beforeChangeSubDocument(e.subDocument),this.subDocument=e.subDocument,this.onChangeSubDocument()),this._destination=e}get savedStatesCount(){return this.savedDestinations.count}get formattingInfo(){return this.importers.character.characterFormatting.rtfFormattingInfo}constructor(e,t,r,i){this.intervalsToDelete=[],this.documentModel=r,this.modelManager=new cP(this.documentModel,i,new Lb.m1),this.formatImagesImporter=new Dw,this.subDocument=this.documentModel.mainSubDocument,this.rtfText=e,this.importerOptions=t,this.richOptions=i,this.savedDestinations=new Rw.K,this.documentProperties=new zv,this.keywordHTHolder=new Wv,this.skipCount=0,this.binCharCount=0,this.parsingState=Qw.Normal,this.rtfDocumentModelType=sM.WithStyle,this.importers=new UT(this),this._destination=this.createDefaultDestination(),this.savedDestinations.push(this._destination),this.positionStates=new Rw.K,this.addEmptyPositionState()}beforeChangeSubDocument(e){if(1==this.positionStates.count)return;this.positionStates.getPrevious().subDocument==e&&this.importers.finalizeSubDocument()}onChangeSubDocument(){this.importers.startImportSubDocument();const e=this.positionStates.getPrevious();this.positionStates.count>1&&e.subDocument==this.subDocument?this.positionStates.pop():this.addEmptyPositionState()}addEmptyPositionState(){return(new Rw.K).push(new yT),this.positionStates.push(new oM(this.subDocument,this.importers.paragraph.createEmptyParagraph(),new Rw.K,{},{},new Rw.K,new nM(this)))}import(){for(this.beforeImport();this.rtfText.moveToNextChar();){const e=this.rtfText.currChar;if(this.parsingState!=Qw.BinData)switch(e){case"{":this.flushDecoder(),this.pushState();break;case"}":this.flushDecoder(),this.popRtfState();break;case"\\":" "!=this.parseRtfKeyword()&&this.rtfText.moveToPrevChar();break;case"\r":case"\n":case"\0":break;default:this.parsingState==Qw.Normal?this.parseChar(e):this.parseHexChar(e)}else this.parseBinChar(e)}if(0!=this.binCharCount&&this.throwUnexpectedEndOfFile(),0!=this.importers.field.fields.count&&this.throwInvalidRtfFile(),!(this.destination instanceof Vx))throw new Error(R.D.InternalException);this.subDocument.getLastRun().getType()!=cs.ParagraphRun&&this.importers.paragraph.insertParagraph(),this.importers.section.setLastSectionLength(),this.importers.finalizeSubDocument(),this.afterImport()}afterImport(){for(;this.intervalsToDelete.length>0;){const e=this.intervalsToDelete.pop();this.modelManager.modelManipulator.range.removeInterval(e,!0,!1)}}parseRtfKeyword(){let e=this.readChar();if(!rn.StringUtils.isAlpha(e))return this.translateControlChar(e)," ";const t=[];for(;rn.StringUtils.isAlpha(e);)t.push(e),e=this.readChar();let r=[];const i="-"==e;if(i&&(r.push(e),e=this.readChar()),i&&!rn.StringUtils.isDigit(e))r=[];else for(;rn.StringUtils.isDigit(e);)r.push(e),e=this.readChar();const n=parseInt(r.join("")),o=t.join("");if(this.isUnicodeSymbolDefinition(o)){const e=String.fromCharCode(65535&n);this.parseUnicodeChar(e)}else this.flushDecoder(),this.translateKeyword(o,isNaN(n)?0:n,0!=r.length);return e}isUnicodeSymbolDefinition(e){return"u"===e}flushDecoder(){this.importers.character.characterFormatting.rtfFormattingInfo.activeDecoder.flush(this)}switchToCodePageDecoder(){this.setActiveDecoder(this.formattingInfo.codePageDecoder)}switchToUnicodeDecoder(){this.setActiveDecoder(this.formattingInfo.unicodeDecoder)}setActiveDecoder(e){this.formattingInfo.activeDecoder!==e&&(this.flushDecoder(),this.formattingInfo.activeDecoder=e)}throwUnexpectedEndOfFile(){this.importerOptions.throwInvalidFile("Unexpected end of file")}throwInvalidRtfFile(){this.importerOptions.throwInvalidFile("Invalid RTF file")}static throwInvalidRtfFile(){throw new Error("Invalid RTF file")}beforeImport(){this.documentModel.defaultCharacterProperties.fontInfo=this.documentModel.cache.fontInfoCache.getItemByName("Times New Roman"),this.documentModel.defaultCharacterProperties.fontSize=12,this.documentModel.numberingLists=[]}translateControlChar(e){0==this.skipCount||"'"==e?this.destination.processControlChar(e):this.decreaseSkipCount()}translateKeyword(e,t,r){if(0==this.skipCount||"bin"==e){this.destination.processKeyword(e,t,r)?this.destination instanceof Ey||(this.optionalGroupLevel=Bo.Constants.MAX_SAFE_INTEGER):this.optionalGroupLevel<Bo.Constants.MAX_SAFE_INTEGER&&(this.destination=new Ey(this))}else this.decreaseSkipCount()}parseBinChar(e){this.destination.processBinChar(e),this.binCharCount--,this.binCharCount<=0&&(this.parsingState=Qw.Normal,this.decreaseSkipCount())}decreaseSkipCount(){this.skipCount=Math.max(0,this.skipCount-1)}popRtfState(){const e=this.destination;this.savedStatesCount==this.optionalGroupLevel&&(this.optionalGroupLevel=Bo.Constants.MAX_SAFE_INTEGER),this.popState(),this.savedStatesCount>=this.optionalGroupLevel&&(this.destination=new Ey(this)),e.afterPopRtfState(),this.skipCount=0,0==this.savedStatesCount&&this.rtfText.resetToEnd()}parseHexChar(e){this.parsingState=Qw.Normal;const t=this.hexToInt(e,!1),r=this.hexToInt(this.readChar(),!1);if(t<0||r<0)return;const i=(t<<4)+r;this.parseChar(Gw.decode(String.fromCharCode(i),this.codePage))}parseChar(e){0==this.skipCount?"\r"==e&&this.destination.canProcessSpecialHexChar()?(this.flushDecoder(),this.destination.processSpecialHexChar(e)):(this.switchToCodePageDecoder(),this.formattingInfo.activeDecoder.processChar(this,e)):this.decreaseSkipCount()}readChar(){return this.rtfText.moveToNextChar()||this.throwUnexpectedEndOfFile(),this.rtfText.currChar}hexToInt(e,t){if(rn.StringUtils.isDigit(e))return e.charCodeAt(0)-"0".charCodeAt(0);if(rn.StringUtils.stringInLowerCase(e)){if(e<"a"||e>"f"){if(!t)return-1;this.importerOptions.throwInvalidFile("Invalid hex value")}return 10+e.charCodeAt(0)-"a".charCodeAt(0)}if(e<"A"||e>"F"){if(!t)return-1;this.importerOptions.throwInvalidFile("Invalid hex value")}return 10+e.charCodeAt(0)-"A".charCodeAt(0)}parseUnicodeChar(e){this.switchToUnicodeDecoder(),this.formattingInfo.activeDecoder.processChar(this,e),this.skipCount=this.importers.character.characterFormatting.rtfFormattingInfo.unicodeCharacterByteCount}processChar(e){this.destination.processChar(e)}setCodePage(e){this.importers.character.characterFormatting.rtfFormattingInfo.codePage=e}get codePage(){return this.importers.character.characterFormatting.rtfFormattingInfo.codePage}parseCharWithoutDecoding(e){this.flushDecoder(),0==this.skipCount&&this.processChar(e),this.decreaseSkipCount()}createTableContentFieldDestination(e){return new Gx(this,e)}createShapeDestination(){return new qx(this)}createFieldDestination(){return new Xx(this)}createDefaultDestination(){return new Vx(this,this.subDocument)}pushState(){this.importers.pushState(),this.savedDestinations.push(this.destination),this.destination=this.destination.clone(),this.destination.increaseGroupLevel()}popState(){const e=this.destination,t=this.savedDestinations.peek();t.beforeNestedGroupFinished(e),e.beforePopRtfState(),this.importers.popState(),this.destination=t,this.destination.nestedGroupFinished(e),this.savedDestinations.pop(),this.subDocument=t.subDocument,this.destination.afterNestedGroupFinished(e)}}var sM;!function(e){e[e.None=0]="None",e[e.WithoutStyle=1]="WithoutStyle",e[e.WithStyle=2]="WithStyle"}(sM||(sM={}));class lM{constructor(e){this.options=e}importFromFile(e,t,r,i){const n=new FileReader;n.onload=()=>{this.importFromString(n.result,t,r,i)},n.onerror=e=>{i(Sw.RtfFileReaderError)},n.readAsText(e)}importFromString(e,t,r,i){this.richOptions=t;try{if(this.importFromStringInner(new FP.T(e,1e5)),!new wu(this.data.documentModel).checkAll())throw new Error}catch(e){return void i(Sw.RtfImportError)}r(this.data.documentModel,this.data.formatImagesImporter)}importFromStringInner(e){this.rtfText=e,e.resetToStart(),this.checkSignature(this.rtfText);const t=new Mw;return t.addParagraph=!1,t.addSection=!0,this.data=new aM(this.rtfText,this.options,new vw(t).createModel(this.richOptions).fillModel(),this.richOptions),this.data.documentModel.compatibilitySettings.compatibilityMode=yg.Word2003,this.data.import(),this.data.documentModel}checkSignature(e){const t="{\\rtf";for(let r=0;r<5;r++)e.moveToNextChar()&&t[r]==e.currChar||this.options.throwInvalidFile("Incorrect rtf signature");e.resetToStart()}}function dM(e,t,r,i){return(n,o)=>{o.whenAllPicturesLoaded((o=>{e.beginUpdate();const a=e.modelManager.modelManipulator.subDocument.insertSubDocument(new pu(t,r),new gu(n.mainSubDocument,n.mainSubDocument.interval));n.updateHyperlinkFields(e,new gu(t,a.insetedInterval),a.newSubDocuments),e.endUpdate(),i(a.insetedInterval,!0)}),5e3);const a=new cP(n,e.modelManager.richOptions,new Lb.m1);o.import(a.modelManipulator)}}function cM(e){return t=>{e(null,!1)}}class hM{constructor(e){this.resultsIsInvalid=!1;const t=document.createElement("div");t.id=e+"_Measure",t.className="dxreMeasurer",document.body.appendChild(t),this.measureContainer=t}dispose(){fn.DomUtils.hideNode(this.measureContainer)}setCharacterPropertiesCache(e){this.charPropsCache=e}clearCache(){var e;null===(e=this.charPropsCache)||void 0===e||e.resetSizes()}measure(e){this.htmlParts=[],this.nodeIndex=0,this.nonCachedMeasureInfos=[];for(let t of e)t.resultSize||(t.charProp.script!==ne.Normal&&this.pushInfoToQueue(t.sbInfo=this.createSpaceMeasureInfo(t)),this.pushInfoToQueue(t));this.measureContainer.innerHTML="",this.htmlParts.forEach((e=>this.measureContainer.appendChild(e)));const t=this.measureContainer.childNodes;for(let e of this.nonCachedMeasureInfos){const r=e.charProp.getSize(e.text);r?e.resultSize=r:this.applyCalculatedSize(e,t)}this.checkResult(e)}checkResult(e){if(e.length&&(this.resultsIsInvalid=f.ListUtils.unsafeAnyOf(e,(e=>this.incorrectInfo(e.resultSize))),this.resultsIsInvalid))for(let t of e)t.resultSize.width=t.resultSize.height=1,t.charProp.clearSizes(),t.charProp.fontInfo&&t.charProp.fontInfo.reset()}incorrectInfo(e){return 0===e.height||isNaN(e.width)||isNaN(e.height)}pushInfoToQueue(e){if(this.nonCachedMeasureInfos.push(e),null!==e.resultSize){this.nonCachedMeasureInfos.push(e),e.nodeIndex=this.nodeIndex++;var t=document.createElement("pre");t.style.cssText=e.signCssString,t.innerHTML=e.getEncodedText(),this.htmlParts.push(t),e.charProp.setSize(e.text,null),e.resultSize=null}}createSpaceMeasureInfo(e){let t=e.charProp.clone();return t.script=ne.Normal,t=this.charPropsCache.getItem(t),new Eg(" ",t)}applyCalculatedSize(e,t){const r=t[e.nodeIndex],i=document.defaultView.getComputedStyle(r,null);e.resultSize=new so.Size(parseFloat(i.width),e.charProp.script==ne.Normal?this.getNormalHeight(e):e.sbInfo.resultSize.height),e.charProp.setSize(e.text,e.resultSize)}getNormalHeight(e){return e.charProp.fontInfo.getHeightFactor()*e.charProp.fontSize}}class uM{constructor(e,t,r){this.runType=e,this.runLength=t,this.charPropsBundle=r}}class pM extends uM{constructor(e,t,r,i){super(cs.TextRun,r.length,i),this.text=this.replaceTabs(r,e,t,i.props),this.runLength=this.text.length}replaceTabs(e,t,r,i){return e.replace(pM.tabRegex,((e,n)=>{const o=e.length;return o<3?rn.StringUtils.repeat(an.specialCharacters.Space,o):rn.StringUtils.repeat(an.specialCharacters.TabMark,this.numTabs(o,this.mergeCharProps(i,t),r,t.defaultTabWidth))}))}mergeCharProps(e,t){const r=new Ii;return r.mergeCharacterProperties(e),r.mergeCharacterProperties(t.defaultCharacterProperties),r.getMergedProperties()}numTabs(e,t,r,i){const n=rn.StringUtils.repeat("&nbsp;",e),o=new Eg(n,t);return r.measure([o]),Math.max(1,Math.round(o.resultSize.width/g.u.twipsToPixelsF(i)))}}pM.tabRegex=new RegExp(an.specialCharacters.NonBreakingSpace+"{1,}","gi");class gM{constructor(e,t,r,i,n,o){this.listIndex=e,this.listLevel=t,this.listFormat=r,this.listType=i,this.displayFormatString=n,this.maskedCharacterProperties=o}}class mM extends uM{constructor(e,t,r,i){super(cs.ParagraphRun,an.specialCharacters.ParagraphMark.length,t),this.listInfo=e,this.maskedParagraphProperties=r,this.tabs=i}}class fM extends uM{constructor(e,t,r){super(cs.InlinePictureRun,1,e),this.picInfo=t,this.actualSize=r}}class bM extends uM{constructor(e,t,r){super(cs.FieldCodeStartRun,an.specialCharacters.FieldCodeStartRun.length,e),this.hyperlinkInfo=t,this.id=r}}class CM extends uM{constructor(e,t){super(cs.FieldCodeEndRun,an.specialCharacters.FieldCodeEndRun.length,e),this.id=t}}class SM extends uM{constructor(e,t){super(cs.FieldResultEndRun,an.specialCharacters.FieldResultEndRun.length,e),this.id=t}}class IM{constructor(e,t,r,i,n,o,a){this.setGridBefore=t,this.setGridAfter=r,this.setWidthBefore=i,this.setWidthAfter=n,this.setCellSpan=o,this.setVerticalMerging=a,this.table=e,this.tableCellGridInfos=[],this.tableCellInfos=[],Su.fillGridInfo(this.table,this.tableCellGridInfos,this.tableCellInfos)}normalizeAll(){return this.transformTableToSquare(),this.normalizeAllHorizontalSpans(),this.normalizeWidthBeforeAfter(),this.normalizeVerticalSpans(),this}transformTableToSquare(){const e=this.table.rows,t=f.ListUtils.maxExtended(e,(e=>e.getTotalCellsInRowConsiderGrid())).maxValue;for(let r,i=0;r=e[i];i++)t!=r.getTotalCellsInRowConsiderGrid()&&this.setGridAfter(this.table,i,t);return this}normalizeAllHorizontalSpans(){const e=new on.FixedInterval(0,this.tableCellGridInfos.length);for(let t=this.tableCellGridInfos[0].length-2;t>=0;--t)f.ListUtils.allOfOnInterval(e,(e=>{const r=this.tableCellGridInfos[e][t];return!r||t<r.getGridCellIndexEnd(this.table)-1}))&&f.ListUtils.forEachOnInterval(e,(e=>{const r=this.tableCellGridInfos[e][t];if(r){const t=r.getCellIndexAbs(e);this.setCellSpan(this.table,e,t,this.table.rows[e].cells[t].columnSpan-1)}else{const r=this.table.rows[e];t<r.gridBefore?this.setGridBefore(this.table,e,r.gridBefore-1):this.setGridAfter(this.table,e,r.gridAfter-1)}}));return this}normalizeWidthBeforeAfter(){const e=this.table.rows;for(let t,r=0;t=e[r];r++)IM.setWidthBeforeAfter(this.table,r,t.gridBefore,t.widthBefore,this.setWidthBefore),IM.setWidthBeforeAfter(this.table,r,t.gridAfter,t.widthAfter,this.setWidthAfter)}normalizeVerticalSpans(){const e=this.table.rows;f.ListUtils.forEach(e,((e,t)=>{f.ListUtils.forEach(e.cells,((e,r)=>{const i=this.tableCellInfos[t][r],n=1==i.getNumRowsInCell()?Xe.None:i.getStartRowIndex()==t?Xe.Restart:Xe.Continue;e.verticalMerging!=n&&this.setVerticalMerging(this.table,t,r,n)}))}))}static setWidthBeforeAfter(e,t,r,i,n){0!=r||i.type==Je.Nil&&0==i.value||n(e,t,lr.createDefault())}}class PM extends tt{constructor(e,t,r,i,n){super(e,t),this.historyRuns=r,this.tablesInfo=i,this.charPropsBundle=n}redo(){this.insertRuns(),this.insertTables()}undo(){for(let e of this.historyTables)this.modelManipulator.table.removeTable(this.boundSubDocument,e);this.modelManipulator.range.removeIntervalWithoutHistory(this.boundSubDocument,this.interval,!1)}insertRuns(){const e=this.boundSubDocument.fields,t=[];for(var r,i=0;r=this.historyRuns[i];i++)switch(r.type){case cs.ParagraphRun:var n=r;this.modelManipulator.paragraph.insertParagraphInner(new Ag(new pu(this.boundSubDocument,n.offsetAtStartDocument),n.charPropsBundle,n.parPropsBundle,n.applyDirectlyToNewParagraph,(()=>{})));break;case cs.InlinePictureRun:const i=r;this.modelManipulator.picture.insertInlinePictureInner(new pu(this.boundSubDocument,i.offsetAtStartDocument),i.charPropsBundle,i.picInfo,i.options);break;case cs.FieldCodeStartRun:t.push(r),this.modelManipulator.text.insertTextInner(new op(new pu(this.boundSubDocument,r.offsetAtStartDocument),r.charPropsBundle,r.type,r.text));break;case cs.FieldResultEndRun:this.modelManipulator.text.insertTextInner(new op(new pu(this.boundSubDocument,r.offsetAtStartDocument),r.charPropsBundle,r.type,r.text));var o=t.pop(),a=0;e.length>0&&(a=Math.max(0,Md.normedBinaryIndexOf(e,o.startPosition+1)),o.startPosition>e[a].getFieldStartPosition()&&a++);var s=new Md(this.boundSubDocument.positionManager,a,o.startPosition,o.separatorPosition,o.endPosition,o.showCode,o.hyperlinkInfo?o.hyperlinkInfo.clone():void 0);if(Md.addField(e,s),this.modelManipulator.notifyModelChanged(new up(this.boundSubDocument.id,o.startPosition,o.separatorPosition,o.endPosition)),o.hyperlinkInfo){let e=on.FixedInterval.fromPositions(o.startPosition+1,o.separatorPosition),t=on.FixedInterval.fromPositions(o.separatorPosition+1,o.endPosition-1);this.modelManipulator.notifyModelChanged(new vm(this.boundSubDocument.id,t,e,o.hyperlinkInfo)),t.length&&this.modelManipulator.style.setCharacterStyle(this.boundSubDocument,t,this.boundSubDocument.documentModel.getCharacterStyleByName(zl.hyperlinkStyleName),!1)}break;default:this.modelManipulator.text.insertTextInner(new op(new pu(this.boundSubDocument,r.offsetAtStartDocument),r.charPropsBundle,r.type,r.text))}}insertTables(){this.historyTables=[];for(let e of this.tablesInfo){const t=new Ja(e.properties,this.boundSubDocument.documentModel.getDefaultTableStyle());t.preferredWidth=e.width;for(let r of e.rows){const e=new Ld(t,this.boundSubDocument.documentModel.cache.tableRowPropertiesCache.getItem(r.properties));e.gridAfter=r.gridAfter,e.gridBefore=r.gridBefore,e.widthAfter=r.widthAfter,e.widthBefore=r.widthBefore,t.rows.push(e);for(let t of r.cells){const r=new Rd(e,this.boundSubDocument.documentModel.cache.tableCellPropertiesCache.getItem(t.properties));r.preferredWidth=t.preferredWidth,r.startParagraphPosition=this.boundSubDocument.positionManager.registerPosition(t.startPosition),r.endParagrapPosition=this.boundSubDocument.positionManager.registerPosition(t.endPosition),r.columnSpan=t.columnSpan,r.verticalMerging=t.firstWhenVerticallyMerged?t.rowSpan>1?Xe.Restart:Xe.None:Xe.Continue,e.cells.push(r)}}const r=e.rows[0].cells[0].startPosition;this.modelManipulator.table.pasteTable(this.boundSubDocument,t,r);const i=Ja.getTableByPosition(this.boundSubDocument.tables,r,!0);new IM(i,((e,t,r)=>e.rows[t].gridBefore=r),((e,t,r)=>e.rows[t].gridAfter=r),((e,t,r)=>e.rows[t].widthBefore=r),((e,t,r)=>e.rows[t].widthAfter=r),((e,t,r,i)=>e.rows[t].cells[r].columnSpan=i),((e,t,r,i)=>e.rows[t].cells[r].verticalMerging=i)).normalizeAll(),i&&this.historyTables.push(i)}}}class wM{get options(){return this.modelManager.richOptions.control}get subDocument(){return this.subDocPos.subDocument}constructor(e,t,r,i){this.pastedListsIndices={},this.fieldsMap={},this.tableInfo=[],this.historyRuns=[],this.modelManager=e,this.subDocPos=t,this.htmlData=r,this.defaultMaskedParProps=this.subDocument.documentModel.defaultParagraphProperties.clone(),this.defaultMaskedParProps.useValue=0,this.defaultMaskedCharProps=this.subDocument.documentModel.defaultCharacterProperties.clone(),this.defaultMaskedCharProps.resetAllUse(),this.charPropsBundle=new pn(Bb.isEnabled(this.options.characterFormatting)?i.props:this.defaultMaskedCharProps.clone(),i.style),this.position=t.position,this.tableInfo=Bb.isEnabled(this.options.tables)?r.tablesInfo:[],wM.runConverterMap||(wM.runConverterMap={},wM.runConverterMap[cs.TextRun]=this.convertTextRun,wM.runConverterMap[cs.InlinePictureRun]=this.convertInlinePictureRun,wM.runConverterMap[cs.ParagraphRun]=this.convertParagraphRun,wM.runConverterMap[cs.FieldCodeStartRun]=this.convertFieldCodeStartRun,wM.runConverterMap[cs.FieldCodeEndRun]=this.convertFieldCodeEndRun,wM.runConverterMap[cs.FieldResultEndRun]=this.convertFieldResultEndRun)}insert(){for(let e of this.htmlData.runsInfo)this.position+=wM.runConverterMap[e.runType].call(this,e);const e=on.FixedInterval.fromPositions(this.subDocPos.position,this.position);return this.modelManager.history.addTransaction((()=>{this.modelManager.history.addAndRedo(new PM(this.modelManager.modelManipulator,new gu(this.subDocPos.subDocument,e),this.historyRuns,this.tableInfo,this.charPropsBundle))})),on.FixedInterval.fromPositions(this.subDocPos.position,this.position)}convertTextRun(e){let t=e.text;return Bb.isEnabled(this.options.tabSymbol)||(t=t.replace(/\t/gi," ")),this.options.tabMarker!==an.specialCharacters.TabMark&&(t=t.replace(/\t/gi,this.options.tabMarker)),this.historyRuns.push(new HS(cs.TextRun,e.charPropsBundle,this.position,t)),t.length}convertInlinePictureRun(e){return Bb.isEnabled(this.options.inlinePictures)?(this.historyRuns.push(new VS(this.position,e.charPropsBundle,e.picInfo,Mb.initByActualSize(e.actualSize))),e.runLength):0}convertParagraphRun(e){if(!Bb.isEnabled(this.options.paragraphs))return 0;const t=this.insertListInfo(e.listInfo),r=Bb.isEnabled(this.options.paragraphFormatting)?e.maskedParagraphProperties:this.defaultMaskedParProps.clone();return this.historyRuns.push(new XS(e.runType,e.charPropsBundle,new mn(r,void 0,t,e.tabs),this.position,an.specialCharacters.ParagraphMark,!0)),1}convertFieldCodeStartRun(e){const t=e.hyperlinkInfo;if(!Bb.isEnabled(this.options.fields)||t&&!Bb.isEnabled(this.options.hyperlinks))return 0;const r=new WS(e.runType,e.charPropsBundle,this.position,an.specialCharacters.FieldCodeStartRun,!1,this.position,void 0,void 0,t);return this.fieldsMap[e.id]=r,this.historyRuns.push(r),1}convertFieldCodeEndRun(e){const t=this.fieldsMap[e.id];return t?(this.historyRuns.push(new zS(e.runType,e.charPropsBundle,this.position,an.specialCharacters.FieldCodeEndRun)),t.separatorPosition=this.position,1):0}convertFieldResultEndRun(e){const t=this.fieldsMap[e.id];return t?(this.historyRuns.push(new jS(e.runType,e.charPropsBundle,this.position,an.specialCharacters.FieldResultEndRun)),t.endPosition=this.position+1,delete this.fieldsMap[e.id],1):0}insertListInfo(e){const t=this.subDocument.documentModel,r=this.modelManager.modelManipulator;if(!e||!Bb.isEnabled(this.options.numberingBulleted)&&!Bb.isEnabled(this.options.numberingMultiLevel)&&!Bb.isEnabled(this.options.numberingSimple))return un.default;if(!Bb.isEnabled(this.options.numberingBulleted)&&e.listType===tn.Bullet){var i=Bb.isEnabled(this.options.numberingSimple);e.listType=i?tn.Simple:tn.MultiLevel,e.listFormat=Zi.Decimal,e.displayFormatString=""}Bb.isEnabled(this.options.numberingSimple)||e.listType!==tn.Simple||(e.listType=Bb.isEnabled(this.options.numberingBulleted)?tn.Bullet:tn.MultiLevel,e.displayFormatString=""),Bb.isEnabled(this.options.numberingMultiLevel)||e.listType!==tn.MultiLevel||(e.listType=Bb.isEnabled(this.options.numberingBulleted)?tn.Bullet:tn.Simple,e.displayFormatString="");let n=this.pastedListsIndices[e.listIndex];if(void 0===n){const i=new dn(t),o=f.ListUtils.elementBy(t.abstractNumberingListTemplates,(t=>t.getListType()===e.listType));if(o){i.copyFrom(o);const a=new cn(t,r.numberingList.addAbstractNumberingList(i));n=r.numberingList.addNumberingList(a),this.pastedListsIndices[e.listIndex]=n}}if(void 0===n)return un.default;const o=n,a=e.listLevel,s=t.numberingLists[o].levels[a];return r.numberingList.listLevelProperties.format.setValue(t,!1,n,a,e.listFormat),e.displayFormatString&&r.numberingList.listLevelProperties.displayFormatString.setValue(t,!1,n,a,e.displayFormatString),e.maskedCharacterProperties&&(s.setCharacterProperties(e.maskedCharacterProperties),s.onCharacterPropertiesChanged()),new un(o,a)}}class yM{get colorProvider(){return this.importer.modelManager.model.colorProvider}constructor(e){this.enablePreserveLineBreaks=!1,this.paragraphWasAddedBefore=!1,this.importer=e}getClosestImporterByTagName(e){return f.ListUtils.reverseElementBy(this.importer.levelInfo,(t=>t.tagImporter.elementTag()==e)).tagImporter}shouldPreserveLineBreaksOnChilds(){return!1}isAllowed(){return!0}addRun(e){this.importer.addRun(e)}get element(){return this.importer.currElement}}class xM extends yM{elementTag(){return"A"}importBefore(){const e=this.element;if(!e.href)return;const t=e.href.split("#"),r=new xd(t[0],t.length>1?t[1]:"",e.title,!1),i=[' HYPERLINK "',r.uri,'" ',""==r.tip?"":'\\o "'+r.tip+'" ',""==r.anchor?"":'\\l "'+r.anchor+'" '].join("");this.addRun(new bM(this.importer.charPropsBundle,r,this.importer.fieldsId)),this.addRun(new pM(this.importer.modelManager.model,this.importer.measurer,i,this.importer.htmlImporterMaskedCharacterProperties.getBundleFrom(this.element,new on.FixedInterval(this.importer.currPosition,i.length)))),this.addRun(new CM(this.importer.charPropsBundle,this.importer.fieldsId))}isImportChildren(){return!0}importAfter(){this.element.href&&(this.addRun(new SM(this.importer.charPropsBundle,this.importer.fieldsId)),this.importer.fieldsId++)}isAllowed(){return Bb.isEnabled(this.importer.modelManager.richOptions.control.hyperlinks)}}class TM extends yM{elementTag(){return"B"}importBefore(){}isImportChildren(){return!0}importAfter(){}}class vM extends yM{elementTag(){return"BR"}importBefore(){const e="always"==this.element.style.pageBreakBefore?an.specialCharacters.PageBreak:an.specialCharacters.LineBreak;this.addRun(new pM(this.importer.modelManager.model,this.importer.measurer,e,this.importer.htmlImporterMaskedCharacterProperties.getBundleFrom(this.element,new on.FixedInterval(this.importer.currPosition,1))))}isImportChildren(){return!1}importAfter(){}}class MM extends yM{elementTag(){return"CENTER"}importBefore(){}isImportChildren(){return!0}importAfter(){}}class EM extends yM{elementTag(){return"CITE"}importBefore(){}isImportChildren(){return!0}importAfter(){}}class DM extends yM{elementTag(){return"DIV"}importBefore(){!this.importer.prevRunIsParagraph&&this.importer.importStarted&&this.importer.addParagraphRun(this.element)}isImportChildren(){return!0}importAfter(){this.importer.prevRunIsParagraph||this.importer.addParagraphRun(this.element)}}class FM extends yM{elementTag(){return"EM"}importBefore(){}isImportChildren(){return!0}importAfter(){}}class RM extends yM{elementTag(){return"I"}importBefore(){}isImportChildren(){return!0}importAfter(){}}class LM extends yM{elementTag(){return"IMG"}importBefore(){const e=this.importer.currElement,t=new so.Size(e.naturalWidth,e.naturalHeight),r=new so.Size(parseFloat(e.style.width),parseFloat(e.style.height)),i=new so.Size(e.width||r.width,e.height||r.height);void 0!==t.width&&void 0!==t.height&&t.applyConverter(g.u.pixelsToTwips),void 0!==i.width&&void 0!==i.height&&i.applyConverter(g.u.pixelsToTwips);const n=this.importer.modelManager.model.cache.imageCache.createUnloadedByBase64OrUrl(e.src,t);this.addRun(new fM(this.importer.charPropsBundle,nh.defaultInfo(n),i))}isImportChildren(){return!1}importAfter(){}}class BM extends yM{elementTag(){return"LI"}importBefore(){const e=this.element.childNodes[0];this.element.innerHTML=this.element.innerHTML.trim(),this.isListElement(e)&&this.importer.addParagraphRun(this.element,this.importer.currListInfo)}isImportChildren(){return!0}importAfter(){const e=f.ListUtils.last([...this.element.childNodes]);this.importer.prevRunIsParagraph||this.isListElement(e)||this.importer.addParagraphRun(this.element,this.importer.currListInfo)}isListElement(e){const t=vE.getElementTag(e);return"OL"===t||"UL"===t}}class AM{static getTableWidthUnit(e){if(!e)return null;const t=e.match(/(px|in|cm|mm|pt|pc|em|ex|%)/g),r=t?t[0]:"px",i=parseFloat(e.replace(r,""));if(isNaN(i))return null;switch(r){case"%":return(new lr).init(i*lr.MULTIPLIER_FOR_PERCENTS,Je.FiftiethsOfPercent);case"px":return(new lr).init(g.u.pixelsToTwips(i),Je.ModelUnits);case"in":return(new lr).init(g.u.inchesToTwips(i),Je.ModelUnits);case"cm":return(new lr).init(g.u.centimetersToTwips(i),Je.ModelUnits);case"mm":return(new lr).init(10*g.u.centimetersToTwips(i),Je.ModelUnits);case"pt":return(new lr).init(g.u.pointsToTwips(i),Je.ModelUnits);case"pc":return(new lr).init(g.u.picasToTwips(i),Je.ModelUnits);default:return(new lr).init(0,Je.Nil)}}static getValueInTwips(e){const t=AM.getTableWidthUnit(e);return null===t?null:t.type==Je.ModelUnits?t.value:0}static getBorderInfo(e,t,r,i){if(!(t&&t.length||r&&r.length||i&&i.length))return null;const n=new Me,o=this.getTableWidthUnit(t);null!=o&&o.type==Je.ModelUnits&&(n.width=o.value),n.style=AM.MapBorderStyleToType[r],void 0===n.style&&(n.style=de.None);const a=w.i.fromString(i);return null!=a&&(n.color=e.getModelColorFromRgba(a==y.BLACK_COLOR?0:a)),n}static importBorder(e,t,r,i,n,o,a,s){let l=AM.getBorderInfo(e,o,a,s);l&&(n(r,l.clone()),t.setUseValue(i,l.style!=de.None))}static setBorders(e,t,r,i,n,o,a,s){AM.importBorder(e,t,r,n,((e,t)=>e.top=t),i.borderTopWidth,i.borderTopStyle,i.borderTopColor),AM.importBorder(e,t,r,o,((e,t)=>e.right=t),i.borderRightWidth,i.borderRightStyle,i.borderRightColor),AM.importBorder(e,t,r,a,((e,t)=>e.bottom=t),i.borderBottomWidth,i.borderBottomStyle,i.borderBottomColor),AM.importBorder(e,t,r,s,((e,t)=>e.left=t),i.borderLeftWidth,i.borderLeftStyle,i.borderLeftColor)}static getPropertyByMap(e,t,r){const i=e[t];return void 0!==i?i:r}static getLineSpacing(e,t=""){if("normal"===e.toLowerCase())return Bt.createSingle();if(/^\d+(\.\d+)?$/.test(e)){const t=parseFloat(e);switch(t){case 1:return Bt.createSingle();case 1.5:return Bt.createSesquialteral();case 2:return Bt.createDouble();default:return Bt.createMultiple(t)}}const r=AM.getTableWidthUnit(e);if(null==r)return AM.getLineSpacingAsMultiple(parseFloat(e));switch(r.type){case Je.FiftiethsOfPercent:return this.getLineSpacingAsMultiple(r.value/lr.MAX_PERCENT_WIDTH);case Je.ModelUnits:return"exactly"===t?Bt.createExactly(r.value):Bt.createAtLeast(r.value);case Je.Nil:case Je.Auto:return Bt.createSingle();default:throw new Error(R.D.InternalException)}}static getLineSpacingAsMultiple(e){return!e||isNaN(e)||P.MathUtils.numberCloseTo(e,1)?Bt.createSingle():P.MathUtils.numberCloseTo(e,1.5)?Bt.createSesquialteral():P.MathUtils.numberCloseTo(e,2)?Bt.createDouble():Bt.createMultiple(e)}}AM.MapBorderStyleToType=(new Eu).add("dashed",de.Dashed).add("dotted",de.Dotted).add("double",de.Double).add("inset",de.Inset).add("outset",de.Outset).add("solid",de.Single).get();class NM{constructor(e,t){this.htmlImporterMaskedCharacterProperties=t,this.importer=e}import(e,t){if(this.listItemElement=fn.DomUtils.getParentByTagName(e,"LI"),this.msoListAttr=e.outerHTML.match(/mso-list:\s*\w*\s*level[^ ]/gi),!this.listItemElement&&!this.msoListAttr)return null;if(this.parentListElement=this.listItemElement?NM.getParentListElement(this.listItemElement):null,!this.parentListElement)return null;const r=this.importListIndex(),i=this.importListLevelIndex();let n,o,a;if(this.listItemElement)n=this.importListFormatByListItemElement(),o=this.importDisplayFormatStringByParentListElement(n,i),a=null;else{const r=NM.getListTextElement(e),s=NM.getListText(r);n=NM.importListFormatByReserveWay(s),o=NM.importDisplayFormatStringByReserveWay(n,i,s),a=this.htmlImporterMaskedCharacterProperties.import(r,t,this.importer.charPropsBundle.props),NM.removeSomeHtml(e,r,s)}return new gM(r,i,n,n==Zi.Bullet?tn.Bullet:tn.MultiLevel,o,a)}importListIndex(){if(this.msoListAttr&&this.msoListAttr.length)return parseInt(this.msoListAttr[0].replace(/mso-list:\s*[A-Za-z]*(\d*)[\s\S]*/gi,"$1"));const e=this.getMainParentListElement();if(!e)return 0;const t=fn.DomUtils.getChildNodes(e.parentNode,(e=>"UL"==e.tagName||"OL"==e.tagName));return f.ListUtils.accumulate(t,0,((t,r,i)=>t+(r==e?i:0)))}importListLevelIndex(){var e;if(this.msoListAttr&&this.msoListAttr.length)return parseInt(this.msoListAttr[0].replace(/mso-list:\s*\w*\s*level/gi,""))-1;let t=0,r=NM.getParentListElement(null===(e=this.parentListElement)||void 0===e?void 0:e.parentElement);for(;r;)t++,r=NM.getParentListElement(null==r?void 0:r.parentElement);return t}importListFormatByListItemElement(){return NM.getListType(this.parentListElement)}static importListFormatByReserveWay(e){if(!e)return Zi.None;const t=encodeURI(e);return"o"==e||t.indexOf("%B7")>-1||t.indexOf("%A7")>-1?Zi.Bullet:/^(IX|IV|V?I{1,3})/.test(e)?Zi.UpperRoman:/^(ix|iv|v?i{1,3})/.test(e)?Zi.LowerRoman:/[0-9]/.test(e)?Zi.Decimal:/[a-z]/.test(e)?Zi.LowerLetter:/[A-Z]/.test(e)?Zi.UpperLetter:Zi.None}importDisplayFormatStringByParentListElement(e,t){const r=NM.getParentListElement(this.parentListElement.parentNode);if(r){const i=NM.getListType(r);return NM.importDisplayFormatStringByParentListFormat(e,i,t)}return""}static importDisplayFormatStringByParentListFormat(e,t,r){return t&&e!=t?"{"+r+"}":""}static importDisplayFormatStringByReserveWay(e,t,r){if(e==Zi.Bullet)return"";if(r.indexOf(".")>-1)return f.ListUtils.accumulate(r.split("."),"",((e,t,r)=>t?e+"{"+r+"}.":e));const i=r.match(/^(\W?)(\w+)(\W?)/);return i&&i.length>2?i[1]+"{"+t+"}"+i[3]:r.charAt(0)}getMainParentListElement(){let e=this.parentListElement?this.parentListElement:null,t=null;for(;e;)t=e,e=NM.getParentListElement(e.parentNode);return t}static getListType(e){return AM.getPropertyByMap(NM.MapListTypeToType,fn.DomUtils.getCurrentStyle(e).listStyleType,Zi.None)}static getListTextElement(e){const t=fn.DomUtils.getNodes(e,(e=>null!=e.outerHTML.match(/mso-list:Ignore/gi)));let r=t.length?t[0]:null;if(!r){const t=fn.DomUtils.getNodes(e,(e=>fn.DomUtils.isTextNode(e)&&e.nodeValue&&!rn.StringUtils.trim(e.nodeValue)||e.textContent&&!rn.StringUtils.trim(e.textContent)||e.innerText&&!rn.StringUtils.trim(e.innerText)));r=t.length?t[0].previousSibling:e.firstChild}return r}static getListText(e){return e?rn.StringUtils.trim((e.nodeValue||fn.DomUtils.getInnerText(e)).split(" ")[0]):""}static getParentListElement(e){const t=["UL","OL"],r=["BODY","DIV","P"];for(;e=null==e?void 0:e.parentElement;){if(r.includes(e.tagName))return null;if(t.includes(e.tagName))return e}return null}static removeSomeHtml(e,t,r){if(1==e.childNodes.length)e.innerHTML=rn.StringUtils.trimStart(e.innerHTML.replace(r,""));else{const r=t.parentNode;r.removeChild(t),r.innerHTML=r.innerHTML.replace(/^<([^\s>]+)(\s[^>]*)?>(\s|&nbsp;){2,}<\/\1>/g,""),t.parentNode!=e&&(e.innerHTML=e.innerHTML.replace(/<([^\s>]+)(\s[^>]*)?><\/\1>/g,""))}}}NM.MapListTypeToType=(new Eu).add("decimal",Zi.Decimal).add("circle",Zi.Bullet).add("disc",Zi.Bullet).add("square",Zi.Bullet).add("lower-alpha",Zi.LowerLetter).add("lower-latin",Zi.LowerLetter).add("upper-alpha",Zi.UpperLetter).add("upper-latin",Zi.UpperLetter).add("lower-roman",Zi.LowerRoman).add("upper-roman",Zi.UpperRoman).get();class kM extends yM{constructor(){super(...arguments),this._ignored=!1}importBefore(){this.importer.addCurrLevelParagraphRunIfNeeded();const e=this.importer.listIndex,t=f.ListUtils.last(this.importer.listInfos),r=t?t.listLevel+1:0;if(9===r)return void(this._ignored=!0);const i=NM.getListType(this.element),n=NM.importDisplayFormatStringByParentListFormat(i,null==t?void 0:t.listFormat,r);this.importer.listInfos.push(new gM(e,r,i,i==Zi.Bullet?tn.Bullet:tn.MultiLevel,n,null))}isImportChildren(){return!0}importAfter(){if(this._ignored)return;this.importer.listInfos.pop();f.ListUtils.last(this.importer.listInfos)||this.importer.listIndex++}}class OM extends kM{elementTag(){return"OL"}}class _M extends yM{constructor(){super(...arguments),this.listInfo=null,this.importChildren=!1}elementTag(){return"P"}importBefore(){this.importer.addCurrLevelParagraphRunIfNeeded(),this.element.innerHTML=this.element.innerHTML.trim();let e=this.element.outerHTML.match(/^<([^\s >]+)(\s[^>]*)?>&nbsp;<\/\1>/gi);(null==e?void 0:e.length)||(this.listInfo=this.getListInfo(),this.importChildren=!0)}isImportChildren(){return this.importChildren}importAfter(){this.importer.addParagraphRun(this.element,this.listInfo)}getListInfo(){var e,t;return rn.StringUtils.trim(fn.DomUtils.getInnerText(this.element))&&"LI"===(null===(t=null===(e=this.element.parentElement)||void 0===e?void 0:e.closest("ul,ol,li"))||void 0===t?void 0:t.tagName)?this.importer.currListItemLevelInfo?this.importer.currListItemLevelInfo.tagImporter.paragraphWasAddedBefore?null:this.importer.currListInfo:this.importer.paragraphListPropertiesUtils.import(this.element,new on.FixedInterval(this.importer.currPosition,0)):null}}class UM extends _M{elementTag(){return"H1"}}class HM extends _M{elementTag(){return"H2"}}class VM extends _M{elementTag(){return"H3"}}class WM extends _M{elementTag(){return"H4"}}class zM extends _M{elementTag(){return"H5"}}class jM extends _M{elementTag(){return"H6"}}class XM extends yM{elementTag(){return"PRE"}importBefore(){}isImportChildren(){return!0}importAfter(){}shouldPreserveLineBreaksOnChilds(){return!0}}class GM extends yM{constructor(){super(...arguments),this.importChilds=!0}elementTag(){return"SPAN"}importBefore(){var e,t;const r=null===(t=null===(e=this.element.getAttribute("style"))||void 0===e?void 0:e.split(";").find((e=>e.startsWith("mso-tab-count:"))))||void 0===t?void 0:t.replace("mso-tab-count:","");if(r){const e=parseInt(r);this.importer.addRun(new pM(this.importer.modelManager.model,this.importer.measurer,rn.StringUtils.repeat(an.specialCharacters.TabMark,e),this.importer.htmlImporterMaskedCharacterProperties.getBundleFrom(this.element,new on.FixedInterval(this.importer.currPosition,e)))),this.importChilds=!1}}isImportChildren(){return this.importChilds}importAfter(){}}var KM,qM,$M,JM,YM,QM,ZM,eE,tE,rE,iE,nE,oE,aE,sE=__webpack_require__(2217);class lE{constructor(e,t,r){this.width=e,this.properties=t,this.rows=r,this.normalize()}get interval(){return on.FixedInterval.fromPositions(this.rows[0].cells[0].startPosition,f.ListUtils.last(f.ListUtils.last(this.rows).cells).endPosition)}normalize(){const e=f.ListUtils.min(this.rows,(e=>e.gridBefore)).gridBefore;e>0&&f.ListUtils.forEach(this.rows,(t=>t.gridBefore-=e));const t=f.ListUtils.min(this.rows,(e=>e.gridAfter)).gridAfter;t>0&&f.ListUtils.forEach(this.rows,(e=>e.gridAfter-=t));const r=f.ListUtils.maxExtended(this.rows,(e=>e.countLogicColumns)).maxValue;f.ListUtils.forEach(this.rows,(e=>{const t=e.countLogicColumns;if(t<r){const i=r-t-e.gridAfter;i&&(0==e.gridAfter&&(e.widthAfter=(new lr).init(0,Je.Auto)),e.gridAfter=i)}}))}}class dE{constructor(e,t,r,i,n,o){this.gridBefore=e,this.gridAfter=t,this.widthBefore=r,this.widthAfter=i,this.properties=n,this.cells=o}get countLogicColumns(){return this.gridBefore+this.gridAfter+f.ListUtils.accumulate(this.cells,0,((e,t)=>e+t.columnSpan))}getCellByColumnSpan(e){let t=this.gridBefore;return f.ListUtils.elementBy(this.cells,(r=>!!new on.FixedInterval(t,r.columnSpan).contains(e)||(t+=r.columnSpan,!1)))}}class cE{constructor(e,t,r,i,n,o,a){this.preferredWidth=e,this.startPosition=t,this.endPosition=r,this.columnSpan=i,this.rowSpan=n,this.properties=o,this.firstWhenVerticallyMerged=a}clone(){return new cE(this.preferredWidth,-1,-1,this.columnSpan,this.rowSpan,this.properties,this.firstWhenVerticallyMerged)}}class hE extends yM{constructor(){super(...arguments),this.rows=[]}elementTag(){return hE.tagName}importBefore(){const e=f.ListUtils.last(this.importer.importedTablesInfo);(e&&f.ListUtils.last(f.ListUtils.last(e.rows).cells).endPosition==this.importer.currPosition||!this.importer.prevRunIsParagraph)&&this.importer.addParagraphRun(this.element),f.ListUtils.last(this.importer.levelInfo).allowInsertRuns=!1,this.element.innerHTML=this.element.innerHTML.replace(/<td([^>]*mso-cell-special:\s*placeholder[^>]*)>[\s\S]*?<\/td>/gi,"<td$1></td>")}isImportChildren(){return!0}importAfter(){if(!this.element.rows.length)return;const e=new lE(this.getTableWidth(),this.getTableProperties(this.colorProvider),this.rows);e.width.type==Je.ModelUnits&&e.width.value>0||f.ListUtils.unsafeAnyOf(this.rows,(e=>f.ListUtils.unsafeAnyOf(e.cells,(e=>e.preferredWidth.type==Je.ModelUnits&&e.preferredWidth.value>0))))||(e.width.type=Je.FiftiethsOfPercent,e.width.value=100*lr.MULTIPLIER_FOR_PERCENTS),this.importer.importedTablesInfo.push(e)}getTableProperties(e){const t=new mr;t.layoutType=Oe.Autofit,t.setUseValue(ur.UseTableLayout,!0);const r=fn.DomUtils.getCurrentStyle(this.element);AM.setBorders(e,t,t.borders,r,ur.UseTopBorder,ur.UseRightBorder,ur.UseBottomBorder,ur.UseLeftBorder);const i=AM.getTableWidthUnit(r.marginLeft);if(i&&i.type!=Je.Nil&&(t.indent=i,t.setUseValue(ur.UseTableIndent,!0)),r.borderSpacing&&"collapse"!=r.borderCollapse){const e=AM.getTableWidthUnit(r.borderSpacing.split(" ")[0]);e&&e.type!=Je.Nil&&(t.cellSpacing=e,t.setUseValue(ur.UseCellSpacing,!0))}const n=w.i.fromString(r.backgroundColor);return n&&(t.shadingInfo=fe.createByColor(he.makeByColor(n)),t.setUseValue(ur.UseShadingInfoIndex,!0)),t}getTableWidth(){let e=AM.getTableWidthUnit(this.element.style.width||sE.F.getElementAttribute(this.element,"width"));if(!e){const t=fn.DomUtils.getParentByTagName(this.element,"TD");t&&(e=AM.getTableWidthUnit(t.style.width||sE.F.getElementAttribute(t,"width")))}return e||(new lr).init(0,Je.Auto)}}hE.tagName="TABLE";class uE extends yM{elementTag(){return"TBODY"}importBefore(){}isImportChildren(){return!0}importAfter(){}}class pE extends yM{constructor(){super(...arguments),this.cells=[]}elementTag(){return pE.tagName}importBefore(){this.rowElement=this.element,this.gridBeforeInfo=pE.importGridBefore(this.rowElement)}isImportChildren(){return!0}importAfter(){if(this.cells.length){const e=this.getClosestImporterByTagName(hE.tagName);gE.addVerticalMergedCells(this.importer,e,this);const{gridAfter:t,widthAfter:r}=pE.importGridAfter(this.rowElement),i=new za;e.rows.push(new dE(this.gridBeforeInfo.gridBefore,t,this.gridBeforeInfo.widthBefore,r,i,this.cells))}}static importGridBefore(e){let t=0,r=0;const i=e.innerHTML.match(/^<td[^>]*mso-cell-special:\s*placeholder[^>]*><\/td>/gi);if(i&&i.length){const e=i[0].replace(/<td[^>]*colspan="(\d+)"[^>]*><\/td>/gi,"$1");t=e==i[0]?1:parseInt(e);const n=i[0].replace(/<td[^>]*width="(\d+)"[^>]*><\/td>/gi,"$1");r=n==i[0]?0:g.u.pixelsToTwips(parseFloat(n))}return{gridBefore:t,widthBefore:lr.create(r,Je.ModelUnits)}}static importGridAfter(e){let t=0,r=0;const i=e.innerHTML.match(/<td[^>]*mso-cell-special:\s*placeholder[^>]*><\/td>$/gi);if(i&&i.length){const e=i[0].replace(/<td[^>]*colspan="(\d+)"[^>]*><\/td>/gi,"$1");t=e==i[0]?1:parseInt(e);const n=i[0].replace(/<td[^>]*width="(\d+)"[^>]*><\/td>/gi,"$1");r=n==i[0]?0:g.u.pixelsToTwips(parseFloat(n))}return{gridAfter:t,widthAfter:lr.create(r,Je.ModelUnits)}}}pE.tagName="TR";class gE extends yM{elementTag(){return"TD"}importBefore(){f.ListUtils.last(this.importer.levelInfo).allowInsertRuns=!0,this.rowImporter=this.getClosestImporterByTagName(pE.tagName),gE.addVerticalMergedCells(this.importer,this.getClosestImporterByTagName(hE.tagName),this.rowImporter),this.startPosition=this.importer.currPosition}isImportChildren(){return!0}importAfter(){const e=this.element,t=AM.getTableWidthUnit(this.element.style.width||sE.F.getElementAttribute(this.element,"width")),r=t||(new lr).init(0,Je.Auto),i=e.colSpan>1e3?1:0==e.colSpan?Number.MAX_VALUE:e.colSpan,n=0==e.rowSpan?Number.MAX_VALUE:e.rowSpan,o=fn.DomUtils.getCurrentStyle(e),a=new cr;this.importCellBorders(this.importer.modelManager.model.colorProvider,a,o),this.importMargins(a,o),this.setVerticalAlign(a,o),this.setBackgroungColor(a,o);const s=this.importer.getLastImportedRun();(!s||!this.importer.prevRunIsParagraph||this.importer.currPosition-s.runLength<this.startPosition)&&this.importer.addParagraphRun(this.element,null,!0),this.rowImporter.cells.push(new cE(r,this.startPosition,this.importer.currPosition,i,n,a,!0))}static addVerticalMergedCells(e,t,r){const i=f.ListUtils.last(t.rows);if(!i)return;let n=r.gridBeforeInfo.gridBefore+f.ListUtils.accumulate(r.cells,0,((e,t)=>e+t.columnSpan));for(;;){const t=i.getCellByColumnSpan(n);if(!(t&&t.rowSpan>1))break;{const i=t.clone();i.rowSpan--,i.startPosition=e.currPosition,i.endPosition=e.currPosition+1,i.firstWhenVerticallyMerged=!1,r.cells.push(i),n+=i.columnSpan,e.addRun(new mM(null,e.charPropsBundle,new Lt,new ts),!0)}}}setBackgroungColor(e,t){let r=w.i.fromString(t.backgroundColor);r&&(e.setUseValue(Ye.UseShadingInfoIndex,!0),e.shadingInfo=fe.createByColor(he.makeByColor(r)))}setVerticalAlign(e,t){const r=gE.verticalAlignInfo[t.verticalAlign];void 0!==r&&(e.verticalAlignment=r,e.setUseValue(Ye.UseVerticalAlignment,!0))}importCellBorders(e,t,r){AM.setBorders(e,t,t.borders,r,Ye.UseTopBorder,Ye.UseRightBorder,Ye.UseBottomBorder,Ye.UseLeftBorder)}importMargins(e,t){this.importMargin(e,t.paddingTop,Ye.UseTopMargin,((e,t)=>e.top=t)),this.importMargin(e,t.paddingRight,Ye.UseRightMargin,((e,t)=>e.right=t)),this.importMargin(e,t.paddingBottom,Ye.UseBottomMargin,((e,t)=>e.bottom=t)),this.importMargin(e,t.paddingLeft,Ye.UseLeftMargin,((e,t)=>e.left=t))}importMargin(e,t,r,i){const n=AM.getTableWidthUnit(t);n&&(i(e.cellMargins,n),e.setUseValue(r,!0))}}gE.verticalAlignInfo=(new Eu).add("bottom",Ke.Bottom).add("middle",Ke.Center).add("top",Ke.Top).get();class mE extends gE{elementTag(){return"TH"}}class fE extends yM{elementTag(){return"TextNode"}importBefore(){let e=this.element.nodeValue||fn.DomUtils.getInnerText(this.element);if(this.enablePreserveLineBreaks||(e=e.replace(/\r\n|\r|\n/g," ")),e&&e.length){if(/^ +$/.test(e)&&this.element.parentNode&&"TD"==this.element.parentNode.tagName){const e=this.importer.levelInfo[this.importer.levelInfo.length-2];if(e.childElements[0]==this.element||f.ListUtils.last(e.childElements)==this.element)return}if(this.enablePreserveLineBreaks){const t=(0,yd.Ev)(e);for(let e=0;e<t.length;e++)t[e].length&&this.addRun(new pM(this.importer.modelManager.model,this.importer.measurer,t[e],this.importer.htmlImporterMaskedCharacterProperties.getBundleFrom(this.element,new on.FixedInterval(this.importer.currPosition,t[e].length)))),e<t.length-1&&this.importer.addParagraphRun(this.element.parentElement||this.element.parentNode)}else this.addRun(new pM(this.importer.modelManager.model,this.importer.measurer,e,this.importer.htmlImporterMaskedCharacterProperties.getBundleFrom(this.element,new on.FixedInterval(this.importer.currPosition,e.length))))}}isImportChildren(){return!1}importAfter(){}}class bE extends yM{elementTag(){return"TT"}importBefore(){}isImportChildren(){return!0}importAfter(){}}class CE extends kM{elementTag(){return"UL"}}class SE extends yM{elementTag(){return"NoTag"}importBefore(){O.print(L.HtmlImporter,"HtmlUndefinedTagImporter.importBefore undefined tag",this.element)}isImportChildren(){return!!this.importer.currElementChildren.length}importAfter(){}}class IE{constructor(e){this.fontInfoCache=e}static isGenericFamily(e){return!!IE.genericFontFamilies[e]}chooseByCssString(e){const t=fn.DomUtils.getFontFamiliesFromCssString(e);if(0==t.length)return null;if(1==t.length&&IE.isGenericFamily(t[0]))return this.chooseGenericFont[t[0]];const r={};this.fontInfoCache.forEach((e=>{const t=e.getFontFamilies();for(let i=0;i<t.length;i++){const n=t[i];if(!IE.isGenericFamily(n)){(r[n]||(r[n]={}))[i]=e}}}));for(let e of t){const t=r[e];if(t){return t[Object.keys(t)[0]]}}return null}chooseGenericFont(e){const t=IE.genericFontFamilies[e];if(!e)return null;const r=this.fontInfoCache.findItemByPredicate((e=>f.ListUtils.unsafeAnyOf(e.getFontFamilies(),(e=>e==t))));if(r)return r;const i=this.fontInfoCache.findItemByPredicate((t=>f.ListUtils.unsafeAnyOf(t.getFontFamilies(),(t=>t==e))));return i||null}}IE.genericFontFamilies={serif:"Times New Roman","sans-serif":"Arial",cursive:"Comic Sans MS",fantasy:"Comic Sans MS",monospace:"Courier New"};class PE{constructor(e,t,r){this.fontInfo=e,this.subDocument=t,this.applyNewFontOnIntervalsAfterLoad=r}}class wE{static getFontSize(e,t){const r=wE.getFontSizeCore(e);if(null!==r)return r;const i=wE.getFontSizeCore(t),n=null!==i?i:12;return e.indexOf("em")>0?parseInt(e)*n:e.indexOf("%")>0?parseInt(e)*n/100:null}static getFontSizeCore(e){return e?e.indexOf("px")>0?g.u.pixelsToPoints(parseInt(e)):e.indexOf("pt")>0?parseInt(e):null:null}}class yE{get model(){return this.importer.modelManager.model}get controlOptions(){return this.importer.modelManager.richOptions.control}constructor(e,t,r,i){this.importer=e,this.loadFontInfos=t,this.tempFontInfoCache=r,this.allowCreateNewFonts=i}getBundleFrom(e,t){return new pn(this.import(e,t,this.importer.charPropsBundle.props),this.importer.charPropsBundle.style)}import(e,t,r){return this.initialCharacterProperties=r,this.result=r.clone(),this.styledElement=fn.DomUtils.isHTMLElementNode(e)?e:e.parentElement||e.parentNode,this.styledElement!==e&&"TD"==this.styledElement.tagName.toUpperCase()?this.result:(this.currentStyle=fn.DomUtils.getCurrentStyle(this.styledElement),this.currentStyle?(this.importFontBold(),this.importFontItalic(),this.importAllCaps(),this.importStrikeoutType(),this.importUnderlineType(),this.importForeColor(),this.importBackColor(),this.importFontInfo(t),this.importFontSize(),this.importHidden(),this.importSuperscript(),this.importSubscript(),this.result):this.result)}importFontBold(){switch(this.currentStyle.fontWeight){case"bold":case"700":this.result.fontBold=!0,this.result.setUseValue(ie.UseFontBold,!0)}}importFontItalic(){"italic"==this.currentStyle.fontStyle&&(this.result.fontItalic=!0,this.result.setUseValue(ie.UseFontItalic,!0))}importAllCaps(){"uppercase"==this.currentStyle.textTransform&&(this.result.allCaps=!0,this.result.setUseValue(ie.UseAllCaps,!0))}importStrikeoutType(){/.*line-through.*/gi.test(this.currentStyle.textDecoration)&&(this.result.fontStrikeoutType=se.Single,this.result.setUseValue(ie.UseFontStrikeoutType,!0))}importUnderlineType(){/.*underline.*/gi.test(this.currentStyle.textDecoration)&&(this.result.fontUnderlineType=le.Single,this.result.setUseValue(ie.UseFontUnderlineType,!0))}importForeColor(){if(""!==this.styledElement.style.color){const e=w.i.fromString(this.currentStyle.color);null!=e&&(this.result.textColor=he.makeByColor(e),this.result.setUseValue(ie.UseForeColorIndex,!0))}}importBackColor(){if(""!==this.styledElement.style.backgroundColor){const e=w.i.fromString(this.currentStyle.backgroundColor);e&&(this.result.shadingInfo=fe.createByColor(he.makeByColor(e)),this.result.setUseValue(ie.UseShadingInfoIndex,!0),this.result.setUseValue(ie.UseHighlightColorIndex,!1))}}importFontInfo(e){if(this.styledElement.style.fontFamily){const t=this.currentStyle.fontFamily;let r=new IE(this.model.cache.fontInfoCache).chooseByCssString(t);if(!r)if(Bb.isEnabled(this.controlOptions.characterFormatting)&&this.allowCreateNewFonts){const i=fn.DomUtils.getFontFamiliesFromCssString(t)[0];if(r=this.tempFontInfoCache.getItemByName(i),!r){r=(this.initialCharacterProperties.fontInfo||this.model.defaultCharacterProperties.fontInfo).clone(),r.name=i,r.cssString=t,this.tempFontInfoCache.getItem(r)}this.loadFontInfos.push(new PE(r,this.importer.subDocument,e))}else r=this.model.defaultCharacterProperties.fontInfo;this.result.fontInfo=r,this.result.setUseValue(ie.UseFontName,!0)}}importFontSize(){if(this.styledElement.style.fontSize){const e=fn.DomUtils.getCurrentStyle(this.styledElement.parentElement||this.styledElement.parentNode),t=wE.getFontSize(this.currentStyle.fontSize,e?e.fontSize:null);null!=t&&t>0&&(this.result.fontSize=t,this.result.setUseValue(ie.UseDoubleFontSize,!0))}}importHidden(){"none"==this.currentStyle.display&&(this.result.hidden=!0,this.result.setUseValue(ie.UseHidden,!0))}importSuperscript(){"super"==this.currentStyle.verticalAlign&&(this.result.script=ne.Superscript,this.result.setUseValue(ie.UseScript,!0))}importSubscript(){"sub"==this.currentStyle.verticalAlign&&(this.result.script=ne.Subscript,this.result.setUseValue(ie.UseScript,!0))}}class xE{import(e,t,r=!1){this.result=new Lt,this.element=t,this.elementStyle=t.style;const i=fn.DomUtils.getCurrentStyle(t);return this.importAlignment(),this.importFirstLineIndent(),this.importLeftIndent(),this.importRightIndent(),this.importLineSpacing(),this.importSpacingBefore(),this.importSpacingAfter(),this.importBackColor(),r||(this.importTopBorder(e,i),this.importRightBorder(e,i),this.importBottomBorder(e,i),this.importLeftBorder(e,i)),this.result}importAlignment(){let e=this.elementStyle.textAlign;if(!e||!e.length){const t=fn.DomUtils.getParentByTagName(this.element,"TD");t&&(e=sE.F.getElementAttribute(t,"align"))}this.result.alignment=AM.getPropertyByMap(xE.MapAlignmentToType,e,Ae.Left),this.result.setUseValue(Be.UseAlignment,this.result.alignment!=Ae.Left)}importFirstLineIndent(){const e=AM.getValueInTwips(this.elementStyle.textIndent);null!=e&&0!=e&&(this.result.firstLineIndentType=e>0?ke.Indented:ke.Hanging,this.result.firstLineIndent=Math.abs(e),this.result.setUseValue(Be.UseFirstLineIndent,!0))}importLeftIndent(){const e=AM.getValueInTwips(this.elementStyle.marginLeft);null!=e&&e>=0&&(this.result.leftIndent=e,this.result.setUseValue(Be.UseLeftIndent,!0))}importRightIndent(){const e=AM.getValueInTwips(this.elementStyle.marginRight);null!=e&&e>=0&&(this.result.rightIndent=e,this.result.setUseValue(Be.UseRightIndent,!0))}importSpacingBefore(){const e=AM.getValueInTwips(this.elementStyle.marginTop);null!=e&&e>=0&&(this.result.spacingBefore=e,this.result.setUseValue(Be.UseSpacingBefore,!0))}importSpacingAfter(){const e=AM.getValueInTwips(this.elementStyle.marginBottom);null!=e&&e>=0&&(this.result.spacingAfter=e,this.result.setUseValue(Be.UseSpacingAfter,!0))}importBackColor(){if(""!==this.element.style.backgroundColor){const e=w.i.fromString(this.element.style.backgroundColor);e&&(this.result.shadingInfo=fe.createByColor(he.makeByColor(e)),this.result.setUseValue(Be.UseShadingInfoIndex,!0))}}importLineSpacing(){this.result.setUseValue(Be.UseLineSpacing,!0),this.result.setUseValue(Be.UseBeforeAutoSpacing,!0),this.result.setUseValue(Be.UseAfterAutoSpacing,!0);const e=this.elementStyle.lineHeight,t=this.elementStyle["mso-line-height-rule"],r=AM.getLineSpacing(e,t);this.result.lineSpacing=r.value,this.result.lineSpacingType=r.type}importTopBorder(e,t){const r=AM.getBorderInfo(e,t.borderTopWidth,t.borderTopStyle,t.borderTopColor);r&&(this.result.topBorder.copyFrom(r),this.result.setUseValue(Be.UseTopBorder,r.style!=de.None))}importRightBorder(e,t){const r=AM.getBorderInfo(e,t.borderRightWidth,t.borderRightStyle,t.borderRightColor);r&&(this.result.rightBorder.copyFrom(r),this.result.setUseValue(Be.UseRightBorder,r.style!=de.None))}importBottomBorder(e,t){const r=AM.getBorderInfo(e,t.borderBottomWidth,t.borderBottomStyle,t.borderBottomColor);r&&(this.result.bottomBorder.copyFrom(r),this.result.setUseValue(Be.UseBottomBorder,r.style!=de.None))}importLeftBorder(e,t){const r=AM.getBorderInfo(e,t.borderLeftWidth,t.borderLeftStyle,t.borderLeftColor);r&&(this.result.leftBorder.copyFrom(r),this.result.setUseValue(Be.UseLeftBorder,r.style!=de.None))}}xE.MapAlignmentToType=(new Eu).add("right",Ae.Right).add("justify",Ae.Justify).add("center",Ae.Center).get();class TE{static import(e){var t,r;const i=new ts,n=null===(r=null===(t=e.getAttribute("style"))||void 0===t?void 0:t.split(";").find((e=>e.startsWith("tab-stops:"))))||void 0===r?void 0:r.replace("tab-stops:","");if(n){const e=n.split(" ");for(let t=0;t<e.length;t++){let r=Ha.Left,n=Sg.None,o=parseFloat(e[t]);for(;isNaN(o);){switch(e[t]){case"right":r=Ha.Right;break;case"center":r=Ha.Center;break;case"decimal":r=Ha.Decimal;break;case"dotted":n=Sg.Dots;break;case"dashed":n=Sg.Hyphens;break;case"middot":n=Sg.MiddleDots;break;case"heavy":n=Sg.ThickLine;break;case"lined":n=Sg.Underline}t++,o=parseFloat(e[t])}const a=e[t].substring(e[t].length-2);let s;switch(a){case"pt":s=g.u.pointsToTwipsF(o);break;case"cm":s=g.u.centimetersToTwipsF(o);break;case"in":s=g.u.inchesToTwipsF(o);break;case"pc":s=g.u.picasToTwips(o);break;default:console.warn(`Unknown unit: ${a}. Tab stop skipped`);continue}const l=new rs(s,r,n,!1,!1);i.add(l)}}return i}}class vE{constructor(e,t,r){this.element=e,this.childElements=t,this.allowInsertRuns=r}initTagImporter(e){if(fn.DomUtils.isTextNode(this.element))this.tagImporter=new fE(e);else{const t=e.tagImporters[vE.getElementTag(this.element)];this.tagImporter=new(t||SE)(e)}return this}static getElementTag(e){const t=fn.DomUtils.isHTMLElementNode(e)&&e.tagName;return t?t.toUpperCase():""}}class ME{constructor(e,t){this.runsInfo=e,this.tablesInfo=t}}class EE{get currElement(){return f.ListUtils.last(this.levelInfo).element}get currElementChildren(){return f.ListUtils.last(this.levelInfo).childElements}get prevLevelInfo(){return this.levelInfo[this.levelInfo.length-2]}get currLevelInfo(){return f.ListUtils.last(this.levelInfo)}get currListItemLevelInfo(){return f.ListUtils.reverseElementBy(this.levelInfo,(e=>{var t;return"LI"===(null===(t=e.tagImporter)||void 0===t?void 0:t.elementTag())}))}get currListInfo(){const e=this.currListItemLevelInfo;return e&&!e.tagImporter.paragraphWasAddedBefore?f.ListUtils.last(this.listInfos):null}get subDocument(){return this.subDocPosition.subDocument}constructor(e,t,r,i,n,o){this.fieldsId=0,this.listIndex=0,this.listInfos=[],EE.importers||(EE.importers=[xM,TM,vM,MM,EM,DM,FM,RM,LM,BM,OM,_M,hE,uE,UM,HM,VM,WM,zM,jM,XM,GM,pE,bE,gE,mE,CE]),this.charPropsBundle=n,this.subDocPosition=r,this.modelManager=e,this.measurer=t,this.currPosition=this.subDocPosition.position,this.levelInfo=[new vE(null,i,!0)],this.formatImagesImporter=o,this.loadFontInfos=[],this.tempFontInfoCache=new _n(this.modelManager.model.cache.fontInfoCache.fontMeasurer),this.htmlImporterMaskedCharacterProperties=new yE(this,this.loadFontInfos,this.tempFontInfoCache,!e.richOptions.fonts.limitedFonts),this.paragraphListPropertiesUtils=new NM(this,this.htmlImporterMaskedCharacterProperties),this.tagImporters={};for(let e of EE.importers)this.tagImporters[new e(this).elementTag()]=e}import(){let e;return this.importStarted=!1,this.importedRunsInfo=[],this.importedTablesInfo=[],f.ListUtils.clear(this.loadFontInfos),this.tempFontInfoCache.clear(),this.modelManager.history.addTransaction((()=>{const t=this.subDocPosition.position;this.prevRunIsParagraph=0==t||this.subDocument.getRunByPosition(t-1).isParagraphOrSectionRun()&&f.ListUtils.allOf(this.subDocument.tables,(e=>e.getEndPosition()!=t)),this.convertChildElements(),e=this.importedRunsInfo.length?new wM(this.modelManager,this.subDocPosition,new ME(this.importedRunsInfo,this.getSortedTables()),this.charPropsBundle).insert():new on.FixedInterval(this.subDocPosition.position,0);for(let e of this.loadFontInfos)this.modelManager.modelManipulator.font.loadFontInfo(e.fontInfo,e.subDocument,[e.applyNewFontOnIntervalsAfterLoad],this.measurer);this.formatImagesImporter&&this.registerImageRuns()})),e}convertChildElements(e=!1){for(let t of this.currElementChildren)this.convertElement(t,e)}getSortedTables(){return this.importedTablesInfo.sort(((e,t)=>{const r=e.interval,i=t.interval,n=r.start-i.start;return n||(r.containsInterval(i)?-1:1)}))}convertElement(e,t){const r=new vE(e,e.childNodes,f.ListUtils.last(this.levelInfo).allowInsertRuns).initTagImporter(this);this.levelInfo.push(r);const i=r.tagImporter;this.putDownParentPropertiesToChild(),i.enablePreserveLineBreaks=t,i.isAllowed()&&i.importBefore(),i.isImportChildren()&&this.convertChildElements(t||i.shouldPreserveLineBreaksOnChilds()),i.isAllowed()&&i.importAfter(),this.levelInfo.pop()}putDownParentPropertiesToChild(){if(!this.currElementChildren)return;const e=this.currElement,t=EE.MapMissTablePropertiesByTagNames[f.ListUtils.last(this.levelInfo).tagImporter.elementTag()];f.ListUtils.forEach(this.currElementChildren,(r=>{const i=this.getStyles(r);if(r.nodeType===Node.ELEMENT_NODE){for(var n in this.getStyles(e))t&&/^(border|background|marginLeft)/gi.test(n)||""!==i[n]&&void 0!==i[n]||""===e.style[n]||EE.MapShorthandProperty[n]||(i[n]=e.style[n]);r.setAttribute("style",Object.keys(i).map((e=>`${e}:${i[e]}`)).join(";"))}}))}getStyles(e){var t;const r=null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"style");if(!r)return{};const i=new RegExp("url\\(.*?\\)","gi"),n="$URL",o=r.match(i);return r.replace(i,n).split(";").reduceRight(((e,t)=>{if(!t)return e;const r=t.indexOf(":"),i=t.substring(0,r).trim(),a=t.substring(r+1).trim();return e[i]=a===n?o.pop():a,e}),{})}addRun(e,t=!1){if(t||f.ListUtils.last(this.levelInfo).allowInsertRuns){const t=e.runType==cs.ParagraphRun||e.runType==cs.SectionRun;this.importedRunsInfo.push(e),this.currPosition+=e.runLength,this.prevRunIsParagraph=t,this.importStarted=!0,t&&this.currListItemLevelInfo&&(this.currListItemLevelInfo.tagImporter.paragraphWasAddedBefore=!0)}}addParagraphRun(e,t=null,r=!1){const i=(new xE).import(this.modelManager.model.colorProvider,e,r),n=TE.import(e);this.removeAllTrailingLineBreaks(),this.addRun(new mM(t,this.charPropsBundle,i,n))}addCurrLevelParagraphRunIfNeeded(){this.currLevelInfo.element.previousSibling&&!this.prevRunIsParagraph&&this.addParagraphRun(this.currLevelInfo.element,this.currListInfo)}removeAllTrailingLineBreaks(){const e=this.importedRunsInfo.length-1;for(let t=e;t>=e-1;t--){let e=this.importedRunsInfo[t];if(!(e instanceof pM))return;if(e.text!==an.specialCharacters.LineBreak)return;this.importedRunsInfo.pop(),this.currPosition-=e.runLength}}getLastImportedRun(){return f.ListUtils.last(this.importedRunsInfo)}columnSize(){const e=this.modelManager.model.getSectionByPosition(this.subDocPosition.position);return TS.findMinimalColumnSize(e.sectionProperties).applyConverter(g.u.pixelsToTwips)}registerImageRuns(){let e=-1;this.subDocument.chunks.forEach((t=>{t.textRuns.forEach((t=>{if(t instanceof lh){e=this.findIndexImportedInlinePictureRunInfo(t.info.publicAPIID,++e);const r=new pu(this.subDocument,t.startOffset),i=this.importedRunsInfo[e],n=Mb.initByActualSize(i.actualSize),o=new Ew(r,n,t);this.formatImagesImporter.registerImageRun(o)}}))}))}findIndexImportedInlinePictureRunInfo(e,t=0){for(let r,i=t;r=this.importedRunsInfo[i];i++)if(r instanceof fM&&r.picInfo.publicAPIID===e)return i;return-1}static convertHtml(e){O.print(L.HtmlImporter,"convertHtml",(()=>e)),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/\s*mso-bidi-font-family/gi,"font-family")).replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,"")).replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,'"')).replace(/\s*TEXT-INDENT: 0cm\s*;/gi,"")).replace(/\s*TEXT-INDENT: 0cm\s*"/gi,'"')).replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,'"')).replace(/<\w+:imagedata/gi,"<img")).replace(/<p([^>]*)><o:[pP][^>]*>\s*<\/o:[pP]><\/p>(?=\s*<\/td>)/gi,"<p$1>&nbsp;</p>")).replace(/<\/?\w+:[^>]*>/gi,"")).replace(/<STYLE[^>]*>[\s\S]*?<\/STYLE[^>]*>/gi,"")).replace(/<(?:META|LINK)[^>]*>\s*/gi,"")).replace(/<\\?\?xml[^>]*>/gi,"")).replace(/<o:[pP][^>]*>\s*<\/o:[pP]>/gi,"")).replace(/<o:[pP][^>]*>.*?<\/o:[pP]>/gi,"&nbsp;")).replace(/<st1:.*?>/gi,"")).replace(/<\!--[\s\S]*?-->/g,"")).replace(/\s*style="\s*"/gi,"")).replace(/style=""/gi,"")).replace(/style=''/gi,"");var t=new RegExp('(?:style=\\")([^\\"]*)(?:\\")',"gi"),r=(e=(e=(e=(e=(e=(e=e.replace(t,(e=>e=(e=e.replace(/&quot;/gi,"'")).replace(/&#xA;/gi," ")))).replace(/^\s|\s$/gi,"")).replace(/<font[^>]*>([^<>]+)<\/font>/gi,"$1")).replace(/<span\s*><span\s*>([^<>]+)<\/span><\/span>/gi,"$1")).replace(/<span>([^<>]+)<\/span>/gi,"$1")).replace(/<caption([^>]*)>[\s\S]*?<\/caption>/gi,"")).match(/<[^>]*style\s*=\s*[^>]*>/gi);if(r&&r.length>0)for(var i,n=0;i=r[n];n++){var o=i.match(/\s*font-family\s*:\s*(([^;]*)([\"';\s)](?!>))|([^;"']*))/gi);if(o&&o.length>1){for(var a,s=o[0].replace(/font-family\s*:\s*([^;]*)[\"'; ]/gi,"$1"),l=i,d=0;a=o[d];d++)l=l.replace(a,"font-family: "+s+";");e=e.replace(i,l)}}var c=(e=(e=e.replace(/^\n|\n$/gi,"")).replace(/(\n+(<br>)|(<\/p>|<br>)\n+)/gi,"$2$3")).match(/<pre([\s\S]*)<\/pre>/g);return c&&f.ListUtils.forEach(c,(t=>{e=e.replace(t,t.replace(/\n/gi,"<p/>"))})),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/(\r*\n+\s+)|(\s+\r*\n+)/gi," ")).replace(/\n+/gi," ")).replace(/\n/gi,an.specialCharacters.LineBreak)).replace(/(<\/(?!(p)+)(\s*[^>]*)?>)<\/td>/gi,"$1<p>&nbsp;</p></td>")).replace(/(<\/(?!(p)+)(\s*[^>]*)?>)<\/th>/gi,"$1<p>&nbsp;</p></th>")).replace(/<script(\s[^>]*)?>[\s\S]*?<\/script>/gi,"")).replace(/<u>([\s\S]*?)<\/u>/gi,'<span style="text-decoration: underline">$1</span>')).replace(/<s>([\s\S]*?)<\/s>/gi,'<span style="text-decoration: line-through">$1</span>')).replace(/<\/([^\s>]+)(\s[^>]*)?><br><\/([^\s>]+)(\s[^>]*)?>/gi,"")).replace(/\s*(<([ph]\d?|ol|ul|li))/gi,"$1")).replace(/(<\/([ph]\d?|ol|ul|li)>)\s*/gi,"$1"),e=this.extractBodyContent(e),O.print(L.HtmlImporter,"convertHtml",(()=>e)),e}static extractBodyContent(e){const t=/<body[^>]*>\s*/i.exec(e);let r=0;t&&(r=t.index+t[0].length);const i=/\s*<\/body[^>]*>\s*/i.exec(e);let n=e.length;return i&&(n=i.index),e.substring(r,n)}}EE.importers=null,EE.MapMissTablePropertiesByTagNames=(new Eu).add("TABLE",!0).add("TD",!0).add("TH",!0).get(),EE.MapShorthandProperty=(new Eu).add("background",!1).add("border",!0).add("borderImage",!0).add("borderTop",!0).add("borderRight",!0).add("borderBottom",!0).add("borderLeft",!0).add("borderWidth",!0).add("borderColor",!0).add("borderStyle",!0).add("borderRadius",!0).add("font",!0).add("fontVariant",!0).add("listStyle",!0).add("margin",!0).add("padding",!0).add("transition",!0).add("transform",!0).add("listStyleType",!0).add("cssText",!0).get();class DE{importFromFile(e,t,r,i){this.init(t);const n=new FileReader;n.onload=()=>{this.importFromString(n.result,t,r,i)},n.onerror=e=>{i(Sw.HtmlFileReaderError)},n.readAsText(e)}importFromString(e,t,r,i,n){this.init(t);try{if(this.fillModel(e,n),!new wu(this.documentModel).checkAll())throw new Error}catch(e){return void i(Sw.HtmlImportError)}r(this.documentModel,this.formatImagesImporter)}init(e){const t=new Mw;t.addSection=!0,t.addParagraph=!0,this.formatImagesImporter=new Dw,this.documentModel=new vw(t).createModel(e).fillModel(),this.modelManager=new cP(this.documentModel,e,new Lb.m1)}fillModel(e,t){const r=document.body.appendChild(this.createContainer());try{r.innerHTML=EE.convertHtml(e),t=t||this.createMaskedCharacterPropertiesBundle();const i=new hM(""),n=new pu(this.documentModel.mainSubDocument,0),o=r.childNodes;new EE(this.modelManager,i,n,o,t,this.formatImagesImporter).import(),this.removeLastParagraph()}finally{document.body.removeChild(r)}}createMaskedCharacterPropertiesBundle(){const e=Pe.createDefault(this.documentModel),t=this.modelManager.model.stylesManager.getDefaultCharacterStyle();return new pn(e,t)}createContainer(){const e=document.createElement("DIV");return e.id="import-container",e.style.width="0",e.style.height="0",e.style.overflow="hidden",e}removeLastParagraph(){const e=this.documentModel.mainSubDocument.getLastParagraph();if(e.length>1)return;const t=this.documentModel.getSectionByPosition(e.startLogPosition.value),r=this.documentModel.mainSubDocument.getLastChunk();this.documentModel.mainSubDocument.paragraphs.pop(),t.setLength(this.documentModel.mainSubDocument,t.getLength()-e.length),r.removeRun(r.textRuns.length-1)}}!function(e){e[e.Centimeter=0]="Centimeter",e[e.Inch=1]="Inch"}(KM||(KM={}));class FE extends g.u{getUnits(){return KM.Centimeter}twipsToUI(e){return g.u.twipsToCentimeters(e)}UIToTwips(e){return g.u.centimetersToTwips(e)}}class RE extends g.u{getUnits(){return KM.Inch}twipsToUI(e){return g.u.twipsToInches(e)}UIToTwips(e){return g.u.inchesToTwips(e)}}class LE extends qc{constructor(e,t,r,i,n){super(e,t),this.cacheInfo=r,this.width=i.width,this.height=i.height,this.description=n,this.isLoaded=this.cacheInfo.isLoaded}equals(e){return super.equals(e)&&this.cacheInfo.equals(e.cacheInfo)&&this.isLoaded==e.isLoaded&&this.description===e.description}clone(){const e=new LE(this.characterProperties,this.colorInfo,this.cacheInfo,this.createSize(),this.description);return e.copyFrom(this),e}getType(){return lc.Picture}pushInfoForMeasure(e,t){}popInfoForMeasure(e,t){}getAscent(){return this.height}getDescent(){return 0}isVisible(){return!0}isVisibleForRowAlign(){return!0}renderGetContent(e){return e.renderPictureBoxContent(this.createSize(),this.cacheInfo,this.hyperlinkTip,this.description)}isWhitespace(){return!1}isLineBreak(){return!1}}class BE{constructor(){this.childElements=[],this.callbacks=[]}getHtmlString(e=!1){const t=this.childElements.map((e=>"string"==typeof e?e:e.outerHTML)).join("");return e?this.addDefaultMarkup(t):t}isEmpty(){return 0===this.callbacks.length&&0===this.childElements.length}clear(){return this._currentElement=null,this.callbacks=[],this.childElements=[],this}startChild(e,t){const r=t?document.createElementNS(t,e):document.createElement(e);return this._currentElement?this._currentElement.appendChild(r):this.childElements.push(r),this._currentElement=r,this}configure(e){return e(this._currentElement),this}addCallback(e){this.callbacks.push(e)}assignFrom(e){return e?"string"==typeof e?(this.addElement(e),this):(e.callbacks.forEach((e=>{e(this)})),e.childElements.forEach((e=>{this.addElement(e)})),e.clear(),this):this}addElement(e){return e?this._currentElement?("string"==typeof e?this._currentElement.innerHTML+=e:this._currentElement?this._currentElement.appendChild(e):this._currentElement=e,this):(this.childElements.push(e),this):this}addBreak(e){return this.startChild("br"),e&&this.configure((t=>t.style.cssText=e)),this.endChild("br"),this}endChild(e){try{let t=this._currentElement;for(;t.tagName.toLowerCase()!==e.toLowerCase();)t=t.parentElement;this._currentElement=t.parentElement}catch(t){console.warn(`The element with the ${e} tag is not found.`)}return this}addDefaultMarkup(e){return'<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body>'+e+"</body></html>"}}class AE{get modelManager(){return this.exportModelOptions.modelManager}get colorProvider(){return this.modelManager.model.colorProvider}get unitConverter(){return this.exportModelOptions.uiUnitConverter}get documentRenderer(){return this.exportModelOptions.pictureRenderer}get lastMaxNumPages(){return this.exportModelOptions.lastMaxNumPages}get pageIndex(){return this.exportModelOptions.pageIndex}constructor(e,t=null){this.rangeCopy=null,this.exportModelOptions=e,this.htmlExporterOptions=t}getHtmlElementsByInterval(e,t,r,i){var n,o,a,s;if(0===r.length)return;const l=this.unitConverter.getUnits()==KM.Centimeter?"cm":"in",d=t.getConstRunIterator(r);let c=r.length,h=r.start,u=new BE;const p=this.getParagraphsByInterval(t,r),m=this.getListsByParagraphs(p);let f=!1,b=0,I=!1,P=null,x=new BE,T=!1;for(;d.moveNext();){const v=Ja.getTableCellByPosition(t.tables,d.currentInterval().start),M=v&&v.verticalMerging===Xe.Continue,E=d.currentRun,D=1===E.paragraph.length;if(p.length&&(E.getType()!=cs.ParagraphRun||D)){const i=C.SearchUtils.normedInterpolationIndexOf(p,(e=>e.startLogPosition.value),h);if(i>-1){const n=p[i];if(p.splice(i,1),v){const t=v.parentRow,r=t.parentTable,i=n.startLogPosition.value;if(r.getStartPosition()==i&&(r.parentCell&&this.addParentTableRecursively(e,u,r.parentCell,i),u.startChild("table").configure((t=>{t.style.cssText=this.getTableStyle(e,r)})).startChild("tbody")),t.getStartPosition()==i&&(u.startChild("tr"),t.gridBefore>0&&u.startChild("td").configure((e=>{e.style.cssText="mso-cell-special:placeholder",e.setAttribute("colspan",t.gridBefore.toString()),e.innerHTML="&nbsp;"})).endChild("td")),v.startParagraphPosition.value==i&&!M){let i=1;if(v.verticalMerging===Xe.Restart){let e=r.rows.indexOf(t),n=t.cells.indexOf(v);for(let t,o=e+1;t=r.rows[o];o++){let e=n;if(t.cells.length!=t.cells.length){let r=0,i=t.cells.length>t.cells.length,o=t;for(let e=0;e<n&&e<o.cells.length;e++)r+=o.cells[e].columnSpan-1,i||(r-=t.cells[e].columnSpan-1);e+=(i?1:-1)*r}let r=t.cells[e];if(!r||r.verticalMerging!==Xe.Continue)break;i++}}u.startChild("td").configure((t=>{t.style.cssText=this.getCellStyle(e,v),i>1&&t.setAttribute("rowspan",i.toString()),v.columnSpan>1&&t.setAttribute("colspan",v.columnSpan.toString())}))}}if(this.startList(e,t,r,u,m,d.currentInterval().start),!M){const e=n.getParagraphMergedProperties();let t="";const r=e.firstLineIndentType;if(r!=ke.None&&(t+="text-indent: "+(r==ke.Hanging?"-":"")+this.unitConverter.twipsToUI(e.firstLineIndent)+l+";"),void 0!==e.alignment)switch(t+="text-align: ",e.alignment){case Ae.Left:t+="left;";break;case Ae.Right:t+="right;";break;case Ae.Justify:case Ae.JustifyHigh:case Ae.JustifyLow:case Ae.JustifyMedium:case Ae.Distribute:case Ae.ThaiDistribute:t+="justify;";break;case Ae.Center:t+="center;"}if(e.lineSpacingType!=Ne.Single){const r=this.unitConverter.twipsToUI(e.lineSpacing)+l+";";switch(t+="line-height: ",e.lineSpacingType){case Ne.AtLeast:t+=r;break;case Ne.Double:t+="2;";break;case Ne.Exactly:t+=r+"mso-line-height-rule: exactly;";break;case Ne.Multiple:t+=e.lineSpacing+";";break;case Ne.Sesquialteral:t+="1.5;"}}w.i.getAlpha(e.shadingInfo.getActualColor(this.colorProvider))>0&&(t+="background: "+y.getCssStringInternal(e.shadingInfo.getActualColor(this.colorProvider))+";"),e.leftIndent&&(t+="margin-left: "+this.unitConverter.twipsToUI(e.leftIndent)+l+";"),e.rightIndent&&(t+="margin-right: "+this.unitConverter.twipsToUI(e.rightIndent)+l+";"),t+="margin-top: "+this.unitConverter.twipsToUI(e.spacingBefore)+l+";",t+="margin-bottom: "+this.unitConverter.twipsToUI(e.spacingAfter)+l+";";const i=this.getBorderCssString(e.topBorder);i&&(t+="border-top:"+i+";");const o=this.getBorderCssString(e.leftBorder);o&&(t+="border-left:"+o+";");const a=this.getBorderCssString(e.bottomBorder);a&&(t+="border-bottom:"+a+";");const s=this.getBorderCssString(e.rightBorder);if(s&&(t+="border-right:"+s+";"),D){const e=E.getCharacterMergedProperties();t+=Nn.getCssRules(e,e.textColor.toRgb(this.colorProvider),!1,!1,!1).join(";")}n.isInList()&&u.startChild("li"),u.startChild("p").configure((e=>{t&&(e.style.cssText=t),D&&(e.innerHTML="&nbsp;")}))}}}let F=new BE,R=new BE;const L=Math.min(c,d.currentInterval().length);switch(E.getType()){case cs.ParagraphRun:if(!M){F.addCallback((e=>e.endChild("p"))),E.paragraph.isInList()&&(F.addCallback((e=>e.endChild("li"))),F.addCallback((t=>this.endList(e,t,m,d.currentInterval().end))));let t=E.paragraph.getEndPosition();if(v){let e=v.parentRow,r=e.parentTable;v.endParagrapPosition.value==t&&F.addCallback((e=>e.endChild("td"))),e.getEndPosition()==t&&(e.gridAfter>0&&F.addCallback((t=>{t.addElement("td").configure((t=>{t.style.cssText="mso-cell-special:placeholder",t.setAttribute("colspan",e.gridAfter.toString()),t.innerHTML="&nbsp;"})).endChild("td")})),F.addCallback((e=>{e.endChild("tr")}))),r.getEndPosition()==t&&F.addCallback((e=>{e.endChild("tbody").endChild("table")}))}}break;case cs.InlinePictureRun:case cs.AnchoredPictureRun:{const e=E,t=E.getCharacterMergedProperties(),r=new LE(t,t.getLayoutColorInfo(this.colorProvider),e.cacheInfo,e.getActualSize().applyConverter(g.u.twipsToPixels),e.info.nonVisualDrawingProperties.description),{cacheInfo:i,hyperlinkTip:n,description:o}=r;R.clear().addElement(this.documentRenderer.renderPictureBoxContent(r.createSize(),i,n,o));break}case cs.InlineTextBoxRun:case cs.AnchoredTextBoxRun:{let t=E,r=e.subDocuments[t.subDocId];R.clear().startChild("table").configure((e=>{e.setAttribute("border","1"),e.style.cssText="border-width: 0px; border-collapse: collapse; border-spacing: 0px;",e.setAttribute("id",i.replace('id="',"").replace('"',""))})).startChild("tbody").startChild("tr").startChild("td").configure((e=>{e.style.cssText=this.getTextBoxStyleString(t)})).assignFrom(this.getHtmlElementsByInterval(e,r,new on.FixedInterval(0,r.getDocumentEndPosition()),i)).endChild("td").endChild("tr").endChild("tbody").endChild("table");break}case cs.FieldCodeStartRun:f=!0;const r=Md.normedBinaryIndexOf(t.fields,h+1),n=t.fields[r];n.isHyperlinkField()&&(P=n.getHyperlinkInfo(),I=!0),b++;break;case cs.FieldCodeEndRun:f=!1;break;case cs.FieldResultEndRun:b--,b||(I=!1),T=!0;break;case cs.LayoutDependentRun:let o=t.fields[Md.normedBinaryIndexOf(t.fields,h)];if(o){let e=rn.StringUtils.trim(t.getText(o.getCodeInterval()).split("\\")[0]).toUpperCase();"NUMPAGES"==e&&(0,S.isDefined)(this.lastMaxNumPages)?R.clear().addElement(this.lastMaxNumPages.toString()):"PAGE"==e&&(0,S.isDefined)(this.pageIndex)&&R.clear().addElement((this.pageIndex+1).toString())}break;default:f||(R=this.getHtmlText(t.getText(new on.FixedInterval(h,L))))}if(P&&!I){const e=null!==(o=null===(n=this.htmlExporterOptions)||void 0===n?void 0:n.sanitaizeHyperlinkURIs)&&void 0!==o&&o,t=null!==(s=null===(a=this.htmlExporterOptions)||void 0===a?void 0:a.convertRelativeURIsToAbsolute)&&void 0!==s&&s;let r=P.uri;const i=(0,yd.EW)(this.exportModelOptions.modelManager);!e||yd.jE.isValid(r,i)?(t&&yd.jE.isRelative(r)&&(r=yd.jE.convertToAbsolute(r).href),""!=P.anchor&&(r=r+"#"+P.anchor)):r=yd.jE.EmptyPage;const l=P.tip;F.clear().startChild("a").configure((e=>{e.setAttribute("href",r),l&&e.setAttribute("title",l)})).assignFrom(x).endChild("a"),P=null,x.clear()}if(F.isEmpty()&&!R.isEmpty()){const e=E.getCharacterMergedProperties(),t=Nn.getCssRules(e,e.textColor.toRgb(this.colorProvider),E.getType()==cs.TextRun,!1,!1).join(";");if(F.startChild("span").configure((e=>{e.style.cssText=t})).assignFrom(R).endChild("span"),P)I&&(x.assignFrom(F),F.clear());else{if(e.fontUnderlineType!=le.None&&!e.underlineWordsOnly){const t=e.underlineColor.toRgb(this.colorProvider),r=t!=y.AUTOMATIC_COLOR?y.getCssStringInternal(t):"initial",i=new BE;i.startChild("span").configure((e=>{e.style.cssText="text-decoration: underline; color: "+r})).assignFrom(F).endChild("span"),F=i}if(e.script!==ne.Normal){const t=new BE;t.startChild("span").configure((t=>{t.style.cssText="font-size: "+e.fontSize+"px;"})).assignFrom(F).endChild("span"),F=t}if(w.i.getAlpha(Ie.getActualBackgroundColor(e,this.colorProvider))>0){const t=new BE;t.startChild("span").configure((t=>{t.style.cssText="background: "+y.getCssStringInternal(Ie.getActualBackgroundColor(e,this.colorProvider))})).assignFrom(F).endChild("span"),F=t}}}u.assignFrom(F),h+=L,c-=L}if(/^<td[^>]*>/gi.test(u.getHtmlString())){const e=new BE;e.startChild("tr"),e.assignFrom(u),u=e}if(/<\/td>$/gi.test(u.getHtmlString())&&u.endChild("tr"),/^<tr[^>]*>/gi.test(u.getHtmlString())){const t=new BE;t.startChild("table").configure((t=>{t.style.cssText=this.getTableStyle(e,null)})).startChild("tbody").assignFrom(u),u=t}return/<\/tr>$/gi.test(u.getHtmlString())&&u.endChild("tbody").endChild("table"),T&&u.isEmpty()&&u.startChild("span").configure((e=>{e.classList.add("field-mark"),e.innerHTML="&nbsp;"})).endChild("span"),u}getParagraphsByInterval(e,t){const r=e.getParagraphsByInterval(t),i=[];for(let e,n=0;e=r[n];n++)t.containsWithIntervalEnd(e.getEndPosition())&&i.push(e);return i}getListsByParagraphs(e){const t=[];let r=null;for(let i,n=0;i=e[n];n++)if(i.isInList()){const e=i.getNumberingListIndex(),n=i.getListLevelIndex(),o=i.startLogPosition.value,a=i.getEndPosition();let s=f.ListUtils.reverseElementBy(t,(t=>t.listLevelIndex<=(null==r?void 0:r.listLevelIndex)&&t.numberingListIndex===e&&t.listLevelIndex===n));if(!s){s={parentList:(null==r?void 0:r.numberingListIndex)===e?r:null,numberingListIndex:e,listLevelIndex:n,start:o,end:a},t.push(s)}r=s;do{s.end=a}while(s=s.parentList)}return t}addParentTableRecursively(e,t,r,i){const n=r.parentRow,o=n.parentTable;o.parentCell&&this.addParentTableRecursively(e,t,o.parentCell,i),o.getStartPosition()===i&&t.startChild("table").configure((t=>t.style.cssText=this.getTableStyle(e,o))).startChild("tbody"),n.getStartPosition()===i&&(t.startChild("tr"),n.gridBefore>0&&t.startChild("td").configure((e=>{e.style.cssText="mso-cell-special:placeholder",e.setAttribute("colspan",n.gridBefore.toString()),e.innerHTML="&nbsp;"})).endChild("td")),r.startParagraphPosition.value===i&&t.startChild("td").configure((t=>{t.style.cssText=this.getCellStyle(e,r),r.columnSpan>1&&t.setAttribute("colspan",r.columnSpan.toString())}))}startList(e,t,r,i,n,o){if(!n.length)return;let a=n.findIndex((e=>e.start===o));if(a<0&&o===r.start){t.getParagraphByPosition(o).getNumberingListIndex()===n[0].numberingListIndex&&(a=0)}if(a>-1){const t=e.numberingLists[n[a].numberingListIndex],r=t.levels[n[a].listLevelIndex].getListLevelProperties().format,o=t.getListType();let s="";switch(r){case Zi.Bullet:s="disc";break;case Zi.Decimal:s="decimal";break;case Zi.LowerLetter:s="lower-alpha";break;case Zi.UpperLetter:s="upper-alpha";break;case Zi.LowerRoman:s="lower-roman";break;case Zi.UpperRoman:s="upper-roman"}i.startChild(o!==tn.Bullet?"ol":"ul").configure((e=>e.style.cssText="list-style-type:"+s))}}endList(e,t,r,i){for(let n=r.length-1;n>=0;n--)if(r[n].end===i){const i=e.numberingLists[r[n].numberingListIndex].getListType();r.splice(n,1),t.endChild(i!=tn.Bullet?"ol":"ul")}}getHtmlText(e){const t=new BE;for(let r=0;r<e.length;r++){switch(e.charAt(r)){case an.specialCharacters.PageBreak:case an.specialCharacters.ColumnBreak:case an.specialCharacters.SectionMark:t.addCallback((e=>e.addBreak("break-before:always")));break;case an.specialCharacters.LineBreak:t.addCallback((e=>e.addBreak()));break;default:return t.addCallback((t=>{t.configure((t=>t.innerHTML+=Tg.EncodeUtils.encodeHtml(e.substring(r))))})),t}}return t}getBorderCssString(e){let t="";if(e){switch(e.width&&(t+=" "+g.u.twipsToPixels(e.width)+"px"),e.style){case de.Dashed:t+=" dashed";break;case de.Dotted:t+=" dotted";break;case de.Double:t+=" double";break;case de.Inset:t+=" inset";break;case de.None:t+=" none";break;case de.Outset:t+=" outset";break;case de.Single:t+=" solid"}const r=this.colorProvider.getRgbaFromModelColor(e.color);w.i.getAlpha(r)>0&&(t+=" "+y.getCssStringInternal(r))}return t}getTableWidthUnitCssString(e){return e.type==Je.FiftiethsOfPercent?e.value/50+"%":g.u.twipsToPoints(e.value)+"pt"}getTableStyle(e,t){let r=e.defaultTableProperties,i=t?t.properties:r,n=t?t.style:e.getDefaultTableStyle(),o="",a=(new Ir).getProperty(i,n,qe.WholeTable,r);a.value&&(o+="margin-left:"+this.getTableWidthUnitCssString(a)+";");let s=(new Pr).getProperty(i,n,qe.WholeTable,r);return o+=(s.value?"border-spacing:"+this.getTableWidthUnitCssString(s):"border-collapse: collapse")+";",o}getCellStyle(e,t){let r=t.properties,i=e.defaultTableProperties,n=e.defaultTableCellProperties,o=t.parentRow.parentTable,a=o.style,s=this.getBorderCssString((new Er).getProperty(o.properties,a,qe.WholeTable,i)),l=this.getBorderCssString((new Mr).getProperty(o.properties,a,qe.WholeTable,i)),d="",c=this.getBorderCssString(t.getActualTopCellBorder(n))||l;c&&(d+="border-top:"+c+";");let h=this.getBorderCssString(t.getActualLeftCellBorder(n))||s;h&&(d+="border-left:"+h+";");let u=this.getBorderCssString(t.getActualBottomCellBorder(n))||l;u&&(d+="border-bottom:"+u+";");let p=this.getBorderCssString(t.getActualRightCellBorder(n))||s;p&&(d+="border-right:"+p+";");let m=t.getActualLeftCellMargin(e);m.value&&(d+="padding-left:"+this.getTableWidthUnitCssString(m)+";");let f=t.getActualTopCellMargin(e);f.value&&(d+="padding-top:"+this.getTableWidthUnitCssString(f)+";");let b=t.getActualRightCellMargin(e);b.value&&(d+="padding-right:"+this.getTableWidthUnitCssString(b)+";");let C=t.getActualBottomCellMargin(e);switch(C.value&&(d+="padding-bottom:"+this.getTableWidthUnitCssString(C)+";"),(new Zr).getProperty(r,a,t.conditionalFormatting,n)){case Ke.Bottom:d+="vertical-align:bottom;";break;case Ke.Center:d+="vertical-align:middle;";break;case Ke.Top:d+="vertical-align:top;"}let S=(new Qr).getProperty(r,a,t.conditionalFormatting,n).getActualColor(this.colorProvider);return w.i.getAlpha(S)>0&&(d+="background: "+y.getCssStringInternal(S)+";"),d+="width: "+g.u.twipsToPixels(t.preferredWidth.value)+"px;",d}getTextBoxStyleString(e){let t=e.textBoxProperties.getContentMargins(),r="padding-top:"+g.u.twipsToPixels(t.top)+"px;";return r+="padding-bottom:"+g.u.twipsToPixels(t.bottom)+"px;",r+="padding-left:"+g.u.twipsToPixels(t.left)+"px;",r+="padding-right:"+g.u.twipsToPixels(t.right)+"px;",r+="border:"+g.u.twipsToPixels(e.shape.outlineWidth)+"px solid "+y.getCssString(e.shape.outlineColor,!0)+";",r+="background-color:"+y.getCssString(e.shape.fillColor,!0)+";",r}}class NE{get modelManipulator(){return this.exportModelOptions.modelManager.modelManipulator}constructor(e,t){this.exportModelOptions=e,this.options=t}exportToBlob(e){this.modelManipulator.picture.loader.ensureAllPicturesLoaded(this.options.ensurePictureLoadedTimeout,(t=>{e(new Blob([this.exportAsString()],{type:Ru.HtmlMimeType}))}))}exportToBase64(e){this.exportToBlob((t=>lo.Base64Utils.fromBlobAsDataUrl(t,(t=>{const r=t.split(",");e(2===r.length?r[1]:"")}))))}exportAsString(){const e=this.modelManipulator.model,t=e.mainSubDocument,r=new on.FixedInterval(0,e.mainSubDocument.getDocumentEndPosition()),i=an.getCopyPasteGuidLabel({sguid:this.sessionGuid,cguid:this.clientGuid});return new AE(this.exportModelOptions).getHtmlElementsByInterval(e,t,r,i).getHtmlString(!0)}}function kE(e,t){const r=[];return b.j.forEach(e.subDocuments,(e=>{f.ListUtils.forEach(e.bookmarks,(e=>{t(e)&&r.push(e)}))})),r}class OE{constructor(e,t,r){this._bookmark=r,this._subDocument=t,this._processor=e}get index(){return bm.getObject(this._subDocument.bookmarks,(e=>e.start),this._bookmark.start,this._bookmark)}get subDocument(){return new cU(this._processor,this._subDocument)}get interval(){return new xb(this._bookmark.start,this._bookmark.length)}get name(){return this._bookmark.name}delete(){this._processor.modelManager.history.addAndRedo(new Bg(this._processor.modelManager.modelManipulator,this._subDocument,this._bookmark.constBookmark))}}class _E{constructor(e){this._processor=e}get count(){return this._getCoreItems().length}getByIndex(e){const t=this._getCoreItems()[e];return void 0!==t?this._getItem(t):null}}class UE extends _E{constructor(e,t){super(e),this._subDocument=t}find(e){const t=this._subDocument;return f.ListUtils.map(mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>t.findBookmarkByInterval([new on.FixedInterval(e,0)])),0,Bo.Constants.MAX_SAFE_INTEGER),Sm.intervalDescriptor("interval",(e=>t.findBookmarkByInterval([new on.FixedInterval(e.start,e.length)])),0,Bo.Constants.MAX_SAFE_INTEGER),Sm.intervalsDescriptor("intervals",(e=>t.findBookmarkByInterval(f.ListUtils.map(e,(e=>new on.FixedInterval(e.start,e.length))))),0,Bo.Constants.MAX_SAFE_INTEGER),mm.stringDescriptor("name",(e=>kE(this._subDocument.documentModel,(t=>t.name==e))),!1),mm.regExpDescriptor("regexp",(e=>kE(this._subDocument.documentModel,(t=>e.test(t.name)))))]),(e=>this._getItem(e)))}create(e,t){const r=mm.check(e,1,!1,[Sm.intervalDescriptor("interval",(e=>new on.FixedInterval(e.start,e.length)))]);if(t=mm.check(t,2,!1,[mm.stringDescriptor("name",(e=>e),!1)]),!Cd.isValidName(t,!0))return;const i=this._processor.modelManager;i.history.beginTransaction();let n=du.findBookmark(i.model.subDocuments,t);return n&&i.history.addAndRedo(new Bg(i.modelManipulator,n.subDocument,n.bookmark.constBookmark)),i.history.addAndRedo(new Lg(i.modelManipulator,this._subDocument,new Sd(r,t))),i.history.endTransaction(),n=du.findBookmark(i.model.subDocuments,t),this._getItem(n.bookmark)}_getItem(e){return new OE(this._processor,this._subDocument,e)}_getCoreItems(){return this._subDocument.bookmarks}}class HE extends _E{constructor(e,t){super(e),this._subDocument=t}create(e,t){const r=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>new on.FixedInterval(e,0))),Sm.intervalDescriptor("interval",(e=>new on.FixedInterval(e.start,e.length)))]),i=this._subDocument.getDocumentEndPosition()-1,n=P.MathUtils.restrictValue(r.start,0,i),o=P.MathUtils.restrictValue(r.end,0,i);r.start=n,r.length=Math.max(0,o-n),(t=mm.check(t,2,!1,[mm.objectDescriptor("hyperlinkInfo","DevExpress.RichEdit.HyperinkInfo",(e=>e))])).tooltip=mm.check(t.tooltip,2,!0,[mm.stringDescriptor("hyperlinkInfo.tooltip",(e=>e||""),!0)]),t.text=mm.check(t.text,2,!0,[mm.stringDescriptor("hyperlinkInfo.text",(e=>e||""),!0)]),t.bookmark=mm.check(t.bookmark,2,!0,[mm.stringDescriptor("hyperlinkInfo.bookmark",(e=>e||""),!0)]),t.url=mm.check(t.url,2,!0,[mm.stringDescriptor("hyperlinkInfo.url",(e=>e||""),!0)]);const a=new xd(t.url,t.bookmark,t.tooltip,!1),s=yb.canChangeHyperlinkDisplayText(new gu(this._subDocument,r)),l=new cU(this._processor,this._subDocument),d=(new ju).setIntervals(new tp(this._subDocument,[r])),c=this._processor.modelManager.modelManipulator;this._processor.beginUpdate(),this._processor.modelManager.history.beginTransaction(),this._processor.modelManager.history.addAndRedo(new pp(this._processor.modelManager.modelManipulator,this._subDocument,r.start,0,r.length,!1,d.charPropsBundle));const h=Md.normedBinaryIndexOf(this._subDocument.fields,r.start+1),u=this._subDocument.fields[h];return this._processor.modelManager.history.addAndRedo(new hp(c,this._subDocument,u.index,a)),l.insertText(u.getCodeInterval().start,xd.getNewCodeText(a)),(s&&t.text||0==u.getResultInterval().length)&&(l.deleteText(Tb(u.getResultInterval())),l.insertText(u.getResultInterval().start,t.text&&""!=t.text?t.text:a.getUriWithAnchor())),this._processor.modelManager.history.addAndRedo(new Up(this._processor.modelManager.modelManipulator,new gu(this._subDocument,u.getResultInterval()))),this._processor.modelManager.history.endTransaction(),this._processor.endUpdate(),this._getItem(this._subDocument.fields[Md.binaryIndexOf(this._subDocument.fields,r.start+1)])}find(e){const t=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>new on.FixedInterval(e,0))),Sm.intervalDescriptor("interval",(e=>new on.FixedInterval(e.start,e.length)))]);return f.ListUtils.reducedMap(bU(this._subDocument.fields,t),(e=>e.isHyperlinkField()?this._getItem(e):null))}_getItem(e){return new pU(this._processor,this._subDocument,e)}_getCoreItems(){return f.ListUtils.reducedMap(this._subDocument.fields,(e=>e.isHyperlinkField()?e:null))}}class VE extends Ze{constructor(e,t,r,i,n,o){super(e),this.newValue=n,this.isAbstractList=t,this.listIndex=r,this.levelIndex=i,this.newUse=o}redo(){this.oldState=this.getManipulator().setValue(this.modelManipulator.model,this.isAbstractList,this.listIndex,this.levelIndex,this.newValue,this.newUse)}undo(){this.getManipulator().restoreValue(this.modelManipulator.model,this.oldState)}getManipulator(){throw new Error(R.D.NotImplemented)}}class WE extends VE{getManipulator(){return this.modelManipulator.numberingList.listLevelCharacterProperties.fontBold}}class zE extends VE{getManipulator(){return this.modelManipulator.numberingList.listLevelCharacterProperties.textColor}}class jE extends VE{getManipulator(){return this.modelManipulator.numberingList.listLevelCharacterProperties.fontItalic}}class XE extends VE{getManipulator(){return this.modelManipulator.numberingList.listLevelCharacterProperties.fontName}}class GE extends VE{getManipulator(){return this.modelManipulator.numberingList.listLevelCharacterProperties.fontSize}}class KE extends Ze{constructor(e,t,r,i,n,o){super(e),this.newValue=n,this.isAbstractList=t,this.listIndex=r,this.levelIndex=i,this.newUse=o}redo(){this.oldState=this.getManipulator().setValue(this.modelManipulator.model,this.isAbstractList,this.listIndex,this.levelIndex,this.newValue,this.newUse)}undo(){this.getManipulator().restoreValue(this.modelManipulator.model,this.oldState)}getManipulator(){throw new Error(R.D.NotImplemented)}}class qE extends KE{getManipulator(){return this.modelManipulator.numberingList.listLevelParagraphProperties.firstLineIndent}}class $E extends KE{getManipulator(){return this.modelManipulator.numberingList.listLevelParagraphProperties.firstLineIndentType}}class JE extends KE{getManipulator(){return this.modelManipulator.numberingList.listLevelParagraphProperties.leftIndent}}class YE extends Ze{constructor(e,t,r,i,n){super(e),this.newValue=n,this.isAbstractList=t,this.listIndex=r,this.levelIndex=i}redo(){this.oldState=this.getManipulator().setValue(this.modelManipulator.model,this.isAbstractList,this.listIndex,this.levelIndex,this.newValue)}undo(){this.getManipulator().restoreValue(this.modelManipulator.model,this.oldState)}getManipulator(){throw new Error(R.D.NotImplemented)}}class QE extends YE{getManipulator(){return this.modelManipulator.numberingList.listLevelProperties.start}}class ZE extends YE{getManipulator(){return this.modelManipulator.numberingList.listLevelProperties.alignment}}class eD extends YE{getManipulator(){return this.modelManipulator.numberingList.listLevelProperties.displayFormatString}}class tD extends YE{getManipulator(){return this.modelManipulator.numberingList.listLevelProperties.format}}class rD extends YE{getManipulator(){return this.modelManipulator.numberingList.listLevelProperties.originalLeftIndent}}class iD extends YE{getManipulator(){return this.modelManipulator.numberingList.listLevelProperties.separator}}!function(e){e[e.MultiLevel=0]="MultiLevel",e[e.Number=1]="Number",e[e.Bullet=2]="Bullet"}(qM||(qM={}));class nD{static toCoreEnum(e){return nD.map[e]}static toApiEnum(e){return b.j.keyBy(nD.map,(t=>t==e))}}nD.map={[qM.Bullet]:tn.Bullet,[qM.MultiLevel]:tn.MultiLevel,[qM.Number]:tn.Simple},function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}($M||($M={})),function(e){e[e.Decimal=0]="Decimal",e[e.Hiragana=1]="Hiragana",e[e.FullWidthHiragana=2]="FullWidthHiragana",e[e.ArabicAbjad=3]="ArabicAbjad",e[e.ArabicAlpha=4]="ArabicAlpha",e[e.Bullet=5]="Bullet",e[e.CardinalText=6]="CardinalText",e[e.Chicago=7]="Chicago",e[e.ChineseCounting=8]="ChineseCounting",e[e.ChineseCountingThousand=9]="ChineseCountingThousand",e[e.ChineseLegalSimplified=10]="ChineseLegalSimplified",e[e.Chosung=11]="Chosung",e[e.DecimalEnclosedCircle=12]="DecimalEnclosedCircle",e[e.DecimalEnclosedCircleChinese=13]="DecimalEnclosedCircleChinese",e[e.DecimalEnclosedFullstop=14]="DecimalEnclosedFullstop",e[e.DecimalEnclosedParentheses=15]="DecimalEnclosedParentheses",e[e.DecimalFullWidth=16]="DecimalFullWidth",e[e.DecimalFullWidth2=17]="DecimalFullWidth2",e[e.DecimalHalfWidth=18]="DecimalHalfWidth",e[e.DecimalZero=19]="DecimalZero",e[e.Ganada=20]="Ganada",e[e.Hebrew1=21]="Hebrew1",e[e.Hebrew2=22]="Hebrew2",e[e.Hex=23]="Hex",e[e.HindiConsonants=24]="HindiConsonants",e[e.HindiDescriptive=25]="HindiDescriptive",e[e.HindiNumbers=26]="HindiNumbers",e[e.HindiVowels=27]="HindiVowels",e[e.IdeographDigital=28]="IdeographDigital",e[e.IdeographEnclosedCircle=29]="IdeographEnclosedCircle",e[e.IdeographLegalTraditional=30]="IdeographLegalTraditional",e[e.IdeographTraditional=31]="IdeographTraditional",e[e.IdeographZodiac=32]="IdeographZodiac",e[e.IdeographZodiacTraditional=33]="IdeographZodiacTraditional",e[e.Iroha=34]="Iroha",e[e.IrohaFullWidth=35]="IrohaFullWidth",e[e.JapaneseCounting=36]="JapaneseCounting",e[e.JapaneseDigitalTenThousand=37]="JapaneseDigitalTenThousand",e[e.JapaneseLegal=38]="JapaneseLegal",e[e.KoreanCounting=39]="KoreanCounting",e[e.KoreanDigital=40]="KoreanDigital",e[e.KoreanDigital2=41]="KoreanDigital2",e[e.KoreanLegal=42]="KoreanLegal",e[e.LowerLetter=43]="LowerLetter",e[e.LowerRoman=44]="LowerRoman",e[e.None=45]="None",e[e.NumberInDash=46]="NumberInDash",e[e.Ordinal=47]="Ordinal",e[e.OrdinalText=48]="OrdinalText",e[e.RussianLower=49]="RussianLower",e[e.RussianUpper=50]="RussianUpper",e[e.TaiwaneseCounting=51]="TaiwaneseCounting",e[e.TaiwaneseCountingThousand=52]="TaiwaneseCountingThousand",e[e.TaiwaneseDigital=53]="TaiwaneseDigital",e[e.ThaiDescriptive=54]="ThaiDescriptive",e[e.ThaiLetters=55]="ThaiLetters",e[e.ThaiNumbers=56]="ThaiNumbers",e[e.UpperLetter=57]="UpperLetter",e[e.UpperRoman=58]="UpperRoman",e[e.VietnameseDescriptive=59]="VietnameseDescriptive"}(JM||(JM={}));class oD{}class aD{constructor(e,t){this._native=e,this._list=t}get index(){return this._native.model.numberingLists.indexOf(this._list)}get type(){return nD.toApiEnum(this._list.getListType())}get levelProperties(){const e=this._list.getAbstractNumberingList(),t=[];for(var r=0;r<e.levels.length;r++){const i=new oD,n=e.levels[r],o=n.getListLevelProperties(),a=n.getParagraphProperties(),s=n.getCharacterProperties();i.displayFormatString=o.displayFormatString,i.format=o.format,i.start=o.start,i.alignment=o.alignment,i.separator=o.separator,i.leftIndent=a.leftIndent,i.firstLineIndent=a.firstLineIndent,i.firstLineIndentType=a.firstLineIndentType,i.fontName=s.fontInfo.name;const l=s.textColor.toRgb(this._native.model.colorProvider);i.fontColor=w.i.colorToHash(l),i.fontSize=s.fontSize,i.fontBold=s.fontBold,i.fontItalic=s.fontItalic,t.push(i)}return t}set levelProperties(e){if(9!==e.length)throw new Error("listLevelSettings must have 9 elements");const t=this._native.modelManipulator,r=this._list.abstractNumberingListIndex,i=this.levelProperties;this._native.history.beginTransaction();for(let n,o=0;n=e[o];o++){let e=i[o];if(void 0!==n.alignment&&n.alignment!=e.alignment&&(bm.assertEnum(n.alignment,$M,"ListLevelNumberAlignment",`listLevelSettings[${o}].alignment`),this._native.history.addAndRedo(new ZE(t,!0,r,o,n.alignment))),void 0!==n.displayFormatString&&n.displayFormatString!==e.displayFormatString&&(bm.assertString(n.displayFormatString,!1,`listLevelSettings[${o}].displayFormatString`),this._native.history.addAndRedo(new eD(t,!0,r,o,n.displayFormatString))),void 0!==n.firstLineIndent&&n.firstLineIndent!==e.firstLineIndent&&(bm.assertNumber(n.firstLineIndent,`listLevelSettings[${o}].firstLineIndent`),this._native.history.addAndRedo(new qE(t,!0,r,o,n.firstLineIndent,!0))),void 0!==n.firstLineIndentType&&n.firstLineIndentType!==e.firstLineIndentType&&(bm.assertEnum(n.firstLineIndentType,ZM,"ParagraphFirstLineIndent",`listLevelSettings[${o}].firstLineIndentType`),this._native.history.addAndRedo(new $E(t,!0,r,o,n.firstLineIndentType,!0))),void 0!==n.fontBold&&n.fontBold!==e.fontBold&&(bm.assertBoolean(n.fontBold,`listLevelSettings[${o}].fontBold`),this._native.history.addAndRedo(new WE(t,!0,r,o,n.fontBold,!0))),void 0!==n.fontColor&&n.fontColor!==e.fontColor){const e=mm.check(n.fontColor,2,!1,Sm.colorDescriptors(`listLevelSettings[${o}].fontColor`));this._native.history.addAndRedo(new zE(t,!0,r,o,he.makeByColor(e),!0))}void 0!==n.fontItalic&&n.fontItalic!==e.fontItalic&&(bm.assertBoolean(n.fontItalic,`listLevelSettings[${o}].fontItalic`),this._native.history.addAndRedo(new jE(t,!0,r,o,n.fontItalic,!0))),void 0!==n.fontName&&n.fontName!==e.fontName&&(bm.assertString(n.fontName,!0,`listLevelSettings[${o}].fontName`),this._native.history.addAndRedo(new XE(t,!0,r,o,this._native.model.cache.fontInfoCache.getItemByName(n.fontName),!0))),void 0!==n.fontSize&&n.fontSize!==e.fontSize&&(bm.assertPositiveNumber(n.fontSize,`listLevelSettings[${o}].fontSize`),this._native.history.addAndRedo(new GE(t,!0,r,o,n.fontSize,!0))),void 0!==n.format&&n.format!==e.format&&(bm.assertEnum(n.format,JM,"ListLevelFormat",`listLevelSettings[${o}].format`),this._native.history.addAndRedo(new tD(t,!0,r,o,n.format))),void 0!==n.leftIndent&&n.leftIndent!==e.leftIndent&&(bm.assertNonNegativeNumber(n.leftIndent,`listLevelSettings[${o}].leftIndent`),this._native.history.addAndRedo(new JE(t,!0,r,o,n.leftIndent,!0))),void 0!==n.separator&&n.separator!==e.separator&&(bm.assertString(n.separator,!1,`listLevelSettings[${o}].separator`),this._native.history.addAndRedo(new iD(t,!0,r,o,n.separator))),void 0!==n.start&&n.start!==e.start&&(bm.assertNumber(n.start,`listLevelSettings[${o}].start`),this._native.history.addAndRedo(new QE(t,!0,r,o,n.start)))}this._native.history.endTransaction()}}class sD{constructor(e,t){this._processor=e,this._paragraph=t}get index(){return this._paragraph.subDocument.getParagraphIndexByPosition(this._paragraph.interval.start)}get interval(){return Tb(this._paragraph.interval)}get properties(){return dD(this._paragraph.getParagraphMergedProperties().clone(),this._processor.modelManager.model.colorProvider)}set properties(e){const t=cD(e),r=this._paragraph.subDocument,i=[this._paragraph.interval],n=(new ju).setIntervals(new tp(r,i));new Eb(this._processor.modelManager,n,t,r,i).apply()}get list(){const e=this._processor.modelManager.model.numberingLists[this._paragraph.getNumberingListIndex()];return e?new aD(this._processor.modelManager,e):null}get listLevel(){return this._paragraph.listLevelIndex}addToList(e,t=0){e=mm.check(e,1,!1,[mm.objectDescriptor("list","List",(e=>e))]),t=mm.check(t,2,!1,[mm.numberDescriptor("targetListLevel",(e=>e),0,8)]);const r=this._paragraph.subDocument,i=new gu(r,new on.FixedInterval(this._paragraph.interval.start,1)),n=this.index,o=this._paragraph.getParagraphMergedProperties();this._processor.beginUpdate(),this._processor.modelManager.history.addTransaction((()=>{this._processor.modelManager.history.addAndRedo(new yw(this._processor.modelManager.modelManipulator,r,n,e.index,t)),this._processor.modelManager.history.addAndRedo(new ft(this._processor.modelManager.modelManipulator,i,o.leftIndent,!1)),this._processor.modelManager.history.addAndRedo(new pt(this._processor.modelManager.modelManipulator,i,o.firstLineIndent,!1))})),this._processor.endUpdate()}}!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(YM||(YM={})),function(e){e[e.Single=0]="Single",e[e.Sesquialteral=1]="Sesquialteral",e[e.Double=2]="Double",e[e.Multiple=3]="Multiple",e[e.Exactly=4]="Exactly",e[e.AtLeast=5]="AtLeast"}(QM||(QM={})),function(e){e[e.None=0]="None",e[e.Indented=1]="Indented",e[e.Hanging=2]="Hanging"}(ZM||(ZM={}));class lD{}function dD(e,t){const r=new lD;return r.alignment=void 0===e.alignment?void 0:e.alignment,r.contextualSpacing=e.contextualSpacing,r.firstLineIndent=e.firstLineIndent,r.firstLineIndentType=void 0===e.firstLineIndentType?void 0:e.firstLineIndentType,r.keepLinesTogether=e.keepLinesTogether,r.leftIndent=e.leftIndent,r.lineSpacingType=void 0===e.lineSpacingType?void 0:e.lineSpacingType,r.lineSpacing=e.lineSpacing,r.outlineLevel=e.outlineLevel,r.pageBreakBefore=e.pageBreakBefore,r.rightIndent=e.rightIndent,r.spacingAfter=e.spacingAfter,r.spacingBefore=e.spacingBefore,r.backColor=bm.internalColorToApiColor(e.shadingInfo.getActualColor(t)),r}function cD(e,t=1){e=mm.check(e,t,!1,[mm.objectDescriptor("properties","ParagraphProperties",(e=>e))]);const r=new Rt;r.alignment=mm.check(e.alignment,t,!0,[mm.enumDescriptor("properties.alignment",(e=>e),YM,"ParagraphAlignment")]),r.contextualSpacing=mm.check(e.contextualSpacing,t,!0,[mm.booleanDescriptor("properties.contextualSpacing",(e=>e))]),r.firstLineIndent=mm.check(e.firstLineIndent,t,!0,[mm.numberDescriptor("properties.firstLineIndent",(e=>e))]),r.firstLineIndentType=mm.check(e.firstLineIndentType,t,!0,[mm.enumDescriptor("properties.firstLineIndentType",(e=>e),ZM,"ParagraphFirstLineIndent")]),r.keepLinesTogether=mm.check(e.keepLinesTogether,t,!0,[mm.booleanDescriptor("properties.keepLinesTogether",(e=>e))]),r.leftIndent=mm.check(e.leftIndent,t,!0,[mm.numberDescriptor("properties.leftIndent",(e=>e))]),r.outlineLevel=mm.check(e.outlineLevel,t,!0,[mm.numberDescriptor("properties.outlineLevel",(e=>e))]),r.pageBreakBefore=mm.check(e.pageBreakBefore,t,!0,[mm.booleanDescriptor("properties.pageBreakBefore",(e=>e))]),r.rightIndent=mm.check(e.rightIndent,t,!0,[mm.numberDescriptor("properties.rightIndent",(e=>e))]),r.spacingAfter=mm.check(e.spacingAfter,t,!0,[mm.numberDescriptor("properties.spacingAfter",(e=>e))]),r.spacingBefore=mm.check(e.spacingBefore,t,!0,[mm.numberDescriptor("properties.spacingBefore",(e=>e))]);const i=mm.check(e.backColor,t,!0,Sm.colorDescriptors("properties.backColor"));return r.shadingInfo=void 0===i?void 0:fe.createByColor(he.makeByColor(i)),r.lineSpacingType=mm.check(e.lineSpacingType,t,!0,[mm.enumDescriptor("properties.lineSpacingType",(e=>e),QM,"ParagraphLineSpacingType")]),r.lineSpacing=mm.check(e.lineSpacing,t,!0,[mm.numberDescriptor("properties.lineSpacing",(e=>e))]),r}class hD extends _E{constructor(e,t){super(e),this._subDocument=t}create(e){return new cU(this._processor,this._subDocument).insertParagraph(e)}find(e){const t=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>new on.FixedInterval(e,0))),Sm.intervalDescriptor("interval",(e=>new on.FixedInterval(e.start,e.length)))]),r=[],i=this._subDocument.getParagraphsByInterval(t);return f.ListUtils.forEach(i,(e=>{r.push(this._getItem(e))})),r}_getItem(e){return new sD(this._processor,e)}_getCoreItems(){return this._subDocument.paragraphs}}class uD extends Ze{constructor(e,t,r){super(e),this.permissionTemplate=r,this.boundSubDocument=t}}class pD extends uD{redo(){this.modelManipulator.rangePermission.createRangePermission(this.boundSubDocument,this.permissionTemplate)}undo(){this.modelManipulator.rangePermission.deleteRangePermission(this.boundSubDocument,this.permissionTemplate)}}class gD extends uD{redo(){this.modelManipulator.rangePermission.deleteRangePermission(this.boundSubDocument,this.permissionTemplate)}undo(){this.modelManipulator.rangePermission.createRangePermission(this.boundSubDocument,this.permissionTemplate)}}function mD(e,t){const r=[];return nn.IntervalAlgorithms.handleAffectedObjects(e,nn.IntervalAlgorithms.getMergedIntervals(t,!0),((e,t,i,n)=>{(n.length||0==e.length||n.start==e.start||0==i.length&&i.start<e.end)&&r.push(e)}),((e,t)=>0)),r}function fD(e,t){const r=[];return f.ListUtils.forEach(e,(e=>{t(e)&&r.push(e)})),r}class bD{constructor(e,t,r){this._rangePermission=r,this._subDocument=t,this._processor=e}get index(){return bm.getObject(this._subDocument.rangePermissions,(e=>e.start),this._rangePermission.start,this._rangePermission)}get subDocument(){return new cU(this._processor,this._subDocument)}get interval(){return new xb(this._rangePermission.start,this._rangePermission.length)}get userName(){return this._rangePermission.userName}get group(){return this._rangePermission.group}delete(){this._processor.modelManager.history.addAndRedo(new gD(this._processor.modelManager.modelManipulator,this._subDocument,this._rangePermission.constRangePermission))}}class CD extends _E{constructor(e,t){super(e),this._subDocument=t}protectRange(e,t="",r=Dd.Everyone_GROUP_NAME){const i=this._processor.modelManager;i.history.beginTransaction();const n=f.ListUtils.map(e,(e=>new on.FixedInterval(e.start,e.length))),o=nn.IntervalAlgorithms.getMergedIntervals(n,!0);let a=0,s=0;const l=[];f.ListUtils.forEach(o,(e=>{s=e.start+1;const i=s-a;i&&l.push(this.create({start:a,length:i},t,r)),a=e.end})),s=this._subDocument.interval.end;const d=s-a;return d&&l.push(this.create({start:a,length:d},t,r)),i.history.endTransaction(),l}find(e){const t=this._subDocument;mm.objectDescriptor("options","DevExpress.RichEdit.IRangePermissionSearchOptions",(e=>e));const r=(0,S.isDefined)(e.position)?(i=e.position,n=!0,o=t.rangePermissions,f.ListUtils.map(mm.check(i,1,n,[mm.numberDescriptor("position",(e=>mD(o,[new on.FixedInterval(e,0)])),0,Bo.Constants.MAX_SAFE_INTEGER),Sm.intervalDescriptor("interval",(e=>mD(o,[new on.FixedInterval(e.start,e.length)])),0,Bo.Constants.MAX_SAFE_INTEGER),Sm.intervalsDescriptor("intervals",(e=>mD(o,f.ListUtils.map(e,(e=>new on.FixedInterval(e.start,e.length))))),0,Bo.Constants.MAX_SAFE_INTEGER)]),(e=>e))):t.rangePermissions;var i,n,o;const a=(0,S.isDefined)(e.userName)?function(e,t){return f.ListUtils.map(mm.check(e,1,!0,[mm.stringDescriptor("userName",(e=>fD(t,(t=>0==Qe.Comparers.stringIgnoreCase(t.userName,e)))),!1),mm.regExpDescriptor("regexp",(e=>fD(t,(t=>e.test(t.userName)))))]),(e=>e))}(e.userName,r):r,s=(0,S.isDefined)(e.group)?function(e,t){return f.ListUtils.map(mm.check(e,1,!0,[mm.stringDescriptor("group",(e=>fD(t,(t=>0==Qe.Comparers.stringIgnoreCase(t.group,e)))),!1),mm.regExpDescriptor("regexp",(e=>fD(t,(t=>e.test(t.group)))))]),(e=>e))}(e.group,r):a;return f.ListUtils.map(s,(e=>this._getItem(e)))}isAllowEdit(e){const t=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>[new on.FixedInterval(e,0)]),0,Bo.Constants.MAX_SAFE_INTEGER),Sm.intervalDescriptor("interval",(e=>[new on.FixedInterval(e.start,e.length)]),0,Bo.Constants.MAX_SAFE_INTEGER),Sm.intervalsDescriptor("intervals",(e=>f.ListUtils.map(e,(e=>new on.FixedInterval(e.start,e.length)))),0,Bo.Constants.MAX_SAFE_INTEGER)]);return this._subDocument.isEditable(t)}create(e,t="",r=Dd.Everyone_GROUP_NAME){const i=mm.check(e,1,!1,[Sm.intervalDescriptor("interval",(e=>new on.FixedInterval(e.start,e.length)))]),n=this._processor.modelManager;n.history.addAndRedo(new pD(n.modelManipulator,this._subDocument,new Fd(i,t,r)));const o=function(e,t,r,i){const n=mD(e,[t]);return f.ListUtils.elementBy(n,(e=>0==Qe.Comparers.stringIgnoreCase(e.userName,r)&&0==Qe.Comparers.stringIgnoreCase(e.group,i)))}(this._subDocument.rangePermissions,i,t,r);return this._getItem(o)}_getItem(e){return new bD(this._processor,this._subDocument,e)}_getCoreItems(){return this._subDocument.rangePermissions}}class SD extends Va.Rectangle{constructor(){super(0,0,0,0),this.rows=[],this.paragraphFrames=[],this.tablesInfo=[]}getEndPosition(){return this.pageAreaOffset+f.ListUtils.last(this.rows).getEndPosition()}getLastRow(){return f.ListUtils.last(this.rows)}static findSectionColumnWithMinimumWidth(e){return f.ListUtils.min(e,(e=>e.width)).width}deepCopy(){const e=new SD;return e.pageAreaOffset=this.pageAreaOffset,e.paragraphFrames=f.ListUtils.shallowCopy(this.paragraphFrames),e.tablesInfo=f.ListUtils.shallowCopy(this.tablesInfo),e.rows=f.ListUtils.shallowCopy(this.rows),e.copyFrom(this),e}}class ID extends Va.Rectangle{constructor(){super(0,0,0,0),this.paragraphColor=0}equals(e){return super.equals(e)&&this.paragraphColor==e.paragraphColor}clone(){const e=new ID;return e.copyFrom(this),e.paragraphColor=this.paragraphColor,e}}class PD extends ju{constructor(e){super(),this.selection=e,this.setIntervals(this.selection.getState().intervalsInfo),this.reset()}reset(){this.setIntervals(this.selection.getState().intervalsInfo),this.resetReturnValues()}resetSectionMergedProperties(){this.mergedSectionPropertiesRaw=null,this.mergedSectionPropertiesFull=null}getMergedSectionPropertiesRaw(){if(!this.mergedSectionPropertiesRaw){let e,t;const r=this.model.sections,i=this.selection.pageIndex;if(i<0){const i=this.intervalsInfo.interval,n=i.start;t=i.end,e=C.SearchUtils.normedInterpolationIndexOf(r,(e=>e.startLogPosition.value),n)}else{const n=this.selection.layout.pages[i];e=Ch.getPageSectionIndex(n,r),t=n.getEndPosition()}this.mergedSectionPropertiesRaw=r[e++].sectionProperties.clone();for(let i;(i=r[e])&&i.startLogPosition.value<t;e++)ju.mergePropertiesRaw(this.mergedSectionPropertiesRaw,i.sectionProperties,vI.ALL_FIELDS)}return this.mergedSectionPropertiesRaw}getMergedSectionPropertiesFull(){return this.mergedSectionPropertiesFull||(this.mergedSectionPropertiesFull=ju.mergePropertiesFull(this.getMergedSectionPropertiesRaw(),vI.ALL_FIELDS)),this.mergedSectionPropertiesFull}resetReturnValues(){super.resetReturnValues(),this.mergedSectionPropertiesRaw=null,this.mergedSectionPropertiesFull=null}}class wD{constructor(){this.onChanged=new Nb,this.init()}setScroll(e){this.state=e}init(){this.state=null}raiseOnChanged(){this.onChanged.listeners.forEach((e=>e.NotifyScrollChanged()))}}wD.StandartScrollPosition=-1,wD.DontChangeScrollPosition=-2;class yD{constructor(e,t,r){this.lp=e,this.relativePosition=t,this.getVerticalOffset=r}}!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Inside=2]="Inside"}(eE||(eE={}));class xD{byModelPosition(e){return this.byModelPositionCore(e.activeSubDocument,e.endOfLine,e.pageIndex)}byModelPositionCore(e,t,r){return new TD(e,t,r)}get byScrollInfo(){return new vD}get nothing(){return new MD}}class TD{get subDocument(){var e;return this._subDocument=null===(e=this._subDocument)||void 0===e?void 0:e.getActualSubDocument()}constructor(e,t,r){this._subDocument=e,this.endOfLine=t,this.pageIndex=r}getModelPosition(){return this.modelPosition}setModelPosition(e){return this.modelPosition=e,this}useCurrentPosition(e){return this.setModelPosition(e.anchorPosition)}setVerticalOffset(e){return this.getVerticalOffset=e,this}useStdOffset(){return this.setVerticalOffset((()=>0))}setRelativePosition(e){return this.relativePosition=e,this}useStdRelativePosition(){return this.setRelativePosition(eE.Inside)}getCanvasState(e){const t=this.modelPosition,r=this.subDocument.isMain()?new ug(e,this.subDocument,t,Hu.Character).create((new cg).setDefault(this.endOfLine),(new cg).setDefault(!1)):new pg(e,this.subDocument,t,this.pageIndex,Hu.Character).create((new cg).setDefault(this.endOfLine),(new cg).setDefault(!1));return r?new yD(r,this.relativePosition,this.getVerticalOffset):null}}class vD{setPageInfo(e){return this.getVerticalOffset=()=>e.topPositionRelativePage,this.pageIndex=e.pageIndex,this.relativePosition=eE.Top,this}getCanvasState(e){return e.isFullyFormatted||e.isPageValid(this.pageIndex+1)?new yD(new Kp(Hu.Page).initByIndexes(this.pageIndex).applyObjectsAsMainSubDocument(e,-1),this.relativePosition,this.getVerticalOffset):null}}class MD{getCanvasState(e){return null}}class ED{get interval(){return this.intervalsInfo.interval}get anchorPostion(){return this.forwardDirection?this.interval.start:this.interval.end}get activePostion(){return this.forwardDirection?this.interval.end:this.interval.start}get reversedAnchorPostion(){return this.forwardDirection?this.interval.end:this.interval.start}constructor(e,t,r,i){this.forwardDirection=!0,this.endOfLine=!1,this.keepX=-1,this.pageIndex=-1,this.intervalsInfo=e.clone(),this.forwardDirection=t,this.endOfLine=r,this.pageIndex=i}setEndOfLine(e){return this.endOfLine=e,this}resetKeepX(){return this.keepX=-1,this}setKeepX(e){return this.keepX=e,this}setForwardDirection(e){return this.forwardDirection=e,this}setInterval(e){return this.intervalsInfo.intervals=[this.getNormalizedLastInterval(e)],this}setIntervals(e){return this.intervalsInfo.intervals=e,this}setPosition(e){return this.intervalsInfo.position=e,this}addInterval(e){return this.intervalsInfo.isCollapsed?this.intervalsInfo.interval=e:this.intervalsInfo.lastIntervalIndex=this.intervalsInfo.intervals.push(this.getNormalizedLastInterval(e))-1,this}extendLastInterval(e){const t=this.anchorPostion;return this.interval.start=Math.min(t,e),this.interval.length=Math.abs(t-e),this.forwardDirection=e>=t,this}setPageIndex(e){return this.pageIndex=e,this}setSubDocument(e){return this.intervalsInfo.subDocument=e,this}getNormalizedLastInterval(e){return this.forwardDirection=e.length>=0,this.forwardDirection?e:new on.FixedInterval(e.end,e.start)}static getDefault(e){return new ED(tp.fromPosition(e,0),!0,!1,-1)}clone(){return new ED(this.intervalsInfo.clone(),this.forwardDirection,this.endOfLine,this.pageIndex)}equals(e){return this.partiallyEquals(e)&&f.ListUtils.equals(this.intervalsInfo.intervals,e.intervalsInfo.intervals)}partiallyEquals(e){return e&&this.keepX==e.keepX&&this.forwardDirection==e.forwardDirection&&this.endOfLine==e.endOfLine&&this.intervalsInfo.lastIntervalIndex==e.intervalsInfo.lastIntervalIndex&&this.pageIndex==e.pageIndex}}class DD{constructor(e){this.state=e,this.linkedIntervals=f.ListUtils.map(e.intervalsInfo.intervals,(t=>new md(e.intervalsInfo.subDocument.positionManager,t)))}finalize(){const e=[];for(let t of this.linkedIntervals)e.push(t.getFixedInterval()),t.destructor(this.state.intervalsInfo.subDocument.positionManager);return this.linkedIntervals=[],this.state.intervalsInfo.intervals=e,this.state}}class FD{constructor(){this.correctIntervalDueToFields=!0,this.correctIntervalDueToTables=!0,this.useFieldUiChecks=!0,this.isForceUpdate=!1}noFieldCorrect(){return this.correctIntervalDueToFields=!1,this}noTablesCorrect(){return this.correctIntervalDueToTables=!1,this}noFieldUiChecks(){return this.useFieldUiChecks=!1,this}forceUpdate(){return this.isForceUpdate=!0,this}}class RD extends Lb.IS{get currState(){return this._state}get keepX(){return this._state.keepX}set keepX(e){this._state.keepX=e}get forwardDirection(){return this._state.forwardDirection}set forwardDirection(e){this._state.forwardDirection=e}get endOfLine(){return this._state.endOfLine}set endOfLine(e){this._state.endOfLine=e}get pageIndex(){return this._state.pageIndex}set pageIndex(e){this._state.pageIndex=e}get intervals(){return this._state.intervalsInfo.intervals}get activeSubDocument(){return this._state.intervalsInfo.subDocument}get lastSelectedInterval(){return this._state.interval}get intervalsInfo(){return this._state.intervalsInfo}get prevState(){return this._prevState}get multiselection(){return this._state.intervalsInfo.multiselection}get anchorPosition(){return this._state.anchorPostion}get reversedAnchorPostion(){return this._state.reversedAnchorPostion}isCollapsed(){return this._state.intervalsInfo.isCollapsed}get subDocumentIntervals(){return new mu(this.activeSubDocument,f.ListUtils.deepCopy(this._state.intervalsInfo.intervals))}get subDocumentInterval(){return this._state.intervalsInfo.subDocInterval}get specialRunInfo(){return this._state.intervalsInfo.specialRunInfo}get tableInfo(){return this._state.intervalsInfo.tableInfo}constructor(e,t,r){super(),this.searchIntervals=[],this.misspelledIntervals=[],this.onChanged=new Nb,this.onSearchChanged=new Nb,this.onMisspelledSelectionChanged=new Nb,this.model=e,this.layout=t,this.scrollManager=new wD,this._prevState=ED.getDefault(r),this._state=ED.getDefault(r)}dispose(){this.onChanged.dispose()}setSelection(e){const t=new FD;t.correctIntervalDueToFields=e.correctIntervalDueToFields,t.correctIntervalDueToTables=e.correctIntervalDueToTables,t.useFieldUiChecks=e.useFieldUiChecks,this.changeState((t=>{t.intervalsInfo.intervals=[e.interval],t.intervalsInfo.lastIntervalIndex=0,t.endOfLine=e.endOfLine,t.keepX=e.keepX}),t),this.resetInputPositionIfNeeded()}getState(){return this._state.clone()}changeState(e,t=new FD){const r=this.getState();return e(r),this.setState(r,t)}setState(e,t=new FD){const r=e.interval.start;if(t.correctIntervalDueToTables)for(let t of e.intervalsInfo.intervals)Zu.correctIntervalDueToTables(e.intervalsInfo.subDocument,t);if(t.correctIntervalDueToFields)for(let r of e.intervalsInfo.intervals)t.useFieldUiChecks?Md.correctIntervalDueToFields(e.intervalsInfo.subDocument,r):Md.correctIntervalDueToFieldsWithoutUiChecks(e.intervalsInfo.subDocument,r);for(let t of e.intervalsInfo.intervals)new gu(e.intervalsInfo.subDocument,t).validateInterval();e.intervalsInfo.intervals=nn.IntervalAlgorithms.getMergedIntervals(e.intervalsInfo.intervals,!0),e.intervalsInfo.lastIntervalIndex=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e.intervalsInfo.intervals,(e=>e.start),r));const i=t.isForceUpdate||!f.ListUtils.equals(this._state.intervalsInfo.intervals,e.intervalsInfo.intervals)||!this._state.partiallyEquals(e)||this._state.intervalsInfo.subDocument!=e.intervalsInfo.subDocument;return i&&(this._prevState=this._state,this._state=e,e.intervalsInfo.resetTableInfo(),e.intervalsInfo.specialRunInfo.init(e.intervalsInfo,this.model),this.raiseSelectionChanged()),i}correctAfterTextBufferChanged(){const e=nn.IntervalAlgorithms.getIntersectionsTwoArraysOfInterval([on.FixedInterval.fromPositions(0,this.activeSubDocument.getDocumentEndPosition())],this.intervals);this.changeState((t=>{const r=t.intervalsInfo.interval.start;t.intervalsInfo.intervals=e,t.intervalsInfo.lastIntervalIndex=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(t.intervalsInfo.intervals,(e=>e.start),r))}))}getFloatingState(){return new DD(this.getState())}restoreFloatingState(e){this.setState(e.finalize())}setSearchSelectionIntervals(e){this.searchIntervals=nn.IntervalAlgorithms.getMergedIntervals(e,!1),this.raiseSearchSelectionChanged()}resetSearchSelection(){this.searchIntervals.length&&(this.searchIntervals=[],this.raiseSearchSelectionChanged())}onUpdateUnlocked(e){e&tE.SelectionChanged&&this.raiseSelectionChanged(),e&tE.SearchSelectionChanged&&this.raiseSearchSelectionChanged(),e&tE.MisspelledSelectionChanged&&this.raiseMisspelledSelectionChanged()}setMisspelledSelectionIntervals(e){this.misspelledIntervals=nn.IntervalAlgorithms.getMergedIntervals(e,!1),this.raiseMisspelledSelectionChanged()}raiseSelectionChanged(){this.isUpdateLocked()?this.registerOccurredEvent(tE.SelectionChanged):this.onChanged.listeners.forEach((e=>e.NotifySelectionChanged(this)))}raiseSearchSelectionChanged(){this.isUpdateLocked()?this.registerOccurredEvent(tE.SearchSelectionChanged):this.onSearchChanged.listeners.forEach((e=>e.NotifySearchSelectionChanged()))}raiseMisspelledSelectionChanged(){this.isUpdateLocked()?this.registerOccurredEvent(tE.MisspelledSelectionChanged):this.onMisspelledSelectionChanged.listeners.forEach((e=>e.NotifyMisspelledSelectionChanged()))}deprecatedSetSelection(e,t,r,i,n,o=!0,a=!0,s=wD.StandartScrollPosition,l=!0){const d=new FD;d.useFieldUiChecks=l,d.correctIntervalDueToTables=a,d.correctIntervalDueToFields=o,this.changeState((n=>{n.setInterval(new on.FixedInterval(Math.min(e,t),Math.abs(e-t))).setKeepX(i).setEndOfLine(r).setForwardDirection(t>=e)}),d),s!=wD.DontChangeScrollPosition&&this.scrollManager.setScroll(wD.StandartScrollPosition?(new xD).byModelPosition(this).useCurrentPosition(this).useStdRelativePosition().useStdOffset():(new xD).byModelPosition(this).setModelPosition(s).useStdRelativePosition().useStdOffset()),this.resetInputPositionIfNeeded()}shouldResetInputPosition(){var e;const t=this.getState();return t.intervalsInfo.subDocument.id!=(null===(e=this.prevState.intervalsInfo.subDocument)||void 0===e?void 0:e.id)||!f.ListUtils.equals(t.intervalsInfo.intervals,this.prevState.intervalsInfo.intervals)}resetInputPositionIfNeeded(){this.shouldResetInputPosition()&&this.inputPosition.reset()}}!function(e){e[e.None=0]="None",e[e.SelectionChanged=1]="SelectionChanged",e[e.SearchSelectionChanged=4]="SearchSelectionChanged",e[e.MisspelledSelectionChanged=8]="MisspelledSelectionChanged"}(tE||(tE={}));class LD{constructor(e,t){this.pos=t.registerPosition(e),this.posManager=t}get modelPosition(){return this.pos.value}destructor(){this.posManager.unregisterPosition(this.pos)}}class BD{constructor(e){this.model=e,this.cache={}}add(e,t){this.delete(e.objectId),this.cache[e.objectId]=new LD(t,this.model.subDocumentsCollection.collection[e.belongsToSubDocId].positionManager)}delete(e){const t=this.cache[e];t&&(t.destructor(),delete this.cache[e])}getPosition(e){return this.cache[e].modelPosition}clear(){b.j.forEach(this.cache,(e=>e.destructor())),this.cache={}}}class AD{constructor(e){this.anchorObjectsPositionInfo=e,this.setEmptyLayout(y.NO_COLOR)}setEmptyLayout(e){this.pages=[],this.validPageCount=0,this.lastMaxNumPages=0,this.isFullyFormatted=!1,this.pageColor=e,this.anchorObjectsPositionInfo.clear()}getLastValidPage(){return this.pages[this.validPageCount-1]}isPageValid(e){return e<this.validPageCount&&this.pages[e].isValid}getPageBySubDocumentId(e){return this.pages.find((t=>!!t.mainSubDocumentPageAreas[e]||!!t.otherPageAreas[e]))}}!function(e){e[e.Nil=-1]="Nil",e[e.None=0]="None",e[e.Single=1]="Single",e[e.Thick=2]="Thick",e[e.Double=3]="Double",e[e.Dotted=4]="Dotted",e[e.Dashed=5]="Dashed",e[e.DotDash=6]="DotDash",e[e.DotDotDash=7]="DotDotDash",e[e.Triple=8]="Triple",e[e.ThinThickSmallGap=9]="ThinThickSmallGap",e[e.ThickThinSmallGap=10]="ThickThinSmallGap",e[e.ThinThickThinSmallGap=11]="ThinThickThinSmallGap",e[e.ThinThickMediumGap=12]="ThinThickMediumGap",e[e.ThickThinMediumGap=13]="ThickThinMediumGap",e[e.ThinThickThinMediumGap=14]="ThinThickThinMediumGap",e[e.ThinThickLargeGap=15]="ThinThickLargeGap",e[e.ThickThinLargeGap=16]="ThickThinLargeGap",e[e.ThinThickThinLargeGap=17]="ThinThickThinLargeGap",e[e.Wave=18]="Wave",e[e.DoubleWave=19]="DoubleWave",e[e.DashSmallGap=20]="DashSmallGap",e[e.DashDotStroked=21]="DashDotStroked",e[e.ThreeDEmboss=22]="ThreeDEmboss",e[e.ThreeDEngrave=23]="ThreeDEngrave",e[e.Outset=24]="Outset",e[e.Inset=25]="Inset",e[e.Apples=26]="Apples",e[e.ArchedScallops=27]="ArchedScallops",e[e.BabyPacifier=28]="BabyPacifier",e[e.BabyRattle=29]="BabyRattle",e[e.Balloons3Colors=30]="Balloons3Colors",e[e.BalloonsHotAir=31]="BalloonsHotAir",e[e.BasicBlackDashes=32]="BasicBlackDashes",e[e.BasicBlackDots=33]="BasicBlackDots",e[e.BasicBlackSquares=34]="BasicBlackSquares",e[e.BasicThinLines=35]="BasicThinLines",e[e.BasicWhiteDashes=36]="BasicWhiteDashes",e[e.BasicWhiteDots=37]="BasicWhiteDots",e[e.BasicWhiteSquares=38]="BasicWhiteSquares",e[e.BasicWideInline=39]="BasicWideInline",e[e.BasicWideMidline=40]="BasicWideMidline",e[e.BasicWideOutline=41]="BasicWideOutline",e[e.Bats=42]="Bats",e[e.Birds=43]="Birds",e[e.BirdsFlight=44]="BirdsFlight",e[e.Cabins=45]="Cabins",e[e.CakeSlice=46]="CakeSlice",e[e.CandyCorn=47]="CandyCorn",e[e.CelticKnotwork=48]="CelticKnotwork",e[e.CertificateBanner=49]="CertificateBanner",e[e.ChainLink=50]="ChainLink",e[e.ChampagneBottle=51]="ChampagneBottle",e[e.CheckedBarBlack=52]="CheckedBarBlack",e[e.CheckedBarColor=53]="CheckedBarColor",e[e.Checkered=54]="Checkered",e[e.ChristmasTree=55]="ChristmasTree",e[e.CirclesLines=56]="CirclesLines",e[e.CirclesRectangles=57]="CirclesRectangles",e[e.ClassicalWave=58]="ClassicalWave",e[e.Clocks=59]="Clocks",e[e.Compass=60]="Compass",e[e.Confetti=61]="Confetti",e[e.ConfettiGrays=62]="ConfettiGrays",e[e.ConfettiOutline=63]="ConfettiOutline",e[e.ConfettiStreamers=64]="ConfettiStreamers",e[e.ConfettiWhite=65]="ConfettiWhite",e[e.CornerTriangles=66]="CornerTriangles",e[e.CouponCutoutDashes=67]="CouponCutoutDashes",e[e.CouponCutoutDots=68]="CouponCutoutDots",e[e.CrazyMaze=69]="CrazyMaze",e[e.CreaturesButterfly=70]="CreaturesButterfly",e[e.CreaturesFish=71]="CreaturesFish",e[e.CreaturesInsects=72]="CreaturesInsects",e[e.CreaturesLadyBug=73]="CreaturesLadyBug",e[e.CrossStitch=74]="CrossStitch",e[e.Cup=75]="Cup",e[e.DecoArch=76]="DecoArch",e[e.DecoArchColor=77]="DecoArchColor",e[e.DecoBlocks=78]="DecoBlocks",e[e.DiamondsGray=79]="DiamondsGray",e[e.DoubleD=80]="DoubleD",e[e.DoubleDiamonds=81]="DoubleDiamonds",e[e.Earth1=82]="Earth1",e[e.Earth2=83]="Earth2",e[e.EclipsingSquares1=84]="EclipsingSquares1",e[e.EclipsingSquares2=85]="EclipsingSquares2",e[e.EggsBlack=86]="EggsBlack",e[e.Fans=87]="Fans",e[e.Film=88]="Film",e[e.Firecrackers=89]="Firecrackers",e[e.FlowersBlockPrint=90]="FlowersBlockPrint",e[e.FlowersDaisies=91]="FlowersDaisies",e[e.FlowersModern1=92]="FlowersModern1",e[e.FlowersModern2=93]="FlowersModern2",e[e.FlowersPansy=94]="FlowersPansy",e[e.FlowersRedRose=95]="FlowersRedRose",e[e.FlowersRoses=96]="FlowersRoses",e[e.FlowersTeacup=97]="FlowersTeacup",e[e.FlowersTiny=98]="FlowersTiny",e[e.Gems=99]="Gems",e[e.GingerbreadMan=100]="GingerbreadMan",e[e.Gradient=101]="Gradient",e[e.Handmade1=102]="Handmade1",e[e.Handmade2=103]="Handmade2",e[e.HeartBalloon=104]="HeartBalloon",e[e.HeartGray=105]="HeartGray",e[e.Hearts=106]="Hearts",e[e.HeebieJeebies=107]="HeebieJeebies",e[e.Holly=108]="Holly",e[e.HouseFunky=109]="HouseFunky",e[e.Hypnotic=110]="Hypnotic",e[e.IceCreamCones=111]="IceCreamCones",e[e.LightBulb=112]="LightBulb",e[e.Lightning1=113]="Lightning1",e[e.Lightning2=114]="Lightning2",e[e.MapleLeaf=115]="MapleLeaf",e[e.MapleMuffins=116]="MapleMuffins",e[e.MapPins=117]="MapPins",e[e.Marquee=118]="Marquee",e[e.MarqueeToothed=119]="MarqueeToothed",e[e.Moons=120]="Moons",e[e.Mosaic=121]="Mosaic",e[e.MusicNotes=122]="MusicNotes",e[e.Northwest=123]="Northwest",e[e.Ovals=124]="Ovals",e[e.Packages=125]="Packages",e[e.PalmsBlack=126]="PalmsBlack",e[e.PalmsColor=127]="PalmsColor",e[e.PaperClips=128]="PaperClips",e[e.Papyrus=129]="Papyrus",e[e.PartyFavor=130]="PartyFavor",e[e.PartyGlass=131]="PartyGlass",e[e.Pencils=132]="Pencils",e[e.People=133]="People",e[e.PeopleHats=134]="PeopleHats",e[e.PeopleWaving=135]="PeopleWaving",e[e.Poinsettias=136]="Poinsettias",e[e.PostageStamp=137]="PostageStamp",e[e.Pumpkin1=138]="Pumpkin1",e[e.PushPinNote1=139]="PushPinNote1",e[e.PushPinNote2=140]="PushPinNote2",e[e.Pyramids=141]="Pyramids",e[e.PyramidsAbove=142]="PyramidsAbove",e[e.Quadrants=143]="Quadrants",e[e.Rings=144]="Rings",e[e.Safari=145]="Safari",e[e.Sawtooth=146]="Sawtooth",e[e.SawtoothGray=147]="SawtoothGray",e[e.ScaredCat=148]="ScaredCat",e[e.Seattle=149]="Seattle",e[e.ShadowedSquares=150]="ShadowedSquares",e[e.SharksTeeth=151]="SharksTeeth",e[e.ShorebirdTracks=152]="ShorebirdTracks",e[e.Skyrocket=153]="Skyrocket",e[e.SnowflakeFancy=154]="SnowflakeFancy",e[e.Snowflakes=155]="Snowflakes",e[e.Sombrero=156]="Sombrero",e[e.Southwest=157]="Southwest",e[e.Stars=158]="Stars",e[e.Stars3d=159]="Stars3d",e[e.StarsBlack=160]="StarsBlack",e[e.StarsShadowed=161]="StarsShadowed",e[e.StarsTop=162]="StarsTop",e[e.Sun=163]="Sun",e[e.Swirligig=164]="Swirligig",e[e.TornPaper=165]="TornPaper",e[e.TornPaperBlack=166]="TornPaperBlack",e[e.Trees=167]="Trees",e[e.TriangleParty=168]="TriangleParty",e[e.Triangles=169]="Triangles",e[e.Tribal1=170]="Tribal1",e[e.Tribal2=171]="Tribal2",e[e.Tribal3=172]="Tribal3",e[e.Tribal4=173]="Tribal4",e[e.Tribal5=174]="Tribal5",e[e.Tribal6=175]="Tribal6",e[e.TwistedLines1=176]="TwistedLines1",e[e.TwistedLines2=177]="TwistedLines2",e[e.Vine=178]="Vine",e[e.Waveline=179]="Waveline",e[e.WeavingAngles=180]="WeavingAngles",e[e.WeavingBraid=181]="WeavingBraid",e[e.WeavingRibbon=182]="WeavingRibbon",e[e.WeavingStrips=183]="WeavingStrips",e[e.WhiteFlowers=184]="WhiteFlowers",e[e.Woodwork=185]="Woodwork",e[e.XIllusions=186]="XIllusions",e[e.ZanyTriangles=187]="ZanyTriangles",e[e.ZigZag=188]="ZigZag",e[e.ZigZagStitch=189]="ZigZagStitch"}(rE||(rE={})),function(e){e[e.Auto=1]="Auto",e[e.Percent=2]="Percent",e[e.Twips=3]="Twips"}(iE||(iE={})),function(e){e[e.Minimum=0]="Minimum",e[e.Auto=1]="Auto",e[e.Exact=2]="Exact"}(nE||(nE={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center"}(oE||(oE={})),function(e){e[e.Top=0]="Top",e[e.Center=2]="Center",e[e.Bottom=3]="Bottom"}(aE||(aE={}));class ND{constructor(e,t,r,i){Object.assign(this,{top:e,right:t,bottom:r,left:i})}}class kD extends ND{constructor(e,t,r,i,n,o){super(e,t,r,i),Object.assign(this,{insideHorizontal:n,insideVertical:o})}}class OD extends ND{constructor(e,t,r,i){super(e,t,r,i)}}class _D{constructor(e,t,r){Object.assign(this,{style:e,color:t,width:r})}}class UD{constructor(e,t){this.width=Math.max(0,e),this.height=Math.max(0,t)}}class HD{constructor(e,t,r,i){this.left=Math.max(0,e),this.right=Math.max(0,t),this.top=Math.max(0,r),this.bottom=Math.max(0,i)}}class VD{constructor(e,t){this._processor=e,this._subDocument=t,this._history=e.modelManager.history,this._modelManipulator=e.modelManager.modelManipulator}_validateWidth(e){const t=mm.objectDescriptor("width","TableWidth",(e=>e)),r=mm.enumDescriptor("width.type",(e=>e),iE,"TableWidthType"),i=mm.numberDescriptor("width.value",(e=>e),0);mm.check(e,1,!1,[t]),mm.check(e.type,1,!1,[r]),mm.check(e.value,1,!1,[i])}_getWidth(e){const{type:t,value:r}=e;return{type:Number(t),value:t===Je.FiftiethsOfPercent?Math.floor(r/50):r}}_getModelWidth(e){const t=e.type===iE.Percent?Math.floor(50*e.value):e.value;return lr.create(t,Number(e.type))}_getBackgroundColor(e){const t=e.backColor.toRgb(this._subDocument.documentModel.colorProvider);return y.getHashString(t)}_validateContentHorizontalAlignment(e){const t=mm.enumDescriptor("contentHorizontalAlignment",(e=>e),oE,"TableContentHorizontalAlignment");mm.check(e,1,!1,[t])}_getStartHorizontalAlignment(e){const t=e.interval.start;return this._subDocument.getParagraphByPosition(t).getParagraphMergedProperties().alignment}_setCellHorizontalAlignment(e,t){const r=new gu(this._subDocument,e.interval),i=new st(this._modelManipulator,r,Number(t),!0);this._history.addAndRedo(i)}_validateContentVerticalAlignment(e){const t=mm.enumDescriptor("contentVerticalAlignment",(e=>e),aE,"TableContentVerticalAlignment");mm.check(e,1,!1,[t])}_setCellVerticalAlignment(e,t){const{cell:r,table:i,rowIndex:n,cellIndex:o}=e;if(Number(r.properties.verticalAlignment)===Number(t))return;const a=new ic(this._modelManipulator,this._subDocument,i.index,n,o,Number(t),!0);this._history.addAndRedo(a)}_validateBorders(e,t){const r=new e,i=mm.objectDescriptor("borders","Borders",(e=>e));mm.check(t,1,!1,[i]);for(const e of Object.keys(t)){const i=mm.objectDescriptor(`borders.${e}`,"Border",(e=>e)),n=mm.enumDescriptor(`borders.${e}.style`,(e=>Number(e)),rE,"BorderLineStyle"),o=mm.numberDescriptor(`borders.${e}.width`,(e=>e),0),a=mm.check(t[e],1,!0,[i]);void 0!==a&&(r[e]=new Me,r[e].style=mm.check(a.style,1,!1,[n]),r[e].color=this._validateColor(a.color,1,`borders.${e}.color`),r[e].width=mm.check(a.width,1,!1,[o]))}return r}_validateColor(e,t,r){const i=mm.check(e,t,!1,Sm.colorDescriptors(r));return he.makeByColor(i)}_getBordersApi(e,t){const r=new e;for(const e of Object.keys(r)){const i=t[e].color.toRgb(this._subDocument.documentModel.colorProvider);r[e]=new _D(Number(t[e].style),y.getHashString(i),t[e].width)}return r}_validateMargins(e,t){const r=new ar,i=mm.objectDescriptor(t,"Margins",(e=>e));mm.check(e,1,!1,[i]);for(const i of Object.keys(e)){const n=mm.numberDescriptor(`${t}.${i}`,(e=>e),0),o=mm.check(e[i],1,!0,[n]);void 0!==o&&(r[i]=lr.create(o,Je.ModelUnits))}return r}_getMarginsApi(e){return new HD(e.left.value,e.right.value,e.top.value,e.bottom.value)}}class WD extends VD{constructor(e,t,r,i){super(e,t),this._tablePosition=r,this._parentRow=i||new XD(this._processor,this._subDocument,this._tablePosition)}get index(){return this._tablePosition.cellIndex}get interval(){return Tb(this._tablePosition.cell.interval)}get parentRow(){return this._parentRow}get width(){return this._getWidth(this._tablePosition.cell.preferredWidth)}set width(e){this._validateWidth(e);const{table:t,rowIndex:r,cellIndex:i}=this._tablePosition,n=this._getModelWidth(e),o=new tc(this._modelManipulator,this._subDocument,t.index,r,i,n);this._history.addAndRedo(o)}get backgroundColor(){const e=this._tablePosition.cell.getActualShadingInfo(this._tablePosition.cell.properties);return this._getBackgroundColor(e)}set backgroundColor(e){const{table:t,rowIndex:r,cellIndex:i}=this._tablePosition,n=this._validateColor(e,1,"backgroundColor"),o=fe.createByColor(n),a=new nc(this._modelManipulator,this._subDocument,t.index,r,i,o,!0);this._history.addAndRedo(a)}get contentHorizontalAlignment(){const e=this._getStartHorizontalAlignment(this._tablePosition.cell);return this._subDocument.getParagraphsByInterval(this._tablePosition.cell.interval).every((t=>t.getParagraphMergedProperties().alignment===e))?Number(e):null}set contentHorizontalAlignment(e){this._validateContentHorizontalAlignment(e),this._history.addTransaction((()=>this._setCellHorizontalAlignment(this._tablePosition.cell,e)))}get contentVerticalAlignment(){return Number(this._tablePosition.cell.properties.verticalAlignment)}set contentVerticalAlignment(e){this._validateContentVerticalAlignment(e),this._setCellVerticalAlignment(this._tablePosition,e)}get characterProperties(){return ym(this._processor,this._subDocument,this._tablePosition.cell.interval)}set characterProperties(e){xm(this._processor,this._subDocument,this._tablePosition.cell.interval,e)}get borders(){const{cell:e}=this._tablePosition,t=e.getActualBorders(e.properties);return this._getBordersApi(OD,t)}set borders(e){const{table:t,rowIndex:r,cellIndex:i}=this._tablePosition,n=this._validateBorders(or,e),o=[n.top,n.right,n.bottom,n.left],a=o.map((e=>!!e||void 0)),s=new ec(this._modelManipulator,this._subDocument,t.index,r,i,o,a);this._history.addAndRedo(s)}get margins(){const{cell:e}=this._tablePosition,t=e.getActualMargins(this._modelManipulator.model);return this._getMarginsApi(t)}set margins(e){const{table:t,rowIndex:r,cellIndex:i}=this._tablePosition,n=this._validateMargins(e,"margins"),o=[n.top,n.right,n.bottom,n.left],a=o.map((e=>!!e||void 0)),s=new Zd(this._modelManipulator,this._subDocument,t.index,r,i,o,a);this._history.addAndRedo(s)}split(e,t){const r=mm.numberDescriptor("columnCount",(e=>e),0);mm.check(e,1,!1,[r]);const i=mm.numberDescriptor("rowCount",(e=>e),0);mm.check(t,2,!1,[i]);const n=ED.getDefault(this._subDocument).setInterval(this._tablePosition.cell.interval),o=new AD(new BD(this._processor.modelManager.model)),a=new RD(this._modelManipulator.model,o,this._subDocument);a.setState(n);const s=new PD(a);this._processor.beginUpdate(),this._history.addTransaction((()=>{oc.splitTableCellsHorizontallyCore(this._processor,this._subDocument,this._tablePosition,e,s),oc.splitTableCellsVerticallyCore(this._processor,this._subDocument,this._tablePosition,t,e,s),ac.updateTable(this._processor.modelManager,this._tablePosition.table,a.activeSubDocument)})),this._processor.endUpdate()}}class zD extends _E{constructor(e,t){super(e),this._subDocument=t,this._history=e.modelManager.history,this._modelManipulator=e.modelManager.modelManipulator}_insertTable(e,t,r,i,n){const o=this._modelManipulator.table.insertTable(this._subDocument,e,t,r,i,n,!0);return this._updateTable(o),o}_insertRowBelow(e,t){this._modelManipulator.table.insertRowBelow(this._subDocument,e,t),this._updateTable(e)}_insertRowAbove(e,t){this._modelManipulator.table.insertRowAbove(this._subDocument,e,t),this._updateTable(e)}_insertCellToTheRight(e,t,r,i){this._modelManipulator.table.insertCellToTheRight(this._subDocument,e,t,r,i,!0,!0,!0,!1),this._normalizeVerticalSpans(e)}_insertCellToTheLeft(e,t,r,i){this._modelManipulator.table.insertCellToTheLeft(this._subDocument,e,t,r,i),this._normalizeVerticalSpans(e)}_removeTable(e){this._modelManipulator.table.removeTableWithContent(this._subDocument,e)}_removeRow(e,t){this._modelManipulator.table.removeTableRowWithContent(this._subDocument,e,t),this._normalizeCellColumnSpans(e),this._updateTable(e)}_removeCell(e,t,r){this._modelManipulator.table.removeTableCellWithContent(this._subDocument,e,t,r),this._normalizeVerticalSpans(e),this._updateTable(e)}_normalizeCellColumnSpans(e){this._modelManipulator.table.normalizeCellColumnSpans(this._subDocument,e,!1)}_normalizeVerticalSpans(e){this._modelManipulator.table.normalizeVerticalSpans(this._subDocument,e)}_updateTable(e){ac.updateTable(this._processor.modelManager,e,this._subDocument)}}class jD extends zD{constructor(e,t,r,i){super(e,t),this._parentRow=i,this._tablePosition=r}_getItem(e){const t=this._tablePosition.clone();return t.cellIndex=t.row.cells.indexOf(e),t.cell=t.row.cells[t.cellIndex],new WD(this._processor,this._subDocument,t,this._parentRow)}_getCoreItems(){return this._tablePosition.row.cells}insert(e,t=!1){const{table:r,row:i,rowIndex:n}=this._tablePosition,o=mm.numberDescriptor("index",(e=>e),0,i.cells.length),a=mm.booleanDescriptor("toRight",(e=>e));return e=mm.check(e,1,!1,[o]),t=mm.check(t,2,!1,[a]),this._processor.beginUpdate(),this._history.addTransaction((()=>{const o=i.cells[e].interval,a=tp.fromInterval(this._subDocument,o),s=(new ju).setIntervals(a);t?this._insertCellToTheRight(r,n,e,s):this._insertCellToTheLeft(r,n,e,s)})),this._processor.endUpdate(),this.getByIndex(e+Number(t))}remove(e){const{table:t,row:r,rowIndex:i}=this._tablePosition,n=mm.numberDescriptor("index",(e=>e),0,r.cells.length);e=mm.check(e,1,!1,[n]),this._processor.beginUpdate(),this._history.addTransaction((()=>{this.count>1&&t.rows.length>1?this._removeCell(t,i,e):t.rows.length>1?this._removeRow(t,i):this._removeTable(t)})),this._processor.endUpdate()}}class XD extends VD{constructor(e,t,r,i){super(e,t),this._tablePosition=r,this._parentTable=i||new $D(this._processor,this._subDocument,this._tablePosition.table)}get index(){return this._tablePosition.rowIndex}get interval(){return Tb(this._tablePosition.row.interval)}get cells(){return new jD(this._processor,this._subDocument,this._tablePosition.clone(),this)}get parentTable(){return this._parentTable}get height(){return{type:Number(this._tablePosition.row.height.type),value:this._tablePosition.row.height.value}}set height(e){const t=mm.objectDescriptor("height","TableRowHeight",(e=>e)),r=mm.enumDescriptor("height.type",(e=>e),nE,"TableRowHeightType"),i=mm.numberDescriptor("height.value",(e=>e),0);mm.check(e,1,!1,[t]),mm.check(e.type,1,!1,[r]),mm.check(e.value,1,!1,[i]);const n=dr.create(e.value,Number(e.type)),o=new jd(this._modelManipulator,this._subDocument,this._tablePosition.table.index,this.index,n);this._history.addAndRedo(o)}}class GD extends zD{constructor(e,t,r,i){super(e,t),this._table=r,this._tableApi=i}_getItem(e){const t=new Qa(this._table,this._table.rows.indexOf(e),-1);return t.row=t.table.rows[t.rowIndex],new XD(this._processor,this._subDocument,t,this._tableApi)}_getCoreItems(){return this._table.rows}insert(e,t=!1){const r=mm.numberDescriptor("index",(e=>e),0,this._table.rows.length),i=mm.booleanDescriptor("below",(e=>e));return e=mm.check(e,1,!1,[r]),t=mm.check(t,2,!1,[i]),this._processor.beginUpdate(),this._history.addTransaction((()=>{t?this._insertRowBelow(this._table,e):this._insertRowAbove(this._table,e)})),this._processor.endUpdate(),this.getByIndex(e+Number(t))}remove(e){const t=mm.numberDescriptor("index",(e=>e),0,this._table.rows.length);e=mm.check(e,1,!1,[t]),this._processor.beginUpdate(),this._history.addTransaction((()=>{this.count>1?this._removeRow(this._table,e):this._removeTable(this._table)})),this._processor.endUpdate()}}class KD{constructor(e,t,r,i,n,o){Object.assign(this,{headerRow:e,totalRow:t,bandedRows:r,firstColumn:i,lastColumn:n,bandedColumns:o})}}const qD=["headerRow","totalRow","bandedRows","firstColumn","lastColumn","bandedColumns"];class $D extends VD{constructor(e,t,r){super(e,t),this._table=r}get index(){return this._table.index}get interval(){return new xb(this._table.interval.start,this._table.interval.length)}delete(){this._processor.beginUpdate(),this._modelManipulator.table.removeTableWithContent(this._subDocument,this._table),this._processor.endUpdate()}get rows(){return new GD(this._processor,this._subDocument,this._table,this)}get parentCell(){const e=this._table.parentCell;if(!e)return null;const t=e.parentRow,r=t.parentTable,i=r.rows.indexOf(t),n=t.cells.indexOf(e),o=new Qa(r,i,n).init();return new WD(this._processor,this._subDocument,o)}get autoFit(){return Boolean(this._table.getActualTableLayout(this._table.properties))}set autoFit(e){const t=mm.booleanDescriptor("autoFit",(e=>e));mm.check(e,1,!1,[t]);const r=new Qm(this._modelManipulator,this._subDocument,this._table.index,Number(e),!0);this._history.addAndRedo(r)}get width(){return this._getWidth(this._table.preferredWidth)}set width(e){this._validateWidth(e);const t=this._getModelWidth(e),r=new Jm(this._modelManipulator,this._subDocument,this._table.index,t);this._history.addAndRedo(r)}get styleName(){return this._table.style.styleName}set styleName(e){var t;const r=mm.stringDescriptor("style",(e=>e),!1);mm.check(e,1,!1,[r]);const i=this._processor.modelManager.model,n=i.getTableStyleByName(e)||i.stylesManager.addTableStyle(null===(t=Wh.getPresetTableStyleByName(e))||void 0===t?void 0:t.clone());if(!n)throw new Error("Style not found.");const o=new _p(this._modelManipulator,this._subDocument,this._table.index,n);this._history.addAndRedo(o)}get tableStyleOptions(){const e=this._table.lookTypes;return new KD(!!(e&_e.ApplyFirstRow),!!(e&_e.ApplyLastRow),!(e&_e.DoNotApplyRowBanding),!!(e&_e.ApplyFirstColumn),!!(e&_e.ApplyLastColumn),!(e&_e.DoNotApplyColumnBanding))}set tableStyleOptions(e){const t=mm.objectDescriptor("tableStyleOptions","TableStyleOptions",(e=>e));mm.check(e,1,!1,[t]);for(const t of qD){const r=mm.booleanDescriptor(`tableStyleOptions.${t}`,(e=>e));mm.check(e[t],1,!1,[r])}let r=this._table.lookTypes;r=this._calculateTableLook(e.headerRow,r,_e.ApplyFirstRow),r=this._calculateTableLook(e.totalRow,r,_e.ApplyLastRow),r=this._calculateTableLook(!e.bandedRows,r,_e.DoNotApplyRowBanding),r=this._calculateTableLook(e.firstColumn,r,_e.ApplyFirstColumn),r=this._calculateTableLook(e.lastColumn,r,_e.ApplyLastColumn),r=this._calculateTableLook(!e.bandedColumns,r,_e.DoNotApplyColumnBanding),this._processor.beginUpdate(),this._history.addTransaction((()=>{const e=new Zm(this._modelManipulator,this._subDocument,this._table.index,r);this._history.addAndRedo(e),ac.updateTable(this._processor.modelManager,this._table,this._subDocument)})),this._processor.endUpdate()}_calculateTableLook(e,t,r){return e?t|r:t&~r}get backgroundColor(){const e=this._table.getActualShadingInfo(this._table.properties);return this._getBackgroundColor(e)}set backgroundColor(e){const t=this._validateColor(e,1,"backgroundColor"),r=fe.createByColor(t),i=new ef(this._modelManipulator,this._subDocument,this._table.index,r,!0);this._history.addAndRedo(i)}get contentHorizontalAlignment(){const e=this._getStartHorizontalAlignment(this._table.getFirstCell());return this._table.rows.every((t=>t.cells.every((t=>this._subDocument.getParagraphsByInterval(t.interval).every((t=>t.getParagraphMergedProperties().alignment===e))))))?Number(e):null}set contentHorizontalAlignment(e){this._validateContentHorizontalAlignment(e),this._processor.beginUpdate(),this._history.addTransaction((()=>{this._table.rows.forEach((t=>{t.cells.forEach((t=>this._setCellHorizontalAlignment(t,e)))}))})),this._processor.endUpdate()}get contentVerticalAlignment(){const e=this._table.getFirstCell().properties.verticalAlignment;return this._table.rows.every((t=>t.cells.every((t=>t.properties.verticalAlignment===e))))?Number(e):null}set contentVerticalAlignment(e){this._validateContentVerticalAlignment(e),this._processor.beginUpdate(),this._history.addTransaction((()=>{this._table.rows.forEach(((t,r)=>{t.cells.forEach(((t,i)=>{const n=new Qa(this._table,r,i).init();return this._setCellVerticalAlignment(n,e)}))}))})),this._processor.endUpdate()}get borders(){const e=this._table.getActualBorders(this._table.properties);return this._getBordersApi(kD,e)}set borders(e){const t=this._validateBorders(gr,e),r=[t.top,t.right,t.bottom,t.left,t.insideHorizontal,t.insideVertical],i=r.map((e=>!!e||void 0)),n=new Ym(this._modelManipulator,this._subDocument,this._table.index,r,i);this._history.addAndRedo(n)}get cellMargins(){const e=this._table.getActualMargins(this._table.properties).clone();return this._getMarginsApi(e)}set cellMargins(e){const t=this._validateMargins(e,"cellMargins"),r=[t.top,t.right,t.bottom,t.left],i=r.map((e=>!!e||void 0)),n=new Km(this._modelManipulator,this._subDocument,this._table.index,r,i);this._history.addAndRedo(n)}mergeCells(e,t){this._validatePosition(e,"startPosition",1),this._validatePosition(t,"endPosition",2);const r=this._table.rows[e.rowIndex].getCellColumnIndex(e.cellIndex),i=this._table.rows[e.rowIndex].getCellColumnIndex(e.cellIndex+1)-1,n=this._table.rows[t.rowIndex].getCellColumnIndex(t.cellIndex),o=this._table.rows[t.rowIndex].getCellColumnIndex(t.cellIndex+1)-1,a=Math.min(e.rowIndex,t.rowIndex),s=Math.max(e.rowIndex,t.rowIndex),l=Math.min(r,n),d=Math.max(i,o),c=[];for(let e=a;e<=s;e++){const t=this._table.rows[e].getCellIndex(l),r=this._table.rows[e].getCellIndex(d),i=this._table.rows[e].cells[t].interval.start,n=this._table.rows[e].cells[r].interval.end;c.push(on.FixedInterval.fromPositions(i,n))}const h=new tp(this._subDocument,c).tableInfo;if(!h.extendedData.isSquare)throw new Error("You can only merge adjacent cells that form a rectangular or square shape.");const u=new tp(this._subDocument,c),p=(new ju).setIntervals(u);this._processor.beginUpdate(),this._history.addTransaction((()=>{this._modelManipulator.table.mergeSelectedTableCellsHorizontally(this._subDocument,h,p),this._modelManipulator.table.mergeSelectedTableCellsVertically(this._subDocument,h,p),this._modelManipulator.table.normalizeRows(this._subDocument,this._table),this._modelManipulator.table.normalizeTableGrid(this._subDocument,this._table),this._modelManipulator.table.normalizeCellColumnSpans(this._subDocument,this._table,!1),ac.updateTable(this._processor.modelManager,this._table,this._subDocument)})),this._processor.endUpdate()}_validatePosition(e,t,r){const i=mm.objectDescriptor(t,"PositionCell",(e=>e));mm.check(e,r,!1,[i]);const n=this._table.rows.length,o=mm.numberDescriptor(`${t}.rowIndex`,(e=>e),0,n);mm.check(e.rowIndex,r,!1,[o]);const a=this._table.rows[e.rowIndex].cells.length,s=mm.numberDescriptor(`${t}.cellIndex`,(e=>e),0,a);mm.check(e.cellIndex,r,!1,[s])}}class JD extends zD{constructor(e,t){super(e,t)}create(e,t,r){e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e),0,this._subDocument.getDocumentEndPosition())]),t=mm.check(t,2,!1,[mm.numberDescriptor("columnCount",(e=>e),1,63)]),r=mm.check(r,3,!1,[mm.numberDescriptor("rowCount",(e=>e),1)]);const i=Kp.ensure(this._processor.layoutFormatterManager,this._subDocument,e),n=Ja.getTableByPosition(this._subDocument.tables,e,!0)?i.row.tableCellInfo.avaliableContentWidth:SD.findSectionColumnWithMinimumWidth(i.pageArea.columns),o=(new ju).setIntervals(tp.fromPosition(this._subDocument,e));this._processor.beginUpdate();const a=this._insertTable(r,t,e,n,o);return this._processor.endUpdate(),new $D(this._processor,this._subDocument,a)}find(e){const t=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>new on.FixedInterval(e,0))),Sm.intervalDescriptor("interval",(e=>new on.FixedInterval(e.start,e.length)))]),r=this._subDocument.tables;if(0==r.length)return[];let i=r[Math.max(0,C.SearchUtils.normedInterpolationIndexOf(r,(e=>e.getStartPosition()),t.start))].getTopLevelParent().index;const n=[];for(let e;e=r[i];i++){const r=e.interval,i=nn.IntervalAlgorithms.getIntersection(r,t);if(i&&(i.length||r.contains(i.start)))n.push(new $D(this._processor,this._subDocument,e));else if(!e.nestedLevel&&e.getStartPosition()>=t.end)break}return n}_getItem(e){return new $D(this._processor,this._subDocument,e)}_getCoreItems(){return this._subDocument.tables}}function YD(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;class QD{static getDir(e){const t=e.lastIndexOf("/");return-1==t?"":e.substring(0,t)}static getFileName(e){const t=e.lastIndexOf("/");return-1==t?e:e.substr(t+1)}static getFileExtension(e){const t=e.lastIndexOf(".");return e.substr(t+1)}static normalize(e){return rn.StringUtils.startsAt(e,"/")?e.substr(1):e}}var ZD,eF,tF,rF,iF,nF=JSZip,oF=__webpack_require__.n(nF);!function(e){e[e.DrawingMLPicture=0]="DrawingMLPicture",e[e.WordProcessing=1]="WordProcessing",e[e.Wps=2]="Wps",e[e.MC=3]="MC",e[e.W10ML=4]="W10ML",e[e.DrawingML=5]="DrawingML",e[e.Rels=6]="Rels",e[e.VML=7]="VML",e[e.WordProcessingDrawing=8]="WordProcessingDrawing",e[e.WordProcessingDrawing14=9]="WordProcessingDrawing14",e[e.Wpg=10]="Wpg",e[e.Wpc=11]="Wpc",e[e.CP=12]="CP",e[e.DC=13]="DC",e[e.DcTerms=14]="DcTerms",e[e.DcmiType=15]="DcmiType",e[e.VT=16]="VT",e[e.Xsi=17]="Xsi",e[e.Wp14=18]="Wp14",e[e.w14=19]="w14",e[e.w15=20]="w15",e[e.ContentTypes=21]="ContentTypes",e[e.Office=22]="Office",e[e.Xml=23]="Xml"}(ZD||(ZD={}));class aF{constructor(e,t){this.prefix=e,this.namespace=t}}class sF{get wordProcessingNamespaceConst(){return this.namespaces[ZD.WordProcessing].namespace}get relsNamespaceConst(){return this.namespaces[ZD.Rels].namespace}get officeNamespace(){return this.namespaces[ZD.Office].namespace}get w14NamespaceConst(){return this.namespaces[ZD.w14].namespace}get w15NamespaceConst(){return this.namespaces[ZD.w15].namespace}get drawingMLNamespaceConst(){return this.namespaces[ZD.DrawingML].namespace}constructor(){this.namespaces=(new Eu).add(ZD.DrawingMLPicture,new aF(sF.drawingMLPicturePrefix,sF.drawingMLPictureNamespace)).add(ZD.WordProcessing,new aF(sF.wordProcessingPrefix,sF.wordProcessingNamespaceConst)).add(ZD.Wps,new aF(sF.wpsPrefix,sF.wpsNamespace)).add(ZD.MC,new aF(sF.mcPrefix,sF.mcNamespace)).add(ZD.W10ML,new aF(sF.w10MLPrefix,sF.w10MLNamespace)).add(ZD.DrawingML,new aF(sF.drawingMLPrefix,sF.drawingMLNamespace)).add(ZD.Rels,new aF(sF.relsPrefix,sF.relationsNamespaceConst)).add(ZD.VML,new aF(sF.vmlPrefix,sF.vmlNamespace)).add(ZD.WordProcessingDrawing,new aF(sF.wordProcessingDrawingPrefix,sF.wordProcessingDrawingNamespaceConst)).add(ZD.WordProcessingDrawing14,new aF(sF.wordProcessingDrawingPrefix14,sF.wordProcessingDrawing14Namespace)).add(ZD.Wpg,new aF(sF.wpgPrefix,sF.wpgNamespace)).add(ZD.Wpc,new aF(sF.wpcPrefix,sF.wpcNamespace)).add(ZD.CP,new aF(sF.cpPrefix,sF.cpNamespace)).add(ZD.DC,new aF(sF.dcPrefix,sF.dcNamespace)).add(ZD.DcTerms,new aF(sF.dcTermsPrefix,sF.dcTermsNamespace)).add(ZD.DcmiType,new aF(sF.dcmiTypePrefix,sF.dcmiTypeNamespace)).add(ZD.VT,new aF(sF.vtPrefix,sF.vtNamespace)).add(ZD.Xsi,new aF(sF.xsiPrefix,sF.xsiNamespace)).add(ZD.Wp14,new aF(sF.wp14Prefix,sF.wp14Namespace)).add(ZD.w14,new aF(sF.w14Prefix,sF.w14NamespaceConst)).add(ZD.w15,new aF(sF.w15Prefix,sF.w15NamespaceConst)).add(ZD.ContentTypes,new aF(sF.contentTypesPrefix,sF.contentTypesNamespace)).add(ZD.Office,new aF(sF.officeNamespacePrefix,sF.officeNamespace)).add(ZD.Xml,new aF(sF.xmlPrefix,sF.xmlNamespace)).get(),this.strictMode=!1,this.rels=new lF(sF.openXMLOfficeDocumentPrefix),this.fillMaps()}getNamespace(e){return this.namespaces[e].namespace}setStrictOpenXml(){this.strictMode=!0,b.j.forEach(this.namespaces,(e=>e.namespace=this.translateToStrict(e.namespace))),this.namespaces[ZD.WordProcessing].namespace="http://purl.oclc.org/ooxml/wordprocessingml/main",this.namespaces[ZD.WordProcessingDrawing].namespace="http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing",this.namespaces[ZD.Rels].namespace="http://purl.oclc.org/ooxml/officeDocument/relationships",this.rels=new lF(sF.strictOpenXMLOfficeDocumentPrefix),this.fillMaps()}translateToStrict(e){return e.replace(sF.openXMLOfficeDocumentPrefix,sF.strictOpenXMLOfficeDocumentPrefix)}lookupNamespaceByPrefix(e){const t=this.mapPrefixToNamespace[e];return t||null}fillMaps(){this.mapNamespaceToPrefix={},this.mapPrefixToNamespace={},b.j.forEach(this.namespaces,(e=>{this.mapNamespaceToPrefix[e.namespace]=e.prefix,this.mapPrefixToNamespace[e.prefix]=e.namespace}))}}sF.wordNamespace="http://schemas.microsoft.com/office/word",sF.openXMLOfficeDocumentPrefix="http://schemas.openxmlformats.org/officeDocument/2006",sF.strictOpenXMLOfficeDocumentPrefix="http://purl.oclc.org/ooxml/officeDocument",sF.drawingMLPicturePrefix="pic",sF.drawingMLPictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture",sF.wordProcessingPrefix="w",sF.wordProcessingNamespaceConst="http://schemas.openxmlformats.org/wordprocessingml/2006/main",sF.wpsPrefix="wps",sF.wpsNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape",sF.mcPrefix="mc",sF.mcNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006",sF.w10MLPrefix="w10",sF.w10MLNamespace="urn:schemas-microsoft-com:office:word",sF.drawingMLPrefix="a",sF.drawingMLNamespace="http://schemas.openxmlformats.org/drawingml/2006/main",sF.relsPrefix="r",sF.relationsNamespaceConst=sF.openXMLOfficeDocumentPrefix+"/relationships",sF.vmlPrefix="v",sF.vmlNamespace="urn:schemas-microsoft-com:vml",sF.wordProcessingDrawingPrefix="wp",sF.wordProcessingDrawingNamespaceConst="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",sF.wordProcessingDrawingPrefix14="wp14",sF.wordProcessingDrawing14Namespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",sF.wpgPrefix="wpg",sF.wpgNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",sF.wpcPrefix="wpc",sF.wpcNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",sF.cpPrefix="cp",sF.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",sF.dcPrefix="dc",sF.dcNamespace="http://purl.org/dc/elements/1.1/",sF.dcTermsPrefix="dcterms",sF.dcTermsNamespace="http://purl.org/dc/terms/",sF.dcmiTypePrefix="dcmitype",sF.dcmiTypeNamespace="http://purl.org/dc/dcmitype/",sF.vtPrefix="vt",sF.vtNamespace=sF.openXMLOfficeDocumentPrefix+"/docPropsVTypes",sF.xsiPrefix="xsi",sF.xsiNamespace="http://www.w3.org/2001/XMLSchema-instance",sF.wp14Prefix="wp14",sF.wp14Namespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",sF.w14Prefix="w14",sF.w14NamespaceConst="http://schemas.microsoft.com/office/word/2010/wordml",sF.w15Prefix="w15",sF.w15NamespaceConst="http://schemas.microsoft.com/office/word/2012/wordml",sF.contentTypesPrefix="",sF.contentTypesNamespace="http://schemas.openxmlformats.org/package/2006/content-types",sF.officeNamespacePrefix="",sF.officeNamespace="urn:schemas-microsoft-com:office:office",sF.xmlPrefix="xml",sF.xmlNamespace="http://www.w3.org/XML/1998/namespace";class lF{constructor(e){const t=e+"/relationships/";this.customPropertiesNamespace=t+"custom-properties",this.officeDocumentType=t+"officeDocument",this.officeStylesType=t+"styles",this.officeWebSettingsType=t+"webSettings",this.officeNumberingType=t+"numbering",this.officeDocumentSettings=t+"settings",this.officeHyperlinkType=t+"hyperlink",this.officeFootNoteType=t+"footnotes",this.officeEndNoteType=t+"endnotes",this.officeCommentType=t+"comments",this.officeThemesType=t+"theme",this.relsImage=t+"image",this.relsHeader=t+"header",this.relsFooter=t+"footer",this.relsFootNote=t+"footnotes",this.relsEndNote=t+"endnotes",this.relsComment=t+"comments",this.propertiesNamespace=e+"/custom-properties",this.relsCommentsExtended="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",this.officeCommentsExtendedType="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",this.packageRelsNamespace="http://schemas.openxmlformats.org/package/2006/relationships",this.corePropertiesNamespace="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"}}class dF{}dF.xml="application/xml",dF.relations="application/vnd.openxmlformats-package.relationships+xml",dF.theme="application/vnd.openxmlformats-officedocument.theme+xml",dF.header="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",dF.footer="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",dF.coreProperties="application/vnd.openxmlformats-package.core-properties+xml",dF.customProperties="application/vnd.openxmlformats-officedocument.custom-properties+xml",dF.document="application/vnd.openxmlformats-officedocument.wordprocessingml.document",dF.mainDocument="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",dF.numbering="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",dF.styles="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml",dF.settings="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",dF.footnotes="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",dF.endnotes="application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml",function(e){e[e.Ok=0]="Ok",e[e.Error=1]="Error",e[e.EndOfFile=2]="EndOfFile"}(eF||(eF={})),function(e){e[e.None=0]="None",e[e.Element=1]="Element",e[e.EndElement=2]="EndElement",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.SignificantWhitespace=5]="SignificantWhitespace",e[e.Whitespace=6]="Whitespace",e[e.Comment=7]="Comment"}(tF||(tF={})),function(e){e[e.ElementStart=0]="ElementStart",e[e.ChildElements=1]="ChildElements",e[e.ElementEnd=2]="ElementEnd",e[e.ToNextNode=3]="ToNextNode"}(rF||(rF={}));class cF{get localName(){return this.node.localName}get name(){return this.node.nodeName}get namespaceURI(){return this.node.namespaceURI}constructor(e,t){this.elementStage=rF.ElementStart,this.node=e,this.nodeType=t}}class hF{get elementInfo(){return this.elementStack.last}get nodeType(){return this.elementInfo.nodeType}get localName(){return this.elementInfo.localName}get name(){return this.elementInfo.name}get namespaceURI(){return this.elementInfo.namespaceURI}get attributes(){return this.elementInfo.node.attributes}get value(){return this.elementInfo.node.nodeValue}constructor(e,t,r){e=rn.StringUtils.trimStart(e),this.filePath=r,this.document=(new DOMParser).parseFromString(e,dF.xml),this.state=eF.Ok,this.elementStack=new Rw.K,this.elementStack.push(new cF(this.document.firstChild,tF.None)),this.handleNewNode(this.document.firstChild),this.options=t}getAttribute(e){return this.elementInfo.node.getAttribute(e)}getAttributeNS(e,t){return this.elementInfo.node.getAttributeNS(t,e)}skipElement(){this.elementInfo.elementStage=rF.ToNextNode}readToFollowingNS(e,t){do{if(this.nodeType==tF.Element&&this.localName==e&&this.namespaceURI==t)return!0}while(this.read());return!1}readToFollowing(e){do{if(this.nodeType==tF.Element&&this.localName==e&&this.handleNewNode(this.elementInfo.node))return!0}while(this.read());return!1}read(){const e=this.elementInfo;if(!e)return!1;switch(e.elementStage){case rF.ElementStart:switch(e.elementStage++,e.node.nodeType){case Node.COMMENT_NODE:if(e.nodeType=tF.Comment,this.options.ignoreComments)return this.elementInfo.elementStage=rF.ToNextNode,this.read();this.elementInfo.elementStage=rF.ToNextNode;break;case Node.TEXT_NODE:e.nodeType=tF.Text,e.elementStage=rF.ToNextNode;break;default:e.nodeType=tF.Element}"#cdata-section"==e.node.nodeName&&(e.nodeType=tF.CDATA,this.elementInfo.elementStage=rF.ToNextNode);break;case rF.ChildElements:{e.elementStage++;const t=this.elementInfo.node.firstChild;if(t){if(!this.handleNewNode(t))return!1;this.elementStack.push(new cF(t,tF.None))}return this.read()}case rF.ElementEnd:e.elementStage++,e.nodeType=tF.EndElement;break;case rF.ToNextNode:{const t=e.node.nextSibling;if(t){if(this.elementStack.pop(),!this.handleNewNode(t))return!1;this.elementStack.push(new cF(t,tF.None))}else if(this.elementStack.pop(),!this.elementStack.count)return this.state=eF.EndOfFile,!1;return this.read()}}return!0}handleNewNode(e){return"parsererror"!=e.nodeName||(this.state=eF.Error,!1)}}const uF=null!==(iF=oF())&&void 0!==iF?iF:nF;class pF{constructor(e){this.options=e,this.entryMap={}}init(e){return YD(this,void 0,void 0,(function*(){const t=this;try{(yield uF.loadAsync(e,{})).forEach(((e,r)=>{t.entryMap[e]=r}))}catch(e){console.log(`Cannot open file: ${e}`)}}))}getXmlReader(e){return YD(this,void 0,void 0,(function*(){const t=this.entryMap[e];if(!t)return null;try{return new hF(yield t.async("text"),this.options,e)}catch(e){return null}}))}getBase64(e){return YD(this,void 0,void 0,(function*(){const t=this.entryMap[e];if(!t)return null;try{return yield t.async("base64")}catch(e){return console.log(`Cannot get base46: ${e}`),null}}))}}var gF,mF,fF,bF,CF,SF,IF,PF,wF,yF,xF,TF,vF,MF,EF,DF,FF,RF,LF,BF;!function(e){e[e.Unknown=0]="Unknown",e[e.Allowed=1]="Allowed",e[e.Forbidden=2]="Forbidden"}(gF||(gF={}));class AF{constructor(e=null){this.progressLimit=30,this.progressRange=1,this.progressService=e}begin(e,t,r,i){this.displayName=e,this.minProgress=t,this.progressRange=Math.max(1,r-t),this.normalizedProgress=this.calculateProgress(i),this.indicationTime=new Date,this.indicationState=gF.Unknown}setProgress(e){const t=this.calculateProgress(e);if(this.indicationState==gF.Unknown){const e=new Date;e.valueOf()-this.indicationTime.valueOf()>=AF.progressShowDelay.valueOf()&&(t<=this.progressLimit?(this.indicationState=gF.Allowed,this.normalizedProgress=t,this.beginIndicationCore(),this.indicateProgressCore(),this.indicationTime=e):this.indicationState=gF.Forbidden)}if(t!=this.normalizedProgress&&(this.normalizedProgress=t,this.indicationState==gF.Allowed)){const e=new Date;(e.valueOf()-this.indicationTime.valueOf()>=AF.minIndicationInterval.valueOf()||100==this.normalizedProgress)&&(this.indicateProgressCore(),this.indicationTime=e)}}end(){this.progressService&&this.progressService.end()}calculateProgress(e){return 100*(e-this.minProgress)/this.progressRange}beginIndicationCore(){this.progressService&&this.progressService.begin(this.displayName,0,100,this.normalizedProgress)}indicateProgressCore(){this.progressService&&this.progressService.setProgress(this.normalizedProgress)}}AF.progressShowDelay=new Date(0,0,0,0,0,0,500),AF.minIndicationInterval=new Date(0,0,0,0,0,0,50);class NF{constructor(e){this.data=e,this.altChunkInfos=[]}insertAltChunks(){f.ListUtils.reverseForEach(this.altChunkInfos,(e=>this.insertAltChunk(e))),this.altChunkInfos=[]}insertAltChunk(e){}}class kF{constructor(e){this.data=e}import(e){}}class OF{constructor(e){this.data=e}}class _F{constructor(e){this.notes={},this.separatorIds=[],this.data=e}}class UF extends _F{insertRun(e){const t=this.data.subDocumentInfo.positionImporter.currPosition,r=new Hl(t,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle,e);this.data.subDocumentInfo.characterImporter.addRun(r,an.specialCharacters.LayoutDependentText)}}class HF extends _F{insertRun(e){const t=this.data.subDocumentInfo.positionImporter.currPosition,r=new Ul(t,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle,e);this.data.subDocumentInfo.characterImporter.addRun(r,an.specialCharacters.LayoutDependentText)}}class VF{constructor(e){this.data=e}}class WF{constructor(e){this.data=e}import(){}importNumberingCore(e){}}class zF{constructor(e){this.data=e,this.createSection()}insertSection(){this.data.subDocumentInfo.paragraphImporter.insertParagraph(!0),this.finishSection(),this.createSection()}finishSection(){this.section.setLength(this.data.subDocument,this.data.subDocumentInfo.positionImporter.currPosition-this.section.startLogPosition.value)}createSection(){this.properties=this.getDefaultSectionProperties(),this.section=new Ch(this.data.documentModel,this.data.subDocument.positionManager.registerPosition(this.data.subDocumentInfo.positionImporter.currPosition),0,this.properties);const e=this.data.documentModel.sections.length;if(e>0){const t=this.data.documentModel.sections[e-1];this.section.headers.copyFrom(t.headers),this.section.footers.copyFrom(t.footers)}this.data.documentModel.sections.push(this.section)}getDefaultSectionProperties(){return new yh}}class jF{constructor(e){this.data=e}import(){}importSettingsCore(e){}}class XF{constructor(){this.id="",this.name="",this.parentId="",this.linkedId="",this.semiHidden=!1,this.hidden=!1,this.nextId="",this.isDefault=!1,this.qFormat=!1,this.numberingId=-1}}class GF{constructor(e){this.isDefaultProcessed=!1,this.info={},this.registered={},this.data=e,this.defaultStyle=this.getDefault()}startImport(){this.currInfo=new XF}endImport(e){return rn.StringUtils.isNullOrEmpty(this.currInfo.id)?null:(this.info[this.currInfo.id]=this.currInfo,this.registered[this.currInfo.name]=!0,this.currInfo.style=this.addStyle(e))}getNumberingListIndex(e){if(!e)return-1;const t=this.data.stylesImporter.listInfos[e];return t?t.listIndex:-1}addInfo(e,t){this.info[e.id]=e,this.registered[t]=!0}getStyleById(e){const t=this.getStyleInfoCore(e);return t?t.style:null}getInfoById(e){const t=this.getStyleInfoCore(e);return t||null}isRegistered(e){return!!this.registered[e]}determineParents(){B.StringMapUtils.forEach(this.info,(e=>e.style.parent=this.getStyleById(e.parentId)))}foreachInfo(e){B.StringMapUtils.forEach(this.info,(t=>e(t)))}addStyle(e){var t;if(this.currInfo.isDefault&&!this.isDefaultProcessed)return this.isDefaultProcessed=!0,(null===(t=this.defaultStyle)||void 0===t?void 0:t.styleName)===this.currInfo.name?this.applyProperties(e,this.defaultStyle):this.defaultStyle=this.addToModel(this.applyProperties(e,this.createEmpty())),this.defaultStyle;{const t=this.getPresetStyleByName(this.currInfo.name);t&&(this.currInfo.name=t.styleName);let r=this.getFromModelByName(this.currInfo.name);return r&&r.id&&r.id!=this.currInfo.id&&(this.currInfo.name=this.currInfo.id,r=this.getFromModelByName(this.currInfo.name)),r?this.applyProperties(e,r):this.addToModel(this.applyProperties(e,this.createEmpty()))}}applyPropertiesBase(e){e.styleName=this.currInfo.name,e.semihidden=this.currInfo.semiHidden,e.hidden=this.currInfo.hidden,e.primary=this.currInfo.qFormat,e.id=this.currInfo.id}getStyleInfoCore(e){return rn.StringUtils.isNullOrEmpty(e)?null:this.info[e]}}class KF extends GF{getDefault(){return this.data.documentModel.getDefaultParagraphStyle()}getFromModelByName(e){return this.data.documentModel.stylesManager.getParagraphStyleByName(e)}createEmpty(){return new es("","",!1,!1,!1,!1,null,null,null,!1,-1,-1,"")}addToModel(e){return this.data.documentModel.stylesManager.addParagraphStyle(e)}applyProperties(e,t){return this.applyPropertiesBase(t),t.localizedName=Wh.getPresetParagraphStyleLocalizedName(t.styleName),t.numberingListIndex=this.getNumberingListIndex(e.numberingId),t.listLevelIndex=e.listLevelIndex,t.maskedCharacterProperties=e.characterFormatting.clone(),t.maskedParagraphProperties=e.paragraphFormatting.clone(),t.tabs=e.tabs,this.currInfo.numberingId==cn.NoNumberingListIndex&&(t.numberingListIndex=cn.NoNumberingListIndex),t}getPresetStyleByName(e){return Wh.getPresetParagraphStyleByName(e,!0)}}class qF extends GF{getDefault(){return this.data.documentModel.getDefaultCharacterStyle()}getFromModelByName(e){return this.data.documentModel.stylesManager.getCharacterStyleByName(e)}createEmpty(){return new zl("","",!1,!1,!1,!1,null,"")}addToModel(e){return this.data.documentModel.stylesManager.addCharacterStyle(e)}applyProperties(e,t){return this.applyPropertiesBase(t),t.maskedCharacterProperties=e.characterFormatting.clone(),t.localizedName=Wh.getPresetCharacterStyleLocalizedName(t.styleName),t}getPresetStyleByName(e){return Wh.getPresetCharacterStyleByName(e,!0)}}class $F extends GF{constructor(){super(...arguments),this.conditionalTableFormattingInfoList=[]}getDefault(){return this.data.documentModel.getDefaultTableStyle()}getFromModelByName(e){return this.data.documentModel.stylesManager.getTableStyleByName(e)}createEmpty(){return new Vh("","",!1,!1,!1,!1,{},new Xl(null,null,null,null,null,null),"")}addToModel(e){return this.data.documentModel.stylesManager.addTableStyle(e)}applyProperties(e,t){this.applyPropertiesBase(t),t.localizedName=Wh.getPresetTableStyleLocalizedName(t.styleName);const r=t.styleName==Vh.DEFAULT_STYLENAME;(r&&(e.tableProperties.getUseValue(ur.UseLeftMargin)||e.tableProperties.getUseValue(ur.UseRightMargin)||e.tableProperties.getUseValue(ur.UseBottomMargin)||e.tableProperties.getUseValue(ur.UseTopMargin))||!r)&&(t.baseConditionalStyle.tableProperties=e.tableProperties.clone()),t.baseConditionalStyle.tableRowProperties=e.tableRowProperties.clone(),t.baseConditionalStyle.tableCellProperties=e.tableCellProperties.clone(),t.baseConditionalStyle.maskedCharacterProperties=e.characterFormatting.clone(),t.baseConditionalStyle.maskedParagraphProperties=e.paragraphFormatting.clone(),t.baseConditionalStyle.tabs=e.tabs.clone();for(const e of this.conditionalTableFormattingInfoList)t.conditionalStyles[e.conditionType]=new Xl(e.tableProperties.clone(),e.tableRowProperties.clone(),e.tableCellProperties.clone(),e.paragraphFormatting.clone(),e.characterFormatting.clone(),e.tabs.clone());return t}getPresetStyleByName(e){return Wh.getPresetTableStyleByName(e,!0)}}class JF extends GF{getDefault(){return this.data.documentModel.getDefaultTableCellStyle()}getFromModelByName(e){return this.data.documentModel.stylesManager.getTableCellStyleByName(e)}createEmpty(){return new Hh("","",!1,!1,!1,!1,null,null)}addToModel(e){return this.data.documentModel.stylesManager.addTableCellStyle(e)}applyProperties(e,t){return this.applyPropertiesBase(t),t.tableCellProperties=e.tableCellProperties.clone(),t.characterProperties=e.characterFormatting.clone(),t}getPresetStyleByName(e){return null}}class YF extends GF{getDefault(){return this.createEmpty()}getFromModelByName(e){return this.data.documentModel.stylesManager.getNumberingListStyleByName(e)}createEmpty(){return new vp("","",!1,!1,!1,!1,-1)}addToModel(e){const t=this.data.documentModel.numberingListStyles.push(e)-1;return this.data.documentModel.numberingListStyles[t]}removeFromModel(e){const t=this.data.documentModel.numberingListStyles.indexOf(e);t&&t>=0&&this.data.documentModel.numberingListStyles.splice(t,1)}applyProperties(e,t){return this.applyPropertiesBase(t),t.numberingListIndex=this.getNumberingListIndex(e.numberingId),t.isDefault=this.currInfo.isDefault,t}addStyle(e){const t=this.getFromModelByName(this.currInfo.name);return t||this.addToModel(this.applyProperties(e,this.createEmpty()))}getPresetStyleByName(e){return null}}class QF{constructor(e){this.data=e,this.paragraphManager=new KF(e),this.characterManager=new qF(e),this.tableManager=new $F(e),this.tableCellManager=new JF(e),this.numberingListManager=new YF(e),this.abstractListInfos={},this.listInfos={},this.deferredStyles=[],this.numberingStyleInfos={}}findNumberingListInfoById(e){return this.listInfos[e]}addListInfo(e){this.listInfos[e.id]=e}addAbstractListInfo(e){this.abstractListInfos[e.abstractNumberingListId]=e}addNumberingListStyleInfo(e){this.numberingStyleInfos[e.id]=e}presetDefaultStyles(){const e=this.data.documentModel.defaultCharacterProperties.clone();e.setUseValue(ie.UseAll,!1);const t=this.data.documentModel.defaultParagraphProperties.clone();t.setUseValue(Be.UseAll,!1);const r=new mr;r.setUseValue(ur.UseAll,!1);const i=new za;i.setUseValue(Ua.UseAll,!1);const n=new cr;n.setUseValue(Ye.UseAll,!1),this.data.documentModel.stylesManager.addCharacterStyle(new zl(zl.defaultParagraphCharacterStyleName,zl.defaultParagraphCharacterStyleName,!1,!1,!1,!0,e)),this.data.documentModel.stylesManager.addParagraphStyle(new es(es.normalStyleName,es.normalStyleName,!1,!1,!1,!0,e,t,new ts,!1,cn.NumberingListNotSettedIndex,0,"")),this.data.documentModel.stylesManager.addTableStyle(new Vh(Vh.DEFAULT_STYLENAME,Vh.DEFAULT_STYLENAME,!1,!1,!0,!0,{},new Xl(r,i,n,t,e,new ts),"")),this.data.documentModel.stylesManager.addTableCellStyle(new Hh(Hh.DEFAULT_STYLENAME,Hh.DEFAULT_STYLENAME,!1,!1,!1,!0,n,e))}determineParents(){this.characterManager.determineParents(),this.paragraphManager.determineParents(),this.tableManager.determineParents(),this.tableCellManager.determineParents(),this.numberingListManager.determineParents()}linkStyles(){this.characterManager.foreachInfo((e=>{const t=this.paragraphManager.getStyleById(e.linkedId);t&&(t.linkedStyle=e.style,e.style.linkedStyle=t)})),this.paragraphManager.foreachInfo((e=>e.style.nextParagraphStyle=this.paragraphManager.getStyleById(e.nextId)))}presetDefaultProperties(){if(!this.data.documentModel.defaultCharacterProperties){const e=new Pe;f.ListUtils.forEach(ir.ALL_FIELDS,(t=>t.setProp(e,t.defaultValue))),e.fontInfo=e.fontInfo.clone(),e.fontInfo.measurer=this.data.documentModel.cache.fontInfoCache.fontMeasurer,e.setAllUse(),this.data.documentModel.defaultCharacterProperties=e}if(!this.data.documentModel.defaultParagraphProperties){const e=new Lt;f.ListUtils.forEach(Ft.ALL_FIELDS,(t=>t.setProp(e,t.defaultValue))),e.useValue=Be.UseAll,this.data.documentModel.defaultParagraphProperties=e}if(!this.data.documentModel.defaultTableProperties){const e=new mr;e.setUseValue(ur.UseAll,!1),this.data.documentModel.defaultTableProperties=e}if(!this.data.documentModel.defaultTableRowProperties){const e=new za;e.setUseValue(Ua.UseAll,!1),this.data.documentModel.defaultTableRowProperties=e}if(!this.data.documentModel.defaultTableCellProperties){const e=new cr;e.setUseValue(Ye.UseAll,!1),this.data.documentModel.defaultTableCellProperties=e}}createNumberingLists(e){let t=1;b.j.forEach(this.listInfos,(r=>{const i=this.findAbstractListInfosById(r.abstractNumberingListId);if(null!=i){const n=new cn(e,i.abstractNumberingIndex);n.innerId=r.id;const o=r.levelOverrides.length;for(let e=0;e<o;e++){const t=r.levelOverrides[e];n.levels[t.levelIndex]=t.getOverrideListLevelCore(n.levels[t.levelIndex])}if(r.listIndex=e.numberingLists.length,e.numberingLists.push(n),-1==n.innerId){for(;f.ListUtils.elementBy(e.numberingLists,(e=>e.innerId==t));)t++;n.innerId=t++}n.deleted=!1}}))}findAbstractListInfosById(e){return this.abstractListInfos[e]}}class ZF{constructor(e){this.data=e}}class eR{constructor(e){this.data=e}import(){}importWebSettingsCore(e){}}class tR{constructor(e){this.data=e,this.bookmarks={}}insertBookmarks(){B.StringMapUtils.forEach(this.bookmarks,(e=>{e.validate(this.data.subDocument)&&this.data.subDocument.bookmarks.push(new Cd(this.data.subDocument.positionManager,new Cn.e(e.start,e.end),e.name))}))}}class rR{get style(){return this._style||this.resetStyle(),this._style}set style(e){this._style=e}get charPropsBundle(){return new pn(this.properties,this.style)}constructor(e){this.data=e,this.resetProperties(),this.data.subDocument.chunks[0]||(this.data.subDocument.chunks=[new mo(this.data.subDocument.positionManager.registerPosition(0),"",!0)])}resetProperties(){return this.properties=Pe.createDefault(this.data.documentModel),this}resetStyle(){return this._style=this.data.stylesImporter.characterManager.defaultStyle,this}resetNoteDocumentId(){return delete this.noteDocumentId,this}reset(){this.resetProperties().resetStyle().resetNoteDocumentId()}insertText(e){const t=e.length,r=new ch(this.data.subDocumentInfo.positionImporter.currPosition,t,this.data.subDocumentInfo.paragraphImporter.paragraph,this.charPropsBundle);r.noteDocumentId=this.noteDocumentId,this.addRun(r,e)}addRun(e,t){const r=f.ListUtils.last(this.data.subDocument.chunks);r.textRuns.push(e),r.textBuffer+=t,this.data.subDocumentInfo.positionImporter.currPosition+=e.getLength()}addRunAtPos(e,t,r){const i=C.SearchUtils.normedInterpolationIndexOf(this.data.subDocument.chunks,(e=>e.startLogPosition.value),r),n=this.data.subDocument.chunks[i],o=r-n.startLogPosition.value,a=C.SearchUtils.normedInterpolationIndexOf(n.textRuns,(e=>e.startOffset),o);n.textRuns[a].startOffset<o?this.addRun(e,t):(n.textRuns.splice(a,0,e),iP.moveRunsInChunk(n,a+1,t.length),n.textBuffer=[n.textBuffer.substr(0,o),t,n.textBuffer.substr(o)].join(""),this.data.subDocumentInfo.positionImporter.currPosition+=e.getLength())}deleteOneSimpleRun(e){}}class iR{get comments(){return this.data.subDocumentInfo.comments}constructor(e){this.data=e}}class nR{get fieldInfoStack(){return this.data.subDocumentInfo.fieldInfoStack}get lastField(){return this.fieldInfoStack.last}constructor(e){this.currIndex=0,this.data=e}applyToLastField(e){const t=this.lastField;t&&e(t)}finishImport(){}processFieldBegin(e){const t=this.data.subDocumentInfo.positionImporter.currPosition;e.startPos=t,this.data.subDocumentInfo.characterImporter.addRun(new Al(t,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle),an.specialCharacters.FieldCodeStartRun),this.fieldInfoStack.push(e)}processFieldSeparator(e){const t=this.data.subDocumentInfo.positionImporter.currPosition;e.codeEndPos=t,this.data.subDocumentInfo.characterImporter.addRun(new Nl(t,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle),an.specialCharacters.FieldCodeEndRun)}processFieldEnd(e){e.codeEndPos<=e.startPos&&this.processFieldSeparator(e);const t=this.data.subDocumentInfo.positionImporter.currPosition;return e.resultEndIndexPos=t+1,this.data.subDocumentInfo.characterImporter.addRun(new kl(t,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle),an.specialCharacters.FieldResultEndRun),this.finishField(e)}insertHyperlinkInstruction(e){this.fieldInfoStack.last.hyperlinkInfo=e}deleteInvalidFieldsInfo(){for(;this.fieldInfoStack.count>0;){const e=this.fieldInfoStack.pop();-1!=e.codeEndPos&&this.data.subDocumentInfo.characterImporter.deleteOneSimpleRun(e.codeEndPos),this.data.subDocumentInfo.characterImporter.deleteOneSimpleRun(e.startPos)}}finishField(e){const t=this.data.subDocument,r=new Md(t.positionManager,e.index,e.startPos,e.codeEndPos,e.resultEndIndexPos,!1,e.hyperlinkInfo);return f.ListUtils.forEach(e.nestedFields,(e=>e.parent=r)),r.disableUpdate=e.disableUpdate,r.hideByParent=e.hideByParent,r.locked=e.locked,t.fields[e.index]=r,this.fieldInfoStack.pop(),r}insertFullField(e,t,r){this.data.subDocumentInfo.fieldImporter.currIndex++;const i=this.data.subDocumentInfo.positionImporter.currPosition,n=new Al(i,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle);this.data.subDocumentInfo.characterImporter.addRun(n,an.specialCharacters.FieldCodeStartRun),e();const o=this.data.subDocumentInfo.positionImporter.currPosition,a=new Nl(o,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle);this.data.subDocumentInfo.characterImporter.addRun(a,an.specialCharacters.FieldCodeEndRun),t();const s=this.data.subDocumentInfo.positionImporter.currPosition,l=new kl(s,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle);this.data.subDocumentInfo.characterImporter.addRun(l,an.specialCharacters.FieldResultEndRun);const d=this.data.subDocument.fields,c=d.length,h=new Md(this.data.subDocument.positionManager,c,i,o,s+1,!1,r);Md.addField(d,h)}}class oR{constructor(e){this.paraId=Bo.Constants.MIN_SAFE_INTEGER,this.data=e,this.createParagraph()}resetProperties(){return this.properties=Lt.createDefault(this.data.documentModel),this}resetStyle(){return this.style=this.data.stylesImporter.paragraphManager.defaultStyle,this}resetTabs(){return this.tabs=new ts,this}resetParMarkCharacterStyle(){return this.parMarkCharacterStyle=this.data.documentModel.characterStyles[0],this}resetParMarkCharProperties(){return this.parMarkCharProperties=Pe.createDefault(this.data.documentModel),this}createParagraph(){this.resetProperties().resetStyle().resetTabs().resetParMarkCharProperties().resetParMarkCharacterStyle();const e=f.ListUtils.last(this.data.subDocument.paragraphs);return this.paragraph=new ns(this.data.subDocument,this.data.subDocument.positionManager.registerPosition(e?e.getEndPosition():0),0,null,null),this.paragraph}insertParagraph(e=!1){const t=this.paragraph;return this.data.subDocumentInfo.characterImporter.addRun(new(e?Ll:Bl)(this.data.subDocumentInfo.positionImporter.currPosition,t,new pn(this.parMarkCharProperties,this.parMarkCharacterStyle)),e?an.specialCharacters.SectionMark:an.specialCharacters.ParagraphMark),this.data.subDocument.paragraphs.push(t),t.length=this.data.subDocumentInfo.positionImporter.currPosition-t.startLogPosition.value,this.applyParagraphProperties(),this.createParagraph(),t}applyParagraphProperties(){this.paragraph.paragraphStyle=this.style,this.paragraph.maskedParagraphProperties=this.data.documentModel.cache.maskedParagraphPropertiesCache.getItem(this.properties.clone()),this.paragraph.tabs=this.tabs.clone()}}class aR{constructor(e){this.data=e,this.currPosition=0}}class sR{constructor(e){this.data=e,this.rangePermissions={}}insertRangePermissions(){b.j.forEach(this.rangePermissions,(e=>{if(e.validate(this.data.subDocument)){if(e.columnFirst<0&&e.columnLast<0)return void this.addPermission(e,e.start,e.end);for(let t=e.firstRowIndex;t<=e.lastRowIndex;t++)this.createDocumentPermissions(e,t)}})),this.data.subDocument.rangePermissions.sort(((e,t)=>e.start!=t.start?e.start-t.start:e.end-t.end))}createDocumentPermissions(e,t){const r=e.table.rows[t].cells,i=r.length;if(e.columnFirst<i){const t=r[e.columnFirst].startParagraphPosition.value,n=r[Math.min(e.columnLast,i-1)].endParagrapPosition.value;e.start<n&&e.end>t&&this.addPermission(e,Math.max(e.start,t),Math.min(e.end,n))}}addPermission(e,t,r){r>=t&&this.data.subDocument.rangePermissions.push(new Dd(this.data.subDocument.positionManager,new Cn.e(t,r+1),e.userName?e.userName:"",e.group?e.group:""))}}class lR{get isInsideTable(){return this.data.subDocumentInfo.tableStack.count>0}constructor(e){this.data=e}cancelTable(e){const t=this.data.subDocument.tables;t.splice(t.indexOf(e),1),this.data.subDocumentInfo.tableStack.pop()}createDefaultTableProperties(){return new mr}createDefaultRowProperties(){return new za}createDefaultCellProperties(){return new cr}}class dR{constructor(e,t,r={},i=null){this.data=e,this.subDocument=t,this.comments=r,this.activeComment=i,this.tableStack=new Rw.K,this.fieldInfoStack=new Rw.K,this.positionImporter=new aR(this.data),this.characterImporter=new rR(this.data),this.paragraphImporter=new oR(this.data),this.bookmarkImporter=new tR(this.data),this.commentsImporter=new iR(this.data),this.fieldImporter=new nR(this.data),this.rangePermissionImporter=new sR(this.data),this.tableImporter=new lR(this.data)}endImport(){this.rangePermissionImporter.insertRangePermissions(),this.fieldImporter.deleteInvalidFieldsInfo(),Ja.sort(this.subDocument.tables),Ja.fillTableByLevels(this.subDocument),this.bookmarkImporter.insertBookmarks(),this.subDocument.paragraphs.length||this.data.subDocumentInfo.paragraphImporter.insertParagraph()}}class cR{constructor(e){this.name=e}}class hR{constructor(e="",t){this.unit=e,this.isValidNumber=void 0!==t,this.isValidNumber&&(this.value=t)}get isEmpty(){return this.equals(hR.empty)}equals(e){return e&&e.isValidNumber==this.isValidNumber&&e.value==this.value&&e.unit==this.unit}}hR.empty=new hR;class uR{static parse(e){return rn.StringUtils.isNullOrEmpty(e)?hR.empty:uR.splitUnitFromValue(e)}static splitUnitFromValue(e){let t="",r=e;const i=e.search(uR.regex);-1!=i?(t=e.substring(0,i),r=e.substring(i)):(t=e,r="");const n=parseFloat(t);return isNaN(n)?new hR(r):new hR(r,n)}}uR.regex=/(?<=[0-9.])[^0-9.]/;class pR{static valueUnitToModelUnitsF(e){if(rn.StringUtils.isNullOrEmpty(e.unit))return e.value;switch(e.unit.toLowerCase()){case"km":return g.u.centimetersToTwips(1e5*e.value);case"m":return g.u.centimetersToTwips(100*e.value);case"cm":return g.u.centimetersToTwips(e.value);case"mm":return g.u.centimetersToTwips(e.value/10);case"in":case"inch":return g.u.inchesToTwips(e.value);case"ft":return g.u.inchesToTwips(12*e.value);case"pt":return g.u.pointsToTwips(e.value);case"pc":return g.u.picasToTwips(e.value);case"mi":case"%":return e.value/100}return e.value}static rotationUnitToModelUnits(e){if(rn.StringUtils.isNullOrEmpty(e.unit))return e.value;switch(e.unit.toLowerCase()){case"fd":return g.u.fdToTwips(e.value);case"":return g.u.degreesToTwips(e.value);default:throw new Error("Invalid rotation value")}}}class gR{static decode(e){return rn.StringUtils.isNullOrEmpty(e)?e:e.replace(gR.xmlCharDecodingRegex,((e,t)=>{const r=parseInt(t,10);return!isNaN(r)&&(r<=31||r>=65535)?String.fromCharCode(r):e}))}}gR.xmlCharDecodingRegex=new RegExp("_x([\\da-fA-F]{4})_");class mR{static createCultureInfo(e){const t=this.dictionary[e];return void 0===t?null:new cR(t)}}mR.dictionary=(new Eu).add(1,"ar").add(2,"bg").add(3,"ca").add(4,"zh-Hans").add(5,"cs").add(6,"da").add(7,"de").add(8,"el").add(9,"en").add(10,"es").add(11,"fi").add(12,"fr").add(13,"he").add(14,"hu").add(15,"is").add(16,"it").add(17,"ja").add(18,"ko").add(19,"nl").add(20,"no").add(21,"pl").add(22,"pt").add(23,"rm").add(24,"ro").add(25,"ru").add(26,"hr").add(27,"sk").add(28,"sq").add(29,"sv").add(30,"th").add(31,"tr").add(32,"ur").add(33,"id").add(34,"uk").add(35,"be").add(36,"sl").add(37,"et").add(38,"lv").add(39,"lt").add(40,"tg").add(41,"fa").add(42,"vi").add(43,"hy").add(44,"az").add(45,"eu").add(46,"hsb").add(47,"mk").add(50,"tn").add(52,"xh").add(53,"zu").add(54,"af").add(55,"ka").add(56,"fo").add(57,"hi").add(58,"mt").add(59,"se").add(60,"ga").add(62,"ms").add(63,"kk").add(64,"ky").add(65,"sw").add(66,"tk").add(67,"uz").add(68,"tt").add(69,"bn").add(70,"pa").add(71,"gu").add(72,"or").add(73,"ta").add(74,"te").add(75,"kn").add(76,"ml").add(77,"as").add(78,"mr").add(79,"sa").add(80,"mn").add(81,"bo").add(82,"cy").add(83,"km").add(84,"lo").add(86,"gl").add(87,"kok").add(89,"sd").add(90,"syr").add(91,"si").add(92,"chr").add(93,"iu").add(94,"am").add(95,"tzm").add(97,"ne").add(98,"fy").add(99,"ps").add(100,"fil").add(101,"dv").add(103,"ff").add(104,"ha").add(106,"yo").add(107,"quz").add(108,"nso").add(109,"ba").add(110,"lb").add(111,"kl").add(112,"ig").add(115,"ti").add(117,"haw").add(120,"ii").add(122,"arn").add(124,"moh").add(126,"br").add(127,"").add(128,"ug").add(129,"mi").add(130,"oc").add(131,"co").add(132,"gsw").add(133,"sah").add(134,"qut").add(135,"rw").add(136,"wo").add(140,"prs").add(145,"gd").add(146,"ku").add(1025,"ar-SA").add(1026,"bg-BG").add(1027,"ca-ES").add(1028,"zh-TW").add(1029,"cs-CZ").add(1030,"da-DK").add(1031,"de-DE").add(1032,"el-GR").add(1033,"en-US").add(1035,"fi-FI").add(1036,"fr-FR").add(1037,"he-IL").add(1038,"hu-HU").add(1039,"is-IS").add(1040,"it-IT").add(1041,"ja-JP").add(1042,"ko-KR").add(1043,"nl-NL").add(1044,"nb-NO").add(1045,"pl-PL").add(1046,"pt-BR").add(1047,"rm-CH").add(1048,"ro-RO").add(1049,"ru-RU").add(1050,"hr-HR").add(1051,"sk-SK").add(1052,"sq-AL").add(1053,"sv-SE").add(1054,"th-TH").add(1055,"tr-TR").add(1056,"ur-PK").add(1057,"id-ID").add(1058,"uk-UA").add(1059,"be-BY").add(1060,"sl-SI").add(1061,"et-EE").add(1062,"lv-LV").add(1063,"lt-LT").add(1064,"tg-Cyrl-TJ").add(1065,"fa-IR").add(1066,"vi-VN").add(1067,"hy-AM").add(1068,"az-Latn-AZ").add(1069,"eu-ES").add(1070,"hsb-DE").add(1071,"mk-MK").add(1074,"tn-ZA").add(1076,"xh-ZA").add(1077,"zu-ZA").add(1078,"af-ZA").add(1079,"ka-GE").add(1080,"fo-FO").add(1081,"hi-IN").add(1082,"mt-MT").add(1083,"se-NO").add(1086,"ms-MY").add(1087,"kk-KZ").add(1088,"ky-KG").add(1089,"sw-KE").add(1090,"tk-TM").add(1091,"uz-Latn-UZ").add(1092,"tt-RU").add(1093,"bn-IN").add(1094,"pa-IN").add(1095,"gu-IN").add(1096,"or-IN").add(1097,"ta-IN").add(1098,"te-IN").add(1099,"kn-IN").add(1100,"ml-IN").add(1101,"as-IN").add(1102,"mr-IN").add(1103,"sa-IN").add(1104,"mn-MN").add(1105,"bo-CN").add(1106,"cy-GB").add(1107,"km-KH").add(1108,"lo-LA").add(1110,"gl-ES").add(1111,"kok-IN").add(1114,"syr-SY").add(1115,"si-LK").add(1116,"chr-Cher-US").add(1117,"iu-Cans-CA").add(1118,"am-ET").add(1121,"ne-NP").add(1122,"fy-NL").add(1123,"ps-AF").add(1124,"fil-PH").add(1125,"dv-MV").add(1128,"ha-Latn-NG").add(1130,"yo-NG").add(1131,"quz-BO").add(1132,"nso-ZA").add(1133,"ba-RU").add(1134,"lb-LU").add(1135,"kl-GL").add(1136,"ig-NG").add(1139,"ti-ET").add(1141,"haw-US").add(1144,"ii-CN").add(1146,"arn-CL").add(1148,"moh-CA").add(1150,"br-FR").add(1152,"ug-CN").add(1153,"mi-NZ").add(1154,"oc-FR").add(1155,"co-FR").add(1156,"gsw-FR").add(1157,"sah-RU").add(1158,"qut-GT").add(1159,"rw-RW").add(1160,"wo-SN").add(1164,"prs-AF").add(1169,"gd-GB").add(1170,"ku-Arab-IQ").add(2049,"ar-IQ").add(2051,"ca-ES-valencia").add(2052,"zh-CN").add(2055,"de-CH").add(2057,"en-GB").add(2058,"es-MX").add(2060,"fr-BE").add(2064,"it-CH").add(2067,"nl-BE").add(2068,"nn-NO").add(2070,"pt-PT").add(2074,"sr-Latn-CS").add(2077,"sv-FI").add(2092,"az-Cyrl-AZ").add(2094,"dsb-DE").add(2098,"tn-BW").add(2107,"se-SE").add(2108,"ga-IE").add(2110,"ms-BN").add(2115,"uz-Cyrl-UZ").add(2117,"bn-BD").add(2118,"pa-Arab-PK").add(2121,"ta-LK").add(2128,"mn-Mong-CN").add(2137,"sd-Arab-PK").add(2141,"iu-Latn-CA").add(2143,"tzm-Latn-DZ").add(2151,"ff-Latn-SN").add(2155,"quz-EC").add(2163,"ti-ER").add(3073,"ar-EG").add(3076,"zh-HK").add(3079,"de-AT").add(3081,"en-AU").add(3082,"es-ES").add(3084,"fr-CA").add(3098,"sr-Cyrl-CS").add(3131,"se-FI").add(3179,"quz-PE").add(4097,"ar-LY").add(4100,"zh-SG").add(4103,"de-LU").add(4105,"en-CA").add(4106,"es-GT").add(4108,"fr-CH").add(4122,"hr-BA").add(4155,"smj-NO").add(4191,"tzm-Tfng-MA").add(5121,"ar-DZ").add(5124,"zh-MO").add(5127,"de-LI").add(5129,"en-NZ").add(5130,"es-CR").add(5132,"fr-LU").add(5146,"bs-Latn-BA").add(5179,"smj-SE").add(6145,"ar-MA").add(6153,"en-IE").add(6154,"es-PA").add(6156,"fr-MC").add(6170,"sr-Latn-BA").add(6203,"sma-NO").add(7169,"ar-TN").add(7177,"en-ZA").add(7178,"es-DO").add(7194,"sr-Cyrl-BA").add(7227,"sma-SE").add(8193,"ar-OM").add(8201,"en-JM").add(8202,"es-VE").add(8218,"bs-Cyrl-BA").add(8251,"sms-FI").add(9217,"ar-YE").add(9225,"en-029").add(9226,"es-CO").add(9242,"sr-Latn-RS").add(9275,"smn-FI").add(10241,"ar-SY").add(10249,"en-BZ").add(10250,"es-PE").add(10266,"sr-Cyrl-RS").add(11265,"ar-JO").add(11273,"en-TT").add(11274,"es-AR").add(11290,"sr-Latn-ME").add(12289,"ar-LB").add(12297,"en-ZW").add(12298,"es-EC").add(12314,"sr-Cyrl-ME").add(13313,"ar-KW").add(13321,"en-PH").add(13322,"es-CL").add(14337,"ar-AE").add(14346,"es-UY").add(15361,"ar-BH").add(15370,"es-PY").add(16385,"ar-QA").add(16393,"en-IN").add(16394,"es-BO").add(17417,"en-MY").add(17418,"es-SV").add(18441,"en-SG").add(18442,"es-HN").add(19466,"es-NI").add(20490,"es-PR").add(21514,"es-US").add(25626,"bs-Cyrl").add(26650,"bs-Latn").add(27674,"sr-Cyrl").add(28698,"sr-Latn").add(28731,"smn").add(29740,"az-Cyrl").add(29755,"sms").add(30724,"zh").add(30740,"nn").add(30746,"bs").add(30764,"az-Latn").add(30779,"sma").add(30787,"uz-Cyrl").add(30800,"mn-Cyrl").add(30813,"iu-Cans").add(30815,"tzm-Tfng").add(31748,"zh-Hant").add(31764,"nb").add(31770,"sr").add(31784,"tg-Cyrl").add(31790,"dsb").add(31803,"smj").add(31811,"uz-Latn").add(31814,"pa-Arab").add(31824,"mn-Mong").add(31833,"sd-Arab").add(31836,"chr-Cher").add(31837,"iu-Latn").add(31839,"tzm-Latn").add(31847,"ff-Latn").add(31848,"ha-Latn").add(31890,"ku-Arab").get();class fR{static parseColor(e){let t="";if("#"==e[0]){const r=e.indexOf("["),i=e.indexOf("]");switch(r>=0&&i>=0&&r<i&&(e=(e.slice(0,r)+e.slice(i+1)).trim()),t=e.substr(1),t.length){case 8:return fR.getColorByArgb(t);case 4:return fR.getColorByArgb(rn.StringUtils.repeat(t.charAt(0),2)+rn.StringUtils.repeat(t.charAt(1),2)+rn.StringUtils.repeat(t.charAt(2),2)+rn.StringUtils.repeat(t.charAt(3),2));case 6:return fR.getColorByRgb(t);case 3:return fR.getColorByRgb(rn.StringUtils.repeat(t.charAt(0),2)+rn.StringUtils.repeat(t.charAt(1),2)+rn.StringUtils.repeat(t.charAt(2),2));default:return fR.getColorByName(e)}}if(6==e.length&&!w.i.colorNames[e]){const t=fR.getColorByRgb(e);if(t!=U.empty)return t}if(rn.StringUtils.startsAt(e.toLowerCase(),"rgb(")){const t=fR.parseRGB(e.substr(4));if(t!=U.empty)return t}return fR.getColorByName(e)}static getColorByName(e){const t=U.fromName(e);return t===y.AUTOMATIC_COLOR?U.empty:t}static getColor(e,t){const r=e.substr(t,2),i=parseInt(r,16);return 0==i&&"00"!=r?-1:i}static getColorByRgb(e,t=255){const r=fR.getColor(e,0),i=fR.getColor(e,2),n=fR.getColor(e,4);return-1!=r&&-1!=i&&-1!=n?t<<24|r<<16|i<<8|n:U.empty}static getColorByArgb(e){const t=fR.getColor(e,0),r=fR.getColor(e,2),i=fR.getColor(e,4),n=fR.getColor(e,6);return-1!=t&&-1!=r&&-1!=i&&-1!=n?t<<24|r<<16|i<<8|n:U.empty}static parseRGB(e){let t="";const r=[];for(const i of e)if(","!=i&&")"!=i)an.isWhitespace.test(i)||(t+=i);else{const e=parseInt(t,10);isNaN(e)||r.push(e),t=""}return 3==r.length?255<<24|r[0]<<16|r[1]<<8|r[2]:U.empty}}class bR{constructor(e){this.data=e}searchInTable(e,t,r,i=!0){const n=t[e];if(void 0!==n)return n.modelValue;if(i){const i=B.StringMapUtils.elementBy(t,(t=>t.mlValue.openXmlValue==e||t.mlValue.wordMLValue==e));return null!==i?i.modelValue:r}return r}readAttribute(e,t){const r=e.getAttributeNS(t,this.data.constants.namespaces[ZD.WordProcessing].namespace);return rn.StringUtils.isNullOrEmpty(r)?e.getAttribute(t):r}readAttributeWithNs(e,t,r){return e.getAttributeNS(t,r)}isBool(e){return"t"==e}isBoolStrict(e){return"1"==e||"on"==e||"true"==e||"t"==e||("0"==e||"off"==e||"false"==e||"f"==e||this.data.options.throwInvalidFile("Not expected Bool value"),!1)}decodeXmlChars(e){return gR.decode(e)}getWpSTOnOffValue(e,t,r=!0){const i=this.readAttribute(e,t);return this.getOnOffValueBool(i,r)}getOnOffValue(e,t,r=!0){const i=e.getAttributeNS(t,null);return this.getOnOffValueBool(i,r)}getOnOffValueBool(e,t){return rn.StringUtils.isNullOrEmpty(e)?t:this.isBoolStrict(e)}getWpSTOnOffNullValue(e,t){return rn.StringUtils.isNullOrEmpty(e.getAttribute(t))?null:this.getWpSTOnOffValue(e,t)}getWpSTIntegerValue(e,t,r=Bo.Constants.MIN_SAFE_INTEGER,i=10){const n=this.readAttribute(e,t);return this.getIntegerValueCore(n,r,i)}getIntegerValueInPoints(e,t,r){const i=e.getAttribute(t);return rn.StringUtils.isNullOrEmpty(i)?Bo.Constants.MIN_SAFE_INTEGER:this.getIntegerValueCore(i.replace("pt",""),r)}getIntegerValue(e,t,r){const i=e.getAttribute(t);return this.getIntegerValueCore(i,r)}parseIntStrict(e,t){return/^(\-|\+)?([0-9]+|Infinity)$/.test(e)?parseInt(e,t):NaN}parseFloatStrict(e){return/^(\-|\+)?([0-9.,]+|Infinity)$/.test(e)?Number(e):NaN}getIntegerValueCore(e,t,r=10){if(rn.StringUtils.isNullOrEmpty(e))return t;const i=this.parseIntStrict(e,r);if(!isNaN(i))return i;const n=this.parseFloatStrict(e);if(!isNaN(n))return n;if(this.data.constants.strictMode){const t=uR.parse(e);return Math.round(pR.valueUnitToModelUnitsF(t))}if(this.data.options.allowIntPercentage&&rn.StringUtils.endsAt(e,"%")){e=e.substring(0,e.length-1);const t=parseInt(e,10);if(!isNaN(t))return 1e3*t}if(this.data.options.ignoreParseErrors)return t;const o=parseInt(e,r);if(!isNaN(o))return o;const a=parseFloat(e);return isNaN(a)?(this.data.options.throwInvalidFile("Not expected integer value"),null):a}getIntegerNullableValue(e,t){const r=this.readAttribute(e,t);return rn.StringUtils.isNullOrEmpty(r)?null:this.getIntegerValueCore(r,Bo.Constants.MIN_SAFE_INTEGER)}getFloatValueInPoints(e,t,r){const i=e.getAttribute(t);return rn.StringUtils.isNullOrEmpty(i)?Bo.Constants.MIN_SAFE_INTEGER:this.getFloatValue(i.replace("pt",""),r)}getFloatValue(e,t){if(rn.StringUtils.isNullOrEmpty(e))return t;const r=parseFloat(e);return isNaN(r)?Bo.Constants.MIN_SAFE_INTEGER:r}getWpEnumValue(e,t,r,i,n){const o=null==n?this.readAttribute(e,t):this.readAttributeWithNs(e,t,n);return rn.StringUtils.isNullOrEmpty(o)?i:this.getWpEnumValueCore(o,r,i)}getWpEnumValueCore(e,t,r){return this.searchInTable(e,t,r,!0)}getWpEnumOnOffNullValue(e,t,r){const i=this.readAttribute(e,t);return rn.StringUtils.isNullOrEmpty(i)?null:this.getWpEnumOnOffNullValueCore(i,r)}getWpSTColorOrNullValue(e,t){const r=e.getAttributeNS(t,this.data.constants.namespaces[ZD.WordProcessing].namespace);return rn.StringUtils.isNullOrEmpty(r)?null:this.parseColor(r,U.empty)}getWpSTColorValue(e,t,r=U.empty){const i=e.getAttributeNS(t,this.data.constants.namespaces[ZD.WordProcessing].namespace);return rn.StringUtils.isNullOrEmpty(i)?r:this.parseColor(i,r)}parseColor(e,t){if("auto"==e)return t;const r=fR.parseColor(e);return r==U.empty?t:r}convertToInt(e){return this.getIntegerValueCore(e,Bo.Constants.MIN_SAFE_INTEGER,16)}readLanguage(e){const t=this.createCultureInfoFromString(e.getAttributeNS("bidi",this.data.constants.wordProcessingNamespaceConst)),r=this.createCultureInfoFromString(e.getAttributeNS("eastAsia",this.data.constants.wordProcessingNamespaceConst)),i=this.createCultureInfoFromString(e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst));return new Ce(t?t.name:null,r?r.name:null,i?i.name:null)}getWpEnumOnOffNullValueCore(e,t){return this.searchInTable(e,t,null,!1)}createCultureInfoFromString(e){try{if(!rn.StringUtils.isNullOrEmpty(e)){if(0==Qe.Comparers.string(e,"x-none"))return null;const t=parseInt(e,10);return isNaN(t)?new cR(e):mR.createCultureInfo(t)}}catch(e){}return null}}class CR{static compareInvariantCultureIgnoreCase(e,t){return Qe.Comparers.stringIgnoreCase(e,t)}}class SR{get documentModel(){return this.data.documentModel}get subDocument(){return this.data.subDocument}constructor(e){this.forbidProcessElementOpenClose=!1,this.data=e}processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}processElementClose(e){}processText(e){return!0}onAlternateContent(){return new IR(this.data,this)}isChoiceNamespaceSupported(e){return!1}processCurrentElementInternal(e){return this.processCurrentElement(e)}process(e){return YD(this,void 0,void 0,(function*(){switch(e.nodeType){case tF.Element:{O.print(L.DocxImporter,"process",(()=>`Element "${e.localName}"`));const t=this.processCurrentElement(e);t?(this.data.destinationStack.push(t),this.data.destinationStack.last.forbidProcessElementOpenClose||(yield this.data.destinationStack.last.processElementOpen(e))):e.skipElement();break}case tF.SignificantWhitespace:case tF.CDATA:case tF.Text:return O.print(L.DocxImporter,"process",(()=>`Text "${e.value}"`)),this.data.destinationStack.last.processText(e);case tF.EndElement:{O.print(L.DocxImporter,"process",(()=>`Element end "${e.localName}"`));const t=this.data.destinationStack.pop();t.forbidProcessElementOpenClose||t.processElementClose(e);break}}return Promise.resolve()}))}peek(){return this}shouldProcessWhitespaces(e){return!1}processCurrentElement(e){const t=e.localName;if("AlternateContent"==t)return this.onAlternateContent();const r=this.elementHandlerTable[t];return r?r(this.data,e):null}}class IR extends SR{get elementHandlerTable(){return this.data.options.throwInvalidFile("AlternateContentDestination exception"),null}constructor(e,t){super(e),this.parentDestination=t,t.forbidProcessElementOpenClose=!0}processElementClose(e){super.processElementClose(e),this.parentDestination.forbidProcessElementOpenClose=!1}processCurrentElement(e){const t=e.localName;if("Choice"!=t||this.hasProcessedChoice){if("Fallback"==t&&!this.hasProcessedChoice)return this.parentDestination}else{const t=e.getAttribute("Requires"),r=this.data.constants.lookupNamespaceByPrefix(t);if(r&&this.parentDestination.isChoiceNamespaceSupported(r))return this.hasProcessedChoice=!0,this.parentDestination}return new yR(this.data)}}class PR extends SR{get elementHandlerTable(){return{}}}class wR extends PR{constructor(e,t,r){super(e),this.properties=t,this.desc=r}}class yR extends PR{}class xR extends SR{get elementHandlerTable(){return{}}constructor(e){super(e),this.destination=this.data.destinationStack.last}processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}processElementClose(e){}processText(e){return this.destination.processText(e)}peek(){return this.destination.peek()}processCurrentElement(e){return this.destination.processCurrentElementInternal(e)}}class TR extends xR{}class vR{constructor(e,t,r,i){this.id=e,this.target=t,this.type=r,this.targetMode=i}isEmpty(){return rn.StringUtils.isNullOrEmpty(this.id)||rn.StringUtils.isNullOrEmpty(this.type)||rn.StringUtils.isNullOrEmpty(this.target)}}class MR extends SR{constructor(e,t){super(e),this.relations=t}get elementHandlerTable(){return{}}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=new vR(e.getAttribute("Id"),e.getAttribute("Target"),e.getAttribute("Type"),e.getAttribute("TargetMode"));t.isEmpty()||this.relations.add(t)}))}}class ER extends SR{get elementHandlerTable(){return ER.handlerTable}constructor(e,t){super(e),this.relations=t}static getThis(e){return e.destinationStack.getThis()}}ER.handlerTable=(new Eu).add("Relationship",((e,t)=>new MR(e,ER.getThis(e).relations))).get();class DR{constructor(e){this.data=e,this.list=[]}init(e){return YD(this,void 0,void 0,(function*(){const t=yield this.data.archiveData.getXmlReader(e);t&&t.readToFollowingNS("Relationships",this.data.constants.rels.packageRelsNamespace)&&(yield this.data.importContent(t,new ER(this.data,this)))}))}add(e){this.list.push(e)}lookupRelationById(e){return f.ListUtils.elementBy(this.list,(t=>t.id==e))}lookupRelationByType(e){return f.ListUtils.elementBy(this.list,(t=>t.type==e))}lookupRelationByTargetAndType(e,t){return f.ListUtils.elementBy(this.list,(r=>r.target==e&&r.type==t))}generateId(){return`rId${this.list.length+1}`}lookupExternalRelationById(e){const t=this.lookupRelationById(e);return t.targetMode&&0==CR.compareInvariantCultureIgnoreCase(t.targetMode,"external")?t:null}lookupRelationTargetById(e,t,r){const i=this.lookupRelationById(e);return QD.normalize(this.calculateRelationTargetCore(i,t,r))}lookupPackageFileStreamByRelationId(e,t){return YD(this,void 0,void 0,(function*(){const r=this.lookupRelationTargetById(e,t,"");return this.data.archiveData.getXmlReader(r)}))}lookupRelationTargetByType(e,t,r){let i=this.lookupRelationByType(e);return i||(i=this.lookupRelationByType(this.data.constants.translateToStrict(e)),null!=i&&this.data.constants.setStrictOpenXml()),QD.normalize(this.calculateRelationTargetCore(i,t,r))}lookupExternalImageByRelationId(e){return YD(this,void 0,void 0,(function*(){const t=this.lookupExternalRelationById(e);if(!t)return null;const r=this.data.documentModel.cache.imageCache.createUnloadedInfoByUrl(t.target);return this.data.imageRelationToCacheMap[t.target]=r.tmpId,r.tmpId}))}lookupImageByRelationId(e,t){return YD(this,void 0,void 0,(function*(){let r=this.lookupRelationTargetById(e,t,"");if(rn.StringUtils.startsAt(r,"/")&&(r=r.substring(1)),this.data.imageRelationToCacheMap[r])return this.data.imageRelationToCacheMap[r];const i=yield this.data.archiveData.getBase64(r);if(!i)return null;const n=Du.makeBase64UriPrefix(Du.convertExtensionToMimeType(QD.getFileExtension(r))),o=this.data.documentModel.cache.imageCache.createUnloadedInfoByBase64(n+i);return this.data.imageRelationToCacheMap[r]=o.tmpId,o.tmpId}))}calculateRelationTargetCore(e,t,r){return null==e?rn.StringUtils.isNullOrEmpty(t)?r:t+"/"+r:rn.StringUtils.startsAt(e.target,"/")||rn.StringUtils.isNullOrEmpty(t)?e.target:t+"/"+e.target}}class FR extends Rw.K{getThis(){return this.last.peek()}}class RR{get subDocumentInfo(){return this.subDocumentsInfoStack.last}get subDocument(){return this._subDocument}constructor(e,t,r){this.imageRelationToCacheMap={},this.options=e,this.archiveData=t,this.documentModel=r,this.formatImagesImporter=new Dw,this.stylesImporter=new QF(this),this.stylesImporter.presetDefaultProperties(),this.subDocumentsInfoStack=new Rw.K,this.pushCurrentSubDocument(this.documentModel.mainSubDocument),this.progressIndication=new AF,this.constants=new sF,this.readerHelper=new bR(this),this.relationsStack=new Rw.K,this.corePropertiesImporter=new kF(this),this.customPropertiesImporter=new OF(this),this.endNotesImporter=new UF(this),this.footNotesImporter=new HF(this),this.numberingListImporter=new WF(this),this.settingsImporter=new jF(this),this.themesImporter=new ZF(this),this.webSettingsImporter=new eR(this),this.headerFooterImporter=new VF(this),this.sectionImporter=new zF(this),this.altChunkImporter=new NF(this),this.destinationStack=new FR}fixLastParagraph(){this.shouldFixLastParagraph()}addRelations(e){return YD(this,void 0,void 0,(function*(){const t=new DR(this);return yield t.init(e),this.relationsStack.push(t),t}))}pushCurrentSubDocument(e){this._subDocument=e,this.subDocumentsInfoStack.push(new dR(this,e,{},null))}popCurrentSubDocument(){const e=this.subDocumentsInfoStack.last;return e.endImport(),this.subDocumentsInfoStack.pop(),this._subDocument=this.subDocumentsInfoStack.last?this.subDocumentsInfoStack.last.subDocument:null,e.subDocument}importContent(e,t){return YD(this,void 0,void 0,(function*(){const r=this.destinationStack.count;for(this.destinationStack.push(t);e.read();)yield this.destinationStack.last.process(e);if(e.state==eF.Error)return this.options.throwInvalidFile("Invalid file"),!1;for(;this.destinationStack.count>r;)this.destinationStack.pop();return!0}))}shouldFixLastParagraph(){return this.subDocument.paragraphs.length>1&&f.ListUtils.last(this.subDocument.paragraphs).isEmpty&&!0}}class LR{constructor(e,t){this.modelValue=e,this.mlValue=t}}class BR{constructor(){this.importMap={},this.exportMap={}}getValueOnImport(e,t){const r=this.importMap[e];return r?r.modelValue:t}}class AR{constructor(e,t){this.openXmlValue=e,this.wordMLValue=void 0!==t?t:this.convertToWordML(e)}convertToWordML(e){const t=e.length,r=[];for(let i=0;i<t;i++){const t=e[i];rn.StringUtils.stringInUpperCase(t)?(r.push("-"),r.push(t.toLowerCase())):r.push(t)}return r.join("")}}class NR{static createHorizontalPositionTypeAttributeTable(){const e=new BR;return NR.makeData(e,gc.Column,"text"),NR.makeData(e,gc.Margin,"margin"),NR.makeData(e,gc.Page,"page"),NR.makeData(e,gc.Character,"char"),NR.makeData(e,gc.LeftMargin,"left-margin-area"),NR.makeData(e,gc.RightMargin,"right-margin-area"),NR.makeData(e,gc.InsideMargin,"inner-margin-area"),NR.makeData(e,gc.OutsideMargin,"outer-margin-area"),e}static createVerticalPositionTypeAttributeTable(){const e=new BR;return NR.makeData(e,fc.Margin,"margin"),NR.makeData(e,fc.Page,"page"),NR.makeData(e,fc.Line,"line"),NR.makeData(e,fc.Paragraph,"text"),NR.makeData(e,fc.TopMargin,"top-margin-area"),NR.makeData(e,fc.BottomMargin,"bottom-margin-area"),NR.makeData(e,fc.InsideMargin,"inner-margin-area"),NR.makeData(e,fc.OutsideMargin,"outer-margin-area"),e}static createSchemeColorTable(){const e=new BR;return NR.makeData(e,yn.Accent1,"accent1"),NR.makeData(e,yn.Accent2,"accent2"),NR.makeData(e,yn.Accent3,"accent3"),NR.makeData(e,yn.Accent4,"accent4"),NR.makeData(e,yn.Accent5,"accent5"),NR.makeData(e,yn.Accent6,"accent6"),NR.makeData(e,yn.Background1,"bg1"),NR.makeData(e,yn.Background2,"bg2"),NR.makeData(e,yn.Dark1,"dk1"),NR.makeData(e,yn.Dark2,"dk2"),NR.makeData(e,yn.FollowedHyperlink,"folHlink"),NR.makeData(e,yn.Hyperlink,"hlink"),NR.makeData(e,yn.Light1,"lt1"),NR.makeData(e,yn.Light2,"lt2"),NR.makeData(e,yn.Style,"phClr"),NR.makeData(e,yn.Text1,"tx1"),NR.makeData(e,yn.Text2,"tx2"),e}static createSystemColorTable(){const e=new BR;return NR.makeData(e,xn.Sc3dDkShadow,"3dDkShadow"),NR.makeData(e,xn.Sc3dLight,"3dLight"),NR.makeData(e,xn.ScActiveBorder,"activeBorder"),NR.makeData(e,xn.ScActiveCaption,"activeCaption"),NR.makeData(e,xn.ScAppWorkspace,"appWorkspace"),NR.makeData(e,xn.ScBackground,"background"),NR.makeData(e,xn.ScBtnFace,"btnFace"),NR.makeData(e,xn.ScBtnHighlight,"btnHighlight"),NR.makeData(e,xn.ScBtnShadow,"btnShadow"),NR.makeData(e,xn.ScBtnText,"btnText"),NR.makeData(e,xn.ScCaptionText,"captionText"),NR.makeData(e,xn.ScGradientActiveCaption,"gradientActiveCaption"),NR.makeData(e,xn.ScGradientInactiveCaption,"gradientInactiveCaption"),NR.makeData(e,xn.ScGrayText,"grayText"),NR.makeData(e,xn.ScHighlight,"highlight"),NR.makeData(e,xn.ScHighlightText,"highlightText"),NR.makeData(e,xn.ScHotLight,"hotLight"),NR.makeData(e,xn.ScInactiveBorder,"inactiveBorder"),NR.makeData(e,xn.ScInactiveCaption,"inactiveCaption"),NR.makeData(e,xn.ScInactiveCaptionText,"inactiveCaptionText"),NR.makeData(e,xn.ScInfoBk,"infoBk"),NR.makeData(e,xn.ScInfoText,"infoText"),NR.makeData(e,xn.ScMenu,"menu"),NR.makeData(e,xn.ScMenuBar,"menuBar"),NR.makeData(e,xn.ScMenuHighlight,"menuHighlight"),NR.makeData(e,xn.ScMenuText,"menuText"),NR.makeData(e,xn.ScScrollBar,"scrollBar"),NR.makeData(e,xn.ScWindow,"window"),NR.makeData(e,xn.ScWindowFrame,"windowFrame"),NR.makeData(e,xn.ScWindowText,"windowText"),e}static createSimpleThemeColorIndexTable(){return(new Eu).add(ce.Accent1,"accent1").add(ce.Accent2,"accent2").add(ce.Accent3,"accent3").add(ce.Accent4,"accent4").add(ce.Accent5,"accent5").add(ce.Accent6,"accent6").add(ce.Dark1,"dark1").add(ce.Dark2,"dark2").add(ce.FollowedHyperlink,"followedHyperlink").add(ce.Hyperlink,"hyperlink").add(ce.Light1,"light1").add(ce.Light2,"light2").add(ce.None,"none").get()}static createSimple2ThemeColorIndexTable(){return(new Eu).add(ce.Accent1,"accent1").add(ce.Accent2,"accent2").add(ce.Accent3,"accent3").add(ce.Accent4,"accent4").add(ce.Accent5,"accent5").add(ce.Accent6,"accent6").add(ce.Dark1,"dk1").add(ce.Dark2,"dk2").add(ce.FollowedHyperlink,"folHlink").add(ce.Hyperlink,"hlink").add(ce.Light1,"lt1").add(ce.Light2,"lt2").get()}static makeData(e,t,r,i){e.importMap[r]=e.exportMap[t]=new LR(t,new AR(r,i))}static createUnderlineTables(){const e=new BR;return NR.makeData(e,le.None,"none"),NR.makeData(e,le.Single,"single"),NR.makeData(e,le.Double,"double"),NR.makeData(e,le.Dotted,"dotted"),NR.makeData(e,le.Dashed,"dash"),NR.makeData(e,le.LongDashed,"dashLong"),NR.makeData(e,le.DashDotted,"dotDash"),NR.makeData(e,le.DashDotDotted,"dotDotDash"),NR.makeData(e,le.DoubleWave,"wavyDouble"),NR.makeData(e,le.HeavyWave,"wavyHeavy"),NR.makeData(e,le.ThickDashDotDotted,"dashDotDotHeavy"),NR.makeData(e,le.ThickDashDotted,"dashDotHeavy"),NR.makeData(e,le.ThickDashed,"dashedHeavy"),NR.makeData(e,le.ThickDotted,"dottedHeavy"),NR.makeData(e,le.ThickLongDashed,"dashLongHeavy"),NR.makeData(e,le.ThickSingle,"thick"),NR.makeData(e,le.Wave,"wave"),e}static createThemeColorValuesTable(){const e=new BR;return NR.makeData(e,z.Accent1,"accent1"),NR.makeData(e,z.Accent2,"accent2"),NR.makeData(e,z.Accent3,"accent3"),NR.makeData(e,z.Accent4,"accent4"),NR.makeData(e,z.Accent5,"accent5"),NR.makeData(e,z.Accent6,"accent6"),NR.makeData(e,z.Dark1,"dark1"),NR.makeData(e,z.Dark2,"dark2"),NR.makeData(e,z.FollowedHyperlink,"followedHyperlink"),NR.makeData(e,z.Hyperlink,"hyperlink"),NR.makeData(e,z.Light1,"light1"),NR.makeData(e,z.Light2,"light2"),NR.makeData(e,z.None,"none"),NR.makeData(e,z.Background1,"background1"),NR.makeData(e,z.Background2,"background2"),NR.makeData(e,z.Text1,"text1"),NR.makeData(e,z.Text2,"text2"),e}static createSectionStartTypeTable(){const e=new BR;return NR.makeData(e,Vs.NextPage,"nextPage"),NR.makeData(e,Vs.OddPage,"oddPage"),NR.makeData(e,Vs.EvenPage,"evenPage"),NR.makeData(e,Vs.Column,"nextColumn"),NR.makeData(e,Vs.Continuous,"continuous"),e}static createLineNumberingRestartTable(){const e=new BR;return NR.makeData(e,zs.Continuous,"continuous"),NR.makeData(e,zs.NewPage,"newPage"),NR.makeData(e,zs.NewSection,"newSection"),e}static createPageNumberingFormatTable(){const e=new BR;return NR.makeData(e,Zi.None,"none"),NR.makeData(e,Zi.Decimal,"decimal"),NR.makeData(e,Zi.AIUEOFullWidthHiragana,"aiueoFullWidth"),NR.makeData(e,Zi.AIUEOHiragana,"aiueo"),NR.makeData(e,Zi.ArabicAbjad,"arabicAbjad"),NR.makeData(e,Zi.ArabicAlpha,"arabicAlpha"),NR.makeData(e,Zi.Bullet,"bullet"),NR.makeData(e,Zi.CardinalText,"cardinalText"),NR.makeData(e,Zi.Chicago,"chicago"),NR.makeData(e,Zi.ChineseCounting,"chineseCounting"),NR.makeData(e,Zi.ChineseCountingThousand,"chineseCountingThousand"),NR.makeData(e,Zi.ChineseLegalSimplified,"chineseLegalSimplified"),NR.makeData(e,Zi.Chosung,"chosung"),NR.makeData(e,Zi.DecimalEnclosedCircle,"decimalEnclosedCircle"),NR.makeData(e,Zi.DecimalEnclosedCircleChinese,"decimalEnclosedCircleChinese"),NR.makeData(e,Zi.DecimalEnclosedFullstop,"decimalEnclosedFullstop"),NR.makeData(e,Zi.DecimalEnclosedParentheses,"decimalEnclosedParen"),NR.makeData(e,Zi.DecimalFullWidth,"decimalFullWidth"),NR.makeData(e,Zi.DecimalFullWidth2,"decimalFullWidth2"),NR.makeData(e,Zi.DecimalHalfWidth,"decimalHalfWidth"),NR.makeData(e,Zi.DecimalZero,"decimalZero"),NR.makeData(e,Zi.Ganada,"ganada"),NR.makeData(e,Zi.Hebrew1,"hebrew1"),NR.makeData(e,Zi.Hebrew2,"hebrew2"),NR.makeData(e,Zi.Hex,"hex"),NR.makeData(e,Zi.HindiConsonants,"hindiConsonants"),NR.makeData(e,Zi.HindiDescriptive,"hindiCounting"),NR.makeData(e,Zi.HindiNumbers,"hindiNumbers"),NR.makeData(e,Zi.HindiVowels,"hindiVowels"),NR.makeData(e,Zi.IdeographDigital,"ideographDigital"),NR.makeData(e,Zi.IdeographEnclosedCircle,"ideographEnclosedCircle"),NR.makeData(e,Zi.IdeographLegalTraditional,"ideographLegalTraditional"),NR.makeData(e,Zi.IdeographTraditional,"ideographTraditional"),NR.makeData(e,Zi.IdeographZodiac,"ideographZodiac"),NR.makeData(e,Zi.IdeographZodiacTraditional,"ideographZodiacTraditional"),NR.makeData(e,Zi.Iroha,"iroha"),NR.makeData(e,Zi.IrohaFullWidth,"irohaFullWidth"),NR.makeData(e,Zi.JapaneseCounting,"japaneseCounting"),NR.makeData(e,Zi.JapaneseDigitalTenThousand,"japaneseDigitalTenThousand"),NR.makeData(e,Zi.JapaneseLegal,"japaneseLegal"),NR.makeData(e,Zi.KoreanCounting,"koreanCounting"),NR.makeData(e,Zi.KoreanDigital,"koreanDigital"),NR.makeData(e,Zi.KoreanDigital2,"koreanDigital2"),NR.makeData(e,Zi.KoreanLegal,"koreanLegal"),NR.makeData(e,Zi.LowerLetter,"lowerLetter"),NR.makeData(e,Zi.LowerRoman,"lowerRoman"),NR.makeData(e,Zi.NumberInDash,"numberInDash"),NR.makeData(e,Zi.Ordinal,"ordinal"),NR.makeData(e,Zi.OrdinalText,"ordinalText"),NR.makeData(e,Zi.RussianLower,"russianLower"),NR.makeData(e,Zi.RussianUpper,"russianUpper"),NR.makeData(e,Zi.TaiwaneseCounting,"taiwaneseCounting"),NR.makeData(e,Zi.TaiwaneseCountingThousand,"taiwaneseCountingThousand"),NR.makeData(e,Zi.TaiwaneseDigital,"taiwaneseDigital"),NR.makeData(e,Zi.ThaiDescriptive,"thaiCounting"),NR.makeData(e,Zi.ThaiLetters,"thaiLetters"),NR.makeData(e,Zi.ThaiNumbers,"thaiNumbers"),NR.makeData(e,Zi.UpperLetter,"upperLetter"),NR.makeData(e,Zi.UpperRoman,"upperRoman"),NR.makeData(e,Zi.VietnameseDescriptive,"vietnameseCounting"),e}static createChapterSeparatorsTable(){const e=new BR;return NR.makeData(e,":".charCodeAt(0),"colon"),NR.makeData(e,an.specialCharacters.EmDash.charCodeAt(0),"emDash"),NR.makeData(e,an.specialCharacters.EnDash.charCodeAt(0),"enDash"),NR.makeData(e,an.specialCharacters.Hyphen.charCodeAt(0),"hyphen"),NR.makeData(e,".".charCodeAt(0),"period"),e}static createVerticalAlignmentTable(){const e=new BR;return NR.makeData(e,Ke.Top,"top"),NR.makeData(e,Ke.Center,"center"),NR.makeData(e,Ke.Bottom,"bottom"),NR.makeData(e,Ke.Both,"both"),e}static createDrawingTextAnchoringTypeTable(){const e=new BR;return NR.makeData(e,Sc.Top,"t","top"),NR.makeData(e,Sc.Center,"ctr","middle"),NR.makeData(e,Sc.Justified,"just"),NR.makeData(e,Sc.Bottom,"b","bottom"),e}static createBorderLineStyleTable(){const e=new BR;return NR.makeData(e,de.Nil,"nil"),NR.makeData(e,de.DashDotStroked,"dashDotStroked"),NR.makeData(e,de.Dashed,"dashed"),NR.makeData(e,de.DashSmallGap,"dashSmallGap"),NR.makeData(e,de.DotDash,"dotDash"),NR.makeData(e,de.DotDotDash,"dotDotDash"),NR.makeData(e,de.Dotted,"dotted"),NR.makeData(e,de.Double,"double"),NR.makeData(e,de.DoubleWave,"doubleWave"),NR.makeData(e,de.Inset,"inset"),NR.makeData(e,de.Disabled,"disabled"),NR.makeData(e,de.None,"none"),NR.makeData(e,de.Outset,"outset"),NR.makeData(e,de.Single,"single"),NR.makeData(e,de.Thick,"thick"),NR.makeData(e,de.ThickThinLargeGap,"thickThinLargeGap"),NR.makeData(e,de.ThickThinMediumGap,"thickThinMediumGap"),NR.makeData(e,de.ThickThinSmallGap,"thickThinSmallGap"),NR.makeData(e,de.ThinThickLargeGap,"thinThickLargeGap"),NR.makeData(e,de.ThinThickMediumGap,"thinThickMediumGap"),NR.makeData(e,de.ThinThickSmallGap,"thinThickSmallGap"),NR.makeData(e,de.ThinThickThinLargeGap,"thinThickThinLargeGap"),NR.makeData(e,de.ThinThickThinMediumGap,"thinThickThinMediumGap"),NR.makeData(e,de.ThinThickThinSmallGap,"thinThickThinSmallGap"),NR.makeData(e,de.ThreeDEmboss,"threeDEmboss"),NR.makeData(e,de.ThreeDEngrave,"threeDEngrave"),NR.makeData(e,de.Triple,"triple"),NR.makeData(e,de.Wave,"wave"),NR.makeData(e,de.Apples,"apples"),NR.makeData(e,de.ArchedScallops,"archedScallops"),NR.makeData(e,de.BabyPacifier,"babyPacifier"),NR.makeData(e,de.BabyRattle,"babyRattle"),NR.makeData(e,de.Balloons3Colors,"balloons3Colors"),NR.makeData(e,de.BalloonsHotAir,"balloonsHotAir"),NR.makeData(e,de.BasicBlackDashes,"basicBlackDashes"),NR.makeData(e,de.BasicBlackDots,"basicBlackDots"),NR.makeData(e,de.BasicBlackSquares,"basicBlackSquares"),NR.makeData(e,de.BasicThinLines,"basicThinLines"),NR.makeData(e,de.BasicWhiteDashes,"basicWhiteDashes"),NR.makeData(e,de.BasicWhiteDots,"basicWhiteDots"),NR.makeData(e,de.BasicWhiteSquares,"basicWhiteSquares"),NR.makeData(e,de.BasicWideInline,"basicWideInline"),NR.makeData(e,de.BasicWideMidline,"basicWideMidline"),NR.makeData(e,de.BasicWideOutline,"basicWideOutline"),NR.makeData(e,de.Bats,"bats"),NR.makeData(e,de.Birds,"birds"),NR.makeData(e,de.BirdsFlight,"birdsFlight"),NR.makeData(e,de.Cabins,"cabins"),NR.makeData(e,de.CakeSlice,"cakeSlice"),NR.makeData(e,de.CandyCorn,"candyCorn"),NR.makeData(e,de.CelticKnotwork,"celticKnotwork"),NR.makeData(e,de.CertificateBanner,"certificateBanner"),NR.makeData(e,de.ChainLink,"chainLink"),NR.makeData(e,de.ChampagneBottle,"champagneBottle"),NR.makeData(e,de.CheckedBarBlack,"checkedBarBlack"),NR.makeData(e,de.CheckedBarColor,"checkedBarColor"),NR.makeData(e,de.Checkered,"checkered"),NR.makeData(e,de.ChristmasTree,"christmasTree"),NR.makeData(e,de.CirclesLines,"circlesLines"),NR.makeData(e,de.CirclesRectangles,"circlesRectangles"),NR.makeData(e,de.ClassicalWave,"classicalWave"),NR.makeData(e,de.Clocks,"clocks"),NR.makeData(e,de.Compass,"compass"),NR.makeData(e,de.Confetti,"confetti"),NR.makeData(e,de.ConfettiGrays,"confettiGrays"),NR.makeData(e,de.ConfettiOutline,"confettiOutline"),NR.makeData(e,de.ConfettiStreamers,"confettiStreamers"),NR.makeData(e,de.ConfettiWhite,"confettiWhite"),NR.makeData(e,de.CornerTriangles,"cornerTriangles"),NR.makeData(e,de.CouponCutoutDashes,"couponCutoutDashes"),NR.makeData(e,de.CouponCutoutDots,"couponCutoutDots"),NR.makeData(e,de.CrazyMaze,"crazyMaze"),NR.makeData(e,de.CreaturesButterfly,"creaturesButterfly"),NR.makeData(e,de.CreaturesFish,"creaturesFish"),NR.makeData(e,de.CreaturesInsects,"creaturesInsects"),NR.makeData(e,de.CreaturesLadyBug,"creaturesLadyBug"),NR.makeData(e,de.CrossStitch,"crossStitch"),NR.makeData(e,de.Cup,"cup"),NR.makeData(e,de.DecoArch,"decoArch"),NR.makeData(e,de.DecoArchColor,"decoArchColor"),NR.makeData(e,de.DecoBlocks,"decoBlocks"),NR.makeData(e,de.DiamondsGray,"diamondsGray"),NR.makeData(e,de.DoubleD,"doubleD"),NR.makeData(e,de.DoubleDiamonds,"doubleDiamonds"),NR.makeData(e,de.Earth1,"earth1"),NR.makeData(e,de.Earth2,"earth2"),NR.makeData(e,de.EclipsingSquares1,"eclipsingSquares1"),NR.makeData(e,de.EclipsingSquares2,"eclipsingSquares2"),NR.makeData(e,de.EggsBlack,"eggsBlack"),NR.makeData(e,de.Fans,"fans"),NR.makeData(e,de.Film,"film"),NR.makeData(e,de.Firecrackers,"firecrackers"),NR.makeData(e,de.FlowersBlockPrint,"flowersBlockPrint"),NR.makeData(e,de.FlowersDaisies,"flowersDaisies"),NR.makeData(e,de.FlowersModern1,"flowersModern1"),NR.makeData(e,de.FlowersModern2,"flowersModern2"),NR.makeData(e,de.FlowersPansy,"flowersPansy"),NR.makeData(e,de.FlowersRedRose,"flowersRedRose"),NR.makeData(e,de.FlowersRoses,"flowersRoses"),NR.makeData(e,de.FlowersTeacup,"flowersTeacup"),NR.makeData(e,de.FlowersTiny,"flowersTiny"),NR.makeData(e,de.Gems,"gems"),NR.makeData(e,de.GingerbreadMan,"gingerbreadMan"),NR.makeData(e,de.Gradient,"gradient"),NR.makeData(e,de.Handmade1,"handmade1"),NR.makeData(e,de.Handmade2,"handmade2"),NR.makeData(e,de.HeartBalloon,"heartBalloon"),NR.makeData(e,de.HeartGray,"heartGray"),NR.makeData(e,de.Hearts,"hearts"),NR.makeData(e,de.HeebieJeebies,"heebieJeebies"),NR.makeData(e,de.Holly,"holly"),NR.makeData(e,de.HouseFunky,"houseFunky"),NR.makeData(e,de.Hypnotic,"hypnotic"),NR.makeData(e,de.IceCreamCones,"iceCreamCones"),NR.makeData(e,de.LightBulb,"lightBulb"),NR.makeData(e,de.Lightning1,"lightning1"),NR.makeData(e,de.Lightning2,"lightning2"),NR.makeData(e,de.MapleLeaf,"mapleLeaf"),NR.makeData(e,de.MapleMuffins,"mapleMuffins"),NR.makeData(e,de.MapPins,"mapPins"),NR.makeData(e,de.Marquee,"marquee"),NR.makeData(e,de.MarqueeToothed,"marqueeToothed"),NR.makeData(e,de.Moons,"moons"),NR.makeData(e,de.Mosaic,"mosaic"),NR.makeData(e,de.MusicNotes,"musicNotes"),NR.makeData(e,de.Northwest,"northwest"),NR.makeData(e,de.Ovals,"ovals"),NR.makeData(e,de.Packages,"packages"),NR.makeData(e,de.PalmsBlack,"palmsBlack"),NR.makeData(e,de.PalmsColor,"palmsColor"),NR.makeData(e,de.PaperClips,"paperClips"),NR.makeData(e,de.Papyrus,"papyrus"),NR.makeData(e,de.PartyFavor,"partyFavor"),NR.makeData(e,de.PartyGlass,"partyGlass"),NR.makeData(e,de.Pencils,"pencils"),NR.makeData(e,de.People,"people"),NR.makeData(e,de.PeopleHats,"peopleHats"),NR.makeData(e,de.PeopleWaving,"peopleWaving"),NR.makeData(e,de.Poinsettias,"poinsettias"),NR.makeData(e,de.PostageStamp,"postageStamp"),NR.makeData(e,de.Pumpkin1,"pumpkin1"),NR.makeData(e,de.PushPinNote1,"pushPinNote1"),NR.makeData(e,de.PushPinNote2,"pushPinNote2"),NR.makeData(e,de.Pyramids,"pyramids"),NR.makeData(e,de.PyramidsAbove,"pyramidsAbove"),NR.makeData(e,de.Quadrants,"quadrants"),NR.makeData(e,de.Rings,"rings"),NR.makeData(e,de.Safari,"safari"),NR.makeData(e,de.Sawtooth,"sawtooth"),NR.makeData(e,de.SawtoothGray,"sawtoothGray"),NR.makeData(e,de.ScaredCat,"scaredCat"),NR.makeData(e,de.Seattle,"seattle"),NR.makeData(e,de.ShadowedSquares,"shadowedSquares"),NR.makeData(e,de.SharksTeeth,"sharksTeeth"),NR.makeData(e,de.ShorebirdTracks,"shorebirdTracks"),NR.makeData(e,de.Skyrocket,"skyrocket"),NR.makeData(e,de.SnowflakeFancy,"snowflakeFancy"),NR.makeData(e,de.Snowflakes,"snowflakes"),NR.makeData(e,de.Sombrero,"sombrero"),NR.makeData(e,de.Southwest,"southwest"),NR.makeData(e,de.Stars,"stars"),NR.makeData(e,de.Stars3d,"stars3d"),NR.makeData(e,de.StarsBlack,"starsBlack"),NR.makeData(e,de.StarsShadowed,"starsShadowed"),NR.makeData(e,de.StarsTop,"starsTop"),NR.makeData(e,de.Sun,"sun"),NR.makeData(e,de.Swirligig,"swirligig"),NR.makeData(e,de.TornPaper,"tornPaper"),NR.makeData(e,de.TornPaperBlack,"tornPaperBlack"),NR.makeData(e,de.Trees,"trees"),NR.makeData(e,de.TriangleParty,"triangleParty"),NR.makeData(e,de.Triangles,"triangles"),NR.makeData(e,de.Tribal1,"tribal1"),NR.makeData(e,de.Tribal2,"tribal2"),NR.makeData(e,de.Tribal3,"tribal3"),NR.makeData(e,de.Tribal4,"tribal4"),NR.makeData(e,de.Tribal5,"tribal5"),NR.makeData(e,de.Tribal6,"tribal6"),NR.makeData(e,de.TwistedLines1,"twistedLines1"),NR.makeData(e,de.TwistedLines2,"twistedLines2"),NR.makeData(e,de.Vine,"vine"),NR.makeData(e,de.Waveline,"waveline"),NR.makeData(e,de.WeavingAngles,"weavingAngles"),NR.makeData(e,de.WeavingBraid,"weavingBraid"),NR.makeData(e,de.WeavingRibbon,"weavingRibbon"),NR.makeData(e,de.WeavingStrips,"weavingStrips"),NR.makeData(e,de.WhiteFlowers,"whiteFlowers"),NR.makeData(e,de.Woodwork,"woodwork"),NR.makeData(e,de.XIllusions,"xIllusions"),NR.makeData(e,de.ZanyTriangles,"zanyTriangles"),NR.makeData(e,de.ZigZag,"zigZag"),NR.makeData(e,de.ZigZagStitch,"zigZagStitch"),e}static createShadingPatternTable(){const e=new BR;return NR.makeData(e,re.Clear,"clear"),NR.makeData(e,re.DiagCross,"diagCross"),NR.makeData(e,re.DiagStripe,"diagStripe"),NR.makeData(e,re.HorzCross,"horzCross"),NR.makeData(e,re.HorzStripe,"horzStripe"),NR.makeData(e,re.Nil,"nil"),NR.makeData(e,re.Pct10,"pct10"),NR.makeData(e,re.Pct12,"pct12"),NR.makeData(e,re.Pct15,"pct15"),NR.makeData(e,re.Pct20,"pct20"),NR.makeData(e,re.Pct25,"pct25"),NR.makeData(e,re.Pct30,"pct30"),NR.makeData(e,re.Pct35,"pct35"),NR.makeData(e,re.Pct37,"pct37"),NR.makeData(e,re.Pct40,"pct40"),NR.makeData(e,re.Pct45,"pct45"),NR.makeData(e,re.Pct5,"pct5"),NR.makeData(e,re.Pct50,"pct50"),NR.makeData(e,re.Pct55,"pct55"),NR.makeData(e,re.Pct60,"pct60"),NR.makeData(e,re.Pct62,"pct62"),NR.makeData(e,re.Pct65,"pct65"),NR.makeData(e,re.Pct70,"pct70"),NR.makeData(e,re.Pct75,"pct75"),NR.makeData(e,re.Pct80,"pct80"),NR.makeData(e,re.Pct85,"pct85"),NR.makeData(e,re.Pct87,"pct87"),NR.makeData(e,re.Pct90,"pct90"),NR.makeData(e,re.Pct95,"pct95"),NR.makeData(e,re.ReverseDiagStripe,"reverseDiagStripe"),NR.makeData(e,re.Solid,"solid"),NR.makeData(e,re.ThinDiagCross,"thinDiagCross"),NR.makeData(e,re.ThinDiagStripe,"ThinDiagStripe"),NR.makeData(e,re.ThinHorzCross,"thinHorzCross"),NR.makeData(e,re.ThinHorzStripe,"thinHorzStripe"),NR.makeData(e,re.ThinReverseDiagStripe,"thinReverseDiagStripe"),NR.makeData(e,re.ThinVertStripe,"thinVertStripe"),NR.makeData(e,re.VertStripe,"vertStripe"),e}static createParagraphLineSpacingTable(){const e=new BR;return NR.makeData(e,Ne.Single,"auto"),NR.makeData(e,Ne.Double,"auto"),NR.makeData(e,Ne.Sesquialteral,"auto"),NR.makeData(e,Ne.Multiple,"auto"),NR.makeData(e,Ne.Exactly,"exact"),NR.makeData(e,Ne.AtLeast,"atLeast"),e}static createParagraphAlignmentTable(){const e=new BR;return NR.makeData(e,Ae.Left,"left"),NR.makeData(e,Ae.Right,"right"),NR.makeData(e,Ae.Center,"center"),NR.makeData(e,Ae.Justify,"both"),e}static createPredefinedBackgroundColors(){const e=new BR;return NR.makeData(e,U.empty,"none"),NR.makeData(e,y.getPredefinedColor(w.i.colorNames.black),"black"),NR.makeData(e,U.fromRgb(0,0,255),"blue"),NR.makeData(e,U.fromRgb(0,255,255),"cyan"),NR.makeData(e,U.fromRgb(0,0,128),"darkBlue"),NR.makeData(e,U.fromRgb(0,128,128),"darkCyan"),NR.makeData(e,U.fromRgb(128,128,128),"darkGray"),NR.makeData(e,U.fromRgb(0,128,0),"darkGreen"),NR.makeData(e,U.fromRgb(128,0,128),"darkMagenta"),NR.makeData(e,U.fromRgb(128,0,0),"darkRed"),NR.makeData(e,U.fromRgb(128,128,0),"darkYellow"),NR.makeData(e,U.fromRgb(0,255,0),"green"),NR.makeData(e,U.fromRgb(192,192,192),"lightGray"),NR.makeData(e,U.fromRgb(255,0,255),"magenta"),NR.makeData(e,U.fromRgb(255,0,0),"red"),NR.makeData(e,U.fromRgb(255,255,255),"white"),NR.makeData(e,U.fromRgb(255,255,0),"yellow"),e}static createRunBreaksTable(){const e=new BR;return NR.makeData(e,an.specialCharacters.LineBreak.charCodeAt(0),"textWrapping"),NR.makeData(e,an.specialCharacters.PageBreak.charCodeAt(0),"page"),NR.makeData(e,an.specialCharacters.ColumnBreak.charCodeAt(0),"column"),e}static createHorizontalAnchorTypesTable(){const e=new BR;return NR.makeData(e,Ve.Column,"text"),NR.makeData(e,Ve.Margin,"margin"),NR.makeData(e,Ve.Page,"page"),e}static createVerticalAnchorTypesTable(){const e=new BR;return NR.makeData(e,We.Paragraph,"text"),NR.makeData(e,We.Margin,"margin"),NR.makeData(e,We.Page,"page"),e}static createHorizontalAlignModeTable(){const e=new BR;return NR.makeData(e,Ue.Center,"center"),NR.makeData(e,Ue.Inside,"inside"),NR.makeData(e,Ue.Left,"left"),NR.makeData(e,Ue.Outside,"outside"),NR.makeData(e,Ue.Right,"right"),e}static createVerticalAlignModeTable(){const e=new BR;return NR.makeData(e,He.Bottom,"bottom"),NR.makeData(e,He.Center,"center"),NR.makeData(e,He.Inline,"inline"),NR.makeData(e,He.Inside,"inside"),NR.makeData(e,He.Outside,"outside"),NR.makeData(e,He.Top,"top"),e}static createWidthUnitTypesTable(){const e=new BR;return NR.makeData(e,Je.Auto,"auto"),NR.makeData(e,Je.FiftiethsOfPercent,"pct"),NR.makeData(e,Je.ModelUnits,"dxa"),NR.makeData(e,Je.Nil,"nil"),e}static createTableRowAlignmentTable(){const e=new BR;return NR.makeData(e,je.Both,"both"),NR.makeData(e,je.Center,"center"),NR.makeData(e,je.Distribute,"distribute"),NR.makeData(e,je.Left,"left"),NR.makeData(e,je.NumTab,"numTab"),NR.makeData(e,je.Right,"right"),e}static createStrictTableRowAlignmentTable(){const e=new BR;return NR.makeData(e,je.Both,"both"),NR.makeData(e,je.Center,"center"),NR.makeData(e,je.Distribute,"distribute"),NR.makeData(e,je.Left,"start"),NR.makeData(e,je.NumTab,"numTab"),NR.makeData(e,je.Right,"end"),e}static createTableLayoutTypeTable(){const e=new BR;return NR.makeData(e,Oe.Autofit,"autofit"),NR.makeData(e,Oe.Fixed,"fixed"),e}static createHeightUnitTypeTable(){const e=new BR;return NR.makeData(e,$e.Auto,"auto"),NR.makeData(e,$e.Exact,"exact"),NR.makeData(e,$e.Minimum,"atLeast"),e}static createMergingStateTable(){const e=new BR;return NR.makeData(e,Xe.None,"none"),NR.makeData(e,Xe.Restart,"restart"),NR.makeData(e,Xe.Continue,"continue"),e}static createHeaderFooterTypeTable(){const e=new BR;return NR.makeData(e,Ws.Even,"even"),NR.makeData(e,Ws.First,"first"),NR.makeData(e,Ws.Odd,"default"),e}static createNumberingListTypeTable(){const e=new BR;return NR.makeData(e,tn.Bullet,"hybridMultilevel","HybridMultilevel"),NR.makeData(e,tn.Simple,"hybridMultilevel","HybridMultilevel"),NR.makeData(e,tn.MultiLevel,"multilevel","Multilevel"),e}static createListNumberSeparatorTable(){const e=new BR;return NR.makeData(e,"\0".charCodeAt(0),"nothing"),NR.makeData(e," ".charCodeAt(0),"space"),NR.makeData(e,an.specialCharacters.TabMark.charCodeAt(0),"tab"),e}static createListNumberAlignmentTable(){const e=new BR;return NR.makeData(e,en.Left,"left"),NR.makeData(e,en.Right,"right"),NR.makeData(e,en.Center,"center"),e}static createTabLeaderTable(){const e=new BR;return NR.makeData(e,Sg.None,"none"),NR.makeData(e,Sg.Dots,"dot"),NR.makeData(e,Sg.EqualSign,"hyphen"),NR.makeData(e,Sg.Hyphens,"hyphen"),NR.makeData(e,Sg.MiddleDots,"middleDot"),NR.makeData(e,Sg.ThickLine,"heavy"),NR.makeData(e,Sg.Underline,"underscore"),e}static createTabAlignmentTable(){const e=new BR;return NR.makeData(e,Ha.Left,"left"),NR.makeData(e,Ha.Right,"right"),NR.makeData(e,Ha.Center,"center"),NR.makeData(e,Ha.Decimal,"decimal"),e}static createStrictTabAlignmentTable(){const e=new BR;return NR.makeData(e,Ha.Left,"start"),NR.makeData(e,Ha.Right,"end"),NR.makeData(e,Ha.Center,"center"),NR.makeData(e,Ha.Decimal,"decimal"),e}static createTextBoxVerticalAlignmentTable(){const e=new BR;return NR.makeData(e,Cc.Top,"t","top"),NR.makeData(e,Cc.Center,"ctr","middle"),NR.makeData(e,Cc.Both,"just"),NR.makeData(e,Cc.Bottom,"b","bottom"),e}static createConditionalTableStyleFormattingTypesTable(){const e=new BR;return NR.makeData(e,qe.BottomLeftCell,"swCell","swCell"),NR.makeData(e,qe.BottomRightCell,"seCell","seCell"),NR.makeData(e,qe.EvenColumnBanding,"band2Vert","band2Vert"),NR.makeData(e,qe.EvenRowBanding,"band2Horz","band2Horz"),NR.makeData(e,qe.FirstColumn,"firstCol","firstCol"),NR.makeData(e,qe.FirstRow,"firstRow","firstRow"),NR.makeData(e,qe.LastColumn,"lastCol","lastCol"),NR.makeData(e,qe.LastRow,"lastRow","lastRow"),NR.makeData(e,qe.OddColumnBanding,"band1Vert","band1Vert"),NR.makeData(e,qe.OddRowBanding,"band1Horz","band1Horz"),NR.makeData(e,qe.TopLeftCell,"nwCell","nwCell"),NR.makeData(e,qe.TopRightCell,"neCell","neCell"),NR.makeData(e,qe.WholeTable,"wholeTable","wholeTable"),e}static createFloatingObjectHorizontalPositionTypeTable(){const e=new BR;return NR.makeData(e,gc.Column,"column","text"),NR.makeData(e,gc.Margin,"margin"),NR.makeData(e,gc.Page,"page"),NR.makeData(e,gc.Character,"character","char"),NR.makeData(e,gc.LeftMargin,"leftMargin","page"),NR.makeData(e,gc.RightMargin,"rightMargin","page"),NR.makeData(e,gc.InsideMargin,"insideMargin","page"),NR.makeData(e,gc.OutsideMargin,"outsideMargin","page"),e}static createFloatingObjectHorizontalPositionAlignmentTable(){const e=new BR;return NR.makeData(e,mc.Left,"left"),NR.makeData(e,mc.Center,"center"),NR.makeData(e,mc.Right,"right"),NR.makeData(e,mc.Inside,"inside"),NR.makeData(e,mc.Outside,"outside"),e}static createFloatingObjectVerticalPositionTypeTable(){const e=new BR;return NR.makeData(e,fc.Margin,"margin"),NR.makeData(e,fc.Page,"page","margin"),NR.makeData(e,fc.Line,"line"),NR.makeData(e,fc.Paragraph,"paragraph","text"),NR.makeData(e,fc.TopMargin,"topMargin","page"),NR.makeData(e,fc.BottomMargin,"bottomMargin","page"),NR.makeData(e,fc.InsideMargin,"insideMargin","page"),NR.makeData(e,fc.OutsideMargin,"outsideMargin","page"),e}static createFloatingObjectVerticalPositionAlignmentTable(){const e=new BR;return NR.makeData(e,bc.Top,"top"),NR.makeData(e,bc.Center,"center"),NR.makeData(e,bc.Bottom,"bottom"),NR.makeData(e,bc.Inside,"inside"),NR.makeData(e,bc.Outside,"outside"),e}static createFloatingObjectTextWrapTypeTable(){const e=new BR;return NR.makeData(e,uc.TopAndBottom,"wrapTopAndBottom","topAndBottom"),NR.makeData(e,uc.Square,"wrapSquare","square"),NR.makeData(e,uc.Through,"wrapThrough","through"),NR.makeData(e,uc.Tight,"wrapTight","tight"),NR.makeData(e,uc.None,"wrapNone","none"),e}static createFloatingObjectTextWrapSideTable(){const e=new BR;return NR.makeData(e,pc.Both,"bothSides","both-sides"),NR.makeData(e,pc.Left,"left"),NR.makeData(e,pc.Right,"right"),NR.makeData(e,pc.Largest,"largest"),e}static createFloatingObjectRelativeFromHorizontalTable(){const e=new BR;return NR.makeData(e,cc.Margin,"margin"),NR.makeData(e,cc.Page,"page"),NR.makeData(e,cc.LeftMargin,"leftMargin"),NR.makeData(e,cc.RightMargin,"rightMargin"),NR.makeData(e,cc.OutsideMargin,"outsideMargin"),NR.makeData(e,cc.InsideMargin,"insideMargin"),e}static createFloatingObjectRelativeFromVerticalTable(){const e=new BR;return NR.makeData(e,hc.Margin,"margin"),NR.makeData(e,hc.Page,"page"),NR.makeData(e,hc.TopMargin,"topMargin"),NR.makeData(e,hc.BottomMargin,"bottomMargin"),NR.makeData(e,hc.OutsideMargin,"outsideMargin"),NR.makeData(e,hc.InsideMargin,"insideMargin"),e}static createFloatingObjectCssRelativeFromHorizontalTable(){const e=new BR;return NR.makeData(e,cc.Margin,"margin"),NR.makeData(e,cc.Page,"page"),NR.makeData(e,cc.LeftMargin,"left-margin-area"),NR.makeData(e,cc.RightMargin,"right-margin-area"),NR.makeData(e,cc.OutsideMargin,"outer-margin-area"),NR.makeData(e,cc.InsideMargin,"inner-margin-area"),e}static createFloatingObjectCssRelativeFromVerticalTable(){const e=new BR;return NR.makeData(e,hc.Margin,"margin"),NR.makeData(e,hc.Page,"page"),NR.makeData(e,hc.TopMargin,"top-margin-area"),NR.makeData(e,hc.BottomMargin,"bottom-margin-area"),NR.makeData(e,hc.OutsideMargin,"outer-margin-area"),NR.makeData(e,hc.InsideMargin,"inner-margin-area"),e}static createThemeColorIndexTable(){const e=new BR;return NR.makeData(e,ce.Accent1,"accent1"),NR.makeData(e,ce.Accent2,"accent2"),NR.makeData(e,ce.Accent3,"accent3"),NR.makeData(e,ce.Accent4,"accent4"),NR.makeData(e,ce.Accent5,"accent5"),NR.makeData(e,ce.Accent6,"accent6"),NR.makeData(e,ce.FollowedHyperlink,"folHlink"),NR.makeData(e,ce.Hyperlink,"hlink"),NR.makeData(e,ce.Dark1,"dk1"),NR.makeData(e,ce.Dark2,"dk2"),NR.makeData(e,ce.Light1,"lt1"),NR.makeData(e,ce.Light2,"lt2"),e}static createTextDirectionTable(){const e=new BR;return NR.makeData(e,Ge.LeftToRightTopToBottom,"lrTb"),NR.makeData(e,Ge.LeftToRightTopToBottomRotated,"lrTbV"),NR.makeData(e,Ge.BottomToTopLeftToRight,"btLr"),NR.makeData(e,Ge.TopToBottomLeftToRightRotated,"tbLrV"),NR.makeData(e,Ge.TopToBottomRightToLeft,"tbRl"),NR.makeData(e,Ge.TopToBottomRightToLeftRotated,"tbRlV"),e}static createNoteNumberingRestartTypeTable(){const e=new BR;return NR.makeData(e,Gs.Continuous,"continuous"),NR.makeData(e,Gs.NewPage,"eachPage"),NR.makeData(e,Gs.NewSection,"eachSect"),e}static createFootNotePlacementTable(){const e=new BR;return NR.makeData(e,js.BelowText,"beneathText"),NR.makeData(e,js.BottomOfPage,"pageBottom"),NR.makeData(e,js.EndOfDocument,"docEnd"),NR.makeData(e,js.EndOfSection,"sectEnd"),e}static createNoteTypeTable(){const e=new BR;return NR.makeData(e,Xs.Normal,"normal"),NR.makeData(e,Xs.Separator,"separator"),NR.makeData(e,Xs.ContinuationSeparator,"continuationSeparator"),NR.makeData(e,Xs.ContinuationNotice,"continuationNotice"),e}}NR.sectionStartTypeTable=NR.createSectionStartTypeTable(),NR.lineNumberingRestartTable=NR.createLineNumberingRestartTable(),NR.pageNumberingFormatTable=NR.createPageNumberingFormatTable(),NR.chapterSeparatorsTable=NR.createChapterSeparatorsTable(),NR.verticalAlignmentTable=NR.createVerticalAlignmentTable(),NR.drawingTextAnchoringType=NR.createDrawingTextAnchoringTypeTable(),NR.textDirectionTable=NR.createTextDirectionTable(),NR.borderLineStyleTable=NR.createBorderLineStyleTable(),NR.themeColorValueTable=NR.createThemeColorValuesTable(),NR.themeColorIndexTable=NR.createThemeColorIndexTable(),NR.simpleThemeColorIndexTable=NR.createSimpleThemeColorIndexTable(),NR.simple2ThemeColorIndexTable=NR.createSimple2ThemeColorIndexTable(),NR.shadingPatternTable=NR.createShadingPatternTable(),NR.lineSpacingTable=NR.createParagraphLineSpacingTable(),NR.paragraphAlignmentTable=NR.createParagraphAlignmentTable(),NR.underlineTables=NR.createUnderlineTables(),NR.predefinedBackgroundColors=NR.createPredefinedBackgroundColors(),NR.listOfKeysPredefinedBackgroundColors=b.j.toListBy(NR.predefinedBackgroundColors.exportMap,((e,t)=>t)),NR.runBreaksTable=NR.createRunBreaksTable(),NR.horizontalAnchorTypesTable=NR.createHorizontalAnchorTypesTable(),NR.verticalAnchorTypesTable=NR.createVerticalAnchorTypesTable(),NR.horizontalAlignModeTable=NR.createHorizontalAlignModeTable(),NR.verticalAlignModeTable=NR.createVerticalAlignModeTable(),NR.widthUnitTypesTable=NR.createWidthUnitTypesTable(),NR.tableRowAlignmentTable=NR.createTableRowAlignmentTable(),NR.strictTableRowAlignmentTable=NR.createStrictTableRowAlignmentTable(),NR.tableLayoutTypeTable=NR.createTableLayoutTypeTable(),NR.heightUnitTypeTable=NR.createHeightUnitTypeTable(),NR.mergingStateTable=NR.createMergingStateTable(),NR.headerFooterTypeTable=NR.createHeaderFooterTypeTable(),NR.floatingObjectHorizontalPositionTypeTable=NR.createFloatingObjectHorizontalPositionTypeTable(),NR.floatingObjectHorizontalPositionAlignmentTable=NR.createFloatingObjectHorizontalPositionAlignmentTable(),NR.floatingObjectVerticalPositionTypeTable=NR.createFloatingObjectVerticalPositionTypeTable(),NR.floatingObjectVerticalPositionAlignmentTable=NR.createFloatingObjectVerticalPositionAlignmentTable(),NR.floatingObjectTextWrapTypeTable=NR.createFloatingObjectTextWrapTypeTable(),NR.floatingObjectTextWrapSideTable=NR.createFloatingObjectTextWrapSideTable(),NR.floatingObjectRelativeFromHorizontalTable=NR.createFloatingObjectRelativeFromHorizontalTable(),NR.floatingObjectRelativeFromVerticalTable=NR.createFloatingObjectRelativeFromVerticalTable(),NR.textBoxVerticalAlignmentTable=NR.createTextBoxVerticalAlignmentTable(),NR.floatingObjectCssRelativeFromHorizontalTable=NR.createFloatingObjectCssRelativeFromHorizontalTable(),NR.floatingObjectCssRelativeFromVerticalTable=NR.createFloatingObjectCssRelativeFromVerticalTable(),NR.tabAlignmentTable=NR.createTabAlignmentTable(),NR.strictTabAlignmentTable=NR.createStrictTabAlignmentTable(),NR.tabLeaderTable=NR.createTabLeaderTable(),NR.conditionalTableStyleFormattingTypesTable=NR.createConditionalTableStyleFormattingTypesTable(),NR.numberingListTypeTable=NR.createNumberingListTypeTable(),NR.listNumberSeparatorTable=NR.createListNumberSeparatorTable(),NR.listNumberAlignmentTable=NR.createListNumberAlignmentTable(),NR.schemeColorTable=NR.createSchemeColorTable(),NR.systemColorTable=NR.createSystemColorTable(),NR.noteNumberingRestartTypeTable=NR.createNoteNumberingRestartTypeTable(),NR.footNotePlacementTable=NR.createFootNotePlacementTable(),NR.noteTypeTable=NR.createNoteTypeTable(),NR.horizontalPositionTypeAttributeTable=NR.createHorizontalPositionTypeAttributeTable(),NR.verticalPositionTypeAttributeTable=NR.createVerticalPositionTypeAttributeTable();class kR{static createColorModelInfo(e,t,r,i=!1){const n=e.readerHelper.getWpEnumValue(t,"themeColor",NR.themeColorValueTable.importMap,z.None);if(n!=z.None){const r=rv.calculateThemeColorIndex(n);return r!=ce.None?he.makeByThemeColorIndex(r,kR.getTint(e,t,"themeTint","themeShade"),n):he.makeByThemeColorIndex(U.empty)}{const n=this.tryConvertAttributeToColor(e,t,r);return null!==n?he.makeByColor(n):i?null:he.makeByColor(U.empty)}}static tryConvertAttributeToColor(e,t,r){let i=U.empty;const n=e.readerHelper.readAttribute(t,r);return"auto"==n?i:(null!=n&&(i=e.readerHelper.parseColor(n,U.empty)),i==U.empty&&(i=e.readerHelper.getWpSTColorValue(t,r,U.empty)),i==U.empty?(i=e.readerHelper.getWpEnumValueCore(n,NR.predefinedBackgroundColors.importMap,U.empty),i!=U.empty?i:null):i)}static createFillInfo(e,t){const r=kR.getTint(e,t,"themeFillTint","themeFillShade"),i=e.readerHelper.getWpEnumValue(t,"themeFill",NR.themeColorValueTable.importMap,z.None);if(i!=z.None){const e=rv.calculateThemeColorIndex(i);if(e!=ce.None)return he.makeByThemeColorIndex(e,r,i)}return he.makeByColor(e.readerHelper.getWpSTColorValue(t,"fill",U.empty),r)}static getTint(e,t,r,i){const n=e.readerHelper.readAttribute(t,r);if(!rn.StringUtils.isNullOrEmpty(n))return hP.calculateTint(e.readerHelper.convertToInt(n));const o=e.readerHelper.readAttribute(t,i);return rn.StringUtils.isNullOrEmpty(o)?0:hP.modifyShadeToTint(e.readerHelper.convertToInt(o))}}class OR extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.documentModel.setPageColor(this.documentModel.cache.colorModelInfoCache.getItem(kR.createColorModelInfo(this.data,e,"color")).toRgb(this.data.documentModel.colorProvider))}))}}class _R{constructor(){this.start=-1,this.end=-1}validate(e){if(this.start<0||this.end<0)return!1;const t=e.getDocumentEndPosition();return this.start=Math.min(t,this.start),this.end=Math.min(t,this.end),this.start>this.end&&([this.start,this.end]=[this.end,this.start]),!0}}class UR extends _R{constructor(){super(...arguments),this.skipNameValidation=!1}validate(e){return(this.skipNameValidation||this.validateBookmarkName(e))&&super.validate(e)}validateBookmarkName(e){return!rn.StringUtils.isNullOrEmpty(this.name)&&f.ListUtils.allOf(e.bookmarks,(e=>e.name!=this.name))}}class HR extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t=e.getAttributeNS("id",this.data.constants.wordProcessingNamespaceConst);if(null!=t&&(t=rn.StringUtils.trim(t)),rn.StringUtils.isNullOrEmpty(t))return;let r=e.getAttributeNS("name",this.data.constants.wordProcessingNamespaceConst);rn.StringUtils.isNullOrEmpty(r)||(r=rn.StringUtils.trim(r));let i=this.data.subDocumentInfo.bookmarkImporter.bookmarks[t];i||(i=new UR,i.name=r,this.data.subDocumentInfo.bookmarkImporter.bookmarks[t]=i),this.assignBookmarkPosition(i)}))}}class VR extends HR{assignBookmarkPosition(e){e.end=this.data.subDocumentInfo.positionImporter.currPosition}}class WR extends HR{assignBookmarkPosition(e){e.start=this.data.subDocumentInfo.positionImporter.currPosition}}class zR extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("id",this.data.constants.wordProcessingNamespaceConst);if(rn.StringUtils.isNullOrEmpty(t))return;const r=this.data.subDocumentInfo.commentsImporter.comments[t];r&&this.assignCommentPosition(r)}))}}class jR extends zR{assignCommentPosition(e){const t=this.data.subDocumentInfo.positionImporter.currPosition;e.start!=t&&-1==e.end&&(e.end=t)}}class XR extends zR{assignCommentPosition(e){-1==e.start&&(e.start=this.data.subDocumentInfo.positionImporter.currPosition)}}class GR{constructor(e,t,r){this.relationId=e,this.position=t,this.subDocument=r}}class KR extends SR{get elementHandlerTable(){return{}}processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}processElementClose(e){}}class qR extends SR{get elementHandlerTable(){return qR.handlerTable}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("id",this.data.constants.relsNamespaceConst);rn.StringUtils.isNullOrEmpty(t)||(this.relId=t)}))}processElementClose(e){rn.StringUtils.isNullOrEmpty(this.relId)||(this.data.altChunkImporter.altChunkInfos.push(new GR(this.relId,this.data.subDocumentInfo.positionImporter.currPosition,this.data.subDocument)),this.data.subDocumentInfo.paragraphImporter.insertParagraph())}}qR.handlerTable=(new Eu).add("altChunkPr",(e=>new KR(e))).get();class $R extends PR{constructor(e,t){super(e),this.characterProperties=t}setProperty(e){this.characterProperties.setValue(this.getDescriptor(),e)}}class JR extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return ir.allCaps}}class YR extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return ir.bold}}class QR{static getShadingValue(e,t){const r=e.documentModel.cache.colorModelInfoCache,i=e.readerHelper.getWpEnumValue(t,"val",NR.shadingPatternTable.importMap,re.Clear),n=r.getItem(kR.createColorModelInfo(e,t,"color")),o=r.getItem(kR.createFillInfo(e,t));return e.documentModel.cache.shadingInfoCache.getItem(new fe(i,o,n))}}class ZR extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(QR.getShadingValue(this.data,e))}))}getDescriptor(){return ir.shadingInfo}}class eL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTOnOffValue(e,"val");this.setProperty(t?se.Double:se.None)}))}getDescriptor(){return ir.strikeoutType}}class tL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.readFontName(e);if(!rn.StringUtils.isNullOrEmpty(t)){const e=this.documentModel.cache.fontInfoCache.getItemByName(t);this.setProperty(e||this.documentModel.cache.fontInfoCache.addFont(t,t))}}))}getDescriptor(){return ir.fontInfo}readFontName(e){let t=e.getAttributeNS("ascii",this.data.constants.namespaces[ZD.WordProcessing].namespace);if(!rn.StringUtils.isNullOrEmpty(t))return t;const r=new AR("hAnsi","h-ansi");return t=e.getAttributeNS(r.openXmlValue,this.data.constants.namespaces[ZD.WordProcessing].namespace),rn.StringUtils.isNullOrEmpty(t)?"":t}}class rL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){switch(e.getAttributeNS("val",this.data.constants.namespaces[ZD.WordProcessing].namespace)){case"baseline":this.setProperty(ne.Normal);break;case"subscript":this.setProperty(ne.Subscript);break;case"superscript":this.setProperty(ne.Superscript)}}))}getDescriptor(){return ir.script}}class iL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val",-1);t>0&&this.setProperty(Math.max(1,t/2))}))}getDescriptor(){return ir.size}}class nL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=kR.createColorModelInfo(this.data,e,"val",!0);null!=t&&this.setProperty(this.data.documentModel.cache.colorModelInfoCache.getItem(t))}))}getDescriptor(){return ir.textColor}}class oL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return ir.hidden}}class aL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=kR.createColorModelInfo(this.data,e,"val");this.setProperty(this.data.documentModel.cache.colorModelInfoCache.getItem(t))}))}getDescriptor(){return ir.highlightColor}}class sL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return ir.italic}}class lL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.readLanguage(e))}))}getDescriptor(){return ir.langInfo}}class dL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return ir.noProof}}class cL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTOnOffValue(e,"val");this.setProperty(t?se.Single:se.None)}))}getDescriptor(){return ir.strikeoutType}}class hL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return ir.smallCaps}}class uL extends $R{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.importUnderlineType(e),this.importUnderlineColor(e)}))}getDescriptor(){return ir.underlineType}importUnderlineType(e){const t=e.getAttributeNS("val",this.data.constants.namespaces[ZD.WordProcessing].namespace);rn.StringUtils.isNullOrEmpty(t)?this.setProperty(le.None):"words"==t?(this.setProperty(le.Single),this.characterProperties.underlineWordsOnly=!0,this.characterProperties.setUseValue(ie.UseUnderlineWordsOnly,!0)):this.setProperty(NR.underlineTables.getValueOnImport(t,le.Single))}importUnderlineColor(e){const t=kR.createColorModelInfo(this.data,e,"color");this.characterProperties.underlineColor=this.data.documentModel.cache.colorModelInfoCache.getItem(t),this.characterProperties.setUseValue(ie.UseUnderlineColorIndex,!0)}}class pL extends SR{get elementHandlerTable(){return pL.handlerTable}constructor(e,t){super(e),this.characterProperties=t}static getCharacterProperties(e){return e.destinationStack.getThis().characterProperties}}pL.handlerTable=(new Eu).add("b",(e=>new YR(e,pL.getCharacterProperties(e)))).add("i",(e=>new sL(e,pL.getCharacterProperties(e)))).add("caps",(e=>new JR(e,pL.getCharacterProperties(e)))).add("smallCaps",(e=>new hL(e,pL.getCharacterProperties(e)))).add("vanish",(e=>new oL(e,pL.getCharacterProperties(e)))).add("color",(e=>new nL(e,pL.getCharacterProperties(e)))).add("highlight",(e=>new aL(e,pL.getCharacterProperties(e)))).add("shd",(e=>new ZR(e,pL.getCharacterProperties(e)))).add("strike",(e=>new cL(e,pL.getCharacterProperties(e)))).add("dstrike",(e=>new eL(e,pL.getCharacterProperties(e)))).add("u",(e=>new uL(e,pL.getCharacterProperties(e)))).add("sz",(e=>new iL(e,pL.getCharacterProperties(e)))).add("vertAlign",(e=>new rL(e,pL.getCharacterProperties(e)))).add("rFonts",(e=>new tL(e,pL.getCharacterProperties(e)))).add("lang",(e=>new lL(e,pL.getCharacterProperties(e)))).add("noProof",(e=>new dL(e,pL.getCharacterProperties(e)))).get();class gL extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst);if(!rn.StringUtils.isNullOrEmpty(t)){const e=this.data.stylesImporter.characterManager.getStyleById(t);e&&this.assignCharacterStyle(e)}}))}}class mL extends gL{assignCharacterStyle(e){this.data.subDocumentInfo.characterImporter.style=e}}class fL extends pL{constructor(e,t){super(e,t),this.data.subDocumentInfo.characterImporter.resetStyle()}get elementHandlerTable(){return fL.handlerTable}}fL.handlerTable=new Eu(B.StringMapUtils.map(pL.handlerTable,(e=>e))).add("rStyle",(e=>new mL(e))).get(),function(e){e[e.None=-1]="None",e[e.PictureFrame=75]="PictureFrame",e[e.TextBox=202]="TextBox"}(mF||(mF={}));class bL{constructor(e){this.size=new eh(!1,0,new so.Size(Bo.Constants.MIN_SAFE_INTEGER,Bo.Constants.MIN_SAFE_INTEGER),new so.Size(0,0),cc.Page,hc.Page,!0,!0),this.imageId=null,this.subDocId=-1,this.data=e,this.anchorInfo=new Jc,this.anchorInfo.wrapType=uc.None,this.anchorInfo.horizontalPositionAlignment=mc.None,this.anchorInfo.verticalPositionAlignment=bc.None,this.shape=new th,this.textBoxProperties=new ph(new jc.m(144,144,72,72)),this.constainerProperties=new rh,this.objectNonVisualProperties=new rh}insertFloatingObject(e){if(!this.isFloatingObject)return null;const t=this.data.subDocumentInfo.positionImporter.currPosition,r=this.data.subDocumentInfo.paragraphImporter.paragraph,i=this.data.subDocumentInfo.characterImporter.style,n=this.data.subDocumentInfo.characterImporter.properties;if(this.shapeType===mF.TextBox){if(this.subDocId<0)return null;const e=new sh(t,r,new pn(n,i),this.shape.clone(),this.subDocId,this.size.clone(),this.anchorInfo.clone(),-1,this.textBoxProperties.clone());return this.data.subDocumentInfo.characterImporter.addRun(e,an.specialCharacters.ObjectMark),e.containerProperties.copyFrom(this.constainerProperties),e}{if(null===this.imageId)return null;const o=e.getPictureData(this.imageId),a=new ah(t,r,new pn(n,i),new oh(new Qc(this.size.lockAspectRatio,this.size.rotation,o,new so.Size(100,100)),this.shape.clone(),this.anchorInfo.clone(),this.constainerProperties,this.objectNonVisualProperties),-1);return this.data.subDocumentInfo.characterImporter.addRun(a,an.specialCharacters.ObjectMark),this.data.formatImagesImporter.registerImageRun(new Ew(new pu(this.data.subDocument,t),Mb.initByActualSize(this.size.absoluteSize),a)),a}}}class CL extends _R{constructor(){super(...arguments),this.columnFirst=-1,this.columnLast=-1,this.userName="",this.group=""}}class SL extends PR{static createActualGroupNames(){const e={};return B.StringMapUtils.forEach(SL.predefinedGroupNames,((t,r)=>e[t]=r)),e}processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t=e.getAttributeNS("id",this.data.constants.wordProcessingNamespaceConst);if(null!=t&&(t=rn.StringUtils.trim(t)),rn.StringUtils.isNullOrEmpty(t))return;let r=this.data.subDocumentInfo.rangePermissionImporter.rangePermissions[t];r||(this.data.subDocumentInfo.rangePermissionImporter.rangePermissions[t]=r=new CL);let i=e.getAttributeNS("ed",this.data.constants.wordProcessingNamespaceConst);rn.StringUtils.isNullOrEmpty(i)||(i=rn.StringUtils.trim(i),r.userName=i);let n=e.getAttributeNS("edGrp",this.data.constants.wordProcessingNamespaceConst);rn.StringUtils.isNullOrEmpty(n)||(n=rn.StringUtils.trim(n),r.group=this.getActualGroupName(n)),this.assignRangePermissionProperties(r,e)}))}getActualGroupName(e){const t=SL.actualGroupNames[e];return void 0===t?e:t}getLastRowIndexFromTable(e){return Math.max(0,e.rows.length-1)}}SL.predefinedGroupNames=(new Eu).add("Everyone","everyone").add("Current User","current").add("Editors","editors").add("Owners","owners").add("Contributors","contributors").add("Administrators","administrators").get(),SL.actualGroupNames=SL.createActualGroupNames();class IL extends SL{assignRangePermissionProperties(e,t){if(e.end=this.data.subDocumentInfo.positionImporter.currPosition,!this.data.subDocumentInfo.tableImporter.isInsideTable&&!e.table)return;const r=this.data.subDocumentInfo.tableStack.last;this.data.subDocumentInfo.tableImporter.isInsideTable&&e.table!==r&&(e.table=r,e.firstRowIndex=0),e.lastRowIndex=this.getLastRowIndexFromTable(e.table)}}class PL extends SL{assignRangePermissionProperties(e,t){e.start=this.data.subDocumentInfo.positionImporter.currPosition,e.columnFirst=this.data.readerHelper.getWpSTIntegerValue(t,"colFirst",-1),e.columnLast=this.data.readerHelper.getWpSTIntegerValue(t,"colLast",-1),this.data.subDocumentInfo.tableImporter.isInsideTable&&(e.table=f.ListUtils.last(this.data.subDocument.tables),e.firstRowIndex=this.getLastRowIndexFromTable(e.table))}}class wL extends SR{get elementHandlerTable(){return{}}}class yL extends wL{}class xL extends wL{}class TL extends xR{processCurrentElement(e){return"sdt"==e.localName?new vL(this.data):super.processCurrentElement(e)}}class vL extends xR{processCurrentElement(e){return"sdtContent"==e.localName?new TL(this.data):super.processCurrentElement(e)}}class ML extends SR{static onBookmarkStart(e,t){return new WR(e)}static onBookmarkEnd(e,t){return new VR(e)}static onRangePermissionStart(e,t){return new PL(e)}static onRangePermissionEnd(e,t){return new IL(e)}static onCommentStart(e,t){return new XR(e)}static onCommentEnd(e,t){return new jR(e)}static onStructuredDocument(e,t){return new vL(e)}static onCustomXml(e,t){return new TR(e)}static onDeleted(e,t){return e.options.ignoreDeletedText?new yR(e):new yL(e)}static onInserted(e,t){return e.options.ignoreInsertedText?new yR(e):new xL(e)}}class EL extends SR{constructor(e,t){super(e),this.cell=t}}class DL extends wR{get border(){return this.desc.getProp(this.properties)}getColor(e){return this.data.documentModel.cache.colorModelInfoCache.getItem(kR.createColorModelInfo(this.data,e,"color"))}setBorderOffset(e){this.border.offset=g.u.pointsToTwips(e),this.properties.setValue(this.desc,this.border)}setBorderWidth(e){this.border.width=Math.round(g.u.pointsToTwipsF(.125*e)),this.properties.setValue(this.desc,this.border)}setBorderLineStyle(e){this.border.style=e==de.Nil?de.None:e,this.properties.setValue(this.desc,this.border)}}class FL extends DL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpEnumValue(e,"val",NR.borderLineStyleTable.importMap,de.None),r=this.data.readerHelper.getWpSTColorValue(e,"color"),i=this.getColor(e),n=this.data.readerHelper.getWpSTOnOffValue(e,"frame",!1),o=this.data.readerHelper.getWpSTOnOffValue(e,"shadow",!1),a=this.data.readerHelper.getWpSTIntegerValue(e,"space",0),s=this.data.readerHelper.getWpSTIntegerValue(e,"sz",0);t==de.None&&r==U.empty&&0==n&&0==o&&0==a&&0==s||(this.border.color=i,this.border.frame=n,this.border.shadow=o,this.setBorderOffset(a),this.setBorderWidth(s),this.setBorderLineStyle(t))}))}}class RL extends EL{static getProps(e){return e.destinationStack.getThis().cell.properties}get elementHandlerTable(){return RL.handlerTable}}RL.handlerTable=(new Eu).add("top",(e=>new FL(e,RL.getProps(e),hr.topBorder))).add("left",(e=>new FL(e,RL.getProps(e),hr.leftBorder))).add("start",(e=>new FL(e,RL.getProps(e),hr.leftBorder))).add("bottom",(e=>new FL(e,RL.getProps(e),hr.bottomBorder))).add("right",(e=>new FL(e,RL.getProps(e),hr.rightBorder))).add("end",(e=>new FL(e,RL.getProps(e),hr.rightBorder))).add("insideH",(e=>null)).add("insideV",(e=>null)).add("tl2br",(e=>new FL(e,RL.getProps(e),hr.topLeftDiagonalBorder))).add("tr2bl",(e=>new FL(e,RL.getProps(e),hr.topRightDiagonalBorder))).get();class LL extends PR{constructor(e,t,r){super(e),this.widthUnit=t,this.setMaskTrue=r}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpEnumValue(e,"type",NR.widthUnitTypesTable.importMap,Je.Auto),r=this.data.readerHelper.getWpSTIntegerValue(e,"w");this.isValid(r)?(this.widthUnit.type=t,this.widthUnit.value=r):this.widthUnit.type=Je.Auto,this.setMaskTrue()}))}isValid(e){return e!=Bo.Constants.MIN_SAFE_INTEGER}}class BL extends LL{isValid(e){return super.isValid(e)&&e>=0}}class AL extends SR{constructor(e,t,r){super(e),this.descriptors=r,this.properties=t}get elementHandlerTable(){return(new Eu).add("top",this.getHandler(this.descriptors.top)).add("left",this.getHandler(this.descriptors.left)).add("start",this.getHandler(this.descriptors.left)).add("bottom",this.getHandler(this.descriptors.bottom)).add("right",this.getHandler(this.descriptors.right)).add("end",this.getHandler(this.descriptors.right)).get()}getHandler(e){const t=this.properties;return r=>new LL(r,e.getProp(t),(()=>t.setValue(e,e.getProp(t))))}}class NL extends EL{get elementHandlerTable(){return{}}}class kL extends NL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val");t!=Bo.Constants.MIN_SAFE_INTEGER&&0!=t&&(this.cell.columnSpan=t)}))}}class OL extends NL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst);rn.StringUtils.isNullOrEmpty(t)||(this.cell.conditionalFormatting=parseInt(t,2))}))}}class _L extends NL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.cell.properties.setValue(hr.fitText,this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}}class UL extends NL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.cell.properties.setValue(hr.hideCellMark,this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}}class HL extends NL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.cell.properties.setValue(hr.noWrap,this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}}class VL extends NL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.cell.properties.setValue(hr.shadingInfo,QR.getShadingValue(this.data,e))}))}}class WL extends NL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.cell.properties.setValue(hr.textDirection,this.data.readerHelper.getWpEnumValue(e,"val",NR.textDirectionTable.importMap,Ge.LeftToRightTopToBottom))}))}}class zL extends NL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.cell.properties.setValue(hr.vertivalAlignment,this.data.readerHelper.getWpEnumValue(e,"val",NR.verticalAlignmentTable.importMap,Ke.Top))}))}}class jL extends NL{processElementClose(e){this.cell.verticalMerging=this.data.readerHelper.getWpEnumValue(e,"val",NR.mergingStateTable.importMap,Xe.Continue)}}class XL extends SR{get elementHandlerTable(){return XL.handlerTable}constructor(e,t){super(e),this.cell=t}static getThis(e){return e.destinationStack.getThis()}}XL.handlerTable=(new Eu).add("tcW",(e=>new BL(e,XL.getThis(e).cell.preferredWidth,(()=>{})))).add("tcBorders",(e=>new RL(e,XL.getThis(e).cell))).add("vMerge",(e=>new jL(e,XL.getThis(e).cell))).add("gridSpan",(e=>new kL(e,XL.getThis(e).cell))).add("shd",(e=>new VL(e,XL.getThis(e).cell))).add("tcMar",(e=>new AL(e,XL.getThis(e).cell.properties,{top:hr.topMargin,right:hr.rightMargin,bottom:hr.bottomMargin,left:hr.leftMargin}))).add("tcFitText",(e=>new _L(e,XL.getThis(e).cell))).add("noWrap",(e=>new HL(e,XL.getThis(e).cell))).add("hideMark",(e=>new UL(e,XL.getThis(e).cell))).add("textDirection",(e=>new WL(e,XL.getThis(e).cell))).add("vAlign",(e=>new zL(e,XL.getThis(e).cell))).add("cnfStyle",(e=>new OL(e,XL.getThis(e).cell))).get();class GL extends PR{constructor(e,t){super(e),this.cell=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst),r=this.data.stylesImporter.tableCellStyles[t];r&&(this.cell.style=r)}))}}class KL extends XL{get elementHandlerTable(){return KL.handlerTable}}KL.handlerTable=new Eu(XL.handlerTable).add("tblCStyle",(e=>new GL(e,e.destinationStack.getThis().cell))).get();class qL extends SR{get elementHandlerTable(){return qL.handlerTable}constructor(e,t){super(e),this.startParagraph=this.data.subDocumentInfo.paragraphImporter.paragraph,this.cell=new Rd(t,this.data.subDocumentInfo.tableImporter.createDefaultCellProperties()),this.paragraphRequired=!0}static getThis(e){return e.destinationStack.getThis()}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.cell.startParagraphPosition=this.data.subDocumentInfo.subDocument.positionManager.registerPosition(this.data.subDocumentInfo.paragraphImporter.paragraph.startLogPosition.value),this.cell.parentRow.cells.push(this.cell)}))}processElementClose(e){this.paragraphRequired&&(this.endParagraph=this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.paragraphImporter.insertParagraph()),this.cell.endParagrapPosition=this.data.subDocumentInfo.subDocument.positionManager.registerPosition(f.ListUtils.last(this.data.subDocumentInfo.subDocument.paragraphs).getEndPosition())}}qL.handlerTable=(new Eu).add("p",(e=>{const t=qL.getThis(e);return t.endParagraph=e.subDocumentInfo.paragraphImporter.paragraph,t.paragraphRequired=!1,new oO(e)})).add("tbl",(e=>{const t=qL.getThis(e);return t.paragraphRequired=!0,new TB(e,t.cell)})).add("tcPr",(e=>new KL(e,qL.getThis(e).cell))).add("bookmarkStart",(e=>new WR(e))).add("bookmarkEnd",(e=>new VR(e))).add("permStart",(e=>new PL(e))).add("permEnd",(e=>new IL(e))).add("sdt",(e=>new vL(e))).add("customXml",(e=>new TR(e))).add("altChunk",(e=>{const t=qL.getThis(e);return t.endParagraph=e.subDocumentInfo.paragraphImporter.paragraph,t.paragraphRequired=!1,new qR(e)})).add("del",(e=>e.options.ignoreDeletedText?new yR(e):new yL(e))).add("ins",(e=>e.options.ignoreInsertedText?new yR(e):new xL(e))).get();class $L extends SR{get elementHandlerTable(){return{}}constructor(e,t,r){super(e),this.table=t,this.tableProperties=r}static getProperties(e){return e.destinationStack.getThis().tableProperties}}class JL extends DL{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpEnumOnOffNullValue(e,"val",NR.borderLineStyleTable.importMap);null!=t&&this.setBorderLineStyle(t);null!=this.data.readerHelper.getWpSTColorOrNullValue(e,"color")&&(this.border.color=this.getColor(e),this.properties.setValue(this.desc,this.border));const r=this.data.readerHelper.getWpSTOnOffNullValue(e,"frame");null!=r&&(this.border.frame=r,this.properties.setValue(this.desc,this.border));const i=this.data.readerHelper.getWpSTOnOffNullValue(e,"shadow");null!=i&&(this.border.shadow=i,this.properties.setValue(this.desc,this.border));const n=this.data.readerHelper.getWpSTIntegerValue(e,"space",Bo.Constants.MIN_SAFE_INTEGER);n!=Bo.Constants.MIN_SAFE_INTEGER&&this.setBorderOffset(n);const o=this.data.readerHelper.getWpSTIntegerValue(e,"sz",Bo.Constants.MIN_SAFE_INTEGER);o!=Bo.Constants.MIN_SAFE_INTEGER&&this.setBorderWidth(o)}))}}class YL extends $L{static getProps(e){return e.destinationStack.getThis().tableProperties}get elementHandlerTable(){return YL.handlerTable}}YL.handlerTable=(new Eu).add("top",(e=>new JL(e,YL.getProps(e),fr.topBorder))).add("left",(e=>new JL(e,YL.getProps(e),fr.leftBorder))).add("start",(e=>new JL(e,YL.getProps(e),fr.leftBorder))).add("bottom",(e=>new JL(e,YL.getProps(e),fr.bottomBorder))).add("right",(e=>new JL(e,YL.getProps(e),fr.rightBorder))).add("end",(e=>new JL(e,YL.getProps(e),fr.rightBorder))).add("insideH",(e=>new JL(e,YL.getProps(e),fr.insideHorizontalBorder))).add("insideV",(e=>new JL(e,YL.getProps(e),fr.insideVerticalBorder))).get();class QL extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.tableProperties.setValue(fr.rowAlignment,this.data.readerHelper.getWpEnumValue(e,"val",NR.tableRowAlignmentTable.importMap,je.Left))}))}}class ZL extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.tableProperties.setValue(fr.avoidDoubleBorders,this.data.readerHelper.getWpSTOnOffValue(e,"val",!1))}))}}class eB extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.tableProperties.setValue(fr.layoutType,this.data.readerHelper.getWpEnumValue(e,"type",NR.tableLayoutTypeTable.importMap,Oe.Autofit))}))}}class tB extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val",Bo.Constants.MIN_SAFE_INTEGER,16);t!=Bo.Constants.MIN_SAFE_INTEGER&&(this.table.lookTypes=t)}))}}class rB extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}}class iB extends SR{constructor(e,t){super(e),this.properties=t}}class nB extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}}class oB extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val");t!=Bo.Constants.MIN_SAFE_INTEGER&&this.tableProperties.setValue(fr.styleColumnBandSize,t)}))}}class aB extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val");t!=Bo.Constants.MIN_SAFE_INTEGER&&this.tableProperties.setValue(fr.styleRowBandSize,t)}))}}class sB extends $L{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.tableProperties.setValue(fr.shadingInfo,QR.getShadingValue(this.data,e))}))}}class lB extends iB{get elementHandlerTable(){return lB.handlerTable}constructor(e,t,r){super(e,r),this.table=t,this.tableProperties=r}static getThis(e){return e.destinationStack.getThis()}static getProperties(e){return lB.getThis(e).tableProperties}}lB.handlerTable=(new Eu).add("tblW",(e=>new BL(e,lB.getThis(e).table.preferredWidth,(()=>{})))).add("tblpPr",(e=>null)).add("tblInd",(e=>{const t=lB.getProperties(e);return new LL(e,t.indent,(()=>{t.setUseValue(ur.UseTableIndent,!0)}))})).add("tblLook",(e=>new tB(e,lB.getThis(e).table,lB.getProperties(e)))).add("tblBorders",(e=>new YL(e,lB.getThis(e).table,lB.getThis(e).properties))).add("tblCellMar",(e=>new AL(e,lB.getProperties(e),{top:fr.topMargin,right:fr.rightMargin,bottom:fr.bottomMargin,left:fr.leftMargin}))).add("tblCellSpacing",(e=>{const t=lB.getProperties(e);return new BL(e,t.cellSpacing,(()=>t.setUseValue(ur.UseCellSpacing,!0)))})).add("tblLayout",(e=>new eB(e,lB.getThis(e).table,lB.getProperties(e)))).add("tblOverlap",(e=>new rB(e,lB.getThis(e).table,lB.getProperties(e)))).add("tblStyleColBandSize",(e=>new oB(e,lB.getThis(e).table,lB.getProperties(e)))).add("tblStyleRowBandSize",(e=>new aB(e,lB.getThis(e).table,lB.getProperties(e)))).add("shd",(e=>new sB(e,lB.getThis(e).table,lB.getProperties(e)))).add("jc",(e=>new QL(e,lB.getThis(e).table,lB.getProperties(e)))).add("adb",(e=>new ZL(e,lB.getThis(e).table,lB.getProperties(e)))).add("bidiVisual",(e=>new nB(e,lB.getThis(e).table,lB.getProperties(e)))).get();class dB extends PR{constructor(e,t){super(e),this.setter=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t=e.getAttributeNS("val",e.namespaceURI);null==t&&(t=e.getAttribute("val")),rn.StringUtils.isNullOrEmpty(t)||this.setter(t)}))}}class cB extends PR{constructor(e,t){super(e),this.heightUnit=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpEnumValue(e,"hRule",NR.heightUnitTypeTable.importMap,$e.Minimum);this.heightUnit.type=t;const r=this.data.readerHelper.getWpSTIntegerValue(e,"val");r!=Bo.Constants.MIN_SAFE_INTEGER&&(this.heightUnit.value=r)}))}}class hB extends SR{constructor(e,t){super(e),this.row=t}get elementHandlerTable(){return{}}}class uB extends hB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.row.properties.setValue(fx.rowAlignment,this.data.readerHelper.getWpEnumValue(e,"val",(this.data.constants.strictMode?NR.strictTableRowAlignmentTable:NR.tableRowAlignmentTable).importMap,je.Left))}))}}class pB extends hB{processElementClose(e){this.row.properties.setValue(fx.cantSplit,this.data.readerHelper.getWpSTOnOffValue(e,"val",!0))}}class gB extends hB{}class mB extends hB{processElementClose(e){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val");t!=Bo.Constants.MIN_SAFE_INTEGER&&(this.row.gridAfter=Math.max(0,t))}}class fB extends hB{processElementClose(e){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val");t!=Bo.Constants.MIN_SAFE_INTEGER&&(this.row.gridBefore=Math.max(0,t))}}class bB extends hB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.row.properties.setValue(fx.header,this.data.readerHelper.getWpSTOnOffValue(e,"val",!0))}))}}class CB extends hB{processElementClose(e){this.row.properties.setValue(fx.hideCellMark,this.data.readerHelper.getWpSTOnOffValue(e,"val"))}}class SB extends SR{get elementHandlerTable(){return SB.handlerTable}constructor(e,t){super(e),this.row=t}static getThis(e){return e.destinationStack.getThis()}}SB.handlerTable=(new Eu).add("cantSplit",(e=>new pB(e,SB.getThis(e).row))).add("gridAfter",(e=>new mB(e,SB.getThis(e).row))).add("gridBefore",(e=>new fB(e,SB.getThis(e).row))).add("hidden",(e=>new CB(e,SB.getThis(e).row))).add("jc",(e=>new uB(e,SB.getThis(e).row))).add("tblCellSpacing",(e=>{const t=SB.getThis(e).row.properties;return new BL(e,t.cellSpacing,(()=>t.setUseValue(Ua.UseCellSpacing,!0)))})).add("tblHeader",(e=>new bB(e,SB.getThis(e).row))).add("trHeight",(e=>new cB(e,SB.getThis(e).row.height))).add("wBefore",(e=>new LL(e,SB.getThis(e).row.widthBefore,(()=>{})))).add("wAfter",(e=>new LL(e,SB.getThis(e).row.widthAfter,(()=>{})))).add("cnfStyle",(e=>new gB(e,SB.getThis(e).row))).add("divId",(e=>new dB(e,(t=>{const r=parseInt(t,10),i=e.documentModel.webSettings;i.id==r&&i.isBodyMarginsSet()&&SB.getThis(e).row.properties.setValue(fx.divId,r)})))).get();class IB extends SR{get elementHandlerTable(){return IB.handlerTable}constructor(e,t){super(e),this.row=new Ld(t,this.data.subDocumentInfo.tableImporter.createDefaultRowProperties())}static getThis(e){return e.destinationStack.getThis()}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.row.parentTable.rows.push(this.row)}))}}IB.handlerTable=(new Eu).add("tc",(e=>new qL(e,IB.getThis(e).row))).add("trPr",(e=>new SB(e,IB.getThis(e).row))).add("tblPrEx",(e=>new lB(e,IB.getThis(e).row.parentTable,IB.getThis(e).row.tablePropertiesException))).add("sdt",(e=>new vL(e))).add("customXml",(e=>new TR(e))).add("del",(e=>e.options.ignoreDeletedText?new yR(e):new yL(e))).add("ins",(e=>e.options.ignoreInsertedText?new yR(e):new xL(e))).add("bookmarkStart",(e=>new WR(e))).add("bookmarkEnd",(e=>new VR(e))).add("permStart",(e=>new PL(e))).add("permEnd",(e=>new IL(e))).get();class PB extends PR{constructor(e,t){super(e),this.table=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst),r=this.data.stylesImporter.tableManager.getStyleById(t);r&&(this.table.style=r)}))}}class wB extends lB{get elementHandlerTable(){return wB.handlerTable}constructor(e,t){super(e,t,t.properties)}static getThis(e){return e.destinationStack.getThis()}}wB.handlerTable=new Eu(lB.handlerTable).add("tblStyle",(e=>new PB(e,wB.getThis(e).table))).get();class yB extends SR{constructor(e,t){super(e),this.tableGrid=t}get elementHandlerTable(){return{}}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.tableGrid.push(this.data.readerHelper.getWpSTIntegerValue(e,"w"))}))}}class xB extends SR{constructor(e,t){super(e),this.tableGrid=t}get elementHandlerTable(){return xB.handlerTable}}xB.handlerTable=(new Eu).add("gridCol",(e=>new yB(e,e.destinationStack.getThis().tableGrid))).get();class TB extends SR{get elementHandlerTable(){return TB.handlerTable}constructor(e,t=null){super(e),this.table=new Ja(this.data.subDocumentInfo.tableImporter.createDefaultTableProperties(),this.data.documentModel.stylesManager.getDefaultTableStyle()),this.table.nestedLevel=this.data.subDocumentInfo.tableStack.count,this.table.parentCell=t,this.tableGrid=[]}static getThis(e){return e.destinationStack.getThis()}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.subDocument.tables.push(this.table),this.data.subDocumentInfo.tableStack.push(this.table)}))}processElementClose(e){if(!this.table.rows.length)return this.data.subDocumentInfo.tableImporter.cancelTable(this.table);this.table.properties.layoutType==Oe.Fixed&&this.tableGrid.length>0&&this.ensureTableCellsWidth(this.table),this.data.subDocumentInfo.tableStack.pop(),ac.updateTableWithoutHistory(this.data.documentModel,this.table)}ensureTableCellsWidth(e){for(const t of e.rows){let e=0;const r=t.cells.length;f.ListUtils.forEach(t.cells,((t,i)=>{const n=r-i-1,o=this.tableGrid.length-e-n,a=Math.min(o,t.columnSpan),s=t.preferredWidth;I.Y.isAnyOf(s.type,Je.Nil,Je.Auto)&&(s.value=f.ListUtils.accumulateNumber(this.tableGrid,(e=>e),0,e,e+a),s.type=Je.ModelUnits),e+=a}))}}}TB.handlerTable=(new Eu).add("tr",(e=>new IB(e,TB.getThis(e).table))).add("tblPr",(e=>new wB(e,TB.getThis(e).table))).add("sdt",(e=>new vL(e))).add("customXml",(e=>new TR(e))).add("tblGrid",(e=>new xB(e,TB.getThis(e).tableGrid))).add("del",(e=>e.options.ignoreDeletedText?new yR(e):new yL(e))).add("ins",(e=>e.options.ignoreInsertedText?new yR(e):new xL(e))).add("bookmarkStart",(e=>new WR(e))).add("bookmarkEnd",(e=>new VR(e))).add("permStart",(e=>new PL(e))).add("permEnd",(e=>new IL(e))).get();class vB extends SR{get elementHandlerTable(){return{}}constructor(e,t){super(e),this.offset=Number.MIN_VALUE,this.percentOffset=Number.MIN_VALUE,this.anchorDestination=t}static getThis(e){return e.destinationStack.getThis()}static onPositionOffset(e,t){return new DB(e,vB.getThis(e))}static onPositionPercentOffset(e,t){return new FB(e,vB.getThis(e))}processElementClose(e){this.anchorDestination.useSimplePosition||this.processElementCloseCore(e)}processElementCloseCore(e){throw new Error("not implemented")}}class MB extends vB{get elementHandlerTable(){return MB.handlerTable}constructor(e,t){super(e,t)}static getThis(e){return e.destinationStack.getThis()}static onHorizontalAlignment(e,t){return new RB(e,MB.getThis(e))}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("relativeFrom");this.relativeTo=this.data.readerHelper.getWpEnumValueCore(t,NR.floatingObjectHorizontalPositionTypeTable.importMap,gc.Page)}))}processElementCloseCore(e){const t=this.anchorDestination.floatingObject,r=t.offset.clone();r.x=this.anchorDestination.convertEmuToDocumentUnits(this.offset),this.offset!=Number.MIN_VALUE&&(t.offset=r);const i=t.percentOffset.clone();i.x=this.percentOffset,this.percentOffset!=Number.MIN_VALUE&&(t.percentOffset=i),null!=this.alignment&&t.horizontalPositionAlignment!=this.alignment&&(t.horizontalPositionAlignment=this.alignment),t.horizontalPositionType!=this.relativeTo&&(t.horizontalPositionType=this.relativeTo)}}MB.handlerTable=(new Eu).add("posOffset",MB.onPositionOffset).add("pctPosHOffset",MB.onPositionPercentOffset).add("align",MB.onHorizontalAlignment).get();class EB extends vB{get elementHandlerTable(){return EB.handlerTable}constructor(e,t){super(e,t)}static getThis(e){return e.destinationStack.getThis()}static onVerticalAlignment(e,t){return new LB(e,EB.getThis(e))}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("relativeFrom");this.relativeTo=this.data.readerHelper.getWpEnumValueCore(t,NR.floatingObjectVerticalPositionTypeTable.importMap,fc.Page)}))}processElementCloseCore(e){const t=this.anchorDestination.floatingObject,r=t.offset.clone();r.y=this.anchorDestination.convertEmuToDocumentUnits(this.offset),this.offset!=Number.MIN_VALUE&&(t.offset=r);const i=t.percentOffset.clone();i.y=this.percentOffset,this.percentOffset!=Number.MIN_VALUE&&(t.percentOffset=i),null!=this.alignment&&t.verticalPositionAlignment!=this.alignment&&(t.verticalPositionAlignment=this.alignment),t.verticalPositionType!=this.relativeTo&&(t.verticalPositionType=this.relativeTo)}}EB.handlerTable=(new Eu).add("posOffset",EB.onPositionOffset).add("pctPosVOffset",EB.onPositionPercentOffset).add("align",EB.onVerticalAlignment).get();class DB extends PR{constructor(e,t){super(e),this.positionDestination=t}processText(e){return this.positionDestination.offset=this.data.readerHelper.getIntegerValueCore(e.value,0),!0}}class FB extends PR{constructor(e,t){super(e),this.positionDestination=t}processText(e){const t=e.value;return rn.StringUtils.isNullOrEmpty(t)||(this.positionDestination.percentOffset=this.data.readerHelper.getIntegerValueCore(t,0)),!0}}class RB extends PR{constructor(e,t){super(e),this.positionDestination=t}processText(e){const t=e.value;return rn.StringUtils.isNullOrEmpty(t)||(this.positionDestination.alignment=this.data.readerHelper.getWpEnumValueCore(t,NR.floatingObjectHorizontalPositionAlignmentTable.importMap,mc.Left)),!0}}class LB extends PR{constructor(e,t){super(e),this.positionDestination=t}processText(e){const t=e.value;return rn.StringUtils.isNullOrEmpty(t)||(this.positionDestination.alignment=this.data.readerHelper.getWpEnumValueCore(t,NR.floatingObjectVerticalPositionAlignmentTable.importMap,bc.Top)),!0}}class BB extends SR{constructor(e,t){super(e),this.value=1e5,this.anchorDestination=t}static getThis(e){return e.destinationStack.getThis()}processElementClose(e){return YD(this,void 0,void 0,(function*(){this.processElementCloseCore(e)}))}processElementCloseCore(e){throw new Error("not implemented")}}class AB extends BB{get elementHandlerTable(){return AB.handlerTable}constructor(e,t){super(e,t)}static getThis(e){return e.destinationStack.getThis()}static onPictureWidth(e,t){return new kB(e,AB.getThis(e))}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("relativeFrom");this.relativeFrom=this.data.readerHelper.getWpEnumValueCore(t,NR.floatingObjectRelativeFromHorizontalTable.importMap,cc.Page)}))}processElementCloseCore(e){const t=this.anchorDestination.floatingObjectImportInfo.size;t.relativeWidthType=this.relativeFrom,t.relativeSize.width=this.value,this.value>0&&t.setUseAbsoluteWidth(!1)}}AB.handlerTable=(new Eu).add("pctWidth",AB.onPictureWidth).get();class NB extends BB{get elementHandlerTable(){return NB.handlerTable}constructor(e,t){super(e,t)}static getThis(e){return e.destinationStack.getThis()}static onPictureHeight(e,t){return new kB(e,NB.getThis(e))}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("relativeFrom");this.relativeFrom=this.data.readerHelper.getWpEnumValueCore(t,NR.floatingObjectRelativeFromVerticalTable.importMap,hc.Page)}))}processElementCloseCore(e){const t=this.anchorDestination.floatingObjectImportInfo.size;t.relativeHeightType=this.relativeFrom,t.relativeSize.height=this.value,this.value>0&&t.setUseAbsoluteHeight(!1)}}NB.handlerTable=(new Eu).add("pctHeight",NB.onPictureHeight).get();class kB extends PR{constructor(e,t){super(e),this.sizeDestination=t}processText(e){const t=e.value;return rn.StringUtils.isNullOrEmpty(t)||(this.sizeDestination.value=this.data.readerHelper.getIntegerValueCore(t,1e5)),!0}}class OB extends PR{constructor(e,t){super(e),this.anchorDestination=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.anchorDestination.floatingObject.wrapType=uc.None}))}}class _B extends PR{constructor(e,t){super(e),this.anchorDestination=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.anchorDestination.floatingObject.wrapType=uc.TopAndBottom}))}}class UB extends PR{constructor(e,t){super(e),this.anchorDestination=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("wrapText");rn.StringUtils.isNullOrEmpty(t)||(this.anchorDestination.floatingObject.wrapSide=this.data.readerHelper.getWpEnumValueCore(t,NR.floatingObjectTextWrapSideTable.importMap,pc.Both))}))}}class HB extends UB{constructor(e,t){super(e,t)}processElementOpen(e){const t=Object.create(null,{processElementOpen:{get:()=>super.processElementOpen}});return YD(this,void 0,void 0,(function*(){t.processElementOpen.call(this,e),this.anchorDestination.floatingObject.wrapType=uc.Square}))}}class VB extends UB{constructor(e,t){super(e,t)}processElementOpen(e){const t=Object.create(null,{processElementOpen:{get:()=>super.processElementOpen}});return YD(this,void 0,void 0,(function*(){t.processElementOpen.call(this,e),this.anchorDestination.floatingObject.wrapType=uc.Through}))}}class WB extends UB{constructor(e,t){super(e,t)}processElementOpen(e){const t=Object.create(null,{processElementOpen:{get:()=>super.processElementOpen}});return YD(this,void 0,void 0,(function*(){t.processElementOpen.call(this,e),this.anchorDestination.floatingObject.wrapType=uc.Tight}))}}class zB extends SR{get elementHandlerTable(){return zB.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t}static OnNonVisualDrawingProperties(e,t){const r=zB.getThis(e).floatingObjectImportInfo;return new aN(e,r,r.objectNonVisualProperties)}static getThis(e){return e.destinationStack.getThis()}}zB.handlerTable=(new Eu).add("cNvPr",zB.OnNonVisualDrawingProperties).get();class jB extends PR{constructor(e,t){super(e),this.color=t}getIntegerValue(e){return this.data.readerHelper.getIntegerValue(e,"val",Bo.Constants.MIN_SAFE_INTEGER)}}class XB extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new Sp(this.getIntegerValue(e)))}))}}class GB extends Cp{clone(){return new GB(this.value)}applyTransform(e){const t=this.toDoubleValue(w.i.getAlpha(e))*this.value/_.ThousandthOfPercentage;return U.fromArgb(this.toIntValue(t),e)}}class KB extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new GB(this.getIntegerValue(e)))}))}}class qB extends Cp{clone(){return new qB(this.value)}applyTransform(e){const t=this.toDoubleValue(w.i.getAlpha(e))+this.value/_.ThousandthOfPercentage;return U.fromArgb(this.toIntValue(t),e)}}class $B extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new qB(this.getIntegerValue(e)))}))}}class JB extends Cp{clone(){return new JB(this.value)}applyTransform(e){return U.fromRgb(w.i.getRed(e),w.i.getGreen(e),this.getRGBFromValue())}}class YB extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new JB(this.getIntegerValue(e)))}))}}class QB extends Cp{clone(){return new QB(this.value)}applyTransform(e){return U.fromRgb(w.i.getRed(e),w.i.getGreen(e),this.applyRGBModulation(w.i.getBlue(e)))}}class ZB extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new QB(this.getIntegerValue(e)))}))}}class eA extends Cp{clone(){return new eA(this.value)}applyTransform(e){return U.fromRgb(w.i.getRed(e),w.i.getGreen(e),this.applyRGBOffset(w.i.getBlue(e)))}}class tA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new eA(this.getIntegerValue(e)))}))}}class rA extends bp{clone(){return new rA}applyTransform(e){return H.fromColorRGB(e).getComplementColor().toRgb()}equals(e){return e&&e instanceof rA}}class iA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new rA)}))}}class nA extends bp{clone(){return new nA}applyTransform(e){return this.applyDefaultGamma(e)}equals(e){return e&&e instanceof nA}}class oA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new nA)}))}}class aA extends bp{clone(){return new aA}applyTransform(e){const t=Math.round(.3*w.i.getRed(e)+.59*w.i.getGreen(e)+.11*w.i.getBlue(e)+.5);return U.fromRgb(t,t,t)}equals(e){return e&&e instanceof aA}}class sA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new aA)}))}}class lA extends Cp{clone(){return new lA(this.value)}applyTransform(e){return U.fromRgb(w.i.getRed(e),this.getRGBFromValue(),w.i.getBlue(e))}}class dA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new lA(this.getIntegerValue(e)))}))}}class cA extends Cp{clone(){return new cA(this.value)}applyTransform(e){return U.fromRgb(w.i.getRed(e),this.applyRGBModulation(w.i.getGreen(e)),w.i.getBlue(e))}}class hA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new cA(this.getIntegerValue(e)))}))}}class uA extends Cp{clone(){return new uA(this.value)}applyTransform(e){return U.fromRgb(w.i.getRed(e),this.applyRGBOffset(w.i.getGreen(e)),w.i.getBlue(e))}}class pA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new uA(this.getIntegerValue(e)))}))}}class gA extends Cp{clone(){return new gA(this.value)}applyTransform(e){return H.fromColorRGB(e).applyHue(this.value).toRgb()}}class mA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new gA(this.getIntegerValue(e)))}))}}class fA extends Cp{clone(){return new fA(this.value)}applyTransform(e){return H.fromColorRGB(e).applyHueMod(this.value).toRgb()}}class bA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new fA(this.getIntegerValue(e)))}))}}class CA extends Cp{clone(){return new CA(this.value)}applyTransform(e){return H.fromColorRGB(e).applyHueOffset(this.value).toRgb()}}class SA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new CA(this.getIntegerValue(e)))}))}}class IA extends bp{clone(){return new IA}applyTransform(e){const t=this.toIntValue(this.applyDefaultGamma(1-this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getRed(e))))),r=this.toIntValue(this.applyDefaultGamma(1-this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getGreen(e))))),i=this.toIntValue(this.applyDefaultGamma(1-this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getBlue(e)))));return U.fromRgb(t,r,i)}equals(e){return e&&e instanceof IA}}class PA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new IA)}))}}class wA extends bp{clone(){return new wA}applyTransform(e){return this.applyInverseDefaultGamma(e)}equals(e){return e&&e instanceof wA}}class yA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new wA)}))}}class xA extends Cp{clone(){return new xA(this.value)}applyTransform(e){return H.fromColorRGB(e).applyLuminance(this.value).toRgb()}}class TA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new xA(this.getIntegerValue(e)))}))}}class vA extends Cp{clone(){return new vA(this.value)}applyTransform(e){return H.fromColorRGB(e).applyLuminanceMod(this.value).toRgb()}}class MA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new vA(this.getIntegerValue(e)))}))}}class EA extends Cp{clone(){return new EA(this.value)}applyTransform(e){return H.fromColorRGB(e).applyLuminanceOffset(this.value).toRgb()}}class DA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new EA(this.getIntegerValue(e)))}))}}class FA extends Cp{clone(){return new FA(this.value)}applyTransform(e){return U.fromRgb(this.getRGBFromValue(),w.i.getGreen(e),w.i.getBlue(e))}}class RA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new FA(this.getIntegerValue(e)))}))}}class LA extends Cp{clone(){return new LA(this.value)}applyTransform(e){return U.fromRgb(this.applyRGBModulation(w.i.getRed(e)),w.i.getGreen(e),w.i.getBlue(e))}}class BA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new LA(this.getIntegerValue(e)))}))}}class AA extends Cp{clone(){return new AA(this.value)}applyTransform(e){return U.fromRgb(this.applyRGBOffset(w.i.getRed(e)),w.i.getGreen(e),w.i.getBlue(e))}}class NA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new AA(this.getIntegerValue(e)))}))}}class kA extends Cp{clone(){return new kA(this.value)}applyTransform(e){return H.fromColorRGB(e).applySaturation(this.value).toRgb()}}class OA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new kA(this.getIntegerValue(e)))}))}}class _A extends Cp{clone(){return new _A(this.value)}applyTransform(e){return H.fromColorRGB(e).applySaturationMod(this.value).toRgb()}}class UA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new _A(this.getIntegerValue(e)))}))}}class HA extends Cp{clone(){return new HA(this.value)}applyTransform(e){return H.fromColorRGB(e).applySaturationOffset(this.value).toRgb()}}class VA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new HA(this.getIntegerValue(e)))}))}}class WA extends Cp{clone(){return new WA(this.value)}applyTransform(e){const t=this.value/_.ThousandthOfPercentage,r=this.applyRGBModulationCore(w.i.getRed(e),t),i=this.applyRGBModulationCore(w.i.getGreen(e),t),n=this.applyRGBModulationCore(w.i.getBlue(e),t);return U.fromRgb(r,i,n)}}class zA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new WA(this.getIntegerValue(e)))}))}}class jA extends Cp{clone(){return new jA(this.value)}applyTransform(e){const t=1-this.value/_.ThousandthOfPercentage,r=this.toIntValue(this.applyDefaultGamma(this.applyTintCore(this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getRed(e))),t))),i=this.toIntValue(this.applyDefaultGamma(this.applyTintCore(this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getGreen(e))),t))),n=this.toIntValue(this.applyDefaultGamma(this.applyTintCore(this.applyInverseDefaultGamma(this.toDoubleValue(w.i.getBlue(e))),t)));return U.fromRgb(r,i,n)}applyTintCore(e,t){return t>0?e*(1-t)+t:e*(1+t)}}class XA extends jB{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.transforms.add(new jA(this.getIntegerValue(e)))}))}}class GA extends SR{get elementHandlerTable(){return GA.handlerTable}constructor(e,t){super(e),this.color=t,this.colorModelInfo=new Bn}static getThis(e){return e.destinationStack.getThis()}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setColorPropertyValue(e)}))}processElementClose(e){this.color.color=this.colorModelInfo}}GA.handlerTable=(new Eu).add("alpha",(e=>new XB(e,GA.getThis(e).color))).add("alphaMod",(e=>new KB(e,GA.getThis(e).color))).add("alphaOff",(e=>new $B(e,GA.getThis(e).color))).add("blue",(e=>new YB(e,GA.getThis(e).color))).add("blueMod",(e=>new ZB(e,GA.getThis(e).color))).add("blueOff",(e=>new tA(e,GA.getThis(e).color))).add("comp",(e=>new iA(e,GA.getThis(e).color))).add("gamma",(e=>new oA(e,GA.getThis(e).color))).add("gray",(e=>new sA(e,GA.getThis(e).color))).add("green",(e=>new dA(e,GA.getThis(e).color))).add("greenMod",(e=>new hA(e,GA.getThis(e).color))).add("greenOff",(e=>new pA(e,GA.getThis(e).color))).add("hue",(e=>new mA(e,GA.getThis(e).color))).add("hueMod",(e=>new bA(e,GA.getThis(e).color))).add("hueOff",(e=>new SA(e,GA.getThis(e).color))).add("inv",(e=>new PA(e,GA.getThis(e).color))).add("invGamma",(e=>new yA(e,GA.getThis(e).color))).add("lum",(e=>new TA(e,GA.getThis(e).color))).add("lumMod",(e=>new MA(e,GA.getThis(e).color))).add("lumOff",(e=>new DA(e,GA.getThis(e).color))).add("red",(e=>new RA(e,GA.getThis(e).color))).add("redMod",(e=>new BA(e,GA.getThis(e).color))).add("redOff",(e=>new NA(e,GA.getThis(e).color))).add("sat",(e=>new OA(e,GA.getThis(e).color))).add("satMod",(e=>new UA(e,GA.getThis(e).color))).add("satOff",(e=>new VA(e,GA.getThis(e).color))).add("shade",(e=>new zA(e,GA.getThis(e).color))).add("tint",(e=>new XA(e,GA.getThis(e).color))).get();class KA extends GA{setColorPropertyValue(e){this.colorModelInfo.rgb=Bn.sRgbToRgb(this.data.readerHelper.readAttribute(e,"val"))}}class qA extends GA{setColorPropertyValue(e){this.colorModelInfo.preset=this.data.readerHelper.readAttribute(e,"val")}}class $A extends GA{setColorPropertyValue(e){const t=this.data.readerHelper.getWpEnumValue(e,"val",NR.schemeColorTable.importMap,yn.Empty);t==yn.Empty&&this.data.options.throwInvalidFile("Invalid scheme color"),this.colorModelInfo.schemeColor=t}}class JA extends SR{get elementHandlerTable(){return JA.handlerTable}constructor(e,t,r){super(e),this.shape=t,this.size=r,this.fillColor=new Pp(Bn.empty)}static getThis(e){return e.destinationStack.getThis()}static onSolidFill(e,t){return new YA(e,JA.getThis(e).fillColor)}static onNoFill(e,t){return new QA(e,JA.getThis(e).fillColor)}static onOutline(e,t){return new ZA(e,JA.getThis(e).shape)}static onGraphicFrame(e,t){return new IN(e,JA.getThis(e).size)}processElementClose(e){const t=this.getAlphaTransform();let r=this.fillColor.color.toRgb(this.data.documentModel.colorProvider);(0,S.isDefined)(t)&&(r=U.fromArgb(t.value,r)),this.shape.fillColor=r}getAlphaTransform(){for(let e of this.fillColor.transforms.transforms)if(e instanceof Sp)return e;return null}}JA.handlerTable=(new Eu).add("solidFill",JA.onSolidFill).add("noFill",JA.onNoFill).add("ln",JA.onOutline).add("xfrm",JA.onGraphicFrame).get();class YA extends SR{get elementHandlerTable(){return YA.handlerTable}constructor(e,t){super(e),this.color=t}static getThis(e){return e.destinationStack.getThis()}static onSRgbColor(e,t){return new KA(e,YA.getThis(e).color)}static onSchemeColor(e,t){return new $A(e,YA.getThis(e).color)}static onPresetColor(e,t){return new qA(e,YA.getThis(e).color)}}YA.handlerTable=(new Eu).add("srgbClr",YA.onSRgbColor).add("schemeClr",YA.onSchemeColor).add("prstClr",YA.onPresetColor).get();class QA extends PR{constructor(e,t){super(e),this.color=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.color.rgb=y.NO_COLOR}))}}class ZA extends SR{get elementHandlerTable(){return ZA.handlerTable}constructor(e,t){super(e),this.shape=t,this.color=new Pp(new Bn)}static getThis(e){return e.destinationStack.getThis()}static onSolidFill(e,t){return new YA(e,ZA.getThis(e).color)}static onNoFill(e,t){return new QA(e,ZA.getThis(e).color)}processElementClose(e){this.shape.outlineColor=this.color.color.toRgb(this.data.documentModel.colorProvider)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getIntegerValue(e,"w",Number.MIN_VALUE);t!=Number.MIN_VALUE&&(this.shape.outlineWidth=g.u.emuToTwips(t))}))}}ZA.handlerTable=(new Eu).add("solidFill",ZA.onSolidFill).add("noFill",ZA.onNoFill).get();class eN extends SR{get elementHandlerTable(){return eN.handlerTable}get imageId(){return this.floatingObjectImportInfo.imageId}constructor(e){super(e),this.floatingObjectImportInfo=new bL(e)}static onInline(e,t){return eN.getThis(e).floatingObjectImportInfo.isFloatingObject=!1,new tN(e,eN.getThis(e).floatingObjectImportInfo)}static onAnchor(e,t){return eN.getThis(e).floatingObjectImportInfo.isFloatingObject=!0,new rN(e,eN.getThis(e).floatingObjectImportInfo)}static getThis(e){return e.destinationStack.getThis()}processElementClose(e){if(this.floatingObjectImportInfo.isFloatingObject)this.floatingObjectImportInfo.insertFloatingObject(this.documentModel.cache.imageCache);else{if(null===this.imageId)return;const e=()=>{const e=this.data.documentModel.cache.imageCache.getPictureData(this.imageId),t=this.data.subDocumentInfo.positionImporter.currPosition,r=new lh(t,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle,nh.defaultInfo(e));this.data.subDocumentInfo.characterImporter.addRun(r,an.specialCharacters.ObjectMark),this.data.formatImagesImporter.registerImageRun(new Ew(new pu(this.data.subDocument,t),Mb.initByActualSize(this.floatingObjectImportInfo.size.absoluteSize),r)),r.info.containerProperties.copyFrom(this.floatingObjectImportInfo.constainerProperties),r.info.nonVisualDrawingProperties.copyFrom(this.floatingObjectImportInfo.objectNonVisualProperties)};this.floatingObjectImportInfo.hyperlinkInfo?this.data.subDocumentInfo.fieldImporter.insertFullField((()=>{const e=this.data.subDocumentInfo.positionImporter.currPosition,t=xd.getNewCodeText(this.floatingObjectImportInfo.hyperlinkInfo),r=new ch(e,t.length,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle);this.data.subDocumentInfo.characterImporter.addRunAtPos(r,t,e)}),(()=>{e()}),this.floatingObjectImportInfo.hyperlinkInfo):e()}}}eN.handlerTable=(new Eu).add("inline",eN.onInline).add("anchor",eN.onAnchor).get();class tN extends SR{get elementHandlerTable(){return tN.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t}static getThis(e){return e.destinationStack.getThis()}static onExtent(e,t){return new oN(e,tN.getThis(e).floatingObjectImportInfo)}static onGraphic(e,t){return new lN(e,tN.getThis(e).floatingObjectImportInfo)}static onDocumentProperties(e,t){const r=tN.getThis(e).floatingObjectImportInfo;return new aN(e,r,r.constainerProperties)}static onCNvGraphicFramePr(e,t){return new iN(e,tN.getThis(e))}}tN.handlerTable=(new Eu).add("extent",tN.onExtent).add("graphic",tN.onGraphic).add("docPr",tN.onDocumentProperties).add("cNvGraphicFramePr",tN.onCNvGraphicFramePr).get();class rN extends SR{get elementHandlerTable(){return rN.handlerTable}get floatingObject(){return this.floatingObjectImportInfo.anchorInfo}constructor(e,t){super(e),this.floatingObjectImportInfo=t}static getThis(e){return e.destinationStack.getThis()}static onExtent(e,t){return new oN(e,rN.getThis(e).floatingObjectImportInfo)}static onGraphic(e,t){return new lN(e,rN.getThis(e).floatingObjectImportInfo)}static onSimplePosition(e,t){return new mN(e,rN.getThis(e))}static onAnchorHorizontalRelativeSize(e,t){return new AB(e,rN.getThis(e))}static onAnchorVerticalRelativeSize(e,t){return new NB(e,rN.getThis(e))}static onHorizontalPosition(e,t){return new MB(e,rN.getThis(e))}static onVerticalPosition(e,t){return new EB(e,rN.getThis(e))}static onWrapNone(e,t){return new OB(e,rN.getThis(e))}static onWrapSquare(e,t){return new HB(e,rN.getThis(e))}static onWrapThrough(e,t){return new VB(e,rN.getThis(e))}static onWrapTight(e,t){return new WB(e,rN.getThis(e))}static onWrapTopAndBottom(e,t){return new _B(e,rN.getThis(e))}static onCNvGraphicFramePr(e,t){return new iN(e,rN.getThis(e))}static onAnchorDocumentProperties(e,t){const r=rN.getThis(e).floatingObjectImportInfo;return new aN(e,r,r.constainerProperties)}isChoiceNamespaceSupported(e){return 0==Qe.Comparers.stringIgnoreCase(e,this.data.constants.namespaces[ZD.Wp14].namespace)||super.isChoiceNamespaceSupported(e)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.floatingObject;let r;r=this.data.readerHelper.getIntegerValue(e,"distT",Number.MIN_VALUE),r!=Number.MIN_VALUE&&(t.topDistance=this.convertEmuToDocumentUnits(r)),r=this.data.readerHelper.getIntegerValue(e,"distB",Number.MIN_VALUE),r!=Number.MIN_VALUE&&(t.bottomDistance=this.convertEmuToDocumentUnits(r)),r=this.data.readerHelper.getIntegerValue(e,"distL",Number.MIN_VALUE),r!=Number.MIN_VALUE&&(t.leftDistance=this.convertEmuToDocumentUnits(r)),r=this.data.readerHelper.getIntegerValue(e,"distR",Number.MIN_VALUE),r!=Number.MIN_VALUE&&(t.rightDistance=this.convertEmuToDocumentUnits(r)),r=this.data.readerHelper.getIntegerValue(e,"relativeHeight",Number.MIN_VALUE),r!=Number.MIN_VALUE&&(t.zOrder=Math.max(r,0)),this.useSimplePosition=this.data.readerHelper.getOnOffValue(e,"simplePos",!1),t.allowOverlap=this.data.readerHelper.getOnOffValue(e,"allowOverlap",!0),this.data.readerHelper.getOnOffValue(e,"behindDoc",!1)&&(t.isBehindDoc=!0),this.data.readerHelper.getOnOffValue(e,"hidden",!1)&&(t.hidden=!0),this.data.readerHelper.getOnOffValue(e,"layoutInCell",!1)&&(t.layoutTableCell=!0),this.data.readerHelper.getOnOffValue(e,"locked",!1)&&(t.locked=!0)}))}convertEmuToDocumentUnits(e){return Math.round(g.u.centimetersToTwipsF(e/36e3/10))}}rN.handlerTable=(new Eu).add("extent",rN.onExtent).add("graphic",rN.onGraphic).add("simplePos",rN.onSimplePosition).add("positionH",rN.onHorizontalPosition).add("positionV",rN.onVerticalPosition).add("wrapNone",rN.onWrapNone).add("wrapSquare",rN.onWrapSquare).add("wrapThrough",rN.onWrapThrough).add("wrapTight",rN.onWrapTight).add("wrapTopAndBottom",rN.onWrapTopAndBottom).add("cNvGraphicFramePr",rN.onCNvGraphicFramePr).add("docPr",rN.onAnchorDocumentProperties).add("sizeRelH",rN.onAnchorHorizontalRelativeSize).add("sizeRelV",rN.onAnchorVerticalRelativeSize).get();class iN extends SR{get elementHandlerTable(){return iN.handlerTable}constructor(e,t){super(e),this.size=t.floatingObjectImportInfo.size}static getThis(e){return e.destinationStack.getThis()}static onGraphicFrameLocks(e,t){return new nN(e,iN.getThis(e))}}iN.handlerTable=(new Eu).add("graphicFrameLocks",iN.onGraphicFrameLocks).get();class nN extends PR{constructor(e,t){super(e),this.size=t.size}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.size,r=e.getAttribute("noChangeAspect");rn.StringUtils.isNullOrEmpty(r)||(t.lockAspectRatio=this.data.readerHelper.getOnOffValueBool(r,!1))}))}}class oN extends PR{constructor(e,t){super(e),this.floatingObjectImportInfo=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("cx"),r=e.getAttribute("cy");this.floatingObjectImportInfo.size.setUseAbsoluteHeight(!0),this.floatingObjectImportInfo.size.setUseAbsoluteWidth(!0),this.floatingObjectImportInfo.size.absoluteSize.width=Math.round(g.u.centimetersToTwips(this.data.readerHelper.getIntegerValueCore(t,0)/36e3/10)),this.floatingObjectImportInfo.size.absoluteSize.height=Math.round(g.u.centimetersToTwips(this.data.readerHelper.getIntegerValueCore(r,0)/36e3/10))}))}}class aN extends SR{get elementHandlerTable(){return aN.handlerTable}constructor(e,t,r){super(e),this.floatingObjectImportInfo=t,this.nonVisualProperties=r}static getThis(e){return e.destinationStack.getThis()}static onHyperlinkClick(e,t){const r=new xd("","","",!1);return aN.getThis(e).floatingObjectImportInfo.hyperlinkInfo=r,new sN(e,r)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("name");rn.StringUtils.isNullOrEmpty(t)||(this.nonVisualProperties.name=t);const r=this.data.readerHelper.getIntegerValue(e,"id",Number.MIN_VALUE);r!=Number.MIN_VALUE&&(this.nonVisualProperties.id=r);const i=e.getAttribute("descr");rn.StringUtils.isNullOrEmpty(i)||(this.nonVisualProperties.description=i);const n=e.getAttribute("title");rn.StringUtils.isNullOrEmpty(n)||(this.nonVisualProperties.title=n)}))}}aN.handlerTable=(new Eu).add("hlinkClick",aN.onHyperlinkClick).get();class sN extends PR{constructor(e,t){super(e),this.hyperlinkInfo=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("tooltip");rn.StringUtils.isNullOrEmpty(t)||(this.hyperlinkInfo.tip=t);const r=yield e.getAttributeNS("id",this.data.constants.relsNamespaceConst);if(!rn.StringUtils.isNullOrEmpty(r)){const e=this.data.relationsStack.last.lookupRelationById(r);if(null!=e){const t=e.target;if("External"==e.targetMode)this.hyperlinkInfo.uri=t;else{const e=t.indexOf("#");this.hyperlinkInfo.anchor=t.substring(e)}}}}))}}class lN extends SR{get elementHandlerTable(){return lN.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t}static getThis(e){return e.destinationStack.getThis()}static onGraphicData(e,t){return new dN(e,lN.getThis(e).floatingObjectImportInfo)}}lN.handlerTable=(new Eu).add("graphicData",lN.onGraphicData).get();class dN extends SR{get elementHandlerTable(){return dN.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t}static getThis(e){return e.destinationStack.getThis()}static onPicture(e,t){return new hN(e,dN.getThis(e).floatingObjectImportInfo)}static onWordProcessingShape(e,t){return new fN(e,dN.getThis(e).floatingObjectImportInfo)}static onDrawingGroupShape(e,t){return new cN(e,dN.getThis(e).floatingObjectImportInfo)}}dN.handlerTable=(new Eu).add("pic",dN.onPicture).add("wsp",dN.onWordProcessingShape).add("wgp",dN.onDrawingGroupShape).get();class cN extends dN{}class hN extends SR{get elementHandlerTable(){return hN.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t}static getThis(e){return e.destinationStack.getThis()}static onPictureNonVisualProperties(e,t){return new zB(e,hN.getThis(e).floatingObjectImportInfo)}static onBlipFill(e,t){return new uN(e,hN.getThis(e).floatingObjectImportInfo)}static onShapeProperties(e,t){const r=hN.getThis(e);return new JA(e,r.floatingObjectImportInfo.shape,r.floatingObjectImportInfo.size)}static onAlternateContent(e,t){return hN.getThis(e)}static onChoice(e,t){return hN.getThis(e)}static onFallback(e,t){return hN.getThis(e)}}hN.handlerTable=(new Eu).add("nvPicPr",hN.onPictureNonVisualProperties).add("blipFill",hN.onBlipFill).add("AlternateContent",hN.onAlternateContent).add("Choice",hN.onChoice).add("Fallback",hN.onFallback).add("spPr",hN.onShapeProperties).get();class uN extends SR{get elementHandlerTable(){return uN.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t}static getThis(e){return e.destinationStack.getThis()}static onBlip(e,t){return new pN(e,uN.getThis(e).floatingObjectImportInfo)}static onSourceRect(e,t){return new gN(e,uN.getThis(e).floatingObjectImportInfo)}}uN.handlerTable=(new Eu).add("blip",uN.onBlip).add("srcRect",uN.onSourceRect).get();class pN extends PR{constructor(e,t){super(e),this.floatingObjectImportInfo=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t=e.getAttributeNS("embed",this.data.constants.relsNamespaceConst);if(!rn.StringUtils.isNullOrEmpty(t)){let e=yield this.data.relationsStack.last.lookupImageByRelationId(t,"word");return null==e&&(e=yield this.data.relationsStack.last.lookupImageByRelationId(t,"")),void(null!=e&&(this.floatingObjectImportInfo.imageId=e))}if(t=e.getAttributeNS("link",this.data.constants.relsNamespaceConst),rn.StringUtils.isNullOrEmpty(t))return;const r=yield this.data.relationsStack.last.lookupExternalImageByRelationId(t);r&&(this.floatingObjectImportInfo.imageId=r)}))}}class gN extends PR{constructor(e,t){super(e),this.floatingObjectImportInfo=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}getThousandthOfPercentValue(e,t,r){const i=e.getAttribute(t);return rn.StringUtils.isNullOrEmpty(i)?r:"%"==i[i.length-1]?this.getPercentValue(i,r):this.data.readerHelper.getIntegerValueCore(i,r)}getPercentValue(e,t){let r;e=e.substr(0,e.length-1);try{r=parseFloat(e)}catch(e){}return r?Math.round(1e3*r):t}}class mN extends PR{constructor(e,t){super(e),this.anchorDestination=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){if(!this.anchorDestination.useSimplePosition)return;let t=this.data.readerHelper.getIntegerValue(e,"x",Number.MIN_VALUE),r=this.data.readerHelper.getIntegerValue(e,"y",Number.MIN_VALUE);t!=Number.MIN_VALUE&&r!=Number.MIN_VALUE&&(t=this.anchorDestination.convertEmuToDocumentUnits(t),r=this.anchorDestination.convertEmuToDocumentUnits(r),this.anchorDestination.floatingObject.offset=new Xc.Point(t,r),this.anchorDestination.floatingObject.horizontalPositionType=gc.Page,this.anchorDestination.floatingObject.verticalPositionType=fc.Page,this.anchorDestination.floatingObject.horizontalPositionAlignment=mc.Left,this.anchorDestination.floatingObject.verticalPositionAlignment=bc.Top)}))}}class fN extends SR{get elementHandlerTable(){return fN.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t}static getThis(e){return e.destinationStack.getThis()}static onTextBox(e,t){return new bN(e,fN.getThis(e).floatingObjectImportInfo)}static onTextBoxProperties(e,t){return new SN(e,fN.getThis(e).floatingObjectImportInfo.textBoxProperties)}static onNonVisualDrawingProperties(e,t){const r=fN.getThis(e).floatingObjectImportInfo;return new aN(e,r,r.constainerProperties)}static onShapeProperties(e,t){const r=fN.getThis(e);return new JA(e,r.floatingObjectImportInfo.shape,r.floatingObjectImportInfo.size)}}fN.handlerTable=(new Eu).add("txbx",fN.onTextBox).add("cNvPr",fN.onNonVisualDrawingProperties).add("bodyPr",fN.onTextBoxProperties).add("spPr",fN.onShapeProperties).get();class bN extends SR{get elementHandlerTable(){return bN.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t,this.floatingObjectImportInfo.shapeType=mF.TextBox,this.data.pushCurrentSubDocument(this.documentModel.createSubDocument(yo.TextBox,this.data.subDocument.id,!0))}static onTextBoxContent(e,t){return new CN(e)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("style"),r=e.getAttribute("inset"),i=this.floatingObjectImportInfo.textBoxProperties;if(rn.StringUtils.isNullOrEmpty(t)||(i.resizeShapeToFitText=this.getResizeShapeToFitText(t)),rn.StringUtils.isNullOrEmpty(r))return;const n=this.getMargins(r);i.leftMargin=this.getValidMarginValue(n[0],144),i.rightMargin=this.getValidMarginValue(n[1],144),i.topMargin=this.getValidMarginValue(n[2],72),i.bottomMargin=this.getValidMarginValue(n[3],72)}))}processElementClose(e){this.floatingObjectImportInfo.subDocId=this.data.subDocument.id,this.data.popCurrentSubDocument()}getMargins(e){const t=new Array(4),r=e.split(",");for(let e=0;e<r.length;e++)t[e]=this.getFloatValue(r[e]);if(r.length<4)for(let e=r.length;e<t.length;e++)t[e]=72+(e<2?72:0);return t}getResizeShapeToFitText(e){return"t"==e.substring(e.length-1)}getValidMarginValue(e,t){return e<0?t:e}getFloatValue(e){const t=uR.parse(e);return t.isEmpty||null==t.value?Number.MIN_VALUE:pR.valueUnitToModelUnitsF(t)}}bN.handlerTable=(new Eu).add("txbxContent",bN.onTextBoxContent).get();class CN extends ML{get elementHandlerTable(){return CN.handlerTable}}CN.handlerTable=(new Eu).add("p",(e=>new oO(e))).add("tbl",(e=>new TB(e))).add("bookmarkStart",ML.onBookmarkStart).add("bookmarkEnd",ML.onBookmarkEnd).add("permStart",ML.onRangePermissionStart).add("permEnd",ML.onRangePermissionEnd).add("sdt",ML.onStructuredDocument).add("altChunk",(e=>new qR(e))).add("customXml",ML.onCustomXml).add("del",ML.onDeleted).add("ins",ML.onInserted).get();class SN extends SR{get elementHandlerTable(){return SN.handlerTable}constructor(e,t){super(e),this.textBoxProperties=t}static getThis(e){return e.destinationStack.getThis()}static onDisableAutoFit(e,t){return SN.getThis(e).textBoxProperties.resizeShapeToFitText=!1,null}static onEnableAutoFit(e,t){return SN.getThis(e).textBoxProperties.resizeShapeToFitText=!0,null}processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t;t=this.data.readerHelper.getIntegerValue(e,"lIns",Number.MIN_VALUE),t!=Number.MIN_VALUE&&(this.textBoxProperties.leftMargin=g.u.emuToTwips(t)),t=this.data.readerHelper.getIntegerValue(e,"rIns",Number.MIN_VALUE),t!=Number.MIN_VALUE&&(this.textBoxProperties.rightMargin=g.u.emuToTwips(t)),t=this.data.readerHelper.getIntegerValue(e,"tIns",Number.MIN_VALUE),t!=Number.MIN_VALUE&&(this.textBoxProperties.topMargin=g.u.emuToTwips(t)),t=this.data.readerHelper.getIntegerValue(e,"bIns",Number.MIN_VALUE),t!=Number.MIN_VALUE&&(this.textBoxProperties.bottomMargin=g.u.emuToTwips(t));const r=e.getAttribute("wrap");"square"==r?this.textBoxProperties.wrapText=!0:"none"==r&&(this.textBoxProperties.wrapText=!1);const i=e.getAttribute("upright");rn.StringUtils.isNullOrEmpty(i)||(this.textBoxProperties.upright=this.data.readerHelper.getOnOffValueBool(i,this.textBoxProperties.upright));const n=this.data.readerHelper.getWpEnumValue(e,"anchor",NR.drawingTextAnchoringType.importMap,-1);-1!=n&&(this.textBoxProperties.verticalAlignment=n)}))}}SN.handlerTable=(new Eu).add("noAutofit",SN.onDisableAutoFit).add("spAutoFit",SN.onEnableAutoFit).get();class IN extends PR{constructor(e,t){super(e),this.size=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getIntegerValue(e,"rot",Bo.Constants.MIN_SAFE_INTEGER);t!=Bo.Constants.MIN_SAFE_INTEGER&&(this.size.rotation=t)}))}}class PN{constructor(){this.index=-1,this.startPos=-1,this.codeEndPos=-1,this.resultEndIndexPos=-1,this.nestedFields=[]}}class wN extends SR{processFieldBegin(e,t,r){const i=new PN;i.disableUpdate=e,i.locked=t,i.hideByParent=r,i.index=this.data.subDocumentInfo.fieldImporter.currIndex++,this.data.subDocumentInfo.fieldImporter.processFieldBegin(i)}processFieldSeparator(){this.data.subDocumentInfo.fieldImporter.applyToLastField((e=>{-1==e.codeEndPos&&this.data.subDocumentInfo.fieldImporter.processFieldSeparator(e)}))}processFieldEnd(){this.data.subDocumentInfo.fieldImporter.applyToLastField((e=>{const t=this.data.subDocumentInfo.fieldImporter.processFieldEnd(e);this.data.subDocumentInfo.fieldImporter.fieldInfoStack.count>0&&this.data.subDocumentInfo.fieldImporter.fieldInfoStack.last.nestedFields.push(t)}))}}class yN extends wN{get elementHandlerTable(){return yN.handlerTable}processElementOpen(e){return YD(this,void 0,void 0,(function*(){switch(e.getAttributeNS("fldCharType",this.data.constants.wordProcessingNamespaceConst)){case"begin":const t=e.getAttributeNS("disableUpdate",this.data.constants.wordProcessingNamespaceConst),r=e.getAttributeNS("hideByParent",this.data.constants.wordProcessingNamespaceConst),i=e.getAttributeNS("fldLock",this.data.constants.wordProcessingNamespaceConst),n=!rn.StringUtils.isNullOrEmpty(t)&&this.data.readerHelper.isBoolStrict(t),o=!rn.StringUtils.isNullOrEmpty(r)&&this.data.readerHelper.isBoolStrict(r),a=!rn.StringUtils.isNullOrEmpty(i)&&this.data.readerHelper.isBoolStrict(i);this.processFieldBegin(n,a,o);break;case"separate":this.processFieldSeparator();break;case"end":this.processFieldEnd()}}))}}yN.handlerTable=(new Eu).add("ffData",(e=>null)).add("fldData",(e=>null)).get();class xN extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.subDocumentInfo.characterImporter.insertText(an.specialCharacters.LineBreak)}))}}class TN extends SR{get elementHandlerTable(){return{}}}class vN extends SR{get elementHandlerTable(){return{}}}class MN extends SR{get elementHandlerTable(){return{}}processText(e){let t=e.value;if(t=this.replaceLineBreakOnSpace(t),!rn.StringUtils.isNullOrEmpty(t)){const e=_y.replaceParagraphMarksWithLineBreaks(t);rn.StringUtils.isNullOrEmpty(e)||this.data.subDocumentInfo.characterImporter.insertText(e)}return!0}replaceLineBreakOnSpace(e){return e.replace("\n"," ")}}class EN extends MN{constructor(e){super(e),this.characterProperties=this.data.subDocumentInfo.characterImporter.properties.clone()}processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}}class DN{constructor(e,t,r){this.documentModel=e,this.readerHelper=t,this.originalSize=r,this.size=r,this.cssKeywordTable=this.createCssKeywordTable(),this.topDistance=0,this.bottomDistance=0,this.leftDistance=180,this.rightDistance=180,this.fromWidth=cc.Page,this.fromHeight=hc.Page,this.offset=new Xc.Point(0,0)}parseAttribute(e){const t=e.split(";");f.ListUtils.forEach(t,(e=>{const t=e.split(":"),r=t[0].toUpperCase(),i=t[1],n=this.cssKeywordTable[r];n&&n(i)}))}getFloatingObjectHorizontalPositionAlignment(e){return this.readerHelper.getWpEnumValueCore(e,NR.floatingObjectHorizontalPositionAlignmentTable.importMap,mc.None)}getFloatingObjectVerticalPositionAlignment(e){return this.readerHelper.getWpEnumValueCore(e,NR.floatingObjectVerticalPositionAlignmentTable.importMap,bc.None)}getWrapText(e){return"square"==e}getFloatingObjectVerticalAlignment(e){return this.readerHelper.getWpEnumValueCore(e,NR.drawingTextAnchoringType.importMap,Sc.Top)}getFloatingObjectRelativeFromHorizontal(e){return this.readerHelper.getWpEnumValueCore(e,NR.floatingObjectCssRelativeFromHorizontalTable.importMap,cc.Margin)}getFloatingObjectRelativeFromVertical(e){return this.readerHelper.getWpEnumValueCore(e,NR.floatingObjectCssRelativeFromVerticalTable.importMap,hc.Margin)}getPercentValue(e){if(e=e.trim(),rn.StringUtils.endsAt(e,"%"))try{const t=parseFloat(e.substr(0,e.length-1));if(t)return 1e3*t}catch(e){}else try{const t=parseInt(e,10);if(t)return 1e3*t}catch(e){}return 1e5}cssWidth(e){const t=uR.parse(e);let r=pR.valueUnitToModelUnitsF(t);"%"===t.unit&&(r*=this.originalSize.width),this.size.width=r}cssHeight(e){const t=uR.parse(e);let r=pR.valueUnitToModelUnitsF(t);"%"===t.unit&&(r*=this.originalSize.height),this.size.height=r}cssVerticalPositionType(e){this.verticalPositionType=e}cssHorizontalPositionType(e){this.horizontalPositionType=e}cssHorizontalPositionAlignment(e){this.horizontalPositionAlignment=this.getFloatingObjectHorizontalPositionAlignment(e)}cssVerticalPositionAlignment(e){this.verticalPositionAlignment=this.getFloatingObjectVerticalPositionAlignment(e)}cssTextBoxVerticalAlignment(e){this.textBoxVerticalAlignment=this.getFloatingObjectVerticalAlignment(e)}cssTextBoxWrapType(e){this.wrapText=this.getWrapText(e),this.useWrapText=!0}cssZOrder(e){this.zOrder=Math.max(parseInt(e,10),0)}cssTopDistance(e){const t=uR.parse(e),r=pR.valueUnitToModelUnitsF(t);this.topDistance=r}cssLeftDistance(e){const t=uR.parse(e),r=pR.valueUnitToModelUnitsF(t);this.leftDistance=r}cssRightDistance(e){const t=uR.parse(e),r=pR.valueUnitToModelUnitsF(t);this.rightDistance=r}cssBottomDistance(e){const t=uR.parse(e),r=pR.valueUnitToModelUnitsF(t);this.bottomDistance=r}cssMsoWidthPercent(e){this.widthPercent=this.getPercentValue(e),this.useRelativeWidth=!0}cssMsoHeightPercent(e){this.heightPercent=this.getPercentValue(e),this.useRelativeHeight=!0}cssMsoWidthRelative(e){this.fromWidth=this.getFloatingObjectRelativeFromHorizontal(e),this.useRelativeWidth=!0}cssMsoHeightRelative(e){this.fromHeight=this.getFloatingObjectRelativeFromVertical(e),this.useRelativeHeight=!0}cssPosition(e){this.position=e}cssOffsetX(e){const t=uR.parse(e),r=pR.valueUnitToModelUnitsF(t);this.offset.x=r}cssOffsetY(e){const t=uR.parse(e),r=pR.valueUnitToModelUnitsF(t);this.offset.y=r}cssRotation(e){this.useRotation=!0;const t=uR.parse(e);this.rotation=pR.rotationUnitToModelUnits(t)}cssVisibility(e){this.hidden="hidden"===e}createCssKeywordTable(){return(new Eu).add("width".toUpperCase(),(e=>this.cssWidth(e))).add("height".toUpperCase(),(e=>this.cssHeight(e))).add("z-index".toUpperCase(),(e=>this.cssZOrder(e))).add("mso-wrap-distance-top".toUpperCase(),(e=>this.cssTopDistance(e))).add("mso-wrap-distance-left".toUpperCase(),(e=>this.cssLeftDistance(e))).add("mso-wrap-distance-right".toUpperCase(),(e=>this.cssRightDistance(e))).add("mso-wrap-distance-bottom".toUpperCase(),(e=>this.cssBottomDistance(e))).add("margin-left".toUpperCase(),(e=>this.cssOffsetX(e))).add("margin-top".toUpperCase(),(e=>this.cssOffsetY(e))).add("mso-position-horizontal".toUpperCase(),(e=>this.cssHorizontalPositionAlignment(e))).add("mso-position-vertical".toUpperCase(),(e=>this.cssVerticalPositionAlignment(e))).add("mso-position-vertical-relative".toUpperCase(),(e=>this.cssVerticalPositionType(e))).add("mso-position-horizontal-relative".toUpperCase(),(e=>this.cssHorizontalPositionType(e))).add("v-text-anchor".toUpperCase(),(e=>this.cssTextBoxVerticalAlignment(e))).add("mso-wrap-style".toUpperCase(),(e=>this.cssTextBoxWrapType(e))).add("rotation".toUpperCase(),(e=>this.cssRotation(e))).add("mso-width-percent".toUpperCase(),(e=>this.cssMsoWidthPercent(e))).add("mso-height-percent".toUpperCase(),(e=>this.cssMsoHeightPercent(e))).add("mso-width-relative".toUpperCase(),(e=>this.cssMsoWidthRelative(e))).add("mso-height-relative".toUpperCase(),(e=>this.cssMsoHeightRelative(e))).add("position".toUpperCase(),(e=>this.cssPosition(e))).add("visibility".toUpperCase(),(e=>this.cssVisibility(e))).get()}}class FN extends SR{get elementHandlerTable(){return FN.handlerTable}get floatingObjectImportInfo(){return this.inlineObjectDestination.floatingObjectImportInfo}get style(){return this.inlineObjectDestination.style}constructor(e,t){super(e),this.inlineObjectDestination=t}static getThis(e){return e.destinationStack.getThis()}static onWrap(e,t){return new RN(e,FN.getThis(e).floatingObjectImportInfo.anchorInfo)}static onLock(e,t){return new LN(e,FN.getThis(e).floatingObjectImportInfo.size)}static onTextBox(e,t){return FN.getThis(e).floatingObjectImportInfo.shapeType=mF.TextBox,new AN(e,FN.getThis(e).floatingObjectImportInfo)}static onAnchorLock(e,t){return new BN(e,FN.getThis(e).floatingObjectImportInfo.anchorInfo)}static onImageData(e,t){return new NN(e,FN.getThis(e).floatingObjectImportInfo)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.inlineObjectDestination.style=e.getAttribute("style"),this.readFloatingObjectProperties(e),this.readShapeProperties(e);const t=e.getAttribute("id");!rn.StringUtils.isNullOrEmpty(t)&&rn.StringUtils.isNullOrEmpty(this.floatingObjectImportInfo.constainerProperties.name)&&(this.floatingObjectImportInfo.constainerProperties.name=t),this.readFlatingObjectHyperlinkInfo(e)}))}readFlatingObjectHyperlinkInfo(e){const t=e.getAttribute("href");if(rn.StringUtils.isNullOrEmpty(t))return;const r=new xd("","","",!1),i=t.lastIndexOf("#");i>=0?(r.uri=t.substring(0,i),r.anchor=t.substring(i+1)):r.uri=t;const n=e.getAttribute("title");rn.StringUtils.isNullOrEmpty(n)||(r.tip=n),this.floatingObjectImportInfo.hyperlinkInfo=r}processElementClose(e){super.processElementClose(e);const t=this.floatingObjectImportInfo.shape;try{this.applyShapeProperties(t)}catch(e){}}applyShapeProperties(e){this.floatingObjectImportInfo.shapeType==mF.TextBox?this.applyTextBoxShapeProperties(e):this.applyPictureShapeProperties(e)}applyTextBoxShapeProperties(e){this.isStroked&&(this.outlineColor==U.empty&&(this.outlineColor=y.BLACK_COLOR),e.outlineColor=this.outlineColor),this.isFilled&&this.fillColor!=U.empty&&(e.fillColor=this.fillColor),this.outlineWidth==Number.MIN_SAFE_INTEGER&&(this.outlineWidth=.75),e.outlineWidth=Math.round(g.u.pointsToTwips(this.outlineWidth))}applyPictureShapeProperties(e){this.isStroked&&this.outlineColor!=U.empty&&(e.outlineColor=this.outlineColor),this.isFilled&&this.fillColor!=U.empty&&(e.fillColor=this.fillColor),this.outlineWidth!=Number.MIN_SAFE_INTEGER&&(e.outlineWidth=Math.round(g.u.pointsToTwips(this.outlineWidth)))}readFloatingObjectProperties(e){const t=this.floatingObjectImportInfo.anchorInfo;this.readFloatingObjectPropertiesCore(e,t)}readShapeProperties(e){try{this.readShapePropertiesCore(e)}catch(e){}}readFloatingObjectPropertiesCore(e,t){rn.StringUtils.isNullOrEmpty(e.getAttribute("side"))||(t.wrapSide=this.data.readerHelper.getWpEnumValue(e,"wrapText",NR.floatingObjectTextWrapSideTable.importMap,pc.Both));const r=e.getAttributeNS("allowincell",this.data.constants.namespaces[ZD.Office].namespace);rn.StringUtils.isNullOrEmpty(r)?t.layoutTableCell=!0:t.layoutTableCell=this.getBoolValue(r);const i=e.getAttributeNS("allowoverlap",this.data.constants.namespaces[ZD.Office].namespace);rn.StringUtils.isNullOrEmpty(i)||(t.allowOverlap=this.getBoolValue(i))}readShapePropertiesCore(e){const t=e.getAttribute("stroked");this.isStroked="f"!=t&&"false"!=t;const r=e.getAttribute("filled");this.isFilled="f"!=r&&"false"!=r;const i=kR.tryConvertAttributeToColor(this.data,e,"strokecolor");this.outlineColor=null==i?y.BLACK_COLOR:i;const n=kR.tryConvertAttributeToColor(this.data,e,"fillcolor");this.fillColor=null==n||n==U.empty?w.i.LIGHT_COLOR:n,this.outlineWidth=this.data.readerHelper.getFloatValueInPoints(e,"strokeweight",Number.MIN_SAFE_INTEGER)}getBoolValue(e){return"t"==e}}FN.handlerTable=(new Eu).add("wrap",FN.onWrap).add("lock",FN.onLock).add("textbox",FN.onTextBox).add("anchorlock",FN.onAnchorLock).add("imagedata",FN.onImageData).get();class RN extends PR{constructor(e,t){super(e),this.floatingObject=t}importTextWrapType(e){const t=e.getAttribute("type"),r=B.StringMapUtils.elementBy(NR.floatingObjectTextWrapTypeTable.importMap,(e=>e.mlValue.wordMLValue==t));r&&(this.floatingObject.wrapType=r.modelValue)}importTextWrapSide(e){const t=e.getAttribute("side"),r=B.StringMapUtils.elementBy(NR.floatingObjectTextWrapSideTable.importMap,(e=>e.mlValue.wordMLValue==t));r&&(this.floatingObject.wrapSide=r.modelValue)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.importTextWrapType(e),this.importTextWrapSide(e)}))}}class LN extends PR{constructor(e,t){super(e),this.size=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("aspectratio");rn.StringUtils.isNullOrEmpty(t)||(this.size.lockAspectRatio="t"==t)}))}}class BN extends PR{constructor(e,t){super(e),this.floatingObjectProperties=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.floatingObjectProperties.locked=!0}))}}class AN extends SR{get elementHandlerTable(){return AN.handlerTable}constructor(e,t){super(e),this.floatingObjectImportInfo=t,this.floatingObjectImportInfo.shapeType=mF.TextBox,this.data.pushCurrentSubDocument(this.documentModel.createSubDocument(yo.TextBox,this.data.subDocument.id,!0))}static onTextBoxContent(e,t){return new CN(e)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttribute("style"),r=e.getAttribute("inset"),i=this.floatingObjectImportInfo.textBoxProperties;if(rn.StringUtils.isNullOrEmpty(t)?i.resizeShapeToFitText=!1:i.resizeShapeToFitText=this.getResizeShapeToFitText(t),rn.StringUtils.isNullOrEmpty(r))return;const n=this.getMargins(r);i.leftMargin=this.getValidMarginValue(n[0],144),i.rightMargin=this.getValidMarginValue(n[1],144),i.topMargin=this.getValidMarginValue(n[2],72),i.bottomMargin=this.getValidMarginValue(n[3],72)}))}processElementClose(e){this.floatingObjectImportInfo.subDocId=this.data.subDocument.id,this.data.popCurrentSubDocument()}getMargins(e){const t=new Array(4),r=e.split(",");for(let e=0;e<r.length;e++)t[e]=this.getFloatValue(r[e]);if(r.length<4)for(let e=r.length;e<t.length;e++)t[e]=72+(e<2?72:0);return t}getResizeShapeToFitText(e){return"t"==e.substring(e.length-1)}getValidMarginValue(e,t){return e<0?t:e}getFloatValue(e){const t=uR.parse(e);return t.isEmpty||null==t.value?Number.MIN_VALUE:pR.valueUnitToModelUnitsF(t)}}AN.handlerTable=(new Eu).add("txbxContent",AN.onTextBoxContent).get();class NN extends PR{constructor(e,t){super(e),this.floatingObjectImportInfo=t,this.floatingObjectImportInfo.shapeType=mF.PictureFrame}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("id",this.data.constants.relsNamespaceConst);if(rn.StringUtils.isNullOrEmpty(t));else{const e=yield this.data.relationsStack.last.lookupImageByRelationId(t,"word");null!=e&&(this.floatingObjectImportInfo.imageId=e)}}))}}class kN extends SR{get elementHandlerTable(){return kN.handlerTable}constructor(e){super(e),this.floatingObjectImportInfo=new bL(this.data)}static getThis(e){return e.destinationStack.getThis()}processElementClose(e){if(this.floatingObjectImportInfo.shapeType==mF.TextBox&&this.floatingObjectImportInfo.subDocId>=0)this.floatingObjectImportInfo.isFloatingObject=!0,this.importFloatingObject(this.getCssParser(new so.Size(0,0))),this.floatingObjectImportInfo.insertFloatingObject(this.documentModel.cache.imageCache);else{if(null===this.floatingObjectImportInfo.imageId)return;const e=this.getCssParser(new so.Size(0,0));let t;if(this.importFloatingObject(this.getCssParser(new so.Size(0,0))),"absolute"!=e.position){const e=this.documentModel.cache.imageCache.getPictureData(this.floatingObjectImportInfo.imageId);if(!e)throw new Error(R.D.InternalException);const r=this.data.subDocumentInfo.positionImporter.currPosition;t=new lh(r,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle,nh.defaultInfo(e)),this.data.subDocumentInfo.characterImporter.addRun(t,an.specialCharacters.ObjectMark),this.data.formatImagesImporter.registerImageRun(new Ew(new pu(this.data.subDocument,r),Mb.initByActualSize(this.floatingObjectImportInfo.size.absoluteSize),t)),t.info.containerProperties.copyFrom(this.floatingObjectImportInfo.constainerProperties),t.info.nonVisualDrawingProperties.copyFrom(this.floatingObjectImportInfo.objectNonVisualProperties)}else this.floatingObjectImportInfo.isFloatingObject=!0,t=this.floatingObjectImportInfo.insertFloatingObject(this.documentModel.cache.imageCache)}}getCssParser(e){const t=new DN(this.data.documentModel,this.data.readerHelper,e);try{t.parseAttribute(this.style)}catch(e){}return t}importFloatingObject(e){this.floatingObjectImportInfo.anchorInfo.zOrder=e.zOrder,this.floatingObjectImportInfo.size.absoluteSize=new so.Size(e.size.width,e.size.height),this.floatingObjectImportInfo.anchorInfo.topDistance=e.topDistance,this.floatingObjectImportInfo.anchorInfo.bottomDistance=e.bottomDistance,this.floatingObjectImportInfo.anchorInfo.leftDistance=e.leftDistance,this.floatingObjectImportInfo.anchorInfo.rightDistance=e.rightDistance,this.floatingObjectImportInfo.anchorInfo.offset=e.offset,this.floatingObjectImportInfo.anchorInfo.hidden=!!e.hidden,null!=e.horizontalPositionAlignment&&e.horizontalPositionAlignment!=mc.None&&(this.floatingObjectImportInfo.anchorInfo.horizontalPositionAlignment=e.horizontalPositionAlignment),null!=e.verticalPositionAlignment&&e.verticalPositionAlignment!=bc.None&&(this.floatingObjectImportInfo.anchorInfo.verticalPositionAlignment=e.verticalPositionAlignment),e.useRelativeWidth&&(this.floatingObjectImportInfo.size.relativeSize.width=e.widthPercent,this.floatingObjectImportInfo.size.relativeWidthType=e.fromWidth),e.useRelativeHeight&&(this.floatingObjectImportInfo.size.relativeSize.height=e.heightPercent,this.floatingObjectImportInfo.size.relativeHeightType=e.fromHeight),e.horizontalPositionType&&(this.floatingObjectImportInfo.anchorInfo.horizontalPositionType=this.convertToHorizontalPositionType(e.horizontalPositionType)),e.verticalPositionType&&(this.floatingObjectImportInfo.anchorInfo.verticalPositionType=this.convertToVerticalPositionType(e.verticalPositionType)),e.textBoxVerticalAlignment&&e.textBoxVerticalAlignment!=Sc.Top&&(this.floatingObjectImportInfo.textBoxProperties.verticalAlignment=e.textBoxVerticalAlignment),e.useWrapText&&(this.floatingObjectImportInfo.textBoxProperties.wrapText=e.wrapText),e.useRotation&&(this.floatingObjectImportInfo.size.rotation=e.rotation)}convertToHorizontalPositionType(e){const t=B.StringMapUtils.elementBy(NR.horizontalPositionTypeAttributeTable.importMap,(t=>t.mlValue.openXmlValue==e));return null===t?gc.Column:t.modelValue}convertToVerticalPositionType(e){const t=B.StringMapUtils.elementBy(NR.verticalPositionTypeAttributeTable.importMap,(t=>t.mlValue.openXmlValue==e));return null===t?fc.Paragraph:t.modelValue}}kN.handlerTable=(new Eu).add("shape",(e=>new FN(e,kN.getThis(e)))).add("rect",(e=>new FN(e,kN.getThis(e)))).get();class ON extends kN{}class _N extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpEnumValue(e,"type",NR.runBreaksTable.importMap,an.specialCharacters.LineBreak.charCodeAt(0));this.data.subDocumentInfo.characterImporter.insertText(String.fromCharCode(t))}))}}class UN extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.subDocumentInfo.characterImporter.insertText(an.specialCharacters.TabMark)}))}}class HN extends SR{get elementHandlerTable(){return{}}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.subDocumentInfo.characterImporter.insertText(an.specialCharacters.SeparatorMark)}))}}class VN extends SR{get elementHandlerTable(){return{}}processElementOpen(e){var t;return YD(this,void 0,void 0,(function*(){const r=e.getAttributeNS("font",this.data.constants.wordProcessingNamespaceConst),i=e.getAttributeNS("char",this.data.constants.wordProcessingNamespaceConst);if(rn.StringUtils.isNullOrEmpty(r)||rn.StringUtils.isNullOrEmpty(i))return;const n=parseInt(i,16);if(isNaN(n))return;const o=String.fromCharCode(n),a=this.data.subDocumentInfo.characterImporter.properties,s=a.clone(),l=null!==(t=this.documentModel.cache.fontInfoCache.getItemByName(r))&&void 0!==t?t:this.documentModel.cache.fontInfoCache.addFont(r);a.setValue(ir.fontInfo,l),this.data.subDocumentInfo.characterImporter.insertText(o),this.data.subDocumentInfo.characterImporter.resetProperties(),this.data.subDocumentInfo.characterImporter.properties.copyFrom(s)}))}}class WN extends PR{processCustomNoteRun(e){this.data.subDocumentInfo.characterImporter.noteDocumentId=e}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("id",this.data.constants.wordProcessingNamespaceConst);let r=this.notes[t];if(!(0,S.isDefined)(r))return;this.data.readerHelper.getWpSTOnOffValue(e,"customMarkFollows",!1)?this.processCustomNoteRun(r):this.insertNoteRun(r)}))}}class zN extends WN{get notes(){return this.data.footNotesImporter.notes}insertNoteRun(e){this.data.footNotesImporter.insertRun(e)}}class jN extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.subDocument.isFootNote()?this.data.footNotesImporter.insertRun():this.data.endNotesImporter.insertRun()}))}}class XN extends WN{get notes(){return this.data.endNotesImporter.notes}insertNoteRun(e){this.data.endNotesImporter.insertRun(e)}}class GN extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const e=new Vl(this.data.subDocumentInfo.positionImporter.currPosition,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle);this.data.subDocumentInfo.characterImporter.addRun(e,an.specialCharacters.ETX)}))}}class KN extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const e=new Wl(this.data.subDocumentInfo.positionImporter.currPosition,this.data.subDocumentInfo.paragraphImporter.paragraph,this.data.subDocumentInfo.characterImporter.charPropsBundle);this.data.subDocumentInfo.characterImporter.addRun(e,an.specialCharacters.EOT)}))}}class qN extends SR{constructor(e){super(e),this.resetProperties()}resetProperties(){this.data.subDocumentInfo.characterImporter.reset()}get elementHandlerTable(){return qN.handlerTable}isChoiceNamespaceSupported(e){const t=e.toLowerCase();return t==this.data.constants.namespaces[ZD.Wps].namespace.toLowerCase()||t==this.data.constants.namespaces[ZD.DrawingMLPicture].prefix.toLowerCase()||t==this.data.constants.namespaces[ZD.Wpg].namespace.toLowerCase()||t==this.data.constants.namespaces[ZD.Wpc].namespace.toLowerCase()||super.isChoiceNamespaceSupported(e)}}qN.handlerTable=(new Eu).add("r",(e=>new $N(e))).add("rPr",(e=>new fL(e,e.subDocumentInfo.characterImporter.properties))).add("t",(e=>new MN(e))).add("noBreakHyphen",(e=>(e.subDocumentInfo.characterImporter.insertText("-"),null))).add("instrText",(e=>new MN(e))).add("cr",(e=>new xN(e))).add("br",(e=>new _N(e))).add("tab",(e=>new UN(e))).add("pict",(e=>new ON(e))).add("object",(e=>new kN(e))).add("fldChar",(e=>new yN(e))).add("drawing",(e=>new eN(e))).add("footnoteReference",(e=>new zN(e))).add("endnoteReference",(e=>new XN(e))).add("footnoteRef",(e=>new jN(e))).add("endnoteRef",(e=>new jN(e))).add("separator",(e=>new GN(e))).add("continuationSeparator",(e=>new KN(e))).add("commentReference",(e=>null)).add("spr",(e=>new HN(e))).add("customObject",(e=>new TN(e))).add("dataContainer",(e=>new vN(e))).add("sym",(e=>new VN(e))).add("delText",(e=>new EN(e))).add("permStart",(e=>new PL(e))).add("permEnd",(e=>new IL(e))).get();class $N extends qN{constructor(e){super(e)}resetProperties(){}}class JN extends SR{get elementHandlerTable(){return JN.handlerTable}}JN.handlerTable=(new Eu).add("smartTag",(e=>new JN(e))).add("r",(e=>new qN(e))).get();class YN extends wN{get elementHandlerTable(){return YN.handlerTable}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("fldLock",this.data.constants.wordProcessingNamespaceConst),r=!rn.StringUtils.isNullOrEmpty(t)&&this.data.readerHelper.isBoolStrict(t);this.processFieldBegin(!1,r,!1);const i=this.createHyperlinkInfo(e);this.data.subDocumentInfo.fieldImporter.fieldInfoStack.last.hyperlinkInfo=i;const n=xd.getNewCodeText(i);this.data.subDocumentInfo.characterImporter.insertText(n),this.processFieldSeparator()}))}processElementClose(e){this.processFieldEnd()}createHyperlinkInfo(e){const t=new xd("","","",!1);for(let r,i=0;r=e.attributes[i];i++){const e=YN.attributeHandlerTable[r.localName];void 0!==e?e(this.data,t,r.value):r.name.indexOf("xmlns")<0&&this.data.options.throwInvalidFile("incorrect hyperlinkInfo")}return t}}YN.handlerTable=(new Eu).add("r",(e=>new qN(e))).add("fldSimple",(e=>new QN(e))).add("hyperlink",(e=>new YN(e))).add("bookmarkStart",(e=>new WR(e))).add("bookmarkEnd",(e=>new VR(e))).add("permStart",(e=>new PL(e))).add("permEnd",(e=>new IL(e))).add("sdt",(e=>new vL(e))).add("customXml",(e=>new TR(e))).add("del",(e=>e.options.ignoreDeletedText?new yR(e):new yL(e))).add("ins",(e=>e.options.ignoreInsertedText?new yR(e):new xL(e))).get(),YN.attributeHandlerTable=(new Eu).add("id",((e,t,r)=>{const i=e.relationsStack.last.lookupRelationById(r);if(null!=i){const e=i.target;if("External"==i.targetMode)t.uri=e;else{const r=e.indexOf("#");t.anchor=e.substring(r)}}})).add("anchor",((e,t,r)=>t.anchor=r)).add("tgtFrame",((e,t,r)=>{})).add("tooltip",((e,t,r)=>t.tip=r)).add("history",((e,t,r)=>t.visited=!e.readerHelper.isBoolStrict(r))).add("docLocation",((e,t,r)=>{})).get();class QN extends wN{get elementHandlerTable(){return QN.handlerTable}processElementOpen(e){return YD(this,void 0,void 0,(function*(){if(this.fieldCode=e.getAttributeNS("instr",this.data.constants.wordProcessingNamespaceConst),rn.StringUtils.isNullOrEmpty(this.fieldCode))return;const t=e.getAttributeNS("fldLock",this.data.constants.wordProcessingNamespaceConst),r=!rn.StringUtils.isNullOrEmpty(t)&&this.data.readerHelper.isBoolStrict(t);this.processFieldBegin(!1,r,!1),this.data.subDocumentInfo.characterImporter.insertText(this.fieldCode),this.processFieldSeparator()}))}processElementClose(e){rn.StringUtils.isNullOrEmpty(this.fieldCode)||this.processFieldEnd()}}QN.handlerTable=(new Eu).add("r",(e=>new qN(e))).add("del",(e=>e.options.ignoreDeletedText?new yR(e):new yL(e))).add("ins",(e=>e.options.ignoreInsertedText?new yR(e):new xL(e))).add("fldSimple",(e=>new QN(e))).add("hyperlink",(e=>new YN(e))).add("sdt",(e=>new vL(e))).add("customXml",(e=>new TR(e))).add("ffData",(e=>null)).get();class ZN extends PR{constructor(e,t){super(e),this.columnInfos=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"w",Bo.Constants.MIN_SAFE_INTEGER);t>0&&this.columnInfos.push(new Sh(t,Math.max(0,this.data.readerHelper.getWpSTIntegerValue(e,"space",Bo.Constants.MIN_SAFE_INTEGER))))}))}}class ek extends SR{get elementHandlerTable(){return ek.handlerTable}get secProps(){return this.data.sectionImporter.properties}static onColumn(e){const t=ek.getThis(e).columnInfos;return t?new ZN(e,t):null}static getThis(e){return e.destinationStack.getThis()}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.secProps.equalWidthColumns=this.data.readerHelper.getWpSTOnOffValue(e,"equalWidth",!1);const t=this.data.readerHelper.getWpSTIntegerValue(e,"num",Bo.Constants.MIN_SAFE_INTEGER);t>0&&(this.secProps.columnCount=t);const r=this.data.readerHelper.getWpSTIntegerValue(e,"space",Bo.Constants.MIN_SAFE_INTEGER);r!=Bo.Constants.MIN_SAFE_INTEGER&&(this.secProps.space=r),this.secProps.equalWidthColumns||(this.columnInfos=this.secProps.columnsInfo)}))}processElementClose(e){this.columnInfos&&(this.columnInfos.length>0?this.secProps.columnsInfo=this.columnInfos:this.secProps.equalWidthColumns=!0,this.columnInfos=null)}}ek.handlerTable=(new Eu).add("col",ek.onColumn).get();class tk extends ML{get elementHandlerTable(){return tk.handlerTable}}tk.handlerTable=(new Eu).add("p",(e=>new oO(e))).add("tbl",(e=>new TB(e))).add("bookmarkStart",ML.onBookmarkStart).add("bookmarkEnd",ML.onBookmarkEnd).add("permStart",ML.onRangePermissionStart).add("permEnd",ML.onRangePermissionEnd).add("sdt",ML.onStructuredDocument).add("customXml",ML.onCustomXml).add("altChunk",(e=>new qR(e))).get();class rk extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("id",this.data.constants.relsNamespaceConst);rn.StringUtils.isNullOrEmpty(t)&&this.data.options.throwInvalidFile("Invalid file. Not found header");const r=e.getAttributeNS("type",this.data.constants.wordProcessingNamespaceConst),i=yield this.data.relationsStack.last.lookupPackageFileStreamByRelationId(t,this.data.documentRootFolder);yield this.data.addRelations(`${this.data.documentRootFolder}/_rels/${QD.getFileName(i.filePath)}.rels`),i.readToFollowingNS(this.isHeader()?"hdr":"ftr",this.data.constants.wordProcessingNamespaceConst)?(this.data.pushCurrentSubDocument(this.createSubDocument(r)),yield this.data.importContent(i,new tk(this.data))):(e.skipElement(),this.data.options.throwInvalidFile("Invalid file. (Don't find header/footer reference)"))}))}processElementClose(e){this.data.altChunkImporter.insertAltChunks(),this.data.fixLastParagraph(),this.data.popCurrentSubDocument(),this.data.relationsStack.pop()}createSubDocument(e){rn.StringUtils.isNullOrEmpty(e)&&(e="default");const t=this.data.sectionImporter.section,r=this.documentModel.createSubDocument(this.isHeader()?yo.Header:yo.Footer,-1,!0);let i;switch(e){case"first":i=Ws.First;break;case"even":i=Ws.Even;break;case"odd":case"default":i=Ws.Odd;break;default:this.data.options.throwInvalidFile("Inknown section type")}return this.isHeader()?t.headers.setObjectIndex(i,this.documentModel.headers.push(r.info)-1):t.footers.setObjectIndex(i,this.documentModel.footers.push(r.info)-1),r}}class ik extends rk{isHeader(){return!1}}class nk extends rk{isHeader(){return!0}}class ok extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.sectionImporter.properties.differentFirstPage=this.data.readerHelper.getWpSTOnOffValue(e,"val")}))}}class ak extends PR{get secProps(){return this.data.sectionImporter.properties}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.secProps.margins.left=this.data.readerHelper.getWpSTIntegerValue(e,"left",this.secProps.margins.left),this.secProps.margins.right=this.data.readerHelper.getWpSTIntegerValue(e,"right",this.secProps.margins.right),this.secProps.margins.top=this.data.readerHelper.getWpSTIntegerValue(e,"top",this.secProps.margins.top),this.secProps.margins.bottom=this.data.readerHelper.getWpSTIntegerValue(e,"bottom",this.secProps.margins.bottom),this.secProps.headerOffset=this.data.readerHelper.getWpSTIntegerValue(e,"header",this.secProps.headerOffset),this.secProps.footerOffset=this.data.readerHelper.getWpSTIntegerValue(e,"footer",this.secProps.footerOffset)}))}}class sk extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"start",Bo.Constants.MIN_SAFE_INTEGER);t!=Bo.Constants.MIN_SAFE_INTEGER&&(this.data.sectionImporter.properties.firstPageNumber=Math.max(0,t),this.data.sectionImporter.properties.continueNumbering=!1)}))}}class lk extends PR{get secProps(){return this.data.sectionImporter.properties}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.secProps.pageSize.width=this.data.readerHelper.getWpSTIntegerValue(e,"w",this.secProps.pageSize.width),this.secProps.pageSize.height=this.data.readerHelper.getWpSTIntegerValue(e,"h",this.secProps.pageSize.height),this.secProps.landscape="landscape"==e.getAttributeNS("orient",this.data.constants.wordProcessingNamespaceConst);const t=this.data.readerHelper.getWpSTIntegerValue(e,"code",Vc.Custom);return this.validatePaperKind(t,this.secProps),Promise.resolve()}))}validatePaperKind(e,t){const r=Ih.calculatePaperSize(e);if(t.pageSize.width<=0&&(t.pageSize.width=t.landscape?r.height:r.width),t.pageSize.height<=0)t.pageSize.height=t.landscape?r.width:r.height;else{const r=t.landscape?new so.Size(t.pageSize.height,t.pageSize.width):t.pageSize.clone();e=Ih.calculatePaperKind(r,Vc.Custom,0,Vc.Letter),t.paperKind=e}}}class dk extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.sectionImporter.properties.startType=this.data.readerHelper.getWpEnumValue(e,"val",NR.sectionStartTypeTable.importMap,Vs.NextPage)}))}}class ck extends PR{get secProps(){return this.data.sectionImporter.properties}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.secProps.lineNumbering;t.countBy=Math.max(0,this.data.readerHelper.getWpSTIntegerValue(e,"countBy",Ph.countBy));const r=this.data.readerHelper.getWpSTIntegerValue(e,"start",Bo.Constants.MIN_SAFE_INTEGER);r!==Bo.Constants.MIN_SAFE_INTEGER&&(t.start=Math.max(0,r)+1);const i=this.data.readerHelper.getWpSTIntegerValue(e,"distance",Ph.distance);i>=0&&(t.distance=i),t.restart=this.data.readerHelper.getWpEnumValue(e,"restart",NR.lineNumberingRestartTable.importMap,Ph.restart)}))}}class hk extends PR{constructor(e,t){super(e),this.footNote=t}}class uk extends hk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.footNote.startingNumber=this.data.readerHelper.getWpSTIntegerValue(e,"val",1)}))}}class pk extends hk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.footNote.numberingRestartType=this.data.readerHelper.getWpEnumValue(e,"val",NR.noteNumberingRestartTypeTable.importMap,Gs.Continuous)}))}}class gk extends SR{static getThis(e){return e.destinationStack.getThis()}constructor(e,t,r){super(e),this.notes=Ql.createDefault(),this.defaultPosition=t,this.defaultFormat=r}get elementHandlerTable(){return gk.handlerTable}processElementClose(e){return YD(this,void 0,void 0,(function*(){this.setProperties(this.notes)}))}createPlacementDestination(e){return new mk(e,this.notes,this.defaultPosition)}createNumberingFormatDestination(e){return new fk(e,this.notes,this.defaultFormat)}}fF=gk,gk.handlerTable=(new Eu).add("pos",(e=>fF.getThis(e).createPlacementDestination(e))).add("numFmt",(e=>fF.getThis(e).createNumberingFormatDestination(e))).add("numStart",(e=>new uk(e,fF.getThis(e).notes))).add("numRestart",(e=>new pk(e,fF.getThis(e).notes))).get();class mk extends hk{constructor(e,t,r){super(e,t),this.defaultPosition=r}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpEnumValue(e,"val",NR.footNotePlacementTable.importMap,this.defaultPosition);this.footNote.position=t}))}}class fk extends hk{constructor(e,t,r){super(e,t),this.defaultNumberingFormat=r}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.footNote.numberingFormat=this.data.readerHelper.getWpEnumValue(e,"val",NR.pageNumberingFormatTable.importMap,this.defaultNumberingFormat)}))}}class bk extends gk{constructor(e){super(e,js.BottomOfPage,Zi.Decimal)}setProperties(e){this.data.sectionImporter.properties.footNote=e}}class Ck extends gk{constructor(e){super(e,js.BottomOfPage,Zi.Decimal)}get elementHandlerTable(){return Ck.handlerTable}setProperties(e){this.data.documentModel.sections[0].sectionProperties.footNote=e}}Ck.handlerTable=(new Eu).append(gk.handlerTable).add("footnote",(e=>new Sk(e))).get();class Sk extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("id",this.data.constants.wordProcessingNamespaceConst);rn.StringUtils.isNullOrEmpty(t)||this.data.footNotesImporter.separatorIds.push(t)}))}}class Ik extends PR{processElementOpen(e){var t;return YD(this,void 0,void 0,(function*(){const r=null!==(t=this.data.sectionImporter.properties.footNote)&&void 0!==t?t:new Ql;r.columnCount=this.data.readerHelper.getWpSTIntegerValue(e,"val",1),this.data.sectionImporter.properties.footNote=r}))}}class Pk extends gk{constructor(e){super(e,js.BottomOfPage,Zi.Decimal)}setProperties(e){this.data.sectionImporter.properties.endNote=e}}class wk extends gk{constructor(e){super(e,js.BottomOfPage,Zi.Decimal)}get elementHandlerTable(){return wk.handlerTable}setProperties(e){this.data.documentModel.sections[0].sectionProperties.endNote=e}processElementClose(e){const t=Object.create(null,{processElementClose:{get:()=>super.processElementClose}});return YD(this,void 0,void 0,(function*(){t.processElementClose.call(this,e),this.data.documentModel.documentEndNotePosition=this.notes.position}))}}wk.handlerTable=(new Eu).append(gk.handlerTable).add("endnote",(e=>new yk(e))).get();class yk extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("id",this.data.constants.wordProcessingNamespaceConst);rn.StringUtils.isNullOrEmpty(t)||this.data.endNotesImporter.separatorIds.push(t)}))}}class xk extends SR{get elementHandlerTable(){return xk.handlerTable}}xk.handlerTable=(new Eu).add("cols",(e=>new ek(e))).add("lnNumType",(e=>new ck(e))).add("pgNumType",(e=>new sk(e))).add("paperSrc",(e=>null)).add("pgMar",(e=>new ak(e))).add("pgSz",(e=>new lk(e))).add("textDirection",(e=>null)).add("textFlow",(e=>null)).add("vAlign",(e=>null)).add("bidi",(e=>null)).add("type",(e=>new dk(e))).add("headerReference",(e=>new nk(e))).add("footerReference",(e=>new ik(e))).add("titlePg",(e=>new ok(e))).add("footnotePr",(e=>new bk(e))).add("endnotePr",(e=>new Pk(e))).add("footnoteColumns",(e=>new Ik(e))).get();class Tk extends xk{}class vk extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst);if(!rn.StringUtils.isNullOrEmpty(t)){const e=this.data.stylesImporter.paragraphManager.getStyleById(t);e&&this.assignParagraphStyle(e)}}))}}class Mk extends vk{assignParagraphStyle(e){this.data.subDocumentInfo.paragraphImporter.style=e}}class Ek extends PR{constructor(e,t){super(e),this.parentDestination=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.parentDestination.listLevelIndex=Math.max(0,Math.min(8,this.data.readerHelper.getWpSTIntegerValue(e,"val",-1)))}))}}class Dk extends PR{constructor(e,t){super(e),this.parentDestination=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t=this.data.readerHelper.getWpSTIntegerValue(e,"val",Bo.Constants.MIN_SAFE_INTEGER);0==t&&(t=ln.NoNumberingListIndex),this.parentDestination.numberingId=t}))}}class Fk extends SR{get listLevelIndex(){return this.paragraphPropertiesDestination.listLevelIndex}set listLevelIndex(e){this.paragraphPropertiesDestination.listLevelIndex=e}get numberingId(){return this.paragraphPropertiesDestination.numberingId}set numberingId(e){this.paragraphPropertiesDestination.numberingId=e}get elementHandlerTable(){return Fk.handlerTable}constructor(e,t){super(e),this.paragraphPropertiesDestination=t,this.paragraphPropertiesDestination.listLevelIndex=-1}static getThis(e){return e.destinationStack.getThis()}}Fk.handlerTable=(new Eu).add("ilvl",(e=>new Ek(e,Fk.getThis(e)))).add("numId",(e=>new Dk(e,Fk.getThis(e)))).get();class Rk extends PR{constructor(e,t){super(e),this.tabs=t}}class Lk extends Rk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"pos",Bo.Constants.MIN_SAFE_INTEGER);if(t==Bo.Constants.MIN_SAFE_INTEGER)return;const r=this.data.readerHelper.getWpEnumValue(e,"leader",NR.tabLeaderTable.importMap,Sg.None),i=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst),n=rn.StringUtils.isNullOrEmpty(i)?Ha.Left:this.data.readerHelper.getWpEnumValueCore(i,(this.data.constants.strictMode?NR.strictTabAlignmentTable:NR.tabAlignmentTable).importMap,Ha.Left);this.tabs.add(new rs(t,n,r,"clear"==i,!1))}))}}class Bk extends Rk{get elementHandlerTable(){return Bk.handlerTable}}Bk.handlerTable=(new Eu).add("tab",((e,t)=>new Lk(e,e.destinationStack.getThis().tabs))).get();class Ak extends gL{assignCharacterStyle(e){this.data.subDocumentInfo.paragraphImporter.parMarkCharacterStyle=e}}class Nk extends PR{constructor(e,t){super(e),this.paragraphProperties=t}setProperty(e){this.paragraphProperties.setValue(this.getDescriptor(),e)}}class kk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpEnumValue(e,"val",NR.borderLineStyleTable.importMap,de.None),r=this.data.documentModel.cache.colorModelInfoCache.getItem(kR.createColorModelInfo(this.data,e,"color")),i=this.data.readerHelper.getWpSTOnOffValue(e,"frame",!1),n=this.data.readerHelper.getWpSTOnOffValue(e,"shadow",!1),o=t==de.None&&r.equals(he.empty)&&0==i&&0==n,a=new Me;o||(a.style=t,a.color=r,a.frame=i,a.shadow=n);const s=this.data.readerHelper.getWpSTIntegerValue(e,"space");s!=Bo.Constants.MIN_SAFE_INTEGER&&(a.offset=g.u.pointsToTwips(s));const l=this.data.readerHelper.getWpSTIntegerValue(e,"sz");l!=Bo.Constants.MIN_SAFE_INTEGER&&(a.width=g.u.pointsToTwipsF(.125*l)),this.setProperty(a)}))}}class Ok extends kk{getDescriptor(){return Ft.betweenBorder}}class _k extends kk{getDescriptor(){return Ft.bottomBorder}}class Uk extends kk{getDescriptor(){return Ft.leftBorder}}class Hk extends kk{getDescriptor(){return Ft.rightBorder}}class Vk extends kk{getDescriptor(){return Ft.topBorder}}class Wk extends Nk{static getThis(e){return e.destinationStack.getThis()}get elementHandlerTable(){return Wk.handlerTable}getDescriptor(){throw new Error(R.D.InternalException)}}Wk.handlerTable=(new Eu).add("top",((e,t)=>new Vk(e,Wk.getThis(e).paragraphProperties))).add("left",((e,t)=>new Uk(e,Wk.getThis(e).paragraphProperties))).add("bottom",((e,t)=>new _k(e,Wk.getThis(e).paragraphProperties))).add("right",((e,t)=>new Hk(e,Wk.getThis(e).paragraphProperties))).add("between",((e,t)=>new Ok(e,Wk.getThis(e).paragraphProperties))).get();class zk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return Ft.contextualSpacing}}class jk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return Ft.keepLinesTogether}}class Xk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return Ft.keepWithNext}}class Gk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val",9);this.setProperty(t<0||t>=9?0:t+1)}))}getDescriptor(){return Ft.outlineLevel}}class Kk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return Ft.pageBreakBefore}}class qk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst);rn.StringUtils.isNullOrEmpty(t)||this.setProperty(this.data.readerHelper.getWpEnumValueCore(t,NR.paragraphAlignmentTable.importMap,Ae.Left))}))}getDescriptor(){return Ft.alignment}}class $k extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t=this.data.readerHelper.getWpSTIntegerValue(e,"left",Bo.Constants.MIN_SAFE_INTEGER);t==Bo.Constants.MIN_SAFE_INTEGER&&(t=this.data.readerHelper.getWpSTIntegerValue(e,"start",Bo.Constants.MIN_SAFE_INTEGER)),t!=Bo.Constants.MIN_SAFE_INTEGER&&this.paragraphProperties.setValue(Ft.leftIndent,t);let r=this.data.readerHelper.getWpSTIntegerValue(e,"right",Bo.Constants.MIN_SAFE_INTEGER);r==Bo.Constants.MIN_SAFE_INTEGER&&(r=this.data.readerHelper.getWpSTIntegerValue(e,"end",Bo.Constants.MIN_SAFE_INTEGER)),r!=Bo.Constants.MIN_SAFE_INTEGER&&this.paragraphProperties.setValue(Ft.rightIndent,r);const i=new AR("firstLine","first-line"),n=this.data.readerHelper.getWpSTIntegerValue(e,i.openXmlValue,Bo.Constants.MIN_SAFE_INTEGER);n!=Bo.Constants.MIN_SAFE_INTEGER&&(n>0?this.setProperty(ke.Indented):n<0?this.setProperty(ke.Hanging):this.setProperty(ke.None),this.paragraphProperties.setValue(Ft.firstLineIndent,Math.abs(n)));const o=this.data.readerHelper.getWpSTIntegerValue(e,"hanging",Bo.Constants.MIN_SAFE_INTEGER);o!=Bo.Constants.MIN_SAFE_INTEGER&&(o>0?this.setProperty(ke.Hanging):o<0?this.setProperty(ke.Indented):this.setProperty(ke.None),this.paragraphProperties.setValue(Ft.firstLineIndent,Math.abs(o)))}))}getDescriptor(){return Ft.firstLineIndentType}}class Jk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return Ft.rightToLeft}}class Yk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(QR.getShadingValue(this.data,e))}))}getDescriptor(){return Ft.shadingInfo}}class Qk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"after",Bo.Constants.MIN_SAFE_INTEGER);t>=0&&this.paragraphProperties.setValue(Ft.spacingAfter,t);const r=this.data.readerHelper.getWpSTIntegerValue(e,"before",Bo.Constants.MIN_SAFE_INTEGER);r>=0&&this.paragraphProperties.setValue(Ft.spacingBefore,r),this.paragraphProperties.setValue(Ft.beforeAutoSpacing,-1==r||this.data.readerHelper.getWpSTOnOffValue(e,new AR("beforeAutospacing","before-autospacing").openXmlValue,!1)),this.paragraphProperties.setValue(Ft.afterAutoSpacing,-1==t||this.data.readerHelper.getWpSTOnOffValue(e,new AR("afterAutospacing","after-autospacing").openXmlValue,!1));const i=this.data.readerHelper.getWpSTIntegerValue(e,"line",Bo.Constants.MIN_SAFE_INTEGER);if(i!=Bo.Constants.MIN_SAFE_INTEGER&&i>0){const t=new AR("lineRule","line-rule"),r=e.getAttributeNS(t.openXmlValue,this.data.constants.wordProcessingNamespaceConst);this.applyLineSpacingValue(i,r)}else i!=Bo.Constants.MIN_SAFE_INTEGER&&this.setProperty(Ne.Single)}))}getDescriptor(){return Ft.lineSpacingType}applyLineSpacingValue(e,t){switch(t){case"at-least":case"atLeast":this.setProperty(Ne.AtLeast),this.paragraphProperties.setValue(Ft.lineSpacing,e);break;case"exact":this.setProperty(Ne.Exactly),this.paragraphProperties.setValue(Ft.lineSpacing,e);break;default:240==e?this.setProperty(Ne.Single):360==e?this.setProperty(Ne.Sesquialteral):480==e?this.setProperty(Ne.Double):(this.setProperty(Ne.Multiple),this.paragraphProperties.setValue(Ft.lineSpacing,e/240))}}}class Zk extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return Ft.suppressHyphenation}}class eO extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return Ft.suppressLineNumbers}}class tO extends Nk{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.setProperty(this.data.readerHelper.getWpSTOnOffValue(e,"val"))}))}getDescriptor(){return Ft.widowOrphanControl}}class rO extends SR{get elementHandlerTable(){return rO.handlerTable}constructor(e,t,r){super(e),this.paragraphProperties=t,this.tabs=r}static getThis(e){return e.destinationStack.getThis()}static getParagraphProperties(e){return rO.getThis(e).paragraphProperties}}rO.handlerTable=(new Eu).add("rPr",(e=>(e.subDocumentInfo.paragraphImporter.resetParMarkCharProperties(),new iO(e,e.subDocumentInfo.paragraphImporter.parMarkCharProperties)))).add("spacing",(e=>new Qk(e,rO.getParagraphProperties(e)))).add("ind",(e=>new $k(e,rO.getParagraphProperties(e)))).add("suppressAutoHyphens",(e=>new Zk(e,rO.getParagraphProperties(e)))).add("suppressLineNumbers",(e=>new eO(e,rO.getParagraphProperties(e)))).add("supressLineNumbers",(e=>new eO(e,rO.getParagraphProperties(e)))).add("contextualSpacing",(e=>new zk(e,rO.getParagraphProperties(e)))).add("bidi",(e=>new Jk(e,rO.getParagraphProperties(e)))).add("pageBreakBefore",(e=>new Kk(e,rO.getParagraphProperties(e)))).add("keepNext",(e=>new Xk(e,rO.getParagraphProperties(e)))).add("keepLines",(e=>new jk(e,rO.getParagraphProperties(e)))).add("widowControl",(e=>new tO(e,rO.getParagraphProperties(e)))).add("jc",(e=>new qk(e,rO.getParagraphProperties(e)))).add("tabs",(e=>new Bk(e,rO.getThis(e).tabs))).add("outlineLvl",(e=>new Gk(e,rO.getParagraphProperties(e)))).add("shd",(e=>new Yk(e,rO.getParagraphProperties(e)))).add("pBdr",(e=>new Wk(e,rO.getParagraphProperties(e)))).get();class iO extends pL{get elementHandlerTable(){return iO.handlerTable}}iO.handlerTable=new Eu(B.StringMapUtils.map(pL.handlerTable,(e=>e))).add("rStyle",((e,t)=>new Ak(e))).get();class nO extends rO{get listLevelIndex(){return this.paragraphDestination.listLevelIndex}set listLevelIndex(e){this.paragraphDestination.listLevelIndex=e}get numberingId(){return this.paragraphDestination.numberingId}set numberingId(e){this.paragraphDestination.numberingId=e}get elementHandlerTable(){return nO.handlerTable}constructor(e,t,r,i){super(e,r,i),this.paragraphDestination=t,e.subDocumentInfo.paragraphImporter.resetParMarkCharProperties().resetParMarkCharacterStyle().resetStyle(),f.ListUtils.clear(i.tabsInfo)}static getThis(e){return e.destinationStack.getThis()}}nO.handlerTable=new Eu(B.StringMapUtils.map(rO.handlerTable,(e=>e))).add("pStyle",(e=>new Mk(e))).add("sectPr",(e=>(e.sectionImporter.shouldInsertSection=!e.subDocumentInfo.tableImporter.isInsideTable,new Tk(e)))).add("numPr",(e=>new Fk(e,nO.getThis(e)))).add("divId",(e=>new dB(e,(t=>{const r=parseInt(t,10),i=e.documentModel.webSettings;i.id==r&&i.isBodyMarginsSet()&&nO.getThis(e).paragraphProperties.setValue(Ft.divId,r)})))).get();class oO extends SR{get elementHandlerTable(){return oO.handlerTable}constructor(e){super(e),this.listLevelIndex=Bo.Constants.MIN_SAFE_INTEGER,this.numberingId=Bo.Constants.MIN_SAFE_INTEGER,this.data.subDocumentInfo.paragraphImporter.resetProperties().resetStyle().resetTabs().resetParMarkCharProperties().resetParMarkCharacterStyle(),this.data.subDocumentInfo.characterImporter.resetProperties(),this.data.subDocument.isMain()&&(this.data.sectionImporter.shouldInsertSection=!1)}static getThis(e){return e.destinationStack.getThis()}isChoiceNamespaceSupported(e){return e.toLowerCase()==this.data.constants.namespaces[ZD.Wps].namespace.toLowerCase()||super.isChoiceNamespaceSupported(e)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("paraId",this.data.constants.w14NamespaceConst);this.data.subDocumentInfo.paragraphImporter.paraId=this.data.readerHelper.getIntegerValueCore(t,Bo.Constants.MIN_SAFE_INTEGER,16)}))}processElementClose(e){this.data.subDocumentInfo.characterImporter.properties=this.data.subDocumentInfo.paragraphImporter.parMarkCharProperties.clone(),this.data.subDocumentInfo.characterImporter.style=this.data.subDocumentInfo.paragraphImporter.parMarkCharacterStyle,this.data.sectionImporter.shouldInsertSection&&this.data.subDocument.isMain()?this.data.sectionImporter.insertSection():this.addNumbering(this.data.subDocumentInfo.paragraphImporter.insertParagraph()),this.data.subDocumentInfo.characterImporter.style=this.data.documentModel.characterStyles[0]}createParagraphPropertiesDestination(){return new nO(this.data,this,this.data.subDocumentInfo.paragraphImporter.properties,this.data.subDocumentInfo.paragraphImporter.tabs)}addNumbering(e){if(this.listLevelIndex=Math.max(0,this.listLevelIndex),this.numberingId!=Bo.Constants.MIN_SAFE_INTEGER){const t=this.data.stylesImporter.findNumberingListInfoById(this.numberingId);t?(e.listLevelIndex=this.listLevelIndex,e.numberingListIndex=t.listIndex):this.numberingId==cn.NoNumberingListIndex&&e.paragraphStyle.getNumberingListIndex()>=QP.minValue&&(e.listLevelIndex=this.listLevelIndex,e.numberingListIndex=cn.NoNumberingListIndex,e.maskedParagraphProperties.getUseValue(Be.UseFirstLineIndent)||(e.maskedParagraphProperties.firstLineIndentType=ke.None,e.maskedParagraphProperties.firstLineIndent=0),e.maskedParagraphProperties.getUseValue(Be.UseLeftIndent)||(e.maskedParagraphProperties.leftIndent=0))}}}oO.handlerTable=(new Eu).add("pPr",(e=>(e.subDocumentInfo.paragraphImporter.properties=Lt.createDefault(e.documentModel),oO.getThis(e).createParagraphPropertiesDestination()))).add("r",(e=>new qN(e))).add("del",(e=>e.options.ignoreDeletedText?new yR(e):new yL(e))).add("ins",(e=>e.options.ignoreInsertedText?new yR(e):new xL(e))).add("pict",(e=>new ON(e))).add("fldSimple",(e=>new QN(e))).add("hyperlink",(e=>new YN(e))).add("fldChar",(e=>new yN(e))).add("instrText",(e=>new MN(e))).add("bookmarkStart",(e=>new WR(e))).add("bookmarkEnd",(e=>new VR(e))).add("permStart",(e=>new PL(e))).add("permEnd",(e=>new IL(e))).add("commentRangeStart",(e=>new XR(e))).add("commentRangeEnd",(e=>new jR(e))).add("smartTag",(e=>new JN(e))).add("sdt",(e=>new vL(e))).add("customXml",(e=>new TR(e))).add("drawing",(e=>new eN(e))).add("altChunk",(e=>new qR(e))).get();class aO extends xk{}class sO extends ML{get elementHandlerTable(){return sO.handlerTable}}sO.handlerTable=(new Eu).add("p",(e=>new oO(e))).add("tbl",(e=>new TB(e))).add("sectPr",(e=>new aO(e))).add("bookmarkStart",ML.onBookmarkStart).add("bookmarkEnd",ML.onBookmarkEnd).add("permStart",ML.onRangePermissionStart).add("permEnd",ML.onRangePermissionEnd).add("commentRangeStart",ML.onCommentStart).add("commentRangeEnd",ML.onCommentEnd).add("sdt",ML.onStructuredDocument).add("altChunk",(e=>new qR(e))).add("customXml",ML.onCustomXml).add("del",ML.onDeleted).add("ins",ML.onInserted).get();class lO extends PR{}class dO extends SR{get elementHandlerTable(){return dO.handlerTable}}dO.handlerTable=(new Eu).add("body",(e=>new sO(e))).add("background",(e=>new OR(e))).add("version",(e=>new lO(e))).get();class cO{}class hO{get newStart(){return this._newStart}set newStart(e){this._newStart=e,this.overrideStart=!0,null!=this.level&&this.applyStartOverride(this.level)}constructor(e){this.documentModel=e}getOverrideListLevel(){return null==this.level&&(this.level=new Qi(this.documentModel,Pe.createDefault(this.documentModel),Lt.createDefault(this.documentModel),new sn),this.applyStartOverride(this.level)),this.level}getOverrideListLevelCore(e){return null!=this.level?this.level:(this.overrideStart&&(e.overrideStart=!0,e.setNewStart(this._newStart)),e)}applyStartOverride(e){this.overrideStart&&(e.overrideStart=!0,e.changeListLevelProperties((e=>e.start=this._newStart)))}}class uO{constructor(){this.levelOverrides=[]}}class pO extends SR{constructor(e){super(e)}get elementHandlerTable(){return pO.handlerTable}static onAbstractNumbering(e,t){return new gO(e)}static onNumbering(e,t){return new mO(e)}}pO.handlerTable=(new Eu).add("abstractNum",pO.onAbstractNumbering).add("num",pO.onNumbering).get();class gO extends SR{get elementHandlerTable(){return gO.handlerTable}constructor(e){super(e),this.list=new dn(e.documentModel),this.info=new cO}static getThis(e){return e.destinationStack.getThis()}static onLevel(e,t){return new xO(e,gO.getThis(e).list)}static onMultilevelType(e,t){return new SO(e,gO.getThis(e).list)}static onName(e,t){return new bO(e,gO.getThis(e).list)}static onUniqueId(e,t){return new CO(e,gO.getThis(e).list)}static onNumberingStyleLink(e,t){return new IO(e,gO.getThis(e).info)}static onStyleLink(e,t){return null}static onTemplate(e,t){return null}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.id=e.getAttributeNS("abstractNumId",this.data.constants.namespaces[ZD.WordProcessing].namespace)}))}processElementClose(e){if(rn.StringUtils.isNullOrEmpty(this.id))return;let t,r=this.list.innerId;const i=f.ListUtils.elementBy(this.data.documentModel.abstractNumberingLists,(e=>e.innerId==r));-1!=r&&i?t=this.data.documentModel.abstractNumberingLists.indexOf(i):(t=this.data.documentModel.abstractNumberingLists.length,this.data.documentModel.abstractNumberingLists.push(this.list)),this.info.abstractNumberingListId=this.id,this.info.abstractNumberingIndex=t,this.data.stylesImporter.addAbstractListInfo(this.info)}}gO.handlerTable=(new Eu).add("lvl",gO.onLevel).add("multiLevelType",gO.onMultilevelType).add("name",gO.onName).add("nsid",gO.onUniqueId).add("numStyleLink",gO.onNumberingStyleLink).add("styleLink",gO.onStyleLink).add("tmpl",gO.onTemplate).get();class mO extends SR{get elementHandlerTable(){return mO.handlerTable}constructor(e){super(e),this.listInfo=new uO}static getThis(e){return e.destinationStack.getThis()}static onAbstractNumberingId(e,t){return new PO(e,mO.getThis(e).listInfo)}static onLevelOverride(e,t){return new wO(e,mO.getThis(e).listInfo)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.listInfo.id=this.data.readerHelper.getWpSTIntegerValue(e,"numId",Number.MIN_VALUE)}))}processElementClose(e){rn.StringUtils.isNullOrEmpty(this.listInfo.abstractNumberingListId)||this.listInfo.id==Number.MIN_VALUE||this.data.stylesImporter.addListInfo(this.listInfo)}}mO.handlerTable=(new Eu).add("abstractNumId",mO.onAbstractNumberingId).add("lvlOverride",mO.onLevelOverride).get();class fO extends PR{constructor(e,t){super(e),this.list=t}}class bO extends fO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}}class CO extends fO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val",Number.MIN_VALUE,16);t!=Number.MIN_VALUE&&(this.list.innerId=Math.abs(t))}))}}class SO extends fO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.readerHelper.getWpEnumValue(e,"val",NR.numberingListTypeTable.importMap,tn.Simple)!=tn.MultiLevel&&this.setHybridListType()}))}setHybridListType(){const e=this.list.levels.length;for(let t=0;t<e;t++){this.list.levels[t].changeListLevelProperties((e=>{0===e.templateCode&&(e.templateCode=Tw.generateNewTemplateCode(this.data.documentModel))}))}}}class IO extends PR{constructor(e,t){super(e),this.info=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst);t&&(this.info.numberingStyleReferenceIndex=t)}))}}class PO extends PR{constructor(e,t){super(e),this.listInfo=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.listInfo.abstractNumberingListId=e.getAttributeNS("val",this.data.constants.namespaces[ZD.WordProcessing].namespace)}))}}class wO extends PR{get elementHandlerTable(){return wO.handlerTable}constructor(e,t){super(e),this.listInfo=t,this.levelOverride=new hO(this.data.documentModel)}static getThis(e){return e.destinationStack.getThis()}static onLevelOverride(e,t){const r=wO.getThis(e);return r.overrideRead=!0,new TO(e,r.levelOverride)}static onLevelStartOverride(e,t){const r=wO.getThis(e);return r.overrideRead=!0,new vO(e,r.levelOverride)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.levelOverride.levelIndex=this.data.readerHelper.getWpSTIntegerValue(e,"ilvl",Number.MIN_VALUE)}))}processElementClose(e){this.levelOverride.levelIndex<0||this.levelOverride.levelIndex>=9||!this.overrideRead||this.listInfo.levelOverrides.push(this.levelOverride)}}wO.handlerTable=(new Eu).add("lvl",wO.onLevelOverride).add("startOverride",wO.onLevelStartOverride).get();class yO extends SR{get elementHandlerTable(){return yO.handlerTable}get levelIndex(){return this._levelIndex}set levelIndex(e){this._levelIndex=e}constructor(e){super(e)}static getThis(e){return e.destinationStack.getThis()}static createElementHandlerTable(){return(new Eu).add("isLgl",yO.onLegalNumbering).add("lvlJc",yO.onTextAlignment).add("lvlRestart",yO.onRestart).add("lvlText",yO.onText).add("start",yO.onStart).add("suff",yO.onSuffix).add("numFmt",yO.onNumberingFormat).add("pPr",yO.onParagraphProperties).add("rPr",yO.onRunProperties).add("legacy",yO.onLegacy)}static onTextAlignment(e,t){return new EO(e,yO.getThis(e))}static onRestart(e,t){return new LO(e,yO.getThis(e))}static onText(e,t){return new RO(e,yO.getThis(e))}static onStart(e,t){return new DO(e,yO.getThis(e))}static onSuffix(e,t){return new BO(e,yO.getThis(e))}static onNumberingFormat(e,t){return new AO(e,yO.getThis(e))}static onParagraphProperties(e,t){return new _O(e,yO.getThis(e).level)}static onRunProperties(e,t){return new OO(e,yO.getThis(e).level)}static onLegalNumbering(e,t){return new NO(e,yO.getThis(e))}static onLegacy(e,t){return new FO(e,yO.getThis(e))}}yO.handlerTable=yO.createElementHandlerTable().get();class xO extends yO{get elementHandlerTable(){return xO.handlerTable}constructor(e,t){super(e),this.list=t}static onParagraphStyleReference(e,t){return new kO(e,yO.getThis(e))}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.levelIndex=this.data.readerHelper.getWpSTIntegerValue(e,"ilvl",0),this.level=this.list.createLevel(this.levelIndex),this.levelProperties=this.level.getListLevelProperties().clone(),this.levelProperties.templateCode=this.data.readerHelper.getWpSTIntegerValue(e,"tplc",0,16)}))}processElementClose(e){this.level.setListLevelProperties(this.levelProperties),this.levelIndex<0||this.levelIndex>=9||(this.list.levels[this.levelIndex]=this.level)}}xO.handlerTable=yO.createElementHandlerTable().add("pStyle",xO.onParagraphStyleReference).get();class TO extends yO{constructor(e,t){super(e),this.levelOverride=t,this.level=t.getOverrideListLevel(),this.levelProperties=this.level.getListLevelProperties().clone()}get levelIndex(){return this.levelOverride.levelIndex}processElementOpen(e){const t=Object.create(null,{processElementOpen:{get:()=>super.processElementOpen}});return YD(this,void 0,void 0,(function*(){t.processElementOpen.call(this,e),this.level.changeListLevelProperties((t=>t.templateCode=this.data.readerHelper.getWpSTIntegerValue(e,"tplc",0,16)))}))}processElementClose(e){this.level.setListLevelProperties(this.levelProperties)}}class vO extends PR{constructor(e,t){super(e),this.levelOverride=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.levelOverride.newStart=this.data.readerHelper.getWpSTIntegerValue(e,"val",0)}))}}class MO extends PR{constructor(e,t){super(e),this.levelDestination=t}get properties(){return this.levelDestination.levelProperties}}class EO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.properties.alignment=this.data.readerHelper.getWpEnumValue(e,"val",NR.listNumberAlignmentTable.importMap,en.Left)}))}}class DO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.properties.start=Math.max(0,this.data.readerHelper.getWpSTIntegerValue(e,"val"))}))}}class FO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.properties.legacy=!0,this.properties.legacySpace=this.data.readerHelper.getWpSTIntegerValue(e,"legacySpace",0),this.properties.legacyIndent=this.data.readerHelper.getWpSTIntegerValue(e,"legacyIndent",0)}))}}class RO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t=e.getAttributeNS("val",this.data.constants.namespaces[ZD.WordProcessing].namespace);null==t&&(t=""),Bb.isEnabled(this.data.documentModel.options.numberingBulleted)||(t=this.replaceStringFormatInBulletNumbering(t)),!Bb.isEnabled(this.data.documentModel.options.numberingSimple)&&Bb.isEnabled(this.data.documentModel.options.numberingBulleted)&&(t=this.replaceStringFormatInSimpleNumbering(),this.levelDestination.level.getCharacterProperties().fontInfo.name="Symbol"),this.properties.displayFormatString=this.convertFormatString(t)}))}replaceStringFormatInBulletNumbering(e){return this.convertFormatString(e)==e?"%1.":e}replaceStringFormatInSimpleNumbering(){return"·"}convertFormatString(e){const t=new RegExp(/%\d/);let r=e.replace("{","{{").replace("}","}}"),i=r.match(t);if(i)do{const e=i[0],n=e.search(/\d/),o=parseInt(e.substr(n,1),10);r=r.replace(t,"{"+(o-1)+"}"),i=r.match(t)}while(i);return r}}class LO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=Math.min(9,Math.max(0,this.data.readerHelper.getWpSTIntegerValue(e,"val")));this.properties.relativeRestartLevel=this.levelDestination.levelIndex-t}))}}class BO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.properties.separator=String.fromCharCode(this.data.readerHelper.getWpEnumValue(e,"val",NR.listNumberSeparatorTable.importMap,an.specialCharacters.TabMark.charCodeAt(0)))}))}}class AO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){let t=this.data.readerHelper.getWpEnumValue(e,"val",NR.pageNumberingFormatTable.importMap,Zi.Decimal);t==Zi.Bullet&&!Bb.isEnabled(this.data.documentModel.options.numberingBulleted)&&Bb.isEnabled(this.data.documentModel.options.numberingSimple)?t=Zi.Decimal:t==Zi.Decimal&&!Bb.isEnabled(this.data.documentModel.options.numberingSimple)&&Bb.isEnabled(this.data.documentModel.options.numberingBulleted)&&(t=Zi.Bullet),this.properties.format=t}))}}class NO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.properties.convertPreviousLevelNumberingToDecimal=this.data.readerHelper.getWpSTOnOffValue(e,"val")}))}}class kO extends MO{constructor(e,t){super(e,t)}processElementOpen(e){return YD(this,void 0,void 0,(function*(){}))}}class OO extends pL{constructor(e,t){super(e,null),this.level=t,this.characterProperties=Pe.createDefault(this.data.documentModel)}processElementClose(e){this.level.setCharacterProperties(this.characterProperties)}}class _O extends rO{constructor(e,t){super(e,null,new ts),this.paragraphProperties=Lt.createDefault(this.data.documentModel),this.level=t}get numberingId(){return-1}set numberingId(e){}get listLevelIndex(){return-1}set listLevelIndex(e){}processElementClose(e){this.level.setParagraphProperties(this.paragraphProperties)}}class UO{clone(){const e=new UO;return e.name=this.name,e.uri=this.uri,e.value=this.value,e}}class HO extends SR{get elementHandlerTable(){return HO.handlerTable}}HO.handlerTable=(new Eu).add("compatSetting",(e=>new VO(e))).get();class VO extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=new UO;t.name=this.data.readerHelper.readAttribute(e,"name"),t.uri=this.data.readerHelper.readAttribute(e,"uri"),t.value=this.data.readerHelper.readAttribute(e,"val"),this.data.documentModel.compatSettings.push(t),this.processSetting(e,t)}))}processSetting(e,t){"compatibilityMode"==t.name&&(this.data.documentModel.compatibilitySettings.compatibilityMode=this.data.readerHelper.getWpSTIntegerValue(e,"val",yg.Word2007))}}class WO extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTIntegerValue(e,"val",Bo.Constants.MIN_SAFE_INTEGER);t>0&&(this.data.documentModel.defaultTabWidth=Math.max(1,t))}))}}class zO extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.documentModel.differentOddAndEvenPages=this.data.readerHelper.getWpSTOnOffValue(e,"val")}))}}class jO{static decodeArrayBuffer(e){const t=new ArrayBuffer(e.length/4*3);return jO.decode(e,t),t}static decode(e,t=null){let r=jO.removePaddingChars(e);r=jO.removePaddingChars(r),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");const i=r.length/4*3,n=t?new Uint8Array(t):new Uint8Array(i);for(let e=0,t=0;e<i;e+=3){const i=jO._keyStr.indexOf(r.charAt(t++)),o=jO._keyStr.indexOf(r.charAt(t++)),a=jO._keyStr.indexOf(r.charAt(t++)),s=jO._keyStr.indexOf(r.charAt(t++)),l=i<<2|o>>4,d=(15&o)<<4|a>>2,c=(3&a)<<6|s;n[e]=l,64!=a&&(n[e+1]=d),64!=s&&(n[e+2]=c)}return n}static getBitesFromInt(e){const t=new ArrayBuffer(4);return new DataView(t).setInt32(0,e,!1),new Uint8Array(t)}static removePaddingChars(e){return 64==jO._keyStr.indexOf(e.charAt(e.length-1))?e.substring(0,e.length-1):e}}jO._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";class XO extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.documentModel.documentProtectionProperties=new Go,r=this.data.readerHelper.readAttribute(e,"hash");rn.StringUtils.isNullOrEmpty(r)||(t.passwordHash=jO.decode(r));const i=this.data.readerHelper.readAttribute(e,"salt");rn.StringUtils.isNullOrEmpty(i)||(t.passwordPrefix=jO.decode(i));const n=this.data.readerHelper.readAttribute(e,"unprotectPassword");if(!rn.StringUtils.isNullOrEmpty(n)&&"00000000"!=n){let e=parseInt(n,16);if(!isNaN(e)){e=e<<24&4278190080|e<<8&16711680|e>>8&65280|e>>24&255,t.word2003PasswordHash=jO.getBitesFromInt(e)}}const o=this.data.readerHelper.readAttribute(e,"cryptProviderType");rn.StringUtils.isNullOrEmpty(o)||(t.cryptProviderType="rsaAES"==o?Ro.RsaAES:Ro.RsaFull);const a=this.data.readerHelper.readAttribute(e,"edit");"readOnly"!=a&&"read-only"!=a||(t.protectionType=Mo.ReadOnly),"comments"==a&&(t.protectionType=Mo.AllowComments),t.enforceProtection=this.data.readerHelper.getWpSTOnOffValue(e,"enforcement",!1),t.hashAlgorithmType=this.data.readerHelper.getWpSTIntegerValue(e,"cryptAlgorithmSid",0),t.hashIterationCount=this.data.readerHelper.getWpSTIntegerValue(e,"cryptSpinCount",1)}))}}class GO extends SR{get elementHandlerTable(){return GO.handlerTable}}GO.handlerTable=(new Eu).add("docVar",(e=>new KO(e))).get();class KO extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.readAttribute(e,"name"),r=this.data.readerHelper.readAttribute(e,"val");rn.StringUtils.isNullOrEmpty(t)||rn.StringUtils.isNullOrEmpty(r)||this.data.documentModel.docVariables.addValue(t,r)}))}}class qO extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.getWpSTOnOffValue(e,"val",!0);this.data.documentModel.mirrorMargins=t}))}}class $O extends SR{get elementHandlerTable(){return $O.handlerTable}}$O.handlerTable=(new Eu).add("defaultTabStop",(e=>new WO(e))).add("evenAndOddHeaders",(e=>new zO(e))).add("documentProtection",(e=>new XO(e))).add("compat",(e=>new HO(e))).add("docVars",(e=>new GO(e))).add("mirrorMargins",(e=>new qO(e))).add("footnotePr",(e=>new Ck(e))).add("endnotePr",(e=>new wk(e))).get();class JO extends tL{readFontName(e){const t=e.getAttributeNS("ascii",this.data.constants.wordProcessingNamespaceConst);if(!rn.StringUtils.isNullOrEmpty(t))return t;const r=e.getAttributeNS(new AR("hAnsi","h-ansi").openXmlValue,this.data.constants.wordProcessingNamespaceConst);if(!rn.StringUtils.isNullOrEmpty(r))return r;const i=e.getAttributeNS("cs",this.data.constants.wordProcessingNamespaceConst);if(!rn.StringUtils.isNullOrEmpty(i))return i;const n=e.getAttributeNS("eastAsia",this.data.constants.wordProcessingNamespaceConst);return rn.StringUtils.isNullOrEmpty(n)?_n.defaultFontName:n}}class YO extends pL{get elementHandlerTable(){return YO.handlerTable}}YO.handlerTable=new Eu(B.StringMapUtils.map(pL.handlerTable,(e=>e))).add("rFonts",(e=>new JO(e,e.destinationStack.getThis().characterProperties))).get();class QO extends SR{get elementHandlerTable(){return QO.handlerTable}processElementOpen(e){const t=Object.create(null,{processElementOpen:{get:()=>super.processElementOpen}});return YD(this,void 0,void 0,(function*(){t.processElementOpen.call(this,e);const r=this.data.documentModel.defaultCharacterProperties;r.setValue(ir.size,10),r.setValue(ir.fontInfo,this.data.documentModel.cache.fontInfoCache.getItemByName(_n.fallbackFontName))}))}}QO.handlerTable=(new Eu).add("rPr",(e=>new YO(e,e.documentModel.defaultCharacterProperties))).get();class ZO extends rO{get elementHandlerTable(){return rO.handlerTable}get numberingId(){return cn.NumberingListNotSettedIndex}set numberingId(e){}get listLevelIndex(){return cn.NumberingListNotSettedIndex}set listLevelIndex(e){}}class e_ extends SR{get elementHandlerTable(){return e_.handlerTable}}e_.handlerTable=(new Eu).add("pPr",(e=>new ZO(e,e.documentModel.defaultParagraphProperties,new ts))).get();class t_ extends SR{get elementHandlerTable(){return t_.handlerTable}}t_.handlerTable=(new Eu).add("pPrDefault",(e=>new e_(e))).add("rPrDefault",(e=>new QO(e))).get();class r_ extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.stylesImporter.currImporter.currInfo.linkedId=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst)}))}}class i_ extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.stylesImporter.currImporter.currInfo.nextId=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst)}))}}class n_ extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.stylesImporter.currImporter.currInfo.hidden=this.data.readerHelper.getWpSTOnOffValue(e,"val")}))}}class o_ extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.stylesImporter.currImporter.currInfo.name=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst)}))}}class a_ extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.stylesImporter.currImporter.currInfo.parentId=e.getAttributeNS("val",this.data.constants.wordProcessingNamespaceConst)}))}}class s_ extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.stylesImporter.currImporter.currInfo.qFormat=this.data.readerHelper.getWpSTOnOffValue(e,"val",!0)}))}}class l_ extends PR{processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.stylesImporter.currImporter.currInfo.semiHidden=this.data.readerHelper.getWpSTOnOffValue(e,"val")}))}}class d_{}class c_ extends rO{get elementHandlerTable(){return c_.handlerTable}get numberingId(){return this.styleDestination.numberingId}set numberingId(e){this.styleDestination.numberingId=e}get listLevelIndex(){return this.styleDestination.listLevelIndex}set listLevelIndex(e){this.styleDestination.listLevelIndex=e}constructor(e,t,r,i){super(e,r,i),this.styleDestination=t}static getThis(e){return e.destinationStack.getThis()}}c_.handlerTable=new Eu(B.StringMapUtils.map(rO.handlerTable,(e=>e))).add("numPr",(e=>new Fk(e,c_.getThis(e)))).get();class h_ extends pL{}class u_ extends XL{}class p_ extends lB{}class g_ extends SB{}class m_ extends SR{constructor(e){super(e),this.numberingId=cn.NumberingListNotSettedIndex,this.characterFormatting=new Pe,this.paragraphFormatting=new Lt,this.tableProperties=new mr,this.tableRowProperties=new za,this.tableCellProperties=new cr,this.tabs=new ts}static getThis(e){return e.destinationStack.getThis()}}m_.handlerTable=(new Eu).add("pPr",(e=>{const t=m_.getThis(e),r=t.paragraphFormatting;return r.setUseValue(Be.UseAll,!1),new c_(e,t,r,t.tabs)})).add("rPr",(e=>{const t=m_.getThis(e).characterFormatting;return t.setUseValue(ie.UseAll,!1),new h_(e,t)})).add("tblPr",(e=>{const t=m_.getThis(e).tableProperties;return t.setUseValue(ur.UseAll,!1),new p_(e,new Ja(t,null),t)})).add("trPr",(e=>{const t=m_.getThis(e).tableRowProperties;return t.setUseValue(Ua.UseAll,!1),new g_(e,new Ld(null,t))})).add("tcPr",(e=>{const t=m_.getThis(e).tableCellProperties;return t.setUseValue(Ye.UseAll,!1),new u_(e,new Rd(null,t))})).get();class f_ extends m_{constructor(){super(...arguments),this.conditionType=qe.WholeTable}get elementHandlerTable(){return m_.handlerTable}processElementOpen(e){const t=Object.create(null,{processElementOpen:{get:()=>super.processElementOpen}});return YD(this,void 0,void 0,(function*(){t.processElementOpen.call(this,e);const r=e.getAttributeNS("type",this.data.constants.wordProcessingNamespaceConst);this.conditionType=rn.StringUtils.isNullOrEmpty(r)?qe.WholeTable:this.data.readerHelper.getWpEnumValueCore(r,NR.conditionalTableStyleFormattingTypesTable.importMap,qe.WholeTable)}))}processElementClose(e){super.processElementClose(e);const t=new d_;t.conditionType=this.conditionType,t.characterFormatting=this.characterFormatting,t.paragraphFormatting=this.paragraphFormatting,t.tableProperties=this.tableProperties,t.tableCellProperties=this.tableCellProperties,t.tableRowProperties=this.tableRowProperties,t.tabs=this.tabs,this.data.stylesImporter.tableManager.conditionalTableFormattingInfoList.push(t)}}f_.condtionTypesTable=(new Eu).add("band1Horz",qe.OddRowBanding).add("band1Vert",qe.OddColumnBanding).add("band2Horz",qe.EvenRowBanding).add("band2Vert",qe.EvenColumnBanding).add("firstCol",qe.FirstColumn).add("firstRow",qe.FirstRow).add("lastCol",qe.LastColumn).add("lastRow",qe.LastRow).add("neCell",qe.TopRightCell).add("nwCell",qe.TopLeftCell).add("seCell",qe.BottomRightCell).add("swCell",qe.BottomLeftCell).add("wholeTable",qe.WholeTable).get();class b_ extends m_{get currImporter(){return this.data.stylesImporter.currImporter}get elementHandlerTable(){return b_.handlerTable}processElementOpen(e){const t=Object.create(null,{processElementOpen:{get:()=>super.processElementOpen}});return YD(this,void 0,void 0,(function*(){switch(t.processElementOpen.call(this,e),e.getAttributeNS("type",this.data.constants.namespaces[ZD.WordProcessing].namespace)){case"character":this.data.stylesImporter.currImporter=this.data.stylesImporter.characterManager;break;case"table":this.data.stylesImporter.currImporter=this.data.stylesImporter.tableManager;break;case"tableCell":this.data.stylesImporter.currImporter=this.data.stylesImporter.tableCellManager;break;case"numbering":this.data.stylesImporter.currImporter=this.data.stylesImporter.numberingListManager;break;default:this.data.stylesImporter.currImporter=this.data.stylesImporter.paragraphManager}this.currImporter.startImport(),this.currImporter.currInfo.id=e.getAttributeNS("styleId",this.data.constants.namespaces[ZD.WordProcessing].namespace),this.currImporter.currInfo.isDefault=this.data.readerHelper.getWpSTOnOffValue(e,"default",!1)}))}processElementClose(e){super.processElementClose(e),this.currImporter.endImport(this)}}b_.handlerTable=new Eu(B.StringMapUtils.map(m_.handlerTable,(e=>e))).add("basedOn",((e,t)=>new a_(e))).add("hidden",((e,t)=>new n_(e))).add("qFormat",((e,t)=>new s_(e))).add("semiHidden",((e,t)=>new l_(e))).add("name",((e,t)=>new o_(e))).add("link",((e,t)=>new r_(e))).add("next",((e,t)=>new i_(e))).add("tblStylePr",((e,t)=>new f_(e))).get();class C_ extends SR{get elementHandlerTable(){return C_.handlerTable}}C_.handlerTable=(new Eu).add("docDefaults",(e=>new t_(e))).add("style",(e=>new b_(e))).get();class S_ extends GA{setColorPropertyValue(e){const t=this.data.readerHelper.getIntegerValue(e,"hue",Bo.Constants.MIN_SAFE_INTEGER),r=this.data.readerHelper.getIntegerValue(e,"sat",Bo.Constants.MIN_SAFE_INTEGER),i=this.data.readerHelper.getIntegerValue(e,"lum",Bo.Constants.MIN_SAFE_INTEGER);t!=Bo.Constants.MIN_SAFE_INTEGER&&r!=Bo.Constants.MIN_SAFE_INTEGER&&i!=Bo.Constants.MIN_SAFE_INTEGER||this.data.options.throwInvalidFile("Incorrect hsl value"),this.colorModelInfo.hsl=new H(t,r,i)}}class I_ extends GA{setColorPropertyValue(e){const t=this.data.readerHelper.getIntegerValue(e,"r",Bo.Constants.MIN_SAFE_INTEGER),r=this.data.readerHelper.getIntegerValue(e,"g",Bo.Constants.MIN_SAFE_INTEGER),i=this.data.readerHelper.getIntegerValue(e,"b",Bo.Constants.MIN_SAFE_INTEGER);t!=Bo.Constants.MIN_SAFE_INTEGER&&r!=Bo.Constants.MIN_SAFE_INTEGER&&i!=Bo.Constants.MIN_SAFE_INTEGER||this.data.options.throwInvalidFile("Invalid sc color"),this.colorModelInfo.scRgb=new Ln(t,r,i)}}class P_ extends GA{setColorPropertyValue(e){const t=this.data.readerHelper.getWpEnumValue(e,"val",NR.systemColorTable.importMap,xn.Empty);t==xn.Empty&&this.data.options.throwInvalidFile("Invalid color values"),this.colorModelInfo.systemColor=t}}class w_ extends SR{constructor(e,t){super(e),this.color=t,this.hasColor=!1}static getColor(e){const t=e.destinationStack.getThis();return t.hasColor=!0,t.color}}w_.handlerTable=(new Eu).add("hslClr",(e=>new S_(e,w_.getColor(e)))).add("prstClr",(e=>new qA(e,w_.getColor(e)))).add("schemeClr",(e=>new $A(e,w_.getColor(e)))).add("scrgbClr",(e=>new I_(e,w_.getColor(e)))).add("srgbClr",(e=>new KA(e,w_.getColor(e)))).add("sysClr",(e=>new P_(e,w_.getColor(e)))).get();class y_ extends w_{get elementHandlerTable(){return y_.handlerTable}}y_.handlerTable=B.StringMapUtils.shallowCopy(w_.handlerTable);class x_ extends y_{constructor(e,t){super(e,new Pp(new Bn)),this.themeColorIndex=t}processElementClose(e){return YD(this,void 0,void 0,(function*(){this.data.documentModel.colorProvider.officeTheme.colors.setDrawingColor(this.themeColorIndex,this.color)}))}}class T_ extends SR{get elementHandlerTable(){return T_.handlerTable}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.documentModel.colorProvider.officeTheme.colors.name=this.data.readerHelper.readAttribute(e,"name")}))}}T_.handlerTable=(new Eu).add("dk1",(e=>new x_(e,ce.Dark1))).add("lt1",(e=>new x_(e,ce.Light1))).add("dk2",(e=>new x_(e,ce.Dark2))).add("lt2",(e=>new x_(e,ce.Light2))).add("accent1",(e=>new x_(e,ce.Accent1))).add("accent2",(e=>new x_(e,ce.Accent2))).add("accent3",(e=>new x_(e,ce.Accent3))).add("accent4",(e=>new x_(e,ce.Accent4))).add("accent5",(e=>new x_(e,ce.Accent5))).add("accent6",(e=>new x_(e,ce.Accent6))).add("hlink",(e=>new x_(e,ce.Hyperlink))).add("folHlink",(e=>new x_(e,ce.FollowedHyperlink))).get();class v_ extends PR{constructor(e,t){super(e),this.textFont=t}processElementOpen(e){return YD(this,void 0,void 0,(function*(){const t=this.data.readerHelper.readAttribute(e,"typeface");rn.StringUtils.isNullOrEmpty(t)||(this.textFont.typeface=t);const r=this.data.readerHelper.readAttribute(e,"panose");rn.StringUtils.isNullOrEmpty(r)||20==r.length||this.data.options.throwInvalidFile("Invalid fonts"),rn.StringUtils.isNullOrEmpty(r)||(this.textFont.panose=r);const i=this.data.readerHelper.getIntegerValue(e,"pitchFamily",Co.DefaultPitchFamily);Math.abs(i)>Bo.Constants.MAX_BYTE&&this.data.options.throwInvalidFile("Invalid fonts"),this.textFont.pitchFamily=i;const n=this.data.readerHelper.getIntegerValue(e,"charset",Co.DefaultCharset);Math.abs(n)>Bo.Constants.MAX_BYTE&&this.data.options.throwInvalidFile("Invalid fonts"),this.textFont.charset=n}))}}class M_ extends PR{constructor(e,t){super(e),this.fontPart=t}processElementClose(e){const t=this.data.readerHelper.readAttribute(e,"script"),r=this.data.readerHelper.readAttribute(e,"typeface");rn.StringUtils.isNullOrEmpty(t)&&rn.StringUtils.isNullOrEmpty(r)&&this.data.options.throwInvalidFile("Invalid fonts"),this.fontPart.addSupplementalFont(t,r)}}class E_ extends SR{get elementHandlerTable(){return E_.handlerTable}get latin(){return this.fontPart.latin}get eastAsian(){return this.fontPart.eastAsian}get complexScript(){return this.fontPart.complexScript}get fonts(){return this.fontPart.supplementalFonts}constructor(e,t){super(e),this.hasLatin=!1,this.hasEastAsian=!1,this.hasComplexScript=!1,this.fontPart=t}static getThis(e){return e.destinationStack.getThis()}processElementClose(e){this.fontPart.isValid=this.hasLatin&&this.hasEastAsian&&this.hasComplexScript&&!rn.StringUtils.isNullOrEmpty(this.latin.typeface)&&null!=this.eastAsian.typeface&&null!=this.complexScript.typeface}}E_.handlerTable=(new Eu).add("latin",(e=>{const t=E_.getThis(e);return t.hasLatin=!0,new v_(e,t.latin)})).add("ea",(e=>{const t=E_.getThis(e);return t.hasEastAsian=!0,new v_(e,t.eastAsian)})).add("cs",(e=>{const t=E_.getThis(e);return t.hasComplexScript=!0,new v_(e,t.complexScript)})).add("font",(e=>new M_(e,E_.getThis(e).fontPart))).get();class D_ extends SR{static getThis(e){return e.destinationStack.getThis()}get elementHandlerTable(){return D_.handlerTable}get majorFont(){return this.data.documentModel.colorProvider.officeTheme.fontScheme.majorFont}get minorFont(){return this.data.documentModel.colorProvider.officeTheme.fontScheme.minorFont}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.documentModel.colorProvider.officeTheme.fontScheme.name=this.data.readerHelper.readAttribute(e,"name")}))}}D_.handlerTable=(new Eu).add("majorFont",(e=>new E_(e,D_.getThis(e).majorFont))).add("minorFont",(e=>new E_(e,D_.getThis(e).minorFont))).get();class F_ extends SR{get elementHandlerTable(){return F_.handlerTable}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.data.documentModel.colorProvider.officeTheme.formatScheme.name=this.data.readerHelper.readAttribute(e,"name")}))}}F_.handlerTable=(new Eu).get();class R_ extends SR{get elementHandlerTable(){return R_.handlerTable}}R_.handlerTable=(new Eu).add("clrScheme",(e=>new T_(e))).add("fontScheme",(e=>new D_(e))).add("fmtScheme",(e=>new F_(e))).get();class L_ extends SR{get elementHandlerTable(){return L_.handlerTable}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.name=this.data.readerHelper.readAttribute(e,"name"),rn.StringUtils.isNullOrEmpty(this.name)||(this.data.documentModel.colorProvider.officeTheme.name=this.name)}))}}L_.handlerTable=(new Eu).add("themeElements",(e=>new R_(e))).get();class B_ extends ML{get elementHandlerTable(){return tk.handlerTable}processElementOpen(e){return YD(this,void 0,void 0,(function*(){this.type=this.data.readerHelper.getWpEnumValue(e,"type",NR.noteTypeTable.importMap,Xs.Normal);const t=this.createSubDocument(this.SubDocumentType);t.info.noteType=this.type,this.data.pushCurrentSubDocument(t),this.id=e.getAttributeNS("id",this.data.constants.wordProcessingNamespaceConst)}))}processElementClose(e){return YD(this,void 0,void 0,(function*(){this.data.fixLastParagraph();const e=this.data.popCurrentSubDocument();this.subDocId=e.id,this.addNote(this.id,this.subDocId,this.type)||this.data.documentModel.subDocumentsCollection.delete(this.subDocId)}))}createSubDocument(e){return this.documentModel.createSubDocument(e,uu.MAIN_SUBDOCUMENT_ID,!0)}}B_.handlerTable=(new Eu).add("p",(e=>new oO(e))).add("tbl",(e=>new TB(e))).add("bookmarkStart",ML.onBookmarkStart).add("bookmarkEnd",ML.onBookmarkEnd).add("permStart",ML.onRangePermissionStart).add("permEnd",ML.onRangePermissionEnd).add("sdt",ML.onStructuredDocument).add("customXml",ML.onCustomXml).get();class A_ extends SR{get elementHandlerTable(){return A_.handlerTable}}A_.handlerTable=(new Eu).add("footnote",(e=>new N_(e))).get();class N_ extends B_{get SubDocumentType(){return yo.FootNote}addNote(e,t,r){return!!this.canAddFootNote(e,r)&&(r==Xs.Normal?this.data.footNotesImporter.notes[e]=t:this.documentModel.footNoteSeparators.setSeparator(t,r),!0)}canAddFootNote(e,t){return!rn.StringUtils.isNullOrEmpty(e)&&(t==Xs.Normal?!(e in this.data.footNotesImporter.notes):!this.documentModel.footNoteSeparators.getSeparator(t)&&this.data.footNotesImporter.separatorIds.includes(e))}}class k_ extends SR{get elementHandlerTable(){return k_.handlerTable}}k_.handlerTable=(new Eu).add("endnote",(e=>new O_(e))).get();class O_ extends B_{get SubDocumentType(){return yo.EndNote}addNote(e,t,r){return!!this.canAddEndNote(e,r)&&(r==Xs.Normal?this.data.endNotesImporter.notes[e]=t:this.documentModel.endNoteSeparators.setSeparator(t,r),!0)}canAddEndNote(e,t){return!rn.StringUtils.isNullOrEmpty(e)&&(t==Xs.Normal?!(e in this.data.endNotesImporter.notes):null==this.documentModel.endNoteSeparators.getSeparator(t)&&this.data.endNotesImporter.separatorIds.includes(e))}}class __{constructor(e){this.asyncImportFromFile=!0,this.options=e}importFromFile(e,t,r,i){return YD(this,void 0,void 0,(function*(){this.reject=i,this.callback=r;const n=new Mw;n.addParagraph=!1,n.addSection=!1;try{const r=new pF(this.options);if(yield r.init(e),this.data=new RR(this.options,r,new vw(n).createModel(t).fillModel()),!e.size)throw new Error("Empty file");if(yield this.importRootRelations(),yield this.importMainSubDocument(),LT.paragraphMarkBetween(this.data.documentModel),LT.fixAllTables(this.data.documentModel),bT.fixLastSection(this.data.documentModel),LT.fixLastParagraphs(this.data.documentModel),!new wu(this.data.documentModel).checkAll())throw new Error}catch(e){return void this.reject(Sw.OpenXmlImportError)}this.callback(this.data.documentModel,this.data.formatImagesImporter)}))}importRootRelations(){return YD(this,void 0,void 0,(function*(){return this.data.addRelations("_rels/.rels")}))}importMainSubDocument(){return YD(this,void 0,void 0,(function*(){const e=this.data.relationsStack.last.lookupRelationTargetByType(this.data.constants.rels.officeDocumentType,"","document.xml");this.data.documentRootFolder=QD.getDir(e),yield this.data.addRelations(`${this.data.documentRootFolder}/_rels/${QD.getFileName(e)}.rels`),yield this.importSettings(),yield this.importThemes(),yield this.importNumbering(),yield this.importStyles(),yield this.importFootNotes(),yield this.importEndNotes(),this.linkNumberingListStyles();const t=yield this.data.archiveData.getXmlReader(e);t.readToFollowingNS("document",this.data.constants.wordProcessingNamespaceConst)?(yield this.data.importContent(t,new dO(this.data)),this.data.sectionImporter.finishSection(),this.data.popCurrentSubDocument()):this.data.options.throwInvalidFile("Not found document element"),this.data.relationsStack.pop()}))}importStyles(){return YD(this,void 0,void 0,(function*(){const e=this.data.relationsStack.last.lookupRelationTargetByType(this.data.constants.rels.officeStylesType,this.data.documentRootFolder,"styles.xml"),t=yield this.data.archiveData.getXmlReader(e);t&&t.readToFollowingNS("styles",this.data.constants.wordProcessingNamespaceConst)?(this.data.stylesImporter.presetDefaultStyles(),yield this.data.importContent(t,new C_(this.data)),this.data.stylesImporter.determineParents(),this.data.stylesImporter.linkStyles()):this.data.options.throwInvalidFile("Not found style element")}))}importFootNotes(){return YD(this,void 0,void 0,(function*(){const e="footnotes.xml",t=this.data.relationsStack.last.lookupRelationTargetByType(this.data.constants.rels.officeFootNoteType,this.data.documentRootFolder,e);yield this.data.addRelations(`${this.data.documentRootFolder}/_rels/${e}.rels`);const r=yield this.data.archiveData.getXmlReader(t);r&&r.readToFollowingNS("footnotes",this.data.constants.wordProcessingNamespaceConst)&&(yield this.data.importContent(r,new A_(this.data))),this.data.relationsStack.pop()}))}importEndNotes(){return YD(this,void 0,void 0,(function*(){const e="endnotes.xml",t=this.data.relationsStack.last.lookupRelationTargetByType(this.data.constants.rels.officeEndNoteType,this.data.documentRootFolder,e);yield this.data.addRelations(`${this.data.documentRootFolder}/_rels/${e}.rels`);const r=yield this.data.archiveData.getXmlReader(t);r&&r.readToFollowingNS("endnotes",this.data.constants.wordProcessingNamespaceConst)&&(yield this.data.importContent(r,new k_(this.data))),this.data.relationsStack.pop()}))}importThemes(){return YD(this,void 0,void 0,(function*(){const e=this.data.relationsStack.last.lookupRelationTargetByType(this.data.constants.rels.officeThemesType,this.data.documentRootFolder,"theme/theme1.xml");yield this.data.addRelations(`${this.data.documentRootFolder}/_rels/theme/theme1.xml.rels`);const t=yield this.data.archiveData.getXmlReader(e);t&&t.readToFollowingNS("theme",this.data.constants.drawingMLNamespaceConst)&&(yield this.data.importContent(t,new L_(this.data))),this.data.relationsStack.pop()}))}importNumbering(){return YD(this,void 0,void 0,(function*(){const e=this.data.relationsStack.last.lookupRelationTargetByType(this.data.constants.rels.officeNumberingType,this.data.documentRootFolder,"numbering.xml"),t=yield this.data.archiveData.getXmlReader(e);t&&t.readToFollowingNS("numbering",this.data.constants.wordProcessingNamespaceConst)&&(yield this.data.importContent(t,new pO(this.data))),this.data.stylesImporter.createNumberingLists(this.data.documentModel)}))}importSettings(){return YD(this,void 0,void 0,(function*(){this.data.documentModel.compatibilitySettings.compatibilityMode=yg.Word2007;const e=this.data.relationsStack.last.lookupRelationTargetByType(this.data.constants.rels.officeDocumentSettings,this.data.documentRootFolder,"settings.xml"),t=yield this.data.archiveData.getXmlReader(e);t&&t.readToFollowingNS("settings",this.data.constants.wordProcessingNamespaceConst)&&(yield this.data.importContent(t,new $O(this.data)))}))}linkNumberingListStyles(){B.StringMapUtils.forEach(this.data.stylesImporter.abstractListInfos,(e=>{if(null!=e.numberingStyleReferenceIndex){const t=this.data.documentModel.abstractNumberingLists[e.abstractNumberingIndex],r=this.data.stylesImporter.numberingListManager.getStyleById(e.numberingStyleReferenceIndex),i=this.data.documentModel.abstractNumberingLists[this.data.documentModel.numberingLists[r.numberingListIndex].abstractNumberingListIndex];f.ListUtils.forEach(t.levels,((e,t)=>{e.copyFrom(i.levels[t])}))}}))}}class U_{constructor(e=e=>{O.isDebug&&console.log(`LoadedFileIsIncorrect: ${e}`)}){this.invalidDocumentMode=Cw.OpenAnyway,this.allowIntPercentage=!1,this.createEmptyDocumentOnLoadError=!0,this.ignoreDeletedText=!0,this.ignoreInsertedText=!0,this.ignoreComments=!0,this.throwInvalidFile=e}}class H_{importFromFile(e,t,r,i){this.reject=i,this.createModel(t);const n=new FileReader;n.onload=()=>{this.importFromString(n.result,t,r,i)},n.onerror=e=>{this.reject(Sw.TxtFileReaderError)},n.readAsText(e)}importFromString(e,t,r,i,n,o){this.createModel(t);try{if(this.fillModel(this.model,e,n,o),!new wu(this.model).checkAll())throw new Error}catch(e){return void i(Sw.TxtImportError)}r(this.model,this.formatImagesImporter)}createModel(e){const t=new Mw;t.addParagraph=!1,this.formatImagesImporter=new Dw,this.model=new vw(t).createModel(e).fillModel()}fillModel(e,t,r,i){const n=(0,yd.Ev)(t),o=e.mainSubDocument,a=o.chunks[0].textRuns;let s=this.model.stylesManager.getDefaultCharacterStyle(),l=this.model.stylesManager.getDefaultParagraphStyle(),d=e.cache.maskedCharacterPropertiesCache.getItem(vw.createTemplateCharProps(e)),c=e.cache.maskedParagraphPropertiesCache.getItem(vw.createTemplateParProps());r?(s=r.style,d=r.props):(s=this.model.stylesManager.getDefaultCharacterStyle(),d=e.cache.maskedCharacterPropertiesCache.getItem(vw.createTemplateCharProps(e))),i?(l=i.style,c=i.props):(l=this.model.stylesManager.getDefaultParagraphStyle(),c=e.cache.maskedParagraphPropertiesCache.getItem(vw.createTemplateParProps()));let h=0;n.forEach((e=>{const t=new ns(o,o.positionManager.registerPosition(h),0,l,c);o.paragraphs.push(t);const r=e.length;r&&a.push(new ch(h,r,t,new pn(d,s))),a.push(new Bl(h+r,t,new pn(d,s))),t.length=1+r,h+=t.length})),o.chunks[0].textBuffer=n.join(an.specialCharacters.ParagraphMark)+an.specialCharacters.ParagraphMark,e.sections[0].setLength(o,f.ListUtils.last(o.paragraphs).getEndPosition())}}function V_(e,t=e=>{throw new Error(R.D.InternalException+" "+e)}){switch(e){case Fu.OpenXml:return new __(new U_(t));case Fu.Rtf:return new lM(new Iw(t));case Fu.PlainText:return new H_;case Fu.Html:return new DE;default:return console.log("Unsupported format"),null}}class W_ extends tt{constructor(e,t,r){super(e,t),this.scale=r}redo(){this.oldState=this.modelManipulator.inlineObject.scale.setValue(this.boundSubDocument,this.interval,this.scale)}undo(){this.modelManipulator.inlineObject.scale.restoreValue(this.boundSubDocument,this.oldState)}}class z_ extends tt{constructor(e,t,r){super(e,t),this.lockAspectRatio=r}redo(){this.oldState=this.modelManipulator.inlineObject.lockAspectRatio.setValue(this.boundSubDocument,this.interval,this.lockAspectRatio)}undo(){this.modelManipulator.inlineObject.lockAspectRatio.restoreValue(this.boundSubDocument,this.oldState)}}!function(e){e[e.Aligned=0]="Aligned",e[e.Absolute=1]="Absolute",e[e.Relative=2]="Relative"}(bF||(bF={})),function(e){e[e.Aligned=0]="Aligned",e[e.Absolute=1]="Absolute",e[e.Relative=2]="Relative"}(CF||(CF={})),function(e){e[e.Inline=0]="Inline",e[e.TopAndBottom=1]="TopAndBottom",e[e.Tight=2]="Tight",e[e.Through=3]="Through",e[e.Square=4]="Square",e[e.BehindText=5]="BehindText",e[e.InFrontOfText=6]="InFrontOfText"}(SF||(SF={})),function(e){e[e.Both=0]="Both",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Largest=3]="Largest"}(IF||(IF={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Inside=4]="Inside",e[e.Outside=5]="Outside"}(PF||(PF={})),function(e){e[e.Page=0]="Page",e[e.Character=1]="Character",e[e.Column=2]="Column",e[e.Margin=3]="Margin",e[e.LeftMargin=4]="LeftMargin",e[e.RightMargin=5]="RightMargin",e[e.InsideMargin=6]="InsideMargin",e[e.OutsideMargin=7]="OutsideMargin"}(wF||(wF={})),function(e){e[e.Top=1]="Top",e[e.Center=2]="Center",e[e.Bottom=3]="Bottom",e[e.Inside=4]="Inside",e[e.Outside=5]="Outside"}(yF||(yF={})),function(e){e[e.Page=0]="Page",e[e.Line=1]="Line",e[e.Paragraph=2]="Paragraph",e[e.Margin=3]="Margin",e[e.TopMargin=4]="TopMargin",e[e.BottomMargin=5]="BottomMargin",e[e.InsideMargin=6]="InsideMargin",e[e.OutsideMargin=7]="OutsideMargin"}(xF||(xF={}));class j_{constructor(e,t,r,i){this._processor=e,this._subDocument=t,this._position=r,this._run=i}get base64(){return lo.Base64Utils.deleteDataUrlPrefix(this._run.info.cacheInfo.base64)}get url(){return this._run.info.cacheInfo.imageUrl}get interval(){return new xb(this._position,1)}get isLoaded(){return this._run.info.cacheInfo.isLoaded}get extension(){const e=lo.Base64Utils.getKnownMimeType(this._run.info.cacheInfo.base64);return e===Ru.DxMimeType.Unknown?"":Ru.MimeTypeUtils.typeToExtension(e)}get originalSize(){const e=this._run.info.size.originalSize;return new UD(e.width,e.height)}get actualSize(){const e=this._run.info.size.actualSize;return new UD(e.width,e.height)}set actualSize(e){const t=mm.check(e,1,!1,[mm.objectDescriptor("size","SizeApi",(e=>e))]),r=this._run.info.size,i=so.Size.initByCommonAction((e=>e(t)/e(r.originalSize)*100));if(this._run.getType()==cs.InlinePictureRun)this._processor.modelManager.history.addAndRedo(new W_(this._processor.modelManager.modelManipulator,new gu(this._subDocument,new on.FixedInterval(this._position,1)),i));else{const e=r.clone();e.scale=i,this._processor.modelManager.modelManipulator.picture.changePictureSize(this._subDocument,this._position,e)}}get description(){return this._run.info.containerProperties.description}set description(e){this._processor.modelManager.modelManipulator.picture.changeDescription(this._subDocument,this._position,e)}changeWrapType(e){if(e==this.getWrapType())return this;this._processor.beginUpdate();const t=this._subDocument.getRunByPosition(this._position).getCharPropsBundle(this._processor.modelManager.model);return e==SF.Inline?this._processor.modelManager.modelManipulator.picture.setFloatingObjectInlineTextWrapType(this._subDocument,this._position,t):this._processor.modelManager.modelManipulator.picture.setFloatingObjectTextWrapType(this._subDocument,this._position,t,e==SF.BehindText,e==SF.BehindText||e==SF.InFrontOfText?uc.None:e),this._processor.endUpdate(),oU(this._processor,this._subDocument,this._subDocument.getRunAndIndexesByPosition(this._position))}delete(){this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.range.removeInterval(new gu(this._subDocument,new on.FixedInterval(this._position,1)),!1,!1),this._processor.endUpdate()}onLoaded(e){this._processor.modelManager.modelManipulator.picture.loader.addLoadListener(this._run.cacheInfo,(()=>e(this)))}reload(e,t){e=mm.check(e,1,!1,[mm.stringDescriptor("base64",(e=>e),!1)]),(t=mm.check(t,2,!0,[mm.objectDescriptor("size","Size",(e=>e))]))&&(mm.check(t.width,2,!1,[mm.numberDescriptor("size.width",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)]),mm.check(t.height,2,!1,[mm.numberDescriptor("size.height",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)])),this._processor.beginUpdate();try{this._processor.modelManager.modelManipulator.picture.reloadPicture(this._subDocument,this._position,e,this.getSizeCore(t))}finally{this._processor.endUpdate()}}getSizeCore(e){return e?new so.Size(e.width,e.height):null}}class X_{constructor(e,t){this.type=bF.Aligned,this.relativeTo=e,this.alignment=t}}class G_{constructor(e,t){this.type=bF.Absolute,this.relativeTo=e,this.position=t}}class K_{constructor(e,t){this.type=bF.Relative,this.relativeTo=e,this.relativePosition=t}}class q_{constructor(e,t){this.type=CF.Aligned,this.relativeTo=e,this.alignment=t}}class $_{constructor(e,t){this.type=CF.Absolute,this.relativeTo=e,this.position=t}}class J_{constructor(e,t){this.type=CF.Relative,this.relativeTo=e,this.relativePosition=t}}function Y_(e,t){if((0,S.isDefined)(e.alignment)){const r=e;return t.percentOffset.x=0,t.horizontalPositionAlignment=r.alignment,t.horizontalPositionType=r.relativeTo,!0}if((0,S.isDefined)(e.position)){const r=e;return t.horizontalPositionAlignment=mc.None,t.percentOffset.x=0,t.offset.x=r.position,t.horizontalPositionType=r.relativeTo,!0}if((0,S.isDefined)(e.relativePosition)){const r=e;return t.horizontalPositionAlignment=mc.None,t.percentOffset.x=r.relativePosition,t.horizontalPositionType=r.relativeTo,!0}return!1}function Q_(e,t){if((0,S.isDefined)(e.alignment)){const r=e;return t.percentOffset.y=0,t.verticalPositionAlignment=r.alignment,t.verticalPositionType=r.relativeTo,!0}if((0,S.isDefined)(e.position)){const r=e;return t.verticalPositionAlignment=bc.None,t.percentOffset.y=0,t.offset.y=r.position,t.verticalPositionType=r.relativeTo,!0}if((0,S.isDefined)(e.relativePosition)){const r=e;return t.verticalPositionAlignment=bc.None,t.percentOffset.y=r.relativePosition,t.verticalPositionType=r.relativeTo,!0}return!1}function Z_(e,t,r,i,n){(0,S.isDefined)(i)&&e.modelManager.modelManipulator.picture.changeNumberedShapeProperty(t,r,i,n)}class eU extends j_{constructor(e,t,r,i){super(e,t,r,i)}get outlineColor(){return bm.internalColorToApiColor(this._run.info.shape.outlineColor)}set outlineColor(e){const t=mm.check(e,1,!1,Sm.colorDescriptors("value"));this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.picture.changeShapeOutlineColor(this._subDocument,this._position,t),this._processor.endUpdate()}get outlineWidth(){return this._run.info.shape.outlineWidth}set outlineWidth(e){this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.picture.changeShapeOutlineWidth(this._subDocument,this._position,e),this._processor.endUpdate()}get wrapSide(){return this._run.anchorInfo.wrapSide}set wrapSide(e){mm.check(e,1,!1,[mm.objectDescriptor("wrapSide","WrapSide",(e=>e))]),this.wrapSide!==e&&this._processor.modelManager.modelManipulator.picture.changeWrapSide(this._subDocument,this._position,e)}get distance(){const e=this._run.anchorInfo;return{left:e.leftDistance,top:e.topDistance,right:e.rightDistance,bottom:e.bottomDistance}}set distance(e){const t=this._processor.modelManager.history;this._processor.beginUpdate(),t.beginTransaction();const r=this._processor.modelManager.modelManipulator.floatingObject.anchorInfo;Z_(this._processor,this._subDocument,this._position,e.left,r.leftDistance),Z_(this._processor,this._subDocument,this._position,e.top,r.topDistance),Z_(this._processor,this._subDocument,this._position,e.right,r.rightDistance),Z_(this._processor,this._subDocument,this._position,e.bottom,r.bottomDistance),t.endTransaction(),this._processor.endUpdate()}getHorizontalPosition(){const e=this._run.anchorInfo;return e.isUsedHorizontalAlignment()?new X_(e.horizontalPositionType,e.horizontalPositionAlignment):e.isUsedHorizontalAbsolutePosition()?new G_(e.horizontalPositionType,e.offset.x):new K_(e.horizontalPositionType,e.percentOffset.x)}setHorizontalPosition(e){mm.check(e,1,!1,[mm.objectDescriptor("position","IHorizontalAlignmentPosition",(e=>e)),mm.objectDescriptor("position","IHorizontalAbsolutePosition",(e=>e)),mm.objectDescriptor("position","IHorizontalRelativePosition",(e=>e))]);const t=this._run.anchorInfo.clone();Y_(e,t)&&(this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.picture.changeHorizontalPosition(this._subDocument,this._position,t),this._processor.endUpdate())}getVerticalPosition(){const e=this._run.anchorInfo;return e.isUsedVerticalAlignment()?new q_(e.verticalPositionType,e.verticalPositionAlignment):e.isUsedVerticalAbsolutePosition()?new $_(e.verticalPositionType,e.offset.y):new J_(e.verticalPositionType,e.percentOffset.y)}setVerticalPosition(e){mm.check(e,1,!1,[mm.objectDescriptor("position","IVerticalAlignmentPositionApi",(e=>e)),mm.objectDescriptor("position","IVerticalAbsolutePositionApi",(e=>e)),mm.objectDescriptor("position","IVerticalRelativePositionApi",(e=>e))]);const t=this._run.anchorInfo.clone();Q_(e,t)&&this._processor.modelManager.modelManipulator.picture.changeVerticalPosition(this._subDocument,this._position,t)}getWrapType(){const e=this._run.anchorInfo;switch(e.wrapType){case uc.None:return e.isBehindDoc?SF.BehindText:SF.InFrontOfText;case uc.Square:return SF.Square;case uc.Through:return SF.Through;case uc.Tight:return SF.Tight;case uc.TopAndBottom:return SF.TopAndBottom;default:return SF.Square}}}class tU{get image(){return this._currImage}constructor(e,t,r){this._processor=e,this._subDocument=t,this._iterator=new jh(t,!0),this._iterator.setPosition(r)}next(){do{if(this._currImage=oU(this._processor,this._subDocument,this._iterator),this._currImage)return this._iterator.moveToNextRun(),!0}while(this._iterator.moveToNextRun());return!1}}class rU extends j_{constructor(e,t,r,i){super(e,t,r,i)}getWrapType(){return SF.Inline}}function iU(e,t,r){return new rU(e,t,r.getAbsoluteRunPosition(),r.run)}function nU(e,t,r){return new eU(e,t,r.getAbsoluteRunPosition(),r.run)}function oU(e,t,r){return r.run.getType()==cs.AnchoredPictureRun?nU(e,t,r):r.run.getType()==cs.InlinePictureRun?iU(e,t,r):null}function aU(e,t,r){const i=[],n=new jh(t,!1);n.setPosition(r.start);const o=()=>{const r=oU(e,t,n);r&&i.push(r)};if(0==r.length)o();else{const e=r.end;do{o()}while(n.moveToNextRun()&&n.getAbsoluteRunPosition()<e)}return i}class sU{constructor(e,t){this._processor=e,this._subDocument=t}createInline(e,t){let r;if(e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1),mm.check(t,2,!1,[mm.objectDescriptor("options","IInsertInlineImageOptionsApi",(e=>e))]),t.base64)r=mm.check(t.base64,2,!1,[mm.stringDescriptor("options.base64",(e=>e),!1)]);else{if(!t.url)throw new Error("options.base64 or options.url must be defined");r=mm.check(t.url,2,!1,[mm.stringDescriptor("options.url",(e=>e),!1)])}const i=mm.check(t.actualSize,2,!0,[mm.objectDescriptor("options.size","Size",(e=>e))]);i&&(mm.check(i.width,2,!1,[mm.numberDescriptor("options.size.width",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)]),mm.check(i.height,2,!1,[mm.numberDescriptor("options.size.height",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)]));let n=mm.check(t.callback,4,!0,[mm.functionDescriptor("options.callback",(e=>e))]);n||(n=()=>{});const o=this._processor.modelManager.model.cache.imageCache.createUnloadedByBase64OrUrl(r),a=(new ju).setIntervals(tp.fromPosition(this._subDocument,e));this._processor.beginUpdate();const s=nh.defaultInfo(o);return s.containerProperties.description=t.description,this._processor.modelManager.modelManipulator.picture.insertInlinePictureViaHistory(new pu(this._subDocument,e),a.charPropsBundle,s,Mb.initByActualSize(i?new so.Size(i.width,i.height):void 0,((t,r)=>setTimeout((()=>{n(iU(this._processor,this._subDocument,this._subDocument.getRunAndIndexesByPosition(e)))}),0)))),this._processor.endUpdate(),iU(this._processor,this._subDocument,this._subDocument.getRunAndIndexesByPosition(e))}createFloating(e,t){e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1),mm.check(t,2,!1,[mm.objectDescriptor("options","IInsertFloatingImageOptionsApi",(e=>e))]);const r=this._processor.modelManager.model.cache.imageCache;let i;if(t.base64){const e=mm.check(t.base64,2,!1,[mm.stringDescriptor("options.base64",(e=>e),!1)]);i=r.createUnloadedInfoByBase64(e)}else{if(!t.url)throw new Error("options.base64 or options.url must be defined");{const e=mm.check(t.url,2,!1,[mm.stringDescriptor("options.url",(e=>e),!1)]);i=r.createUnloadedInfoByUrl(e)}}const n=mm.check(t.actualSize,2,!0,[mm.objectDescriptor("options.size","Size",(e=>e))]);n&&(mm.check(n.width,2,!1,[mm.numberDescriptor("options.size.width",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)]),mm.check(n.height,2,!1,[mm.numberDescriptor("options.size.height",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)]));let o=mm.check(t.callback,4,!0,[mm.functionDescriptor("options.callback",(e=>e))]);o||(o=()=>{});const a=(new ju).setIntervals(tp.fromPosition(this._subDocument,e));this._processor.beginUpdate();const s=new th;(0,S.isDefined)(t.outlineWidth)&&(s.outlineWidth=t.outlineWidth),(0,S.isDefined)(t.outlineColor)&&(s.outlineColor=mm.check(t.outlineColor,2,!1,Sm.colorDescriptors("options.outlineColor")));const l=new Jc;(0,S.isDefined)(t.wrapSide)&&(l.wrapSide=t.wrapSide);const d=(0,S.isDefined)(t.wrapType)?t.wrapType:SF.Square;switch(d){case SF.BehindText:l.wrapType=uc.None,l.isBehindDoc=!0;break;case SF.InFrontOfText:l.wrapType=uc.None,l.isBehindDoc=!1;break;default:l.wrapType=d,l.isBehindDoc=!1}(0,S.isDefined)(t.distance)&&((0,S.isDefined)(t.distance.left)&&(l.leftDistance=t.distance.left),(0,S.isDefined)(t.distance.right)&&(l.rightDistance=t.distance.right),(0,S.isDefined)(t.distance.top)&&(l.topDistance=t.distance.top),(0,S.isDefined)(t.distance.bottom)&&(l.bottomDistance=t.distance.bottom));const c=t.horizontalPosition;c&&Y_(c,l);const h=t.verticalPosition;h&&Q_(h,l);const u=new oh(new Qc(!0,0,i,new so.Size(100,100)),s,l,new rh,new rh);return u.containerProperties.description=t.description,this._processor.modelManager.modelManipulator.picture.insertAnchoredPictureViaHistory(new pu(this._subDocument,e),a.charPropsBundle,u,new Mb(!1,n?new so.Size(n.width,n.height):void 0,((t,r)=>setTimeout((()=>{o(nU(this._processor,this._subDocument,this._subDocument.getRunAndIndexesByPosition(e)))}),0)))),this._processor.endUpdate(),nU(this._processor,this._subDocument,this._subDocument.getRunAndIndexesByPosition(e))}getIterator(e=0){const t=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1);return new tU(this._processor,this._subDocument,t)}getAllImages(){return aU(this._processor,this._subDocument,this._subDocument.interval)}find(e){const t=f.ListUtils.map(mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>[new on.FixedInterval(e,0)]),0,Bo.Constants.MAX_SAFE_INTEGER),Sm.intervalDescriptor("interval",(e=>[new on.FixedInterval(e.start,e.length)])),Sm.intervalsDescriptor("intervals",(e=>f.ListUtils.map(e,(e=>new on.FixedInterval(e.start,e.length)))))]),(e=>Cm(e,0,this._subDocument.getDocumentEndPosition())));return f.ListUtils.accumulate(t,[],((e,t)=>f.ListUtils.addListOnTail(e,aU(this._processor,this._subDocument,t))))}}class lU{constructor(e,t){this._section=t,this._processor=e}get index(){return C.SearchUtils.normedInterpolationIndexOf(this._processor.modelManager.model.sections,(e=>e.startLogPosition.value),this._section.startLogPosition.value)}get interval(){return Tb(this._section.interval)}get margins(){const e=this._section.sectionProperties.margins.clone();return new HD(e.left,e.right,e.top,e.bottom)}set margins(e){e=mm.check(e,1,!1,[mm.objectDescriptor("margins","Margins",(e=>e))]),mm.check(e.left,1,!1,[mm.numberDescriptor("margins.left",(e=>e),0,Bo.Constants.MAX_SAFE_INTEGER)]),mm.check(e.left,1,!1,[mm.numberDescriptor("margins.right",(e=>e),0,Bo.Constants.MAX_SAFE_INTEGER)]),mm.check(e.left,1,!1,[mm.numberDescriptor("margins.top",(e=>e),0,Bo.Constants.MAX_SAFE_INTEGER)]),mm.check(e.left,1,!1,[mm.numberDescriptor("margins.bottom",(e=>e),0,Bo.Constants.MAX_SAFE_INTEGER)]),this._processor.beginUpdate(),this._processor.modelManager.history.addTransaction((t=>{t.addAndRedo(new cI(this._processor.modelManager.modelManipulator,this._section.interval,e.left)),t.addAndRedo(new uI(this._processor.modelManager.modelManipulator,this._section.interval,e.right)),t.addAndRedo(new hI(this._processor.modelManager.modelManipulator,this._section.interval,e.top)),t.addAndRedo(new pI(this._processor.modelManager.modelManipulator,this._section.interval,e.bottom))})),this._processor.endUpdate()}get columnCount(){return this._section.sectionProperties.columnCount}set columnCount(e){e=mm.check(e,1,!1,[mm.numberDescriptor("columnCount",(e=>e),1,64)]),this._processor.modelManager.history.addTransaction((t=>{t.addAndRedo(new gI(this._processor.modelManager.modelManipulator,this._section.interval,e)),t.addAndRedo(new fI(this._processor.modelManager.modelManipulator,this._section.interval,!0))}))}get pageSize(){const e=this._section.sectionProperties.pageSize.clone();return new UD(e.width,e.height)}set pageSize(e){e=mm.check(e,1,!1,[mm.objectDescriptor("size","Size",(e=>e))]),mm.check(e.width,1,!1,[mm.numberDescriptor("size.width",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)]),mm.check(e.height,1,!1,[mm.numberDescriptor("size.height",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)]);const t=this._section.interval,r=this._section.sectionProperties,i=e.width>e.height,n=r.landscape;this._processor.modelManager.history.beginTransaction(),n!==i&&this._processor.modelManager.history.addAndRedo(new PI(this._processor.modelManager.modelManipulator,t,i)),r.pageWidth===e.width&&r.pageHeight==e.height||this._processor.modelManager.history.addAndRedo(new TI(this._processor.modelManager.modelManipulator,t,Ih.calculatePaperKind(new so.Size(e.width,e.height),Vc.Custom,0,Vc.Letter))),r.pageWidth!==e.width&&this._processor.modelManager.history.addAndRedo(new CI(this._processor.modelManager.modelManipulator,t,e.width)),r.pageHeight!==e.height&&this._processor.modelManager.history.addAndRedo(new SI(this._processor.modelManager.modelManipulator,t,e.height)),this._processor.modelManager.history.endTransaction()}get headerOffset(){return this._section.sectionProperties.headerOffset}set headerOffset(e){e=mm.check(e,1,!1,[mm.numberDescriptor("offset",(e=>e),0,Bo.Constants.MAX_SAFE_INTEGER)]),this._processor.modelManager.history.addAndRedo(new yI(this._processor.modelManager.modelManipulator,this._section.interval,e))}get footerOffset(){return this._section.sectionProperties.footerOffset}set footerOffset(e){e=mm.check(e,1,!1,[mm.numberDescriptor("offset",(e=>e),0,Bo.Constants.MAX_SAFE_INTEGER)]),this._processor.modelManager.history.addAndRedo(new xI(this._processor.modelManager.modelManipulator,this._section.interval,e))}get paperSize(){return this._section.sectionProperties.paperKind}set paperSize(e){const t=mm.check(e,1,!1,[mm.enumDescriptor("paperSize",(e=>e),TF,"PaperSize")]),r=this._processor.modelManager.modelManipulator,i=this._processor.modelManager.history,n=this._section.interval;this._processor.modelManager.history.beginTransaction();try{if(i.addAndRedo(new TI(r,n,t)),t!=Vc.Custom){const e=Ih.calculatePaperSize(t);i.addAndRedo(new CI(r,n,e.width)),i.addAndRedo(new SI(r,n,e.height))}}finally{this._processor.modelManager.history.endTransaction()}}get landscape(){return this._section.sectionProperties.landscape}set landscape(e){e=mm.check(e,1,!1,[mm.booleanDescriptor("landscape",(e=>e))]),this._processor.modelManager.history.addAndRedo(new PI(this._processor.modelManager.modelManipulator,this._section.interval,e))}getHeader(e=MF.Primary,t=!0){const r=mm.check(e,1,!1,[mm.enumDescriptor("type",(e=>e),MF,"HeaderFooterType")]);let i=this._section.headers.getObject(r);if(!i&&t){const e=C.SearchUtils.normedInterpolationIndexOf(this._processor.modelManager.model.sections,(e=>e.startLogPosition.value),this._section.startLogPosition.value);this._processor.modelManager.modelManipulator.header.insertHeaderFooter(e,!0,r),i=this._section.headers.getObject(r)}return i?new cU(this._processor,i.getSubDocument(this._processor.modelManager.model)):null}getFooter(e=MF.Primary,t=!0){const r=mm.check(e,1,!1,[mm.enumDescriptor("type",(e=>e),MF,"HeaderFooterType")]);let i=this._section.footers.getObject(r);if(!i&&t){const e=C.SearchUtils.normedInterpolationIndexOf(this._processor.modelManager.model.sections,(e=>e.startLogPosition.value),this._section.startLogPosition.value);this._processor.modelManager.modelManipulator.header.insertHeaderFooter(e,!1,r),i=this._section.footers.getObject(r)}return i?new cU(this._processor,i.getSubDocument(this._processor.modelManager.model)):null}}function dU(e,t,r,i,n){var o,a;if(!t.length)return new on.FixedInterval(e,0);const s=null!==(o=null==n?void 0:n.inputPosition)&&void 0!==o?o:(new ju).setIntervals(tp.fromPosition(r,e)),l=null===(a=null==n?void 0:n.wrapIntoBeginUpdate)||void 0===a||a;l&&i.beginUpdate(),i.modelManager.history.beginTransaction();const d=new RegExp(/\r\n|\n|\r/g),c=t.length,h=e=>{d.lastIndex=e;const r=d.exec(t);return r?r.index:-1};let u=h(0),p=0,g=e;const m=[];for(;p<c;){let e;if(u==p)m.push(i.modelManager.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(r,g),s))),e="\r\n"==t.substr(u,2)?2:1,u=h(p+e);else{const n=-1==u?c:u,o=t.substring(p,n);m.push(i.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(r,g),s.charPropsBundle,cs.TextRun,o)).insertedInterval),e=o.length}g+=e,p+=e}i.modelManager.history.endTransaction(),l&&i.endUpdate();const b=nn.IntervalAlgorithms.getMergedIntervals(m,!0);return new Cn.e(b[0].start,f.ListUtils.last(b).end)}!function(e){e[e.Custom=0]="Custom",e[e.Letter=1]="Letter",e[e.LetterSmall=2]="LetterSmall",e[e.Tabloid=3]="Tabloid",e[e.Ledger=4]="Ledger",e[e.Legal=5]="Legal",e[e.Statement=6]="Statement",e[e.Executive=7]="Executive",e[e.A3=8]="A3",e[e.A4=9]="A4",e[e.A4Small=10]="A4Small",e[e.A5=11]="A5",e[e.B4=12]="B4",e[e.B5=13]="B5",e[e.Folio=14]="Folio",e[e.Quarto=15]="Quarto",e[e.Standard10x14=16]="Standard10x14",e[e.Standard11x17=17]="Standard11x17",e[e.Note=18]="Note",e[e.Number9Envelope=19]="Number9Envelope",e[e.Number10Envelope=20]="Number10Envelope",e[e.Number11Envelope=21]="Number11Envelope",e[e.Number12Envelope=22]="Number12Envelope",e[e.Number14Envelope=23]="Number14Envelope",e[e.CSheet=24]="CSheet",e[e.DSheet=25]="DSheet",e[e.ESheet=26]="ESheet",e[e.DLEnvelope=27]="DLEnvelope",e[e.C5Envelope=28]="C5Envelope",e[e.C3Envelope=29]="C3Envelope",e[e.C4Envelope=30]="C4Envelope",e[e.C6Envelope=31]="C6Envelope",e[e.C65Envelope=32]="C65Envelope",e[e.B4Envelope=33]="B4Envelope",e[e.B5Envelope=34]="B5Envelope",e[e.B6Envelope=35]="B6Envelope",e[e.ItalyEnvelope=36]="ItalyEnvelope",e[e.MonarchEnvelope=37]="MonarchEnvelope",e[e.PersonalEnvelope=38]="PersonalEnvelope",e[e.USStandardFanfold=39]="USStandardFanfold",e[e.GermanStandardFanfold=40]="GermanStandardFanfold",e[e.GermanLegalFanfold=41]="GermanLegalFanfold",e[e.IsoB4=42]="IsoB4",e[e.JapanesePostcard=43]="JapanesePostcard",e[e.Standard9x11=44]="Standard9x11",e[e.Standard10x11=45]="Standard10x11",e[e.Standard15x11=46]="Standard15x11",e[e.InviteEnvelope=47]="InviteEnvelope",e[e.LetterExtra=50]="LetterExtra",e[e.LegalExtra=51]="LegalExtra",e[e.TabloidExtra=52]="TabloidExtra",e[e.A4Extra=53]="A4Extra",e[e.LetterTransverse=54]="LetterTransverse",e[e.A4Transverse=55]="A4Transverse",e[e.LetterExtraTransverse=56]="LetterExtraTransverse",e[e.APlus=57]="APlus",e[e.BPlus=58]="BPlus",e[e.LetterPlus=59]="LetterPlus",e[e.A4Plus=60]="A4Plus",e[e.A5Transverse=61]="A5Transverse",e[e.B5Transverse=62]="B5Transverse",e[e.A3Extra=63]="A3Extra",e[e.A5Extra=64]="A5Extra",e[e.B5Extra=65]="B5Extra",e[e.A2=66]="A2",e[e.A3Transverse=67]="A3Transverse",e[e.A3ExtraTransverse=68]="A3ExtraTransverse",e[e.JapaneseDoublePostcard=69]="JapaneseDoublePostcard",e[e.A6=70]="A6",e[e.JapaneseEnvelopeKakuNumber2=71]="JapaneseEnvelopeKakuNumber2",e[e.JapaneseEnvelopeKakuNumber3=72]="JapaneseEnvelopeKakuNumber3",e[e.JapaneseEnvelopeChouNumber3=73]="JapaneseEnvelopeChouNumber3",e[e.JapaneseEnvelopeChouNumber4=74]="JapaneseEnvelopeChouNumber4",e[e.LetterRotated=75]="LetterRotated",e[e.A3Rotated=76]="A3Rotated",e[e.A4Rotated=77]="A4Rotated",e[e.A5Rotated=78]="A5Rotated",e[e.B4JisRotated=79]="B4JisRotated",e[e.B5JisRotated=80]="B5JisRotated",e[e.JapanesePostcardRotated=81]="JapanesePostcardRotated",e[e.JapaneseDoublePostcardRotated=82]="JapaneseDoublePostcardRotated",e[e.A6Rotated=83]="A6Rotated",e[e.JapaneseEnvelopeKakuNumber2Rotated=84]="JapaneseEnvelopeKakuNumber2Rotated",e[e.JapaneseEnvelopeKakuNumber3Rotated=85]="JapaneseEnvelopeKakuNumber3Rotated",e[e.JapaneseEnvelopeChouNumber3Rotated=86]="JapaneseEnvelopeChouNumber3Rotated",e[e.JapaneseEnvelopeChouNumber4Rotated=87]="JapaneseEnvelopeChouNumber4Rotated",e[e.B6Jis=88]="B6Jis",e[e.B6JisRotated=89]="B6JisRotated",e[e.Standard12x11=90]="Standard12x11",e[e.JapaneseEnvelopeYouNumber4=91]="JapaneseEnvelopeYouNumber4",e[e.JapaneseEnvelopeYouNumber4Rotated=92]="JapaneseEnvelopeYouNumber4Rotated",e[e.Prc16K=93]="Prc16K",e[e.Prc32K=94]="Prc32K",e[e.Prc32KBig=95]="Prc32KBig",e[e.PrcEnvelopeNumber1=96]="PrcEnvelopeNumber1",e[e.PrcEnvelopeNumber2=97]="PrcEnvelopeNumber2",e[e.PrcEnvelopeNumber3=98]="PrcEnvelopeNumber3",e[e.PrcEnvelopeNumber4=99]="PrcEnvelopeNumber4",e[e.PrcEnvelopeNumber5=100]="PrcEnvelopeNumber5",e[e.PrcEnvelopeNumber6=101]="PrcEnvelopeNumber6",e[e.PrcEnvelopeNumber7=102]="PrcEnvelopeNumber7",e[e.PrcEnvelopeNumber8=103]="PrcEnvelopeNumber8",e[e.PrcEnvelopeNumber9=104]="PrcEnvelopeNumber9",e[e.PrcEnvelopeNumber10=105]="PrcEnvelopeNumber10",e[e.Prc16KRotated=106]="Prc16KRotated",e[e.Prc32KRotated=107]="Prc32KRotated",e[e.Prc32KBigRotated=108]="Prc32KBigRotated",e[e.PrcEnvelopeNumber1Rotated=109]="PrcEnvelopeNumber1Rotated",e[e.PrcEnvelopeNumber2Rotated=110]="PrcEnvelopeNumber2Rotated",e[e.PrcEnvelopeNumber3Rotated=111]="PrcEnvelopeNumber3Rotated",e[e.PrcEnvelopeNumber4Rotated=112]="PrcEnvelopeNumber4Rotated",e[e.PrcEnvelopeNumber5Rotated=113]="PrcEnvelopeNumber5Rotated",e[e.PrcEnvelopeNumber6Rotated=114]="PrcEnvelopeNumber6Rotated",e[e.PrcEnvelopeNumber7Rotated=115]="PrcEnvelopeNumber7Rotated",e[e.PrcEnvelopeNumber8Rotated=116]="PrcEnvelopeNumber8Rotated",e[e.PrcEnvelopeNumber9Rotated=117]="PrcEnvelopeNumber9Rotated",e[e.PrcEnvelopeNumber10Rotated=118]="PrcEnvelopeNumber10Rotated"}(TF||(TF={})),function(e){e[e.Main=0]="Main",e[e.Header=1]="Header",e[e.Footer=2]="Footer",e[e.TextBox=3]="TextBox",e[e.FootNote=4]="FootNote",e[e.EndNote=5]="EndNote"}(vF||(vF={})),function(e){e[e.First=0]="First",e[e.Odd=1]="Odd",e[e.Even=2]="Even",e[e.Primary=1]="Primary"}(MF||(MF={})),function(e){e[e.NextPage=0]="NextPage",e[e.OddPage=1]="OddPage",e[e.EvenPage=2]="EvenPage",e[e.Continuous=3]="Continuous"}(EF||(EF={}));class cU{constructor(e,t){this._subDocument=t,this._processor=e}get paragraphs(){return new hD(this._processor,this._subDocument)}get bookmarks(){return new UE(this._processor,this._subDocument)}get rangePermissions(){return new CD(this._processor,this._subDocument)}get tables(){return new JD(this._processor,this._subDocument)}get fields(){return new mU(this._processor,this._subDocument)}get hyperlinks(){return new HE(this._processor,this._subDocument)}get images(){return new sU(this._processor,this._subDocument)}get parentSubDocument(){const e=this._subDocument.info;return e.isTextBox?new cU(this._processor,this._processor.modelManager.model.subDocuments[e.parentSubDocumentId]):null}get id(){return this._subDocument.id}get type(){return this._subDocument.info.getType()}get interval(){return new xb(0,this._subDocument.getDocumentEndPosition())}get length(){return this._subDocument.getDocumentEndPosition()}insertText(e,t){return e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),Tb(dU(e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1),t=mm.check(t,2,!1,[mm.stringDescriptor("text",(e=>e),!0)]),this._subDocument,this._processor,{wrapIntoBeginUpdate:!0}))}insertLineBreak(e){return hU(e,an.specialCharacters.LineBreak,this._processor,this._subDocument)}insertColumnBreak(e){return hU(e,an.specialCharacters.ColumnBreak,this._processor,this._subDocument)}insertPageBreak(e){return hU(e,an.specialCharacters.PageBreak,this._processor,this._subDocument)}insertSectionBreak(e,t){e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1);const r=mm.check(t,2,!1,[mm.enumDescriptor("type",(e=>e),EF,"SectionBreakType")]),i=(new ju).setIntervals(tp.fromPosition(this._subDocument,e));return this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.section.insertSectionAndSetStartType(e,r,i.charPropsBundle),this._processor.endUpdate(),new lU(this._processor,this._processor.modelManager.model.getSectionByPosition(e+1))}insertPicture(e,t,r,i){e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1),t=mm.check(t,2,!1,[mm.stringDescriptor("base64",(e=>e),!1)]),(r=mm.check(r,3,!0,[mm.objectDescriptor("size","Size",(e=>e))]))&&(mm.check(r.width,3,!1,[mm.numberDescriptor("size.width",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)]),mm.check(r.height,3,!1,[mm.numberDescriptor("size.height",(e=>e),1,Bo.Constants.MAX_SAFE_INTEGER)])),(i=mm.check(i,4,!0,[mm.functionDescriptor("callback",(e=>e))]))||(i=()=>{});const n=this._processor.modelManager.model.cache.imageCache.createUnloadedByBase64OrUrl(t),o=r?new so.Size(r.width,r.height):void 0,a=(new ju).setIntervals(tp.fromPosition(this._subDocument,e));this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.picture.insertInlinePictureViaHistory(new pu(this._subDocument,e),a.charPropsBundle,nh.defaultInfo(n),Mb.initByActualSize(o,((e,t)=>i(Tb(e))))),this._processor.endUpdate()}insertParagraph(e){e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition());const t=(new ju).setIntervals(tp.fromPosition(this._subDocument,e));return this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.paragraph.insertParagraphViaHistory(new Ag(new pu(this._subDocument,e),t.charPropsBundle,new mn(void 0,void 0,void 0,void 0),!1)),this._processor.endUpdate(),new sD(this._processor,this._subDocument.getParagraphByPosition(e))}insertHtml(e,t,r){const i=mm.numberDescriptor("position",(e=>e)),n=mm.stringDescriptor("htmlText",(e=>e),!1),o=mm.functionDescriptor("callback",(e=>e));e=mm.check(e,1,!1,[i]),e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1),t=mm.check(t,2,!1,[n]),(r=mm.check(r,3,!0,[o]))||(r=()=>{});!function(e,t,r,i,n){(new DE).importFromString(i,e.modelManager.richOptions,dM(e,t,r,n),cM(n))}(this._processor,this._subDocument,e,t,(e=>r((0,S.isDefined)(e)?Tb(e):null)))}getHtml(e){const t=this._checkInterval(e);return function(e,t,r){const i=fb.create(new mu(t,[r])),n=new cP(i.model,e.modelManager.richOptions,new Lb.m1),o=e.getExportModelOptions({modelManager:n});return new NE(o,new BP).exportAsString()}(this._processor,this._subDocument,t)}insertRtf(e,t,r){e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1),t=mm.check(t,2,!1,[mm.stringDescriptor("rtf",(e=>e),!1)]),(r=mm.check(r,3,!0,[mm.functionDescriptor("callback",(e=>e))]))||(r=()=>{}),function(e,t,r,i,n){const o=new Iw((()=>{}));new lM(o).importFromString(i,e.modelManager.richOptions,dM(e,t,r,n),cM(n))}(this._processor,this._subDocument,e,t,((e,t)=>r((0,S.isDefined)(e)?Tb(e):null,t)))}getRtf(e){const t=this._checkInterval(e);return function(e,t,r){const i=fb.create(new mu(t,[r])),n=new cP(i.model,e,new Lb.m1);return new bw(n.modelManipulator,new AP).exportAsString()}(this._processor.modelManager.richOptions,this._subDocument,t)}insertContent(e,t,r,i){e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),e=P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1),t=mm.check(t,2,!1,[mm.stringDescriptor("contentAsBase64",(e=>e),!1),mm.objectDescriptor("contentAsFile","File",(e=>e)),mm.objectDescriptor("contentAsBlob","Blob",(e=>e)),mm.objectDescriptor("contentAsArrayBuffer","ArrayBuffer",(e=>e))]);const n=mm.check(r,3,!1,[mm.enumDescriptor("documentFormat",(e=>e),Fu,"DevExpress.RichEdit.DocumentFormat")]);(i=mm.check(i,4,!0,[mm.functionDescriptor("callback",(e=>e))]))||(i=()=>{}),function(e,t,r,i,n,o){i instanceof ArrayBuffer&&(i=lo.Base64Utils.fromArrayBuffer(i)),(0,S.isString)(i)&&(i=lo.Base64Utils.getFileFromBase64(i));const a=V_(n,(()=>{}));if(!a)throw new Error("Unknown document format");a.importFromFile(i,e.modelManager.richOptions,dM(e,t,r,o),cM(o))}(this._processor,this._subDocument,e,t,n,((e,t)=>i(Tb(e),t)))}deleteText(e){const t=this._checkInterval(e);t.length&&(this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.range.removeInterval(new gu(this._subDocument,t),!0,!1),this._processor.endUpdate())}getText(e){const t=this._checkInterval(e);return this._subDocument.getText(t)}getCharacterProperties(e){const t=this._checkInterval(e);return ym(this._processor,this._subDocument,t)}setCharacterProperties(e,t){const r=this._checkInterval(e);xm(this._processor,this._subDocument,r,t)}getParagraphProperties(e){const t=this._checkInterval(e);return dD((new ju).setIntervals(new tp(this._subDocument,[t])).getMergedParagraphPropertiesFull(),this._processor.modelManager.model.colorProvider)}setParagraphProperties(e,t){const r=this._checkInterval(e),i=cD(t,2),n=(new ju).setIntervals(new tp(this._subDocument,[r]));this._processor.beginUpdate(),new Eb(this._processor.modelManager,n,i,this._subDocument,[r]).apply(),this._processor.endUpdate()}_checkInterval(e,t=1){if(!e)return this._subDocument.interval;const r=Sm.intervalDescriptor("interval",(e=>Cm(e,0,this._subDocument.getDocumentEndPosition())));return mm.check(e,t,!1,[r])}}function hU(e,t,r,i){e=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>e))]),e=P.MathUtils.restrictValue(e,0,i.getDocumentEndPosition()-1);const n=(new ju).setIntervals(new tp(i,[new on.FixedInterval(e,0)]));return Tb(r.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(i,e),n.charPropsBundle,cs.TextRun,t)).insertedInterval)}!function(e){e[e.Unknown=0]="Unknown",e[e.Time=1]="Time",e[e.Date=2]="Date",e[e.Page=3]="Page",e[e.NumPages=4]="NumPages",e[e.MergeField=5]="MergeField",e[e.DocVariable=6]="DocVariable",e[e.Hyperlink=7]="Hyperlink",e[e.Seq=8]="Seq",e[e.Tc=9]="Tc",e[e.PageRef=10]="PageRef",e[e.Toc=11]="Toc",e[e.FillIn=12]="FillIn"}(DF||(DF={}));class uU{constructor(e,t,r){this._processor=e,this._field=r,this._subDocument=t}get index(){return this._field.index}get interval(){return Tb(this._field.getAllFieldInterval())}get codeInterval(){return Tb(this._field.getCodeInterval())}get subDocument(){return new cU(this._processor,this._subDocument)}get resultInterval(){return Tb(this._field.getResultInterval())}get isShowCode(){return this._field.showCode}set isShowCode(e){this._processor.modelManager.modelManipulator.field.setFieldShowCode(this._subDocument,this._field,!!e)}get isHyperlink(){return this._field.isHyperlinkField()}get name(){const e=Jg.getParser(this._processor.modelManager,this._processor.layoutFormatterManager,null,this._subDocument,this._field);return e?e.name:DF.Unknown}delete(){this._processor.modelManager.modelManipulator.range.removeInterval(new gu(this._subDocument,this._field.getAllFieldInterval()),!0,!1)}update(e){return e=e?mm.check(e,1,!1,[mm.functionDescriptor("callback",(e=>e))]):()=>{},this._processor.modelManager.history.beginTransaction(),this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.field.updateFields(this._processor.layoutFormatterManager,this._processor.createFieldRequestManager(),new Sb([new mu(this._subDocument,[this._field.getAllFieldInterval()])],(()=>{this._processor.endUpdate(),this._processor.modelManager.history.endTransaction(),e(this)}),new $g))}}class pU extends uU{get hyperlinkInfo(){const e=this._field.getHyperlinkInfo();return new gU(yb.getHyperlinkResultText(this._subDocument,this._field),e.uri,e.anchor,e.tip)}set hyperlinkInfo(e){e=mm.check(e,1,!1,[mm.objectDescriptor("info","HyperlinkInfo",(e=>e))]);const t=mm.check(e.url,1,!0,[mm.stringDescriptor("hyperlinkInfo.url",(e=>e||""),!0)]),r=mm.check(e.tooltip,1,!0,[mm.stringDescriptor("hyperlinkInfo.tooltip",(e=>e||""),!0)]),i=mm.check(e.bookmark,1,!0,[mm.stringDescriptor("hyperlinkInfo.bookmark",(e=>e||""),!0)]),n=mm.check(e.text,1,!0,[mm.stringDescriptor("hyperlinkInfo.text",(e=>e||""),!0)]),o=new xd(t,i,r,!1);this._processor.modelManager.modelManipulator.field.setHyperlinkInfoWithReplaceResultAndCode(this._subDocument,this.index,o,n)}}class gU{constructor(e,t,r,i){this.url=t,this.bookmark=r,this.tooltip=i,this.text=e}}class mU extends _E{constructor(e,t){super(e),this._subDocument=t}create(e,t){const r=mm.check(e,1,!1,[Sm.intervalDescriptor("codeInterval",(e=>Cm(e,0,this._subDocument.getDocumentEndPosition()))),mm.numberDescriptor("position",(e=>new on.FixedInterval(P.MathUtils.restrictValue(e,0,this._subDocument.getDocumentEndPosition()-1),0)))]);t=(0,S.isNumber)(e)?mm.check(t,2,!0,[mm.stringDescriptor("code",(e=>e),!0)]):void 0;const i=(new ju).setIntervals(new tp(this._subDocument,[new on.FixedInterval(r.start,0)]));return this._processor.beginUpdate(),this._processor.modelManager.history.beginTransaction(),this._processor.modelManager.history.addAndRedo(new pp(this._processor.modelManager.modelManipulator,this._subDocument,r.start,r.length,0,!0,i.charPropsBundle)),t&&this._processor.modelManager.history.addAndRedo(new nm(this._processor.modelManager.modelManipulator,new op(new pu(this._subDocument,r.start+1),i.charPropsBundle,cs.TextRun,t))),this._processor.modelManager.history.endTransaction(),this._processor.endUpdate(),this._getItem(this._subDocument.fields[Md.binaryIndexOf(this._subDocument.fields,r.start+1)])}createMergeField(e,t){return this.create(e,`MERGEFIELD "${t}"`)}find(e){const t=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>new on.FixedInterval(e,0))),Sm.intervalDescriptor("interval",(e=>new on.FixedInterval(e.start,e.length)))]);return bU(this._subDocument.fields,t).map((e=>this._getItem(e)))}showAllFieldResults(e){this._showAllFieldCodesCore(e,!1)}showAllFieldCodes(e){this._showAllFieldCodesCore(e,!0)}updateAllFields(e,t){e&&(e=mm.check(e,1,!0,[mm.functionDescriptor("callback",(e=>e))]));const r=(t=t?mm.check(t,2,!1,[mm.objectDescriptor("options","UpdateFieldsOptions",(e=>e))]):new fU(!0,!0)).doInAllSubDocuments?b.j.toListBy(this._processor.modelManager.model.subDocuments,(e=>new mu(e,[e.interval]))):[new mu(this._subDocument,[this._subDocument.interval])];return this._processor.beginUpdate(),this._processor.modelManager.history.beginTransaction(),this._processor.modelManager.modelManipulator.field.updateFields(this._processor.layoutFormatterManager,this._processor.createFieldRequestManager(),new Sb(r,(()=>{this._processor.modelManager.history.endTransaction(),this._processor.endUpdate(),e&&e()}),new $g(t.updateTocFields)))}_showAllFieldCodesCore(e=!0,t){const r=(e=mm.check(e,1,!0,[mm.booleanDescriptor("doInAllSubDocuments",(e=>e))]))?b.j.toList(this._processor.modelManager.model.subDocuments):[this._subDocument];this._processor.beginUpdate(),this._processor.modelManager.modelManipulator.field.setAllFieldsShowCode(t,r),this._processor.endUpdate()}_getItem(e){return new uU(this._processor,this._subDocument,e)}_getCoreItems(){return this._subDocument.fields}}class fU{constructor(e=!0,t=!0){this.doInAllSubDocuments=e,this.updateTocFields=t}}function bU(e,t){if(0==e.length)return[];let r=e[Math.max(0,Md.normedBinaryIndexOf(e,t.start))].getAbsolutelyTopLevelField().index;const i=[];for(let n;n=e[r];r++){const e=n.getAllFieldInterval(),r=nn.IntervalAlgorithms.getIntersection(e,t);if(r&&(r.length||e.contains(r.start)))i.push(n);else if(!n.parent&&n.getFieldStartPosition()>=t.end)break}return i}class CU{constructor(e,t){this._internalItem=t,this._processor=e}get name(){return this._internalItem.name}get cssName(){return this._internalItem.cssString}delete(){this._processor.modelManager.modelManipulator.font.removeFont(this._internalItem)}}class SU extends _E{_getItem(e){return new CU(this._processor,e)}_getCoreItems(){return this._processor.modelManager.model.cache.fontInfoCache.getAllFonts()}getByName(e){const t=this._processor.modelManager.model.cache.fontInfoCache.getItemByName(e);return t?this._getItem(t):null}create(e,t){return this._processor.modelManager.richOptions.fonts.limitedFonts?(console.warn("Font creation is prohibited."),null):this._getItem(this._processor.modelManager.modelManipulator.font.addFontByName(e,t))}getAllFontNames(){return this._processor.modelManager.model.cache.fontInfoCache.getFontNames()}}class IU extends _E{create(e){bm.assertEnum(e,qM,"NumberingType","type");const t=Tw.getNumberingListTemplateIndex(this._processor.modelManager.model,nD.toCoreEnum(e)),r=this._processor.modelManager.model.abstractNumberingListTemplates[t];var i=new dn(this._processor.modelManager.model);i.copyFrom(r),this._processor.beginUpdate(),this._processor.modelManager.history.beginTransaction(),this._processor.modelManager.history.addAndRedo(new Pw(this._processor.modelManager.modelManipulator,i));var n=this._processor.modelManager.model.abstractNumberingLists.length-1,o=new cn(this._processor.modelManager.model,n);return this._processor.modelManager.history.addAndRedo(new ww(this._processor.modelManager.modelManipulator,o)),this._processor.modelManager.history.endTransaction(),this._processor.endUpdate(),this._getItem(o)}deleteNumeration(e,t){const r=mm.check(t,2,!1,[mm.numberDescriptor("position",(e=>new on.FixedInterval(e,0))),Sm.intervalDescriptor("interval",(e=>new on.FixedInterval(e.start,e.length)))]);var i=this._processor.modelManager.model.subDocuments[e.id].getParagraphIndicesByIntervals([r]);this._processor.beginUpdate(),this._processor.modelManager.history.beginTransaction(),Tw.deleteNumberingList(this._processor.modelManager,this._processor.modelManager.model.subDocuments[e.id],i),this._processor.modelManager.history.endTransaction(),this._processor.endUpdate()}_getItem(e){return new aD(this._processor.modelManager,e)}_getCoreItems(){return this._processor.modelManager.model.numberingLists}}class PU extends _E{find(e){bm.assertNumber(e,"position");const t=this._processor.modelManager.model.getSectionByPosition(e);return new lU(this._processor,t)}create(e,t){return new cU(this._processor,this._processor.modelManager.model.mainSubDocument).insertSectionBreak(e,t)}_getItem(e){return new lU(this._processor,e)}_getCoreItems(){return this._processor.modelManager.model.sections}}class wU extends _E{get main(){return this._getItem(this._processor.modelManager.model.mainSubDocument)}getById(e){return this._getItem(this._processor.modelManager.model.subDocuments[e])}forEach(e){e=mm.check(e,1,!0,[mm.functionDescriptor("callback",(e=>e))]),b.j.forEach(this._processor.modelManager.model.subDocuments,(t=>e(this._getItem(t))))}_getItem(e){return new cU(this._processor,e)}_getCoreItems(){return b.j.toList(this._processor.modelManager.model.subDocuments)}}class yU{constructor(e){this._processor=e}get fonts(){return new SU(this._processor)}get subDocuments(){return new wU(this._processor)}get sections(){return new PU(this._processor)}get bookmarks(){return this.subDocuments.main.bookmarks}get rangePermissions(){return this.subDocuments.main.rangePermissions}get paragraphs(){return this.subDocuments.main.paragraphs}get tables(){return this.subDocuments.main.tables}get fields(){return new mU(this._processor,this._processor.modelManager.model.mainSubDocument)}get hyperlinks(){return new HE(this._processor,this._processor.modelManager.model.mainSubDocument)}get lists(){return new IU(this._processor)}get length(){return this.subDocuments.main.length}get interval(){return this.subDocuments.main.interval}get isProtected(){return this._processor.modelManager.model.isDocumentProtectionEnabled}protect(e){this._processor.modelManager.modelManipulator.documentProtectionProperties.enforceDocumentProtection(e)}unprotect(){this._processor.modelManager.modelManipulator.documentProtectionProperties.forceRemoveDocumentProtection()}checkProtectionPassword(e){return!!this.isProtected&&this._processor.modelManager.model.checkDocumentProtectionPassword(e)}insertText(e,t){return this.subDocuments.main.insertText(e,t)}insertLineBreak(e){return this.subDocuments.main.insertLineBreak(e)}insertColumnBreak(e){return this.subDocuments.main.insertColumnBreak(e)}insertPageBreak(e){return this.subDocuments.main.insertPageBreak(e)}insertSectionBreak(e,t){return this.subDocuments.main.insertSectionBreak(e,t)}insertPicture(e,t,r,i){this.subDocuments.main.insertPicture(e,t,r,i)}insertParagraph(e){return this.subDocuments.main.insertParagraph(e)}deleteText(e){return this.subDocuments.main.deleteText(e)}getText(e){return this.subDocuments.main.getText(e)}getCharacterProperties(e){return this.subDocuments.main.getCharacterProperties(e)}setCharacterProperties(e,t){this.subDocuments.main.setCharacterProperties(e,t)}getParagraphProperties(e){return this.subDocuments.main.getParagraphProperties(e)}setParagraphProperties(e,t){this.subDocuments.main.setParagraphProperties(e,t)}getDefaultCharacterProperties(){return Pm(this._processor.modelManager.model.defaultCharacterProperties,this._processor.modelManager.model.colorProvider)}setDefaultCharacterProperties(e){const t=wm(e,this._processor.modelManager.model.cache.fontInfoCache,1,!1,this._processor.modelManager.model.defaultCharacterProperties.clone());this._processor.beginUpdate(),this._processor.modelManager.model.defaultCharacterProperties=this._processor.modelManager.model.cache.maskedCharacterPropertiesCache.getItem(t),b.j.forEach(this._processor.modelManager.model.subDocuments,(e=>e.resetMergedFormattingCache(wg.All))),this._processor.layoutFormatterManager.restartManager.restartAllLayout(),this._processor.endUpdate()}}!function(e){e[e.None=0]="None",e[e.FileNew=1]="FileNew",e[e.FileOpen=2]="FileOpen",e[e.FileSave=3]="FileSave",e[e.FileSaveAs=4]="FileSaveAs",e[e.FilePrint=5]="FilePrint",e[e.Undo=6]="Undo",e[e.Redo=7]="Redo",e[e.PasteSelection=8]="PasteSelection",e[e.CopySelection=9]="CopySelection",e[e.CutSelection=10]="CutSelection",e[e.ChangeFontName=11]="ChangeFontName",e[e.ChangeStyle=12]="ChangeStyle",e[e.ChangeFontSize=13]="ChangeFontSize",e[e.IncreaseFontSize=14]="IncreaseFontSize",e[e.DecreaseFontSize=15]="DecreaseFontSize",e[e.MakeTextUpperCase=16]="MakeTextUpperCase",e[e.MakeTextLowerCase=17]="MakeTextLowerCase",e[e.CapitalizeEachWordTextCase=18]="CapitalizeEachWordTextCase",e[e.ToggleTextCase=19]="ToggleTextCase",e[e.ToggleFontBold=20]="ToggleFontBold",e[e.ToggleFontItalic=21]="ToggleFontItalic",e[e.ToggleFontUnderline=22]="ToggleFontUnderline",e[e.ToggleFontDoubleUnderline=23]="ToggleFontDoubleUnderline",e[e.ToggleFontStrikeout=24]="ToggleFontStrikeout",e[e.ToggleFontSuperscript=26]="ToggleFontSuperscript",e[e.ToggleFontSubscript=27]="ToggleFontSubscript",e[e.ChangeFontForeColor=28]="ChangeFontForeColor",e[e.ChangeFontBackColor=29]="ChangeFontBackColor",e[e.ClearFormatting=30]="ClearFormatting",e[e.ToggleBulletedListItem=31]="ToggleBulletedListItem",e[e.ToggleNumberingListItem=32]="ToggleNumberingListItem",e[e.ToggleMultilevelListItem=33]="ToggleMultilevelListItem",e[e.DecreaseIndent=34]="DecreaseIndent",e[e.IncreaseIndent=35]="IncreaseIndent",e[e.ToggleShowWhitespace=36]="ToggleShowWhitespace",e[e.ToggleParagraphAlignmentLeft=37]="ToggleParagraphAlignmentLeft",e[e.ToggleParagraphAlignmentCenter=38]="ToggleParagraphAlignmentCenter",e[e.ToggleParagraphAlignmentRight=39]="ToggleParagraphAlignmentRight",e[e.ToggleParagraphAlignmentJustify=40]="ToggleParagraphAlignmentJustify",e[e.SetSingleParagraphSpacing=41]="SetSingleParagraphSpacing",e[e.SetSesquialteralParagraphSpacing=42]="SetSesquialteralParagraphSpacing",e[e.SetDoubleParagraphSpacing=43]="SetDoubleParagraphSpacing",e[e.AddSpacingBeforeParagraph=45]="AddSpacingBeforeParagraph",e[e.AddSpacingAfterParagraph=46]="AddSpacingAfterParagraph",e[e.RemoveSpacingBeforeParagraph=47]="RemoveSpacingBeforeParagraph",e[e.RemoveSpacingAfterParagraph=48]="RemoveSpacingAfterParagraph",e[e.ChangeParagraphBackColor=49]="ChangeParagraphBackColor",e[e.Find=50]="Find",e[e.Replace=51]="Replace",e[e.ShowFontForm=52]="ShowFontForm",e[e.ShowParagraphForm=53]="ShowParagraphForm",e[e.InsertPageBreak=54]="InsertPageBreak",e[e.ShowInsertTableForm=55]="ShowInsertTableForm",e[e.InsertPicture=56]="InsertPicture",e[e.ShowBookmarkForm=58]="ShowBookmarkForm",e[e.ShowHyperlinkForm=59]="ShowHyperlinkForm",e[e.ShowSymbolForm=65]="ShowSymbolForm",e[e.SetNormalSectionPageMargins=66]="SetNormalSectionPageMargins",e[e.SetNarrowSectionPageMargins=67]="SetNarrowSectionPageMargins",e[e.SetModerateSectionPageMargins=68]="SetModerateSectionPageMargins",e[e.SetWideSectionPageMargins=69]="SetWideSectionPageMargins",e[e.ShowPageMarginsSetupForm=70]="ShowPageMarginsSetupForm",e[e.SetPortraitPageOrientation=71]="SetPortraitPageOrientation",e[e.SetLandscapePageOrientation=72]="SetLandscapePageOrientation",e[e.ShowPagePaperSetupForm=73]="ShowPagePaperSetupForm",e[e.SetSectionOneColumn=74]="SetSectionOneColumn",e[e.SetSectionTwoColumns=75]="SetSectionTwoColumns",e[e.SetSectionThreeColumns=76]="SetSectionThreeColumns",e[e.ShowColumnsSetupForm=77]="ShowColumnsSetupForm",e[e.InsertColumnBreak=79]="InsertColumnBreak",e[e.InsertSectionBreakNextPage=80]="InsertSectionBreakNextPage",e[e.InsertSectionBreakEvenPage=81]="InsertSectionBreakEvenPage",e[e.InsertSectionBreakOddPage=82]="InsertSectionBreakOddPage",e[e.ChangePageColor=90]="ChangePageColor",e[e.ToggleShowHorizontalRuler=94]="ToggleShowHorizontalRuler",e[e.FullScreen=98]="FullScreen",e[e.SetSectionLegalPaperKind=99]="SetSectionLegalPaperKind",e[e.SetSectionFolioPaperKind=100]="SetSectionFolioPaperKind",e[e.SetSectionA4PaperKind=101]="SetSectionA4PaperKind",e[e.SetSectionA5PaperKind=102]="SetSectionA5PaperKind",e[e.SetSectionA6PaperKind=103]="SetSectionA6PaperKind",e[e.SetSectionB5PaperKind=104]="SetSectionB5PaperKind",e[e.SetSectionExecutivePaperKind=105]="SetSectionExecutivePaperKind",e[e.SelectAll=106]="SelectAll",e[e.ShowPageSetupForm=107]="ShowPageSetupForm",e[e.ShowNumberingListForm=108]="ShowNumberingListForm",e[e.ExtendLineDown=109]="ExtendLineDown",e[e.ExtendLineEnd=110]="ExtendLineEnd",e[e.ExtendLineStart=111]="ExtendLineStart",e[e.ExtendLineUp=112]="ExtendLineUp",e[e.ExtendNextCharacter=113]="ExtendNextCharacter",e[e.ExtendPreviousCharacter=114]="ExtendPreviousCharacter",e[e.ExtendSelectLine=115]="ExtendSelectLine",e[e.InsertParagraph=116]="InsertParagraph",e[e.InsertText=117]="InsertText",e[e.LineDown=118]="LineDown",e[e.LineEnd=119]="LineEnd",e[e.LineStart=120]="LineStart",e[e.LineUp=121]="LineUp",e[e.NextCharacter=122]="NextCharacter",e[e.PreviousCharacter=123]="PreviousCharacter",e[e.SelectLine=124]="SelectLine",e[e.ToggleBackspaceKey=125]="ToggleBackspaceKey",e[e.ToggleDeleteKey=126]="ToggleDeleteKey",e[e.InsertLineBreak=127]="InsertLineBreak",e[e.NextPage=128]="NextPage",e[e.ExtendNextPage=129]="ExtendNextPage",e[e.PreviousPage=130]="PreviousPage",e[e.ExtendPreviousPage=131]="ExtendPreviousPage",e[e.ChangeInlinePictureScale=132]="ChangeInlinePictureScale",e[e.IncrementParagraphLeftIndent=133]="IncrementParagraphLeftIndent",e[e.DecrementParagraphLeftIndent=134]="DecrementParagraphLeftIndent",e[e.DragMoveContent=135]="DragMoveContent",e[e.DragCopyContent=136]="DragCopyContent",e[e.InsertSpace=137]="InsertSpace",e[e.RulerSectionMarginLeft=138]="RulerSectionMarginLeft",e[e.RulerSectionMarginRight=139]="RulerSectionMarginRight",e[e.RulerParagraphRightIndent=140]="RulerParagraphRightIndent",e[e.RulerSectionColumnsSettings=141]="RulerSectionColumnsSettings",e[e.RulerParagraphLeftIndents=142]="RulerParagraphLeftIndents",e[e.InsertTabMark=143]="InsertTabMark",e[e.InsertShiftTabMark=144]="InsertShiftTabMark",e[e.DocumentStart=145]="DocumentStart",e[e.ExtendDocumentStart=146]="ExtendDocumentStart",e[e.DocumentEnd=147]="DocumentEnd",e[e.ExtendDocumentEnd=148]="ExtendDocumentEnd",e[e.GoToNextWord=149]="GoToNextWord",e[e.ExtendGoToNextWord=150]="ExtendGoToNextWord",e[e.GoToPrevWord=151]="GoToPrevWord",e[e.ExtendGoToPrevWord=152]="ExtendGoToPrevWord",e[e.GoToStartParagraph=153]="GoToStartParagraph",e[e.ExtendGoToStartParagraph=154]="ExtendGoToStartParagraph",e[e.GoToEndParagraph=155]="GoToEndParagraph",e[e.ExtendGoToEndParagraph=156]="ExtendGoToEndParagraph",e[e.ReloadDocument=157]="ReloadDocument",e[e.ShowErrorModelIsChangedMessageCommand=158]="ShowErrorModelIsChangedMessageCommand",e[e.ShowErrorSessionHasExpiredMessageCommand=159]="ShowErrorSessionHasExpiredMessageCommand",e[e.SelectParagraph=160]="SelectParagraph",e[e.ShowErrorOpeningAndOverstoreImpossibleMessageCommand=161]="ShowErrorOpeningAndOverstoreImpossibleMessageCommand",e[e.SetSectionLetterPaperKind=162]="SetSectionLetterPaperKind",e[e.ShowErrorClipboardAccessDeniedMessageCommand=163]="ShowErrorClipboardAccessDeniedMessageCommand",e[e.SelectLineNoUpdateControlState=164]="SelectLineNoUpdateControlState",e[e.ExtendSelectLineNoUpdateControlState=165]="ExtendSelectLineNoUpdateControlState",e[e.ShowTabsForm=166]="ShowTabsForm",e[e.ShowCustomNumberingListForm=167]="ShowCustomNumberingListForm",e[e.ShowServiceFontForm=168]="ShowServiceFontForm",e[e.ShowServiceSymbolsForm=169]="ShowServiceSymbolsForm",e[e.RestartNumberingList=170]="RestartNumberingList",e[e.DeleteTabRuler=171]="DeleteTabRuler",e[e.InsertTabRuler=172]="InsertTabRuler",e[e.MoveTabRuler=173]="MoveTabRuler",e[e.IncrementNumberingIndent=174]="IncrementNumberingIndent",e[e.DecrementNumberingIndent=175]="DecrementNumberingIndent",e[e.IncrementParagraphIndentFromFirstRow=176]="IncrementParagraphIndentFromFirstRow",e[e.DecrementParagraphIndentFromFirstRow=177]="DecrementParagraphIndentFromFirstRow",e[e.CreateField=178]="CreateField",e[e.UpdateField=179]="UpdateField",e[e.ToggleFieldCodes=180]="ToggleFieldCodes",e[e.ShowAllFieldCodes=186]="ShowAllFieldCodes",e[e.ShowAllFieldResults=187]="ShowAllFieldResults",e[e.ToggleAllFields=188]="ToggleAllFields",e[e.ContinueNumberingList=189]="ContinueNumberingList",e[e.InsertNumerationToParagraphs=190]="InsertNumerationToParagraphs",e[e.DeleteNumerationFromParagraphs=191]="DeleteNumerationFromParagraphs",e[e.ShowErrorInnerExceptionMessageCommand=192]="ShowErrorInnerExceptionMessageCommand",e[e.ShowErrorAuthExceptionMessageCommand=193]="ShowErrorAuthExceptionMessageCommand",e[e.ShowEditHyperlinkForm=194]="ShowEditHyperlinkForm",e[e.OpenHyperlink=195]="OpenHyperlink",e[e.RemoveHyperlink=196]="RemoveHyperlink",e[e.ShowErrorSavingMessageCommand=197]="ShowErrorSavingMessageCommand",e[e.ShowErrorOpeningMessageCommand=198]="ShowErrorOpeningMessageCommand",e[e.ShowErrorDocVariableErrorCommand=199]="ShowErrorDocVariableErrorCommand",e[e.UpdateAllFields=200]="UpdateAllFields",e[e.InsertNonBreakingSpace=201]="InsertNonBreakingSpace",e[e.RemoveHyperlinks=202]="RemoveHyperlinks",e[e.CreateDateField=203]="CreateDateField",e[e.CreateTimeField=204]="CreateTimeField",e[e.CreatePageField=205]="CreatePageField",e[e.ShowCreateHyperlinkForm=206]="ShowCreateHyperlinkForm",e[e.SentenceCase=207]="SentenceCase",e[e.SwitchTextCase=208]="SwitchTextCase",e[e.GoToFirstDataRecord=209]="GoToFirstDataRecord",e[e.GoToPreviousDataRecord=210]="GoToPreviousDataRecord",e[e.GoToNextDataRecord=211]="GoToNextDataRecord",e[e.GoToLastDataRecord=212]="GoToLastDataRecord",e[e.ToggleViewMergedData=213]="ToggleViewMergedData",e[e.ShowInsertMergeFieldForm=214]="ShowInsertMergeFieldForm",e[e.CreateMergeField=215]="CreateMergeField",e[e.ShowFinishAndMergeForm=216]="ShowFinishAndMergeForm",e[e.ShowSaveMergedDocumentForm=218]="ShowSaveMergedDocumentForm",e[e.AddSelectedLineCommandNoUpdateControlState=219]="AddSelectedLineCommandNoUpdateControlState",e[e.InsertHeader=220]="InsertHeader",e[e.InsertFooter=221]="InsertFooter",e[e.LinkHeaderFooterToPrevious=222]="LinkHeaderFooterToPrevious",e[e.CreateBookmark=225]="CreateBookmark",e[e.DeleteBookmarks=226]="DeleteBookmarks",e[e.GoToPageHeader=227]="GoToPageHeader",e[e.GoToPageFooter=228]="GoToPageFooter",e[e.GoToNextPageHeaderFooter=229]="GoToNextPageHeaderFooter",e[e.GoToPreviousPageHeaderFooter=230]="GoToPreviousPageHeaderFooter",e[e.ToggleDifferentFirstPage=231]="ToggleDifferentFirstPage",e[e.ToggleDifferentOddAndEvenPages=232]="ToggleDifferentOddAndEvenPages",e[e.ClosePageHeaderFooter=233]="ClosePageHeaderFooter",e[e.ContextItem_HeadersFooters=234]="ContextItem_HeadersFooters",e[e.InsertPageNumberField=235]="InsertPageNumberField",e[e.InsertPageCountField=236]="InsertPageCountField",e[e.GoToBookmark=237]="GoToBookmark",e[e.InsertTableCore=238]="InsertTableCore",e[e.ContextItem_Tables=239]="ContextItem_Tables",e[e.ShowTablePropertiesForm=240]="ShowTablePropertiesForm",e[e.ShowCellOptionsForm=242]="ShowCellOptionsForm",e[e.InsertTableColumnToTheLeft=243]="InsertTableColumnToTheLeft",e[e.InsertTableColumnToTheRight=244]="InsertTableColumnToTheRight",e[e.InsertTableRowBelow=245]="InsertTableRowBelow",e[e.InsertTableRowAbove=246]="InsertTableRowAbove",e[e.DeleteTableRows=247]="DeleteTableRows",e[e.DeleteTableColumns=248]="DeleteTableColumns",e[e.InsertTableCellWithShiftToTheLeft=249]="InsertTableCellWithShiftToTheLeft",e[e.DeleteTableCellsWithShiftToTheHorizontally=250]="DeleteTableCellsWithShiftToTheHorizontally",e[e.DeleteTable=251]="DeleteTable",e[e.ShowInsertTableCellsForm=252]="ShowInsertTableCellsForm",e[e.ShowDeleteTableCellsForm=253]="ShowDeleteTableCellsForm",e[e.MergeTableCells=254]="MergeTableCells",e[e.ShowSplitTableCellsForm=255]="ShowSplitTableCellsForm",e[e.SplitTableCellsCommand=256]="SplitTableCellsCommand",e[e.InsertTableCellsWithShiftToTheVertically=257]="InsertTableCellsWithShiftToTheVertically",e[e.DeleteTableCellsWithShiftToTheVertically=258]="DeleteTableCellsWithShiftToTheVertically",e[e.ShowBorderShadingForm=259]="ShowBorderShadingForm",e[e.TableCellAlignTopLeft=260]="TableCellAlignTopLeft",e[e.TableCellAlignTopCenter=261]="TableCellAlignTopCenter",e[e.TableCellAlignTopRight=262]="TableCellAlignTopRight",e[e.TableCellAlignMiddleLeft=263]="TableCellAlignMiddleLeft",e[e.TableCellAlignMiddleCenter=264]="TableCellAlignMiddleCenter",e[e.TableCellAlignMiddleRight=265]="TableCellAlignMiddleRight",e[e.TableCellAlignBottomLeft=266]="TableCellAlignBottomLeft",e[e.TableCellAlignBottomCenter=267]="TableCellAlignBottomCenter",e[e.TableCellAlignBottomRight=268]="TableCellAlignBottomRight",e[e.ApplyTableStyle=269]="ApplyTableStyle",e[e.ToggleTableCellsTopBorder=270]="ToggleTableCellsTopBorder",e[e.ToggleTableCellsRightBorder=271]="ToggleTableCellsRightBorder",e[e.ToggleTableCellsBottomBorder=272]="ToggleTableCellsBottomBorder",e[e.ToggleTableCellsLeftBorder=273]="ToggleTableCellsLeftBorder",e[e.ToggleTableCellNoBorder=274]="ToggleTableCellNoBorder",e[e.ToggleTableCellAllBorders=275]="ToggleTableCellAllBorders",e[e.ToggleTableCellInsideBorders=276]="ToggleTableCellInsideBorders",e[e.ToggleTableCellInsideHorizontalBorders=277]="ToggleTableCellInsideHorizontalBorders",e[e.ToggleTableCellInsideVerticalBorders=278]="ToggleTableCellInsideVerticalBorders",e[e.ToggleTableCellOutsideBorders=279]="ToggleTableCellOutsideBorders",e[e.ToggleFirstRow=280]="ToggleFirstRow",e[e.ToggleLastRow=281]="ToggleLastRow",e[e.ToggleFirstColumn=282]="ToggleFirstColumn",e[e.ToggleLastColumn=283]="ToggleLastColumn",e[e.ToggleBandedRows=284]="ToggleBandedRows",e[e.ToggleBandedColumn=285]="ToggleBandedColumn",e[e.SelectTableCell=286]="SelectTableCell",e[e.SelectTableColumn=287]="SelectTableColumn",e[e.SelectTableRow=288]="SelectTableRow",e[e.SelectTable=289]="SelectTable",e[e.ChangeTableBorderColorRepositoryItem=290]="ChangeTableBorderColorRepositoryItem",e[e.ChangeTableBorderWidthRepositoryItem=291]="ChangeTableBorderWidthRepositoryItem",e[e.ChangeTableBorderStyleRepositoryItem=292]="ChangeTableBorderStyleRepositoryItem",e[e.ShowErrorPathTooLongCommand=293]="ShowErrorPathTooLongCommand",e[e.ChangeTableCellShading=294]="ChangeTableCellShading",e[e.ToggleShowTableGridLines=295]="ToggleShowTableGridLines",e[e.ExtendSelectTableCell=296]="ExtendSelectTableCell",e[e.ExtendSelectTableColumn=297]="ExtendSelectTableColumn",e[e.ExtendSelectTableRow=298]="ExtendSelectTableRow",e[e.ExtendSelectTable=299]="ExtendSelectTable",e[e.SelectTableCellsRange=300]="SelectTableCellsRange",e[e.ShowServiceBorderShadingForm=301]="ShowServiceBorderShadingForm",e[e.RulerTableColumnSeparators=302]="RulerTableColumnSeparators",e[e.ChangeActiveSubDocumentToMain=303]="ChangeActiveSubDocumentToMain",e[e.ChangeActiveSubDocumentToHeaderFooterByPageIndex=304]="ChangeActiveSubDocumentToHeaderFooterByPageIndex",e[e.ChangeActiveSubDocumentToHeaderFooterBySubDocument=305]="ChangeActiveSubDocumentToHeaderFooterBySubDocument",e[e.ShowErrorInvalidDocumentFormat=306]="ShowErrorInvalidDocumentFormat",e[e.SetSectionPageSize=307]="SetSectionPageSize",e[e.SetSectionColumnCount=308]="SetSectionColumnCount",e[e.ChangeTableRowHeight=309]="ChangeTableRowHeight",e[e.ChangeTableCellWidth=310]="ChangeTableCellWidth",e[e.ChangeTableColumnWidth=311]="ChangeTableColumnWidth",e[e.ChangeTableLook=312]="ChangeTableLook",e[e.ShowSpellCheckerForm=313]="ShowSpellCheckerForm",e[e.IgnoreSpellingError=314]="IgnoreSpellingError",e[e.IgnoreAllSpellingErrors=315]="IgnoreAllSpellingErrors",e[e.DeleteRepeatedWord=316]="DeleteRepeatedWord",e[e.AddWordToDictionary=317]="AddWordToDictionary",e[e.ChangeSpellingError=318]="ChangeSpellingError",e[e.ChangeAllSpellingErrors=319]="ChangeAllSpellingErrors",e[e.ShowSpellingCheckCompletedMessage=320]="ShowSpellingCheckCompletedMessage",e[e.RulerChangeTableColumnWidth=321]="RulerChangeTableColumnWidth",e[e.RulerChangeTableRowHeight=322]="RulerChangeTableRowHeight",e[e.DeleteTableCellsByBackspace=323]="DeleteTableCellsByBackspace",e[e.GoToDataRecord=324]="GoToDataRecord",e[e.FindAll=325]="FindAll",e[e.ReplaceNext=326]="ReplaceNext",e[e.ReplaceAll=327]="ReplaceAll",e[e.HideFindResults=328]="HideFindResults",e[e.ActivateRibbon=329]="ActivateRibbon",e[e.ChangeHeaderOffset=330]="ChangeHeaderOffset",e[e.ChangeFooterOffset=331]="ChangeFooterOffset",e[e.Download=332]="Download",e[e.ShowErrorCantSaveToEmptyPathMessageCommand=333]="ShowErrorCantSaveToEmptyPathMessageCommand",e[e.RemoveNextWord=334]="RemoveNextWord",e[e.RemovePrevWord=335]="RemovePrevWord",e[e.GoToStartNextPage=336]="GoToStartNextPage",e[e.GoToStartPrevPage=337]="GoToStartPrevPage",e[e.ExtendGoToStartNextPage=338]="ExtendGoToStartNextPage",e[e.ExtendGoToStartPrevPage=339]="ExtendGoToStartPrevPage",e[e.SetSectionPageMargins=340]="SetSectionPageMargins",e[e.AssignShortcut=341]="AssignShortcut",e[e.ShowLayoutOptionsForm=342]="ShowLayoutOptionsForm",e[e.ChangeFloatingObjectFillColor=343]="ChangeFloatingObjectFillColor",e[e.ChangeFloatingObjectOutlineColor=344]="ChangeFloatingObjectOutlineColor",e[e.ChangeFloatingObjectOutlineWidth=345]="ChangeFloatingObjectOutlineWidth",e[e.SetFloatingObjectSquareTextWrapType=346]="SetFloatingObjectSquareTextWrapType",e[e.SetFloatingObjectTightTextWrapType=347]="SetFloatingObjectTightTextWrapType",e[e.SetFloatingObjectThroughTextWrapType=348]="SetFloatingObjectThroughTextWrapType",e[e.SetFloatingObjectTopAndBottomTextWrapType=349]="SetFloatingObjectTopAndBottomTextWrapType",e[e.SetFloatingObjectBehindTextWrapType=350]="SetFloatingObjectBehindTextWrapType",e[e.SetFloatingObjectInFrontOfTextWrapType=351]="SetFloatingObjectInFrontOfTextWrapType",e[e.SetFloatingObjectTopLeftAlignment=352]="SetFloatingObjectTopLeftAlignment",e[e.SetFloatingObjectTopCenterAlignment=353]="SetFloatingObjectTopCenterAlignment",e[e.SetFloatingObjectTopRightAlignment=354]="SetFloatingObjectTopRightAlignment",e[e.SetFloatingObjectMiddleLeftAlignment=355]="SetFloatingObjectMiddleLeftAlignment",e[e.SetFloatingObjectMiddleCenterAlignment=356]="SetFloatingObjectMiddleCenterAlignment",e[e.SetFloatingObjectMiddleRightAlignment=357]="SetFloatingObjectMiddleRightAlignment",e[e.SetFloatingObjectBottomLeftAlignment=358]="SetFloatingObjectBottomLeftAlignment",e[e.SetFloatingObjectBottomCenterAlignment=359]="SetFloatingObjectBottomCenterAlignment",e[e.SetFloatingObjectBottomRightAlignment=360]="SetFloatingObjectBottomRightAlignment",e[e.FloatingObjectBringForward=361]="FloatingObjectBringForward",e[e.FloatingObjectBringToFront=362]="FloatingObjectBringToFront",e[e.FloatingObjectBringInFrontOfText=363]="FloatingObjectBringInFrontOfText",e[e.FloatingObjectSendBackward=364]="FloatingObjectSendBackward",e[e.FloatingObjectSendToBack=365]="FloatingObjectSendToBack",e[e.FloatingObjectSendBehindText=366]="FloatingObjectSendBehindText",e[e.ContextItem_FloatingObjects=367]="ContextItem_FloatingObjects",e[e.InsertAnchoredTextBox=368]="InsertAnchoredTextBox",e[e.ChangeActiveSubDocumentToTextBox=369]="ChangeActiveSubDocumentToTextBox",e[e.ChangeTextBoxProperties=370]="ChangeTextBoxProperties",e[e.ChangeFloatingObjectShape=371]="ChangeFloatingObjectShape",e[e.CreateEmptyMergeField=372]="CreateEmptyMergeField",e[e.CreateEmptyDocVariableField=373]="CreateEmptyDocVariableField",e[e.SetFloatingObjectInlineTextWrapType=374]="SetFloatingObjectInlineTextWrapType",e[e.FloatingObjectDragDropChangePosition=375]="FloatingObjectDragDropChangePosition",e[e.InsertHtml=376]="InsertHtml",e[e.CreateTocField=377]="CreateTocField",e[e.CreateTableOfEquationsField=378]="CreateTableOfEquationsField",e[e.CreateTableOfFiguresField=379]="CreateTableOfFiguresField",e[e.CreateTableOfTablesField=380]="CreateTableOfTablesField",e[e.CreateEquationCaptionField=381]="CreateEquationCaptionField",e[e.CreateFigureCaptionField=382]="CreateFigureCaptionField",e[e.CreateTableCaptionField=383]="CreateTableCaptionField",e[e.UpdateTableOfContents=384]="UpdateTableOfContents",e[e.SetParagraphBodyTextLevel=385]="SetParagraphBodyTextLevel",e[e.SetParagraphHeading1Level=386]="SetParagraphHeading1Level",e[e.SetParagraphHeading2Level=387]="SetParagraphHeading2Level",e[e.SetParagraphHeading3Level=388]="SetParagraphHeading3Level",e[e.SetParagraphHeading4Level=389]="SetParagraphHeading4Level",e[e.SetParagraphHeading5Level=390]="SetParagraphHeading5Level",e[e.SetParagraphHeading6Level=391]="SetParagraphHeading6Level",e[e.SetParagraphHeading7Level=392]="SetParagraphHeading7Level",e[e.SetParagraphHeading8Level=393]="SetParagraphHeading8Level",e[e.SetParagraphHeading9Level=394]="SetParagraphHeading9Level",e[e.ChangeHeadingLevel=395]="ChangeHeadingLevel",e[e.SetParagraphLevel=396]="SetParagraphLevel",e[e.CreateFieldWithCode=397]="CreateFieldWithCode",e[e.ChangeHyperlink=398]="ChangeHyperlink",e[e.SetAutoFitContents=399]="SetAutoFitContents",e[e.SetAutoFitWindow=400]="SetAutoFitWindow",e[e.SetFixedColumnWidth=401]="SetFixedColumnWidth",e[e.InsertRtf=402]="InsertRtf",e[e.GetRtf=403]="GetRtf",e[e.ForceSyncWithServer=404]="ForceSyncWithServer",e[e.SwitchToSimpleView=405]="SwitchToSimpleView",e[e.SwitchToPrintLayoutView=406]="SwitchToPrintLayoutView",e[e.ChangeViewType=407]="ChangeViewType",e[e.InsertContentFromServer=408]="InsertContentFromServer",e[e.ShowInsertContentFromServerErrorDialogCommand=409]="ShowInsertContentFromServerErrorDialogCommand",e[e.OpenDocumentLocally=410]="OpenDocumentLocally",e[e.InsertPictureLocally=411]="InsertPictureLocally",e[e.CreateNewDocumentLocally=412]="CreateNewDocumentLocally",e[e.ExportDocument=413]="ExportDocument",e[e.DownloadDocumentLocally=414]="DownloadDocumentLocally",e[e.ShowErrorLoadPictureMessage=415]="ShowErrorLoadPictureMessage",e[e.PrintDocumentOnClient=416]="PrintDocumentOnClient",e[e.MailMergeOnClient=417]="MailMergeOnClient",e[e.DownloadDocx=418]="DownloadDocx",e[e.DownloadRtf=419]="DownloadRtf",e[e.DownloadTxt=420]="DownloadTxt",e[e.DownloadHtml=421]="DownloadHtml",e[e.PdfExported=430]="PdfExported",e[e.ChangeCaseMenu=431]="ChangeCaseMenu",e[e.AlignParagraphMenu=432]="AlignParagraphMenu",e[e.LineSpacingMenu=433]="LineSpacingMenu",e[e.MarginsMenu=434]="MarginsMenu",e[e.OrientationMenu=435]="OrientationMenu",e[e.SizeMenu=436]="SizeMenu",e[e.ColumnsMenu=437]="ColumnsMenu",e[e.BreaksMenu=438]="BreaksMenu",e[e.AddTextMenu=439]="AddTextMenu",e[e.InsertCaptionMenu=440]="InsertCaptionMenu",e[e.InsertTableOfFiguresMenu=441]="InsertTableOfFiguresMenu",e[e.CreateFieldMenu=442]="CreateFieldMenu",e[e.TableStyleOptionsMenu=443]="TableStyleOptionsMenu",e[e.BordersMenu=444]="BordersMenu",e[e.SelectMenu=445]="SelectMenu",e[e.DeleteMenu=446]="DeleteMenu",e[e.InsertMenu=447]="InsertMenu",e[e.AutoFitMenu=448]="AutoFitMenu",e[e.AlignmentMenu=449]="AlignmentMenu",e[e.WrapTextMenu=450]="WrapTextMenu",e[e.PositionMenu=451]="PositionMenu",e[e.BringForwardMenu=452]="BringForwardMenu",e[e.SendBackwardMenu=453]="SendBackwardMenu",e[e.ChangeFloatingObjectTextWrapTypeMenu=454]="ChangeFloatingObjectTextWrapTypeMenu",e[e.FloatingObjectBringForwardMenu=455]="FloatingObjectBringForwardMenu",e[e.FloatingObjectSendBackwardMenu=456]="FloatingObjectSendBackwardMenu",e[e.NoSpellingSuggestions=457]="NoSpellingSuggestions",e[e.GetHtml=458]="GetHtml",e[e.CreateEmptyIfField=459]="CreateEmptyIfField"}(FF||(FF={})),function(e){e[e.None=0]="None",e[e.Persistent=1]="Persistent",e[e.Temporary=2]="Temporary"}(RF||(RF={})),function(e){e[e.OnRedo=1]="OnRedo",e[e.OnUndo=2]="OnUndo",e[e.OnRedoAndUndo=3]="OnRedoAndUndo"}(LF||(LF={}));class xU extends Ze{canBeMerged(){return!0}constructor(e,t,r,i,n=LF.OnRedoAndUndo){super(e),this.selection=t,this.newState=i,this.oldState=r,this.directionFlag=new pr.Flag(n)}redo(){this.directionFlag.get(LF.OnRedo)&&this.selection.scrollManager.setScroll(this.newState)}undo(){this.directionFlag.get(LF.OnUndo)&&this.selection.scrollManager.setScroll(this.oldState)}}class TU extends Ze{canBeMerged(){return!0}constructor(e,t,r,i,n=LF.OnRedoAndUndo){super(e),this.selection=t,this.oldState=r,this.newState=i,this.directionFlag=new pr.Flag(n)}redo(){this.directionFlag.get(LF.OnRedo)&&this.selection.setState(this.newState)}undo(){this.directionFlag.get(LF.OnUndo)&&this.selection.setState(this.oldState)}}class vU{get subDocument(){return this.intervalsInfo.subDocument}setChangeSelection(e){return this.changeSelection=e,this}setIntervalsInfo(e){return this.intervalsInfo=e,this}constructor(e){this.control=e,this.changeSelection=!0,this.isSetManually=!0,e&&(this.intervalsInfo=this.control.selection.intervalsInfo.clone())}}class MU extends vU{constructor(e,t){super(e),this.param=t}}class EU{get modelManipulator(){return this.control.modelManager.modelManipulator}get selection(){return this.control.selection}get history(){return this.control.modelManager.history}get inputPosition(){return this.control.inputPosition}constructor(e){this.control=e}get colorProvider(){return this.control.modelManager.model.colorProvider}getRelatedCommands(){return{[this.commandId]:!0}}execute(e,t){const r=this.control.commandManager.isPublicApiCall;if(this.control.commandManager.isPublicApiCall=e,this.control.isClosed()&&!this.isEnabledInClosedDocument())return this.control.commandManager.isPublicApiCall=r,!1;const i=this.convertToCommandOptions(t),n=this.getState(i),o=this.control.getModifiedState();if(!n.enabled)return this.control.commandManager.isPublicApiCall=r,!1;this.beforeExecute(),this.control.beginUpdate(),this.control.commandManager.beforeExecuting(this);const a=this.executeCore(n,i);this.control.commandManager.afterExecuting();const s=this.lockBarHolderUpdate(o),l=this.lockInputPositionUpdating(o);return s&&this.control.barHolder.enableUpdate(!1),l&&(this.control.inputPositionModelChangesListener.updateEnabled=!1),this.control.endUpdate(),this.afterExecute(),this.control.barHolder.forceUpdate(this.getRelatedCommands()),s&&this.control.barHolder.enableUpdate(!0),l&&(this.control.inputPositionModelChangesListener.updateEnabled=!0),a&&this.updateControlState(),this.control.commandManager.isPublicApiCall=r,a}afterExecute(){}beforeExecute(){}convertToCommandOptions(e){if(e instanceof vU)return e;const t=new MU(this.control,this.DEPRECATEDConvertOptionsParameter(e));return this.DEPRECATEDCorrectlMainCommandOptions(t),t.isSetManually=!1,t}updateControlState(){}executeCore(e,t){throw new Error(R.D.NotImplemented)}isEnabled(e){return this.control.commandManager.commandIsEnabled(this.commandId)&&(this.isEnabledInReadOnlyMode()||this.control.readOnly!=RF.Persistent&&this.canModify())}lockBarHolderUpdate(e){return!1}lockInputPositionUpdating(e){return!1}isEnabledInReadOnlyMode(){return!1}isEnabledInClosedDocument(){return!1}canModify(){return this.selection.activeSubDocument.isEditable(this.getIntervalsForModifying())}getIntervalsForModifying(){return this.selection.intervals}getFloatingObjectParentSubDocument(){const e=this.selection.specialRunInfo;return e.isPictureSelected()?this.selection.activeSubDocument:e.getParentSubDocument()}DEPRECATEDConvertOptionsParameter(e){return e}DEPRECATEDCorrectlMainCommandOptions(e){}static addSelectionBefore(e){e.modelManager.history.addAndRedo(new xU(e.modelManager.modelManipulator,e.selection,(new xD).byScrollInfo.setPageInfo(e.viewManager.canvasManager.getScrollTopInfo()),null,LF.OnUndo)),e.modelManager.history.add(new TU(e.modelManager.modelManipulator,e.selection,e.selection.getState(),null,LF.OnUndo))}static addSelectionAfter(e,t,r=()=>{}){const i=e.selection.getState().setPosition(t);r(i),e.modelManager.history.addAndRedo(new TU(e.modelManager.modelManipulator,e.selection,null,i,LF.OnRedo)),e.modelManager.history.addAndRedo(new xU(e.modelManager.modelManipulator,e.selection,null,(new xD).byModelPosition(e.selection).setModelPosition(t).useStdRelativePosition().useStdOffset(),LF.OnRedo))}addSelectionBefore(){EU.addSelectionBefore(this.control)}addSelectionAfter(e,t=()=>{}){EU.addSelectionAfter(this.control,e,t)}insertText(e,t){const r=this.inputPosition.charPropsBundle;this.history.beginTransaction(),this.modelManipulator.range.removeInterval(new gu(e.subDocument,e.interval),!0,!1);const i=new op(new pu(e.subDocument,e.interval.start),r,cs.TextRun,t),n=this.modelManipulator.text.insertTextViaHistory(i);return this.history.endTransaction(),n}insertTextWithSelection(e,t){const r=this.inputPosition.charPropsBundle;this.insertSomeWithSelection(e,(e=>{const i=new op(e,r,cs.TextRun,t);return this.modelManipulator.text.insertTextViaHistory(i).insertedInterval.end}))}insertSomeWithSelection(e,t){this.history.beginTransaction(),this.addSelectionBefore(),this.modelManipulator.range.removeInterval(e,!0,!1);const r=t(new pu(e.subDocument,e.interval.start));this.addSelectionAfter(r),this.history.endTransaction()}static replaceTextByParagraph(e,t,r){r.validateInterval();const i=r.interval,n=r.subDocument;let o=t.getCharacterStyle(),a=t.getMaskedCharacterProperties().clone(),s=n.getRunByPosition(i.start).paragraph;const l=s.paragraphStyle?s.paragraphStyle.nextParagraphStyle:null,d=l&&s.getEndPosition()-1==i.end,c=s.isInList()&&!d&&!i.containsInterval(s.interval);e.history.beginTransaction(),i.length>0&&e.modelManipulator.range.removeInterval(r,!0,!1);const h=new on.FixedInterval(i.start+an.specialCharacters.ParagraphMark.length,0);let u=()=>{};if(c){i.length>0&&(s=n.getRunByPosition(i.start).paragraph);const e=n.getRunByPosition(s.getEndPosition()-1);o=e.characterStyle,a=e.maskedCharacterProperties.clone()}else d&&n.isEditable([new on.FixedInterval(h.start,1)])&&(u=e=>{e.history.addAndRedo(new Op(e.modelManipulator,new gu(n,h),e.model.stylesManager.addParagraphStyle(l)))});return e.modelManipulator.paragraph.insertParagraphViaHistory(new Ag(new pu(n,r.interval.start),new pn(a,o),new mn(void 0,void 0,void 0,void 0),!1,u)),e.history.endTransaction(),new on.FixedInterval(i.start,1)}}class DU extends OE{constructor(e,t,r){super(e,t,r),this._core=e}goTo(){const e=this._core.commandManager.getCommand(FF.GoToBookmark),t=new MU(this._core,this._bookmark.name);e.execute(!0,t)}}class FU extends UE{constructor(e,t){super(e,t),this._core=e}_getItem(e){return new DU(this._core,this._subDocument,e)}}class RU extends cU{constructor(e,t){super(e,t),this._core=e}get bookmarks(){return new FU(this._core,this._subDocument)}}class LU extends wU{constructor(e){super(e),this._core=e}get main(){return this._getItem(this._core.modelManager.model.mainSubDocument)}_getItem(e){return new RU(this._core,e)}}class BU extends yU{constructor(e){super(e),this._core=e}get modified(){return this._core.getModifiedState()==n.True}set modified(e){e||this._core.setModifiedFalse()}get subDocuments(){return new LU(this._core)}get bookmarks(){return this.subDocuments.main.bookmarks}get images(){return this.subDocuments.main.images}setDefaultCharacterProperties(e){super.setDefaultCharacterProperties(e),this._core.inputPosition.reset(),this._core.barHolder.updateItemsState()}}class AU{constructor(e){this._core=e}beginTransaction(){this._core.modelManager.history.beginTransaction()}endTransaction(){this._core.modelManager.history.endTransaction()}redo(){this._core.modelManager.history.redo()}undo(){this._core.modelManager.history.undo()}clear(){this._core.modelManager.history.clear(),this._core.barHolder.updateItemsState()}}class NU{constructor(e,t=!1,r=!1,i=!1,n=!1){this.keyCode=mm.check(e,1,!1,[mm.enumDescriptor("keyCode",(e=>e),BF,"KeyCode")]),this.alt=!!r,this.ctrl=!!t,this.shift=!!i,this.meta=!!n}}!function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Pause=19]="Pause",e[e.CapsLock=20]="CapsLock",e[e.Esc=27]="Esc",e[e.Spacebar=32]="Spacebar",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Key_0=48]="Key_0",e[e.Key_1=49]="Key_1",e[e.Key_2=50]="Key_2",e[e.Key_3=51]="Key_3",e[e.Key_4=52]="Key_4",e[e.Key_5=53]="Key_5",e[e.Key_6=54]="Key_6",e[e.Key_7=55]="Key_7",e[e.Key_8=56]="Key_8",e[e.Key_9=57]="Key_9",e[e.Key_a=65]="Key_a",e[e.Key_b=66]="Key_b",e[e.Key_c=67]="Key_c",e[e.Key_d=68]="Key_d",e[e.Key_e=69]="Key_e",e[e.Key_f=70]="Key_f",e[e.Key_g=71]="Key_g",e[e.Key_h=72]="Key_h",e[e.Key_i=73]="Key_i",e[e.Key_j=74]="Key_j",e[e.Key_k=75]="Key_k",e[e.Key_l=76]="Key_l",e[e.Key_m=77]="Key_m",e[e.Key_n=78]="Key_n",e[e.Key_o=79]="Key_o",e[e.Key_p=80]="Key_p",e[e.Key_q=81]="Key_q",e[e.Key_r=82]="Key_r",e[e.Key_s=83]="Key_s",e[e.Key_t=84]="Key_t",e[e.Key_u=85]="Key_u",e[e.Key_v=86]="Key_v",e[e.Key_w=87]="Key_w",e[e.Key_x=88]="Key_x",e[e.Key_y=89]="Key_y",e[e.Key_z=90]="Key_z",e[e.Windows=91]="Windows",e[e.ApplicationKey=93]="ApplicationKey",e[e.Numpad_0=96]="Numpad_0",e[e.Numpad_1=97]="Numpad_1",e[e.Numpad_2=98]="Numpad_2",e[e.Numpad_3=99]="Numpad_3",e[e.Numpad_4=100]="Numpad_4",e[e.Numpad_5=101]="Numpad_5",e[e.Numpad_6=102]="Numpad_6",e[e.Numpad_7=103]="Numpad_7",e[e.Numpad_8=104]="Numpad_8",e[e.Numpad_9=105]="Numpad_9",e[e.Asterisk=106]="Asterisk",e[e.PlusSign=107]="PlusSign",e[e.MinusSign=109]="MinusSign",e[e.Numpad_Period=110]="Numpad_Period",e[e.Numpad_Slash=111]="Numpad_Slash",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.Semicolon=186]="Semicolon",e[e.EqualsSign=187]="EqualsSign",e[e.Comma=188]="Comma",e[e.Hyphen=189]="Hyphen",e[e.Period=190]="Period",e[e.Slash=191]="Slash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBracket=221]="CloseBracket",e[e.Quotes=222]="Quotes"}(BF||(BF={}));class kU{constructor(e){this._core=e}get showHiddenSymbols(){return this._core.innerClientProperties.showHiddenSymbols}set showHiddenSymbols(e){this._core.commandManager.getCommand(FF.ToggleShowWhitespace).execute(!0,e)}get showTableGridLines(){return this._core.innerClientProperties.showTableGridLines}set showTableGridLines(e){this._core.commandManager.getCommand(FF.ToggleShowTableGridLines).execute(!0,e)}}class OU{get enabled(){return this._core.loadingPanelManager.loadingPanel.enabled}set enabled(e){this._core.loadingPanelManager.loadingPanel.enabled=e}get customPanel(){return this._core.loadingPanelManager.loadingPanel.customPanel}set customPanel(e){this._core.loadingPanelManager.loadingPanel.customPanel=e}constructor(e){this._core=e}show(){this._core.loadingPanelManager.loadingPanel.setVisible(!0)}hide(){this._core.loadingPanelManager.loadingPanel.setVisible(!1)}}class _U{constructor(e){this._core=e}get activeSubDocument(){return new RU(this._core,this._core.selection.activeSubDocument)}get anchor(){return this._core.selection.getState().anchorPostion}get active(){return this._core.selection.getState().activePostion}get start(){return this._core.selection.getState().interval.start}get end(){return this._core.selection.getState().interval.end}get intervals(){const e=[];for(let t,r=0;t=this._core.selection.intervals[r];r++){let r=new xb(t.start,t.length);e.push(r)}return e}get showCursorAtEndOfLine(){return this._core.selection.endOfLine}set showCursorAtEndOfLine(e){e!=this._core.selection.endOfLine&&this._core.selection.changeState((t=>t.setEndOfLine(e)))}setSelection(e){const t=this._core.selection.activeSubDocument,r=t.getDocumentEndPosition(),i=mm.check(e,1,!1,[mm.numberDescriptor("position",(e=>[Cm(new on.FixedInterval(e,0),0,r)])),Sm.intervalDescriptor("interval",(e=>[Cm(e,0,r)])),Sm.intervalsDescriptor("intervals",(e=>f.ListUtils.map(e,(e=>Cm(e,0,r)))))]),n=this._core.commandManager.isPublicApiCall;this._core.commandManager.isPublicApiCall=!0,this._core.selection.changeState((e=>{if(on.FixedInterval.isCollapsed(i)){const r=i[0].start;t.getParagraphByPosition(r).startLogPosition.value==r&&e.setEndOfLine(!1)}e.setIntervals(i)}),(new FD).noFieldUiChecks()),this._core.selection.scrollManager.setScroll((new xD).byModelPosition(this._core.selection).setModelPosition(this._core.selection.anchorPosition).useStdRelativePosition().useStdOffset()),this._core.commandManager.isPublicApiCall=n}selectAll(){this._core.commandManager.getCommand(FF.SelectAll).execute(!0)}goToSubDocumentEnd(e){e?this._core.commandManager.getCommand(FF.ExtendDocumentEnd).execute(!0):this._core.commandManager.getCommand(FF.DocumentEnd).execute(!0)}goToNextLine(e){e?this._core.commandManager.getCommand(FF.ExtendLineDown).execute(!0):this._core.commandManager.getCommand(FF.LineDown).execute(!0)}goToLineEnd(e){e?this._core.commandManager.getCommand(FF.ExtendLineEnd).execute(!0):this._core.commandManager.getCommand(FF.LineEnd).execute(!0)}goToLineStart(e){e?this._core.commandManager.getCommand(FF.ExtendLineStart).execute(!0):this._core.commandManager.getCommand(FF.LineStart).execute(!0)}goToPreviousLine(e){e?this._core.commandManager.getCommand(FF.ExtendLineUp).execute(!0):this._core.commandManager.getCommand(FF.LineUp).execute(!0)}goToNextCharacter(e){e?this._core.commandManager.getCommand(FF.ExtendNextCharacter).execute(!0):this._core.commandManager.getCommand(FF.NextCharacter).execute(!0)}goToPreviousCharacter(e){e?this._core.commandManager.getCommand(FF.ExtendPreviousCharacter).execute(!0):this._core.commandManager.getCommand(FF.PreviousCharacter).execute(!0)}selectLine(e){const t=this._core.selection.lastSelectedInterval.end;e?this._core.commandManager.getCommand(FF.AddSelectedLineCommandNoUpdateControlState).execute(!0,t):this._core.commandManager.getCommand(FF.SelectLine).execute(!0,t)}goToNextPage(e){e?this._core.commandManager.getCommand(FF.ExtendNextPage).execute(!0):this._core.commandManager.getCommand(FF.NextPage).execute(!0)}goToPreviousPage(e){e?this._core.commandManager.getCommand(FF.ExtendPreviousPage).execute(!0):this._core.commandManager.getCommand(FF.PreviousPage).execute(!0)}goToDocumentStart(e){e?this._core.commandManager.getCommand(FF.ExtendDocumentStart).execute(!0):this._core.commandManager.getCommand(FF.DocumentStart).execute(!0)}goToDocumentEnd(e){e?this._core.commandManager.getCommand(FF.ExtendDocumentEnd).execute(!0):this._core.commandManager.getCommand(FF.DocumentEnd).execute(!0)}goToNextWord(e){e?this._core.commandManager.getCommand(FF.ExtendGoToNextWord).execute(!0):this._core.commandManager.getCommand(FF.GoToNextWord).execute(!0)}goToPreviousWord(e){e?this._core.commandManager.getCommand(FF.ExtendGoToPrevWord).execute(!0):this._core.commandManager.getCommand(FF.GoToPrevWord).execute(!0)}goToParagraphStart(e){e?this._core.commandManager.getCommand(FF.ExtendGoToStartParagraph).execute(!0):this._core.commandManager.getCommand(FF.GoToStartParagraph).execute(!0)}goToParagraphEnd(e){e?this._core.commandManager.getCommand(FF.ExtendGoToEndParagraph).execute(!0):this._core.commandManager.getCommand(FF.GoToEndParagraph).execute(!0)}selectParagraph(){const e=this._core.selection.lastSelectedInterval.start;this._core.commandManager.getCommand(FF.SelectParagraph).execute(!0,e)}goToNextPageStart(e){e?this._core.commandManager.getCommand(FF.ExtendGoToStartNextPage).execute(!0):this._core.commandManager.getCommand(FF.GoToStartNextPage).execute(!0)}goToPreviousPageStart(e){e?this._core.commandManager.getCommand(FF.ExtendGoToStartPrevPage).execute(!0):this._core.commandManager.getCommand(FF.GoToStartPrevPage).execute(!0)}selectTableCell(){this._core.commandManager.getCommand(FF.SelectTableCell).execute(!0)}selectTableRow(){this._core.commandManager.getCommand(FF.SelectTableRow).execute(!0)}selectTable(){this._core.commandManager.getCommand(FF.SelectTable).execute(!0)}}class UU{constructor(e,t){this.visible=!0,this.denyUpdateValue=!1,this.enabled=e,this.value=t}}class HU extends UU{constructor(e,t,r){super(e,r),this.interval=t}}class VU extends UU{constructor(e,t,r){super(e,r),this.intervals=t}}class WU{get enabled(){return this.commandEnabled&&(this.paragraphStyleChangeEnabled||this.characterStyleChangeEnabled)}constructor(e,t,r,i,n){this.commandEnabled=e,this.paragraphStyleChangeEnabled=t,this.characterStyleChangeEnabled=r,this.interval=i,this.visible=!0,this.denyUpdateValue=!1,this.value=n}}class zU extends HU{constructor(e,t,r,i,n){super(e,t,r),this.equalWidth=i,this.activeIndex=n}}class jU extends vU{constructor(e,t,r){super(e),this.keyCode=t,this.callback=r}}class XU extends EU{isEnabled(){return super.isEnabled()}getState(){return new UU(this.isEnabled())}isEnabledInReadOnlyMode(){return!0}executeCore(e,t){return this.control.shortcutManager.assignShortcut(t.keyCode,t.callback),!0}}var GU=__webpack_require__(2674),KU=__webpack_require__(2153);class qU{}class $U extends qU{constructor(e,t,r){super(),this.fieldInterval=e,this.variableName=t,this.args=r,this.value=null,this.keepLastParagraph=!1}}class JU{constructor(e,t,r,i){this.callback=e,this.fieldInterval=t,this.variableName=r,this.args=i}}class YU extends qU{constructor(e){super(),this.data=e}}class QU{constructor(e,t,r){const i=rn.StringUtils.trim(e).replace(/\//g,"\\").match(/(.*?\\?)([^\\]*)(\..+?)$/i);this.isPDF=t,this.folderPath=i?QU.normalizeVirtualFolderPath(i[1],!1):"",this.name=i?i[2]:e,this.extension=this.isPDF?".pdf":i?i[3]:"",this.documentFormat=r||QU.convertToDocumentFormat(`.${this.extension}`)}getFullPath(){return this.folderPath+this.name+this.extension}checkFileName(){if(0===this.name.length)throw new Error("File name is not defined")}checkExtension(){if(0===this.extension.length)throw new Error("File extension is not defined")}static normalizeVirtualFolderPath(e,t){return t&&(e=rn.StringUtils.trim(e).replace(/\//g,"\\")),0==e.length||"\\"==e?"":"\\"==rn.StringUtils.getSymbolFromEnd(e,1)?e:e+"\\"}static convertToDocumentFormat(e){const t=rn.StringUtils.trim(e);return QU.testFormat(t,"doc")?Fu.Doc:QU.testFormat(t,"epub")?Fu.ePub:QU.testFormat(t,"html")||QU.testFormat(t,"htm")?Fu.Html:QU.testFormat(t,"mht")?Fu.Mht:QU.testFormat(t,"odt")?Fu.OpenDocument:QU.testFormat(t,"docx")?Fu.OpenXml:QU.testFormat(t,"txt")?Fu.PlainText:QU.testFormat(t,"rtf")?Fu.Rtf:QU.testFormat(t,"xml")?Fu.WordML:Fu.Undefined}static convertToDocumentExtension(e){const t=e.lastIndexOf("."),r=e.slice(t);return QU.convertExtensionToDocumentFormat(r)!==Fu.Undefined?r:""}static convertExtensionToDocumentFormat(e){switch(e.toLowerCase()){case"doc":case".doc":return Fu.Doc;case"epub":case".epub":return Fu.ePub;case"html":case".html":case"htm":case".htm":return Fu.Html;case"mht":case".mht":return Fu.Mht;case"odt":case".odt":return Fu.OpenDocument;case"docx":case".docx":return Fu.OpenXml;case"txt":case".txt":return Fu.PlainText;case"rtf":case".rtf":return Fu.Rtf;case"xml":case".xml":return Fu.WordML;default:return Fu.Undefined}}static convertToString(e){switch(e){case Fu.Doc:return".doc";case Fu.ePub:return".epub";case Fu.Html:return".html";case Fu.Mht:return".mht";case Fu.OpenDocument:return".odt";case Fu.PlainText:return".txt";case Fu.Rtf:return".rtf";case Fu.WordML:return".xml";case Fu.OpenXml:return".docx";default:return""}}static testFormat(e,t){return new RegExp(`.*\\.${t}$`,"i").test(e)}}class ZU{pixelsToTwips(e){return g.u.pixelsToTwips(e)}inchesToTwips(e){return g.u.inchesToTwips(e)}pointsToTwips(e){return g.u.pointsToTwips(e)}centimetersToTwips(e){return g.u.centimetersToTwips(e)}twipsToCentimeters(e){return g.u.twipsToCentimeters(e)}pixelsToCentimeters(e){return g.u.pixelToCentimeters(e)}twipsToInches(e){return g.u.twipsToInches(e)}pixelsToInches(e){return g.u.pixelsToInches(e)}pixelsToPoints(e){return g.u.pixelsToPoints(e)}twipsToPoints(e){return g.u.twipsToPointsF(e)}twipsToPixels(e){return g.u.twipsToPixelsF(e)}}class eH{constructor(e){this.textCache=Object.create(null),this.charProps=e}getHashCode(){return this.charProps.getHashCode()}equals(e){return this.charProps.equals(e.charProps)}addFont(e,t){this.textCache[e]=t}getFont(e){return this.textCache[e]}replaceUnloadedFonts(e){const t=Object.create(null);for(let r in this.textCache){const i=this.textCache[r];t[r]=i.loaded?i:e[i.controlFontType]}const r=new eH(this.charProps);return r.textCache=t,r}}class tH extends we{replaceUnloadedFonts(e){const t=new tH;return b.j.forEach(this.hashtable,(r=>r.forEach((r=>t.getItem(r.replaceUnloadedFonts(e)))))),t}}class rH{constructor(e,t,r){this.fonts={},this.cache=new tH,this.controlFontsCache=e.controlFontsCache,this.layout=t,this.defaultFont=r?e.fontInfoCache.getItemByName(r):null}addDefaultFont(){if(!this.defaultFont)return;const e=e=>{const t=this.defaultFont.controlFontMap[e],r=this.controlFontsCache.getFontByKey(t);r&&(this.fonts[t]=r)};this.defaultFont.ensureAllControlFontsAssigned(this.controlFontsCache),e(wn.Regular),e(wn.Bold),e(wn.Italic),e(wn.BoldItalic)}collect(){this.addDefaultFont();for(const e of this.layout.pages){for(const t of e.mainSubDocumentPageAreas)this.grabFromPageArea(t);b.j.forEach(e.otherPageAreas,(e=>this.grabFromPageArea(e)))}return b.j.toList(this.fonts)}grabFromPageArea(e){for(const t of e.columns)for(const e of t.rows){e.numberingListBox&&(this.addFont(e.numberingListBox.textBox),e.numberingListBox.separatorBox&&this.addFont(e.numberingListBox.separatorBox));for(const t of e.boxes)this.addFont(t)}}addFont(e){if(I.Y.isAnyOf(e.getType(),lc.Picture,lc.AnchorPicture))return;const t=rH.boxContent(e);t.length&&this.mustHaveFontsForRenderText(e.characterProperties,t)}mustHaveFontsForRenderText(e,t){const r=this.cache.getItem(new eH(e)),i=new pr.Flag;i.set(wn.Bold,e.fontBold),i.set(wn.Italic,e.fontItalic);const n=e.fontInfo.controlFontMap[i.getValue()],o=t.length;let a=null;for(let s=0;s<o;s++){const o=t[s];if(r.getFont(o))continue;const l=o.charCodeAt(0),d=this.controlFontsCache.getFontByKey(n);let c=d&&f.ListUtils.unsafeAnyOf(d.unicodeRanges,(e=>e.contains(l)))?d:null;c||(d?c=d:(a||(a=this.controlFontsCache.addFont(Mn.createDefault(e.fontInfo.getFontFamilies()[0],i))),c=a)),this.fonts[c.cacheKey]||(this.fonts[c.cacheKey]=c),r.addFont(o,c)}}static boxContent(e){switch(e.getType()){case lc.Text:case lc.LayoutDependent:case lc.Dash:return e.text;case lc.ColumnBreak:case lc.LineBreak:case lc.PageBreak:case lc.ParagraphMark:case lc.SectionMark:case lc.TabSpace:case lc.Space:return" ";default:return""}}}class iH{constructor(e,t,r){this.fontsCache=e,this.fontsSettings=t,this.showConsoleMessage=r}loadFonts(e,t,r){this.needInvalidateLayout=!1;const i=[];for(let r of e)r=this.fontsCache.addFont(r),f.ListUtils.unsafeAnyOf(t,(e=>e==r.status))&&i.push(new nH(r,this.fontsSettings));let n=i.length;if(n)for(let e of i)e.font.status=Pn.Loading,this.makeRequest(e,(t=>{e.font.status=t?Pn.Loaded:Pn.Error,t&&(e.font.applySource(t,(()=>{this.needInvalidateLayout=!0})),rn.StringUtils.endsAt(e.currentPath,".ttc")&&(e.font.isFontCollection=!0)),n--,n||r()}));else setTimeout(r,0)}makeRequest(e,t){const r=()=>{this.showConsoleMessage&&e.showError(),t(null)},i=new XMLHttpRequest;i.onload=n=>{if("text/html"!==i.getResponseHeader("Content-Type")){const n=i.response;i.status>=400||!n?e.next()?this.makeRequest(e,t):r():t(n)}else r()},i.onerror=()=>r(),i.open("GET",e.currentPath,!0),i.responseType="arraybuffer",i.send()}}class nH{get currentPath(){return this.sourceUrls[this.ind]}constructor(e,t){this.sourceUrls=[],this.ind=0,this.font=e,this.sourceUrls=e.allSourceUrls(t.defaultFolder)}next(){return++this.ind<this.sourceUrls.length}showError(){console.log("Font is not loaded: {name = "+this.font.fontFamily+", bold = "+this.font.descriptors.msWordBold()+", italic = "+this.font.descriptors.msWordItalic()+"}")}}class oH extends $c{constructor(e,t,r,i,n,o,a,s,l){super(e,t,r,i,n,o,a),this.cacheInfo=s,this.descrtiption=l,this.isLoaded=this.cacheInfo.isLoaded}getType(){return lc.AnchorPicture}equals(e){return super.equals(e)&&this.cacheInfo.equals(e.cacheInfo)&&this.isLoaded==e.isLoaded}clone(){const e=new oH(this.characterProperties,this.colorInfo,this.belongsToSubDocId,this.anchorInfo,this.shape,this.objectId,this.rotationInRadians,this.cacheInfo,this.descrtiption);return e.copyFrom(this),e}renderGetContent(e){return e.renderPictureBoxContent(this.createSize(),this.cacheInfo,this.hyperlinkTip,this.descrtiption)}}var aH,sH,lH=__webpack_require__(1215);class dH{exportCharacterProperties(e,t,r,i,n){const o=t.colorInfo;let a=o.textColor;const s=o.foregroundColor;t.hyperlinkTip&&e.link(r.x,r.y,i.width,i.height,t.hyperlinkTip),s!=y.AUTOMATIC_COLOR&&(e.save(),e.rect(r.x,r.y+1,i.width,i.height-2).fill(w.i.colorToHash(s)),e.restore()),a==y.AUTOMATIC_COLOR&&(a=y.BLACK_COLOR),e.fillColor(w.i.colorToHash(a)),n&&t.characterProperties.fontStrikeoutType&&t.characterProperties.fontUnderlineType&&e.strike(r.x,r.y,i.width,i.height,{color:w.i.colorToHash(a)})}}class cH{constructor(e,t,r){this.doc=e,this.textFontMapCache=t,this.characterPropertiesExporter=new dH,this.measurer=r}export(e,t,r,i,n,o){const a=t.getTop(e),s=Xc.Point.plus(i,new Xc.Point(t.x?t.x:0,a||0)).applyConverter(g.u.pixelsToPointsF),l=t.createSize().applyConverter(g.u.pixelsToPointsF);if((t instanceof LE||t instanceof oH)&&t.cacheInfo.isPdfCompatible()){const e=t.cacheInfo.pdfCompatibleBase64;this.doc.image(e,s.x,s.y,{width:l.width,height:l.height})}else this.exportText(s,l,rH.boxContent(t),t,r,n,o)}getTextPosition(e,t,r){const i=e.characterProperties,n=i.fontSize,o=i.script;let a=0;return o==ne.Normal?a=e.getAscent()-g.u.pointsToPixels(t*n):o==ne.Subscript&&(a=i.fontSize*(1-i.fontInfo.scriptMultiplier)),new Xc.Point(r.x,r.y+a)}createTextProperties(e,t,r){const i={lineGap:0};return t&&e.fontUnderlineType&&(i.underline=!0),t&&e.fontStrikeoutType&&(i.strike=!0),i.baseline=-1*e.fontSize*r,i.lineBreak=!1,i.width=Bo.Constants.MAX_SAFE_INTEGER,i}exportText(e,t,r,i,n,o,a){const s=n<=a,l=this.separateTextByFont(r,i.characterProperties);for(;l.moveToNextInterval();){const n=l.object,a=r.slice(l.interval.start,l.interval.end);if(l.numIntervals>1){const r=new Mg(a,i.characterProperties);this.measurer.measure([r]),l.intervalIndex>0&&(e.x+=t.width),t=r.resultSize.applyConverter(g.u.pixelsToPointsF)}if(n){const r=i.characterProperties,l=r.script==ne.Normal?r.fontSize:r.fontSize*r.fontInfo.scriptMultiplier;this.doc.font(n.cacheKey,void 0,l);const d=this.createTextProperties(r,s,o);this.characterPropertiesExporter.exportCharacterProperties(this.doc,i,e,t,s);const c=this.getTextPosition(i,o,e);this.doc.text(a,c.x,c.y,d)}else this.doc.rect(e.x,e.y,t.width,t.height).stroke()}}separateTextByFont(e,t){const r=e.length,i=this.textFontMapCache.getItem(new eH(t)),n=new lH.g(((e,t)=>e==t?0:1),new Cn.e(0,0));for(let t=0;t<r;t++)n.add(t,i.getFont(e[t]));return n.getIterator()}}class hH{constructor(e,t,r){this.doc=e,this.boxExporter=new cH(e,t,r)}export(e,t){const r=Xc.Point.plus(t,e);r.y+=e.getSpacingBefore();const i=(e.baseLine-e.getSpacingBefore())/(e.height-e.getSpacingBefore()-e.getSpacingAfter());let n=e.boxes.length-1;for(let t;(t=e.boxes[n])&&t.renderNoStrikeoutAndNoUnderlineIfBoxInEndRow();n--);e.numberingListBox&&(this.doc.save(),this.boxExporter.export(e,e.numberingListBox.textBox,0,r,i,n),e.numberingListBox.separatorBox&&this.boxExporter.export(e,e.numberingListBox.separatorBox,0,r,i,n),this.doc.restore());const o=e.getLastVisibleBoxIndex();for(let t=0;t<=o;t++)this.doc.save(),this.boxExporter.export(e,e.boxes[t],t,r,i,n),this.doc.restore()}}class uH{constructor(e){this.doc=e}export(e,t){this.doc.save();const r=Xc.Point.plus(t,e);for(let t of e.tableRows)for(let e of t.backgroundInfos)if(e.color!=y.AUTOMATIC_COLOR&&"transparent"!=y.getCssStringInternal(e.color)){const t=new Xc.Point(r.x+e.x,r.y+e.y).applyConverter(g.u.pixelsToPointsF);this.doc.save(),this.doc.rect(t.x,t.y,g.u.pixelsToPointsF(e.width),g.u.pixelsToPointsF(e.height)).fill(w.i.colorToHash(e.color)),this.doc.restore()}for(let t of e.horizontalBorders)this.exportHorizontalBorder(t,r);for(let t of e.verticalBorders)this.exportVerticalBorder(t,r);this.doc.restore()}isRenderTableBorder(e){return e&&e.style!=de.None&&e.style!=de.Nil}exportHorizontalBorder(e,t){const r=e.borderInfo;if(this.isRenderTableBorder(r)){const i=Xc.Point.plus(t,new Xc.Point(e.xPos,e.yPos)).applyConverter(g.u.pixelsToPointsF);this.drawHorizontalLine(i,g.u.pixelsToPointsF(e.length),g.u.pixelsToPointsF(r.width),r.color)}}exportVerticalBorder(e,t){const r=e.borderInfo;if(this.isRenderTableBorder(r)){const i=Xc.Point.plus(t,new Xc.Point(e.xPos,e.yPos)).applyConverter(g.u.pixelsToPointsF);this.drawVerticalLine(i,g.u.pixelsToPointsF(r.width),g.u.pixelsToPointsF(e.length),r.color)}}drawHorizontalLine(e,t,r,i){this.doc.rect(e.x,e.y-r/2,t,r).fill(w.i.colorToHash(i))}drawVerticalLine(e,t,r,i){this.doc.rect(e.x,e.y,t,r).fill(w.i.colorToHash(i))}}class pH{constructor(e,t,r){this.doc=e,this.rowExporter=new hH(e,t,r),this.tableColumnInfoExporter=new uH(e)}export(e,t,r){this.doc.save();const i=e.clone().applyConverter(g.u.pixelsToPointsF);r&&this.doc.rect(i.x,i.y,i.width,i.height).clip(),e.columns.forEach((r=>this.exportColumn(r,new Xc.Point(e.x,e.y),t))),r&&this.doc.restore()}exportColumn(e,t,r){const i=Xc.Point.plus(t,e);e.tablesInfo.forEach((e=>this.tableColumnInfoExporter.export(e,i))),this.exportParagraphFrames(i,e.paragraphFrames);for(let t of e.rows)this.shouldExportRow(t,i,r)&&this.rowExporter.export(t,i)}shouldExportRow(e,t,r){return e.height>0&&e.y+e.height+t.y<r}exportParagraphFrames(e,t){for(let r of t)if(r.paragraphColor!=y.AUTOMATIC_COLOR){const t=Xc.Point.plus(e,r).applyConverter(g.u.pixelsToPointsF);this.doc.rect(t.x,t.y,g.u.pixelsToPointsF(r.width),g.u.pixelsToPointsF(r.height)).fill(w.i.colorToHash(r.paragraphColor)),this.doc.fillColor(w.i.colorToHash(y.AUTOMATIC_COLOR))}}}class gH{constructor(e,t,r){this.doc=e,this.pageAreaExporter=new pH(e,t,r)}export(e,t,r){this.doc.addPage(this.getPageOptions(e));const i=new Xc.Point(e.x,e.y).applyConverter(g.u.pixelsToPointsF),n=e.createSize().applyConverter(g.u.pixelsToPointsF);this.drawRect(i,n,r);const o=e.anchoredObjectHolder.getObjectsForRenderer(t,e.anchoredObjectHolder.objects);this.exportFloatingObjects(e,o,0,e.renderLevelCalculator.headerFooterPageAreasLevel),this.exportHeaderFooter(e),this.exportFloatingObjects(e,o,e.renderLevelCalculator.headerFooterPageAreasLevel,e.renderLevelCalculator.mainPageAreaLevel),this.exportMainSubDocument(e),this.exportFloatingObjects(e,o,e.renderLevelCalculator.mainPageAreaLevel,e.renderLevelCalculator.maxRenderLevels)}exportFloatingObjects(e,t,r,i){t.filter((e=>r<=e.rendererLevel&&e.rendererLevel<i)).forEach((t=>{this.doc.save(),this.exportFloatingObject(e,t),this.doc.restore()}))}exportFloatingObject(e,t){const r=new Xc.Point(t.x,t.y).applyConverter(g.u.pixelsToPointsF),i=t.createSize().applyConverter(g.u.pixelsToPointsF),n=g.u.radiansToDegrees(t.rotationInRadians);if(n&&this.doc.rotate(n,{origin:[r.x+i.width/2,r.y+i.height/2]}),t instanceof oH)t.cacheInfo.isPdfCompatible()&&this.doc.image(t.cacheInfo.pdfCompatibleBase64,r.x,r.y,{width:i.width,height:i.height});else if(t.getType()==lc.AnchorTextBox){const n=t,o=b.j.elementBy(e.otherPageAreas,(e=>e.subDocument.id==n.internalSubDocId));if(!o)return;const a=n.shape;this.drawRect(r,i,a.fillColor,a.outlineColor,a.outlineWidth),this.pageAreaExporter.export(o,e.bottom,!0)}}drawRect(e,t,r,i=y.AUTOMATIC_COLOR,n=0){this.doc.save(),r!=y.AUTOMATIC_COLOR&&"transparent"!=y.getCssStringInternal(r)&&(this.doc.rect(e.x,e.y,t.width,t.height),this.doc.fillOpacity(y.getOpacity(r)),this.doc.fill(w.i.colorToHash(r))),i!=y.AUTOMATIC_COLOR&&n>0&&this.drawOutlineRect(e,t,n,i),this.doc.fillColor(w.i.colorToHash(y.AUTOMATIC_COLOR)),this.doc.restore()}drawOutlineRect(e,t,r,i){this.doc.polygon([e.x,e.y],[e.x+t.width,e.y],[e.x+t.width,e.y+t.height],[e.x,e.y+t.height]),this.doc.lineWidth(g.u.pixelsToPointsF(r)),this.doc.strokeOpacity(y.getOpacity(i)),this.doc.strokeColor(w.i.colorToHash(i)),this.doc.stroke()}exportMainSubDocument(e){e.mainSubDocumentPageAreas.forEach((t=>this.pageAreaExporter.export(t,e.bottom,!1)))}exportHeaderFooter(e){b.j.forEach(e.otherPageAreas,(t=>{t.subDocument.isTextBox()||this.pageAreaExporter.export(t,e.height,!1)}))}getPageOptions(e){const t={};return t.size=[g.u.pixelsToPointsF(e.width)+1,g.u.pixelsToPointsF(e.height)+1],t.margins={top:0,left:0,bottom:0,right:0},t}}class mH{get layoutFormatterManager(){return this.docProcessor.layoutFormatterManager}get measurer(){return this.docProcessor.layoutFormatterManager.measurer}get pdfFontCache(){return this.docProcessor.modelManager.model.cache.controlFontsCache}get pdfSettings(){return this.docProcessor.modelManager.richOptions.pdf}get fontsSettings(){return this.docProcessor.modelManager.richOptions.fonts}constructor(e){this.docProcessor=e}export(e,t){const r="function"==typeof t?t:t&&t.modifyPdfDocument?t.modifyPdfDocument:()=>{},i="function"!=typeof t&&t&&t.modifyPdfPage?t.modifyPdfPage:()=>{};if(!this.layoutFormatterManager.isDocumentOpened)return void setTimeout((()=>r(null)),0);const n=()=>{if(!this.pdfSettings.pdfDocument)return console.warn("Pdf kit library is not loaded."),void setTimeout((()=>r(null)),0);if(!this.pdfSettings.blobStream)return console.warn("Blob stream library is not loaded."),void setTimeout((()=>r(null)),0);const t=this.layoutFormatterManager.layout;for(;!t.isFullyFormatted;)this.layoutFormatterManager.runFormatting(t.validPageCount);const n=new rH(this.docProcessor.modelManager.model.cache,t,this.fontsSettings.mappings.defaultFontName),o=n.collect(),a=new iH(this.pdfFontCache,this.fontsSettings,!0);a.loadFonts(o,[Pn.Unloaded],(()=>{f.ListUtils.unsafeAnyOf(o,(e=>this.pdfFontCache.getFont(e)))?(0,bn.lX)()?(0,bn.mw)((()=>{for(a.needInvalidateLayout&&this.docProcessor.invalidateLayoutAfterFontsLoaded();!t.isFullyFormatted;)this.layoutFormatterManager.runFormatting(t.validPageCount);this.exportDocument(t,o,n,e,r,i)})):this.exportDocument(t,o,n,e,r,i):r(null)}))},o=this.docProcessor.modelManager.richOptions.pdf.pdfKitScriptUrl;!o||this.pdfSettings.pdfDocument&&this.pdfSettings.blobStream?n():GU.FileUtils.loadJavascriptFile(o,n)}exportDocument(e,t,r,i,n,o){this.docProcessor.modelManager.modelManipulator.picture.loader.ensureAllPicturesPdfCompatible(3e3,this.pdfSettings.convertImageToCompatibleFormat,(()=>{const a=new this.pdfSettings.pdfDocument({autoFirstPage:!1,font:"Symbol"}),s=new this.pdfSettings.blobStream;s.on("finish",(()=>{const e=s.toBlob("application/pdf");i(e,s)})),a.pipe(s);for(let e of t){const t=this.pdfFontCache.getFont(e);t&&a.registerFont(e.cacheKey,t.data,t.isFontCollection?t.fontFamily:void 0)}const l=this.replaceUnloadedFonts(r),d=new gH(a,l,this.measurer);e.pages.forEach((t=>{d.export(t,e.anchorObjectsPositionInfo,e.pageColor),o(a)})),n(a),a.end()}))}replaceUnloadedFonts(e){const t={},r=this.docProcessor.modelManager.richOptions.fonts.mappings.defaultFontName,i=r?this.docProcessor.modelManager.model.cache.fontInfoCache.getItemByName(r):null;if(i)for(let e of[wn.Regular,wn.Bold,wn.Italic,wn.BoldItalic])t[e]=this.getControlFontByType(i,e);return e.cache.replaceUnloadedFonts(t)}getControlFontByType(e,t){const r=e.controlFontMap[t],i=this.docProcessor.modelManager.model.cache.controlFontsCache.getFontByKey(r);return i&&i.loaded?i:void 0}}function fH(e,t,r){new mH(e).export(t,r)}function bH(e,t,r){fH(e,((e,r)=>{GU.FileUtils.startDownloadFileLocal(e,t+".pdf")}),r)}class CH{set onCalculateDocumentVariable(e){this._processor.onCalculateDocumentVariable=e?t=>e(this,t):null}constructor(){this.unitConverter=new ZU}importDocument(e,t,r){this._processor.openDocument(e,t,r),this.document=new yU(this._processor)}exportDocumentToBase64(e,t){this._processor.exportDocumentToBase64(e,t||null)}exportDocumentToBlob(e,t){this._processor.exportDocumentToBlob(e,t||null)}downloadDocument(e,t){const r=t;this._processor.exportDocumentToBlob((t=>GU.FileUtils.startDownloadFileLocal(t,e+QU.convertToString(r))),r)}exportToPdf(e,t){fH(this._processor,((t,r)=>{lo.Base64Utils.fromBlobAsArrayBuffer(t,(i=>e(i,t,r)))}),t)}downloadPdf(e,t){bH(this._processor,e,t)}dispose(){this._processor.dispose()}_importInnerDocument(e){this._processor.openInnerDocument(e),this.document=new yU(this._processor)}_initByEmptyModel(){const e=new vw(new Mw).createModel(this._processor.modelManager.richOptions).fillModel();this._processor.openInnerDocument(e),this.document=new yU(this._processor)}}!function(e){e[e.PlainText=1]="PlainText",e[e.Rtf=2]="Rtf",e[e.Html=3]="Html",e[e.OpenXml=4]="OpenXml"}(aH||(aH={}));class SH extends BP{constructor(){super(...arguments),this.limitBookmarkNameTo40Chars=!0,this.limitStyleNameTo253Chars=!0,this.limitFontNameTo31Chars=!0,this.allowAlternateStyleNames=!0,this.exportCompatibilitySettings=!0}}const IH=null!==(sH=oF())&&void 0!==sH?sH:nF;class PH{constructor(){this.zip=new IH,this.folders={}}addFile(e,t){this.zip.file(e,'<?xml version="1.0" encoding="utf-8"?>\n'+t.convertToString(),{createFolders:!0})}addBase64(e,t){this.zip.file(e,t,{createFolders:!0,base64:!0})}generateBlob(e){this.zip.generateAsync({type:"blob",mimeType:dF.document,compression:"DEFLATE",compressionOptions:{level:1}}).then(e)}generateBase64(e){this.zip.generateAsync({type:"base64",compression:"DEFLATE",compressionOptions:{level:1}}).then(e)}}class wH{static convertToHexString(e){return e.toString(16)}static getValueFromTables(e,t,r){const i=e.exportMap[t];return void 0!==i?i.mlValue.openXmlValue:e.exportMap[r].mlValue.openXmlValue}static getValueFromTablesExplicitDefault(e,t,r){const i=e.exportMap[t];return void 0!==i?i.mlValue.openXmlValue:r}}var yH=__webpack_require__(9279);class xH{constructor(e){this.rootNamespaces=[],this.constants=e}initNS(e,t){return this.dom=document.implementation.createDocument(t,e,null),this.curr=this.dom.documentElement,this}convertToString(){const e=(new XMLSerializer).serializeToString(this.dom.documentElement);if(yH.Browser.IE){const t=[],r=e.match(/\<.*?\>/)[0];for(const e of this.rootNamespaces){const i=`xmlns:${e.prefix}="${e.namespace}"`;-1==r.search(i)&&t.push(i)}return e.replace(/xmlns.*?\".*?\"/,`$& ${t.join(" ")} `).replace('xmlns:xml="http://www.w3.org/XML/1998/namespace"',"")}return e}addNamespaceToRootElement(e){const t=this.constants.namespaces[e];this.rootNamespaces.push(t),this.dom.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns"+(rn.StringUtils.isNullOrEmpty(t.prefix)?"":`:${t.prefix}`),t.namespace)}elementStart(e){return this.curr=this.curr.appendChild(this.dom.createElementNS(this.curr.namespaceURI,this.prefixPlusLocalName(this.constants.mapNamespaceToPrefix[this.curr.namespaceURI],e))),this}elementStartNS(e,t){const r=this.constants.namespaces[e];return this.curr=this.curr.appendChild(this.dom.createElementNS(r.namespace,this.prefixPlusLocalName(r.prefix,t))),this}endElement(){return this.curr=this.curr.parentNode,this}attr(e,t){return this.curr.setAttribute(e,t),this}attrNS(e,t,r){const i=this.constants.namespaces[e];return this.curr.setAttributeNS(i.namespace,this.prefixPlusLocalName(i.prefix,t),r),this}writeString(e){return this.curr.appendChild(this.dom.createTextNode(e)),this}writeRaw(e){const t=(new DOMParser).parseFromString(e,dF.xml).documentElement.childNodes;for(let e=t.length;e>0;e--)this.curr.appendChild(t[0])}writeWpEmptyElement(e){this.writeWpStartElement(e),this.endElement()}writeWpStartElement(e){this.elementStartNS(ZD.WordProcessing,e)}writeWpsStartElement(e){this.elementStartNS(ZD.Wps,e)}writeWpDrawingStartElement(e){this.elementStartNS(ZD.WordProcessingDrawing,e)}writeDrawingStartElement(e){this.elementStartNS(ZD.DrawingML,e)}writeWp14DrawingStartElement(e){this.elementStartNS(ZD.WordProcessingDrawing14,e)}writeMcStartElement(e){this.elementStartNS(ZD.MC,e)}writePicDrawingStartElement(e){this.elementStartNS(ZD.DrawingMLPicture,e)}writeWpStringValue(e,t){this.writeWpStartElement(e),this.attrNS(ZD.WordProcessing,"val",t),this.endElement()}writeWpBoolValue(e,t){this.writeWpStringValue(e,this.convertBoolToString(t))}writeWpBoolValueAsTag(e,t){t&&(this.writeWpStartElement(e),this.endElement())}writeWpIntValue(e,t){this.writeWpStringValue(e,t.toString())}writeWpStringAttr(e,t){const r=this.constants.namespaces[ZD.WordProcessing];this.curr.setAttributeNS(r.namespace,this.prefixPlusLocalName(r.prefix,e),t)}writeWpBoolAttr(e,t){this.writeWpStringAttr(e,this.convertBoolToString(t))}writeWpIntAttr(e,t){this.writeWpStringAttr(e,t.toString())}writeDCEmptyElement(e){this.elementStartNS(ZD.DC,e),this.endElement()}writeCPEmptyElement(e){this.elementStartNS(ZD.CP,e),this.endElement()}writeBoolValue(e,t){this.attr(e,this.convertBoolToString(t))}writeIntValue(e,t){const r=Math.floor(t);if(O.isDebug&&r!==t)throw new Error(R.D.InternalException);this.attr(e,r.toString())}writeWpEmptyOrFalseValue(e,t){t?this.writeWpEmptyElement(e):this.writeWpBoolValue(e,!1)}prefixPlusLocalName(e,t){return rn.StringUtils.isNullOrEmpty(e)?t:`${e}:${t}`}convertBoolToString(e){return e?"1":"0"}}class TH{get writer(){return this.data.writer}constructor(e){this.data=e}}class vH extends TH{export(){const e=(rn.StringUtils.isNullOrEmpty(this.rootNSPrefix)?"":`${this.rootNSPrefix}:`)+this.rootElement;this.data.writer=new xH(this.data.constants).initNS(e,this.rootNSValue),this.fillWriter(),this.isWriteToZip()&&this.writeToZip(this.filePath,this.writer),this.data.popWriter()}get rootNSPrefix(){return""}get rootNSValue(){return""}isWriteToZip(){return!0}writeToZip(e,t){this.data.zipBuilder.addFile(e,t)}}class MH extends TH{get colorProvider(){return this.data.model.colorProvider}static convertScript(e){switch(e){case ne.Subscript:return"subscript";case ne.Superscript:return"superscript";default:case ne.Normal:return"baseline"}}exportRunPropertiesCore(e){this.fontName(e),this.bold(e),this.italic(e),this.allCaps(e),this.smallCaps(e),this.strikeout(e),this.noProof(e),this.hidden(e),this.foreColor(e),this.doubleFontSize(e),this.fontUnderline(e),this.backColor(e),this.fontScript(e),this.rightToLeft(e),this.langInfo(e)}exportStyleCharacterProperties(e){this.writer.writeWpStartElement("rPr"),this.exportRunPropertiesCore(e),this.writer.endElement()}exportRunProperties(e){this.shouldExportRunProperties(e)&&(this.writer.writeWpStartElement("rPr"),e.characterStyle.styleName!=zl.defaultParagraphCharacterStyleName&&this.writer.writeWpStringValue("rStyle",this.data.charStyleExporter.getStyleId(this.data.model.stylesManager.characterStyleNameToIndex[e.characterStyle.styleName])),this.exportRunPropertiesCore(e.maskedCharacterProperties),this.writer.endElement())}shouldExportRunProperties(e){const t=e.maskedCharacterProperties;return t.getUseValue(ie.UseFontName)||t.getUseValue(ie.UseDoubleFontSize)||t.getUseValue(ie.UseFontBold)||t.getUseValue(ie.UseFontItalic)||t.getUseValue(ie.UseFontUnderlineType)||t.getUseValue(ie.UseUnderlineWordsOnly)||t.getUseValue(ie.UseFontStrikeoutType)||t.getUseValue(ie.UseAllCaps)||t.getUseValue(ie.UseSmallCaps)||t.getUseValue(ie.UseForeColorIndex)||t.getUseValue(ie.UseShadingInfoIndex)||t.getUseValue(ie.UseHighlightColorIndex)||t.getUseValue(ie.UseUnderlineColorIndex)&&!U.isTransparentOrEmpty(t.underlineColor.toRgb(this.colorProvider))||t.getUseValue(ie.UseScript)||t.getUseValue(ie.UseHidden)||t.getUseValue(ie.UseLangInfo)||t.getUseValue(ie.UseRightToLeft)||t.getUseValue(ie.UseNoProof)||e.characterStyle.styleName!=zl.defaultParagraphCharacterStyleName}fontName(e){if(!e.getUseValue(ie.UseFontName)||!e.fontInfo)return;this.writer.writeWpStartElement("rFonts");const t=e.fontInfo.name;this.writer.writeWpStringAttr("ascii",t),this.writer.writeWpStringAttr(new AR("hAnsi").openXmlValue,t),this.writer.endElement()}bold(e){e.getUseValue(ie.UseFontBold)&&this.writer.writeWpBoolValue("b",e.fontBold)}italic(e){e.getUseValue(ie.UseFontItalic)&&this.writer.writeWpBoolValue("i",e.fontItalic)}allCaps(e){e.getUseValue(ie.UseAllCaps)&&this.writer.writeWpBoolValue("caps",e.allCaps)}smallCaps(e){e.getUseValue(ie.UseSmallCaps)&&this.writer.writeWpBoolValue("smallCaps",e.smallCaps)}strikeout(e){if(e.getUseValue(ie.UseFontStrikeoutType))switch(e.fontStrikeoutType){case se.Double:this.writer.writeWpBoolValue("dstrike",!0);break;case se.None:this.writer.writeWpBoolValue("strike",!1);break;default:this.writer.writeWpBoolValue("strike",!0)}}noProof(e){e.getUseValue(ie.UseNoProof)&&(this.writer.writeWpStartElement("noProof"),this.writer.writeWpBoolAttr("val",e.noProof),this.writer.endElement())}hidden(e){e.getUseValue(ie.UseHidden)&&this.writer.writeWpBoolValue("vanish",e.hidden)}doubleFontSize(e){e.getUseValue(ie.UseDoubleFontSize)&&this.writer.writeWpIntValue("sz",2*e.fontSize)}fontScript(e){e.getUseValue(ie.UseScript)&&this.writer.writeWpStringValue("vertAlign",MH.convertScript(e.script))}rightToLeft(e){}langInfo(e){e.getUseValue(ie.UseLangInfo)&&(this.writer.writeWpStartElement("lang"),e.langInfo.latin&&this.writer.writeWpStringAttr("val",e.langInfo.latin),e.langInfo.bidi&&this.writer.writeWpStringAttr("bidi",e.langInfo.bidi),e.langInfo.eastAsia&&this.writer.writeWpStringAttr("eastAsia",e.langInfo.eastAsia),this.writer.endElement())}fontUnderline(e){const t=e.getUseValue(ie.UseFontUnderlineType),r=e.getUseValue(ie.UseUnderlineWordsOnly),i=e.getUseValue(ie.UseUnderlineColorIndex),n=i?e.underlineColor.toRgb(this.colorProvider):null;(t||r||i&&!U.isTransparentOrEmpty(n))&&(this.writer.writeWpStartElement("u"),r&&e.underlineWordsOnly&&t&&e.fontUnderlineType==le.Single?this.writer.writeWpStringAttr("val","words"):t&&this.writer.writeWpStringAttr("val",wH.getValueFromTables(NR.underlineTables,e.fontUnderlineType,le.Single)),i&&!U.isTransparentOrEmpty(n)&&this.data.colorExporter.exportColorInfo(e.underlineColor,"color",!1),this.writer.endElement())}backColor(e){if(e.getUseValue(ie.UseHighlightColorIndex)){const t=e.highlightColor.toRgb(this.colorProvider);U.isTransparentOrEmpty(t)||t==y.NO_COLOR||this.writer.writeWpStringValue("highlight",this.data.colorExporter.convertHighlightColorToString(e.highlightColor.toRgb(this.colorProvider)))}e.getUseValue(ie.UseShadingInfoIndex)&&e.shadingInfo.getActualColor(this.colorProvider)!=y.NO_COLOR&&this.data.colorExporter.exportShadingCore(e.shadingInfo,!0)}foreColor(e){e.getUseValue(ie.UseForeColorIndex)&&(this.writer.writeWpStartElement("color"),this.data.colorExporter.exportColorInfo(e.textColor,"val",!0),this.writer.endElement())}}class EH extends TH{get colorProvider(){return this.data.model.colorProvider}static convertThemeColorValue(e){return wH.getValueFromTables(NR.themeColorValueTable,e,z.None)}static convertThemeColorIndex(e){return wH.getValueFromTables(NR.themeColorIndexTable,e,ce.None)}static convertShadingPattern(e){return wH.getValueFromTables(NR.shadingPatternTable,e,re.Clear)}static convertColorToString(e){return w.i.colorToHash(e).substr(1)}exportColorInfo(e,t,r){const i=e.toRgb(this.colorProvider);U.isTransparentOrEmpty(i)?r&&this.writer.writeWpStringAttr(t,"auto"):(this.writer.writeWpStringAttr(t,EH.convertColorToString(i)),e.themeValue!=z.None?this.writer.writeWpStringAttr("themeColor",EH.convertThemeColorValue(e.themeValue)):e.themeColorIndex!=ce.None&&this.writer.writeWpStringAttr("themeColor",EH.convertThemeColorIndex(e.themeColorIndex)),e.tint<0&&e.tint>Bo.Constants.MIN_SAFE_INTEGER&&this.writer.writeWpStringAttr("themeShade",wH.convertToHexString(hP.calculateShadeFromColorModelInfoTint(e.tint))),e.tint>0&&this.writer.writeWpStringAttr("themeTint",wH.convertToHexString(hP.calculateTintFromColorModelInfoTint(e.tint))))}convertHighlightColorToString(e){if(U.isTransparentOrEmpty(e))return NR.predefinedBackgroundColors.exportMap[U.empty].mlValue.openXmlValue;const t=NR.predefinedBackgroundColors.exportMap[e];if(void 0!==t)return t.mlValue.openXmlValue;const r=U.calculateNearestColor(NR.listOfKeysPredefinedBackgroundColors,e),i=this.data.currentTableBackgroundColor;return U.isTransparentOrEmpty(i)||i!=e||r==e?NR.predefinedBackgroundColors.exportMap[r].mlValue.openXmlValue:""}exportShadingCore(e,t){this.writer.writeWpStartElement("shd"),this.writer.writeWpStringAttr("val",EH.convertShadingPattern(e.shadingPattern)),this.exportColorInfo(e.foreColor,"color",t),this.exportFillInfo(e.backColor),this.writer.endElement()}exportFillInfo(e){const t=e.toRgb(this.colorProvider);U.isTransparentOrEmpty(t)?this.writer.writeWpStringAttr("fill","auto"):this.writer.writeWpStringAttr("fill",EH.convertColorToString(t)),e.themeValue!=z.None?this.writer.writeWpStringAttr("themeFill",EH.convertThemeColorValue(e.themeValue)):e.themeColorIndex!=ce.None&&this.writer.writeWpStringAttr("themeFill",EH.convertThemeColorIndex(e.themeColorIndex)),e.tint<0&&e.tint>Bo.Constants.MIN_SAFE_INTEGER&&this.writer.writeWpStringAttr("themeFillShade",wH.convertToHexString(hP.calculateShadeFromColorModelInfoTint(e.tint))),e.tint>0&&this.writer.writeWpStringAttr("themeFillTint",wH.convertToHexString(hP.calculateTintFromColorModelInfoTint(e.tint)))}}class DH extends TH{exportSectionLevelFootNoteProperties(e){this.isDefault(e)||(this.writer.writeWpStartElement("footnotePr"),this.exportNoteProperties(e),this.writer.endElement())}exportSectionLevelEndNoteProperties(e){this.isDefault(e)||(this.writer.writeWpStartElement("endnotePr"),this.exportNoteProperties(e),this.writer.endElement())}exportDocumentLevelFootNoteProperties(e){(!this.isDefault(e)||this.data.footNotes.size>0)&&(this.writer.writeWpStartElement("footnotePr"),this.exportNoteProperties(e),this.exportFootNoteSeparators(),this.writer.endElement())}exportDocumentLevelEndNoteProperties(e){(!this.isDefault(e)||this.data.endNotes.size>0)&&(this.writer.writeWpStartElement("endnotePr"),this.exportNoteProperties(e),this.exportEndNoteSeparators(),this.writer.endElement())}exportSectionFootNoteColumnCount(e){e&&e.columnCount!==DH.defaultProperties.columnCount&&(this.writer.elementStartNS(ZD.w15,"footnoteColumns"),this.writer.writeWpIntAttr("val",e.columnCount),this.writer.endElement())}isDefault(e){return!e||e.equals(DH.defaultProperties)}exportNoteProperties(e){const t=DH.defaultProperties.position;e.position!=t&&this.writer.writeWpStringValue("pos",wH.getValueFromTables(NR.footNotePlacementTable,e.position,t)),e.startingNumber!=DH.defaultProperties.startingNumber&&this.writer.writeWpIntValue("numStart",e.startingNumber);const r=DH.defaultProperties.numberingFormat;e.numberingFormat!=r&&this.writer.writeWpStringValue("numFmt",wH.getValueFromTables(NR.pageNumberingFormatTable,e.numberingFormat,r));const i=DH.defaultProperties.numberingRestartType;e.numberingRestartType!=i&&this.writer.writeWpStringValue("numRestart",wH.getValueFromTables(NR.noteNumberingRestartTypeTable,e.numberingRestartType,i))}exportFootNoteSeparators(){this.exportNoteSeparators(this.data.model.footNoteSeparators,this.exportFootNoteSeparator.bind(this))}exportEndNoteSeparators(){this.exportNoteSeparators(this.data.model.endNoteSeparators,this.exportEndNoteSeparator.bind(this))}exportFootNoteSeparator(e){this.exportNoteSeparator("footnote",e,this.data.footNotes)}exportEndNoteSeparator(e){this.exportNoteSeparator("endnote",e,this.data.endNotes)}exportNoteSeparators(e,t){for(const r of e.getSeparatos())t(r)}exportNoteSeparator(e,t,r){const i=r.get(t);this.writer.writeWpStartElement(e),this.writer.writeWpIntAttr("id",i),this.writer.endElement()}}DH.defaultProperties=Ql.createDefault();class FH extends TH{static createDefaultProperties(){const e=new yh;return e.pageSize=new so.Size(12240,15840),e.landscape=!1,e.equalWidthColumns=!0,e.differentFirstPage=!1,e.space=g.u.hundredthsOfMillimeterToTwips(1250),e}constructor(e,t){super(e),this._section=t}exportProperties(){this.writer.writeWpStartElement("sectPr"),this.exportSectionHeadersFootersCore(this._section),this.exportSectionPropertiesCore(this._section),this.writer.endElement()}exportHeaderFooter(e,t){const r=e.getObject(t);if(r){const e=this.data.model.sections.indexOf(this._section),i=this.data.model.sections[e-1];if(i){if(r===(r.isHeader?i.headers:i.footers).getObject(t))return}const n=this.data.model.subDocuments[r.subDocumentId];this.data.exportSubDocumentsList.push(n);const o=`${n.isHeader()?"header":"footer"}${n.id}`,a=`${o}.xml`;this.data.contentTypesExporter.registerContentTypeOverride(`/word/${a}`,n.isHeader()?dF.header:dF.footer),(n.isHeader()?this.data.mainSubDocumentRelations.headerRelationsTable:this.data.mainSubDocumentRelations.footerRelationsTable)[o]=a,this.writer.writeWpStartElement(n.isHeader()?"headerReference":"footerReference"),this.writer.writeWpStringAttr("type",wH.getValueFromTables(NR.headerFooterTypeTable,t,Ws.Odd)),this.writer.attrNS(ZD.Rels,"id",o),this.writer.endElement()}}exportSectionHeadersFootersCore(e){this.exportHeaderFooter(e.headers,Ws.First),this.exportHeaderFooter(e.headers,Ws.Even),this.exportHeaderFooter(e.headers,Ws.Odd),this.exportHeaderFooter(e.footers,Ws.First),this.exportHeaderFooter(e.footers,Ws.Even),this.exportHeaderFooter(e.footers,Ws.Odd)}exportSectionPropertiesCore(e){const t=new DH(this.data);t.exportSectionLevelFootNoteProperties(e.sectionProperties.footNote),t.exportSectionLevelEndNoteProperties(e.sectionProperties.endNote);const r=e.sectionProperties;this.writer.writeWpStringValue("type",wH.getValueFromTables(NR.sectionStartTypeTable,r.startType,Vs.NextPage)),this.exportSectionPage(r),this.exportSectionMargins(r),this.exportSectionLineNumbering(r),this.exportSectionPageNumbering(r),this.exportSectionColumns(r),t.exportSectionFootNoteColumnCount(e.sectionProperties.footNote),this.exportSectionGeneralSettings(r)}exportSectionPage(e){this.shouldExportSectionPage(e)&&(this.writer.writeWpStartElement("pgSz"),e.pageSize.width!=FH.defaultProps.pageSize.width&&this.writer.writeWpIntAttr("w",e.pageSize.width),e.pageSize.height!=FH.defaultProps.pageSize.height&&this.writer.writeWpIntAttr("h",e.pageSize.height),e.landscape&&this.writer.writeWpStringAttr("orient",e.landscape?"landscape":"portrait"),this.writer.endElement())}shouldExportSectionPage(e){return!e.pageSize.equals(FH.defaultProps.pageSize)||e.landscape!=FH.defaultProps.landscape}exportSectionMargins(e){this.writer.writeWpStartElement("pgMar"),this.writer.writeWpIntAttr("left",e.marginLeft),this.writer.writeWpIntAttr("right",e.marginRight),this.writer.writeWpIntAttr("top",e.marginTop),this.writer.writeWpIntAttr("bottom",e.marginBottom),this.writer.writeWpIntAttr("header",e.headerOffset),this.writer.writeWpIntAttr("footer",e.footerOffset),this.writer.endElement()}exportSectionLineNumbering(e){const t=e.lineNumbering;if(t.isDefined){if(this.writer.writeWpStartElement("lnNumType"),this.writer.writeWpIntAttr("countBy",t.countBy),t.start!==Ph.start&&this.writer.writeWpIntAttr("start",t.start-1),t.distance!==Ph.distance&&this.writer.writeWpIntAttr("distance",t.distance),t.restart!==Ph.restart){const e=NR.lineNumberingRestartTable.exportMap[t.restart];e&&this.writer.writeWpStringAttr("restart",e.mlValue.openXmlValue)}this.writer.endElement()}}exportSectionPageNumbering(e){if(this.shouldExportPageNumbering(e)){this.writer.writeWpStartElement("pgNumType");try{e.continueNumbering||this.writer.writeWpIntAttr("start",e.firstPageNumber)}finally{this.writer.endElement()}}}shouldExportPageNumbering(e){return!e.continueNumbering}exportSectionColumns(e){this.shouldExportSectionColumns(e)&&(this.writer.writeWpStartElement("cols"),this.writer.writeWpBoolAttr("equalWidth",e.equalWidthColumns),e.equalWidthColumns?this.exportEqualWidthColumns(e):this.exportNonUniformColumns(e),this.writer.endElement())}shouldExportSectionColumns(e){return e.equalWidthColumns!=FH.defaultProps.equalWidthColumns||e.columnCount!=FH.defaultProps.columnCount||e.space!=FH.defaultProps.space}exportEqualWidthColumns(e){e.columnCount!=FH.defaultProps.columnCount&&this.writer.writeWpIntAttr("num",e.columnCount),e.space!=FH.defaultProps.space&&this.writer.writeWpIntAttr("space",e.space)}exportNonUniformColumns(e){e.columnsInfo.length!=FH.defaultProps.columnCount&&this.writer.writeWpIntAttr("num",e.columnsInfo.length);for(const t of e.columnsInfo)this.writer.writeWpStartElement("col"),this.writer.writeWpIntAttr("w",t.width),this.writer.writeWpIntAttr("space",t.space),this.writer.endElement()}exportSectionGeneralSettings(e){e.differentFirstPage!=FH.defaultProps.differentFirstPage&&this.writer.writeWpBoolValue("titlePg",e.differentFirstPage)}}FH.defaultProps=FH.createDefaultProperties();class RH extends TH{static convertLineSpacingValue(e,t){return e==Ne.AtLeast||e==Ne.Exactly?Math.round(t):(e==Ne.Single?t=1:e==Ne.Double?t=2:e==Ne.Sesquialteral&&(t=1.5),Math.round(240*t))}static shouldExportParagraphBorder(e,t){return t&&(!e||t.style!=de.None||0!=t.width)}exportParagraphPropertiesCore(e,t,r,i,n){e.getUseValue(Be.UseKeepWithNext)&&this.writer.writeWpBoolValue("keepNext",e.keepWithNext),e.getUseValue(Be.UseKeepLinesTogether)&&this.writer.writeWpBoolValue("keepLines",e.keepLinesTogether),e.getUseValue(Be.UsePageBreakBefore)&&e.pageBreakBefore&&this.writer.writeWpBoolValue("pageBreakBefore",e.pageBreakBefore),e.getUseValue(Be.UseWidowOrphanControl)&&this.writer.writeWpBoolValue("widowControl",e.widowOrphanControl),e.getUseValue(Be.UseSuppressLineNumbers)&&this.writer.writeWpBoolValue(new AR("suppressLineNumbers","supressLineNumbers").openXmlValue,e.suppressLineNumbers),e.getUseValue(Be.UseShadingInfoIndex)&&this.data.colorExporter.exportShadingCore(e.shadingInfo,!1),e.getUseValue(Be.UseSuppressHyphenation)&&this.writer.writeWpBoolValue("suppressAutoHyphens",e.suppressHyphenation),e.getUseValue(Be.UseRightToLeft)&&!n&&this.writer.writeWpBoolValue("bidi",e.rightToLeft),e.getUseValue(Be.UseContextualSpacing)&&this.writer.writeWpBoolValue("contextualSpacing",e.contextualSpacing),e.getUseValue(Be.UseAlignment)&&this.writer.writeWpStringValue("jc",wH.getValueFromTables(NR.paragraphAlignmentTable,e.alignment,Ae.Left)),e.getUseValue(Be.UseDivId)&&!n&&this.writer.writeWpIntValue("divId",e.divId),this.exportParagraphBorders(e,n),this.exportParagraphSpacing(e),this.exportParagraphIndentation(e),this.exportParagraphOutlineLevel(e),this.exportParagraphNumbering(t,r),i&&i.call(this)}exportStyleParagraphProperties(e,t,r,i){this.writer.writeWpStartElement("pPr"),this.data.parPropsExporter.exportParagraphPropertiesCore(e,r,i,(()=>this.exportTabProperties(t)),!1),this.writer.endElement()}exportParagraphProperties(e,t,r,i){this.shouldExportParagraphProperties(e,t,r)&&(this.writer.writeWpStartElement("pPr"),this.data.parPropsExporter.exportParagraphPropertiesCore(r.maskedParagraphProperties,r.numberingListIndex,r.listLevelIndex,(()=>this.exportTabProperties(r.tabs)),!1),r.paragraphStyle&&this.writer.writeWpStringValue("pStyle",this.data.parStyleExporter.getStyleId(this.data.parStyleExporter.getStyleIndexByName(r.paragraphStyle.styleName))),this.data.charPropsExporter.exportRunProperties(i),this.shouldExportSectionProperties(e,t,r)&&new FH(this.data,t).exportProperties(),this.writer.endElement())}exportTabProperties(e){if(this.shouldExportTabProperties(e)){this.writer.writeWpStartElement("tabs");for(const t of e.tabsInfo)t.isDefault||this.exportTab(t);this.writer.endElement()}}exportParagraphNumbering(e,t){this.shouldExportParagraphNumbering(e,t)&&(this.writer.writeWpStartElement("numPr"),t>0&&this.writer.writeWpIntValue("ilvl",t),(e>=QP.minValue||e==cn.NoNumberingListIndex)&&this.writer.writeWpIntValue("numId",this.getNumberingListIndexForExport(e)),this.writer.endElement())}shouldExportParagraphNumbering(e,t){return e==cn.NoNumberingListIndex||e>=QP.minValue||t>0}exportParagraphOutlineLevel(e){if(e.getUseValue(Be.UseOutlineLevel)){let t=e.outlineLevel;t<=0||t>=10?this.writer.writeWpIntValue("outlineLvl",9):this.writer.writeWpIntValue("outlineLvl",t-1)}}exportParagraphSpacing(e){(e.getUseValue(Be.UseLineSpacing)||e.getUseValue(Be.UseSpacingBefore)||e.getUseValue(Be.UseSpacingAfter)||e.getUseValue(Be.UseBeforeAutoSpacing)||e.getUseValue(Be.UseAfterAutoSpacing))&&(this.writer.writeWpStartElement("spacing"),e.getUseValue(Be.UseLineSpacing)&&this.writer.writeWpStringAttr(new AR("lineRule").openXmlValue,wH.getValueFromTables(NR.lineSpacingTable,e.lineSpacingType,Ne.Single)),e.getUseValue(Be.UseLineSpacing)&&this.writer.writeWpIntAttr("line",RH.convertLineSpacingValue(e.lineSpacingType,e.lineSpacing)),e.getUseValue(Be.UseSpacingBefore)&&this.writer.writeWpIntAttr("before",e.spacingBefore),e.getUseValue(Be.UseSpacingAfter)&&this.writer.writeWpIntAttr("after",e.spacingAfter),e.getUseValue(Be.UseBeforeAutoSpacing)&&this.writer.writeWpBoolAttr(new AR("beforeAutospacing","before-autospacing").openXmlValue,e.beforeAutoSpacing),e.getUseValue(Be.UseAfterAutoSpacing)&&this.writer.writeWpBoolAttr(new AR("afterAutospacing","after-autospacing").openXmlValue,e.afterAutoSpacing),this.writer.endElement())}exportParagraphIndentation(e){if(e.getUseValue(Be.UseFirstLineIndent)||e.getUseValue(Be.UseFirstLineIndent)||e.getUseValue(Be.UseLeftIndent)||e.getUseValue(Be.UseRightIndent)){if(this.writer.writeWpStartElement("ind"),e.getUseValue(Be.UseFirstLineIndent))switch(e.firstLineIndentType){case ke.Hanging:this.writer.writeWpIntAttr("hanging",e.firstLineIndent),e.getUseValue(Be.UseLeftIndent)&&this.writer.writeWpIntAttr("left",e.leftIndent);break;case ke.Indented:this.writer.writeWpIntAttr(new AR("firstLine").openXmlValue,e.firstLineIndent),e.getUseValue(Be.UseLeftIndent)&&this.writer.writeWpIntAttr("left",e.leftIndent);break;case ke.None:this.writer.writeWpIntAttr(new AR("firstLine").openXmlValue,0),e.getUseValue(Be.UseLeftIndent)&&this.writer.writeWpIntAttr("left",e.leftIndent)}else e.getUseValue(Be.UseLeftIndent)&&this.writer.writeWpIntAttr("left",e.leftIndent);e.getUseValue(Be.UseRightIndent)&&this.writer.writeWpIntAttr("right",e.rightIndent),this.writer.endElement()}}exportParagraphBorders(e,t){const r=e.getUseValue(Be.UseBetweenBorder)&&RH.shouldExportParagraphBorder(t,e.betweenBorder),i=e.getUseValue(Be.UseBottomBorder)&&RH.shouldExportParagraphBorder(t,e.bottomBorder),n=e.getUseValue(Be.UseLeftBorder)&&RH.shouldExportParagraphBorder(t,e.leftBorder),o=e.getUseValue(Be.UseRightBorder)&&RH.shouldExportParagraphBorder(t,e.rightBorder),a=e.getUseValue(Be.UseTopBorder)&&RH.shouldExportParagraphBorder(t,e.topBorder);(r||i||n||o||a)&&(this.writer.writeWpStartElement("pBdr"),a&&this.exportParagraphBorder("top",e.topBorder),n&&this.exportParagraphBorder("left",e.leftBorder),i&&this.exportParagraphBorder("bottom",e.bottomBorder),o&&this.exportParagraphBorder("right",e.rightBorder),r&&this.exportParagraphBorder("between",e.betweenBorder),this.writer.endElement())}exportParagraphBorder(e,t){this.writer.writeWpStartElement(e),this.writer.writeWpStringAttr("val",wH.getValueFromTables(NR.borderLineStyleTable,t.style,de.None)),this.writer.writeWpIntAttr("sz",g.u.twipsToPointsF(8*t.width)),this.writer.writeWpIntAttr("space",g.u.twipsToPointsF(t.offset)),this.writer.writeWpBoolAttr("shadow",t.shadow),this.writer.writeWpBoolAttr("frame",t.frame),this.data.colorExporter.exportColorInfo(t.color,"color",!1),this.writer.endElement()}getNumberingListIndexForExport(e){return e==cn.NoNumberingListIndex?0:e+1}exportTab(e){this.writer.writeWpStartElement("tab"),e.deleted?this.writer.writeWpStringAttr("val","clear"):this.writer.writeWpStringAttr("val",wH.getValueFromTables(NR.tabAlignmentTable,e.alignment,Ha.Left)),this.writer.writeWpIntAttr("pos",P.MathUtils.restrictValue(e.position,-31680,31680)),this.writer.writeWpStringAttr("leader",wH.getValueFromTables(NR.tabLeaderTable,e.leader,Sg.None)),this.writer.endElement()}shouldExportTabProperties(e){return e&&!!f.ListUtils.unsafeAnyOf(e.tabsInfo,(e=>!e.isDefault))}shouldExportParagraphProperties(e,t,r){const i=r.maskedParagraphProperties;return i.getUseValue(Be.UseAlignment)||i.getUseValue(Be.UseFirstLineIndent)||i.getUseValue(Be.UseLeftIndent)||i.getUseValue(Be.UseRightIndent)||i.getUseValue(Be.UseLineSpacing)||i.getUseValue(Be.UseSpacingAfter)||i.getUseValue(Be.UseSpacingBefore)||i.getUseValue(Be.UseSuppressHyphenation)||i.getUseValue(Be.UseSuppressLineNumbers)||i.getUseValue(Be.UseContextualSpacing)||i.getUseValue(Be.UseRightToLeft)||i.getUseValue(Be.UsePageBreakBefore)||i.getUseValue(Be.UseBeforeAutoSpacing)||i.getUseValue(Be.UseAfterAutoSpacing)||i.getUseValue(Be.UseKeepWithNext)||i.getUseValue(Be.UseKeepLinesTogether)||i.getUseValue(Be.UseWidowOrphanControl)||i.getUseValue(Be.UseOutlineLevel)||i.getUseValue(Be.UseShadingInfoIndex)||i.getUseValue(Be.UseLeftBorder)||i.getUseValue(Be.UseRightBorder)||i.getUseValue(Be.UseTopBorder)||i.getUseValue(Be.UseBottomBorder)||i.getUseValue(Be.UseBetweenBorder)||i.getUseValue(Be.UseDivId)||r.paragraphStyle.styleName!=es.normalStyleName||this.data.charPropsExporter.shouldExportRunProperties(e.getRunByPosition(r.getEndPosition()-1))||r.isInList()||this.shouldExportSectionProperties(e,t,r)||this.shouldExportTabProperties(r.tabs)}shouldExportSectionProperties(e,t,r){return e.isMain()&&r.getEndPosition()==t.getEndPosition()&&r!=f.ListUtils.last(e.paragraphs)}}class LH extends TH{export(e,t){e.deleted||(this.writer.writeWpStartElement("style"),this.writer.writeWpStringAttr("type",this.getType()),this.writer.writeWpStringAttr("styleId",this.getStyleId(t)),0==t&&this.writer.writeWpBoolAttr("default",!0),e.hidden&&this.writer.writeWpEmptyElement("hidden"),e.semihidden&&this.writer.writeWpEmptyElement("semiHidden"),this.exportStyleName(e),this.exportParentStyle(e),this.exportCore(e),this.writer.writeWpBoolValueAsTag("qFormat",e.primary),this.writer.endElement())}exportStyleName(e){this.writer.writeWpStringValue("name",e.styleName)}exportParentStyle(e){null!=e.parent&&this.writer.writeWpStringValue("basedOn",this.getStyleId(this.getStyleIndexByName(e.parent.styleName)))}}class BH extends LH{getStyleId(e){return"C"+e.toString()}getStyleIndexByName(e){return this.data.model.stylesManager.characterStyleNameToIndex[e]}getType(){return"character"}exportCore(e){e.linkedStyle&&this.writer.writeWpStringValue("link",this.getStyleId(this.data.parStyleExporter.getStyleIndexByName(e.linkedStyle.styleName))),this.data.charPropsExporter.exportStyleCharacterProperties(e.maskedCharacterProperties)}}class AH extends LH{getStyleId(e){return"N"+e.toString()}getStyleIndexByName(e){return this.data.model.stylesManager.characterStyleNameToIndex[e]}getType(){return""}exportCore(e){}}class NH extends LH{getStyleId(e){return"P"+e.toString()}getStyleIndexByName(e){return this.data.model.stylesManager.paragraphStyleNameToIndex[e]}getType(){return"paragraph"}exportCore(e){null!=e.nextParagraphStyle&&this.writer.writeWpStringValue("next",this.getStyleId(this.getStyleIndexByName(e.nextParagraphStyle.styleName))),e.linkedStyle&&this.writer.writeWpStringValue("link",this.getStyleId(this.data.charStyleExporter.getStyleIndexByName(e.linkedStyle.styleName))),e.autoUpdate&&this.writer.writeWpBoolValue("autoRedefine",e.autoUpdate),this.data.parPropsExporter.exportStyleParagraphProperties(e.maskedParagraphProperties,e.tabs,e.numberingListIndex,e.listLevelIndex),this.data.charPropsExporter.exportStyleCharacterProperties(e.maskedCharacterProperties)}}class kH extends TH{static convertTableRowAlignment(e){return e==je.Both?NR.tableRowAlignmentTable[je.Center].mlValue.openXmlValue:wH.getValueFromTables(NR.tableRowAlignmentTable,e,je.Left)}exportTableRowProperties(e){const t=e.properties;this.writer.writeWpStartElement("trPr"),this.exportTableRowPropertiesCore(t),e.gridBefore&&(this.writer.writeWpIntValue("gridBefore",e.gridBefore),this.data.tableWidthExporter.exportWidthUnitValue("wBefore",e.widthBefore)),e.gridAfter&&(this.writer.writeWpIntValue("gridAfter",e.gridAfter),this.data.tableWidthExporter.exportWidthUnitValue("wAfter",e.widthAfter)),0!=e.height.value&&this.exportTableRowHeight(e.height),this.writer.endElement()}exportPropsForStyles(e){this.writer.writeWpStartElement("trPr"),this.exportTableRowPropertiesCore(e),this.writer.endElement()}exportTableRowPropertiesCore(e){e.getUseValue(Ua.UseCantSplit)&&this.writer.writeWpEmptyElement("cantSplit"),e.getUseValue(Ua.UseHeader)&&this.writer.writeWpEmptyElement("tblHeader"),e.getUseValue(Ua.UseCellSpacing)&&this.data.tableWidthExporter.exportWidthUnitValue("tblCellSpacing",e.cellSpacing),e.tableRowAlignment!=je.Left&&this.writer.writeWpStringValue("jc",kH.convertTableRowAlignment(e.tableRowAlignment)),e.getUseValue(Ua.UseHideCellMark)&&this.writer.writeWpBoolValue("hidden",e.hideCellMark),e.getUseValue(Ua.UseDivId)&&this.writer.writeWpIntValue("divId",e.divId)}exportTableRowHeight(e){this.writer.writeWpStartElement("trHeight"),e.type!=$e.Auto&&this.writer.writeWpStringAttr("hRule",wH.getValueFromTables(NR.heightUnitTypeTable,e.type,$e.Auto)),this.writer.writeWpIntAttr("val",e.value),this.writer.endElement()}}class OH extends TH{static exportTableBorderCore(e,t,r){e.writer.writeWpStringAttr("val",wH.getValueFromTables(NR.borderLineStyleTable,t.style,de.None)),e.writer.writeWpIntAttr("sz",g.u.twipsToPoints(8*t.width)),e.writer.writeWpIntAttr("space",g.u.twipsToPoints(t.offset)),e.writer.writeWpBoolAttr("shadow",t.shadow),e.writer.writeWpBoolAttr("frame",t.frame),e.colorExporter.exportColorInfo(t.color,"color",r)}exportTablePropertiesCore(e,t){const r=e.properties;this.exportCoreProps(r,t),r.isTableOverlap||this.writer.writeWpStringValue("tblOverlap",r.isTableOverlap?"overlap":"never"),r.getUseValue(ur.UseTableStyleRowBandSize)&&this.writer.writeWpIntValue("tblStyleRowBandSize",Math.max(r.tableStyleRowBandSize,1)),r.getUseValue(ur.UseTableStyleColBandSize)&&this.writer.writeWpIntValue("tblStyleColBandSize",Math.max(r.tableStyleColumnBandSize,1)),this.data.tableWidthExporter.exportWidthUnitValue("tblW",e.preferredWidth),this.exportTableBorders(r),this.exportCellMargins(r),e.lookTypes!=_e.None&&this.writer.writeWpStringValue("tblLook",rn.StringUtils.padLeft(e.lookTypes.toString(16).toUpperCase(),4,"0"))}exportTablePropertiesForStyle(e){this.writer.writeWpStartElement("tblPr"),this.exportCoreProps(e,!1),this.exportCellMargins(e),this.writer.endElement()}exportTablePropertiesException(e){this.shouldExportTblPropsException(e)&&(this.writer.writeWpStartElement("tblPrEx"),this.exportCoreProps(e,!0),_H.shouldExportCellMargins(this.data,e.cellMargins)&&_H.exportCellMargins(this.data,"tblCellMar",e.cellMargins),this.writer.endElement())}exportCoreProps(e,t){e.getUseValue(ur.UseTableAlignment)&&this.writer.writeWpStringValue("jc",kH.convertTableRowAlignment(e.tableRowAlignment)),e.getUseValue(ur.UseCellSpacing)&&this.data.tableWidthExporter.exportWidthUnitValue("tblCellSpacing",e.cellSpacing),e.getUseValue(ur.UseTableIndent)&&this.data.tableWidthExporter.exportWidthUnitValue("tblInd",e.indent),this.exportTableBorders(e),e.shadingInfo.equals(fe.noColor)||this.data.colorExporter.exportShadingCore(e.shadingInfo,!1),e.getUseValue(ur.UseTableLayout)&&t&&(this.writer.writeWpStartElement("tblLayout"),this.writer.writeWpStringAttr("type",wH.getValueFromTables(NR.tableLayoutTypeTable,e.layoutType,Oe.Autofit)),this.writer.endElement())}shouldExportTblPropsException(e){return e.getUseValue(ur.UseTableAlignment)||e.getUseValue(ur.UseCellSpacing)||e.getUseValue(ur.UseTableIndent)||e.getUseValue(ur.UseShadingInfoIndex)||e.getUseValue(ur.UseTableLayout)||this.shouldExportTableBorders(e)||_H.shouldExportCellMargins(this.data,e.cellMargins)}exportCellMargins(e){(e.getUseValue(ur.UseLeftMargin)||e.getUseValue(ur.UseRightMargin)||e.getUseValue(ur.UseTopMargin)||e.getUseValue(ur.UseBottomMargin))&&(this.writer.writeWpStartElement("tblCellMar"),e.getUseValue(ur.UseTopMargin)&&this.exportCellMargin("top",e.cellMargins.top),e.getUseValue(ur.UseLeftMargin)&&this.exportCellMargin("left",e.cellMargins.left),e.getUseValue(ur.UseBottomMargin)&&this.exportCellMargin("bottom",e.cellMargins.bottom),e.getUseValue(ur.UseRightMargin)&&this.exportCellMargin("right",e.cellMargins.right),this.writer.endElement())}exportCellMargin(e,t){this.data.tableWidthExporter.writeTableUnit(e,t.value,t.type==Je.Nil&&0==t.value?Je.ModelUnits:t.type)}exportTableBorders(e){if(this.shouldExportTableBorders(e)){const t=e.borders;this.writer.writeWpStartElement("tblBorders"),e.getUseValue(ur.UseTopBorder)&&this.exportTableBorder("top",t.top),e.getUseValue(ur.UseLeftBorder)&&this.exportTableBorder("left",t.left),e.getUseValue(ur.UseBottomBorder)&&this.exportTableBorder("bottom",t.bottom),e.getUseValue(ur.UseRightBorder)&&this.exportTableBorder("right",t.right),e.getUseValue(ur.UseInsideHorizontalBorder)&&this.exportTableBorder("insideH",t.insideHorizontal),e.getUseValue(ur.UseInsideVerticalBorder)&&this.exportTableBorder("insideV",t.insideVertical),this.writer.endElement()}}shouldExportTableBorders(e){const t=(t,r)=>e.getUseValue(t)&&r.style!=de.Nil;return t(ur.UseTopBorder,e.borders.top)||t(ur.UseRightBorder,e.borders.right)||t(ur.UseBottomBorder,e.borders.bottom)||t(ur.UseLeftBorder,e.borders.left)||t(ur.UseInsideHorizontalBorder,e.borders.insideHorizontal)||t(ur.UseInsideVerticalBorder,e.borders.insideVertical)}exportTableBorder(e,t){t.style!=de.Nil&&(this.writer.writeWpStartElement(e),OH.exportTableBorderCore(this.data,t,!0),this.writer.endElement())}}class _H extends TH{static exportCellMargins(e,t,r){e.writer.writeWpStartElement(t),e.tableWidthExporter.exportWidthUnitValue("top",r.top),e.tableWidthExporter.exportWidthUnitValue("left",r.left),e.tableWidthExporter.exportWidthUnitValue("bottom",r.bottom),e.tableWidthExporter.exportWidthUnitValue("right",r.right),e.writer.endElement()}static shouldExportCellMargins(e,t){return!(e.tableWidthExporter.forbidExportWidthUnit(t.bottom)&&e.tableWidthExporter.forbidExportWidthUnit(t.left)&&e.tableWidthExporter.forbidExportWidthUnit(t.top)&&e.tableWidthExporter.forbidExportWidthUnit(t.right))}exportTableCellProperties(e){this.writer.writeWpStartElement("tcPr"),this.exportTableCellPropertiesCore(e,!0),this.writer.endElement()}exportTableCellPropertiesForStyle(e){this.writer.writeWpStartElement("tcPr"),this.exportCoreProperties(e,!0),this.writer.endElement()}exportTableCellPropertiesCore(e,t){const r=e.properties;r.getUseValue(Ye.UseCellConditionalFormatting)&&this.writer.writeWpStringValue("cnfStyle",rn.StringUtils.padLeft(e.conditionalFormatting.toString(2),12,"0")),this.data.tableWidthExporter.exportWidthUnitValue("tcW",e.preferredWidth),e.columnSpan>1&&this.writer.writeWpIntValue("gridSpan",e.columnSpan),e.verticalMerging!=Xe.None&&this.writer.writeWpStringValue("vMerge",wH.getValueFromTables(NR.mergingStateTable,e.verticalMerging,Xe.Restart)),this.exportCoreProperties(r,t)}exportCoreProperties(e,t){t&&this.exportTableCellBorders(e),e.getUseValue(Ye.UseShadingInfoIndex)&&this.data.colorExporter.exportShadingCore(e.shadingInfo,!0),e.getUseValue(Ye.UseNoWrap)&&this.writer.writeWpEmptyOrFalseValue("noWrap",e.noWrap),_H.shouldExportCellMargins(this.data,e.cellMargins)&&_H.exportCellMargins(this.data,"tcMar",e.cellMargins),e.getUseValue(Ye.UseTextDirection)&&this.writer.writeWpStringValue("textDirection",wH.getValueFromTables(NR.textDirectionTable,e.textDirection,Ge.LeftToRightTopToBottom)),e.getUseValue(Ye.UseFitText)&&this.writer.writeWpEmptyOrFalseValue("tcFitText",e.fitText),e.getUseValue(Ye.UseVerticalAlignment)&&this.writer.writeWpStringValue("vAlign",wH.getValueFromTables(NR.verticalAlignmentTable,e.verticalAlignment,Ke.Top)),e.getUseValue(Ye.UseHideCellMark)&&this.writer.writeWpEmptyOrFalseValue("hideMark",e.hideCellMark)}exportTableCellBorders(e){if(this.hasBorders(e)){const t=e.borders;this.writer.writeWpStartElement("tcBorders"),e.getUseValue(Ye.UseTopBorder)&&this.exportTableCellBorder("top",t.top),e.getUseValue(Ye.UseLeftBorder)&&this.exportTableCellBorder("left",t.left),e.getUseValue(Ye.UseBottomBorder)&&this.exportTableCellBorder("bottom",t.bottom),e.getUseValue(Ye.UseRightBorder)&&this.exportTableCellBorder("right",t.right),e.getUseValue(Ye.UseTopLeftDiagonalBorder)&&this.exportTableCellBorder("tl2br",t.topLeftDiagonal),e.getUseValue(Ye.UseTopRightDiagonalBorder)&&this.exportTableCellBorder("tr2bl",t.topRightDiagonal),this.writer.endElement()}}hasBorders(e){const t=(t,r)=>e.getUseValue(t)&&r.style!=de.Nil;return t(Ye.UseTopBorder,e.borders.top)||t(Ye.UseRightBorder,e.borders.right)||t(Ye.UseBottomBorder,e.borders.bottom)||t(Ye.UseLeftBorder,e.borders.left)||t(Ye.UseTopRightDiagonalBorder,e.borders.topLeftDiagonal)||t(Ye.UseTopLeftDiagonalBorder,e.borders.topRightDiagonal)}exportTableCellBorder(e,t){t.style!=de.Nil&&(this.writer.writeWpStartElement(e),t.style==de.None?this.writer.writeWpStringAttr("val",NR.borderLineStyleTable.exportMap[de.Nil].mlValue.openXmlValue):OH.exportTableBorderCore(this.data,t,!1),this.writer.endElement())}}class UH extends LH{getStyleId(e){return"T"+e.toString()}getStyleIndexByName(e){return this.data.model.stylesManager.tableStyleNameToIndex[e]}getType(){return"table"}exportCore(e){this.exportTableConditionalStyle(e.baseConditionalStyle),e.conditionalStyles&&!b.j.isEmpty(e.conditionalStyles)&&b.j.forEach(e.conditionalStyles,((e,t)=>{e&&(this.writer.writeWpStartElement("tblStylePr"),this.writer.writeWpStringAttr("type",wH.getValueFromTables(NR.conditionalTableStyleFormattingTypesTable,t,qe.WholeTable)),this.exportTableConditionalStyle(e),this.writer.endElement())}))}exportTableConditionalStyle(e){e.maskedParagraphProperties.useValue!=Be.UseNone&&this.data.parPropsExporter.exportStyleParagraphProperties(e.maskedParagraphProperties,e.tabs,cn.NumberingListNotSettedIndex,cn.NumberingListNotSettedIndex),e.maskedCharacterProperties.getUseValueFull()!=ie.UseNone&&this.data.charPropsExporter.exportStyleCharacterProperties(e.maskedCharacterProperties),this.data.tablePropsExporter.exportTablePropertiesForStyle(e.tableProperties),new kH(this.data).exportPropsForStyles(e.tableRowProperties),new _H(this.data).exportTableCellPropertiesForStyle(e.tableCellProperties)}}class HH extends TH{exportWidthUnitValue(e,t){this.forbidExportWidthUnit(t)||this.writeTableUnit(e,t.value,t.type)}forbidExportWidthUnit(e){return e.type==Je.Nil&&0==e.value}writeTableUnit(e,t,r){this.writer.writeWpStartElement(e),this.writer.writeWpIntAttr("w",t),this.writer.writeWpStringAttr("type",wH.getValueFromTables(NR.widthUnitTypesTable,r,Je.ModelUnits)),this.writer.endElement()}}class VH extends TH{exportTextRunCore(e){let t=0;const r=e.length;for(let i=0;i<r;i++){const r=e[i],n=NR.runBreaksTable.exportMap[r.charCodeAt(0)];n?(this.exportTextCorePartial(e,t,i-t),t=i+1,this.exportBreak(n.mlValue.openXmlValue)):r==an.specialCharacters.TabMark&&(this.exportTextCorePartial(e,t,i-t),t=i+1,this.writer.writeWpStartElement("tab"),this.writer.endElement())}this.exportTextCorePartial(e,t,r-t)}removeSpecialSymbols(e){if(!this.containsSpecialSymbols(e))return e;const t=[],r=e.length;for(let i=0;i<r;i++){const r=e[i],n=r.charCodeAt(0);(n>VH.lastLowSpecial&&n<VH.firstHighSpecial||"\t"==r||"\n"==r||"\r"==r)&&t.push(r)}return t.join("")}exportTextCorePartial(e,t,r){r>0&&this.exportTextCore(0==t&&r==e.length?e:e.substr(t,r))}exportTextCore(e){rn.StringUtils.isNullOrEmpty(e)||(e=this.removeSpecialSymbols(e),rn.StringUtils.isNullOrEmpty(e)||(this.writer.writeWpStartElement(this.getTextTag()),/ /.test(e)&&this.writer.attrNS(ZD.Xml,"space","preserve"),this.writer.writeString(e),this.writer.endElement()))}exportBreak(e){this.writer.elementStartNS(ZD.WordProcessing,"br"),this.writer.writeWpStringAttr("type",e),this.writer.endElement()}getTextTag(){return 0==this.data.subDocumentExporter.fieldCodeDepth?"t":"instrText"}containsSpecialSymbols(e){const t=e.length;for(let r=0;r<t;r++){const t=e[r],i=t.charCodeAt(0);if((i<=VH.lastLowSpecial||i>=VH.firstHighSpecial)&&"\t"!=t&&"\n"!=t&&"\r"!=t)return!0}return!1}}VH.lastLowSpecial="".charCodeAt(0),VH.firstHighSpecial="￿".charCodeAt(0);class WH extends vH{get filePath(){return"word/numbering.xml"}get rootElement(){return new AR("numbering","lists").openXmlValue}get rootNSPrefix(){return this.data.constants.namespaces[ZD.WordProcessing].prefix}get rootNSValue(){return this.data.constants.namespaces[ZD.WordProcessing].namespace}static shouldExportNumbering(e){return!!e.numberingLists.length}export(){WH.shouldExportNumbering(this.data.model)&&super.export()}fillWriter(){f.ListUtils.forEach(this.data.model.abstractNumberingLists,((e,t)=>{this.writer.writeWpStartElement("abstractNum"),this.writer.writeWpIntAttr("abstractNumId",t),this.writer.writeWpStringValue("nsid",rn.StringUtils.padLeft(wH.convertToHexString(e.getId()),8,"0")),this.writer.writeWpStringValue("multiLevelType",wH.getValueFromTables(NR.numberingListTypeTable,e.getListType(),tn.Bullet));this.exportLevels(e.levels),this.writer.endElement()})),f.ListUtils.forEach(this.data.model.numberingLists,((e,t)=>{this.writer.writeWpStartElement("num"),this.writer.writeWpIntAttr("numId",t+1),this.writer.writeWpIntValue("abstractNumId",e.abstractNumberingListIndex),this.exportOverrideLevels(e.levels),this.writer.endElement()}))}exportOverrideLevels(e){f.ListUtils.forEach(e,((e,t)=>{(e.overrideStart||e instanceof Qi)&&this.exportLevelOverride(e,t)}))}exportLevelOverride(e,t){this.writer.writeWpStartElement("lvlOverride"),this.writer.writeWpIntAttr("ilvl",t),e.overrideStart&&this.exportStartOverride(e.getNewStart()),e instanceof Qi&&this.exportLevel(e,t),this.writer.endElement()}exportStartOverride(e){this.writer.writeWpIntValue("startOverride",e)}exportLevel(e,t){this.writer.writeWpStartElement("lvl"),this.writer.writeWpIntAttr("ilvl",t),e.getListLevelProperties().templateCode&&this.writer.writeWpStringAttr("tplc",rn.StringUtils.padLeft(e.getListLevelProperties().templateCode.toString(16),8,"0")),this.exportLevelProperties(e,t),this.exportLevelParagraphProperties(e.getParagraphProperties(),null),this.exportLevelCharacterProperties(e.getCharacterProperties()),this.writer.endElement()}exportLevels(e){f.ListUtils.forEach(e,((e,t)=>{this.exportLevel(e,t)}))}exportLevelProperties(e,t){const r=e.getListLevelProperties();this.writer.writeWpIntValue("start",r.start),this.exportNumberFormatValue(r),r.suppressRestart?this.writer.writeWpIntValue("lvlRestart",0):0!=r.relativeRestartLevel&&this.writer.writeWpIntValue("lvlRestart",t-r.relativeRestartLevel);const i=e instanceof Ji?e:null;null!=i&&this.exportAbstractLevelProperties(i),r.convertPreviousLevelNumberingToDecimal&&this.writer.writeWpBoolValue("isLgl",r.convertPreviousLevelNumberingToDecimal),this.writer.writeWpStringValue("suff",wH.getValueFromTables(NR.listNumberSeparatorTable,r.separator.charCodeAt(0),"\0".charCodeAt(0))),this.writer.writeWpStringValue("lvlText",this.convertFormatString(r.displayFormatString)),r.legacy&&(this.writer.writeWpStartElement("legacy"),this.writer.writeWpIntAttr("legacy",1),this.writer.writeWpIntAttr("legacyIndent",r.legacyIndent),this.writer.writeWpIntAttr("legacySpace",r.legacySpace),this.writer.endElement()),this.writer.writeWpStringValue("lvlJc",wH.getValueFromTables(NR.listNumberAlignmentTable,r.alignment,en.Left))}exportLevelParagraphProperties(e,t){this.writer.writeWpStartElement("pPr"),this.data.parPropsExporter.exportParagraphPropertiesCore(e,cn.NumberingListNotSettedIndex,-1,null,!1),this.writer.endElement()}exportLevelCharacterProperties(e){this.writer.writeWpStartElement("rPr"),this.data.charPropsExporter.exportRunPropertiesCore(e),this.writer.endElement()}convertFormatString(e){try{return this.data.model.simpleFormattersManager.formatString(e,"%1","%2","%3","%4","%5","%6","%7","%8","%9")}catch(e){return""}}exportNumberFormatValue(e){this.writer.writeWpStringValue("numFmt",wH.getValueFromTables(NR.pageNumberingFormatTable,e.format,Zi.Decimal))}exportAbstractLevelProperties(e){}}class zH extends vH{get filePath(){return"[Content_Types].xml"}get rootElement(){return"Types"}get rootNSPrefix(){return""}get rootNSValue(){return this.data.constants.namespaces[ZD.ContentTypes].namespace}constructor(e){super(e),this.usedContentTypes={},this.overriddenContentTypes={},this.registerContentType("rels",dF.relations),this.registerContentType("xml",dF.xml),this.registerContentTypeOverride("/word/document.xml",dF.mainDocument),WH.shouldExportNumbering(e.model)&&this.registerContentTypeOverride("/word/numbering.xml",dF.numbering),this.registerContentTypeOverride("/word/styles.xml",dF.styles),this.registerContentTypeOverride("/word/settings.xml",dF.settings),this.registerContentTypeOverride("/docProps/core.xml",dF.coreProperties)}registerContentTypeOverride(e,t){this.overriddenContentTypes[e]=t}registerContentType(e,t){this.usedContentTypes[e]=t}fillWriter(){B.StringMapUtils.forEach(this.usedContentTypes,((e,t)=>{this.writer.elementStart("Default"),this.writer.attr("Extension",t),this.writer.attr("ContentType",e),this.writer.endElement()})),B.StringMapUtils.forEach(this.overriddenContentTypes,((e,t)=>{this.writer.elementStart("Override"),this.writer.attr("PartName",t),this.writer.attr("ContentType",e),this.writer.endElement()}))}}class jH extends vH{constructor(){super(...arguments),this.styleNameToIndex=new Map,this.sortedStyleIndexes=[],this.processedStyleNames=new Set}get filePath(){return"word/styles.xml"}get rootElement(){return"styles"}get rootNSPrefix(){return this.data.constants.namespaces[ZD.WordProcessing].prefix}get rootNSValue(){return this.data.constants.namespaces[ZD.WordProcessing].namespace}fillWriter(){this.exportDocumentDefaults();const e=this.getSortedStyleIndexes();f.ListUtils.forEach(e,(e=>this.data.parStyleExporter.export(this.data.model.paragraphStyles[e],e))),f.ListUtils.forEach(this.data.model.characterStyles,((e,t)=>this.data.charStyleExporter.export(e,t))),f.ListUtils.forEach(this.data.model.tableStyles,((e,t)=>this.data.tblStyleExporter.export(e,t)))}exportDocumentDefaults(){this.writer.writeWpStartElement("docDefaults"),this.exportDocumentCharacterDefaults(),this.exportDocumentParagraphDefaults(),this.writer.endElement()}exportDocumentCharacterDefaults(){this.writer.writeWpStartElement("rPrDefault"),this.writer.writeWpStartElement("rPr"),this.data.charPropsExporter.exportRunPropertiesCore(this.data.model.defaultCharacterProperties),this.writer.endElement(),this.writer.endElement()}exportDocumentParagraphDefaults(){this.writer.writeWpStartElement("pPrDefault"),this.writer.writeWpStartElement("pPr"),this.data.parPropsExporter.exportParagraphPropertiesCore(this.data.model.defaultParagraphProperties,cn.NumberingListNotSettedIndex,0,null,!0),this.writer.endElement(),this.writer.endElement()}getSortedStyleIndexes(){this.styleNameToIndex=new Map,this.sortedStyleIndexes=[],this.processedStyleNames=new Set;const e=this.data.model.paragraphStyles;e.forEach(((e,t)=>this.styleNameToIndex.set(e.styleName,t)));for(let t=0;t<e.length;t++)this.sortStyleIndexRecursive(t);return this.sortedStyleIndexes}sortStyleIndexRecursive(e){const t=this.data.model.paragraphStyles[e];if(!this.processedStyleNames.has(t.styleName)){if(this.processedStyleNames.add(t.styleName),t.parent){const e=this.styleNameToIndex.get(t.parent.styleName);this.sortStyleIndexRecursive(e)}this.sortedStyleIndexes.push(e)}}}class XH extends jc.m{constructor(e=0,t=0,r=0,i=0){super(i,t,e,r)}}class GH{constructor(e){this.run=e}get fillColor(){return this.run.shape.fillColor}get isFloatingObject(){return!1}get containerProperties(){return this.run.info.containerProperties}get nonVisualDrawingObjectProperties(){return this.run.info.nonVisualDrawingProperties}get actualSize(){return this.run.size.actualSize}get rotation(){return 0}get lockAspectRatio(){return this.run.size.lockAspectRatio}get allowOverlap(){return!1}get isBehindDoc(){return!1}get layoutInTableCell(){return!1}get locked(){return!1}get zOrder(){return 0}get useBottomDistance(){return!1}get bottomDistance(){return 0}get useLeftDistance(){return!1}get leftDistance(){return 0}get useRightDistance(){return!1}get rightDistance(){return 0}get useTopDistance(){return!1}get topDistance(){return 0}get useHidden(){return!1}get hidden(){return!1}get horizontalPositionAlignment(){return mc.None}get horizontalPositionType(){return gc.Page}get usePercentOffset(){return!1}get verticalPositionAlignment(){return bc.None}get verticalPositionType(){return fc.Page}get useRotation(){return!1}get textWrapType(){return uc.None}get textWrapSide(){return pc.Left}get shape(){return null}get useRelativeWidth(){return!1}get useRelativeHeight(){return!1}get relativeSize(){return new so.Size(0,0)}get relativeHeightType(){return hc.Page}get relativeWidthType(){return cc.Page}get offset(){return new Xc.Point(0,0)}get percentOffset(){return new Xc.Point(0,0)}get hyperlinkInfo(){return null}get sourceRect(){return new XH(0,0,0,0)}get isTextBox(){return!1}}class KH{constructor(e){this.run=e}get fillColor(){return this.run.shape.fillColor}get isFloatingObject(){return!0}get containerProperties(){return this.isTextBox?this.run.containerProperties:this.run.info.containerProperties}get nonVisualDrawingObjectProperties(){return null}get actualSize(){return this.run.size.actualSize}get rotation(){return this.run.size.rotation}get lockAspectRatio(){return this.run.size.lockAspectRatio}get allowOverlap(){return this.run.anchorInfo.allowOverlap}get isBehindDoc(){return this.run.anchorInfo.isBehindDoc}get layoutInTableCell(){return this.run.anchorInfo.layoutTableCell}get locked(){return this.run.anchorInfo.locked}get zOrder(){return this.run.anchorInfo.zOrder}get useBottomDistance(){return!0}get bottomDistance(){return this.run.anchorInfo.bottomDistance}get useLeftDistance(){return!0}get leftDistance(){return this.run.anchorInfo.leftDistance}get useRightDistance(){return!0}get rightDistance(){return this.run.anchorInfo.rightDistance}get useTopDistance(){return!0}get topDistance(){return this.run.anchorInfo.topDistance}get useHidden(){return this.run.anchorInfo.hidden}get hidden(){return this.run.anchorInfo.hidden}get horizontalPositionAlignment(){return this.run.anchorInfo.horizontalPositionAlignment}get horizontalPositionType(){return this.run.anchorInfo.horizontalPositionType}get usePercentOffset(){return this.run.anchorInfo.percentOffset.x>0||this.run.anchorInfo.percentOffset.y>0}get verticalPositionAlignment(){return this.run.anchorInfo.verticalPositionAlignment}get verticalPositionType(){return this.run.anchorInfo.verticalPositionType}get useRotation(){return!!this.run.size.rotation}get textWrapType(){return this.run.anchorInfo.wrapType}get textWrapSide(){return this.run.anchorInfo.wrapSide}get shape(){return this.run.shape}get useRelativeWidth(){return!1}get useRelativeHeight(){return!1}get relativeSize(){return new so.Size(0,0)}get relativeHeightType(){return hc.Page}get relativeWidthType(){return cc.Page}get offset(){return this.run.anchorInfo.offset}get percentOffset(){return this.run.anchorInfo.percentOffset}get hyperlinkInfo(){return null}get sourceRect(){return new XH(0,0,0,0)}get isTextBox(){return!1}}class qH extends KH{constructor(e){super(e)}}class $H extends KH{constructor(e){super(e)}get actualSize(){return new so.Size(this.run.size.absoluteSize.width,this.run.size.absoluteSize.height)}get useRelativeWidth(){return!this.run.size.useAbsoluteWidth()}get useRelativeHeight(){return!this.run.size.useAbsoluteHeight()}get relativeSize(){return this.run.size.relativeSize}get relativeHeightType(){return this.run.size.relativeHeightType}get relativeWidthType(){return this.run.size.relativeWidthType}get textBoxProperties(){return this.run.textBoxProperties}get isTextBox(){return!0}}class JH extends TH{exportImageData(e,t){const r=this.data.exportedImageTable[e];this.data.exportedImageTable[e]=!0;const i=Du.getMimeTypeFromBase64Uri(t),n=Du.convertMimeTypeToExtension(i);this.data.contentTypesExporter.registerContentType(n,i);const o=this.data.idGenerator.generateImageName(e);r||this.data.zipBuilder.addBase64(`word/media/${o}.${n}`,Du.getBase64DataWithoutPrefix(t));const a=this.data.idGenerator.generateImageRelationId(e);return this.data.relationExporter.imageRelationsTable[a]=`media/${o}.${n}`,a}exportImageUrl(e,t){const r=this.data.idGenerator.generateImageRelationId(e);return this.data.relationExporter.exportedExternalImageRelationsTable[r]=t,r}}class YH extends TH{writeFloatingObjectDrawing(e,t){this.writer.writeWpStartElement("drawing"),this.writeFloatingObjectAnchor(e,t),this.writer.endElement()}writeFloatingObjectTextBoxContent2010(e,t){this.writer.writeMcStartElement("AlternateContent"),this.writer.writeMcStartElement("Choice"),this.writer.attr("Requires",this.data.constants.namespaces[ZD.Wps].prefix),this.writer.writeWpStartElement("drawing"),this.writeFloatingObjectAnchorTextBox(e,t),this.writer.endElement(),this.writer.endElement(),this.writer.endElement()}writeFloatingObjectTxbxContent(e){this.writer.writeWpStartElement("txbxContent");this.data.createTextBoxExporter(e).exportTextBoxContent(),this.writer.endElement()}writeFloatingObjectAnchor(e,t){this.writer.writeWpDrawingStartElement(e.isFloatingObject?"anchor":"inline");const r=this.data.drawingElementId;this.data.drawingElementId++,this.exportFloatingObjectProperties(e,r),this.writeFloatingObjectPictureContent(t,e,r),e.isFloatingObject&&(this.writeFloatingObjectPercentWidth(e),this.writeFloatingObjectPercentHeight(e)),this.writer.endElement()}writeFloatingObjectAnchorTextBox(e,t){this.writer.writeWpDrawingStartElement("anchor");const r=this.data.drawingElementId;this.data.drawingElementId++,this.exportFloatingObjectProperties(e,r),this.writeFloatingObjectTextBoxContent(t,e),e.isFloatingObject&&(this.writeFloatingObjectPercentWidth(e),this.writeFloatingObjectPercentHeight(e)),this.writer.endElement()}writeFloatingObjectTextBoxContent(e,t){this.writer.writeDrawingStartElement("graphic"),this.writeFloatingTextObjectGraphicData(e,t),this.writer.endElement()}writeFloatingObjectPictureContent(e,t,r){this.writer.writeDrawingStartElement("graphic"),this.writeFloatingObjectGraphicData(e,t,r),this.writer.endElement()}writeFloatingObjectPic(e,t,r){this.writer.writePicDrawingStartElement("pic"),this.writeFloatingObjectNvPicPr(t.nonVisualDrawingObjectProperties,r),this.writeFloatingObjectBlipFill(e,t),this.writeFloatingObjectPicSpPr(t),this.writer.endElement()}writeFloatingObjectNvPicPr(e,t){this.writer.writePicDrawingStartElement("nvPicPr"),this.writeFloatingObjectCNvPr(e,t),this.writeFloatingObjectCNvPicPr(),this.writer.endElement()}writeFloatingObjectCNvPr(e,t){this.writer.writePicDrawingStartElement("cNvPr"),this.writer.writeIntValue("id",t),this.writer.attr("name",e&&!rn.StringUtils.isNullOrEmpty(e.name)?e.name:"Picture "+t),this.writer.endElement()}writeFloatingObjectCNvPicPr(){this.writer.writePicDrawingStartElement("cNvPicPr"),this.writer.endElement()}writeFloatingObjectWpsSpPr(e){this.writer.writeWpsStartElement("spPr"),this.writeFloatingObjectSpPr(e),this.writer.endElement()}writeFloatingObjectPicSpPr(e){this.writer.writePicDrawingStartElement("spPr"),this.writeFloatingObjectSpPr(e),this.writer.endElement()}writeFloatingObjectBlipFill(e,t){this.writer.writePicDrawingStartElement("blipFill"),this.writeFloatingObjectBlip(e),this.writeFloatingObjectSourceRect(t),this.writeFloatingObjectStretchAndSourceRect(t),this.writer.endElement()}writeFloatingObjectBlip(e){const t=this.data.model.cache.imageCache.getPictureData(e),r=new JH(this.data),i=t.isLoaded?r.exportImageData(e,t.base64):r.exportImageUrl(e,t.imageUrl);this.writer.writeDrawingStartElement("blip"),this.writer.attrNS(ZD.Rels,t.isLoaded?"embed":"link",i),this.writer.endElement()}writeFloatingObjectSourceRect(e){const t=e.sourceRect;t.isEmpty()||(this.writer.writeDrawingStartElement("srcRect"),this.writer.writeIntValue("l",t.left),this.writer.writeIntValue("t",t.top),this.writer.writeIntValue("r",t.right),this.writer.writeIntValue("b",t.bottom),this.writer.endElement())}writeFloatingObjectStretchAndSourceRect(e){this.writer.writeDrawingStartElement("stretch"),e.sourceRect.isEmpty()&&(this.writer.writeDrawingStartElement("fillRect"),this.writer.endElement()),this.writer.endElement()}writeFloatingObjectPrstGeom(){this.writer.writeDrawingStartElement("prstGeom"),this.writer.attr("prst","rect"),this.writer.endElement()}writeFloatingObjectSpPr(e){this.writeFloatingObjectXfrm(e),this.writeFloatingObjectPrstGeom(),e.shape&&(e.shape.fillColor&&this.writeFloatingObjectSolidFill(e.shape.fillColor),e.shape.outlineColor&&this.writeFloatingObjectLn(e.shape));const t=e instanceof GH?e:null;null!=t&&this.writeFloatingObjectSolidFill(t.fillColor)}writeFloatingObjectLn(e){this.writer.writeDrawingStartElement("ln"),e.outlineWidth&&this.writer.writeIntValue("w",g.u.twipsToEmu(e.outlineWidth)),this.writeFloatingObjectSolidFill(e.outlineColor),this.writer.endElement()}writeFloatingObjectSolidFill(e){U.isTransparentOrEmptyorNoColor(e)?(this.writer.writeDrawingStartElement("noFill"),this.writer.endElement()):(this.writer.writeDrawingStartElement("solidFill"),this.writeFloatingObjectSrgbClr(e),this.writer.endElement())}writeFloatingObjectSrgbClr(e){if(this.writer.writeDrawingStartElement("srgbClr"),this.writer.attr("val",w.i.colorToHash(e).substr(1)),255!=w.i.getAlpha(e)){this.writer.writeDrawingStartElement("alpha");const t=1e3*Math.round(w.i.getAlpha(e)/Bo.Constants.MAX_BYTE*100);this.writer.writeIntValue("val",t),this.writer.endElement()}this.writer.endElement()}writeFloatingObjectXfrm(e){this.writer.writeDrawingStartElement("xfrm"),e.shape&&e.useRotation&&this.writer.writeIntValue("rot",e.rotation),this.writeFloatingObjectOff(),this.writeFloatingObjectExt(e),this.writer.endElement()}writeFloatingObjectGraphicData(e,t,r){this.writer.writeDrawingStartElement("graphicData"),this.writer.attr("uri",this.data.constants.namespaces[ZD.DrawingMLPicture].namespace),this.writeFloatingObjectPic(e,t,r),this.writer.endElement()}writeFloatingTextObjectGraphicData(e,t){this.writer.writeDrawingStartElement("graphicData"),this.writer.attr("uri",this.data.constants.namespaces[ZD.Wps].namespace),this.writeFloatingObjectWsp(e,t),this.writer.endElement()}writeFloatingObjectWsp(e,t){this.writer.writeWpsStartElement("wsp"),this.writer.writeWpsStartElement("cNvSpPr"),this.writer.endElement(),this.writeFloatingObjectWpsSpPr(t),this.writeFloatingObjectTxbx(e),this.writeFloatingObjectBodyPr(t.textBoxProperties),this.writer.endElement()}writeFloatingObjectTxbx(e){this.writer.writeWpsStartElement("txbx"),this.writeFloatingObjectTxbxContent(e),this.writer.endElement()}writeFloatingObjectBodyPr(e){this.writer.writeWpsStartElement("bodyPr"),this.writer.attr("wrap",e.wrapText?"square":"none"),e.leftMargin>=0&&this.writer.writeIntValue("lIns",g.u.twipsToEmu(e.leftMargin)),e.topMargin>=0&&this.writer.writeIntValue("tIns",g.u.twipsToEmu(e.topMargin)),e.rightMargin>=0&&this.writer.writeIntValue("rIns",g.u.twipsToEmu(e.rightMargin)),e.bottomMargin>=0&&this.writer.writeIntValue("bIns",g.u.twipsToEmu(e.bottomMargin)),null!=e.verticalAlignment&&this.writer.attr("anchor",this.convertTextBoxVerticalAlignment(e.verticalAlignment)),e.upright&&this.writer.writeBoolValue("upright",e.upright),null!=e.resizeShapeToFitText&&(e.resizeShapeToFitText?this.writer.writeDrawingStartElement("spAutoFit"):this.writer.writeDrawingStartElement("noAutofit"),this.writer.endElement()),this.writer.endElement()}convertTextBoxVerticalAlignment(e){return wH.getValueFromTables(NR.drawingTextAnchoringType,e,Sc.Top)}writeFloatingObjectOff(){this.writer.writeDrawingStartElement("off"),this.writer.writeIntValue("x",0),this.writer.writeIntValue("y",0),this.writer.endElement()}writeFloatingObjectExt(e){this.writer.writeDrawingStartElement("ext"),this.writer.writeIntValue("cx",g.u.twipsToEmu(Math.max(0,e.actualSize.width))),this.writer.writeIntValue("cy",g.u.twipsToEmu(Math.max(0,e.actualSize.height))),this.writer.endElement()}writeFloatingObjectPercentWidth(e){e.useRelativeWidth&&(this.writer.writeWp14DrawingStartElement("sizeRelH"),this.writer.attr("relativeFrom",wH.getValueFromTables(NR.floatingObjectRelativeFromHorizontalTable,e.relativeWidthType,cc.Page)),this.writer.writeWp14DrawingStartElement("pctWidth"),this.writer.writeString(e.relativeSize.width.toString()),this.writer.endElement(),this.writer.endElement())}writeFloatingObjectPercentHeight(e){e.useRelativeHeight&&(this.writer.writeWp14DrawingStartElement("sizeRelV"),this.writer.attr("relativeFrom",wH.getValueFromTables(NR.floatingObjectRelativeFromVerticalTable,e.relativeHeightType,hc.Page)),this.writer.writeWp14DrawingStartElement("pctHeight"),this.writer.writeString(e.relativeSize.height.toString()),this.writer.endElement(),this.writer.endElement())}exportFloatingObjectProperties(e,t){e.isFloatingObject&&(this.writer.writeIntValue("simplePos",0),this.writer.writeBoolValue("allowOverlap",e.allowOverlap),this.writer.writeBoolValue("behindDoc",e.isBehindDoc),this.writer.writeBoolValue("layoutInCell",e.layoutInTableCell),this.writer.writeBoolValue("locked",e.locked),this.writer.writeIntValue("relativeHeight",Math.max(0,e.zOrder)),e.useBottomDistance&&e.bottomDistance>=0&&this.writer.writeIntValue("distB",g.u.twipsToEmu(e.bottomDistance)),e.useLeftDistance&&e.leftDistance>=0&&this.writer.writeIntValue("distL",g.u.twipsToEmu(e.leftDistance)),e.useRightDistance&&e.rightDistance>=0&&this.writer.writeIntValue("distR",g.u.twipsToEmu(e.rightDistance)),e.useTopDistance&&e.topDistance>=0&&this.writer.writeIntValue("distT",g.u.twipsToEmu(e.topDistance)),e.useHidden&&this.writer.writeBoolValue("hidden",e.hidden),this.writeFloatingObjectSimplePosition(),e.horizontalPositionAlignment==mc.None&&e.usePercentOffset&&0!=e.percentOffset.x?this.writeFloatingObjectPercentPositionH2010(e):this.writeFloatingObjectPositionH(e),e.verticalPositionAlignment==bc.None&&e.usePercentOffset&&0!=e.percentOffset.y?this.writeFloatingObjectPercentPositionV2010(e):this.writeFloatingObjectPositionV(e)),this.writeFloatingObjectExtent(e),this.writeFloatingObjectEffectExtent(e),e.isFloatingObject&&this.writeFloatingObjectWrap(e),this.writeFloatingObjectDocPr(e,t),this.writeFloatingObjectCNvGraphicFramePr(e)}writeFloatingObjectPositionV(e){this.writeFloatingObjectPositionVCore(e,this.writeFloatingObjectVerticalOffset)}writeFloatingObjectPositionVCore(e,t){this.writer.writeWpDrawingStartElement("positionV"),this.writer.attr("relativeFrom",wH.getValueFromTables(NR.floatingObjectVerticalPositionTypeTable,e.verticalPositionType,fc.Page)),e.verticalPositionAlignment!=bc.None?this.writeFloatingObjectVerticalPositionAlignment(e):t.call(this,e),this.writer.endElement()}writeFloatingObjectVerticalOffset(e){this.writer.writeWpDrawingStartElement("posOffset"),this.writer.writeString(g.u.twipsToEmu(e.offset.y).toString()),this.writer.endElement()}writeFloatingObjectVerticalPositionAlignment(e){this.writer.writeWpDrawingStartElement("align"),this.writer.writeString(wH.getValueFromTablesExplicitDefault(NR.floatingObjectVerticalPositionAlignmentTable,e.verticalPositionAlignment,"")),this.writer.endElement()}writeFloatingObjectPercentPositionH2010(e){this.writer.writeMcStartElement("AlternateContent"),this.writer.writeMcStartElement("Choice"),this.writer.attr("Requires",this.data.constants.namespaces[ZD.Wp14].prefix),this.writeFloatingObjectPositionHCore(e,this.writeFloatingObjectPercentHorizontalOffset),this.writer.endElement(),this.writer.writeMcStartElement("Fallback"),this.writeFloatingObjectPositionH(e),this.writer.endElement(),this.writer.endElement()}writeFloatingObjectPercentPositionV2010(e){this.writer.writeMcStartElement("AlternateContent"),this.writer.writeMcStartElement("Choice"),this.writer.attr("Requires",this.data.constants.namespaces[ZD.Wp14].prefix),this.writeFloatingObjectPositionVCore(e,this.writeFloatingObjectPercentVerticalOffset),this.writer.endElement(),this.writer.writeMcStartElement("Fallback"),this.writeFloatingObjectPositionV(e),this.writer.endElement(),this.writer.endElement()}writeFloatingObjectPercentVerticalOffset(e){this.writer.writeWp14DrawingStartElement("pctPosVOffset"),this.writer.writeString(e.percentOffset.y.toString()),this.writer.endElement()}writeFloatingObjectPercentHorizontalOffset(e){this.writer.writeWp14DrawingStartElement("pctPosHOffset"),this.writer.writeString(e.percentOffset.x.toString()),this.writer.endElement()}writeFloatingObjectPositionH(e){this.writeFloatingObjectPositionHCore(e,this.writeFloatingObjectHorizontalOffset)}writeFloatingObjectPositionHCore(e,t){this.writer.writeWpDrawingStartElement("positionH"),this.writer.attr("relativeFrom",wH.getValueFromTables(NR.floatingObjectHorizontalPositionTypeTable,e.horizontalPositionType,gc.Page)),e.horizontalPositionAlignment!=mc.None?this.writeFloatingObjectHorizontalPositionAlignment(e):t.call(this,e),this.writer.endElement()}writeFloatingObjectHorizontalOffset(e){this.writer.writeWpDrawingStartElement("posOffset"),this.writer.writeString(g.u.twipsToEmu(e.offset.x).toString()),this.writer.endElement()}writeFloatingObjectHorizontalPositionAlignment(e){this.writer.writeWpDrawingStartElement("align"),this.writer.writeString(wH.getValueFromTablesExplicitDefault(NR.floatingObjectHorizontalPositionAlignmentTable,e.horizontalPositionAlignment,"")),this.writer.endElement()}writeFloatingObjectSimplePosition(){this.writer.writeWpDrawingStartElement("simplePos"),this.writer.writeIntValue("x",0),this.writer.writeIntValue("y",0),this.writer.endElement()}writeFloatingObjectExtent(e){this.writer.writeWpDrawingStartElement("extent"),this.writer.writeIntValue("cx",g.u.twipsToEmu(Math.max(0,e.actualSize.width))),this.writer.writeIntValue("cy",g.u.twipsToEmu(Math.max(e.actualSize.height,0))),this.writer.endElement()}writeFloatingObjectEffectExtent(e){if(!e.useRotation)return;this.writer.writeWpDrawingStartElement("effectExtent");const t=new QH(g.u.twipsToEmu(e.actualSize.width),g.u.twipsToEmu(e.actualSize.height),e.rotation);t.calculate(),this.writer.writeIntValue("l",t.horizontalIndent),this.writer.writeIntValue("t",t.verticalIndent),this.writer.writeIntValue("r",t.horizontalIndent),this.writer.writeIntValue("b",t.verticalIndent),this.writer.endElement()}writeFloatingObjectWrap(e){const t=NR.floatingObjectTextWrapTypeTable.exportMap[e.textWrapType];void 0!==t&&this.writeWpDrawingElement(e,t.mlValue.openXmlValue,I.Y.isAnyOf(e.textWrapType,uc.Square,uc.Through,uc.Tight))}writeWpDrawingElement(e,t,r){this.writer.writeWpDrawingStartElement(t),r&&this.writer.attr("wrapText",wH.getValueFromTables(NR.floatingObjectTextWrapSideTable,e.textWrapSide,pc.Both)),this.writeWpWrapPolygonElement(e),this.writer.endElement()}writeWpWrapPolygonElement(e){e.textWrapType!=uc.Through&&e.textWrapType!=uc.Tight||(this.writer.writeWpDrawingStartElement("wrapPolygon"),this.writeWpDrawingStart(),this.writeWpLineToDrawingElement(0,21600),this.writeWpLineToDrawingElement(21600,21600),this.writeWpLineToDrawingElement(21600,0),this.writeWpLineToDrawingElement(0,0),this.writer.endElement())}writeWpDrawingStart(){this.writer.writeWpDrawingStartElement("start"),this.writer.writeIntValue("x",0),this.writer.writeIntValue("y",0),this.writer.endElement()}writeWpLineToDrawingElement(e,t){this.writer.writeWpDrawingStartElement("lineTo"),this.writer.writeIntValue("x",e),this.writer.writeIntValue("y",t),this.writer.endElement()}writeFloatingObjectCNvGraphicFramePr(e){this.writer.writeWpDrawingStartElement("cNvGraphicFramePr"),this.writeFloatingObjectGraphicFrameLocks(e),this.writer.endElement()}writeFloatingObjectGraphicFrameLocks(e){this.writer.writeDrawingStartElement("graphicFrameLocks"),e.lockAspectRatio&&this.writer.writeBoolValue("noChangeAspect",e.lockAspectRatio),this.writer.endElement()}writeFloatingObjectDocPr(e,t){this.writeElementDocPrCore(e,t)}writeElementDocPrCore(e,t){const r=rn.StringUtils.isNullOrEmpty(e.containerProperties.name)?e.isTextBox?`Text Box ${t.toString()}`:`Picture ${t.toString()}`:e.containerProperties.name,i=e.hyperlinkInfo;this.writer.writeWpDrawingStartElement("docPr"),this.writer.writeIntValue("id",t),rn.StringUtils.isNullOrEmpty(r)||this.writer.attr("name",r),rn.StringUtils.isNullOrEmpty(e.containerProperties.description)||this.writer.attr("descr",e.containerProperties.description),rn.StringUtils.isNullOrEmpty(e.containerProperties.title)||this.writer.attr("title",e.containerProperties.title),null!=i&&this.writeHyperlinkClick(i),this.writer.endElement()}writeHyperlinkClick(e){this.writer.writeDrawingStartElement("hlinkClick");let t=e.uri;if(rn.StringUtils.isNullOrEmpty(e.anchor)||(t+="#"+e.anchor),!rn.StringUtils.isNullOrEmpty(t)){const e=this.data.idGenerator.calcDocumentRelationId();this.data.subDocumentExporter.hyperlinkRelationsTable[e]=t,this.writer.attrNS(ZD.Rels,"id",e)}rn.StringUtils.isNullOrEmpty(e.anchor)||this.writer.attr("tgtFrame",e.anchor),rn.StringUtils.isNullOrEmpty(e.tip)||this.writer.attr("tooltip",e.tip),this.writer.endElement()}}class QH{constructor(e,t,r){this.width=e,this.height=t,this.rotation=r}calculate(){const e=g.u.twipsToDegree(this.rotation)*Math.PI/180,t=Math.floor(this.width/2),r=Math.floor(this.height/2),i=Math.floor(t*Math.cos(e)-r*Math.sin(e)),n=Math.floor(t*Math.sin(e)+r*Math.cos(e)),o=t,a=-r,s=Math.floor(o*Math.cos(e)-a*Math.sin(e)),l=Math.floor(o*Math.sin(e)+a*Math.cos(e));Math.abs(i)>Math.abs(s)?(this.horizontalIndent=Math.abs(Math.abs(i)-Math.abs(t)),this.verticalIndent=Math.abs(Math.abs(l)-Math.abs(a))):(this.horizontalIndent=Math.abs(Math.abs(s)-Math.abs(o)),this.verticalIndent=Math.abs(Math.abs(n)-Math.abs(r))),(g.u.twipsToDegree(this.rotation)-90)%180==0&&(this.horizontalIndent=0)}}class ZH extends TH{constructor(){super(...arguments),this.tableIndexes=[],this.tableInfo=[],this.initTableDeferred=!1}get tables(){return this.data.subDocumentExporter.subDocument.tables}init(){this.tableIterator=new IP(this.tables),this.tableIterator.init(0)}checkTable(e,t){const r=this.tableIterator.indexes;if(r.length){const t=this.tableIterator.generateInfo(e);this.handleNextCell(this.tableInfo?f.ListUtils.last(this.tableInfo):null,f.ListUtils.last(t)),this.tableInfo=t}(this.initTableDeferred||this.tableIterator.update(e)||0==e&&this.tableIterator.indexes.length)&&(this.initTableDeferred=!1,this.closeTables(r),this.initNewTables(r,t),t&&(this.tableInfo=this.tableIterator.generateInfo(e)))}getTableGrid(e){if(e.rows[0].logicColumnCount<64)return[];return[]}initNewTables(e,t){for(let r=this.tableIndexes.length;r<e.length;r++){if(!t){this.initTableDeferred=!0;break}{const t=this.tables[e[r]];this.tableIndexes.push(t.index),this.startTable(t),this.startRow(t.rows[0]),this.startCell(t.rows[0].cells[0])}}}closeTables(e){let t=0;const r=this.tableIndexes.length;for(let i=0;i<r;i++){const r=e[i];if(void 0===r||this.tableIndexes[i]!=r)break;t++}for(let e=this.tableIndexes.length-t;e>0;e--)this.tableIndexes.pop(),this.tableInfo.pop(),this.writer.endElement(),this.writer.endElement(),this.writer.endElement()}handleNextCell(e,t){e&&t&&(e.rowIndex!=t.rowIndex?(this.writer.endElement(),this.writer.endElement(),this.startRow(t.row),this.startCell(t.cell)):e.cellIndex!=t.cellIndex&&(this.writer.endElement(),this.startCell(t.cell)))}startTable(e){this.writer.writeWpStartElement("tbl"),this.exportTableProperties(e),this.exportTableGrid(e)}startRow(e){this.writer.writeWpStartElement("tr"),this.data.tablePropsExporter.exportTablePropertiesException(e.tablePropertiesException),(e.properties.mask!=Ua.UseNone||e.gridBefore||e.gridAfter||e.gridBefore||0!=e.height.value)&&new kH(this.data).exportTableRowProperties(e)}startCell(e){this.writer.writeWpStartElement("tc"),this.allowExportTableCellProperties(e)&&new _H(this.data).exportTableCellProperties(e)}exportTableProperties(e){this.writer.writeWpStartElement("tblPr"),e.style&&this.writer.writeWpStringValue("tblStyle",this.data.tblStyleExporter.getStyleId(this.data.tblStyleExporter.getStyleIndexByName(e.style.styleName))),this.data.tablePropsExporter.exportTablePropertiesCore(e,!0),this.writer.endElement()}exportTableGrid(e){this.writer.writeWpStartElement("tblGrid");for(const t of this.getTableGrid(e))this.writer.writeWpStartElement("gridCol"),this.writer.writeWpIntAttr("w",Math.max(1,t)),this.writer.endElement();this.writer.endElement()}allowExportTableCellProperties(e){const t=e.properties;return!this.data.tableWidthExporter.forbidExportWidthUnit(e.preferredWidth)||e.verticalMerging!=Xe.None||t.mask!=Ye.UseNone||e.columnSpan>1||e.verticalMerging!=Xe.None}}class eV extends vH{get filePath(){return this._filePath}get rootNSPrefix(){return this.data.constants.namespaces[ZD.WordProcessing].prefix}get rootNSValue(){return this.data.constants.namespaces[ZD.WordProcessing].namespace}constructor(e,t){super(e),this.fieldCodeDepth=0,this.paragraph=null,this.firstIteration=!0,this.predefinedGroupNames=(new Eu).add("Everyone","everyone").add("Current User","current").add("Editors","editors").add("Owners","owners").add("Contributors","contributors").add("Administrators","administrators").get(),this._filePath=t,this.hyperlinkRelationsTable={},this.fieldsStack=new Rw.K,this.runHandlerMap={[cs.TextRun]:this.textRunHandler,[cs.ParagraphRun]:this.paragraphRunHandler,[cs.SectionRun]:this.sectionRunHandler,[cs.FieldCodeStartRun]:this.fieldCodeStartRunHandler,[cs.FieldCodeEndRun]:this.fieldCodeEndRunHandler,[cs.FieldResultEndRun]:this.fieldResultEndRunHandler,[cs.AnchoredPictureRun]:this.anchoredPictureRunHandler,[cs.AnchoredTextBoxRun]:this.anchoredTextRunHandler,[cs.InlinePictureRun]:this.inlinePictureRunHandler,[cs.InlineTextBoxRun]:null,[cs.LayoutDependentRun]:this.layoutDependentRunHandler,[cs.FootNoteRun]:this.footNoteRunHandler,[cs.EndNoteRun]:this.endNoteRunHandler,[cs.NoteSeparatorRun]:this.noteSeparatorRunHandler,[cs.NoteContinuationSeparatorRun]:this.noteContinuationSeparatorRun},this.tableExporter=new ZH(this.data)}fillWriter(){this.data.subDocumentExporterStack.push(this),this.registerNamespaces(),this.data.pushRelationExporter(this.createRelationExporter()),this.fillWriterCore(),this.isMainContent()||this.data.popRelationExporter(),this.data.subDocumentExporterStack.pop()}init(){this.modelIterator=new jh(this.subDocument,!1),this.modelIterator.setPosition(0),this.tableExporter.init(),this.bookmarksIterator=new mP(this.subDocument.bookmarks),this.bookmarksIterator.init(),this.rangePermisiionsIterator=new mP(this.subDocument.rangePermissions),this.rangePermisiionsIterator.init()}endParagraph(e,t,r){this.paragraph&&this.writer.endElement(),this.tableExporter.checkTable(e,r),r&&(this.paragraph=this.modelIterator.run.paragraph,this.writer.writeWpStartElement("p"),this.data.parPropsExporter.exportParagraphProperties(this.subDocument,t,this.paragraph,this.getCurrentParagraphRun()))}getCurrentParagraphRun(){return this.modelIterator.run?this.modelIterator.run.isParagraphOrSectionRun()?this.run:this.subDocument.getRunByPosition(this.run.paragraph.interval.end-1):null}exportSection(e,t){const r=t.end;for(;this.firstIteration||this.modelIterator.moveToNextChar();this.firstIteration=!1){this.run!=this.modelIterator.run&&(this.run=this.modelIterator.run,this.runText=this.modelIterator.getRunText(),this.runStartCharOffset=0);const t=this.modelIterator.getAbsolutePosition();if(!this.paragraph||t>=this.paragraph.getEndPosition()){if(t==r)break;this.endParagraph(t,e,!0)}this.bookmarksIterator.update(t)&&(this.exportRun(new Cn.e(this.runStartCharOffset,this.modelIterator.charOffset)),this.exportBookmark(this.bookmarksIterator)),this.rangePermisiionsIterator.update(t)&&(this.exportRun(new Cn.e(this.runStartCharOffset,this.modelIterator.charOffset)),this.exportRangePermission(this.rangePermisiionsIterator)),this.modelIterator.charOffset+1==this.run.getLength()&&this.exportRun(new Cn.e(this.runStartCharOffset,this.run.getLength()))}this.bookmarksIterator.update(r)&&this.exportBookmark(this.bookmarksIterator),this.rangePermisiionsIterator.update(r)&&this.exportRangePermission(this.rangePermisiionsIterator),this.endParagraph(r,e,!1),this.paragraph=null,this.firstIteration=!0}registerNamespaces(){this.ignorableNamespaces=[],this.registerDefaultNamespaces(),this.registerIgnorableNamespaces()}registerDefaultNamespaces(){this.registerNamespace(ZD.WordProcessing,!1),this.registerNamespace(ZD.Wps,!1),this.registerNamespace(ZD.MC,!1),this.registerNamespace(ZD.W10ML,!1),this.registerNamespace(ZD.VML,!1),this.registerNamespace(ZD.Wpg,!1),this.registerNamespace(ZD.Wpc,!1),this.registerNamespace(ZD.Rels,!1),this.registerNamespace(ZD.DrawingML,!1),this.registerNamespace(ZD.DrawingMLPicture,!1),this.registerNamespace(ZD.WordProcessingDrawing,!1),this.registerNamespace(ZD.WordProcessingDrawing14,!0)}registerNamespace(e,t){this.writer.addNamespaceToRootElement(e),t&&this.ignorableNamespaces.push(this.data.constants.namespaces[e].prefix)}registerIgnorableNamespaces(){this.ignorableNamespaces.length&&this.writer.attrNS(ZD.MC,"Ignorable",f.ListUtils.unique(this.ignorableNamespaces,Qe.Comparers.string,((e,t)=>e==t?0:1)).join(" ")),this.ignorableNamespaces=[]}exportRun(e){if(e.length){const t=this.runHandlerMap[this.run.getType()];t&&(this.absRunStartPosition=this.modelIterator.getAbsoluteRunPosition(),t.call(this,this.runText.substring(e.start,e.end)))}this.runStartCharOffset=e.end}textRunHandler(e){this.writer.writeWpStartElement("r"),this.data.charPropsExporter.exportRunProperties(this.run),this.tryExportNoteCustomMarkReference(),this.data.textExporter.exportTextRunCore(e),this.writer.endElement()}paragraphRunHandler(){}sectionRunHandler(){}fieldCodeStartRunHandler(){this.fieldsStack.push(this.subDocument.fields[Md.binaryIndexOf(this.subDocument.fields,this.absRunStartPosition+1)]),this.exportFieldChar("begin",!0),this.fieldCodeDepth++}fieldCodeEndRunHandler(){this.exportFieldChar("separate",!1),this.fieldCodeDepth--}fieldResultEndRunHandler(){this.exportFieldChar("end",!1),this.fieldsStack.pop()}shouldExportPicture(e){return e.isLoaded||e.imageUrl}anchoredPictureRunHandler(){this.writer.writeWpStartElement("r"),this.data.charPropsExporter.exportRunProperties(this.run),this.tryExportNoteCustomMarkReference();const e=this.run;this.shouldExportPicture(e.cacheInfo)&&new YH(this.data).writeFloatingObjectDrawing(new qH(e),e.cacheInfo.currId),this.writer.endElement()}anchoredTextRunHandler(){this.writer.writeWpStartElement("r"),this.data.charPropsExporter.exportRunProperties(this.run),this.tryExportNoteCustomMarkReference();const e=this.run;new YH(this.data).writeFloatingObjectTextBoxContent2010(new $H(e),this.data.model.subDocuments[e.subDocId]),this.writer.endElement()}inlinePictureRunHandler(){this.writer.writeWpStartElement("r"),this.data.charPropsExporter.exportRunProperties(this.run),this.tryExportNoteCustomMarkReference();const e=this.run;this.shouldExportPicture(e.cacheInfo)&&new YH(this.data).writeFloatingObjectDrawing(new GH(e),e.cacheInfo.currId),this.writer.endElement()}layoutDependentRunHandler(){}footNoteRunHandler(){this.writer.writeWpStartElement("r"),this.data.charPropsExporter.exportRunProperties(this.run);const e=this.run.noteDocumentId;(0,S.isDefined)(e)&&e>uu.MAIN_SUBDOCUMENT_ID?this.exportFootNoteReference(e,!1):(this.writer.writeWpStartElement("footnoteRef"),this.writer.endElement()),this.writer.endElement()}exportFootNoteReference(e,t){const r=this.data.model.subDocuments[e],i=this.data.addFootNote(r);this.exportNoteReference("footnoteReference",i,t)}endNoteRunHandler(){this.writer.writeWpStartElement("r"),this.data.charPropsExporter.exportRunProperties(this.run);const e=this.run.noteDocumentId;(0,S.isDefined)(e)&&e>uu.MAIN_SUBDOCUMENT_ID?this.exportEndNoteReference(e,!1):(this.writer.writeWpStartElement("endnoteRef"),this.writer.endElement()),this.writer.endElement()}exportEndNoteReference(e,t){const r=this.data.model.subDocuments[e],i=this.data.addEndNote(r);this.exportNoteReference("endnoteReference",i,t)}tryExportNoteCustomMarkReference(){const e=this.run.noteDocumentId;if(!(0,S.isDefined)(e))return;this.data.model.subDocuments[e].isFootNote()?this.exportFootNoteReference(e,!0):this.exportEndNoteReference(e,!0)}exportNoteReference(e,t,r){this.writer.writeWpStartElement(e),r&&this.writer.writeWpBoolAttr("customMarkFollows",!0),this.writer.writeWpIntAttr("id",t),this.writer.endElement()}noteSeparatorRunHandler(){this.exportNoteSeparator("separator")}noteContinuationSeparatorRun(){this.exportNoteSeparator("continuationSeparator")}exportNoteSeparator(e){this.writer.writeWpStartElement("r"),this.data.charPropsExporter.exportRunProperties(this.run),this.writer.writeWpStartElement(e),this.writer.endElement(),this.writer.endElement()}exportBookmark(e){for(const t of e.addedObjects)this.writer.writeWpStartElement("bookmarkStart"),this.writer.writeWpIntAttr("id",t.index),this.writer.writeWpStringAttr("name",t.object.name),this.writer.endElement();for(const t of e.deletedObjects)this.writer.writeWpStartElement("bookmarkEnd"),this.writer.writeWpIntAttr("id",t.index),this.writer.endElement()}exportRangePermission(e){for(const t of e.addedObjects)this.writer.writeWpStartElement("permStart"),this.writer.writeWpIntAttr("id",t.index),rn.StringUtils.isNullOrEmpty(t.object.userName)||this.writer.writeWpStringAttr("ed",t.object.userName),rn.StringUtils.isNullOrEmpty(t.object.group)||this.writer.writeWpStringAttr("edGrp",this.getGroupName(t.object.group)),this.writer.endElement();for(const t of e.deletedObjects)this.writer.writeWpStartElement("permEnd"),this.writer.writeWpIntAttr("id",t.index),this.writer.endElement()}getGroupName(e){const t=this.predefinedGroupNames[e];return t||e}exportFieldChar(e,t){this.writer.writeWpStartElement("r"),this.data.charPropsExporter.exportRunProperties(this.run),this.writer.writeWpStartElement("fldChar"),this.writer.writeWpStringAttr("fldCharType",e);const r=this.fieldsStack.last;t&&r.disableUpdate&&this.writer.writeWpBoolAttr("disableUpdate",!0),t&&r.locked&&this.writer.writeWpBoolAttr("fldLock",!0),t&&r.hideByParent&&this.writeHideByParent(),this.writer.endElement(),this.writer.endElement()}writeHideByParent(){}}class tV extends eV{constructor(e,t,r){super(e,r),this.subDocument=t}isMainContent(){return this.subDocument.isMain()}}class rV extends tV{get rootElement(){throw new Error(R.D.NotImplemented)}constructor(e,t){super(e,t,"")}exportTextBoxContent(){this.data.subDocumentExporterStack.push(this),this.fillWriterCore(),this.data.subDocumentExporterStack.pop()}createRelationExporter(){throw new Error(R.D.NotImplemented)}fillWriter(){throw new Error(R.D.NotImplemented)}fillWriterCore(){this.init(),this.exportSection(this.data.model.sections[0],new on.FixedInterval(0,this.subDocument.getDocumentEndPosition()))}}class iV{constructor(){this.id=0,this.documentRelationId=this.calcDocumentRelationId()}generateImageName(e){return"image"+e.toString()}generateImageRelationId(e){return"Image"+e.toString()}calcDocumentRelationId(){return`R${this.next().toString(16)}`}calcCorePropertiesDocumentRelationId(){return"core"+this.documentRelationId}calcCustomPropertiesDocumentRelationId(){return"custom"+this.documentRelationId}next(){return this.id++}}class nV{get writer(){return this.writerStack.last}set writer(e){this.writerStack.push(e)}get subDocumentExporter(){return this.subDocumentExporterStack.last}get relationExporter(){return f.ListUtils.last(this.relationExporters)}get mainSubDocumentRelations(){return this.relationExporters[0]}constructor(e,t){this.drawingElementId=1,this.exportSubDocumentsList=[],this.relationExporters=[],this.model=e,this.options=t,this.constants=new sF,this.writerStack=new Rw.K,this.zipBuilder=new PH,this.writerHelper=new wH,this.idGenerator=new iV,this.subDocumentExporterStack=new Rw.K,this.relationExporters=[],this.tableWidthExporter=new HH(this),this.charPropsExporter=new MH(this),this.parPropsExporter=new RH(this),this.tablePropsExporter=new OH(this),this.colorExporter=new EH(this),this.parStyleExporter=new NH(this),this.charStyleExporter=new BH(this),this.tblStyleExporter=new UH(this),this.numberingStyleExporter=new AH(this),this.textExporter=new VH(this),this.styleExporter=new jH(this),this.contentTypesExporter=new zH(this),this.exportedImageTable={},this.footNotes=new Map,this.endNotes=new Map}popWriter(){this.writerStack.pop()}pushRelationExporter(e){this.relationExporters.push(e)}popRelationExporter(){this.relationExporters.pop().export()}createTextBoxExporter(e){return new rV(this,e)}init(){this.headerCounter=0,this.footerCounter=0}addFootNote(e){const t=this.footNotes.size-1;return this.footNotes.set(e,t),t}addEndNote(e){const t=this.endNotes.size-1;return this.endNotes.set(e,t),t}}class oV extends vH{get filePath(){return"docProps/core.xml"}get rootElement(){return"coreProperties"}get rootNSPrefix(){return this.data.constants.namespaces[ZD.CP].prefix}get rootNSValue(){return this.data.constants.namespaces[ZD.CP].namespace}fillWriter(){this.registerNamespaces(),this.writer.writeDCEmptyElement("title"),this.writer.writeDCEmptyElement("subject"),this.writer.writeDCEmptyElement("creator"),this.writer.writeCPEmptyElement("keywords"),this.writer.writeDCEmptyElement("description"),this.writer.writeCPEmptyElement("lastModifiedBy"),this.writer.elementStartNS(ZD.CP,"revision"),this.writer.writeString("1"),this.writer.endElement();const e=this.getDateTime();this.writer.elementStartNS(ZD.DcTerms,"created"),this.writer.attrNS(ZD.Xsi,"type","dcterms:W3CDTF"),this.writer.writeString(e),this.writer.endElement(),this.writer.elementStartNS(ZD.DcTerms,"modified"),this.writer.attrNS(ZD.Xsi,"type","dcterms:W3CDTF"),this.writer.writeString(e),this.writer.endElement()}registerNamespaces(){this.writer.addNamespaceToRootElement(ZD.DC),this.writer.addNamespaceToRootElement(ZD.DcTerms),this.writer.addNamespaceToRootElement(ZD.DcmiType),this.writer.addNamespaceToRootElement(ZD.Xsi)}getDateTime(){const e=new Date;return e.getFullYear()+"-"+this.getLastTwoSlice(e.getMonth()+1)+"-"+this.getLastTwoSlice(e.getDate())+("T"+this.getLastTwoSlice(e.getHours())+":"+this.getLastTwoSlice(e.getMinutes())+":"+this.getLastTwoSlice(e.getSeconds())+"Z")}getLastTwoSlice(e){return("0"+e).slice(-2)}}class aV extends vH{constructor(){super(...arguments),this.numRels=0}get rootNSPrefix(){return""}get rootNSValue(){return this.data.constants.rels.packageRelsNamespace}get rootElement(){return"Relationships"}addRel(e,t,r,i=!1){this.writer.elementStart("Relationship"),this.writer.attr("Id",e),this.writer.attr("Type",t),this.writer.attr("Target",rn.StringUtils.isNullOrEmpty(r)?r:this.urlEncodeAsciiSpecialSymbols(r)),i&&this.writer.attr("TargetMode","External"),this.writer.endElement(),this.numRels++}urlEncodeAsciiSpecialSymbols(e){return e&&(e.indexOf(" ")>=0&&(e=e.replace(" ","%20")),e.indexOf("'")>=0&&(e=e.replace("'","%27"))),e}}class sV extends aV{get filePath(){return"_rels/.rels"}fillWriter(){this.addRel(this.data.idGenerator.documentRelationId,this.data.constants.rels.officeDocumentType,"word/document.xml"),this.addRel(this.data.idGenerator.calcCorePropertiesDocumentRelationId(),this.data.constants.rels.corePropertiesNamespace,"docProps/core.xml")}}class lV extends vH{get filePath(){return"word/settings.xml"}get rootElement(){return new AR("settings","docPr").openXmlValue}get rootNSPrefix(){return this.data.constants.namespaces[ZD.WordProcessing].prefix}get rootNSValue(){return this.data.constants.namespaces[ZD.WordProcessing].namespace}fillWriter(){const e=this.data.model.mirrorMargins;e&&this.writer.writeWpBoolValueAsTag("mirrorMargins",e),this.writer.writeWpBoolValue("displayBackgroundShape",this.data.model.displayBackgroundShape),this.exportDocumentProtectionSettings(),this.writer.writeWpIntValue("defaultTabStop",this.data.model.defaultTabWidth),this.writer.writeWpBoolValue("autoHyphenation",!1),this.writer.writeWpBoolValue("evenAndOddHeaders",this.data.model.differentOddAndEvenPages),this.exportFootNoteProperties(),this.exportEndNoteProperties(),this.exportCompatSettings(),this.exportDocumentVariables(),this.exportColorSchemeMapping()}exportColorSchemeMapping(){const e=bo.schemeColorValuesToThemeColorIndexTranslationTable;this.writer.writeWpStartElement("clrSchemeMapping"),this.exportColorSchemeMappingElement(e,yn.Background1,"bg1"),this.exportColorSchemeMappingElement(e,yn.Text1,"t1"),this.exportColorSchemeMappingElement(e,yn.Background2,"bg2"),this.exportColorSchemeMappingElement(e,yn.Text2,"t2"),this.exportColorSchemeMappingElement(e,yn.Accent1,"accent1"),this.exportColorSchemeMappingElement(e,yn.Accent2,"accent2"),this.exportColorSchemeMappingElement(e,yn.Accent3,"accent3"),this.exportColorSchemeMappingElement(e,yn.Accent4,"accent4"),this.exportColorSchemeMappingElement(e,yn.Accent5,"accent5"),this.exportColorSchemeMappingElement(e,yn.Accent6,"accent6"),this.exportColorSchemeMappingElement(e,yn.Hyperlink,"hyperlink"),this.exportColorSchemeMappingElement(e,yn.FollowedHyperlink,"followedHyperlink"),this.writer.endElement()}exportCompatSettings(){this.writer.writeWpStartElement("compat"),this.exportCompatSetting("compatibilityMode",this.data.model.compatibilitySettings.compatibilityMode.toString(),sF.wordNamespace),f.ListUtils.forEach(this.data.model.compatSettings.filter((e=>"compatibilityMode"!==e.name)),(e=>{this.exportCompatSetting(e.name,e.value,e.uri)})),this.writer.endElement()}exportCompatSetting(e,t,r){this.writer.writeWpStartElement("compatSetting"),this.writer.writeWpStringAttr("name",e),this.writer.writeWpStringAttr("uri",r),this.writer.writeWpStringAttr("val",t),this.writer.endElement()}exportDocumentVariables(){this.writer.writeWpStartElement("docVars"),this.data.model.docVariables.foreach(((e,t)=>{(0,S.isDefined)(t)&&"object"!=typeof t&&(t=String(t),rn.StringUtils.isNullOrEmpty(t)||(this.writer.writeWpStartElement("docVar"),this.writer.writeWpStringAttr("name",e),this.writer.writeWpStringAttr("val",t),this.writer.endElement()))})),this.writer.endElement()}exportColorSchemeMappingElement(e,t,r){const i=e[t];if(void 0!==i&&i!=ce.None){const e=NR.simpleThemeColorIndexTable[i];void 0!==e&&this.writer.writeWpStringAttr(r,e)}}exportDocumentProtectionSettings(){const e=this.data.model.documentProtectionProperties;e.enforceProtection&&(this.writer.writeWpStartElement("documentProtection"),this.exportDocumentProtectionType(e.protectionType),this.writer.writeWpBoolAttr("enforcement",e.enforceProtection),this.exportDocumentProtectionSettingsCore(e),this.writer.endElement())}exportDocumentProtectionType(e){e==Mo.ReadOnly&&this.writer.writeWpStringAttr("edit","readOnly"),e==Mo.AllowComments&&this.writer.writeWpStringAttr("edit","comments"),e==Mo.TrackedChanges&&this.writer.writeWpStringAttr("edit","trackedChanges")}exportDocumentProtectionSettingsCore(e){!e.passwordHash||e.passwordHash.length<=0||(this.writer.writeWpStringAttr("cryptProviderType",e.cryptProviderType==Ro.RsaAES?"rsaAES":"rsaFull"),this.writer.writeWpStringAttr("cryptAlgorithmClass","hash"),this.writer.writeWpStringAttr("cryptAlgorithmType","typeAny"),this.writer.writeWpIntAttr("cryptAlgorithmSid",e.hashAlgorithmType),this.writer.writeWpStringAttr("cryptSpinCount",Math.max(1,e.hashIterationCount).toString()),e.passwordHash&&this.writer.writeWpStringAttr("hash",lo.Base64Utils.fromArrayBuffer(e.passwordHash)),e.passwordPrefix&&this.writer.writeWpStringAttr("salt",lo.Base64Utils.fromArrayBuffer(e.passwordPrefix)))}exportFootNoteProperties(){const e=this.data.model.sections[0].sectionProperties.footNote;new DH(this.data).exportDocumentLevelFootNoteProperties(e)}exportEndNoteProperties(){const e=this.data.model.sections[0].sectionProperties.endNote;new DH(this.data).exportDocumentLevelEndNoteProperties(e)}}class dV extends aV{get filePath(){return this._filePath}constructor(e,t){super(e),this._filePath=t,this.collection=[],this.imageRelationsTable={},this.hyperlinkRelationsTable={},this.exportedExternalImageRelationsTable={}}fillWriter(){this.generateFileRelationCore(this.imageRelationsTable,this.data.constants.rels.relsImage),this.generateFileRelationCore(this.exportedExternalImageRelationsTable,this.data.constants.rels.relsImage,!0),this.generateHyperlinkRelationsCore(this.hyperlinkRelationsTable,this.data.constants.rels.officeHyperlinkType);for(const e of this.collection)this.addRel(e.id,e.type,e.target)}generateFileRelationCore(e,t,r=!1){B.StringMapUtils.forEach(e,((e,i)=>this.addRel(i,t,e,r)))}isWriteToZip(){return this.numRels>0}generateHyperlinkRelationsCore(e,t){B.StringMapUtils.forEach(e,((e,r)=>this.addRel(r,t,e,!rn.StringUtils.startsAt(e,"#"))))}}class cV extends tV{get rootElement(){return this.subDocument.isHeader()?"hdr":"ftr"}constructor(e,t,r,i){super(e,t,r),this.relsFilePath=i}createRelationExporter(){return new dV(this.data,this.relsFilePath)}fillWriterCore(){this.init(),this.exportSection(this.data.model.sections[0],new on.FixedInterval(0,this.subDocument.getDocumentEndPosition()))}}class hV extends dV{constructor(e){super(e,"word/_rels/document.xml.rels"),this.headerRelationsTable={},this.footerRelationsTable={},this.footNoteRelationsTable={},this.endNoteRelationsTable={},this.commentRelationsTable={},this.commentsExtendedRelationsTable={}}fillWriter(){super.fillWriter(),this.generateFileRelationCore(this.headerRelationsTable,this.data.constants.rels.relsHeader),this.generateFileRelationCore(this.footerRelationsTable,this.data.constants.rels.relsFooter),this.generateFileRelationCore(this.footNoteRelationsTable,this.data.constants.rels.relsFootNote),this.generateFileRelationCore(this.endNoteRelationsTable,this.data.constants.rels.relsEndNote),this.generateFileRelationCore(this.commentsExtendedRelationsTable,this.data.constants.rels.relsCommentsExtended),this.generateFileRelationCore(this.commentRelationsTable,this.data.constants.rels.relsComment),this.addRel("RelStyle1",this.data.constants.rels.officeStylesType,"styles.xml"),this.data.model.webSettings.isBodyMarginsSet()&&this.addRel("RelWebSettings1",this.data.constants.rels.officeWebSettingsType,"webSettings.xml"),WH.shouldExportNumbering(this.data.model)&&this.addRel("RelNum1",this.data.constants.rels.officeNumberingType,"numbering.xml"),this.addRel("RelSettings1",this.data.constants.rels.officeDocumentSettings,"settings.xml"),this.addRel("RelTheme1",this.data.constants.rels.officeThemesType,"theme/theme1.xml")}}class uV extends tV{createRelationExporter(){return new hV(this.data)}get rootElement(){return"document"}fillWriterCore(){this.exportDocumentBackground(),this.writer.writeWpStartElement("body"),this.init();for(const e of this.data.model.sections)this.exportSection(e,e.interval);new FH(this.data,f.ListUtils.last(this.data.model.sections)).exportProperties(),this.writer.endElement()}exportDocumentBackground(){const e=this.data.model.pageBackColor,t=this.data.model.cache.colorModelInfoCache.getItem(he.makeByColor(e));e==U.empty&&t.themeColorIndex==ce.None||(this.writer.writeWpStartElement("background"),this.data.colorExporter.exportColorInfo(t,"color",!1),this.writer.endElement())}}class pV extends vH{get filePath(){return"word/theme/theme1.xml"}get rootElement(){return"theme"}get rootNSPrefix(){return this.data.constants.namespaces[ZD.DrawingML].prefix}get rootNSValue(){return this.data.constants.namespaces[ZD.DrawingML].namespace}fillWriter(){this.data.pushRelationExporter(new dV(this.data,"word/theme/_rels/theme1.xml.rels")),this.writer.attr("name",this.data.model.colorProvider.officeTheme.name),this.generateThemeElementsContent(),this.generateObjectDefaults(),this.generateExtraClrScheme(),this.data.popRelationExporter(),this.data.contentTypesExporter.registerContentTypeOverride("/word/theme/theme1.xml",dF.theme)}createElement(e,t){this.writer.elementStartNS(ZD.DrawingML,e),t.call(this),this.writer.endElement()}writeIntValue(e,t,r){t!=r&&this.writer.attr(e,t.toString())}generateThemeElementsContent(){this.writer.elementStartNS(ZD.DrawingML,"themeElements"),this.generateThemeColorSchemesContent(),this.generateThemeFontSchemesContent(),this.generateThemeFormatSchemesContent(),this.writer.endElement()}generateObjectDefaults(){this.writer.elementStartNS(ZD.DrawingML,"objectDefaults"),this.writer.endElement()}generateExtraClrScheme(){this.writer.elementStartNS(ZD.DrawingML,"extraClrSchemeLst"),this.writer.endElement()}generateThemeColorSchemesContent(){const e=this.data.model.colorProvider.officeTheme.colors;this.writer.elementStartNS(ZD.DrawingML,"clrScheme"),this.writer.attr("name",this.data.model.colorProvider.officeTheme.colors.name),this.generateThemeColorSchemeContent(ce.Dark1,e.Dark1),this.generateThemeColorSchemeContent(ce.Light1,e.Light1),this.generateThemeColorSchemeContent(ce.Dark2,e.Dark2),this.generateThemeColorSchemeContent(ce.Light2,e.Light2),this.generateThemeColorSchemeContent(ce.Accent1,e.Accent1),this.generateThemeColorSchemeContent(ce.Accent2,e.Accent2),this.generateThemeColorSchemeContent(ce.Accent3,e.Accent3),this.generateThemeColorSchemeContent(ce.Accent4,e.Accent4),this.generateThemeColorSchemeContent(ce.Accent5,e.Accent5),this.generateThemeColorSchemeContent(ce.Accent6,e.Accent6),this.generateThemeColorSchemeContent(ce.Hyperlink,e.Hyperlink),this.generateThemeColorSchemeContent(ce.FollowedHyperlink,e.FollowedHyperlink),this.writer.endElement()}generateThemeColorSchemeContent(e,t){this.writer.elementStartNS(ZD.DrawingML,NR.simple2ThemeColorIndexTable[e]),this.generateDrawingColorContent(t),this.writer.endElement()}generateThemeFontSchemesContent(){this.writer.elementStartNS(ZD.DrawingML,"fontScheme"),this.writer.attr("name",this.data.model.colorProvider.officeTheme.fontScheme.name),this.generateThemeFontSchemePartContent(this.data.model.colorProvider.officeTheme.fontScheme.majorFont,"majorFont"),this.generateThemeFontSchemePartContent(this.data.model.colorProvider.officeTheme.fontScheme.minorFont,"minorFont"),this.writer.endElement()}generateThemeFontSchemePartContent(e,t){this.writer.elementStartNS(ZD.DrawingML,t),this.generateDrawingTextFontContent(e.latin,"latin"),this.generateDrawingTextFontContent(e.eastAsian,"ea"),this.generateDrawingTextFontContent(e.complexScript,"cs"),B.StringMapUtils.forEach(e.supplementalFonts,((e,t)=>this.generateThemeSupplementalFontContent(t,e))),this.writer.endElement()}generateThemeSupplementalFontContent(e,t){this.writer.elementStartNS(ZD.DrawingML,"font"),this.writer.attr("script",e),this.writer.attr("typeface",t),this.writer.endElement()}generateDrawingTextFontContent(e,t){const r=e.typeface,i=e.panose,n=e.pitchFamily,o=e.charset;this.writer.elementStartNS(ZD.DrawingML,t),this.writer.attr("typeface",rn.StringUtils.isNullOrEmpty(r)?"":r),rn.StringUtils.isNullOrEmpty(i)||20!=i.length||this.writer.attr("panose",i),this.writeIntValue("pitchFamily",n,Co.DefaultPitchFamily),this.writeIntValue("charset",o,Co.DefaultCharset),this.writer.endElement()}generateDrawingColorContent(e){if(e)switch(e.colorType){case W.Rgb:this.exportRgbColor(e);break;case W.System:this.exportSystemColor(e)}}exportSystemColor(e){this.writer.elementStartNS(ZD.DrawingML,"sysClr"),this.exportSystemColorAttributes(e.system),this.exportLastComputedColorAttribute(e.finalColor(this.data.model.colorProvider)),this.writer.endElement()}exportRgbColor(e){this.writer.elementStartNS(ZD.DrawingML,"srgbClr"),this.exportRgbColorAttributes(e.originalColor.rgb),this.writer.endElement()}exportRgbColorAttributes(e){this.exportColorAttributes("val",e)}exportColorAttributes(e,t){this.writer.attr(e,w.i.colorToHash(t).substr(1))}exportSystemColorAttributes(e){const t=NR.systemColorTable.exportMap[e];void 0!==t&&this.writer.attr("val",t.mlValue.openXmlValue)}exportLastComputedColorAttribute(e){this.exportColorAttributes("lastClr",e)}generateThemeFormatSchemesContent(){this.writer.elementStartNS(ZD.DrawingML,"fmtScheme");const e=this.data.model.colorProvider.officeTheme.formatScheme.name;rn.StringUtils.isNullOrEmpty(e)||this.writer.attr("name",e),this.createElement("fillStyleLst",this.generateDrawingFillContent),this.createElement("lnStyleLst",this.generateOutlineContent),this.createElement("effectStyleLst",this.generateDrawingEffectStyleContent),this.createElement("bgFillStyleLst",this.generateDrawingBgFillContent),this.writer.endElement()}addTempString(e){return`<tmpElement xmlns:${this.data.constants.namespaces[ZD.DrawingML].prefix}="${this.data.constants.namespaces[ZD.DrawingML].namespace}">`+e+"</tmpElement>"}generateDrawingFillContent(){this.writer.writeRaw(this.addTempString('<a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill>'))}generateOutlineContent(){this.writer.writeRaw(this.addTempString('<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>'))}generateDrawingEffectStyleContent(){this.writer.writeRaw(this.addTempString('<a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle>'))}generateDrawingBgFillContent(){this.writer.writeRaw(this.addTempString('<a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill>'))}}class gV extends eV{constructor(e,t){super(e,`word/${t}`),this.relsFilePath=`word/_rels/${t}.rels`,this.fileName=t}createRelationExporter(){return new dV(this.data,this.relsFilePath)}isMainContent(){return!1}fillWriterCore(){this.exportNotes(),this.addRels(this.fileName),this.data.contentTypesExporter.registerContentTypeOverride(`/word/${this.fileName}`,this.contentType)}exportNotes(){for(const[e,t]of this.noteToIdMap.entries()){this.pushSubDocument(e),this.writer.writeWpStartElement(this.childElement);const r=e.info.noteType;r!==Xs.Normal&&this.writer.writeWpStringAttr("type",NR.noteTypeTable.exportMap[r].mlValue.openXmlValue),this.writer.writeWpIntAttr("id",t),this.exportNoteContent(),this.writer.endElement(),this.popSubDocument()}}exportNoteContent(){this.init(),this.exportSection(this.data.model.sections[0],new on.FixedInterval(0,this.subDocument.getDocumentEndPosition()))}pushSubDocument(e){this.subDocument=e}popSubDocument(){const e=this.subDocument;return this.subDocument=null,e}}class mV extends gV{constructor(e){super(e,"footnotes.xml")}get rootElement(){return"footnotes"}get childElement(){return"footnote"}get contentType(){return dF.footnotes}get noteToIdMap(){return this.data.footNotes}addRels(e){this.data.mainSubDocumentRelations.footNoteRelationsTable.RelFootnotes=e}}class fV extends gV{constructor(e){super(e,"endnotes.xml")}get rootElement(){return"endnotes"}get childElement(){return"endnote"}get contentType(){return dF.endnotes}get noteToIdMap(){return this.data.endNotes}addRels(e){this.data.mainSubDocumentRelations.endNoteRelationsTable.RelEndnotes=e}}class bV{constructor(e,t){this.modelManipulator=e,this.options=t,this.data=new nV(e.model,t)}exportToBlob(e){this.modelManipulator.picture.loader.ensureAllPicturesLoaded(this.options.ensurePictureLoadedTimeout,(t=>{this.exportInner(),this.data.zipBuilder.generateBlob(e)}))}exportToBase64(e){this.modelManipulator.picture.loader.ensureAllPicturesLoaded(this.options.ensurePictureLoadedTimeout,(t=>{this.exportInner(),this.data.zipBuilder.generateBase64(e)}))}exportInner(){this.addFootNoteSeparators(),this.addEndNoteSeparators(),new oV(this.data).export(),this.exportCustomProperties(),new uV(this.data,this.data.model.mainSubDocument,"word/document.xml").export();for(let e;e=this.data.exportSubDocumentsList.pop();){const t=`${e.isHeader()?"header":"footer"}${e.id}.xml`;new cV(this.data,e,`word/${t}`,`word/_rels/${t}.rels`).export()}new jH(this.data).export(),new WH(this.data).export(),new lV(this.data).export(),this.exportFootNotesAndEndNotes(),this.exportComments(),this.exportWebSettings(),new pV(this.data).export(),new sV(this.data).export(),this.data.popRelationExporter(),this.data.contentTypesExporter.export()}addFootNoteSeparators(){for(const e of this.data.model.footNoteSeparators.getSeparatos())this.data.addFootNote(e)}addEndNoteSeparators(){for(const e of this.data.model.endNoteSeparators.getSeparatos())this.data.addEndNote(e)}exportCustomProperties(){}exportFootNotesAndEndNotes(){this.data.footNotes.size>0&&new mV(this.data).export(),this.data.endNotes.size>0&&new fV(this.data).export()}exportComments(){}exportWebSettings(){}}class CV{get model(){return this.modelManipulator.model}constructor(e,t){this.modelManipulator=e,this.options=t}exportToBlob(e){this.getBlob(e)}exportToBase64(e){this.getBlob((t=>lo.Base64Utils.fromBlobAsDataUrl(t,(t=>{const r=t.split(",");e(2===r.length?r[1]:"")}))))}getBlob(e){this.modelManipulator.picture.loader.ensureAllPicturesLoaded(this.options.ensurePictureLoadedTimeout,(t=>{let r="";this.model.mainSubDocument.paragraphs.forEach(((e,t)=>{t>0&&(r+="\r\n"),r+=this.model.mainSubDocument.getSimpleText(new on.FixedInterval(e.startLogPosition.value,e.length))})),e(new Blob([r],{type:Ru.PlainTextMimeType}))}))}}function SV(e,t){PV(e).exportToBase64(t)}function IV(e,t){PV(e).exportToBlob(t)}function PV(e){const{modelManipulator:t}=e.modelManager;switch(e.documentFormat){case Fu.OpenXml:return new bV(t,new SH);case Fu.Rtf:return new bw(t,new AP);case Fu.PlainText:return new CV(t,new BP);case Fu.Html:return new NE(e,new BP);default:return console.log("Unsupported format"),null}}var wV,yV,xV,TV,vV,MV,EV,DV,FV,RV,LV,BV,AV,NV,kV,OV=DevExpress.localization,_V=DevExpress.viz;!function(e){e[e.Deleted=0]="Deleted",e[e.Replaced=1]="Replaced",e[e.Updated=2]="Updated",e[e.Inserted=3]="Inserted"}(wV||(wV={}));class UV{get layoutIndex(){return this.index}get canvasIndex(){return this.index}constructor(e,t=wV.Updated){this.index=e,this.changeType=t}summarizeChanges(e){}}class HV extends UV{reduceChanges(){return this.changeType==wV.Updated?null:this}}class VV extends UV{reduceChanges(){return this.changeType==wV.Updated?null:this}}class WV extends UV{reduceChanges(){return this.changeType==wV.Updated?null:this}}class zV extends UV{reduceChanges(){return this.changeType==wV.Updated?null:this}}class jV extends WV{get layoutIndex(){return this._layoutIndex}get canvasIndex(){return this.index}constructor(e,t,r){super(t,r),this._layoutIndex=e}}class XV extends zV{get layoutIndex(){return this._layoutIndex}get canvasIndex(){return this.index}constructor(e,t,r){super(t,r),this._layoutIndex=e}}class GV extends VV{get layoutIndex(){return this._layoutIndex}get canvasIndex(){return this.index}constructor(e,t,r){super(t,r),this._layoutIndex=e}}class KV{static layoutPoint(e){return e?`[pageIndex: ${e.pageIndex}, x: ${e.x}, y:${e.y}]`:"null"}static layoutPosition(e){return KV.layoutPositionShort(e)+`, boxInd: ${e.boxIndex}, charOffset:${e.charOffset}`}static layoutPositionShort(e){return`DetLevel: ${Hu[e.detailsLevel]}, pageIndex: ${e.pageIndex}, pageAreaInd: ${e.pageAreaIndex}, columnInd: ${e.columnIndex}, rowInd: ${e.rowIndex}`}static layoutChangeBase(e,t="",r="\t"){const i=[];return i.push(`${t}index: ${e.index}`),i.push(`type: ${wV[e.changeType]}`),i.join(r)}static pageSelectionChange(e,t=""){const r=`${t}\t`,i=`${r}\t`;const n=[];return n.push(KV.layoutChangeBase(e,t)),n.push(`${t}pageSelectionChange:\n${O.join("\n",O.map(((e,t)=>`${r}areaSelectionChange[${t}]:\n${KV.areaSelectionChange(e,i)}`),e.areaChanges))}`),n.join("\n")}static areaSelectionChange(e,t=""){const r=[];return r.push(KV.layoutChangeBase(e,t,",\t")),r.push(lg.rectangle(e.selection,t,",\t")),r.join(",\t")}static pageChange(e,t=""){const r=`${t}\t`,i=`${r}\t`;let n=(e,t)=>`${r}pageAreaChange[${t}]:\n${KV.pageAreaChange(e,i)}`;const o=[];return o.push(KV.layoutChangeBase(e,t)),o.push(`${t}mainPageAreaChanges:\n${O.join("\n",O.map(n,e.mainPageAreaChanges))}`),o.push(`${t}otherPageAreaChanges:\n${O.join("\n",O.map(n,e.otherPageAreaChanges))}`),o.push(`${t}floatingPictureChanges:\n${O.join("\n",O.map(((e,t)=>`${r}pictureFloatingChange[${t}]:\n${KV.anchoredPictureChange(e,i)}`),e.anchoredPictureChanges))}`),o.join("\n")}static pageAreaChange(e,t=""){const r=`${t}\t`,i=`${r}\t`;const n=[];return n.push(KV.layoutChangeBase(e,t)),n.push(`${t}columnChanges:\n${O.join("\n",O.map(((e,t)=>`${r}columnChange[${t}]:\n${KV.columnChange(e,i)}`),e.columnChanges))}`),n.join("\n")}static anchoredPictureChange(e,t=""){const r=[];return r.push(KV.layoutChangeBase(e,t)),r.push(`${t}objectId: ${e.index}`),r.join("\n")}static columnChange(e,t=""){const r=`${t}\t`,i=(e,t,i,n)=>`${r}[${n}]:\t${t(i,"")}`,n=[{name:"rowChange",getChange:e=>e.rowChanges,handler:KV.rowChange},{name:"paragraphFrameChange",getChange:e=>e.paragraphFrameChanges,handler:KV.paragraphFrameChange},{name:"tableChange",getChange:e=>e.tableChanges,handler:KV.tableChange}],o=[];o.push(KV.layoutChangeBase(e,t));for(let r of n)o.push(`${t}${r.name}s:\n${O.join("\n",O.map(O.w(4,i)(r.name)(r.handler),r.getChange(e)))}`);return o.join("\n")}static rowChange(e,t=""){return KV.layoutChangeBase(e,t)}static paragraphFrameChange(e,t=""){const r=[];return r.push(KV.layoutChangeBase(e,t)),r.join("\t")}static tableChange(e,t=""){return KV.layoutChangeBase(e,t)}static layoutTableColumnInfo(e,t="",r="\t"){const i=`${t}\t`,n=[];return n.push(`${t}TableIndex: ${e.logicInfo.grid.table.index}`),n.push(`${t}NestedLevel: ${e.logicInfo.grid.table.nestedLevel}`),n.push(`${t}ParentTableIndex: ${e.parentCell?e.parentCell.parentRow.parentTable.logicInfo.grid.table.index:""}`),n.push(`${t}NumRows: ${e.tableRows.length}`),n.push(`${t}Rows:\n${f.ListUtils.map(e.tableRows,(e=>KV.layoutTableRowInfo(e,i,r))).join("\n")}`),n.join(r)}static layoutTableRowInfo(e,t="",r="\t"){const i=`${t}\t`,n=[];return n.push(`${t}RowIndex: ${e.rowIndex}`),n.push(`${t}NumCells: ${e.rowCells.length}`),n.push(`${t}Cells:\n${f.ListUtils.map(e.rowCells,(e=>KV.layoutTableCellInfo(e,i,r))).join("\n\n")}`),n.join(r)}static layoutTableCellInfo(e,t="",r="\t"){const i=[];return i.push(`${t}CellGridIndex: ${e.cellGridIndex}`),i.push(`${t}Flags: ${O.mask(_a,e.boundFlags.getValue(),_a.StartAndEndOnOtherColumns)}`),i.push(`${t}InternalTablesIndexes: ${b.j.toListBy(e.internalTables,(e=>e.logicInfo.grid.table.index.toString())).join(" ")}`),i.push(`${t}NumLayoutRows: ${e.layoutRows.length}`),i.push(`${t}CellText: ${f.ListUtils.map(e.layoutRows,(e=>f.ListUtils.map(e.boxes,(e=>e.getType()==lc.Text?e.text:"¶")).join(""))).join("")}`),i.join(r)}}class qV extends UV{constructor(e,t=wV.Updated,r=[],i=[],n=[]){super(e,t),this.rowChanges=r,this.tableChanges=i,this.paragraphFrameChanges=n}summarizeChanges(e){this.rowChanges=this.rowChanges.concat(e.rowChanges),this.tableChanges=this.tableChanges.concat(e.tableChanges),this.paragraphFrameChanges=this.paragraphFrameChanges.concat(e.paragraphFrameChanges)}reduceChanges(){return this.rowChanges=f.ListUtils.reducedMap(this.rowChanges,(e=>e.reduceChanges())),this.tableChanges=f.ListUtils.reducedMap(this.tableChanges,(e=>e.reduceChanges())),this.paragraphFrameChanges=f.ListUtils.reducedMap(this.paragraphFrameChanges,(e=>e.reduceChanges())),this.changeType!=wV.Updated||this.rowChanges.length||this.tableChanges.length||this.paragraphFrameChanges.length?this:null}}class $V extends UV{constructor(e,t=wV.Updated,r=[]){super(e,t),this.columnChanges=r}summarizeChanges(e){this.columnChanges=this.columnChanges.concat(e.columnChanges)}reduceChanges(){return this.columnChanges=f.ListUtils.reducedMap(this.columnChanges,(e=>e.reduceChanges())),this.changeType!=wV.Updated||this.columnChanges.length?this:null}}class JV extends UV{constructor(e,t=wV.Updated,r=[],i=[]){super(e,t),this.mainPageAreaChanges=r,this.otherPageAreaChanges=i,this.anchoredPictureChanges=[]}summarizeChanges(e){f.ListUtils.addListOnTail(this.mainPageAreaChanges,e.mainPageAreaChanges),f.ListUtils.addListOnTail(this.otherPageAreaChanges,e.otherPageAreaChanges),f.ListUtils.addListOnTail(this.anchoredPictureChanges,e.anchoredPictureChanges)}emptyOrInvalid(){if(this.changeType!=wV.Updated||this.otherPageAreaChanges.length>0||this.anchoredPictureChanges.length>0)return!1;for(let e of this.mainPageAreaChanges){if(e.changeType!=wV.Updated)return!1;for(let t of e.columnChanges)if(t.changeType!=wV.Updated||0!=t.rowChanges.length||0!=t.paragraphFrameChanges.length||0!=t.tableChanges.length)return!1}return!0}reduceChanges(){return this.mainPageAreaChanges=f.ListUtils.reducedMap(this.mainPageAreaChanges,(e=>e.reduceChanges())),this.otherPageAreaChanges=f.ListUtils.reducedMap(this.otherPageAreaChanges,(e=>e.reduceChanges())),this.anchoredPictureChanges=f.ListUtils.reducedMap(this.anchoredPictureChanges,(e=>e.reduceChanges())),this}}class YV{merge(e){for(var t of(this.resultChanges=[],this.infos=[],this.fillTo(0),e))switch(t.changeType){case wV.Inserted:this.handleInsertedChange(t);break;case wV.Deleted:this.handleDeletedChange(t);break;case wV.Replaced:this.handleReplacedChange(t,yV.Replaced);break;case wV.Updated:this.handleReplacedChange(t,yV.Updated)}return this.collectFinalChanges(),this.resultChanges}fillTo(e){for(;this.infos.length<=e;)this.infos.push(new nW(yV.None,null,0))}handleDeletedChange(e){this.fillTo(e.index);const t=this.infos.splice(e.index+1,1)[0];this.infos[e.index].numElemsDeletedAfterThis+=1+(t?t.numElemsDeletedAfterThis:0)}handleInsertedChange(e){this.fillTo(e.index);const t=this.infos[e.index];this.infos.splice(e.index+1,0,t.numElemsDeletedAfterThis?new nW(yV.Replaced,this.changeConstructor(e.index,wV.Replaced),t.numElemsDeletedAfterThis-1):new nW(yV.Inserted,e,0)),t.numElemsDeletedAfterThis=0}handleReplacedChange(e,t){this.fillTo(e.index+1);const r=this.infos[e.index+1];switch(r.type){case yV.Inserted:case yV.Replaced:break;case yV.None:case yV.Updated:t==yV.Updated&&r.type==yV.Updated?r.change.summarizeChanges(e):(r.type=t,r.change=e)}}collectFinalChanges(){for(let e,t=0;e=this.infos[t];t++){switch(e.type){case yV.Inserted:case yV.Replaced:case yV.Updated:e.change.index=t-1,this.resultChanges.push(e.change);case yV.None:}for(;e.numElemsDeletedAfterThis;e.numElemsDeletedAfterThis--)this.resultChanges.push(this.changeConstructor(t,wV.Deleted))}}}class QV extends YV{changeConstructor(e,t){return new JV(e,t,[],[])}}class ZV extends YV{changeConstructor(e,t){return new $V(e,t,[])}}class eW extends YV{changeConstructor(e,t){return new qV(e,t,[],[],[])}}class tW extends YV{changeConstructor(e,t){return new WV(e,t)}}class rW extends YV{changeConstructor(e,t){return new zV(e,t)}}class iW extends YV{changeConstructor(e,t){return new VV(e,t)}}class nW{constructor(e,t,r){this.type=e,this.change=t,this.numElemsDeletedAfterThis=r}}!function(e){e[e.Replaced=0]="Replaced",e[e.Inserted=1]="Inserted",e[e.Updated=2]="Updated",e[e.None=3]="None"}(yV||(yV={}));class oW{constructor(){this.reset()}reset(){this.pageChanges=[]}addPageChange(e){e&&this.pageChanges.push(e)}getPageChanges(){return this.pageChanges}getMergedPageChanges(){if(!this.pageChanges.length)return[];const e=(new QV).merge(this.pageChanges);return O.print(L.LayoutFormatter,"mergedPageChanges - Changes\n",sg.level_1((e=>KV.pageChange(e,"")),e,"","\n")),e}}function aW(e,t){return t?(t.minElement>e.minElement&&(e.minElement=t.minElement),t.maxElement>e.maxElement&&(e.maxElement=t.maxElement),e):e}class sW{constructor(e){this.manager=e}get anchorInfo(){return this.obj.anchorInfo}init(e){this.lp=this.manager.activeFormatter.layoutPosition,this.obj=e,this.isRelativeCell=!!this.manager.activeFormatter.tableFormatter&&(e.anchorInfo.layoutTableCell||this.manager.model.compatibilitySettings.layoutInTableCell),this.isSimpleView=this.manager.innerClientProperties.viewsSettings.isSimpleView}}class lW extends sW{calculate(e){this.init(e),this.obj.x=this.getX(),this.correctInTextAnchorPosition()}get leftCellMargin(){return this.manager.activeFormatter.tableFormatter.actualFormatter.tableInfo.currCellInfo.marginLeft}get rightCellMargin(){return this.manager.activeFormatter.tableFormatter.actualFormatter.tableInfo.currCellInfo.marginRight}getX(){if(this.anchorInfo.isUsedHorizontalAlignment())return this.alignment(this.anchorInfo.horizontalPositionType,this.anchorInfo.horizontalPositionAlignment);if(this.anchorInfo.isUsedHorizontalAbsolutePosition())return g.u.twipsToPixelsF(this.anchorInfo.offset.x)+this.absolute();if(this.anchorInfo.isUsedHorizontalBookLayout())return this.bookLayout();if(this.anchorInfo.isUsedHorizontalRelativePosition())return this.relative();throw new Error(R.D.InternalException)}relativeColumnPos(){return this.lp.pageArea.x+this.lp.column.x}correctInTextAnchorPosition(){if(!this.isRelativeCell||!this.obj.isInText())return;const e=this.relativeColumnPos()+this.lp.row.tableCellInfo.x;this.obj.x=Math.max(this.obj.x,e);const t=this.relativeColumnPos()+this.lp.row.tableCellInfo.right,r=this.obj.right-t;if(r>0){const t=this.obj.x-e;this.obj.x-=Math.min(r,t)}}alignment(e,t){switch(e){case gc.Character:return this.getAlignPosition(t,0);case gc.Column:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.getAlignPosition(t,this.lp.row.tableCellInfo.width-this.leftCellMargin-this.rightCellMargin):this.relativeColumnPos()+this.getAlignPosition(t,this.lp.column.width);case gc.Page:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.getAlignPosition(t,this.lp.row.tableCellInfo.width):this.getAlignPosition(t,this.manager.boundsCalculator.pageWidth);case gc.Margin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.leftCellMargin+this.getAlignPosition(t,this.lp.row.tableCellInfo.width-this.leftCellMargin-this.rightCellMargin):this.manager.boundsCalculator.marginLeft+this.getAlignPosition(t,this.lp.pageArea.width);case gc.LeftMargin:case gc.InsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.getAlignPosition(t,this.leftCellMargin):this.getAlignPosition(t,this.manager.boundsCalculator.marginLeft);case gc.RightMargin:case gc.OutsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.right-this.rightCellMargin+this.getAlignPosition(mc.Right,this.rightCellMargin):this.manager.boundsCalculator.pageWidth-this.manager.boundsCalculator.marginRight+this.getAlignPosition(t,this.manager.boundsCalculator.marginRight);default:throw new Error(R.D.InternalException)}}getAlignPosition(e,t){switch(e){case mc.Left:return 0;case mc.Center:return t/2-this.obj.width/2;case mc.Right:return t-this.obj.width;default:throw new Error(R.D.InternalException)}}absolute(){switch(this.anchorInfo.horizontalPositionType){case gc.Page:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x:0;case gc.Column:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.leftCellMargin:this.relativeColumnPos();case gc.Character:{const e=this.lp.getLogPosition(Hu.Row),t=this.obj.rowOffset,r=C.SearchUtils.normedInterpolationIndexOf(this.lp.row.boxes,(t=>e+t.rowOffset),t),i=this.lp.row.boxes[r];if(!i)return this.lp.getLayoutX(null,Hu.Row);const n=Math.max(0,t-e-i.rowOffset);return this.lp.getLayoutX(null,Hu.Row)+i.x+i.getCharOffsetXInPixels(this.manager.measurer,n)}case gc.Margin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.leftCellMargin:this.manager.boundsCalculator.marginLeft;case gc.LeftMargin:case gc.OutsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.leftCellMargin:0;case gc.RightMargin:case gc.InsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.right-this.rightCellMargin:this.manager.boundsCalculator.pageWidth-this.manager.boundsCalculator.marginRight;default:throw new Error(R.D.InternalException)}}bookLayout(){return this.alignment(this.anchorInfo.horizontalPositionType,lW.mapBookLayoutALignmentType[this.anchorInfo.horizontalPositionAlignment])}relative(){switch(this.anchorInfo.horizontalPositionType){case gc.Page:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.anchorInfo.getRelativeOffsetX(this.lp.row.tableCellInfo.width):this.anchorInfo.getRelativeOffsetX(this.manager.boundsCalculator.pageWidth);case gc.Margin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.leftCellMargin+this.anchorInfo.getRelativeOffsetX(this.lp.row.tableCellInfo.width-this.leftCellMargin-this.rightCellMargin):this.manager.boundsCalculator.marginLeft+this.anchorInfo.getRelativeOffsetX(this.manager.boundsCalculator.pageWidth-this.manager.boundsCalculator.marginLeft-this.manager.boundsCalculator.marginRight);case gc.LeftMargin:case gc.InsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.x+this.anchorInfo.getRelativeOffsetX(this.leftCellMargin):this.anchorInfo.getRelativeOffsetX(this.manager.boundsCalculator.marginLeft);case gc.RightMargin:case gc.OutsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.right-this.rightCellMargin+this.anchorInfo.getRelativeOffsetX(this.rightCellMargin):this.manager.boundsCalculator.pageWidth-this.manager.boundsCalculator.marginRight+this.anchorInfo.getRelativeOffsetX(this.manager.boundsCalculator.marginRight);default:throw new Error(R.D.InternalException)}}}lW.mapBookLayoutALignmentType={[mc.Inside]:mc.Left,[mc.Outside]:mc.Right};class dW extends sW{calculate(e){this.init(e),this.obj.y=this.getY(),this.correctInTextAnchorPosition()}get topCellMargin(){return this.manager.activeFormatter.tableFormatter.actualFormatter.tableInfo.currRowInfo.topAndBottomMargins.topMargin}getY(){if(this.anchorInfo.isUsedVerticalAbsolutePosition())return g.u.twipsToPixelsF(this.anchorInfo.offset.y)+this.absolute();if(this.anchorInfo.isUsedVerticalAlignment())return this.alignment();if(this.anchorInfo.isUsedVerticalRelativePosition())return this.relative();throw new Error(R.D.InternalException)}relativeColumnPos(){return this.lp.pageArea.y+this.lp.column.y}correctInTextAnchorPosition(){if(!this.isRelativeCell||!this.obj.isInText())return;const e=this.relativeColumnPos()+this.lp.row.tableCellInfo.y;this.obj.y=Math.max(this.obj.y,e)}getRowWhatStartParagraphY(){const e=this.lp.pageArea.subDocument.paragraphs[this.manager.activeFormatter.rowFormatter.result.paragraphIndex].startLogPosition.value,t=this.lp.column.rows,r=e-this.lp.getLogPosition(Hu.Column),i=this.lp.rowIndex;let n=i>=t.length?this.lp.row:t[i];for(let e,o=i-1;(e=t[o])&&e.columnOffset>=r;o--)n=e;const o=n.initialY-this.manager.activeFormatter.layoutPosition.getOffsetRelativeColumn().y;return Math.min(o,n.y)}absolute(){switch(this.anchorInfo.verticalPositionType){case fc.Page:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:0;case fc.Line:return this.relativeColumnPos()+this.lp.row.y;case fc.Margin:if(!this.isSimpleView)return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.manager.boundsCalculator.marginTop;case fc.Paragraph:return this.relativeColumnPos()+this.getRowWhatStartParagraphY();case fc.TopMargin:case fc.InsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:0;case fc.BottomMargin:case fc.OutsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.manager.boundsCalculator.pageHeight-this.manager.boundsCalculator.marginBottom;default:throw new Error(R.D.InternalException)}}alignment(){switch(this.anchorInfo.verticalPositionType){case fc.Page:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.getAlignPosition(this.manager.boundsCalculator.pageHeight);case fc.Line:return this.lp.getLayoutY(Hu.Column)+this.lp.row.y+this.getAlignPosition(this.lp.row.height);case fc.Paragraph:return this.relativeColumnPos()+this.getRowWhatStartParagraphY();case fc.Margin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.manager.boundsCalculator.marginTop+this.getAlignPosition(this.manager.boundsCalculator.pageHeight-this.manager.boundsCalculator.marginTop-this.manager.boundsCalculator.marginBottom);case fc.TopMargin:case fc.InsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.getAlignPosition(this.manager.boundsCalculator.marginTop);case fc.BottomMargin:case fc.OutsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.manager.boundsCalculator.pageHeight-this.manager.boundsCalculator.marginBottom+this.getAlignPosition(this.manager.boundsCalculator.marginBottom);default:throw new Error(R.D.InternalException)}}getAlignPosition(e){switch(this.anchorInfo.verticalPositionAlignment){case bc.Top:case bc.Inside:return 0;case bc.Center:return e/2-this.obj.height/2;case bc.Bottom:case bc.Outside:return e-this.obj.height;default:throw new Error(R.D.InternalException)}}relative(){switch(this.anchorInfo.verticalPositionType){case fc.Page:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.anchorInfo.getRelativeOffsetY(this.manager.boundsCalculator.pageHeight);case fc.Margin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.manager.boundsCalculator.marginTop+this.anchorInfo.getRelativeOffsetY(this.manager.boundsCalculator.pageHeight-this.manager.boundsCalculator.marginTop-this.manager.boundsCalculator.marginBottom);case fc.TopMargin:case fc.InsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.anchorInfo.getRelativeOffsetY(this.manager.boundsCalculator.marginTop);case fc.BottomMargin:case fc.OutsideMargin:return this.isRelativeCell?this.relativeColumnPos()+this.lp.row.tableCellInfo.y+this.topCellMargin:this.manager.boundsCalculator.pageHeight-this.manager.boundsCalculator.marginBottom+this.anchorInfo.getRelativeOffsetY(this.manager.boundsCalculator.marginBottom);default:throw new Error(R.D.InternalException)}}}class cW{constructor(e){this.manager=e,this.anchorObjectHorizontalPositionCalculator=new lW(this.manager),this.anchorObjectVerticalPositionCalculator=new dW(this.manager),this.reset()}reset(){this.textBoxContextSizeCalculators={}}}class hW{constructor(e,t,r){this.wrap=e,this.size=t,this.isInited=!1,this.layoutInTableCell=r}calculateSize(e){this.isInited||(this.isInited=!0,this.layoutSize=new so.Size(this.size.useAbsoluteWidth()?g.u.twipsToPixelsF(this.size.absoluteSize.width):this.size.getActualRelativeWidth(e),this.size.useAbsoluteHeight()?g.u.twipsToPixelsF(this.size.absoluteSize.height):this.size.getActualRelativeHeight(e)),this.wrap.info.tablePosition&&this.layoutInTableCell&&aW(this.paragraphMinMax,new xl.MinMaxNumber(this.layoutSize.width,this.layoutSize.width)))}}class uW extends Va.Rectangle{constructor(e){super(0,0,0,0),this.columns=[],this.subDocument=e}getEndPosition(){return this.pageOffset+f.ListUtils.last(this.columns).getEndPosition()}getLastColumn(){return this.columns[this.columns.length-1]}deepCopy(){const e=new uW(this.subDocument);return e.pageOffset=this.pageOffset,e.columns=f.ListUtils.map(this.columns,(e=>e.deepCopy())),e.copyFrom(this),e}}!function(e){e[e.NormallyEnd=0]="NormallyEnd",e[e.ParagraphEnd=1]="ParagraphEnd",e[e.PageEnd=2]="PageEnd",e[e.ColumnEnd=4]="ColumnEnd",e[e.SectionEnd=8]="SectionEnd",e[e.DocumentEnd=16]="DocumentEnd",e[e.CellTableEnd=64]="CellTableEnd",e[e.PageBreakBefore=128]="PageBreakBefore"}(xV||(xV={}));class pW extends Va.Rectangle{get hasEffectToPageHeight(){return 1!=this.boxes.length||!this.boxes[0].isSectionBreakBox}constructor(e=Number.MAX_SAFE_INTEGER){super(0,0,0,0),this.boxes=[],this.bookmarkBoxes=[],this.numberingListBox=null,this.flags=new pr.Flag(xV.NormallyEnd),this.initialY=e}getEndPosition(){return this.columnOffset+this.getLastBoxEndPositionInRow()}getLastBoxEndPositionInRow(){return f.ListUtils.last(this.boxes).getEndPosition()}getStartPosition(){return this.columnOffset+this.boxes[0].rowOffset}getLastBox(){return f.ListUtils.last(this.boxes)}isEmpty(){return 0==this.boxes.length}increaseRowHeightFromSpacingBeforeAndAfter(e,t){if(!this.getLastBox())return;const r=e-this.baseLine+this.spacingBefore;r>0&&(this.spacingBefore-=Math.min(this.spacingBefore,r));const i=t+this.baseLine-this.height;i>0&&(this.spacingAfter-=Math.min(this.spacingAfter,i))}applySpacingBefore(e){this.rollbackSpacingBefore(),this.spacingBefore=e,this.height+=this.getSpacingBefore(),this.baseLine+=this.getSpacingBefore()}rollbackSpacingBefore(){this.height=this.height-this.getSpacingBefore(),this.baseLine=this.baseLine-this.getSpacingBefore(),this.spacingBefore=0}applySpacingAfter(e){this.rollbackSpacingAfter(),this.spacingAfter=e,this.height+=this.getSpacingAfter()}rollbackSpacingAfter(){this.height=Math.max(0,this.height-this.getSpacingAfter()),this.spacingAfter=0}getSpacingBefore(){return this.spacingBefore||0}getSpacingAfter(){return this.spacingAfter||0}getLastVisibleBox(){var e=this.getLastVisibleBoxIndex();return e>=0?this.boxes[e]:null}getLastVisibleBoxIndex(){for(var e,t=this.boxes.length-1;e=this.boxes[t];t--)if(e.isVisible())return t;return-1}static getParagraphSpacingBefore(e,t,r,i,n){const o=e.getParagraphMergedProperties(),a=Math.abs(g.u.twipsToPixelsF(o.spacingBefore));if(!a||!t)return a;if(r&&i&&!n)return a;if(o.contextualSpacing&&e.paragraphStyle.styleName==t.paragraphStyle.styleName)return 0;if(r)return a;{const e=t.getParagraphMergedProperties(),r=g.u.twipsToPixelsF(e.spacingAfter);return r>=a?0:Math.abs(a-r)}}static getParagraphSpacingAfter(e,t){const r=e.getParagraphMergedProperties(),i=Math.abs(g.u.twipsToPixelsF(r.spacingAfter));return i&&t&&r.contextualSpacing&&e.paragraphStyle.styleName==t.paragraphStyle.styleName?0:i}applyXOffsetToBoxes(e){for(let t of this.boxes)t.x+=e;this.numberingListBox&&(this.numberingListBox.textBox.x+=e,this.numberingListBox.separatorBox&&(this.numberingListBox.separatorBox.x+=e))}getLastBoxIndexWhatCanStrikeoutAndUnderline(){let e=this.boxes.length-1;for(let t;(t=this.boxes[e])&&t.renderNoStrikeoutAndNoUnderlineIfBoxInEndRow();e--);return e}containsSpacesOnly(){return this.boxes.length>0&&f.ListUtils.allOf(this.boxes,(e=>e.isWhitespace()))}}class gW{static collect(e,t,r,i){return gW.collectNewParFrames(e,i,t.rows,r+t.pageAreaOffset)}static collectNewParFrames(e,t,r,i){const n=[],o=i+r[0].columnOffset;let a,s,l=C.SearchUtils.normedInterpolationIndexOf(t,(e=>e.startLogPosition.value),o),d=t[l],c=d.interval,h=l-1,u=t[l].getParagraphMergedProperties();for(let o,p,m=0;p=r[m];m++){const f=i+p.columnOffset;for(;;){if(c.contains(f)){l!=h||u.firstLineIndentType!=ke.None?(a=new ID,n.push(a),a.paragraphColor=u.shadingInfo.getActualColor(e),a.x=p.x,a.width=p.right-g.u.twipsToPixelsF(u.rightIndent)-a.x,a.y=p.y,a.height=p.height,(0==m||o&&o.tableCellInfo&&!p.tableCellInfo||p.tableCellInfo&&p.tableCellInfo.layoutRows[0]==p||s==y.NO_COLOR||s==y.AUTOMATIC_COLOR)&&(a.y+=p.getSpacingBefore(),a.height-=p.getSpacingBefore()),gW.isRemoveSpacingAfter(e,p,r[m+1],t,l)&&(a.height-=p.getSpacingAfter()),s=a.paragraphColor):(a.height=p.bottom-a.y,gW.isRemoveSpacingAfter(e,p,r[m+1],t,l)&&(a.height-=p.getSpacingAfter())),h=l;break}l++,d=t[l],c=d.interval,u=d.getParagraphMergedProperties()}o=p}return gW.mergeParagraphFrames(n)}static isRemoveSpacingAfter(e,t,r,i,n){let o;return!r||t.flags.get(xV.ParagraphEnd)&&(!t.tableCellInfo&&r.tableCellInfo||t.tableCellInfo&&f.ListUtils.last(t.tableCellInfo.layoutRows)==t||(o=i[n+1].getParagraphMergedProperties().shadingInfo.getActualColor(e))==y.NO_COLOR||o==y.AUTOMATIC_COLOR)}static mergeParagraphFrames(e){const t=[];let r;for(let i,n=0;i=e[n];n++)i.paragraphColor!=y.NO_COLOR&&i.paragraphColor!=y.AUTOMATIC_COLOR?r&&i.paragraphColor==r.paragraphColor&&i.x==r.x&&i.width==r.width&&Math.abs(i.y-r.bottom)<2?r.height=i.bottom-r.y:(r=i,t.push(r)):r=null;return t}}class mW{static collect(e,t){const r=[];for(let i=0;i<t.length;i++){const n=t[i],o=e[i];o?n.equals(o)||r.push(new VV(i,wV.Replaced)):r.push(new VV(i,wV.Inserted))}for(let i=t.length;i<e.length;i++)r.push(new VV(t.length,wV.Deleted));return r}}class fW{constructor(e,t){this.bounds=e,this.cell=t,this.canPutTextAtRight=!1,this.canPutTextAtLeft=!1}}class bW{getRectangleBounds(e){const t=e.activeFormatter.tableFormatter;if(!t){const t=e.model.compatibilitySettings.compatibilityMode<yg.Word2013;return e.activeFormatter.subDocument.isHeaderFooter()&&t?[]:this.rectangleBounds}const r=e.layout.anchorObjectsPositionInfo,i=t.tableInfo.table.getEndPosition();return f.ListUtils.reducedMap(this.rectangleBounds,((e,t)=>r.getPosition(this.ancObjectsId[t])<i?e:null))}addTableInTextObject(e,t){this.addAnchoredObject(e,t)}resetByColumn(e,t,r){if(this.rectangleBounds=[],this.ancObjectsId=[],!r){const r=b.j.reducedMap(e,(e=>e.levelType==dc.InText?e:null));b.j.forEach(r,(e=>this.addAnchoredObject(e,t)))}}removeAnchorObjectId(e){this.ancObjectsId.splice(e,1),this.rectangleBounds.splice(e,1)}addAnchoredObject(e,t){const r=e.anchorInfo,i=e.getExtendedBounds(),n=i.center,o=Gc.mg.fromRectangle(i);o.rotateAround(n,e.rotationInRadians,!1,!0);const a=o.bounds;switch(r.wrapType){case uc.Tight:case uc.Through:case uc.Square:{const i=this.createAnchorObjectBoundsInfo(r,a,e.parentCell);bW.applySquareWrapSide(r.wrapSide,i,t),this.rectangleBounds.push(i);break}case uc.TopAndBottom:{const t=this.createAnchorObjectBoundsInfo(r,a,e.parentCell);t.canPutTextAtLeft=!1,t.canPutTextAtRight=!1,this.rectangleBounds.push(t);break}default:throw new Error(R.D.InternalException)}this.ancObjectsId.push(e.objectId)}createAnchorObjectBoundsInfo(e,t,r){return t.applyOffsetsOutside(e.getDistanceMargins()),new fW(t,r)}static applySquareWrapSide(e,t,r){const i=t.bounds,n=nn.IntervalAlgorithms.getIntersectionNonNullLength(new on.FixedInterval(i.x,i.width),r);if(n)switch(e){case pc.Right:t.canPutTextAtRight=!0;break;case pc.Left:t.canPutTextAtLeft=!0;break;case pc.Largest:t.canPutTextAtLeft=n.start-r.start>=r.end-n.end,t.canPutTextAtRight=!t.canPutTextAtLeft;break;case pc.Both:t.canPutTextAtRight=!0,t.canPutTextAtLeft=!0}}}class CW{constructor(e){this.calculators={},this.currentParagraphIndex=-1,this.subDocument=e}calculateCounters(e){e<this.currentParagraphIndex&&this.reset(),this.currentParagraphIndex=e;var t=this.subDocument.paragraphs[e],r=t.getAbstractNumberingListIndex();return this.getCalculator(r).calculateNextCounters(t)}getCalculator(e){return this.calculators[e]||(this.calculators[e]=new Wo(this.subDocument.documentModel.abstractNumberingLists[e])),this.calculators[e]}reset(){this.calculators={},this.currentParagraphIndex=-1}}class SW extends $c{constructor(e,t,r,i,n,o,a,s,l){super(e,t,r,i,n,o,a),this.internalSubDocId=s,this.textBoxProperties=l}getType(){return lc.AnchorTextBox}clone(){const e=new SW(this.characterProperties,this.colorInfo,this.belongsToSubDocId,this.anchorInfo,this.shape,this.objectId,this.rotationInRadians,this.internalSubDocId,this.textBoxProperties);return e.copyFrom(this),e}renderGetContent(e){throw Error(R.D.NotImplemented)}}class IW extends qc{equals(e){return super.equals(e)&&this.text==e.text}constructor(e,t){super(e,t),!IW.renderCharacterProperties&&e&&(IW.renderCharacterProperties=new Ie,IW.renderCharacterProperties.fontSize=10,IW.renderCharacterProperties.fontInfo=this.characterProperties.fontInfo.clone(),IW.renderCharacterProperties.fontInfo.measurer=this.characterProperties.fontInfo.measurer,IW.renderCharacterProperties.fontInfo.name="Arial",IW.renderCharacterProperties.fontInfo.cssString="Arial",IW.renderCharacterProperties.fontInfo.scriptMultiplier=.65)}clone(){const e=new IW(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.text=e.text}getType(){return lc.PageBreak}pushInfoForMeasure(e,t){e.push(new Mg(this.getHiddenText(),this.renderGetCharacterProperties().initProps))}popInfoForMeasure(e,t){var r=e.pop();this.text=t?r.text:"&nbsp;",this.setSize(r.resultSize)}renderGetContent(e){return this.text}renderNoStrikeoutAndNoUnderlineIfBoxInEndRow(){return!0}renderGetCharacterProperties(){return IW.renderCharacterProperties.hidden=this.characterProperties.hidden,new Kc(IW.renderCharacterProperties,this.colorInfo)}isWhitespace(){return!1}isLineBreak(){return!0}getHiddenText(){return"........Page Break........"}}class PW extends IW{clone(){const e=new PW(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}getType(){return lc.ColumnBreak}getHiddenText(){return"........Column Break........"}isLineBreak(){return!0}}class wW extends qc{get isDashBox(){return!0}constructor(e,t,r){super(e,t),this.text=r}equals(e){return super.equals(e)&&this.text==e.text}getType(){return lc.Dash}clone(){const e=new wW(this.characterProperties,this.colorInfo,this.text);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.text=e.text}renderGetContent(e){return this.text}pushInfoForMeasure(e,t){e.push(new Eg(this.text,this.characterProperties))}popInfoForMeasure(e,t){this.setSize(e.pop().resultSize)}isVisible(){return!0}isVisibleForRowAlign(){return!0}renderIsWordBox(){return!0}isWhitespace(){return!1}isLineBreak(){return!1}}class yW extends qc{constructor(e,t,r){super(e,t),this.text=r}equals(e){return super.equals(e)&&this.text==e.text}clone(){const e=new yW(this.characterProperties,this.colorInfo,this.text);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.text=e.text}getType(){return lc.Text}pushInfoForMeasure(e,t){e.push(new Mg(this.text,this.characterProperties))}popInfoForMeasure(e,t){this.setSize(e.pop().resultSize)}isVisible(){return!0}isVisibleForRowAlign(){return!0}getLength(){return this.text.length}getCharOffsetXInPixels(e,t){if(0==t)return 0;if(t===this.getLength())return this.width;{const r=new Mg(this.text.substr(0,t),this.characterProperties);return e.measure([r]),r.resultSize.width}}calculateCharOffsetByPointX(e,t){const r=this.getBoxRanges(e),i=r.length;for(var n=0;n<i;n++)if(r[n].resultSize.width>t){const e=n>0?r[n].resultSize.width-r[n-1].resultSize.width:r[0].resultSize.width;(t-(n>0?r[n-1].resultSize.width:0))/e>.6&&n++;break}return n}splitByWidth(e,t,r){if(1==this.getLength())return super.splitByWidth(e,t,r);const i=this.getBoxRanges(e);for(let n,o=i.length-1;n=i[o];o--)if(n.resultSize.width<=t||0==o&&r){const t=this.clone();return t.text=t.text.substr(0,n.text.length),qc.initializeWithMeasurer([new fP(t,null)],e,!1),t}return null}splitBoxByPosition(e,t){const r=this.clone();return r.text=r.text.substr(t),this.text=this.text.substr(0,t),r.rowOffset=this.getEndPosition(),qc.initializeWithMeasurer([new fP(this,null),new fP(r,null)],e,!1),r}getCharIndex(e){return this.text.indexOf(e)}renderGetContent(e){return Tg.EncodeUtils.encodeHtml(this.text)}renderIsWordBox(){return!0}isWhitespace(){return!1}isLineBreak(){return!1}getBoxRanges(e){const t=[],r=this.text.length;for(let e=1;e<=r;e++)t.push(new Mg(this.text.substr(0,e),this.characterProperties));return e.measure(t),t}}!function(e){e[e.Page=0]="Page",e[e.Numpages=1]="Numpages"}(TV||(TV={}));class xW extends yW{clone(){const e=new xW(this.characterProperties,this.colorInfo,this.text);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.type=e.type}getType(){return lc.LayoutDependent}setType(e){this.type=e}calculateText(e){switch(this.type){case TV.Numpages:this.text=e.layout.lastMaxNumPages.toString(),e.activeFormatter.subDocument.isMain()||e.layoutDependentRunCache.add(e.activeFormatter.layoutPosition.pageIndex,e.activeFormatter.subDocument.id);break;case TV.Page:this.text=e.activeFormatter.layoutPosition.page.pageOrdinal.toString()}}isLineBreak(){return!1}}class TW extends qc{clone(){const e=new TW(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e)}getType(){return lc.FieldCodeStart}getBoxChar(){return"{"}pushInfoForMeasure(e,t){e.push(new Eg(this.getBoxChar(),this.characterProperties))}popInfoForMeasure(e,t){this.setSize(e.pop().resultSize)}isVisibleForRowAlign(){return!0}isVisible(){return!0}renderGetContent(e){return Tg.EncodeUtils.encodeHtml(this.getBoxChar())}isWhitespace(){return!1}isLineBreak(){return!1}}class vW extends TW{clone(){const e=new vW(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}getType(){return lc.FieldCodeEnd}getBoxChar(){return"}"}}class MW extends qc{getType(){return lc.FieldResultEnd}clone(){throw new Error(R.D.InternalException)}isWhitespace(){throw new Error(R.D.InternalException)}renderGetContent(e){throw new Error(R.D.InternalException)}pushInfoForMeasure(e,t){}popInfoForMeasure(e,t){}isLineBreak(){throw new Error(R.D.InternalException)}}class EW extends qc{equals(e){return super.equals(e)&&this.lineBreakSymbol==e.lineBreakSymbol}constructor(e,t){super(e,t),!EW.renderCharacterProperties&&e&&(EW.renderCharacterProperties=new Ie,EW.renderCharacterProperties.fontSize=8,EW.renderCharacterProperties.fontInfo=this.characterProperties.fontInfo.clone(),EW.renderCharacterProperties.fontInfo.measurer=this.characterProperties.fontInfo.measurer,EW.renderCharacterProperties.fontInfo.name="Arial",EW.renderCharacterProperties.fontInfo.cssString="Arial",EW.renderCharacterProperties.fontInfo.scriptMultiplier=.65)}clone(){const e=new EW(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.lineBreakSymbol=e.lineBreakSymbol}getType(){return lc.LineBreak}pushInfoForMeasure(e,t){e.push(new Eg("a",this.characterProperties))}popInfoForMeasure(e,t){this.lineBreakSymbol=t?an.specialCharacters.HiddenLineBreak:"&nbsp;",this.renderGetCharacterProperties(),this.setSize(e.pop().resultSize)}renderGetContent(e){return this.lineBreakSymbol}renderNoStrikeoutAndNoUnderlineIfBoxInEndRow(){return!0}renderGetCharacterProperties(){return EW.renderCharacterProperties.hidden=this.characterProperties.hidden,new Kc(EW.renderCharacterProperties,this.colorInfo)}isWhitespace(){return!1}isLineBreak(){return!0}}class DW extends qc{equals(e){return super.equals(e)&&this.spaceWidth==e.spaceWidth&&this.hiddenSpaceWidth==e.hiddenSpaceWidth}clone(){const e=new DW(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.spaceWidth=e.spaceWidth,this.hiddenSpaceWidth=e.hiddenSpaceWidth}getType(){return lc.NonBreakingSpace}pushInfoForMeasure(e,t){e.push(new Eg("&nbsp;",this.characterProperties)),t&&e.push(new Eg(DW.SYMBOL,this.characterProperties))}popInfoForMeasure(e,t){this.hiddenSpaceWidth=t?e.pop().resultSize.width:0;const r=e.pop();this.setSize(r.resultSize),this.spaceWidth=r.resultSize.width}isVisible(){return!0}isVisibleForRowAlign(){return!0}renderGetContent(e){const t=Math.ceil((this.width-this.hiddenSpaceWidth)/Math.max(1,this.spaceWidth));return(this.hiddenSpaceWidth>0?DW.SYMBOL:"")+rn.StringUtils.repeat("&nbsp;",t)}renderIsWordBox(){return!0}isWhitespace(){return!0}isLineBreak(){return!1}}DW.SYMBOL="˚";class FW extends qc{constructor(e,t,r){super(e,t),this.isLastParagraphInCell=r}equals(e){return super.equals(e)&&this.paragraphMarkSymbol==e.paragraphMarkSymbol&&this.isLastParagraphInCell==e.isLastParagraphInCell}clone(){const e=new FW(this.characterProperties,this.colorInfo,this.isLastParagraphInCell);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.paragraphMarkSymbol=e.paragraphMarkSymbol,this.isLastParagraphInCell=e.isLastParagraphInCell}getType(){return lc.ParagraphMark}pushInfoForMeasure(e,t){e.push(new Eg(this.getSymbolForMesure(),this.characterProperties))}popInfoForMeasure(e,t){this.paragraphMarkSymbol=this.getSymbol(t),this.setSize(e.pop().resultSize)}renderGetContent(e){return this.paragraphMarkSymbol}renderNoStrikeoutAndNoUnderlineIfBoxInEndRow(){return!0}isWhitespace(){return!1}isLineBreak(){return!0}getSymbolForMesure(){return this.isLastParagraphInCell?an.specialCharacters.CurrencySign:an.specialCharacters.HiddenParagraphMark}getSymbol(e){return e?this.getSymbolForMesure():"&nbsp;"}}class RW extends IW{get isSectionBreakBox(){return!0}clone(){const e=new RW(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}getType(){return lc.SectionMark}getHiddenText(){return"::::::::Section Break::::::::"}}class LW extends qc{equals(e){return super.equals(e)&&this.spaceWidth==e.spaceWidth&&this.hiddenSpaceWidth==e.hiddenSpaceWidth}clone(){const e=new LW(this.characterProperties,this.colorInfo);return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.spaceWidth=e.spaceWidth,this.hiddenSpaceWidth=e.hiddenSpaceWidth}getType(){return lc.Space}pushInfoForMeasure(e,t){e.push(new Eg(an.specialCharacters.Space,this.characterProperties)),t&&e.push(new Eg(an.specialCharacters.HiddenSpace,this.characterProperties))}popInfoForMeasure(e,t){this.hiddenSpaceWidth=t?e.pop().resultSize.width:0;const r=e.pop();this.setSize(r.resultSize),this.spaceWidth=r.resultSize.width}isVisible(){return!0}renderGetContent(e){const t=Math.ceil((this.width-this.hiddenSpaceWidth)/Math.max(1,this.spaceWidth));return(this.hiddenSpaceWidth>0?an.specialCharacters.HiddenSpace:"")+rn.StringUtils.repeat("&nbsp;",t)}renderNoStrikeoutAndNoUnderlineIfBoxInEndRow(){return!0}isWhitespace(){return!0}isLineBreak(){return!1}}class BW{constructor(){this.conflictNameResolution=vV.Rename,this.visibility=MV.Auto,this.color="rgb(127, 127, 127)"}copyFrom(e){this.conflictNameResolution=e.conflictNameResolution,this.visibility=e.visibility,this.color=e.color}clone(){const e=new BW;return e.copyFrom(this),e}}!function(e){e[e.Keep=0]="Keep",e[e.Rename=1]="Rename",e[e.Skip=2]="Skip"}(vV||(vV={})),function(e){e[e.Auto=0]="Auto",e[e.Visible=1]="Visible",e[e.Hidden=2]="Hidden"}(MV||(MV={})),function(e){e[e.StartBox=0]="StartBox",e[e.EndBox=1]="EndBox"}(EV||(EV={}));class AW extends Va.Rectangle{constructor(e){super(0,0,0,0),this.boxType=EV.StartBox,this.color="",this.boxType=e}equals(e){return super.equals(e)&&this.color==e.color&&this.boxType==e.boxType}}AW.DEFAULT_WIDTH=3,AW.DEFAULT_BORDER_WIDTH=2;class NW{static findLastVisibleBoxIndex(e,t,r){return f.ListUtils.reverseIndexBy(e,(e=>e.isVisibleForRowAlign()),t,r)}static align(e,t,r,i,n){switch(t){case Ae.Right:NW.alignRightCenter(NW.getBoxes(e,i),r,1);break;case Ae.Center:NW.alignRightCenter(NW.getBoxes(e,i),r,2);break;case Ae.Justify:case Ae.JustifyHigh:case Ae.JustifyLow:case Ae.JustifyMedium:case Ae.Distribute:case Ae.ThaiDistribute:NW.alignJustify(NW.getBoxes(e,i),r,n);break;case Ae.Left:break;default:throw new Error(R.D.InternalException)}}static getBoxes(e,t){if(t)return e.boxes.slice(t);if(!e.numberingListBox)return e.boxes;const r=e.boxes.slice();return e.numberingListBox.separatorBox&&r.unshift(e.numberingListBox.separatorBox),r.unshift(e.numberingListBox.textBox),r}static alignRightCenter(e,t,r){let i=NW.calculateFreeSpace(e,NW.findLastVisibleBoxIndex(e),t);if(r>1&&(i=Math.floor(i/r)),i>0)for(let t of e)t.x+=i}static alignJustify(e,t,r){switch(f.ListUtils.last(e).getType()){case lc.ParagraphMark:case lc.ColumnBreak:case lc.PageBreak:case lc.SectionMark:return;case lc.LineBreak:if(r)return}const i=e[e.length-2],n=NW.findLastVisibleBoxIndex(e);if(i&&(i.getType()==lc.ParagraphMark||i.getType()==lc.PageBreak)||i&&i.getType()==lc.PageBreak||n<0)return;const o=NW.firstNonSpaceBoxIndex(e);if(o<0)return;let a=0;for(let t=o+1;t<=n;t++){const r=e[t];r.getType()==lc.Space&&(a+=r.width)}const s=NW.calculateFreeSpace(e,n,t);if(0==a||s<=0)return;let l=e[o].right;for(let t=o+1;t<=n;t++){const r=e[t];r.x=l;r.getType()==lc.Space&&(r.width+=s*r.width/a),l+=r.width}for(let t,r=n+1;t=e[r];r++)t.x=l,l+=t.width}static calculateFreeSpace(e,t,r){return r-(t>=0?e[t].right:e[0].x)}static firstNonSpaceBoxIndex(e){let t=-1;for(let r=e.length-1;r>=0;r--)switch(e[r].getType()){case lc.TabSpace:return t;case lc.Space:case lc.NonBreakingSpace:break;default:t=r}return t}}!function(e){e[e.None=0]="None",e[e.NotEnoughChunks=1]="NotEnoughChunks"}(DV||(DV={})),function(e){e[e.None=0]="None",e[e.Open=1]="Open",e[e.Close=2]="Close"}(FV||(FV={}));class kW{get rowStartPos(){return this.rowFormatter.rowSizesManager.rowStartPos}constructor(e,t){this.rowFormatter=e,this.newAnchoredObjects=[],this.row=new pW(t),this.startRowFormatting(!0)}startRowFormatting(e){this.flags=new pr.Flag(DV.None),this.row.boxes=[],this.rowBoxIndexStart=0,e&&(this.newAnchoredObjects=[])}finishLogicalRow(e){if(this.rowBoxIndexStart==this.row.boxes.length)return;this.rowFormatter.tabInfo.shiftBoxesAfterLastTab();const t=this.rowFormatter.manager.model.compatibilitySettings.dontJustifyLinesEndingInSoftLineBreak;NW.align(this.row,this.rowFormatter.paragraphProps.alignment,e,this.rowBoxIndexStart,t),this.rowBoxIndexStart=this.row.boxes.length}deleteSomeAnchorObjects(e,t){this.newAnchoredObjects.splice(e),this.rowFormatter.iterator.setPosition(t,!1,!1)}finishRow(){this.finishLogicalRow(this.rowFormatter.rowSizesManager.rowFormattingInfo.lastNonEmptyInterval.end);const e=f.ListUtils.last(this.row.boxes).rowOffset;for(let t,r=0;t=this.newAnchoredObjects[r];r++){if(t.rowOffset>e){this.deleteSomeAnchorObjects(r,t.rowOffset);break}if(t.levelType==dc.InText){this.deleteSomeAnchorObjects(r+1,t.rowOffset+1);break}}const t=this.rowFormatter.subDocument.paragraphs;this.row.applySpacingAfter(this.row.flags.get(xV.ParagraphEnd)?pW.getParagraphSpacingAfter(t[this.paragraphIndex],t[this.paragraphIndex+1]):0);const r=this.rowFormatter.rowSizesManager.rowStartPos;for(let e of this.row.boxes)e.x-=this.row.x,e.rowOffset-=r;const i=this.row.boxes.length?f.ListUtils.last(this.row.boxes).getEndPosition():0;this.addBrackets(r,i),this.row.numberingListBox&&(this.row.numberingListBox.textBox.x-=this.row.x,this.row.numberingListBox.separatorBox&&(this.row.numberingListBox.separatorBox.x-=this.row.x)),this.row.columnOffset=r-this.rowFormatter.manager.activeFormatter.layoutPosition.getLogPosition(Hu.Column);const n=this.onlyInlinePictureBox();n&&n.width>this.row.width&&(this.row.width=n.width);const o=this.rowFormatter.rowSizesManager.heightCalculator.currState;this.row.increaseRowHeightFromSpacingBeforeAndAfter(o.maxAscent,o.maxDescent)}onlyInlinePictureBox(){let e;for(let t=this.row.boxes.length-1;t>=0;t--){const r=this.row.boxes[t];if(r.getType()==lc.Picture)e=r;else if(!I.Y.isAnyOf(r.getType(),lc.ParagraphMark,lc.SectionMark,lc.LineBreak,lc.PageBreak))return null}return e}addBracketBox(e,t,r,i){const n=new AW(e);n.x=r-(e==EV.EndBox?AW.DEFAULT_BORDER_WIDTH:0),n.y=this.row.baseLine-i.getAscent()-this.row.getSpacingBefore(),n.width=AW.DEFAULT_WIDTH,n.height=i.height,n.color=t,this.row.bookmarkBoxes.push(n)}addBrackets(e,t){if(!this.row.boxes[0])return;const r=e+t;f.ListUtils.forEach(this.rowFormatter.iterator.getBracketInfo(e,t),(t=>{const i=t.absPos-e,n=this.getBracketBox(i),o=this.getBracketXPosition(i,n);t.flags.get(FV.Open)&&t.absPos<r&&this.addBracketBox(EV.StartBox,t.color,o,n),t.flags.get(FV.Close)&&(0!=t.length&&t.absPos>e||0==t.length&&t.absPos<=e)&&this.addBracketBox(EV.EndBox,t.color,o+(0==t.length?AW.DEFAULT_BORDER_WIDTH:0),n)}))}getBracketBox(e){const t=this.row.boxes;return t[Math.max(0,C.SearchUtils.normedInterpolationIndexOf(t,(e=>e.rowOffset),e))]}getBracketXPosition(e,t){const r=P.MathUtils.restrictValue(e-t.rowOffset,0,t.getLength());return t.x+t.getCharOffsetXInPixels(this.rowFormatter.manager.measurer,r)}}class OW{constructor(e){this.objects=e}init(e){this.index=C.SearchUtils.normedInterpolationIndexOf(this.objects,(e=>this.getPosition(e)),e),this.updateNextObjPos()}update(e){if(e<this.nextObjPosition)return!1;for(;this.getPosition(this.objects[++this.index])<e;);return this.updateNextObjPos(),!0}updateNextObjPos(){const e=this.objects[this.index+1];this.nextObjPosition=e?this.getPosition(e):Number.MAX_VALUE}}class _W extends OW{getPosition(e){return e.startLogPosition.value}}class UW extends OW{getPosition(e){return e.startLogPosition.value}}class HW{static get MAX_NUM_NEW_BOXES(){return VW.AVERAGE_BOXES_ON_PAGE}get colorProvider(){return this.manager.model.colorProvider}constructor(e,t){this.positionFromStartGenerate=-1,this.waitForMoreChunks=!1,HW.modelCharToLayoutBoxConverter||(HW.modelCharToLayoutBoxConverter={[an.specialCharacters.LineBreak]:function(e,t){return new EW(e,e.getLayoutColorInfo(t))},[an.specialCharacters.Space]:function(e,t){return new LW(e,e.getLayoutColorInfo(t))},[an.specialCharacters.TabMark]:function(e,t){return new Fg(e,e.getLayoutColorInfo(t))},[an.specialCharacters.PageBreak]:function(e,t){return new IW(e,e.getLayoutColorInfo(t))},[an.specialCharacters.ColumnBreak]:function(e,t){return new PW(e,e.getLayoutColorInfo(t))},[an.specialCharacters.NonBreakingSpace]:function(e,t){return new DW(e,e.getLayoutColorInfo(t))}},HW.MapFieldCodeToLayoutDependentBoxType={PAGE:TV.Page,NUMPAGES:TV.Numpages}),this.manager=e,this.boxWrapsHolder=t}isNotEmptyParagraphOrSectionRunBeforeTable(e){const t=this.newWrappers&&this.newWrappers.length,r=t&&!f.ListUtils.last(this.newWrappers).info.tablePosition;return t&&r&&(e.getType()==lc.ParagraphMark||e.getType()!=lc.SectionMark)&&this.modelIterator.getAbsolutePosition()==this.tableIterator.getNextObjectPosition()}addNewBoxInfo(e,t=this.modelIterator.charOffset){e.rowOffset=this.getAbsolutePosition(t)-e.getLength();if(e.characterProperties.hidden&&!this.manager.innerClientProperties.showHiddenSymbols&&this.isLastParagraphBoxInSubDocumentVisible(e)&&this.isTableCellConsiderAtLeastOneBox(this.currWrapInfo,e)&&!this.isNotEmptyParagraphOrSectionRunBeforeTable(e)||HW.isFieldHideElement(this.currWrapInfo,e)||this.currWrapInfo.tablePosition&&(f.ListUtils.unsafeAnyOf(this.currWrapInfo.tablePosition,(e=>e.cell.verticalMerging==Xe.Continue))||I.Y.isAnyOf(e.getType(),lc.SectionMark,lc.PageBreak,lc.ColumnBreak)))return null;const r=new fP(e,this.currWrapInfo);return this.addToBoxFieldInfo(r),this.newWrappers.push(r),r}generate(){if(!this.init())return!1;const e=this.modelIterator.getAbsolutePosition();return this.updateBracketsInfo(),this.waitForMoreChunks?f.ListUtils.last(this.chunks).getEndPosition()>e&&this.updatePosSecondaryIterators(e):this.newWrappers=[],this.offsetStartWordAtStartRun=this.modelIterator.charOffset,this.currBoxInfoType=lc.Text,this.waitForMoreChunks=!1,this.createNewBoxes(),!this.waitForMoreChunks&&(qc.initializeWithMeasurer(this.newWrappers,this.manager.measurer,this.manager.innerClientProperties.showHiddenSymbols),this.boxWrapsHolder.setNewWrappers(this.newWrappers,e),this.newWrappers.length>0)}updateBracketsInfo(){this.boxWrapsHolder.bracketsInfo=[];const e=this.boxWrapsHolder.manager.bookmarksSettings,t=this.boxWrapsHolder.manager.documentProtectionSettings;e.visibility==MV.Visible&&this.collectObjectBrackets(this.subDocument.bookmarks,e.color,(e=>!e.isHidden())),this.boxWrapsHolder.manager.documentProtectionSettings.showBrackets&&this.collectObjectBrackets(this.subDocument.availableRangePermissions,t.rangeHighlightBracketsColor,(()=>!0));const r=(e,t)=>{const r=e.absPos-t.absPos;return r||(e.color==t.color?0:-1)};this.boxWrapsHolder.bracketsInfo=f.ListUtils.merge(this.boxWrapsHolder.bracketsInfo,r,((e,t)=>0==r(e,t)),((e,t)=>e.flags.set(t.flags.getValue(),!0)))}collectObjectBrackets(e,t,r){const i=this.boxWrapsHolder.bracketsInfo;f.ListUtils.forEach(e,(e=>{r(e)&&(i.push(new zW(e.start,new pr.Flag(FV.Open),t,e.interval.length)),i.push(new zW(e.end,new pr.Flag(FV.Close),t,e.interval.length)))}))}get subDocument(){return this.boxWrapsHolder.subDocument}get chunks(){return this.subDocument.chunks}updatePosSecondaryIterators(e){this.paragraphIterator.init(e),this.sectionIterator.init(e),this.tableIterator.init(e),this.fieldIterator.init(e)}init(){const e=this.positionFromStartGenerate;if(this.subDocument.isMain()&&f.ListUtils.last(this.chunks).getEndPosition()==e)return!1;if(-1==e)return!0;if(this.modelIterator=new jh(this.subDocument,!1),this.modelIterator.setPosition(e),e>=this.modelIterator.chunk.getEndPosition())return!1;this.paragraphIterator=new _W(this.subDocument.paragraphs),this.sectionIterator=new UW(this.manager.model.sections),this.tableIterator=new IP(this.subDocument.tables),this.fieldIterator=new PP(this.subDocument.fields),this.updatePosSecondaryIterators(e),this.currWrapInfo=new bP(this.paragraphIterator.index,this.sectionIterator.index,this.tableIterator.generateInfo(e),this.fieldIterator.generateInfo(e)),this.positionFromStartGenerate=-1;const t=f.ListUtils.last(this.chunks);return this.lastModelPosition=f.ListUtils.last(this.chunks).isLast||!this.subDocument.isMain()?t.getEndPosition()-1:Number.MAX_VALUE,!0}isLastParagraphBoxInSubDocumentVisible(e){if(e.rowOffset!=this.lastModelPosition)return!0;const t=f.ListUtils.last(this.newWrappers);return t&&t.box.getType()==lc.ParagraphMark}isTableCellConsiderAtLeastOneBox(e,t){if(!e.tablePosition||t.getType()!=lc.ParagraphMark||f.ListUtils.last(e.tablePosition).cell.endParagrapPosition.value-1!=t.rowOffset)return!0;for(let t,r=this.newWrappers.length-1;(t=this.newWrappers[r])&&(t&&t.info.tablePosition&&!(t.info.tablePosition.length<e.tablePosition.length));r--)if(t.info.tablePosition.length==e.tablePosition.length)return t.box.getType()==lc.ParagraphMark&&f.ListUtils.allOf2(e.tablePosition,t.info.tablePosition,((e,t)=>e.equals(t)));return!1}static isFieldHideElement(e,t){const r=e.fieldsInfo;return r&&(f.ListUtils.unsafeAnyOf(r,(e=>!e.field.showCode&&e.isInCodePart||e.field.showCode&&!e.isInCodePart))||t.getType()==lc.FieldResultEnd)}addToBoxFieldInfo(e){const t=e.info.fieldsInfo;if(t){for(let r,i=t.length-1;r=t[i];i--)if(r.field.isHyperlinkField()&&!r.isInCodePart&&this.boxWrapsHolder.manager.activeSubDocument===this.subDocument){const t=r.field.getHyperlinkInfo();""!=t.tip?e.box.hyperlinkTip=t.tip:""!=t.uri?e.box.hyperlinkTip=t.uri+(""==t.anchor?"":"#"+t.anchor):""!=t.anchor?e.box.hyperlinkTip="_"==t.anchor[0]?this.manager.stringResources.commonLabels.currentDocumentHyperlinkTooltip:"#"+t.anchor:e.box.hyperlinkTip="";break}f.ListUtils.unsafeAnyOf(t,(e=>e.isInCodePart))&&(e.box.fieldLevel=t.length),e.box.getType()==lc.LayoutDependent&&e.box.setType(HW.MapFieldCodeToLayoutDependentBoxType[this.getFieldType(f.ListUtils.last(t))])}}getFieldType(e){return e.fieldType||(e.fieldType=rn.StringUtils.trim(this.subDocument.getText(e.field.getCodeInterval()).split("\\")[0]).toUpperCase()),e.fieldType}getAbsolutePosition(e){return this.chunk.startLogPosition.value+this.run.startOffset+e}get run(){return this.modelIterator.run}get chunk(){return this.modelIterator.chunk}createNewBoxes(){for(;this.newWrappers.length<HW.MAX_NUM_NEW_BOXES||this.currWrapInfo.tablePosition||this.offsetStartWordAtStartRun!=this.modelIterator.charOffset;){if(this.modelIterator.charOffset>=this.run.getLength()&&!this.getNextRun())return void(this.chunk.isLast?this.boxWrapsHolder.flags.set(RV.DocumentEnd,!0):this.waitForMoreChunks=!!this.currWrapInfo.tablePosition);this.parseByChar()}}parseByChar(){const e=this.modelIterator.getCurrentChar();switch(e){case an.specialCharacters.Space:case an.specialCharacters.NonBreakingSpace:case an.specialCharacters.TabMark:case an.specialCharacters.LineBreak:case an.specialCharacters.PageBreak:case an.specialCharacters.ColumnBreak:this.makeBreakBox(e);break;case an.specialCharacters.Dash:case an.specialCharacters.EmDash:case an.specialCharacters.EnDash:this.makeDashBox();break;default:this.parseByRunType()}}parseByRunType(){switch(this.run.getType()){case cs.ParagraphRun:case cs.SectionRun:this.makeParagraphAndSectionBox();break;case cs.InlinePictureRun:this.makeInlinePictureBox();break;case cs.InlineTextBoxRun:throw new Error(R.D.NotImplemented);case cs.AnchoredPictureRun:this.makeAnchoredPictureRun();break;case cs.AnchoredTextBoxRun:this.makeAnchoredTextBoxRun();break;case cs.FieldCodeStartRun:this.makeFieldCodeStartRun();break;case cs.FieldCodeEndRun:this.makeFieldCodeEndRun();break;case cs.FieldResultEndRun:this.makeFieldResultEndRun();break;case cs.LayoutDependentRun:this.makeLayoutDependentRun();break;case cs.FootNoteRun:case cs.EndNoteRun:this.skipCurrentRun();break;default:this.makeDefault()}}makeBreakBox(e){this.currWordToBox(),this.modelIterator.charOffset++,this.addNewBoxInfo(HW.modelCharToLayoutBoxConverter[e](this.getActualCharacterProperties(),this.colorProvider)),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}makeDashBox(){this.currBoxInfoType!=lc.Dash&&(this.currWordToBox(),this.currBoxInfoType=lc.Dash,this.offsetStartWordAtStartRun=this.modelIterator.charOffset),this.modelIterator.charOffset++}makeParagraphAndSectionBox(){this.modelIterator.charOffset++;const e=this.run.getCharacterMergedProperties();this.addNewBoxInfo(this.run.getType()==cs.ParagraphRun?new FW(e,e.getLayoutColorInfo(this.colorProvider),this.isLastParagraphInCell()):new RW(e,e.getLayoutColorInfo(this.colorProvider))),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}isLastParagraphInCell(){const e=this.run.paragraph,t=e.getTableCell();return!!t&&e.getEndPosition()==t.interval.end}skipCurrentRun(){this.modelIterator.charOffset=this.run.getLength(),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}makeInlinePictureBox(){const e=this.run;this.modelIterator.charOffset++;const t=e.getCharacterMergedProperties();this.addNewBoxInfo(new LE(t,t.getLayoutColorInfo(this.colorProvider),e.cacheInfo,e.getActualSize().applyConverter(g.u.twipsToPixelsF),e.info.nonVisualDrawingProperties.description)),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}makeAnchoredPictureRun(){const e=this.run;if(this.modelIterator.charOffset++,e.anchorInfo.hidden)return;const t=e.getCharacterMergedProperties();this.addNewBoxInfo(new oH(t,t.getLayoutColorInfo(this.colorProvider),this.subDocument.id,e.anchorInfo.clone(),e.shape.clone().applyConverter(g.u.twipsToPixelsF),e.anchoredObjectID,g.u.twipsToRadians(e.size.rotation),e.cacheInfo,e.info.nonVisualDrawingProperties.description).setPosition(new Xc.Point(0,0)).setSize(e.getActualSize().applyConverter(g.u.twipsToPixelsF))),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}static createLayoutAnchoredTextBoxFromRun(e,t,r){return new SW(e.getCharacterMergedProperties(),e.getCharacterMergedProperties().getLayoutColorInfo(r),t,e.anchorInfo.clone(),e.shape.clone().applyConverter(g.u.twipsToPixelsF),e.anchoredObjectID,g.u.twipsToRadians(e.size.rotation),e.subDocId,e.textBoxProperties.clone().setMarginsToAnotherMeasuringSystem(g.u.twipsToPixelsF))}makeAnchoredTextBoxRun(){const e=this.run;if(this.modelIterator.charOffset++,!e.anchorInfo.hidden){const t=this.addNewBoxInfo(HW.createLayoutAnchoredTextBoxFromRun(e,this.subDocument.id,this.colorProvider));t&&(this.manager.anchoredObjectsManager.textBoxContextSizeCalculators[e.anchoredObjectID]=new hW(t,e.size,this.subDocument.documentModel.compatibilitySettings.getActualLayoutInTableCell(e.anchorInfo)))}this.offsetStartWordAtStartRun=this.modelIterator.charOffset}makeFieldCodeStartRun(){this.modelIterator.charOffset++;const e=this.run.getCharacterMergedProperties();this.addNewBoxInfo(new TW(e,e.getLayoutColorInfo(this.colorProvider))),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}makeFieldCodeEndRun(){this.modelIterator.charOffset++;const e=this.run.getCharacterMergedProperties();this.addNewBoxInfo(new vW(e,e.getLayoutColorInfo(this.colorProvider))),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}makeFieldResultEndRun(){this.modelIterator.charOffset++;const e=this.run.getCharacterMergedProperties();this.addNewBoxInfo(new MW(e,e.getLayoutColorInfo(this.colorProvider))),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}makeLayoutDependentRun(){this.modelIterator.charOffset++;const e=this.run.getCharacterMergedProperties();this.addNewBoxInfo(new xW(this.run.getCharacterMergedProperties(),e.getLayoutColorInfo(this.colorProvider),this.modelIterator.getRunText())),this.offsetStartWordAtStartRun=this.modelIterator.charOffset}makeDefault(){this.currBoxInfoType==lc.Dash&&(this.currWordToBox(),this.offsetStartWordAtStartRun=this.modelIterator.charOffset),this.modelIterator.charOffset++}currWordToBox(){const e=this.currBoxInfoType==lc.Text?HW.MAX_BOX_LENGTH:1;if(this.modelIterator.charOffset>this.offsetStartWordAtStartRun){let t=this.offsetStartWordAtStartRun;do{const r=Math.min(e,this.modelIterator.charOffset-t),i=this.modelIterator.getRunText(t,r);t+=r;const n=this.getActualCharacterProperties();this.currBoxInfoType==lc.Text?this.addNewBoxInfo(new yW(n,n.getLayoutColorInfo(this.colorProvider),i),t):this.addNewBoxInfo(new wW(n,n.getLayoutColorInfo(this.colorProvider),i),t)}while(t<this.modelIterator.charOffset)}this.currBoxInfoType=lc.Text}getActualCharacterProperties(){const e=this.currWrapInfo.fieldsInfo;if(e){let t=!1;for(let r,i=0;r=e[i];i++)if(t){if(r.field.isHyperlinkField()&&this.run.characterStyle.styleName==zl.hyperlinkStyleName){const e=new Ii;e.mergeMergedCharacterProperties(this.run.mergeCharacterProperties({excludeCharacterStyle:!0}));const t=this.run.characterStyle,r=t.maskedCharacterProperties.clone();return r.setUseValue(ie.UseUnderlineColorIndex,!1),r.setUseValue(ie.UseForeColorIndex,!1),e.mergeCharacterProperties(r),e.mergeCharacterStyle(t.parent),e.getMergedProperties()}}else{if(r.field.isHyperlinkField()){if(r.field.getHyperlinkInfo().visited){const e=this.run.getCharacterMergedProperties().clone();return e.textColor=he.makeByColor(w.i.fromHashString("#483D8B")),e}break}t="TOC"==this.getFieldType(r)}}return this.run.getCharacterMergedProperties()}getNextRun(){this.currWordToBox();const e=this.modelIterator.run;if(!this.modelIterator.moveToNextRun())return!1;const t=this.modelIterator.getAbsolutePosition();let r=!1;return this.paragraphIterator.update(t)&&(this.subDocument.isMain()&&this.sectionIterator.update(t),this.tableIterator.update(t),r=!0),(this.fieldIterator.update(t)||e.getType()==cs.FieldCodeEndRun)&&(r=!0),r&&(this.currWrapInfo=new bP(this.paragraphIterator.index,this.sectionIterator.index,this.tableIterator.generateInfo(t),this.fieldIterator.generateInfo(t))),this.offsetStartWordAtStartRun=0,!0}}HW.MAX_BOX_LENGTH=50,function(e){e[e.None=0]="None",e[e.DocumentEnd=1]="DocumentEnd"}(RV||(RV={}));class VW{constructor(e,t){this.manager=e,this.subDocument=e.model.subDocuments[t],this.boxGenerator=new HW(e,this)}reset(e){this.wrappers=[],this.wrapIndex=0,this.flags=new pr.Flag(RV.None),this.boxGenerator.positionFromStartGenerate=e,this.boxGenerator.waitForMoreChunks=!1,this.boxGenerator.generate(),this.getWrap(),O.print(L.BoxWrapHolder,"reset",(()=>`wrappers.length:${this.wrappers.length}, subDocId: ${this.subDocument.id}`))}getWrap(){if(this.wrapIndex<this.wrappers.length||this.boxGenerator.generate()){const e=this.wrappers[this.wrapIndex];return this.currPos=e.box.rowOffset,O.print(L.BoxWrapHolder,"getWrap",(()=>`currPos: ${this.currPos}, wrapInd: ${this.wrapIndex}, subDocId: ${this.subDocument.id}`)),e}const e=f.ListUtils.last(this.wrappers);return this.currPos=e?e.box.getEndPosition():this.subDocument.getDocumentEndPosition(),O.print(L.BoxWrapHolder,"getWrap",(()=>`currPos: ${this.currPos}, wrapInd: ${this.wrapIndex}, subDocId: ${this.subDocument.id}`)),null}get position(){return this.currPos}setPosition(e,t){!t&&this.trySetPosition(e)||this.reset(e)}toNextWrap(){this.wrapIndex++,this.getWrap()}setParagraphsWidthInfo(e){this.paragraphBoundsInfo={};let t,r,i=-1,n=null;for(let o of e){if(o.info.tablePosition){if(o.info.paragraphIndex!=i&&(i=o.info.paragraphIndex,n=new xl.MinMaxNumber(0,0),this.paragraphBoundsInfo[i]=n,t=0,r=0),o.box.getType()==lc.AnchorTextBox){this.manager.anchoredObjectsManager.textBoxContextSizeCalculators[o.box.objectId].paragraphMinMax=n;continue}o.box.isLineBreak()?r=0:(r+=o.box.width,n.maxElement=Math.max(n.maxElement,r)),o.box.isLineBreak()||o.box.isWhitespace()||o.box.isDashBox?t=0:(t+=o.box.width,n.minElement=Math.max(n.minElement,t))}}}setNewWrappers(e,t){if(!e.length)return;f.ListUtils.addListOnTail(this.wrappers,e);const r=this.wrappers.length-VW.MAX_BOXES_IN_LIST;if(r>0){const e=this.wrappers[r-1],i=this.wrappers[r];!(e.box.getEndPosition()<=t)||i&&i.info.tablePosition||(this.wrappers.splice(0,r),this.wrapIndex=Math.max(0,this.wrapIndex-r))}O.print(L.BoxWrapHolder,"setNewWrappers",(()=>`wrappers.length:${this.wrappers.length}, subDocId: ${this.subDocument.id}`)),this.setParagraphsWidthInfo(this.wrappers)}setNextValidWrapPosition(e,t){if(this.interval.contains(e)){this.wrapIndex=C.SearchUtils.normedInterpolationIndexOf(this.wrappers,(e=>e.box.rowOffset),e);let r=this.wrappers[this.wrapIndex];const i=this.wrappers.length;for(;r.info.getTableNestedLevel()>=t&&this.wrapIndex<i-1;)r=this.wrappers[++this.wrapIndex];this.currPos=r.box.getEndPosition()}else this.reset(e)}trySetPosition(e){if(!this.interval.contains(e))return!1;this.wrapIndex=C.SearchUtils.normedInterpolationIndexOf(this.wrappers,(e=>e.box.rowOffset),e);const t=this.wrappers[this.wrapIndex];if(e>=t.box.getEndPosition())return this.currPos=this.wrappers[++this.wrapIndex].box.rowOffset,!0;const r=e-t.box.rowOffset;return r>0&&this.splitBoxByPosition(t,r),this.currPos=this.wrappers[this.wrapIndex].box.rowOffset,!0}splitBoxByPosition(e,t){const r=e.splitByPosition(this.manager.measurer,t);r&&(this.wrapIndex++,this.wrappers.splice(this.wrapIndex,0,r))}get interval(){return this.wrappers.length?on.FixedInterval.fromPositions(this.wrappers[0].box.rowOffset,f.ListUtils.last(this.wrappers).box.getEndPosition()):new on.FixedInterval(0,0)}}VW.AVERAGE_BOXES_ON_PAGE=2e3,VW.MAX_BOXES_IN_LIST_MULTIPLIER=3,VW.MAX_BOXES_IN_LIST=VW.AVERAGE_BOXES_ON_PAGE*VW.MAX_BOXES_IN_LIST_MULTIPLIER;class WW{constructor(e,t){this.boxWrapsHolder=new VW(e,t)}get subDocument(){return this.boxWrapsHolder.subDocument}setNextValidWrapPosition(e,t){this.boxWrapsHolder.setNextValidWrapPosition(e,t)}allBoxesGiven(){return this.boxWrapsHolder.flags.get(RV.DocumentEnd)}getPosition(){return this.boxWrapsHolder.position}setPosition(e,t,r){if((t||e!=this.boxWrapsHolder.position)&&this.boxWrapsHolder.setPosition(e,t),r&&O.isEnabled){const e=this.boxWrapsHolder.getWrap();e&&e.info.tablePosition&&new Ya(0,0).equals(e.info.tablePosition[0])}}documentStart(){this.boxWrapsHolder.reset(0)}getWrap(e){return this.boxWrapsHolder.getWrap()&&e&&this.boxWrapsHolder.toNextWrap(),this.boxWrapsHolder.getWrap()}getBracketInfo(e,t){const r=new on.FixedInterval(e,t),i=e+t;let n=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(this.boxWrapsHolder.bracketsInfo,(e=>e.absPos),e));const o=[];for(let e;(e=this.boxWrapsHolder.bracketsInfo[n])&&!(e.absPos>i);n++)r.containsWithIntervalEnd(e.absPos)&&o.push(e);return o}getParagraphBounds(e){return this.boxWrapsHolder.paragraphBoundsInfo[e]}}class zW{constructor(e,t,r,i){this.absPos=e,this.flags=t,this.color=r,this.length=i}addFlagValue(e){this.flags.set(e,!0)}}class jW extends qc{getFont(e){let t=e.getItemByName("Arial");return t||(t=e.getItemByName("Times New Roman"),t||(t=e.getItemByName("Calibri"))),t}constructor(e,t,r,i,n,o=en.Left,a){if(super(e,t),this.textBox=new yW(e,t,r),this.alignment=o,"\0"!=i){let r=e.clone(),o=null;switch(a&&(o=this.getFont(a)),o||(o=e.fontInfo.clone(),o.measurer=e.fontInfo.measurer,o.name="Arial",o.cssString="Arial"),r.fontInfo=o,n&&(r=n.getItem(r)),i){case an.specialCharacters.TabMark:this.separatorBox=new Fg(r,t);break;case an.specialCharacters.Space:case an.specialCharacters.EmSpace:case an.specialCharacters.EnSpace:this.separatorBox=new LW(r,t)}}}equals(e){return e&&super.equals(e)&&this.textBox.equals(e.textBox)&&(!this.separatorBox&&!e.separatorBox||this.separatorBox&&e.separatorBox&&this.separatorBox.equals(e.separatorBox))}clone(){const e=new jW(this.characterProperties,this.colorInfo,"0","\0");return e.copyFrom(this),e}copyFrom(e){super.copyFrom(e),this.textBox=e.textBox.clone(),this.separatorBox=e.separatorBox.clone()}getType(){return lc.NumberingList}pushInfoForMeasure(e,t){this.textBox.pushInfoForMeasure(e,t),this.separatorBox&&this.separatorBox.pushInfoForMeasure(e,t)}popInfoForMeasure(e,t){this.separatorBox&&(this.separatorBox.popInfoForMeasure(e,t),this.separatorBox instanceof Fg&&(this.separatorBox=this.separatorBox.getLayoutTabBox(Sg.None))),this.textBox.popInfoForMeasure(e,t)}isWhitespace(){throw new Error(R.D.InternalException)}renderGetContent(e){throw new Error(R.D.InternalException)}isLineBreak(){throw new Error(R.D.InternalException)}}class XW{static areClose(e,t){const r=e-t;return 0==r||Math.abs(r)<this.epsilon}static lessThan(e,t){return e<t&&!this.areClose(e,t)}static greaterThan(e,t){return e>t&&!this.areClose(e,t)}}XW.epsilon=153e-8;class GW{static getNonCollapsedIntersection(e,t){const r=Va.Rectangle.getIntersection(e,t);return r&&!this.isCollapsed(r)?r:null}static isCollapsed(e){return e.isCollapsed()||XW.areClose(e.x,e.right)||XW.areClose(e.y,e.bottom)}}class KW extends on.FixedInterval{constructor(e,t,r=t){super(e,t),this.avaliableWidth=r}get busyWidth(){return this.length-this.avaliableWidth}get startOfFreeSpace(){return this.start+this.busyWidth}isConsiderBoxes(){return this.avaliableWidth!=this.length}}class qW{get isFloatingIntersectRow(){return!!this.intersectsObjects.length}get lastNonEmptyInterval(){return this.intervals[this.lastNonEmptyIntervalIndex]}constructor(e,t,r,i,n){this.intervals=[],this.busyIntervals=[],this.currIndex=0,this.minY=e,this.height=Math.max(1,t),this.outerHorizontalRowContentBounds=r,this.boundsOfAnchoredOblectsOnThisColumn=i,this.tableCell=n,this.lastNonEmptyIntervalIndex=0}get currInterval(){return this.intervals[this.currIndex]}indexOfFreeInterval(e){return f.ListUtils.indexBy(this.intervals,(t=>t.avaliableWidth>=e),this.currIndex)}indexOfIntervalContainsPositon(e){const t=f.ListUtils.indexBy(this.intervals,(t=>t.start>e||e<t.end),this.currIndex+1);return t<0?this.intervals.length-1:t}calculate(){this.setIntersectObjects(),this.busyIntervals=nn.IntervalAlgorithms.getMergedIntervals(f.ListUtils.map(this.intersectsObjects,(e=>new on.FixedInterval(e.x,e.width))),!0);const e=nn.IntervalAlgorithms.reflectIntervals(this.busyIntervals,this.outerHorizontalRowContentBounds);e.length?this.intervals=f.ListUtils.map(e,(e=>new KW(e.start,e.length))):(this.resetMinY(f.ListUtils.min),O.print(L.RowFormatter,"RowFormattingInfo.calculate ",`minY:${this.minY}, height:${this.height}, currIndex: ${this.currIndex} intervals:\n${O.join("\n",f.ListUtils.map(this.intervals,(e=>lg.fixedInterval(e))))}`))}canIncrementHeightTo(e){const t=f.ListUtils.map(this.intervals,(t=>new Va.Rectangle(t.start,this.minY,t.busyWidth,e))),r=this.calcIntersectObjects(e);return!f.ListUtils.unsafeAnyOf(r,(e=>f.ListUtils.unsafeAnyOf(t,(t=>GW.getNonCollapsedIntersection(t,e)))))}findNextYPos(){this.resetMinY(f.ListUtils.min)}findNextYPosWhatHasNeededSpace(e){for(;this.isFloatingIntersectRow&&!f.ListUtils.anyOf(this.intervals,(t=>t.avaliableWidth>=e));)this.resetMinY(f.ListUtils.min);this.currIndex=0}setIntersectObjects(){this.intersectsObjects=this.calcIntersectObjects(this.height)}calcIntersectObjects(e){const t=new Va.Rectangle(this.outerHorizontalRowContentBounds.start,this.minY,this.outerHorizontalRowContentBounds.length,e);return f.ListUtils.reducedMap(this.boundsOfAnchoredOblectsOnThisColumn,(e=>{if(this.tableCell!==e.cell)return null;const r=Va.Rectangle.getNonCollapsedIntersection(t,e.bounds);if(!r)return null;if(!e.canPutTextAtLeft){const e=r.right;r.x=t.x,r.width=e-r.x}return e.canPutTextAtRight||(r.width=t.right-r.x),r}))}resetMinY(e){this.minY=e(this.intersectsObjects,(e=>e.bottom)).bottom,this.calculate()}}class $W{static create(e,t){switch(t){case Ne.AtLeast:return new tz(Math.max(1,g.u.twipsToPixelsF(e)));case Ne.Double:return new QW;case Ne.Exactly:return new ez(Math.max(1,g.u.twipsToPixelsF(e)));case Ne.Multiple:return new JW(0!==e?e:1);case Ne.Sesquialteral:return new ZW;case Ne.Single:default:return new YW}}calculate(e,t,r,i){const n=t+r;if(0==n)return e;const o=this.calculateSpacing(n);return!i||t>i?o:0==r?e:this.calculateSpacingInlineObjectCase(n,o,i,r)}}class JW extends $W{constructor(e){if(super(),e<=0)throw new Error(rz("multiplier",e));this.multiplier=e}calculateSpacing(e){return e*this.multiplier}calculateSpacingInlineObjectCase(e,t,r,i){return r+i+(t-e)}}class YW extends $W{calculateSpacing(e){return e}calculateSpacingInlineObjectCase(e,t,r,i){return r+i}}class QW extends $W{calculateSpacing(e){return 2*e}calculateSpacingInlineObjectCase(e,t,r,i){return r+i+(t-e)}}class ZW extends $W{calculateSpacing(e){return 3*e/2}calculateSpacingInlineObjectCase(e,t,r,i){return r+i+(t-e)}}class ez extends $W{constructor(e){super(),this.lineSpacing=e}calculateSpacing(e){throw new Error(R.D.NotImplemented)}calculateSpacingInlineObjectCase(e,t,r,i){throw new Error(R.D.NotImplemented)}calculate(e,t,r,i){return this.lineSpacing}}class tz extends YW{constructor(e){if(super(),e<=0)throw new Error(rz("lineSpacing",e));this.lineSpacing=e}calculate(e,t,r,i){var n=super.calculate(e,t,r,i);return Math.max(n,this.lineSpacing)}}function rz(e,t){return e+" is not a valid value for "+(t?t.toString():typeof t)}class iz{constructor(e,t,r,i){this.maxBoxHeight=e,this.maxAscent=t,this.maxDescent=r,this.maxPictureBoxHeight=i}initFromRow(e){this.height=e.height,this.baseLine=e.baseLine,this.spacingBefore=e.getSpacingBefore()}applyToRow(e){e.rollbackSpacingBefore(),e.applySpacingBefore(this.spacingBefore),e.height=this.height,e.baseLine=this.baseLine}getFullRowHeight(){return this.height+this.spacingBefore}equalHeights(e){return this.maxBoxHeight==e.maxBoxHeight&&this.maxAscent==e.maxAscent&&this.maxDescent==e.maxDescent&&this.maxPictureBoxHeight==e.maxPictureBoxHeight}}class nz{get row(){return this.rowFormatter.row}constructor(e,t){this.rowFormatter=e,this.rowSpacingBeforeApplier=t,this.lineSpacingCalculator=$W.create(this.rowFormatter.paragraphProps.lineSpacing,this.rowFormatter.paragraphProps.lineSpacingType),this.currState=new iz(0,0,0,0),this.currState.height=0,this.currState.baseLine=0,this.currState.spacingBefore=0,this.applyState(this.getState(this.rowFormatter.currBox))}getState(e){let t;switch(e.getType()){case lc.Text:case lc.FieldCodeStart:case lc.FieldCodeEnd:case lc.Dash:t=new iz(Math.max(e.height,this.currState.maxBoxHeight),Math.max(e.getAscent(),this.currState.maxAscent),Math.max(e.getDescent(),this.currState.maxDescent),this.currState.maxPictureBoxHeight);break;case lc.Picture:t=new iz(Math.max(e.height,this.currState.maxBoxHeight),this.currState.maxAscent,this.currState.maxDescent,Math.max(e.height,this.currState.maxPictureBoxHeight));break;default:return this.currState}return this.calcNewState(t)}calcNewState(e){return this.currState.equalHeights(e)||0==e.maxBoxHeight?this.currState:(this.calcRowParams(e.maxBoxHeight,e.maxAscent,e.maxDescent,e.maxPictureBoxHeight),e.initFromRow(this.row),e)}applyState(e){this.currState=e}T584234(){const e=this.row;if(e.boxes.length&&e.boxes[0].getType()==lc.Picture&&f.ListUtils.allOf(e.boxes,(e=>nz.affectedBoxesT584234[e.getType()]),1)){let t=e.boxes[0],r=!1;for(let i,n=2;i=e.boxes[n];n++)i.getType()==lc.Picture&&t.getType()!=lc.Picture&&nz.affectedBoxesT584234[t.getType()]&&(r=!0,this.applyT584234Height(t)),t=i;r||f.ListUtils.reverseForEach(e.boxes,(e=>{e.getType()!=lc.Picture&&this.applyT584234Height(e)}))}}applyT584234Height(e){const t=new iz(Math.max(e.height,this.currState.maxBoxHeight),Math.max(e.getAscent(),this.currState.maxAscent),Math.max(e.getDescent(),this.currState.maxDescent),this.currState.maxPictureBoxHeight);this.applyState(this.calcNewState(t))}setFinalRowParams(){const e=this.row;if(0!=this.currState.maxBoxHeight)return this.T584234(),this.currState.applyToRow(e),!0;const t=f.ListUtils.last(e.boxes);return!(t||!f.ListUtils.unsafeAnyOf(this.rowFormatter.result.newAnchoredObjects,(e=>e.levelType==dc.InText)))||(this.calcRowParams(t.height,t.getAscent(),t.getDescent(),this.currState.maxPictureBoxHeight),this.currState.initFromRow(this.row),!1)}calcRowParams(e,t,r,i){const n=this.row;switch(n.rollbackSpacingBefore(),n.height=this.lineSpacingCalculator.calculate(e,t,r,i),this.rowFormatter.paragraphProps.lineSpacingType){case Ne.AtLeast:case Ne.Exactly:n.baseLine=Math.max(0,n.height-r),n.lineHeight=n.height;break;default:n.baseLine=Math.max(t,i),n.lineHeight=Math.max(t+r,i)}this.rowSpacingBeforeApplier.apply(this.row,this.rowFormatter.result.paragraphIndex)}}nz.affectedBoxesT584234={[lc.LineBreak]:!0,[lc.ParagraphMark]:!0,[lc.TabSpace]:!0,[lc.Space]:!0,[lc.Picture]:!0};class oz{constructor(e,t,r,i,n,o){this.rowFormatter=e,this.row=this.rowFormatter.row,this.row.x=t.start,this.row.width=t.length,this.rowStartPos=this.rowFormatter.currBox.rowOffset,this.heightCalculator=new nz(this.rowFormatter,i),o&&this.rowFormatter.paragraph.isInList()&&this.addNumberingListBoxes();const a=this.rowFormatter.paragraph.getTableCell();this.rowFormattingInfo=new qW(r,this.heightCalculator.currState.getFullRowHeight(),t,n,a),this.rowFormattingInfo.calculate()}addNumberingListBoxes(){const{paragraph:e,result:{paragraphIndex:t},numberingListCountersManager:r,manager:i}=this.rowFormatter,n=r.calculateCounters(t);let o=e.getNumberingListTextCore(n),a=e.getNumerationCharacterProperties();if(i.browserUtils.MacOSPlatform&&o===an.specialCharacters.MSWordBulletMark&&"Symbol"===a.fontInfo.name){const t=Tw.getNumberingListTemplate(i.model,tn.Bullet).levels[e.getListLevelIndex()],r=t.getCharacterProperties().fontInfo;a=a.clone(),a.fontInfo=r.clone(),a.fontInfo.measurer=r.measurer,o=t.getListLevelProperties().displayFormatString}this.row.numberingListBox=new jW(a,a.getLayoutColorInfo(i.model.colorProvider),o,e.getNumberingListSeparatorChar(),i.model.cache.mergedCharacterPropertiesCache,e.getListLevel().getListLevelProperties().alignment,i.model.cache.fontInfoCache),qc.initializeWithMeasurer([new fP(this.row.numberingListBox,null)],i.measurer,i.innerClientProperties.showHiddenSymbols);const s=[this.row.numberingListBox.textBox],l=this.row.numberingListBox.separatorBox;l&&s.push(l);for(let e of s)this.heightCalculator.applyState(this.heightCalculator.getState(e))}addFullWord(e){const t=f.ListUtils.accumulate(e,0,((e,t)=>e+t.width)),r=this.rowFormattingInfo.currInterval.end;let i=this.rowFormattingInfo.indexOfFreeInterval(t);if(i<0)return new az(!1,t);const n=this.heightCalculator.currState;f.ListUtils.forEach(e,(e=>this.heightCalculator.applyState(this.heightCalculator.getState(e))));const o=this.heightCalculator.currState,a=o.getFullRowHeight();if(this.rowFormattingInfo.intervals[i].avaliableWidth-=t,a!=this.rowFormattingInfo.height&&!this.rowFormattingInfo.canIncrementHeightTo(a))return this.rowFormattingInfo.height=a,this.heightCalculator.currState=n,this.restartAllRow(),null;this.heightCalculator.applyState(o),this.rowFormattingInfo.currIndex!=i&&this.finishLogicalRow(i,r);let s=this.rowFormattingInfo.currInterval.startOfFreeSpace-t;for(let t of e)t.x=s,s+=t.width,this.row.boxes.push(t),this.rowFormattingInfo.lastNonEmptyIntervalIndex=this.rowFormattingInfo.currIndex;return new az(!0)}addWordByChars(e){let t=!0;const r=this.rowFormatter.manager.innerClientProperties.viewsSettings;for(let r of e){if(!(this.rowFormattingInfo.currInterval.avaliableWidth>=r.width)){const e=r.splitByWidth(this.rowFormatter.manager.measurer,this.rowFormattingInfo.currInterval.avaliableWidth,t);return e?(e.x=this.rowFormattingInfo.currInterval.startOfFreeSpace,this.row.boxes.push(e),this.rowFormattingInfo.lastNonEmptyIntervalIndex=this.rowFormattingInfo.currIndex,this.heightCalculator.applyState(this.heightCalculator.getState(e)),e.getEndPosition()):r.rowOffset}r.x=this.rowFormattingInfo.currInterval.startOfFreeSpace,this.rowFormattingInfo.currInterval.avaliableWidth-=r.width,this.row.boxes.push(r),this.rowFormattingInfo.lastNonEmptyIntervalIndex=this.rowFormattingInfo.currIndex,this.heightCalculator.applyState(this.heightCalculator.getState(r)),t=!1}if(r.isSimpleView)return e[e.length-1].getEndPosition();throw new Error(R.D.InternalException)}addTabBox(e){this.row.boxes.push(e),this.rowFormattingInfo.currInterval.avaliableWidth-=e.width,this.rowFormattingInfo.lastNonEmptyIntervalIndex=this.rowFormattingInfo.currIndex,this.rowFormatter.setBoxInfo(!0)}addBox(){const e=this.rowFormattingInfo.currInterval.end,t=this.rowFormatter.currBox,r=this.rowFormattingInfo.indexOfFreeInterval(t.width);if(r<0)return void(this.row.isEmpty()?this.rowFormattingInfo.isFloatingIntersectRow?(this.rowFormattingInfo.findNextYPos(),this.rowFormattingInfo.currIndex=0,this.addBox()):(t.x=this.rowFormattingInfo.intervals[0].startOfFreeSpace,this.rowFormattingInfo.intervals[0].avaliableWidth-=Math.min(t.width,this.rowFormattingInfo.intervals[0].avaliableWidth),this.addBoxIgnoreWidth()):this.rowFormatter.finishRow());this.rowFormattingInfo.intervals[r].avaliableWidth-=t.width;const i=this.heightCalculator.getState(t),n=i.getFullRowHeight();if(n!=this.rowFormattingInfo.height&&!this.rowFormattingInfo.canIncrementHeightTo(n))return this.rowFormattingInfo.intervals[r].avaliableWidth+=t.width,this.rowFormattingInfo.height=n,void this.restartAllRow();this.rowFormattingInfo.height=n,this.heightCalculator.applyState(i),this.rowFormattingInfo.currIndex!=r&&this.finishLogicalRow(r,e),t.x=this.rowFormattingInfo.currInterval.startOfFreeSpace-t.width,this.row.boxes.push(t),this.rowFormattingInfo.lastNonEmptyIntervalIndex=this.rowFormattingInfo.currIndex,this.rowFormatter.setBoxInfo(!0)}addBoxIgnoreWidth(){const e=this.rowFormatter.currBox;this.row.boxes.push(e),this.rowFormattingInfo.lastNonEmptyIntervalIndex=this.rowFormattingInfo.currIndex,this.heightCalculator.applyState(this.heightCalculator.getState(e)),this.rowFormatter.setBoxInfo(!0)}anywayAddBox(){const e=this.rowFormatter.currBox;e.x=this.rowFormattingInfo.currInterval.startOfFreeSpace,this.rowFormattingInfo.currInterval.avaliableWidth-=e.width,this.rowFormattingInfo.currInterval.avaliableWidth<0&&(this.rowFormattingInfo.currInterval.avaliableWidth=0),this.row.boxes.push(e),this.rowFormattingInfo.lastNonEmptyIntervalIndex=this.rowFormattingInfo.currIndex,this.rowFormatter.setBoxInfo(!0)}restartAllRow(e=!0){this.rowFormatter.setPosition(this.rowStartPos,!1,!0),this.rowFormatter.setBoxInfo(!1),this.rowFormattingInfo.calculate(),this.rowFormattingInfo.currIndex=0,this.rowFormatter.result.startRowFormatting(e),this.rowFormatter.wordHolder.restart(),this.rowFormatter.tabInfo.restart()}finishLogicalRow(e,t){this.rowFormattingInfo.currInterval.isConsiderBoxes()&&this.rowFormatter.result.finishLogicalRow(t),this.rowFormattingInfo.currIndex=e}finishRow(){return this.row.y=this.rowFormattingInfo.minY,this.heightCalculator.setFinalRowParams()||this.row.containsSpacesOnly()||this.rowFormattingInfo.canIncrementHeightTo(this.heightCalculator.currState.getFullRowHeight())?(this.rowFormatter.result.finishRow(),!0):(this.rowFormattingInfo.height=this.heightCalculator.currState.getFullRowHeight(),this.restartAllRow(),!1)}addNumberingBoxes(){return!!this.row.boxes.length||!this.row.numberingListBox||this.tryPlaceNumberingBoxes()}getTabEndPos(e,t){const r=this.rowFormatter.tabInfo.getNextCustomTabPosition(t);if(this.rowFormatter.paragraphProps.firstLineIndentType==ke.Hanging){const i=this.rowFormatter.paragraphHorizontalBounds.start+g.u.twipsToPixelsF(this.rowFormatter.paragraphProps.leftIndent);return r&&e&&i>t&&on.FixedInterval.fromPositions(t,i).contains(r.position)?r.position:i<t?this.rowFormatter.tabInfo.getNextDefaultTabPosition(t):i}return r?r.position:this.rowFormatter.tabInfo.getNextDefaultTabPosition(t)}tryPlaceNumberingBoxes(){const e=this.row.numberingListBox,t=e.textBox,r=this.calculateNumberingListBoxOffset(e.alignment,t.width),i=this.rowFormattingInfo.currInterval.startOfFreeSpace-r;t.x=i;let n=t.width,o=!1;const a=e.separatorBox;if(a){const e=i+this.row.numberingListBox.textBox.width;if(a.getType()==lc.TabSpace){const t=this.getTabEndPos(0==this.rowFormattingInfo.currIndex,e);a.width=t-e,o=!0}a.x=e,n+=a.width}if(this.rowFormattingInfo.isFloatingIntersectRow){const e=this.rowFormattingInfo.indexOfFreeInterval(n);if(e<0)return this.rowFormattingInfo.findNextYPos(),this.rowFormattingInfo.currIndex=0,this.restartAllRow(),!1;if(this.rowFormattingInfo.currIndex!=e){const t=this.rowFormattingInfo.currInterval?this.rowFormattingInfo.currInterval.end:-1;if(o)return this.finishLogicalRow(this.rowFormattingInfo.currIndex+1,t),this.tryPlaceNumberingBoxes();this.finishLogicalRow(e,t)}}return this.row.x-=r,this.rowFormattingInfo.currInterval.start-=r,this.rowFormattingInfo.currInterval.avaliableWidth-=n,this.rowFormattingInfo.lastNonEmptyIntervalIndex=this.rowFormattingInfo.currIndex,!0}calculateNumberingListBoxOffset(e,t){let r=0;return e==en.Center?r=t/2:e==en.Right&&(r=t),r}}class az{constructor(e,t){this.isSuccess=e,this.requiredWidth=t}}class sz{constructor(e){this.rowFormatter=e}addBoxAnyway(e=!1,t=LV.None,...r){this.rowFormatter.wordHolder.pushBoxes()&&this.rowFormatter.rowSizesManager.addNumberingBoxes()&&(this.rowFormatter.rowSizesManager.anywayAddBox(),this.rowFormatter.manager.innerClientProperties.viewsSettings.isSimpleView&&(r=f.ListUtils.reducedMap(r,(e=>I.Y.isAnyOf(e,xV.ColumnEnd,xV.PageEnd,xV.SectionEnd)?null:e))),f.ListUtils.forEach(r,(e=>this.rowFormatter.row.flags.set(e,!0))),t!=LV.None&&this.rowFormatter.setState(t),e&&this.rowFormatter.finishRow())}addAnchorObject(){this.rowFormatter.wordHolder.pushBoxes()&&this.rowFormatter.addAnchorObject()}addTextBox(){this.rowFormatter.wordHolder.addBox()}addDashBox(){this.rowFormatter.wordHolder.addBox(),this.rowFormatter.wordHolder.pushBoxes()}addPictureBox(){this.rowFormatter.wordHolder.pushBoxes()&&this.rowFormatter.rowSizesManager.addNumberingBoxes()&&this.rowFormatter.rowSizesManager.addBox()}addSpaceBox(){this.addBoxAnyway(!1,LV.Base)}addTabulationBox(){this.rowFormatter.wordHolder.pushBoxes()&&this.rowFormatter.rowSizesManager.addNumberingBoxes()&&(this.rowFormatter.tabInfo.addTabBox()?this.rowFormatter.setState(LV.Base):this.rowFormatter.finishRow())}addSectionBox(){this.addBoxAnyway(!0,LV.None,xV.ParagraphEnd,xV.SectionEnd)}addLineBreakBox(){this.addBoxAnyway(!0)}addPageBreakBox(){this.addBoxAnyway(!1,LV.EndedWithPageBreak,xV.PageEnd)}addColumnBreakBox(){this.addBoxAnyway(!0,LV.None,xV.ColumnEnd)}addParagraphBox(){this.addBoxAnyway(!1,LV.EndedWithParagraphMark,xV.ParagraphEnd)}}class lz extends sz{constructor(e){super(e)}addAnchorObject(){this.rowFormatter.finishRow()}addTextBox(){this.rowFormatter.finishRow()}addDashBox(){this.rowFormatter.finishRow()}addPictureBox(){this.rowFormatter.finishRow()}addSpaceBox(){this.rowFormatter.finishRow()}addTabulationBox(){this.rowFormatter.finishRow()}addLineBreakBox(){this.rowFormatter.finishRow()}addPageBreakBox(){this.rowFormatter.finishRow()}addColumnBreakBox(){this.rowFormatter.finishRow()}addParagraphBox(){this.rowFormatter.finishRow()}}class dz extends lz{constructor(e){super(e)}addParagraphBox(){this.addBoxAnyway(!1,LV.EndedWithParagraphMark,xV.ParagraphEnd)}}class cz{get row(){return this.rowFormatter.row}get currIntervalOrLastNonEmpty(){const e=this.rowFormatter.rowSizesManager.rowFormattingInfo.currInterval;return e||this.rowFormatter.rowSizesManager.rowFormattingInfo.lastNonEmptyInterval}get currInterval(){return this.rowFormatter.rowSizesManager.rowFormattingInfo.currInterval}constructor(e,t){this.rowFormatter=e,this.paragraphHorizontalBoundsStart=t;const r=this.rowFormatter.paragraph.getTabs();this.defaultTabStop=g.u.twipsToPixelsF(r.defaultTabStop),this.tabPositions=r.positions;for(let e of this.tabPositions)e.position=g.u.twipsToPixelsF(e.position);if(this.rowFormatter.paragraphProps.firstLineIndentType==ke.Hanging&&!this.rowFormatter.paragraph.isInList()){const e=g.u.twipsToPixelsF(this.rowFormatter.paragraphProps.leftIndent),t=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(this.tabPositions,(e=>e.position),e)),r=this.tabPositions[t],i=r?r.position:Number.MAX_VALUE;i!=e&&this.tabPositions.splice(e>i?t+1:t,0,new rs(e,Ha.Left,Sg.None,!1,!1))}for(let e of this.tabPositions)e.position+=this.paragraphHorizontalBoundsStart;this.restart()}restart(){this.lastTabPosition=null,this.lastTabBoxIndex=-1}shiftBoxesAfterLastTab(){if(!this.lastTabPosition||I.Y.isAnyOf(this.lastTabPosition.alignment,Ha.Left,Ha.Numbering))return;const e=this.row.boxes[this.lastTabBoxIndex],t=this.calculateActualTabWidth(e);t>0&&(e.width=t,this.currIntervalOrLastNonEmpty.avaliableWidth-=t,f.ListUtils.forEach(this.row.boxes,(e=>e.x+=t),this.lastTabBoxIndex+1)),this.restart()}addTabBox(){const e=this.rowFormatter.currBox;this.shiftBoxesAfterLastTab();let t=this.getNextCustomTabPosition(this.currInterval.startOfFreeSpace);const r=t&&!I.Y.isAnyOf(t.alignment,Ha.Left,Ha.Numbering);let i=t?t.position:this.getNextDefaultTabPosition(this.currInterval.startOfFreeSpace);if(i>this.currInterval.end){let e=this.rowFormatter.rowSizesManager.rowFormattingInfo.indexOfIntervalContainsPositon(i);e!=this.rowFormatter.rowSizesManager.rowFormattingInfo.currIndex&&(r?i=this.currInterval.end:(this.rowFormatter.rowSizesManager.finishLogicalRow(e,this.currInterval.end),t=this.getNextCustomTabPosition(this.currInterval.startOfFreeSpace),i=t?t.position:this.getNextDefaultTabPosition(this.currInterval.startOfFreeSpace)))}e.x=this.currInterval.startOfFreeSpace,e.width=r?0:i-e.x;const n=e.getLayoutTabBox(t?t.leader:Sg.None),o=f.ListUtils.last(this.rowFormatter.rowSizesManager.rowFormattingInfo.intervals);if(i>o.end){if(o.end<this.rowFormatter.paragraphHorizontalBounds.end){if(this.rowFormatter.manager.model.compatibilitySettings.compatibilityMode<yg.Word2013)return this.currInterval.length=Number.MAX_SAFE_INTEGER,this.currInterval.avaliableWidth=Number.MAX_SAFE_INTEGER,this.row.width=Number.MAX_SAFE_INTEGER,this.addTabBox();if(n.right<this.rowFormatter.paragraphHorizontalBounds.end){const e=this.rowFormatter.paragraphHorizontalBounds.end-o.end;let t=!r;if(t&&this.rowFormatter.rowSizesManager.rowFormattingInfo.isFloatingIntersectRow&&(t=!nn.IntervalAlgorithms.getIntersection(new on.FixedInterval(o.end,e),f.ListUtils.last(this.rowFormatter.rowSizesManager.rowFormattingInfo.busyIntervals))),t)return o.end=this.rowFormatter.paragraphHorizontalBounds.end,o.avaliableWidth+=e,this.row.width+=e,this.addTabBox()}}if(!this.row.isEmpty()&&!r)return!1;if(this.rowFormatter.rowSizesManager.rowFormattingInfo.isFloatingIntersectRow&&!r){for(this.rowFormatter.rowSizesManager.rowFormattingInfo.findNextYPos(),this.rowFormatter.rowSizesManager.restartAllRow(!1);I.Y.isAnyOf(this.rowFormatter.currBox.getType(),lc.AnchorPicture,lc.AnchorTextBox);)this.rowFormatter.setBoxInfo(!0);return this.addTabBox()}}return this.rowFormatter.rowSizesManager.addTabBox(n),this.lastTabPosition=t||new rs(i,Ha.Left,Sg.None,!1,!1),this.lastTabBoxIndex=this.row.boxes.length-1,!0}calculateActualTabWidth(e){const t=e.x;switch(this.lastTabPosition.alignment){case Ha.Decimal:{const e=rn.StringUtils.getDecimalSeparator();for(let r,i=this.lastTabBoxIndex+1;r=this.row.boxes[i];i++){const i=r.getCharIndex(e);if(i>=0){const e=r.getCharOffsetXInPixels(this.rowFormatter.manager.measurer,i);return this.getFinalCustomTabWidth(t,r.x+e-t)}}}case Ha.Right:{const e=this.calcLastVisibleBoxRightBounds(t),r=Math.min(this.lastTabPosition.position,this.currIntervalOrLastNonEmpty.start+this.currIntervalOrLastNonEmpty.length);return Math.max(0,r-e)}case Ha.Center:{const e=this.calcLastVisibleBoxRightBounds(t);return this.getFinalCustomTabWidth(t,Math.ceil((e-t)/2))}case Ha.Left:case Ha.Numbering:return 0;default:throw new Error(R.D.InternalException)}}calcLastVisibleBoxRightBounds(e){const t=this.row.boxes.length-1,r=this.lastTabBoxIndex+1,i=this.row.boxes[NW.findLastVisibleBoxIndex(this.row.boxes,t,r)];return i?i.right:e}getFinalCustomTabWidth(e,t){return P.MathUtils.restrictValue(this.lastTabPosition.position-e-t,0,this.currIntervalOrLastNonEmpty.avaliableWidth)}getNextDefaultTabPosition(e){if(!this.defaultTabStop)return e;if(e>=this.paragraphHorizontalBoundsStart){const t=this.paragraphHorizontalBoundsStart+this.defaultTabStop*(Math.floor((e-this.paragraphHorizontalBoundsStart)/this.defaultTabStop)+1);return t-e>1?t:t+this.defaultTabStop}return this.paragraphHorizontalBoundsStart-this.defaultTabStop*Math.floor((this.paragraphHorizontalBoundsStart-e)/this.defaultTabStop)}getNextCustomTabPosition(e){return f.ListUtils.elementBy(this.tabPositions,(t=>XW.lessThan(e,t.position)))}}class hz{constructor(e){this.rowFormatter=e,this.restart()}restart(){this.boxes=null}addBox(){this.boxes||(this.boxes=[]);const e=this.rowFormatter.currBox;this.boxes.push(e),this.rowFormatter.setBoxInfo(!0)}pushBoxes(){if(!this.boxes)return!0;if(!this.rowFormatter.rowSizesManager.addNumberingBoxes())return!1;const e=this.rowFormatter.rowSizesManager.addFullWord(this.boxes);if(null==e?void 0:e.isSuccess)return this.boxes=null,!0;if(null==e)return!1;if(this.rowFormatter.row.isEmpty()){if(this.rowFormatter.rowSizesManager.rowFormattingInfo.isFloatingIntersectRow)return this.rowFormatter.rowSizesManager.rowFormattingInfo.findNextYPosWhatHasNeededSpace(e.requiredWidth),this.pushBoxes();const t=this.rowFormatter.rowSizesManager.addWordByChars(this.boxes);this.rowFormatter.setPosition(t,!1,!1)}else this.rowFormatter.setPosition(this.boxes[0].rowOffset,!1,!1);return this.rowFormatter.rowSizesManager.finishLogicalRow(this.rowFormatter.rowSizesManager.rowFormattingInfo.currIndex+1,this.rowFormatter.rowSizesManager.rowFormattingInfo.currInterval.end),this.rowFormatter.finishRow(),this.boxes=null,!1}}!function(e){e[e.None=0]="None",e[e.Base=1]="Base",e[e.EndedWithPageBreak=2]="EndedWithPageBreak",e[e.EndedWithParagraphMark=3]="EndedWithParagraphMark"}(LV||(LV={}));class uz{constructor(e,t){this.rowFormatting=!0,this.manager=e,this.iterator=new WW(this.manager,t),this.numberingListCountersManager=new CW(this.subDocument),this.stateMap={},this.stateMap[LV.Base]=new sz(this),this.stateMap[LV.EndedWithPageBreak]=new dz(this),this.stateMap[LV.EndedWithParagraphMark]=new lz(this),uz.addBoxFunctionMap||(uz.addBoxFunctionMap={},uz.addBoxFunctionMap[lc.Space]=function(){this.currentState.addSpaceBox()},uz.addBoxFunctionMap[lc.NonBreakingSpace]=function(){this.currentState.addTextBox()},uz.addBoxFunctionMap[lc.Dash]=function(){this.currentState.addDashBox()},uz.addBoxFunctionMap[lc.Text]=function(){this.currentState.addTextBox()},uz.addBoxFunctionMap[lc.Picture]=function(){this.currentState.addPictureBox()},uz.addBoxFunctionMap[lc.ParagraphMark]=function(){this.currentState.addParagraphBox()},uz.addBoxFunctionMap[lc.LineBreak]=function(){this.currentState.addLineBreakBox()},uz.addBoxFunctionMap[lc.SectionMark]=function(){this.currentState.addSectionBox()},uz.addBoxFunctionMap[lc.PageBreak]=function(){this.currentState.addPageBreakBox()},uz.addBoxFunctionMap[lc.ColumnBreak]=function(){this.currentState.addColumnBreakBox()},uz.addBoxFunctionMap[lc.TabSpace]=function(){this.currentState.addTabulationBox()},uz.addBoxFunctionMap[lc.FieldCodeStart]=function(){this.currentState.addTextBox()},uz.addBoxFunctionMap[lc.FieldCodeEnd]=function(){this.currentState.addTextBox()},uz.addBoxFunctionMap[lc.LayoutDependent]=function(){this.currentState.addTextBox()},uz.addBoxFunctionMap[lc.AnchorTextBox]=function(){this.currentState.addAnchorObject()},uz.addBoxFunctionMap[lc.AnchorPicture]=function(){this.currentState.addAnchorObject()})}get subDocument(){return this.iterator.subDocument}get row(){return this.result.row}get paragraph(){return this.subDocument.paragraphs[this.result.paragraphIndex]}get paragraphProps(){return this.paragraph.getParagraphMergedProperties()}getNextBoxWrapInfo(){return this.iterator.getWrap(!1)}setPosition(e,t,r){this.iterator.setPosition(e,t,r)}getPosition(){return this.iterator.getPosition()}documentStart(){this.iterator.documentStart()}formatRow(e,t,r){this.paragraphHorizontalBounds=t,this.initResult(e),O.print(L.RowFormatter,"formatRow",`paragraphHorizontalBounds: ${lg.fixedInterval(t)}, firstBoxOffset: ${this.currBox.rowOffset}`);const i=this.manager.activeFormatter.lastRowInfo.row,n=!i||i.flags.get(xV.ParagraphEnd)||this.manager.activeFormatter.lastRowInfo.paragraphIndex!=this.currWrapInfo.paragraphIndex,o=n?g.u.twipsToPixelsF(this.paragraphProps.getLeftIndentForFirstRow()):g.u.twipsToPixelsF(this.paragraphProps.getLeftIndentForOtherRow()),a=on.FixedInterval.fromPositions(t.start+o,t.end-g.u.twipsToPixelsF(this.paragraphProps.rightIndent));this.rowSizesManager=new oz(this,a,e,r,this.manager.activeFormatter.layoutRowBoundsCalculator.getRectangleBounds(this.manager),n),this.tabInfo=new cz(this,t.start),this.wordHolder=new hz(this),this.rowFormatting=!0;let s=0;for(;this.rowFormatting;)if(this.setState(LV.Base),this.innerFormatRow(),++s>1e4)throw new Error(R.D.InternalException)}innerFormatRow(){for(;this.rowFormatting&&this.currBox;){const e=this.currWrapInfo.tablePosition;if(uz.addBoxFunctionMap[this.currBox.getType()].call(this),this.currWrapInfo){if(!e&&this.currWrapInfo.tablePosition){this.finishRow();break}if(e&&(!this.currWrapInfo.tablePosition||!this.currWrapInfo.equalsTablePositions(e))){this.wordHolder.pushBoxes(),this.row.flags.set(xV.CellTableEnd,!0),this.finishRow();break}}else e&&this.row.flags.set(xV.CellTableEnd,!0)}if(!this.currBox){if(!this.iterator.allBoxesGiven())return this.iterator.setPosition(this.startPos,!1,!1),this.result.flags.set(DV.NotEnoughChunks,!0),void(this.rowFormatting=!1);this.row.flags.set(xV.DocumentEnd,!0)}this.rowFormatting=!this.rowSizesManager.finishRow()}finishRow(){if(!this.result.row.boxes.length&&!this.result.newAnchoredObjects.length)throw new Error(R.D.InternalException);this.rowFormatting=!1}setState(e){this.currentState=this.stateMap[e]}addAnchorObject(){const e=this.currBox;this.setBoxInfo(!0);const t=this.manager.activeFormatter.layoutPosition.page.anchoredObjectHolder.getObjById(e.objectId);if(t)t.isApproved=!0;else{if(e.getType()==lc.AnchorTextBox){const t=this.manager.anchoredObjectsManager.textBoxContextSizeCalculators[e.objectId];t.calculateSize(this.manager.boundsCalculator),e.setContentSize(t.layoutSize)}this.result.newAnchoredObjects.push(e)}}initResult(e){this.result=new kW(this,e),this.setBoxInfo(!1),this.currBox&&(this.startPos=this.currBox.rowOffset),this.result.paragraphIndex=this.currWrapInfo.paragraphIndex,this.result.sectionIndex=this.currWrapInfo.sectionIndex}setBoxInfo(e){let t=this.iterator.getWrap(e);if(!t)return this.currBox=null,void(this.currWrapInfo=null);this.currBox=t.box.getType()==lc.TabSpace?t.box:t.box.clone(),this.currWrapInfo=t.info,this.currBox.getType()==lc.LayoutDependent&&(this.currBox.calculateText(this.manager),qc.initializeWithMeasurer([new fP(this.currBox,null)],this.manager.measurer,!1))}}class pz{constructor(e,t,r,i,n){this.lastRow=e,this.paragraphs=t,this.isFirstRowInCell=r,this.isFirstCellInRow=i,this.isFirstRowInTable=n}apply(e,t){e.applySpacingBefore(this.lastRow&&!this.lastRow.flags.get(xV.ParagraphEnd)?0:pW.getParagraphSpacingBefore(this.paragraphs[t],this.paragraphs[t-1],this.isFirstRowInCell,this.isFirstCellInRow,this.isFirstRowInTable))}}class gz{constructor(e,t,r,i){this.settings=e,this.lastRowInfo=t,this.paragraphs=r,this.isFirstRowOnColumn=i}apply(e,t){e.applySpacingBefore(this.calculateSpacingBefore(e,t))}calculateSpacingBefore(e,t){const r=this.lastRowInfo.row;if(this.firstRowOfSection()||r.tableCellInfo&&!this.isFirstRowOnColumn)return pW.getParagraphSpacingBefore(this.paragraphs[t],null,!1,!1,!1);if(t==this.lastRowInfo.paragraphIndex){if(this.firstRowOfParagraphStartingWithPageBreak()&&this.settings.allowParagraphSpacingAfterPageBreak)return pW.getParagraphSpacingBefore(this.paragraphs[t],null,!1,!1,!1)}else if(!this.isFirstRowOnColumn&&!this.rowConsistsOfPageBreakOnly(e))return pW.getParagraphSpacingBefore(this.paragraphs[t],this.paragraphs[t-1],!1,!1,!1);return 0}firstRowOfSection(){return!this.lastRowInfo.row||this.lastRowInfo.row.flags.get(xV.SectionEnd)}rowConsistsOfPageBreakOnly(e){return 1==e.boxes.length&&e.boxes[0].getType()==lc.PageBreak}firstRowOfParagraphStartingWithPageBreak(){return this.lastRowInfo.row&&this.rowConsistsOfPageBreakOnly(this.lastRowInfo.row)&&this.lastRowInfo.startPosition==this.paragraphs[this.lastRowInfo.paragraphIndex].startLogPosition.value}}class mz extends Va.Rectangle{constructor(e,t){super(e.x,e.y,e.width,e.height),this.color=t}}class fz extends Va.Rectangle{constructor(e,t,r){super(t.x,t.y,t.width,t.height),this.parentTable=e,this.rowCells=[],this.backgroundInfos=[],this.rowIndex=r}isBoundWithPrev(){return f.ListUtils.indexBy(this.rowCells,(e=>!e.boundFlags.get(_a.StartOnThisColumn)))>=0}getCellIndexByExactlyCellGridIndex(e){return C.SearchUtils.binaryIndexOf(this.rowCells,(t=>t.cellGridIndex-e))}getCellByExactlyCellGridIndex(e){const t=this.getCellIndexByExactlyCellGridIndex(e);return t<0?null:this.rowCells[t]}}class bz{static createBackgroundInfos(e,t,r,i,n,o,a){const s=r.table.style,l=r.table.rows;for(let d,c=0;d=n[c];c++){const h=i.tableRows[c],u=h.rowIndex,p=a[u].cellSpacing,g=l[u].cells,m=o[c],f=0==c,b=c==n.length-1;for(let i,a=0;i=d[a];a++){const C=g[a];if(C.verticalMerging==Xe.Continue&&0!=c)continue;const S=a==d.length-1,I=r.tableCellInfos[u][a],P=Math.min(I.getStartRowIndex()+I.getNumRowsInCell()-u+c,n.length)-1,w=o[P],y=new Va.Rectangle(0,0,0,0);if(p){const e=0==a?1:0,t=i.length-(S?2:1);y.x=i[e].xPos+i[e].borderInfo.width,y.width=i[t].xPos-y.x;const r=m[f?1:0];y.y=r.yPosition+r.maxWidth,y.height=w[w.length-(b?2:1)].yPosition-y.y}else{y.x=i[0].xPos+i[0].borderInfo.width;const e=S?i[1]:d[a+1][0];y.width=e.xPos-y.x;const t=m[0],r=P==n.length-1?o[P][1]:o[P+1][0];y.y=t.yPosition+t.maxWidth,y.height=r.yPosition-y.y}const x=C.verticalMerging==Xe.Continue?l[I.getStartRowIndex()].cells[I.getCellIndex(0)]:C,T=(new Qr).getProperty(x.properties,s,x.conditionalFormatting,t).getActualColor(e);h.backgroundInfos.push(new mz(y,T))}}}}class Cz{static getFinalReducedVerticalBorders(e){const t=[],r=[];for(let t of e)for(let e of t)for(let t of e)r.push(t);r.sort(((e,t)=>{const r=e.xPos-t.xPos;if(Math.abs(r)>1)return r;const i=e.yPos-t.yPos;return 0!=i?i:0}));let i=r[0];t.push(i);for(let e,n=1;e=r[n];n++)i.canCombineVertical(e)?i.length=e.yPos+e.length-i.yPos:(i=e,t.push(i));return t}static getFinalReducedHorizontalBorders(e){const t=[];for(let r of e)for(let e of r){const r=e.borders;let i=r[0].getLayoutTableBorder(e);t.push(i);for(let n,o=1;n=r[o];o++)Math.abs(i.xPos+i.length-n.xPosition)<2&&i.borderInfo.equals(n.borderInfo)?i.length=n.xPosition+n.length-i.xPos:(i=n.getLayoutTableBorder(e),t.push(i))}return t}}class Sz{static setColumnHorizontalBorders(e,t,r,i){const n=e.tableRows,o=e.y;for(let e,a=0;e=n[a];a++){const s=0==a,l=a==n.length-1;let d=t[e.rowIndex].cellSpacing;const c=r[a];if(d>0){let t;s?(c[0].yPosition=e.y,c[0].isOffsetFromTop=!0,c[1].yPosition=c[0].yPosition+c[0].maxWidth+d*(i?2:1)+c[1].maxWidth,c[1].isOffsetFromTop=!1,t=3):(c[0].yPosition=e.y+d+c[0].maxWidth,c[0].isOffsetFromTop=!1,t=2),l?(c[t].yPosition=e.bottom-c[t].maxWidth,c[t].isOffsetFromTop=!0,c[t-1].yPosition=c[t].yPosition-2*d-c[t-1].maxWidth,c[t-1].isOffsetFromTop=!0):(c[t-1].yPosition=e.bottom-d-c[t-1].maxWidth,c[t-1].isOffsetFromTop=!0)}else c[0].yPosition=s?e.y:e.y-c[0].maxWidth/2,c[0].isOffsetFromTop=!0,l&&(c[1].yPosition=e.bottom-c[1].maxWidth,c[1].isOffsetFromTop=!0);for(let e of c)e.yPosition-=o}}static setColumnVerticalBorders(e,t,r,i,n,o,a,s){const l=e.tableRows,d=t.table.rows;for(let e,c=0;e=l[c];c++){const h=0==c,u=c==l.length-1,p=n[c],g=n[c+1],m=p.length-1,f=[];o.push(f);const b=e.rowIndex,C=d[b].cells,S=s?r[b].cellSpacing:0;for(let e=0;e<C.length;e++){const r=0==e,n=e==C.length-1,o=t.tableCellInfos[b][e],s=!h&&o.getStartRowIndex()!=b,l=!u&&o.getStartRowIndex()+o.getNumRowsInCell()-1!=b,d=[];f.push(d);for(let t of a[b][e])d.push(t.clone());let c,I;S>0?(c=p[h?1:0],I=p[m-(u?1:0)]):(c=p[0],I=u?p[m]:g[0]);const P=c.yPosition+(c.isOffsetFromTop?c.maxWidth:0),w=I.yPosition-(I.isOffsetFromTop?0:I.maxWidth);for(let e,t=0;e=d[t];t++){const o=0==t,a=t==d.length-1,p=r&&o||a&&n;e.yPos=P,(p||s)&&(e.yPos-=S*(i&&h?2:1)+c.maxWidth),e.length=w-e.yPos,(p||l)&&(e.length+=S*(u?2:1)+I.maxWidth)}}}}}class Iz{constructor(e,t,r,i){this.xPos=e,this.yPos=t,this.length=r,this.borderInfo=i}clone(){return new Iz(this.xPos,this.yPos,this.length,this.borderInfo.clone())}copyFrom(e){this.xPos=e.xPos,this.yPos=e.yPos,this.length=e.length,this.borderInfo=e.borderInfo.clone()}canCombineVertical(e){return Math.abs(this.xPos-e.xPos)<2&&Math.abs(this.yPos+this.length-e.yPos)<2&&this.borderInfo.equals(e.borderInfo)}}class Pz extends Iz{constructor(e,t,r,i,n){super(e,t,r,i),this.layoutRowIndex=n}clone(){return new Pz(this.xPos,this.yPos,this.length,this.borderInfo.clone(),this.layoutRowIndex)}copyFrom(e){super.copyFrom(e),this.layoutRowIndex=e.layoutRowIndex}canCombine(e){let t=Math.abs(this.xPos+this.length-e.xPos),r=Math.abs(this.yPos-e.yPos);return t<3&&r<3&&this.layoutRowIndex==e.layoutRowIndex}}class wz extends Iz{clone(){return new wz(this.xPos,this.yPos,this.length,this.borderInfo.clone())}copyFrom(e){super.copyFrom(e)}}class yz{static getHorizontalCursorBorders(e){const t=[];return f.ListUtils.forEach(e.tableRows,((r,i)=>{f.ListUtils.forEach(r.rowCells,(r=>{t.push(yz.createHorizontalCursorBorder(e,r,i))}))})),yz.combine(t)}static combine(e){const t=[];let r=e[0];t.push(r);for(let i,n=1;i=e[n];n++)r.canCombine(i)?r.length=i.xPos+i.length-r.xPos:(r=i,t.push(r));return t.sort(((e,t)=>e.yPos-t.yPos))}static createHorizontalCursorBorder(e,t,r){return new Pz(t.x-e.x,t.bottom-e.y-yz.BORDER_HALF_WIDTH,t.width,ve.getEmpty(),r)}}yz.BORDER_HALF_WIDTH=2;class xz{constructor(e,t,r){this.isEditable=!0,this.backgroundColor=e,this.grid=t,this.pageIndexFromWhichTableWasMoved=r}}class Tz extends Va.Rectangle{constructor(e,t,r){super(r.x,r.y,r.width,r.height),this.horizontalBorders=[],this.verticalBorders=[],this.verticalCursorBorders=[],this.horizontalCursorBorders=[],this.tableRows=[],this.parentCell=e,this.logicInfo=t}isLastLayoutColumnInModelTable(){const e=this.getTopLevelColumn();return!e.isBoundWithNext()&&f.ListUtils.last(e.tableRows).rowIndex==e.logicInfo.grid.table.rows.length-1}calculateFlags(){this.boundFlags=new pr.Flag(_a.StartOnThisColumn|_a.EndOnThisColumn),f.ListUtils.forEach(this.tableRows,(e=>f.ListUtils.forEach(e.rowCells,(e=>{e.boundFlags.get(_a.StartOnThisColumn)||this.boundFlags.set(_a.StartOnThisColumn,!1),e.boundFlags.get(_a.EndOnThisColumn)||this.boundFlags.set(_a.EndOnThisColumn,!1)}))))}getTopLevelColumn(){let e,t=this;for(;e=t.parentCell;)t=e.parentRow.parentTable;return t}isBoundWithPrev(){return!this.boundFlags.get(_a.StartOnThisColumn)}isBoundWithNext(){return!this.boundFlags.get(_a.EndOnThisColumn)}static getFirstCellInPageThatBoundWithCellPlacedInNextPage(e){let t,r=null,i=-1;for(let n,o=e.length-1;n=e[o];o--){const e=f.ListUtils.unsafeAnyOf(n.tableRows,(e=>f.ListUtils.unsafeAnyOf(e.rowCells,(e=>e.boundFlags.get(_a.EndOnThisColumn)?null:e))));e&&(!r||(t=e.parentRow.parentTable.logicInfo.grid.table.nestedLevel)>i)&&(r=e,i=t)}return r}isEmpty(){return!this.tableRows.length}}class vz{constructor(e){this.borders=[],this.maxWidth=0,this.isOffsetFromTop=e}updateWidth(e){e>this.maxWidth&&(this.maxWidth=e)}clone(){const e=new vz(this.isOffsetFromTop);return e.copyFrom(this),e}copyFrom(e){this.isOffsetFromTop=e.isOffsetFromTop,this.yPosition=e.yPosition,this.maxWidth=e.maxWidth,this.borders=[];for(let e of this.borders)this.borders.push(e.clone())}}class Mz{clone(){const e=new Mz;return e.copyFrom(this),e}copyFrom(e){this.length=e.length,this.xPosition=e.xPosition,this.borderInfo=e.borderInfo.clone()}getLayoutTableBorder(e){return new Iz(this.xPosition,e.yPosition-(e.isOffsetFromTop?0:this.borderInfo.width),this.length,this.borderInfo)}}class Ez{constructor(e,t,r){this.cellSpacings=f.ListUtils.map(t.rows,(i=>new Xa(e,t,i.tablePropertiesException).getProperty(i.properties,t.style,i.conditionalFormatting,e.defaultTableRowProperties).asNumberNoPercentType(r)));const i=e.defaultTableProperties;this.leftBorder=t.getActualLeftBorder(i),this.rightBorder=t.getActualRightBorder(i),this.bottomBorder=t.getActualBottomBorder(i),this.topBorder=t.getActualTopBorder(i),this.horizontalBorder=t.getActualHorizontalBorder(i),this.verticalBorder=t.getActualVerticalBorder(i),this.leftBorder=Ez.borderConvertToPixels(this.leftBorder,r),this.rightBorder=Ez.borderConvertToPixels(this.rightBorder,r),this.topBorder=Ez.borderConvertToPixels(this.topBorder,r),this.bottomBorder=Ez.borderConvertToPixels(this.bottomBorder,r),this.horizontalBorder=Ez.borderConvertToPixels(this.horizontalBorder,r),this.verticalBorder=Ez.borderConvertToPixels(this.verticalBorder,r)}static borderConvertToPixels(e,t){if(!e)return null;const r=e.clone();return r.width=t(r.width),r}}class Dz{rowCellSpacing(e){return this.tblbrdProvider.cellSpacings[e]}get borderHorizontal(){return this.tblbrdProvider.horizontalBorder}get grid(){return this.tableInfo.grid}get tblStyle(){return this.tableInfo.table.style}constructor(e,t){this.colorProvider=t.colorProvider,this.tableInfo=e,this.tblbrdProvider=new Ez(t,e.table,g.u.twipsToPixels)}getVerticalBorders(){const e=[],t=this.grid.table.rows,r=this.grid.tableCellInfos;for(var i,n=0;i=t[n];n++){var o=this.rowCellSpacing(n);const c=[],h=i.cells.length-1;var a=i.cells;e.push(c);for(var s,l=0;s=a[l];l++){const e=[];c.push(e);var d=r[n][l];const i=d.getStartRowIndex()!=n?t[d.getStartRowIndex()].cells[d.getCellIndex(0)]:s;if(o>0)0==l?(e.push(this.mergeVerticalBorders(null,null,null,null,!0,this.tblbrdProvider.leftBorder,(e=>Math.floor(this.grid.columns.positions[d.getGridCellIndex()]-e/2)))),e.push(this.mergeVerticalBorders(i,Xr,null,null,!1,this.tblbrdProvider.leftBorder,(e=>Math.floor(this.grid.columns.positions[d.getGridCellIndex()]+2*o))))):e.push(this.mergeVerticalBorders(i,Xr,null,null,!1,this.tblbrdProvider.verticalBorder,(e=>Math.floor(this.grid.columns.positions[d.getGridCellIndex()]+o)))),e.push(this.mergeVerticalBorders(i,Gr,null,null,!1,this.tblbrdProvider.verticalBorder,(e=>Math.floor(this.grid.columns.positions[d.getGridCellIndex()+s.columnSpan]-o*(l==a.length-1?2:1)-e)))),l==h&&e.push(this.mergeVerticalBorders(null,null,null,null,!0,this.tblbrdProvider.rightBorder,(e=>Math.floor(this.getCellEndGridPosition(n,l)-e/2))));else{if(0==l)e.push(this.mergeVerticalBorders(i,Xr,null,null,!0,this.tblbrdProvider.leftBorder,(e=>Math.floor(this.grid.columns.positions[d.getGridCellIndex()]-e/2))));else{const t=a[l-1];e.push(this.mergeVerticalBorders(i,Xr,t,Gr,!1,this.tblbrdProvider.verticalBorder,(e=>Math.floor(this.grid.columns.positions[d.getGridCellIndex()]))))}l==h&&e.push(this.mergeVerticalBorders(i,Gr,null,null,!0,this.tblbrdProvider.rightBorder,(e=>Math.floor(this.getCellEndGridPosition(n,l)-e/2))))}}}return e}getVerticalCursorBorders(){let e=[],t=this.grid.table.rows,r=this.grid.tableCellInfos;for(var i,n=0;i=t[n];n++){let t=[],a=i.cells.length-1;e.push(t);for(var o=0;o<i.cells.length;o++){let e=[];t.push(e),this.rowCellSpacing(n)>0?this.populateVerticalCursorBordersWithSpacing(o,n,a,this.rowCellSpacing(n),e,r[n][o]):this.populateVerticalCursorBorders(o,n,a,e,r[n][o])}}return e}populateVerticalCursorBordersWithSpacing(e,t,r,i,n,o){0==e?n.push(this.createVerticalCursorBorder(this.grid.columns.positions[o.getGridCellIndex()])):n.push(this.createVerticalCursorBorder(this.grid.columns.positions[o.getGridCellIndex()],i)),e==r&&n.push(this.createVerticalCursorBorder(this.grid.columns.positions[this.getCellGridColumnIndex(t,e)]))}populateVerticalCursorBorders(e,t,r,i,n){i.push(this.createVerticalCursorBorder(this.grid.columns.positions[n.getGridCellIndex()])),e==r&&i.push(this.createVerticalCursorBorder(this.grid.columns.positions[this.getCellGridColumnIndex(t,e)]))}getCellGridColumnIndex(e,t){return this.grid.tableCellInfos[e][t].getGridCellIndex()+this.grid.table.rows[e].cells[t].columnSpan}createVerticalCursorBorder(e,t=-1){let r=-1!=t?t:4;return new wz(Math.floor(e-r/2),0,0,(new Me).getLayoutBorder(this.colorProvider))}mergeVerticalBorders(e,t,r,i,n,o,a){const s=Dz.mergeThreeBorders(this.colorProvider,e,t,r,i,n,o,this.tblStyle,g.u.twipsToPixels),l=new Iz(0,0,0,s?s.getLayoutBorder(this.colorProvider):null);return l.borderInfo&&(l.xPos=a(l.borderInfo.width)),l}getHorizontalBordersByRow(e,t,r){const i=[];return this.rowCellSpacing(e)>0?((t||0==e)&&i.push(this.collectTableHorizontalBorders(this.tblbrdProvider.topBorder,e)),i.push(this.collectOneCellAndTableHorizontalBorders(e,Kr,e-1,this.tblbrdProvider.horizontalBorder,!t)),i.push(this.collectOneCellAndTableHorizontalBorders(e,qr,e+1,this.tblbrdProvider.horizontalBorder,!r)),r&&i.push(this.collectTableHorizontalBorders(this.tblbrdProvider.bottomBorder,e))):(t||0==e?i.push(this.collectOneCellAndTableHorizontalBorders(e,Kr,e-1,this.tblbrdProvider.topBorder,!1)):i.push(this.collectThreeBorders(e,Kr,qr,this.tblbrdProvider.horizontalBorder)),r&&i.push(this.collectOneCellAndTableHorizontalBorders(e,qr,e+1,this.tblbrdProvider.bottomBorder,!1))),i}collectTableHorizontalBorders(e,t){const r=this.grid.table.rows[t].cells,i=r.length-1,n=r[i],o=this.grid.tableCellInfos[t][0],a=this.grid.tableCellInfos[t][i],s=new Mz;s.borderInfo=e.getLayoutBorder(this.colorProvider),s.xPosition=Math.floor(this.grid.columns.positions[o.getGridCellIndex()]),s.length=Math.ceil(this.grid.columns.positions[a.getGridCellIndex()+n.columnSpan])-s.xPosition;const l=new vz(!0);return l.borders.push(s),l.updateWidth(e?e.width:0),l}collectOneCellAndTableHorizontalBorders(e,t,r,i,n){const o=this.grid.table.rows[e].cells,a=this.rowCellSpacing(e),s=new vz(!0);for(let l,d=0;l=o[d];d++){const c=this.grid.tableCellInfos[e][d],h=c.getGridCellIndex();if(c==(n?this.grid.tableCellGridInfos[r][h]:null))continue;const u=Math.floor(this.grid.columns.positions[h]+a*(0==d?2:1)),p=Math.ceil(this.grid.columns.positions[h+l.columnSpan]-a*(d==o.length-1?2:1)),m=t?Ez.borderConvertToPixels(new t(l.parentRow.tablePropertiesException,!n).getProperty(l.properties,this.tblStyle,l.conditionalFormatting,null),g.u.twipsToPixels):null,f=new Mz;f.xPosition=u,f.length=p-u;const b=m||i;f.borderInfo=b?b.getLayoutBorder(this.colorProvider):null,s.borders.push(f),s.updateWidth(f.borderInfo?f.borderInfo.width:0)}return s}collectThreeBorders(e,t,r,i){const n=new vz(!0),o=this.grid.columns.numColumns,a=e-1,s=this.grid.tableCellGridInfos[a],l=this.grid.tableCellGridInfos[e],d=this.grid.table.rows[a].cells,c=this.grid.table.rows[e].cells;for(let h=0;h<o;h++){const o=s[h],u=l[h];if(!o&&!u||o&&a!=o.getStartRowIndex()+o.getNumRowsInCell()-1)continue;let p=o?d[o.getCellIndex(a-o.getStartRowIndex())]:null,m=u?c[u.getCellIndex(e-u.getStartRowIndex())]:null;const f=new Mz;f.xPosition=Math.floor(this.grid.columns.positions[h]),f.length=Math.ceil(this.grid.columns.width[h]);const b=Dz.mergeThreeBorders(this.colorProvider,m,t,p,r,!1,i,this.tblStyle,g.u.twipsToPixels);f.borderInfo=b?b.getLayoutBorder(this.colorProvider):null,n.updateWidth(f.borderInfo?f.borderInfo.width:0),n.borders.push(f)}return n}getCellEndGridPosition(e,t){const r=this.grid.tableCellInfos[e][t].getGridCellIndex()+this.grid.table.rows[e].cells[t].columnSpan;return Math.ceil(this.grid.columns.positions[r])}static mergeThreeBorders(e,t,r,i,n,o,a,s,l){let d;if(t&&i)d=AT.getPowerfulBorder(e,Ez.borderConvertToPixels(new r(t.parentRow.tablePropertiesException,o).getProperty(t.properties,s,t.conditionalFormatting,null),l),Ez.borderConvertToPixels(new n(i.parentRow.tablePropertiesException,o).getProperty(i.properties,s,i.conditionalFormatting,null),l));else{const e=t||i;e&&(d=Ez.borderConvertToPixels(new(r||n)(e.parentRow.tablePropertiesException,o).getProperty(e.properties,s,e.conditionalFormatting,null),l))}return d||(d=a),d}static getLeftBorder(e,t,r,i,n){return Dz.getRightLeftBorder(e,t,r,i,n,0==t.cellIndex,Xr,Gr)}static getRightBorder(e,t,r,i,n){return Dz.getRightLeftBorder(e,t,r,i,n,t.cellIndex==t.row.cells.length-1,Gr,Xr)}static getRightLeftBorder(e,t,r,i,n,o,a,s){const l=t.table.style;return i.cellSpacings[t.rowIndex]>0?Dz.mergeThreeBorders(e,t.cell,a,null,null,o,o?i.leftBorder:i.verticalBorder,l,n):o?Dz.mergeThreeBorders(e,t.cell,a,null,null,o,i.leftBorder,l,n):Dz.mergeThreeBorders(e,t.cell,a,r,s,o,i.verticalBorder,l,n)}}class Fz{get isPercentBased(){return this.type==Je.FiftiethsOfPercent}constructor(e){this.width=e.type==Je.ModelUnits?g.u.twipsToPixelsF(e.width):e.width,this.type=e.type,this.percentValue=0,this.preferredWidth=0,this.bounds=new xl.MinMaxNumber(0,0)}updateMinBound(e){e>this.bounds.minElement&&(this.bounds.minElement=e)}updateMaxBound(e){e>this.bounds.maxElement&&(this.bounds.maxElement=e)}static totalMinWidth(e,t=0,r=e.length){let i=0;for(let n=t;n<r;n++)i+=e[n].bounds.minElement;return i}static totalMaxWidth(e,t=0,r=e.length){let i=0;for(let n=t;n<r;n++)i+=e[n].bounds.maxElement;return i}static totalWidth(e,t=0,r=e.length){let i=0;for(let n=t;n<r;n++)i+=e[n].width;return i}static totalPercentWidth(e,t=0,r=e.length){let i=0;for(let n=t;n<r;n++)i+=e[n].percentValue;return i}static totalPreferredWidth(e,t=0,r=e.length){let i=0;for(let n=t;n<r;n++)i+=e[n].preferredWidth;return i}static getLastDXAColumnIndex(e,t=0,r=e.length){for(let i=r-1;i>=t;i--)if(e[i].preferredWidth)return i;return-1}}class Rz extends Fz{}class Lz extends Fz{constructor(e){super(e),this.totalHorizontalMargins=0}static totalHorizontalMargins(e,t,r){let i=0;for(let n=t;n<r;n++)i+=e[n].totalHorizontalMargins;return i}static hasColumnsWithoutPreferredWidth(e,t=0,r=e.length){for(let i=t;i<r;i++)if(!e[i].preferredWidth)return!0;return!1}}class Bz{constructor(e){this.width=f.ListUtils.map(e,(e=>e.width)),this.numColumns=this.width.length;let t=0;if(this.positions=f.ListUtils.map(e,(e=>t+=e.width)),this.positions.unshift(0),f.ListUtils.unsafeAnyOf(this.positions,(e=>isNaN(e)||e<0)))throw new Error(R.D.InternalException)}}class Az{get table(){return this.grid.table}get currCache(){return this.cache[this.table.index]}get subDocument(){return this.boxIterator.subDocument}constructor(e,t,r,i){this.accuracy=8,this.maxPercentWidth=5e3,this.grid=e,this.cache=t,this.boxIterator=r,this.maxTableWidth=i,this.percentBaseWidth=Math.max(0,i-this.currCache.indent.asNumberNoPercentType(g.u.twipsToPixelsF));const n=Dm.getIntervals(this.table);if(f.ListUtils.unsafeAnyOf(n,(e=>1!=e.colSpan)))throw new Error(R.D.InternalException);this.columns=f.ListUtils.map(n,this.makeInterval),this.applyCellsWidth(n),this.autofitTable()}convertTableWidthUnitToTwips(e){return e.type==Je.ModelUnits?e.value:e.type==Je.FiftiethsOfPercent?e.value*g.u.pixelsToTwipsF(this.percentBaseWidth)/this.maxPercentWidth:0}getFixedTableWidthInTwips(){return this.currCache.preferredWidth.type==Je.FiftiethsOfPercent?this.convertTableWidthUnitToTwips(this.currCache.indent)+this.convertTableWidthUnitToTwips(this.currCache.preferredWidth):this.convertTableWidthUnitToTwips(this.currCache.preferredWidth)}calculateEstimatedTableWidth(){let e=this.columns.length,t=0,r=0,i=0;for(let n=0;n<e;n++){const e=this.columns[n],o=Math.max(e.bounds.maxElement,e.bounds.minElement);e.isPercentBased&&e.percentValue>0?(t=Math.max(o*this.maxPercentWidth/e.percentValue,t),r+=e.percentValue):i+=o}if(0==i&&r>0)return t;const n=this.maxPercentWidth-r;return n<=0?this.maxTableWidth:(t=Math.max(i*this.maxPercentWidth/n,t),Math.min(t,this.maxTableWidth))}getColumns(){return new Bz(this.columns)}autofitTable(){const e=this.currCache.isFixedTableWidth?g.u.twipsToPixelsF(this.getFixedTableWidthInTwips()):this.calculateEstimatedTableWidth();let t=this.columns.length,r=e,i=0,n=0,o=0,a=0,s=0;for(let e=0;e<t;e++){const t=this.columns[e];t.isPercentBased&&t.percentValue>0?s+=t.percentValue:!t.isPercentBased&&t.preferredWidth>0?(o+=t.preferredWidth,a+=t.bounds.minElement):(i+=t.bounds.maxElement,n+=t.bounds.minElement)}r=this.autofitPercentWidthColumns(e,s,0!=o||0!=n),r=this.autofitModelUnitWidthColumns(r,o,a,n),this.autofitNoSetWidthColumns(r,n,i);for(let e=0;e<t;e++){const t=this.columns[e];t.width=Math.max(t.width,t.bounds.minElement)}this.autofitTail(Fz.totalWidth(this.columns),e)}autofitNoSetWidthColumns(e,t,r){if(e>0){const i=r-e,n=r-t;i>0&&n>i?this.compressWidthProportionallyOfDifferenceMaxAndMinWidth(i,n,(e=>e.isPercentBased||e.preferredWidth>0)):this.enlargeWidthProportionallyMaxWidth(r,e,(e=>!e.isPercentBased&&0==e.preferredWidth))}}compressWidthProportionallyOfDifferenceMaxAndMinWidth(e,t,r){for(let i=this.columns.length-1;i>=0&&e>0&&t>0;i--){const n=this.columns[i];if(r(n))continue;const o=(n.bounds.maxElement-n.bounds.minElement)*e/t;n.width=n.bounds.maxElement-o,t-=n.bounds.maxElement-n.bounds.minElement,e-=o}}autofitPercentWidthColumns(e,t,r){if(t<=0)return e;let i=Math.min(this.maxPercentWidth,t),n=e;return r&&(i=this.maxPercentWidth),f.ListUtils.forEach(this.columns,(e=>{const t=Math.min(i,e.percentValue);e.percentValue&&e.percentValue>0&&i>0&&(e.width=Math.max(n*t/i,e.bounds.minElement),n-=e.width,i-=t)})),n}autofitModelUnitWidthColumns(e,t,r,i){if(t<=0)return e;if(e>0){const n=t-e+i,o=t-r;n>0&&o>n?this.compressWidthProportionallyOfDifferencePreferredWidthAndMinWidth(n,o,!0):0!=i?this.applyPrefferedWidth():this.enlargeWidthProportionallyMaxWidth(t,e,(e=>!e.isPercentBased&&e.preferredWidth>0))}return e-t}applyPrefferedWidth(){f.ListUtils.forEach(this.columns,(e=>{!e.isPercentBased&&e.preferredWidth>0&&(e.width=e.preferredWidth)}))}compressWidthProportionallyOfDifferencePreferredWidthAndMinWidth(e,t,r=!1){for(let i=this.columns.length-1;i>=0&&e>0&&t>0;i--){const n=this.columns[i];if(n.preferredWidth>0&&(!r||!n.isPercentBased)){const r=(n.preferredWidth-n.bounds.minElement)*e/t;n.width=Math.max(n.preferredWidth-r,Az.minColumnWidth),t-=n.preferredWidth-n.bounds.minElement,e-=r}}}enlargeWidthProportionallyMaxWidth(e,t,r){f.ListUtils.forEach(this.columns,(i=>{r(i)&&e>0&&(i.width=t*i.bounds.maxElement/e,t-=i.width,e-=i.bounds.maxElement)}))}compressTableGrid(e){const t=this.columns.length-1,r=[];let i=0,n=0;for(let e=0;e<=t;e++){n+=this.columns[e].width;const t=Math.max(this.columns[e].width-this.columns[e].bounds.minElement,0);r.push(t),i+=t}const o=n-e;if(i>o)this.compressProportionallyWidthCore(r,i,o);else{for(let e=0;e<=t;e++)this.columns[e].width-=r[e];this.changeColumnsProportionally(0,t,n-i,e)}}compressProportionallyWidthCore(e,t,r){const i=this.columns.length;if(0!=t)for(let n=0;n<i;n++){const i=r*e[n]/t;if(this.columns[n].width-=i,r-=i,0==(t-=e[n]))break}else{let e=r;t=i;for(let n=0;n<i;n++){const o=n!=i-1?r/t:e;this.columns[n].width=Math.max(this.columns[n].width-o,0),e-=o}}}changeColumnsProportionally(e,t,r,i){const n=Math.abs(i-r);let o=n;for(let a=e;a<=t;a++){const e=a!=t?this.columns[a].width*n/r:o;r>i?this.columns[a].width=Math.max(Az.minColumnWidth,this.columns[a].width-e):this.columns[a].width+=e,o-=e}}}Az.minColumnWidth=g.u.twipsToPixelsF(1);class Nz{constructor(e,t,r,i,n){this.containsCellsMergedByHorizontal=!1,this.table=i,this.map={};const o=new Iu(this.table),a=new Qa(this.table,-1,-1);for(;a.moveToNextRow();)for(;a.moveToNextCell();){const i=new _z(e,t,o,r,a,n).cellWidth();this.register(new Oz(new kz(o.tableCellInfos[a.rowIndex][a.cellIndex].getGridCellIndex(),a.cell.columnSpan),i))}}register(e){const t=250*e.pos.columnIndex+e.pos.span,r=this.map[t];r?aW(r.info,e.info):this.map[t]=e,this.containsCellsMergedByHorizontal||(this.containsCellsMergedByHorizontal=e.pos.span>1)}tableWidth(){if(!this.containsCellsMergedByHorizontal){let e=0,t=0;return b.j.forEach(this.map,(r=>{e+=r.info.minElement,t+=r.info.maxElement})),new xl.MinMaxNumber(e,t)}let e=b.j.toList(this.map);e=e.sort(((e,t)=>{const r=e.pos.columnIndex-t.pos.columnIndex;return r||e.pos.span-t.pos.span}));const t=e.length,r=f.ListUtils.initByCallback(t+1,(()=>new xl.MinMaxNumber(0,0)));for(let i of e){const e=r[i.pos.columnIndex],n=new xl.MinMaxNumber(e.minElement+i.info.minElement,e.maxElement+i.info.maxElement);for(let e=i.pos.endColumnIndex;e<t;e++){const t=r[e];if(t.minElement>n.minElement&&t.maxElement>n.maxElement)break;aW(t,n)}}return r[t-1]}}class kz{constructor(e,t){this.columnIndex=e,this.span=t}get endColumnIndex(){return this.columnIndex+this.span}}class Oz{constructor(e,t){this.pos=e,this.info=t}}class _z{constructor(e,t,r,i,n,o){this.subDocument=e,this.boxIterator=t,this.cache=i,this.pos=n,this.percentBaseWidth=o,this.grid=r}cellWidth(){const e=this.cache[this.grid.table.index],t=this.grid.tableCellInfos[this.pos.rowIndex][this.pos.cellIndex];if(this.pos.cell.verticalMerging==Xe.Continue)return e.rows[t.getStartRowIndex()].cells[t.getCellIndexAbs(t.getStartRowIndex())].contentWidthsInfo;const r=this.pos.table,i=t.getStartRowIndex();this.pos=new Qa(r,i,t.getCellIndexAbs(i)).init();const n=e.rows[this.pos.rowIndex].cells[this.pos.cellIndex],o=n.leftBorderWidth+n.rightBorderWidth,a=this.pos.cell.preferredWidth,s=a.asNumber(this.percentBaseWidth,g.u.twipsToPixelsF);if(e.layoutType==Oe.Fixed){const e=n.horizontalMargins+n.spacing+o,t=Math.max(e,s);return n.contentWidthsInfo=new xl.MinMaxNumber(t,t)}{let e=this.cellWidthCore(this.pos);if(n.noWrap&&a.type!=Je.ModelUnits){const t=Math.max(e.minElement,e.maxElement);e=new xl.MinMaxNumber(t,t)}let t=e.minElement+n.horizontalMargins+n.spacing+o;n.noWrap&&a.type==Je.ModelUnits&&(t=Math.max(s,t)),t=Math.min(Bo.Constants.MAX_SAFE_INTEGER,t);let r=e.maxElement+n.horizontalMargins+n.spacing+o;return a.type==Je.ModelUnits&&(r=Math.max(t,s)),r=Math.min(Bo.Constants.MAX_SAFE_INTEGER,r),n.contentWidthsInfo=new xl.MinMaxNumber(t,r)}}getTableWidth(e,t){const r=e.preferredWidth,i=e.getActualTableIndent(this.subDocument.documentModel.defaultTableProperties),n=new Nz(this.subDocument,this.boxIterator,this.cache,e,0).tableWidth();if(r.type!=Je.Nil&&r.type!=Je.Auto){const e=r.asNumber(t,g.u.twipsToPixelsF)+i.asNumber(t,g.u.twipsToPixelsF);aW(n,new xl.MinMaxNumber(e,e))}return n}getInnerTables(e){var t;const r=e.table.nestedLevel+1,i=this.boxIterator.subDocument.tablesByLevels[r];return null!==(t=null==i?void 0:i.filter((t=>t.parentCell===e.cell)))&&void 0!==t?t:[]}cellWidthCore(e){const t=this.boxIterator.subDocument,r=t.paragraphs;let i=new xl.MinMaxNumber(0,0);const n=this.getInnerTables(e);for(let e of n)aW(i,this.getTableWidth(e,0));for(let o of nn.IntervalAlgorithms.reflectIntervals(f.ListUtils.map(n,(e=>e.interval)),e.cell.interval)){const e=t.getParagraphIndexByPosition(o.start),n=o.end;for(let t,o=e;(t=r[o])&&t.startLogPosition.value<n;o++)aW(i,this.boxIterator.getParagraphBounds(o))}return i}}class Uz extends Az{makeInterval(e){return new Lz(e)}applyCellsWidth(e){this.calcCacheCellWidths(),this.applyCellContentWidth()}autofitTail(e,t){if(this.currCache.layoutType==Oe.Fixed)return;const r=Fz.totalMinWidth(this.columns);let i=r;t<=this.percentBaseWidth&&(i=Math.min(i,this.percentBaseWidth)),i=Math.max(t,i),this.currCache.isFixedTableWidth||(i=Math.min(this.percentBaseWidth,i)),e>i&&(i>r?this.compressTableGrid(i):this.compressProportionallyMinWidth(i,r))}compressProportionallyMinWidth(e,t){for(let r=0;r<this.columns.length;r++){const i=this.columns[r],n=t>0?Math.max(i.bounds.minElement*e/t,Az.minColumnWidth):Az.minColumnWidth;i.width=n,e-=n,t-=i.bounds.minElement}}calcCacheCellWidths(){const e=new Qa(this.table,-1,-1);for(;e.moveToNextRow();)for(;e.moveToNextCell();)new _z(this.subDocument,this.boxIterator,this.grid,this.cache,e,this.percentBaseWidth).cellWidth()}applyCellContentWidth(){const e=new Qa(this.table,-1,-1);for(;e.moveToNextRow();){let t=e.row.gridBefore;for(;e.moveToNextCell();)1==e.cell.columnSpan&&this.applyCellContentWidthWithoutSpan(this.columns,e,t),t+=e.cell.columnSpan}for(let e of this.columns)0==e.bounds.minElement&&0==e.bounds.maxElement&&(e.isPercentBased?e.bounds.minElement=e.bounds.maxElement=1:e.bounds.minElement=e.bounds.maxElement=Math.max(1,e.width));for(e.initIndexes(-1,-1);e.moveToNextRow();){let t=e.row.gridBefore;for(;e.moveToNextCell();)e.cell.columnSpan>1&&this.applyCellContentWidthWithSpan(this.columns,e,t),t+=e.cell.columnSpan}for(let e of this.columns)e.width=e.bounds.maxElement=Math.max(e.bounds.maxElement,Az.minColumnWidth)}applyCellContentWidthWithoutSpan(e,t,r){const i=this.currCache.rows[t.rowIndex].cells[t.cellIndex],n=i.contentWidthsInfo,o=Math.max(Az.minColumnWidth,n.minElement);let a=Math.max(Az.minColumnWidth,n.maxElement);const s=e[r];s.updateMinBound(o),s.updateMaxBound(a),s.totalHorizontalMargins=Math.max(s.totalHorizontalMargins,i.horizontalMargins);const l=t.cell.preferredWidth,d=l.type;if(d==Je.FiftiethsOfPercent)if(l.value>0){s.type=Je.FiftiethsOfPercent;const e=Math.min(this.maxPercentWidth,l.value);s.percentValue=Math.max(e,s.percentValue)}else this.currCache.isFixedTableWidth&&this.applyPreferredWidth(s,o,0);else d==Je.ModelUnits&&this.applyPreferredWidth(s,o,l.asNumber(this.percentBaseWidth,g.u.twipsToPixels))}applyPreferredWidth(e,t,r){r=Math.max(t,r),e.preferredWidth=Math.max(e.preferredWidth,r),e.updateMaxBound(e.preferredWidth)}applyCellContentWidthWithSpan(e,t,r){const i=r+t.cell.columnSpan-1,n=i+1,o=this.currCache.rows[t.rowIndex].cells[t.cellIndex],a=o.contentWidthsInfo,s=Math.max(Az.minColumnWidth,a.minElement);let l=Math.max(Az.minColumnWidth,a.maxElement);const d=t.cell.preferredWidth,c=this.columns[i];if(d.type==Je.FiftiethsOfPercent){const e=Fz.totalPercentWidth(this.columns,r,n),t=Math.min(this.maxPercentWidth,d.value);if(f.ListUtils.allOf(this.columns,(e=>e.isPercentBased),r,n)){const e=Fz.totalPercentWidth(this.columns,r,i);c.percentValue=Math.max(t-e,c.percentValue)}else if(e>0){const i=Math.max(0,t-e);let o=0;f.ListUtils.forEach(this.columns,(e=>{e.isPercentBased||(o+=e.bounds.maxElement)}),r,n),f.ListUtils.forEach(this.columns,(e=>{e.isPercentBased||(e.percentValue=Math.max(1,i*e.bounds.maxElement/o),e.type=Je.FiftiethsOfPercent)}),r,n)}}else if(d.type==Je.ModelUnits){let e=d.asNumber(this.percentBaseWidth,g.u.twipsToPixelsF);if(e=Math.max(s,e),l=e,f.ListUtils.allOf(this.columns,(e=>!e.isPercentBased&&e.preferredWidth>0),r,n)){const t=Fz.totalMaxWidth(this.columns,r,i);c.preferredWidth=Math.max(c.preferredWidth,e-t),c.updateMaxBound(c.preferredWidth);return void(s>Fz.totalMinWidth(this.columns,r,n)&&this.enlargeColumnsMinWidthByPreferredWidth(r,i,s,e))}}s>Lz.totalMinWidth(e,r,n)&&this.enlargeColumnsMinWidth(e,r,n,s);const h=Lz.totalMaxWidth(e,r,n);l>h&&this.enlargeColumnsMaxWidth(e,r,n,h,l);const u=Lz.totalHorizontalMargins(e,r,n);o.horizontalMargins>u&&this.enlargeColumnsHorizontalMargins(e,r,n,u,o.horizontalMargins)}enlargeColumnsMinWidthByPreferredWidth(e,t,r,i){let n=r,o=i;for(let r=t;r>=e;r--){const e=this.columns[r];e.preferredWidth>0&&o>0&&(e.bounds.minElement=e.preferredWidth*n/o,e.updateMaxBound(e.bounds.minElement),n-=e.bounds.minElement,o-=e.preferredWidth)}}enlargeColumnsHorizontalMargins(e,t,r,i,n){const o=0==i;let a=n-i,s=r-t+1;for(let t,n=r-1;(t=e[n])&&a>0;n--){const e=o?a/s:a*t.totalHorizontalMargins/i;a-=e,i-=t.totalHorizontalMargins,t.totalHorizontalMargins+=e,s--}}enlargeColumnsMinWidth(e,t,r,i){const n=Lz.hasColumnsWithoutPreferredWidth(e,t,r);let o=0,a=0;f.ListUtils.forEach(e,(e=>{0==e.bounds.minElement&&0==e.bounds.maxElement?o++:a+=e.bounds.minElement}),t,r);let s=Lz.totalMaxWidth(e,t,r)+Lz.totalMinWidth(e,t,r);const l=0==s;(l||o>0)&&(s=r-t,i-=a),f.ListUtils.reverseForEach(e,(e=>{if(!n||0==e.preferredWidth){if(o>0&&(e.bounds.minElement>0||e.bounds.maxElement>0))return;const t=l||o>0?1:e.bounds.minElement+e.bounds.maxElement,r=t*i/s;s-=t,i-=r,e.updateMinBound(r),e.updateMaxBound(e.bounds.minElement)}}),r-1,t)}enlargeColumnsMaxWidth(e,t,r,i,n){const o=f.ListUtils.allOf(e,(e=>0!=e.preferredWidth),t,r);let a=i;f.ListUtils.reverseForEach(e,(e=>{if(o||0==e.preferredWidth){const t=0!=a?e.bounds.maxElement*n/a:0;a-=e.bounds.maxElement,a<0&&(a=0),(n-=t)<0&&(n=0),e.bounds.maxElement=Math.max(Az.minColumnWidth,t)}}),r-1,t)}}class Hz extends Az{makeInterval(e){return new Rz(e)}autofitTail(e,t){e.toFixed(this.accuracy)>t.toFixed(this.accuracy)&&this.compressTableGrid(t)}applyCellsWidth(e){let t=0,r=0,i=0;for(let n=0;n<e.length;n++){const o=e[n];switch(o.type){case Je.FiftiethsOfPercent:t+=o.width,t>this.maxPercentWidth&&(o.width=Math.max(0,this.maxPercentWidth-t+o.width),t=this.maxPercentWidth);break;case Je.ModelUnits:r+=o.width;break;case Je.Auto:case Je.Nil:i++}}let n=this.getFixedTableWidthInTwips(),o=n;0==r&&0==i||(o=n*t/this.maxPercentWidth);let a=n;o>0&&(a=Math.min(n-o,r));let s=n-r-o;for(let n=0;n<e.length;n++){const l=this.columns[n],d=e[n];let c=0;switch(d.type){case Je.FiftiethsOfPercent:l.type=Je.FiftiethsOfPercent,l.percentValue=d.width,c=o*d.width/t;break;case Je.ModelUnits:d.width>0&&(c=a*d.width/r,a-=c,r-=d.width);break;case Je.Auto:case Je.Nil:c=s/i,s-=c,i--}c=Math.max(Az.minColumnWidth,c),c=g.u.twipsToPixelsF(c),l.updateMinBound(c),l.updateMaxBound(c)}}}class Vz{get isFixedTableWidth(){const e=this.preferredWidth.type;return e==Je.FiftiethsOfPercent||e==Je.ModelUnits}get isFixedAlgoritm(){return this.layoutType==Oe.Fixed&&this.isFixedTableWidth}constructor(e,t,r,i){this.borderProvider=new Ez(e,t,g.u.twipsToPixels),this.indent=t.getActualTableIndent(e.defaultTableProperties),i.viewsSettings.isSimpleView&&0==t.nestedLevel&&this.indent.value<0&&(this.indent=this.indent.clone(),this.indent.value=0),this.layoutType=t.getActualTableLayout(e.defaultTableProperties),this.preferredWidth=this.getActualPreferredWidth(t);const n=new Qa(t,-1,-1);for(this.rows=[];n.moveToNextRow();)this.rows.push(new Wz(e,this.borderProvider,n,this.rows,r))}getActualPreferredWidth(e){let t=e.preferredWidth;return t.type==Je.ModelUnits&&0==t.value&&(t=lr.createDefault()),t}}class Wz{constructor(e,t,r,i,n){for(this.cells=[];r.moveToNextCell();)if(r.cell.verticalMerging==Xe.Continue){const e=n.tableCellInfos[r.rowIndex][r.cellIndex],t=e.getStartRowIndex();this.cells.push(i[t].cells[e.getCellIndexAbs(t)])}else this.cells.push(new zz(e,t,r))}}class zz{constructor(e,t,r){const i=r.table.style,n=e.defaultTableCellProperties;this.noWrap=(new Yr).getProperty(r.cell.properties,i,r.cell.conditionalFormatting,n),this.horizontalMargins=Yz.getCellMargin(r.cell.getActualLeftCellMargin(e))+Yz.getCellMargin(r.cell.getActualRightCellMargin(e)),this.leftBorderWidth=Dz.getLeftBorder(e.colorProvider,r,r.row.cells[r.cellIndex-1],t,g.u.twipsToPixels).width,this.rightBorderWidth=Dz.getRightBorder(e.colorProvider,r,r.row.cells[r.cellIndex+1],t,g.u.twipsToPixels).width,this.spacing=t.cellSpacings[r.rowIndex]*(0==r.cell.parentRow.gridBefore&&0==r.cellIndex||0==r.cell.parentRow.gridAfter&&r.cellIndex==r.row.cells.length-1?3:2)}}class jz{getContentModelPosition(e){const t=this.innerFormatter;return t&&t.tableInfo.table.nestedLevel<=e?t.tableInfo.currCellInfo.getContentModelPosition(e):this.contentModelPosition}get xContentInterval(){return this.actualCellInfo._xContentInterval}get xInterval(){return this.actualCellInfo._xInterval}get currLayoutRowContentWidth(){return this.innerFormatter?this.innerFormatter.tableInfo.currCellInfo.currLayoutRowContentWidth:this.actualCellInfo.xContentInterval.length}get nestedTableMaxWidth(){return this.actualCellInfo.xContentInterval.length}getCurrLayoutRowOffset(e){return e&&this.innerFormatter?this.innerFormatter.tableInfo.currCellInfo.getCurrLayoutRowOffset(!0):new Xc.Point(this.xContentInterval.start,this.currLayoutTableCellInfo.bottom)}get isSomeLayoutRowsPlaced(){return this.cell.startParagraphPosition.value!=this.contentModelPosition}get heightBeforeContent(){return this.actualCellInfo._heightBeforeContent}get heightAfterContent(){return this.actualCellInfo._heightAfterContent}get tableInfo(){return this.rowInfo.tableInfo}get cell(){return this.rowInfo.row.cells[this.cellIndex]}get isContendFullyPlaced(){return this.actualCellInfo._contentModelPosition==this.actualCellInfo.cell.endParagrapPosition.value}get formattingSuspended(){return this._formattingSuspended}get currLayoutTableCellInfo(){return this.actualCellInfo._currLayoutTableCellInfo}get contentModelPosition(){return this.actualCellInfo._contentModelPosition}get actualTableIndexes(){return new Ya(this.actualCellInfo.rowInfo.rowIndex,this.actualCellInfo.cellIndex)}get minBottomPosition(){return this.actualCellInfo._minBottomPosition}get innerFormatter(){return this.actualCellInfo._innerFormatter}set innerFormatter(e){this.actualCellInfo._innerFormatter=e}set isStartOnThisColumn(e){this.actualCellInfo._isStartOnThisColumn=e}set minBottomPosition(e){this.actualCellInfo._minBottomPosition=Math.max(e,this.actualCellInfo._minBottomPosition)}get marginLeft(){return this.actualCellInfo._marginLeft}get marginRight(){return this.actualCellInfo._marginRight}constructor(e,t){this._isStartOnThisColumn=!1,this._formattingSuspended=!1,this.cellIndex=e,this.rowInfo=t,this.actualCellInfo=this.getActuallCellInfo(),this.init()}getActuallCellInfo(){if(this.cell.verticalMerging!=Xe.Continue)return this;const e=this.tableInfo.grid.tableCellInfos[this.rowInfo.rowIndex][this.cellIndex];return this.tableInfo.rows[e.getStartRowIndex()].cells[e.getCellIndex(0)]}cellFullyFormatted(){this.cellPartiallyFormatted(this.actualCellInfo.cell.endParagrapPosition.value)}cellPartiallyFormatted(e){this.formattingSuspended||(this.actualCellInfo._contentModelPosition=e)}undoContentModelPosition(){this.actualCellInfo._contentModelPosition=this.actualCellInfo._savedContentModelPosition}storeContentModelPosition(){this.actualCellInfo._savedContentModelPosition=this.actualCellInfo._contentModelPosition}init(){const e=this.cell;if(e.verticalMerging==Xe.Continue)return this._xInterval=null,this._xContentInterval=null,this._heightBeforeContent=null,this._heightAfterContent=null,this._marginLeft=null,this._marginRight=null,void(this._savedContentModelPosition=this._contentModelPosition=null);const t=this.rowInfo.rowIndex,r=0==this.cellIndex,i=this.rowInfo.row.cells.length-1==this.cellIndex,n=this.tableInfo.grid.tableCellInfos[t][this.cellIndex],o=this.rowInfo.cellSpacing;this._marginLeft=Yz.getCellMargin(e.getActualLeftCellMargin(this.tableInfo.model)),this._marginRight=Yz.getCellMargin(e.getActualRightCellMargin(this.tableInfo.model));const a=this.tableInfo.xPositionStart+this.tableInfo.grid.columns.positions[n.getGridCellIndex()],s=this.tableInfo.xPositionStart+this.tableInfo.grid.columns.positions[n.getGridCellIndex()+e.columnSpan],l=this.tableInfo.verticalBorders[t][this.cellIndex],d=l[o>0&&r?1:0],c=Math.max(a+this._marginLeft+o*(r?2:1),d.borderInfo?this.tableInfo.xPositionStart+d.xPos+d.borderInfo.width:-Number.MAX_VALUE);let h;h=o>0||i?l[l.length-(o>0&&i?2:1)]:this.tableInfo.verticalBorders[t][this.cellIndex+1][0];const u=Math.min(s-(this._marginRight+o*(i?2:1)),h.borderInfo?this.tableInfo.xPositionStart+h.xPos:Bo.Constants.MAX_SAFE_INTEGER);this._xInterval=on.FixedInterval.fromPositions(a,s),this._xContentInterval=on.FixedInterval.fromPositions(c,u),this._savedContentModelPosition=this._contentModelPosition=e.startParagraphPosition.value}initLayoutInfo(){const e=0==this.tableInfo.currRowInfo.rowIndex,t=this.tableInfo.currRowInfo.rowIndex==this.tableInfo.rows.length-1;this.actualCellInfo._minBottomPosition=0;const r=this.rowInfo.cellSpacing,i=this.tableInfo.currRowHorizontalBorders.length-1,n=this.tableInfo.currRowHorizontalBorders[0].maxWidth,o=this.tableInfo.currRowHorizontalBorders[i].maxWidth;this.actualCellInfo._heightBeforeContent=(e?n:n/2)+this.rowInfo.topAndBottomMargins.topMargin,this.actualCellInfo._heightAfterContent=(t?o:o/2)+this.rowInfo.topAndBottomMargins.bottomMargin,r>0&&(this.actualCellInfo._heightBeforeContent+=r*(this.tableInfo.isThisColumnFirstInTable?2:1)+(this.tableInfo.isThisTableRowFirstInColumn?this.tableInfo.currRowHorizontalBorders[1].maxWidth:0),this.actualCellInfo._heightAfterContent+=this.tableInfo.currRowHorizontalBorders[i-1].maxWidth+(this.tableInfo.isCurrRowLastInTable?2:1)*r),this.actualCellInfo._currLayoutTableCellInfo=new Wa(this.rowInfo.currLayoutTableRowInfo,new Va.Rectangle(this.xInterval.start,this.tableInfo.currRowInfo.currLayoutTableRowInfo.y,this.xInterval.length,this.actualCellInfo._heightBeforeContent),this.tableInfo.grid.tableCellInfos[this.rowInfo.rowIndex][this.cellIndex].getGridCellIndex(),this.xContentInterval.length),this.actualCellInfo._isStartOnThisColumn&&this.currLayoutTableCellInfo.boundFlags.set(_a.StartOnThisColumn,!1)}clearLayoutInfo(){this.actualCellInfo._heightAfterContent=null,this.actualCellInfo._heightBeforeContent=null,this.actualCellInfo._currLayoutTableCellInfo=null}suspendFormatting(){this._formattingSuspended=!0}resumeFormatting(){this._formattingSuspended=!1}}class Xz{constructor(e){this.tableInfo=e}getFirstNotFullyRenderedCell(e){const t=f.ListUtils.unsafeAnyOf(this.tableInfo.rows,((e,t)=>this.getNextPositionOnRow(t,0,!1,!0,(()=>!0))),e);return f.ListUtils.allOf(this.tableInfo.table.rows[e].cells,((t,r)=>{const i=this.tableInfo.rows[e].cells[r];return i.isContendFullyPlaced||e<this.tableInfo.grid.tableCellInfos[e][r].getEndRowIndex()-1&&i.isSomeLayoutRowsPlaced}))?this.getFirstNotFullyRenderedCell(e+1):t}getNextPos(e){const t=this.tableInfo.grid.tableCellInfos[e.rowIndex][e.cellIndex],r=t.getGridCellIndex()+t.getColumnSpan(this.tableInfo.grid.table),i=this.getNextPositionOnRow(e.rowIndex,r,!1,!1,(()=>!0));if(i)return i;if(this.getNextPositionOnRow(e.rowIndex,0,!0,!0,(t=>t.getEndRowIndex()-1==e.rowIndex)))return null;const n=f.ListUtils.unsafeAnyOf(this.tableInfo.rows,((e,t)=>this.getNextPositionOnRow(t,0,!1,!1,(e=>e.getStartRowIndex()==t))),e.rowIndex+1);if(n&&n.rowIndex>e.rowIndex+1){const e=n.rowIndex-1,t=this.tableInfo.rows[e].cells;let r=!1;for(let i,n=0;i=t[n];n++){const t=this.tableInfo.grid.tableCellInfos[e][n];if(t.getLastRowIndex()>e){r=!1;break}t.getLastRowIndex()==e&&(i.isContendFullyPlaced||(r=!0))}if(r)return null}return n}isTableFullyFormatted(){return!this.getNextPositionOnRow(this.tableInfo.rows.length-1,0,!0,!0,(()=>!0))}getNextPositionOnRow(e,t,r,i,n){const o=this.tableInfo.grid.columns.positions.length-1,a=this.tableInfo.grid.tableCellGridInfos[e],s=this.tableInfo.grid.table;for(let l=t;l<o;){const t=a[l];if(t){if(n(t)&&!this.isCellContendFullyPlaced(t)&&(i||!this.cellRenderedOnThisColumn(t)))return new Ya(e,t.getCellIndex(e-t.getStartRowIndex()));l+=t.getColumnSpan(s)}else{if(r){const r=this.tableInfo.grid.tableCellGridInfos[e-1];if(r){const n=r[l];if(n&&!this.isCellContendFullyPlaced(n)&&(i||!this.cellRenderedOnThisColumn(t)))return new Ya(e-1,n.getCellIndex(e-1-n.getStartRowIndex()))}}l++}}return null}isCellContendFullyPlaced(e){const t=e.getStartRowIndex(),r=e.getCellIndex(0);return this.tableInfo.rows[t].cells[r].isContendFullyPlaced}cellRenderedOnThisColumn(e){const t=e.getGridCellIndex(),r=e.getStartRowIndex(),i=this.tableInfo.currLayoutTableColumnInfo.tableRows;for(let e,n=i.length-1;(e=i[n])&&e.rowIndex>=r;n--)if(e.getCellIndexByExactlyCellGridIndex(t)>=0)return!0;return!1}}class Gz{constructor(){this.topMargin=0,this.bottomMargin=0}addCellTopMargin(e){this.topMargin<e&&(this.topMargin=e)}addCellBottomMargin(e){this.bottomMargin<e&&(this.bottomMargin=e)}sumOfBoth(){return this.topMargin+this.bottomMargin}}class Kz{constructor(e,t,r){this.cantSplit=e,this.preferredHeightValue=g.u.twipsToPixelsF(t.value),this.preferredHeightType=t.type,this.contentHeight=0,this.horizontalAlignment=r}}class qz{get row(){return this.tableInfo.table.rows[this.rowIndex]}constructor(e,t){this.cells=[],this.tableInfo=e,this.rowIndex=t,this.howManyColumnsConsiderTableRow=0,this.init()}init(){const e=this.row,t=(new Ga).getProperty(e.properties,this.tableInfo.tableStyle,e.conditionalFormatting,this.tableInfo.defaultTblRowProps),r=new Ka(e.tablePropertiesException).getProperty(e.properties,this.tableInfo.tableStyle,e.conditionalFormatting,this.tableInfo.defaultTblRowProps);this.heightInfo=new Kz(t,e.height,r),this.cellSpacing=new Xa(this.tableInfo.model,this.tableInfo.table,e.tablePropertiesException).getProperty(e.properties,this.tableInfo.tableStyle,e.conditionalFormatting,this.tableInfo.defaultTblRowProps).asNumberNoPercentType(g.u.twipsToPixels),this.topAndBottomMargins=new Gz;for(let t of e.cells)t.verticalMerging!=Xe.Continue&&(this.topAndBottomMargins.addCellTopMargin(Yz.getCellMargin(t.getActualTopCellMargin(this.tableInfo.model))),this.topAndBottomMargins.addCellBottomMargin(Yz.getCellMargin(t.getActualBottomCellMargin(this.tableInfo.model))))}initLayoutInfo(e,t){const r=f.ListUtils.last(this.tableInfo.currLayoutTableColumnInfo.tableRows);this.currLayoutTableRowInfo=new fz(this.tableInfo.currLayoutTableColumnInfo,new Va.Rectangle(this.tableInfo.xPositionStart,r?r.bottom:this.tableInfo.currLayoutTableColumnInfo.y,0,0),this.tableInfo.minRowIndex),this.tableInfo.currRowHorizontalBorders=this.tableInfo.bordersHelper.getHorizontalBordersByRow(this.currLayoutTableRowInfo.rowIndex,this.tableInfo.isThisTableRowFirstInColumn||e,!0);for(let e of this.cells)e.initLayoutInfo();this.layoutRowIndexInColumn=t.rows.length}clearLayoutInfo(){this.currLayoutTableRowInfo=null,this.tableInfo.currRowHorizontalBorders=null;for(let e of this.cells)e.clearLayoutInfo()}}class $z{get table(){return this.position.table}get tableStyle(){return this.table.style}get tblProps(){return this.table.properties}get defaultTblProps(){return this.model.defaultTableProperties}get defaultTblRowProps(){return this.model.defaultTableRowProperties}get defaultTblCellProps(){return this.model.defaultTableCellProperties}get currRowInfo(){return this.rows[this.position.rowIndex]}get currCellInfo(){return this.currRowInfo.cells[this.position.cellIndex]}get isThisTableRowFirstInColumn(){return 0==this.currLayoutTableColumnInfo.tableRows.length}get isCurrRowLastInTable(){return this.position.rowIndex==this.grid.table.rows.length-1}get currTablePositionIndexes(){const e=this.currCellInfo;return new Ya(e.rowInfo.rowIndex,e.cellIndex)}get isSimpleView(){return this.rowFormatter.manager.innerClientProperties.viewsSettings.isSimpleView}constructor(e,t,r,i,n,o){this.minRowIndex=0,this.verticalBorders=[],this.verticalCursorBorders=[],this.isThisColumnFirstInTable=!0,this.pageIndexFromWhichTableWasMoved=null,this.rowFormatter=e,this.model=this.rowFormatter.manager.model,this.maxWidth=r,this.columnWidth=r,this.position=new Qa(t,0,0).init(),this.bordersHelper=new Dz(this,this.model),this.pageIndexFromWhichTableWasMoved=o,this.init(i,n),this.rows=f.ListUtils.map(this.table.rows,((e,t)=>new qz(this,t))),this.verticalBorders=this.bordersHelper.getVerticalBorders(),this.verticalCursorBorders=this.bordersHelper.getVerticalCursorBorders();for(let e of this.rows)e.cells=f.ListUtils.map(e.row.cells,((t,r)=>new jz(r,e)));this.cellOrderHelper=new Xz(this)}static checkIsTableCannotBePlacedOnCurrentPage(e,t,r,i){return this.moveRowDownToFitTable(e,t,r,$z.getEstimatedTableWidth(t,i),i).needNextPage}init(e,t){let r=0,i=0;if(0==this.table.nestedLevel&&!this.model.compatibilitySettings.matchHorizontalTableIndentsToTextEdge&&!this.isSimpleView){const e=this.table.rows[0],t=e.cells[0];r=new Hr(this.table,this.model,e.tablePropertiesException).getProperty(t.properties,this.tableStyle,t.conditionalFormatting,null).asNumberNoPercentType(g.u.twipsToPixels),i=new Vr(this.table,this.model,e.tablePropertiesException).getProperty(t.properties,this.tableStyle,t.conditionalFormatting,null).asNumberNoPercentType(g.u.twipsToPixels)}const n=$z.moveRowDownToFitTable(this.rowFormatter,this.table,t,$z.getEstimatedTableWidth(this.table,this.maxWidth),this.maxWidth);this.maxWidth=this.maxWidth+(n.xDiff?-n.xDiff:r+i),this.grid=function(e,t,r,i){const n=t.subDocument,o=new Iu(e),a={};a[e.index]=new Vz(n.documentModel,e,o,i);const s=e.getEndPosition();for(let t,r=e.index+1;(t=n.tables[r])&&t.getStartPosition()<s;r++)a[t.index]=new Vz(n.documentModel,t,new Iu(t),i);const l=a[e.index];return o.columns=new(l.isFixedAlgoritm?Hz:Uz)(o,a,t,r).getColumns(),o}(this.table,this.rowFormatter.iterator,this.maxWidth,this.rowFormatter.manager.innerClientProperties);let o=this.table.getActualTableIndent(this.defaultTblProps);this.isSimpleView&&0==this.table.nestedLevel&&o.value<0&&(o=o.clone(),o.value=0);const a=o.asNumberNoPercentType(g.u.twipsToPixels);this.xPositionStart=e+a+(n.xDiff?n.xDiff:-r)+this.getShiftHorizontalPosition(e),this.yPositionStart=t+n.yDiff}getShiftHorizontalPosition(e){const t=this.columnWidth-this.grid.commonWidth;if(t>=0)return 0;const r=this.table.getActualTableAlignment();if(r==je.Center){let r=t/2-e;return r<0&&this.isSimpleView&&(r=0),r}return r==je.Right?t-e:0}static getEstimatedTableWidth(e,t){const r=e.preferredWidth,i=3*e.rows[0].getTotalCellsInRowConsiderGrid();return e.properties.layoutType!=Oe.Autofit||r.type!=Je.Auto&&r.type!=Je.Nil?Math.min(e.preferredWidth?e.preferredWidth.asNumber(t,g.u.twipsToPixels):i,t):i}static getRelationByColumnY(e,t){return t-e.pageArea.y-e.column.y}static getRelationByColumnX(e,t){return t-e.pageArea.x-e.column.x}static moveRowDownToFitTable(e,t,r,i,n){const o=e.manager.activeFormatter.layoutPosition;let a=0,s=r;const l=Math.min(e.iterator.getWrap(!1).box.height*t.rows.length,o.column.bottom-s),d=o.column.bottom-l-this.empiricalOffset;let c=!1;if(0==t.nestedLevel&&o.pageArea.subDocument.isMain()){const e=[];b.j.forEach(o.page.anchoredObjectHolder.objects,(i=>{var n;if(i.isInText()&&r<=this.getRelationByColumnY(o,i.y+i.height)&&(null===(n=i.parentCell)||void 0===n?void 0:n.parentRow.parentTable)!==t)return e.push(i)})),e.sort(((e,t)=>e.y-t.y));const h=n-i;a=this.getXDiff(e,s,o,l);for(let t=0;t<e.length&&a>h;t++){const r=e[t],i=this.getRelationByColumnY(o,r.y+r.height)+this.empiricalOffset;if(d<i){a=0,c=!0;break}s=i,a=this.getXDiff(e,s,o,l)}}return{xDiff:a,yDiff:s-r,needNextPage:c}}static getXDiff(e,t,r,i){let n=0;return e.forEach((e=>{e.isInText()&&nn.IntervalAlgorithms.getIntersectionNonNullLength(new on.FixedInterval(this.getRelationByColumnY(r,e.y),e.height),new on.FixedInterval(t,i))&&(n=Math.max(n,this.getRelationByColumnX(r,e.right)+this.empiricalOffset))})),n}initLayoutInfo(e,t,r){this.currColumnHorizontalBorders=[];const i=this.currLayoutTableColumnInfo?this.currLayoutTableColumnInfo.logicInfo:new xz((new Ar).getProperty(this.tblProps,this.tableStyle,qe.WholeTable,this.defaultTblProps).getActualColor(this.model.colorProvider),this.grid,this.pageIndexFromWhichTableWasMoved);this.currLayoutTableColumnInfo=new Tz(t,i,new Va.Rectangle(this.xPositionStart,e,this.grid.commonWidth,0)),this.rows[this.minRowIndex].initLayoutInfo(!0,r)}}$z.empiricalOffset=g.u.inchesToPixels(.07);class Jz{static tableRowContentCompress(e){for(let t of e.rowCells)Jz.cellCompress(t,t.createRectangle())}static tableCompress(e,t){Jz.compress(e,t,!0,!1);const r=e.clone().moveRectangle(-e.x,-e.y);for(let i of e.tableRows)Jz.rowCompress(i,r,t);Jz.compressBorders(e.horizontalBorders,r,!0),Jz.compressBorders(e.horizontalCursorBorders,r,!0),Jz.compressBorders(e.verticalBorders,r,!1),Jz.compressBorders(e.verticalCursorBorders,r,!1)}static compressBorders(e,t,r){const i=[];for(let n of e)(r?Jz.compressHorizontalBorder:Jz.compressVerticalBorder)(n,t)&&i.push(n);e.length!=i.length&&(e.splice(0),f.ListUtils.addListOnTail(e,i))}static rowCompress(e,t,r){Jz.compress(e,r,!0,!1);for(let r of e.backgroundInfos)Jz.compress(r,t,!0,!1);for(let t of e.rowCells)Jz.cellCompress(t,r)}static cellCompress(e,t){Jz.compress(e,t,!0,!1);for(let r of e.layoutRows)Jz.compress(r,t,!0,!0);t=e,b.j.forEach(e.internalTables,(e=>Jz.tableCompress(e,t)))}static compress(e,t,r,i){const n=Va.Rectangle.getIntersection(e,t);if(n)return i&&e.x<t.x&&e.applyXOffsetToBoxes(e.x-t.x),e.setGeomerty(n),!0;if(r){const r=new Va.RectangleDeviation(t,new Xc.Point(e.x,e.y)).calcDeviation().deviation,i=r.get(Va.HitTestDeviation.Right),n=r.get(Va.HitTestDeviation.Bottom),o=i?t.right:e.x,a=n?t.bottom:e.y;e.setPosition(new Xc.Point(o,a)),e.setSize(new so.Size(i?0:Math.min(e.right,t.right)-o,n?0:Math.min(e.bottom,t.bottom)-a))}return!1}static compressVerticalBorder(e,t){if(nn.IntervalAlgorithms.getIntersection(new on.FixedInterval(e.xPos,e.borderInfo.width),new on.FixedInterval(t.x,t.width))){return nn.IntervalAlgorithms.getIntersection(new on.FixedInterval(e.yPos,e.length),new on.FixedInterval(t.y,t.height))?(e.length=Math.min(e.yPos+e.length,t.bottom)-e.yPos,!0):(e.yPos>t.bottom&&(e.yPos=t.bottom,e.length=0),!1)}return e.length=Math.min(e.yPos+e.length,t.bottom)-e.yPos,e.xPos<t.x||(e.xPos=t.right,e.borderInfo.width=0,!1)}static compressHorizontalBorder(e,t){if(nn.IntervalAlgorithms.getIntersection(new on.FixedInterval(e.yPos,e.borderInfo.width),new on.FixedInterval(t.y,t.height))){return nn.IntervalAlgorithms.getIntersection(new on.FixedInterval(e.xPos,e.length),new on.FixedInterval(t.x,t.width))?(e.length=Math.min(e.xPos+e.length,t.right)-e.xPos,!0):(e.xPos>t.right&&(e.xPos=t.right,e.length=0),!1)}return e.length=Math.min(e.xPos+e.length,t.right)-e.xPos,e.yPos<t.y||(e.yPos=t.bottom,e.borderInfo.width=0,!1)}}!function(e){e[e.None=0]="None",e[e.RowAdded=1]="RowAdded",e[e.TableFinished=2]="TableFinished",e[e.GoToNextColumn=4]="GoToNextColumn"}(BV||(BV={}));class Yz{get posToWaitingContinuedFormatterMap(){return 0==this.nestedLevel?this._posToWaitingContinuedFormatterMap:this.parentFormatter.posToWaitingContinuedFormatterMap}get needAddSomeLayoutRows(){return this.columnWasEmpty&&this.noReadyTableRows&&this.tableInfo.currCellInfo.currLayoutTableCellInfo.isEmpty()||!this.tableInfo.rowFormatter.manager.activeFormatter.subDocument.isMain()}get noReadyTableRows(){let e=this;do{if(e.tableInfo.currLayoutTableColumnInfo.tableRows.length)return!1}while(e=e.parentFormatter);return!0}get columnWasEmpty(){return this.parentFormatter?this.parentFormatter.columnWasEmpty:this._columnWasEmpty}get isCurrTableCellFirstInRow(){return 0==this.position.cellIndex}get isCurrTableRowIsFirstInTable(){return 0==this.position.rowIndex}get currLayoutRowOffset(){return this.tableInfo.currCellInfo.getCurrLayoutRowOffset(!0)}get currLayoutRowContentWidth(){return this.tableInfo.currCellInfo.currLayoutRowContentWidth}get nestedTableMaxWidth(){return this.tableInfo.currCellInfo.nestedTableMaxWidth}get nestedLevel(){return this.tableInfo.table.nestedLevel}get isCurrLayoutRowIsFirstInCell(){return 0==this.tableInfo.currRowInfo.cells[this.position.cellIndex].currLayoutTableCellInfo.layoutRows.length}get actualFormatter(){const e=this.tableInfo.currCellInfo.innerFormatter;return e?e.actualFormatter:this}get position(){return this.tableInfo.position}get grid(){return this.tableInfo.grid}constructor(e,t,r,i,n,o,a,s,l,d=null){this._posToWaitingContinuedFormatterMap=[],this.isFullyFormatted=!1,this.parentFormatter=l;const c=t[a];if(0!=c.rowIndex||0!=c.cellIndex)throw new Error(R.D.InternalException);this.tableInfo=new $z(e,c.table,i,n.x,n.y,d),this.initColumn(r,o,s),++a<t.length&&this.createInnerFormatter(t)}getNestedTablePosition(e){const t=this.nestedLevel+1;return e&&e.length>t?e[t]:null}createInnerFormatter(e){const t=this.getAvaliableSpaceForCellContent(),r=this.nestedLevel+1,i=this.getNestedTablePosition(e);if(i&&(0!=i.rowIndex||0!=i.cellIndex)){const e=this.posToWaitingContinuedFormatterMap[i.cell.endParagrapPosition.value];if(e)return void(this.tableInfo.currCellInfo.innerFormatter=e)}this.tableInfo.currCellInfo.innerFormatter=new Yz(this.tableInfo.rowFormatter,e,this.column,this.nestedTableMaxWidth,this.currLayoutRowOffset,this.tableInfo.currCellInfo.currLayoutTableCellInfo,r,t,this)}createNextCellFormatter(){const e=this.tableInfo.rowFormatter.getNextBoxWrapInfo().info.tablePosition;e&&e.length>this.nestedLevel+1&&!this.tableInfo.currCellInfo.innerFormatter&&this.createInnerFormatter(e)}resetPosition(e,t,r=Bo.Constants.MAX_SAFE_INTEGER){O.print(L.TableFormatter,"resetPosition",(()=>`rowIndex: ${e.rowIndex}, cellIndex: ${e.cellIndex}, forceEndAndStartRow: ${t}`));const i=t||e.rowIndex>this.tableInfo.minRowIndex;i&&(this.finishRow(),this.tableInfo.minRowIndex=Math.max(e.rowIndex,this.tableInfo.minRowIndex));const n=this.tableInfo.grid.tableCellInfos[e.rowIndex][e.cellIndex],o=n.getCellIndex(this.tableInfo.minRowIndex-n.getStartRowIndex());this.position.initIndexes(this.tableInfo.minRowIndex,o).init(),this.tableInfo.rowFormatter.setPosition(this.tableInfo.currCellInfo.getContentModelPosition(r),!1,!1),this.tableInfo.currCellInfo.resumeFormatting(),i&&this.tableInfo.currRowInfo.initLayoutInfo(t,this.column)}initColumn(e,t,r){this.columnStart(e,!1,this.tableInfo.yPositionStart,t,r)}columnStart(e,t=!0,r=0,i=null,n=null){if(this.column=e,this._columnWasEmpty=!this.column.rows.length,this.tableInfo.initLayoutInfo(r,i,this.column),this.tableInfo.avaliableHeight=null===n?this.column.height-this.tableInfo.currLayoutTableColumnInfo.y:n,t)for(let t of this.tableInfo.rows)for(let r of t.cells)r.innerFormatter&&r.innerFormatter.columnStart(e,!0,r.getCurrLayoutRowOffset(!1).y,r.currLayoutTableCellInfo,this.getAvaliableSpaceForCellContent(r))}findNextCell(e,t){let r,i=this.tableInfo.rowFormatter.getNextBoxWrapInfo();if(i)r=i.info.tablePosition;else{if(!this.tableInfo.rowFormatter.iterator.allBoxesGiven())throw new Error(R.D.InternalException);r=null}this.isCellFinished(r)&&(this.tableInfo.currCellInfo.cellFullyFormatted(),this.finishCell(),this.setNextCell(e)),i=this.tableInfo.rowFormatter.getNextBoxWrapInfo(),r=i?i.info.tablePosition:null,r&&!e.get(BV.TableFinished)&&!this.tableInfo.currCellInfo.innerFormatter&&(r.length>t.tablePosition.length||r.length==t.tablePosition.length&&f.ListUtils.last(r).table.index!=f.ListUtils.last(t.tablePosition).table.index)&&this.createInnerFormatter(r)}isCellFinished(e){const t=e?e[this.nestedLevel]:null;return t?!(this.tableInfo.currCellInfo.actualTableIndexes.equals(t)&&this.tableInfo.table.index==t.table.index):!this.tableInfo.currCellInfo.formattingSuspended}isLayoutRowIsLastOnCell(){const e=this.tableInfo.rowFormatter.getNextBoxWrapInfo();let t;if(e)t=e.info.tablePosition;else{if(!this.tableInfo.rowFormatter.iterator.allBoxesGiven())return!0;t=null}const r=t?t[this.nestedLevel]:null;return!r||!this.tableInfo.currCellInfo.actualTableIndexes.equals(r)}resetCaseInTextAnchorObject(e,t){if(this.nestedLevel<e.tablePosition.length-1)return this.tableInfo.currCellInfo.innerFormatter.resetCaseInTextAnchorObject(e,t);{let e=!1;if(this.tableInfo.rowFormatter.manager.activeFormatter.subDocument.isMain()){const r=this.tableInfo.rowFormatter.manager.activeFormatter.layoutPosition;e=t.bottom>r.pageArea.y+r.column.y+this.tableInfo.currLayoutTableColumnInfo.y+this.tableInfo.avaliableHeight-this.tableInfo.currCellInfo.heightAfterContent}return this.tableInfo.rowFormatter.manager.activeFormatter.layoutPosition.page.tableAnchoredObjectsHolder.addTableCellAnchoredObject(this.tableInfo.position,t.objectId),this.resetFromRow(new pr.Flag),e}}applyResultOfTopLevelFormatters(e,t,r=[]){if(this.nestedLevel<t.getTableNestedLevel())r.push(this),this.tableInfo.currCellInfo.innerFormatter.applyResultOfTopLevelFormatters(e,t,r);else for(let i;i=r.pop();)i.processResultOfTopLevelFormatter(e,t)}processResultOfTopLevelFormatter(e,t){const r=this.tableInfo.currCellInfo;if(e.anyOf(BV.TableFinished,BV.GoToNextColumn)){const i=r.innerFormatter.tableInfo.currLayoutTableColumnInfo;if(i.isEmpty()||(e.get(BV.TableFinished)||r.innerFormatter.columnEnd(),r.currLayoutTableCellInfo.internalTables[r.currLayoutTableCellInfo.layoutRows.length]=i,r.currLayoutTableCellInfo.height+=r.innerFormatter.tableInfo.currLayoutTableColumnInfo.height),e.get(BV.TableFinished))r.innerFormatter=null;else{this.tableInfo.rowFormatter.iterator.setNextValidWrapPosition(r.innerFormatter.tableInfo.table.getEndPosition(),t.tablePosition.length-1),r.suspendFormatting();if(!this.getNestedTablePosition(this.tableInfo.rowFormatter.iterator.getWrap(!1).info.tablePosition)){const e=this.getNestedTablePosition(t.tablePosition);e&&(this.posToWaitingContinuedFormatterMap[e.cell.endParagrapPosition.value]=r.innerFormatter)}}e.set(BV.TableFinished,!1),e.set(BV.GoToNextColumn,!1),this.findNextCell(e,t)}}getRowHeight(e,t){const r=e.heightInfo.preferredHeightValue;switch(e.heightInfo.preferredHeightType){case $e.Exact:return r;case $e.Minimum:return Math.max(r+e.topAndBottomMargins.sumOfBoth(),t);default:return t}}addLayoutRow(e,t){const r=this.tableInfo.currCellInfo;if(this.nestedLevel<t.getTableNestedLevel())return r.innerFormatter.addLayoutRow(e,t);const i=new pr.Flag(BV.None),n=this.getCellContentMaxBottom(),o=e.row,a=r.currLayoutTableCellInfo;a.internalTables[a.layoutRows.length]&&this.isLayoutRowIsLastOnCell()&&1==o.boxes.length&&o.boxes[0].getType()==lc.ParagraphMark&&(o.height=0);const s=0==r.cellIndex&&0==a.layoutRows.length?this.getRowHeight(r.rowInfo,o.height):o.height,l=o.y+s;return!r.innerFormatter&&(l<=n||this.needAddSomeLayoutRows)?(o.tableCellInfo=a,a.layoutRows.push(o),a.height=o.bottom-a.y,i.set(BV.RowAdded,!0),this.tableInfo.currRowInfo.layoutRowIndexInColumn=Math.min(this.tableInfo.currRowInfo.layoutRowIndexInColumn,this.column.rows.length),this.tableInfo.currCellInfo.cellPartiallyFormatted(e.rowStartPos+o.getLastBoxEndPositionInRow())):this.cantPlaceRow(i,e.rowStartPos),i}cantPlaceRow(e,t){this.tableInfo.currCellInfo.currLayoutTableCellInfo.isEmpty()?this.resetFromRow(e):(this.tableInfo.currCellInfo.cellPartiallyFormatted(t),this.finishCell(),this.setNextCell(e))}resetFromRow(e){this.cancelPlaceRow();const t=this.tableInfo.cellOrderHelper.getFirstNotFullyRenderedCell(this.tableInfo.minRowIndex);this.resetPosition(t,!0),this.tableInfo.currRowInfo.initLayoutInfo(!0,this.column);const r=this.tableInfo.rowFormatter.iterator.getWrap(!1).info.tablePosition;this.nestedLevel+1<r.length&&this.createInnerFormatter(r),e.set(BV.GoToNextColumn,!0)}setNextCell(e){const t=this.tableInfo.cellOrderHelper.getNextPos(this.tableInfo.currTablePositionIndexes);if(t)this.resetPosition(t,!1);else{if(this.tableInfo.cellOrderHelper.isTableFullyFormatted())return this.finishRow(),this.finishTable(),void e.set(BV.TableFinished,!0);{e.set(BV.GoToNextColumn,!0);const t=this.tableInfo.cellOrderHelper.getFirstNotFullyRenderedCell(this.tableInfo.minRowIndex);this.resetPosition(t,!0)}}this.createNextCellFormatter()}finishCell(){var e,t;const r=this.tableInfo.currCellInfo,i=r.currLayoutTableCellInfo;if(!i||i.isEmpty())return;r.isContendFullyPlaced||i.boundFlags.set(_a.EndOnThisColumn,!1),this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowCells.push(i),i.height+=r.heightAfterContent;const n=this.tableInfo.rowFormatter.manager.activeFormatter.layoutPosition,o=this.tableInfo.rowFormatter.manager.activeFormatter.layoutPosition.page.tableAnchoredObjectsHolder.getTableCellAnchoredObjects(this.tableInfo.position,this.tableInfo.rowFormatter.manager.activeFormatter),a=(null!==(t=null===(e=f.ListUtils.max(o,(e=>e.bottom)))||void 0===e?void 0:e.bottom)&&void 0!==t?t:0)-(n.pageArea.y+n.column.y+i.y);i.height=Math.max(i.height,a)}cancelPlaceRow(){this.column.rows.splice(this.tableInfo.currRowInfo.layoutRowIndexInColumn),this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowCells=[];for(let e of this.tableInfo.currRowInfo.cells)e.undoContentModelPosition()}finishRow(){const e=this.tableInfo.currRowInfo;if(e.currLayoutTableRowInfo.rowCells.length){e.currLayoutTableRowInfo.rowCells.sort(((e,t)=>e.cellGridIndex-t.cellGridIndex)),this.applyBottomHorizontalBordersChangesForPrevRow(),this.tableInfo.currColumnHorizontalBorders.push(this.tableInfo.currRowHorizontalBorders),this.tableInfo.currLayoutTableColumnInfo.tableRows.push(e.currLayoutTableRowInfo),e.howManyColumnsConsiderTableRow++,this.setRowHeight(),this.extendCellHeightToRowHeight();for(let t of e.cells)t.isContendFullyPlaced||(t.isStartOnThisColumn=!0),t.storeContentModelPosition();this.tableInfo.lastRowBottomBoundPosition=e.currLayoutTableRowInfo.bottom}e.clearLayoutInfo()}columnEnd(){if(!this.tableInfo.currLayoutTableColumnInfo.tableRows.length)return;this.setCellsHeight();const e=[],t=[];if(Sz.setColumnHorizontalBorders(this.tableInfo.currLayoutTableColumnInfo,this.tableInfo.rows,this.tableInfo.currColumnHorizontalBorders,this.tableInfo.isThisColumnFirstInTable),Sz.setColumnVerticalBorders(this.tableInfo.currLayoutTableColumnInfo,this.grid,this.tableInfo.rows,this.tableInfo.isThisColumnFirstInTable,this.tableInfo.currColumnHorizontalBorders,e,this.tableInfo.verticalBorders,!0),Sz.setColumnVerticalBorders(this.tableInfo.currLayoutTableColumnInfo,this.grid,this.tableInfo.rows,this.tableInfo.isThisColumnFirstInTable,this.tableInfo.currColumnHorizontalBorders,t,this.tableInfo.verticalCursorBorders,!1),this.tableInfo.currLayoutTableColumnInfo.calculateFlags(),this.column.tablesInfo.push(this.tableInfo.currLayoutTableColumnInfo),this.tableInfo.currLayoutTableColumnInfo.height=this.tableInfo.lastRowBottomBoundPosition-this.tableInfo.currLayoutTableColumnInfo.y,this.setRowsVerticalBounds(e),bz.createBackgroundInfos(this.tableInfo.rowFormatter.manager.model.colorProvider,this.tableInfo.defaultTblCellProps,this.grid,this.tableInfo.currLayoutTableColumnInfo,e,this.tableInfo.currColumnHorizontalBorders,this.tableInfo.rows),this.tableInfo.currLayoutTableColumnInfo.horizontalBorders=Cz.getFinalReducedHorizontalBorders(this.tableInfo.currColumnHorizontalBorders),this.tableInfo.currLayoutTableColumnInfo.horizontalCursorBorders=yz.getHorizontalCursorBorders(this.tableInfo.currLayoutTableColumnInfo),this.tableInfo.currLayoutTableColumnInfo.verticalBorders=Cz.getFinalReducedVerticalBorders(e),this.tableInfo.currLayoutTableColumnInfo.verticalCursorBorders=Cz.getFinalReducedVerticalBorders(t),$a.applyHorizontalAlignment(this.tableInfo.currLayoutTableColumnInfo,this.tableInfo.maxWidth),$a.applyCellsVerticalAlignment(this.tableInfo.defaultTblCellProps,this.grid,this.tableInfo.currLayoutTableColumnInfo,this.tableInfo.rows),0==this.position.table.nestedLevel)for(let e of this.tableInfo.currLayoutTableColumnInfo.tableRows)Jz.tableRowContentCompress(e);this.tableInfo.isThisColumnFirstInTable=!1}finishTable(){this.columnEnd(),this.tableInfo.rowFormatter.setPosition(this.tableInfo.table.getEndPosition(),!1,!1),this.isFullyFormatted=!0}getAvaliableSpaceForCellContent(e=this.tableInfo.currCellInfo){return this.getCellContentMaxBottom()-e.currLayoutTableCellInfo.bottom}getCellContentMaxBottom(e=this.tableInfo.currCellInfo){return this.tableInfo.currLayoutTableColumnInfo.y+this.tableInfo.avaliableHeight-e.heightAfterContent}setCellsHeight(){const e=this.tableInfo.currLayoutTableColumnInfo.tableRows;for(let r,i=0;r=e[i];i++){const n=r.rowIndex,o=this.grid.tableCellInfos[n],a=this.grid.table.rows[n].cells;for(let n,s=0;n=a[s];s++){if(n.verticalMerging==Xe.Continue)continue;const a=o[s];var t=a.getGridCellIndex();const l=f.ListUtils.elementBy(r.rowCells,(e=>e.cellGridIndex==t));l&&(l.height=Yz.getCellHeight(e,i,a.getEndRowIndex()))}}}static getCellHeight(e,t,r){let i=0;for(let n;(n=e[t])&&n.rowIndex<r;t++)i+=n.height;return i}setRowsVerticalBounds(e){const t=this.tableInfo.currLayoutTableColumnInfo.x,r=this.tableInfo.currLayoutTableColumnInfo.tableRows;for(let i,n=0;i=r[n];n++){const r=e[n],o=f.ListUtils.last(f.ListUtils.last(r)),a=r[0][0].xPos;i.x=t+a,i.width=o.xPos-a}}static setRowHeightInternal(e){e.height=f.ListUtils.accumulate(e.rowCells,0,((e,t)=>Math.max(e,t.height)))}setRowHeightWhenRowBelongsToManyColumns(){const e=this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowIndex;if(this.grid.table.rows.length-1==e)return Yz.setRowHeightInternal(this.tableInfo.currRowInfo.currLayoutTableRowInfo);const t=[];let r=0;const i=this.grid.tableCellGridInfos;for(let n of this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowCells){const o=n.cellGridIndex;i[e][o]===i[e+1][o]?t.push(o):r=Math.max(r,n.height)}if(0==r)return Yz.setRowHeightInternal(this.tableInfo.currRowInfo.currLayoutTableRowInfo);const n=this.grid.table.rows;if(t.length>0&&!f.ListUtils.unsafeAnyOf(this.grid.tableCellInfos,((e,r)=>f.ListUtils.unsafeAnyOf(e,((e,i)=>n[r].cells[i].verticalMerging!=Xe.Continue||!f.ListUtils.unsafeAnyOf(t,(t=>t==e.getGridCellIndex()))))),e+1))return Yz.setRowHeightInternal(this.tableInfo.currRowInfo.currLayoutTableRowInfo);this.tableInfo.currRowInfo.currLayoutTableRowInfo.height=r}setRowHeight(){const e=this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowIndex;if(this.tableInfo.currRowInfo.howManyColumnsConsiderTableRow>1)return this.setRowHeightWhenRowBelongsToManyColumns();const t=this.grid.table.rows[e].cells;let r=0;for(let n,o=0;n=t[o];o++){if(n.verticalMerging!=Xe.Continue)continue;const t=this.grid.tableCellInfos[e][o];if(e==t.getEndRowIndex()-1){const n=Math.max(0,this.tableInfo.currLayoutTableColumnInfo.tableRows.length-t.getNumRowsInCell()),o=this.tableInfo.currLayoutTableColumnInfo.tableRows[n];var i=t.getGridCellIndex();const a=f.ListUtils.elementBy(o.rowCells,(e=>e.cellGridIndex==i));a&&(r=Math.max(r,f.ListUtils.accumulate(this.tableInfo.rows,a.height,((e,t)=>e-t.heightInfo.contentHeight),o.rowIndex,e)))}}for(let i of this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowCells){const n=this.grid.tableCellGridInfos[e][i.cellGridIndex],o=n.getStartRowIndex();t[n.getCellIndex(e-o)].verticalMerging==Xe.None&&(r=Math.max(r,i.height))}const n=this.tableInfo.rows[e],o=n.heightInfo;this.tableInfo.currRowInfo.currLayoutTableRowInfo.height=this.getRowHeight(n,Math.max(r,o.contentHeight)),o.contentHeight=this.tableInfo.currRowInfo.currLayoutTableRowInfo.height}extendCellHeightToRowHeight(){const e=this.tableInfo.currRowInfo.currLayoutTableRowInfo.height;for(let t of this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowCells)t.height=Math.max(t.height,e)}applyBottomHorizontalBordersChangesForPrevRow(){if(0==this.tableInfo.currLayoutTableColumnInfo.tableRows.length)return;const e=this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowIndex,t=!e,r=f.ListUtils.last(this.tableInfo.currLayoutTableColumnInfo.tableRows).rowIndex,i=r==this.grid.table.rows.length-1,n=this.tableInfo.rows[r].cellSpacing,o=f.ListUtils.last(this.tableInfo.currColumnHorizontalBorders);let a=0;if(n>0){const t=o.pop(),r=o.pop(),s=this.tableInfo.bordersHelper.collectOneCellAndTableHorizontalBorders(e-1,qr,e,this.tableInfo.bordersHelper.borderHorizontal,!0);o.push(s),a=r.maxWidth+t.maxWidth-s.maxWidth+(i?n:0)}else{const e=o.pop().maxWidth;t&&(a=e)}if(0!=a){this.tableInfo.currRowInfo.currLayoutTableRowInfo.height-=a;for(let e of this.tableInfo.currRowInfo.currLayoutTableRowInfo.rowCells){e.y-=a;for(let t of e.layoutRows)t.y-=a}}}static getCellMargin(e){return e.asNumberNoPercentType(g.u.twipsToPixels)}}!function(e){e[e.DocumentStart=0]="DocumentStart",e[e.PageStart=1]="PageStart",e[e.PageAreaStart=2]="PageAreaStart",e[e.ColumnStart=3]="ColumnStart",e[e.RowFormatting=4]="RowFormatting",e[e.ColumnEnd=5]="ColumnEnd",e[e.PageAreaEnd=6]="PageAreaEnd",e[e.PageEnd=7]="PageEnd",e[e.DocumentEnd=8]="DocumentEnd",e[e.End=9]="End"}(AV||(AV={}));class Qz{constructor(e){this._row=null,this._startPosition=0,this._paragraphIndex=-1,this.paragraphs=e}reset(e){this._row=null,this._startPosition=e.getPosition(),this._paragraphIndex=-1,this.isParIndexSet=!0}recalculateParagraphIndex(e){this.isParIndexSet=!1,e&&this.calculateParagraphIndex()}setRowInfo(e,t,r){this._row=e,this._startPosition=t+e.columnOffset,this.recalculateParagraphIndex(r)}setFullRowInfo(e,t,r){this._row=e,this._startPosition=t,this._paragraphIndex=r,this.isParIndexSet=!0}setFullRowInfoAndCalculateParagraph(e,t,r){this._row=e,this._startPosition=t,this.recalculateParagraphIndex(r)}get row(){return this._row}get startPosition(){return this._startPosition}get paragraphIndex(){return this.isParIndexSet||this.calculateParagraphIndex(),this._paragraphIndex}calculateParagraphIndex(){this._paragraphIndex=C.SearchUtils.normedInterpolationIndexOf(this.paragraphs,(e=>e.startLogPosition.value),this._startPosition),this.isParIndexSet=!0}isNextRowFirstInParagraph(){return!this._row||this._row.flags.get(xV.ParagraphEnd)}}class Zz{constructor(e){this.manager=e}restartCommonPart(e){return this.manager.mainFormatter.rowFormatter.getPosition()<e?(this.manager.mainFormatter.rowFormatter.iterator.setPosition(this.manager.mainFormatter.rowFormatter.getPosition(),!0,!0),!1):(this.manager.mainFormatter.rowFormatter.numberingListCountersManager.reset(),this.manager.mainFormatter.rowFormatter.setPosition(e,!0,!0),!0)}restartFromPage(e,t,r){const i=this.calcRestartPosition(e);if(!this.restartCommonPart(i))return;const n=new Kp(Hu.None);n.pageIndex=e;const o=new Qz(this.manager.mainFormatter.rowFormatter.subDocument.paragraphs),a=this.manager.layout.pages[e-1];if(a){const e=f.ListUtils.last(a.mainSubDocumentPageAreas),t=e.getLastColumn();o.setRowInfo(t.getLastRow(),a.getPosition()+e.pageOffset+t.pageAreaOffset,!1)}else o.reset(this.manager.mainFormatter.rowFormatter);this.manager.boundsCalculator.init(this.manager.model.getSectionByPosition(i)),this.manager.mainFormatter.setParamsForRestart(AV.PageStart,n,o,r),t&&this.manager.runFormatting(e)}calcRestartPosition(e){if(0==e)return 0;const t=this.manager.layout.pages[e-1],r=f.ListUtils.last(t.mainSubDocumentPageAreas),i=r.getLastColumn(),n=i.getLastRow(),o=f.ListUtils.last(n.boxes),a=t.getPosition()+r.pageOffset+i.pageAreaOffset+n.columnOffset+o.rowOffset+o.getLength(),s=n.tableCellInfo;return!s||s.boundFlags.get(_a.StartOnThisColumn)?a:Math.max(a,this.calcRestartPosition(e-1))}restartHeaderFooterInternal(e,t){const r=this.manager.layout.pages[t];this.manager.changesManager.addPageChange(new JV(t,wV.Updated,[],[])),e.isHeader()?this.manager.otherPageAreaFormatter.formatHeaderPageArea(r,e.info):this.manager.otherPageAreaFormatter.formatFooterPageArea(r,e.info),this.manager.onPagesReady(),this.restartFromPage(t,!0,!0)}restartFormatingAllLayout(){for(;this.manager.layout.pages.shift();)this.manager.changesManager.addPageChange(new JV(0,wV.Deleted,[],[]));this.manager.layout.setEmptyLayout(this.manager.model.pageBackColor),this.manager.mainFormatter.rowFormatter.setPosition(0,!0,!0),this.manager.mainFormatter.rowFormatter.numberingListCountersManager.reset();const e=new Qz(this.manager.mainFormatter.rowFormatter.subDocument.paragraphs);e.reset(this.manager.mainFormatter.rowFormatter),this.manager.mainFormatter.setParamsForRestart(AV.DocumentStart,null,e,!0),this.manager.runFormatting(0)}restartByAnchoredObject(e){const t=e.index;if(!this.manager.mainFormatter.subDocument.tables.length)return this.restartFromPage(t,!1,!0);const r=new Kp(Hu.Page);r.pageIndex=t,r.page=e;let i=this.manager.invalidator.isPageStartWithMultipageTable(e);if(!i)return!this.manager.mainFormatter.tableFormatter||this.manager.activeFormatter.subDocument.isMain()?this.restartFromPage(t,!1,!0):this.restartFromPage(t,!1,!1);e:for(r.pageAreaIndex=0;r.pageArea=r.page.mainSubDocumentPageAreas[r.pageAreaIndex];r.pageAreaIndex++)for(r.columnIndex=0;r.column=r.pageArea.columns[r.columnIndex];r.columnIndex++)for(r.rowIndex=0;r.row=r.column.rows[r.rowIndex];r.rowIndex++)if(!r.row.tableCellInfo||r.row.tableCellInfo.parentRow.parentTable.getTopLevelColumn().logicInfo.grid.table.index!=i.index)break e;if(!r.pageArea||!r.column||!r.row)return this.restartFromPage(t,!1,!0);this.restartFromRow(r,this.manager.invalidator.getStartModelPositionOfRow(r),!1,!1),this.manager.floatingRestartInfoHolder.init()}restartFromRow(e,t,r,i=!0){if(e.isFirstRowOnPage())return this.restartFromPage(e.page.index,r,!0);const n=this.manager.mainFormatter,o=new Qz(n.rowFormatter.subDocument.paragraphs),a=e.clone();if(a.advanceToPrevRow(this.manager.layout)?o.setRowInfo(a.row,e.getLogPosition(Hu.Column)+a.row.columnOffset,!0):o.setRowInfo(null,0,!0),!this.restartCommonPart(t))return;const s=this.createNewLayoutPage(e,t);if(i){const t=this.manager.layout.anchorObjectsPositionInfo,r=this.manager.invalidator.getStartModelPositionOfRow(e);e.page.anchoredObjectHolder.objects=b.j.reducedMap(e.page.anchoredObjectHolder.objects,(i=>{if(t.getPosition(i.objectId)>=r&&e.pageArea.subDocument.id===i.belongsToSubDocId){if(i.getType()===lc.AnchorTextBox){const t=i.internalSubDocId;delete e.page.otherPageAreas[t],s.otherPageAreaChanges.push(new $V(t,wV.Deleted))}else s.anchoredPictureChanges.push(new HV(i.objectId,wV.Deleted));return null}return i}))}this.setBoundsCalculatorState(t,e.page,e.pageIndex);const l=this.manager.boundsCalculator,d=f.ListUtils.last(l.mainPageAreasBounds),c=f.ListUtils.last(l.mainColumnsBounds);n.setBoundsForRestart(d,c);const h=new on.FixedInterval(e.pageArea.x+c[e.columnIndex].x,c[e.columnIndex].width);n.layoutRowBoundsCalculator.resetByColumn(e.page.anchoredObjectHolder.objects,h,!1),n.setParamsForRestart(AV.RowFormatting,e,o,!0),r&&this.manager.runFormatting(e.page.index)}setBoundsCalculatorState(e,t,r){const i=this.manager.boundsCalculator;i.init(this.manager.model.getSectionByPosition(e));const n=this.manager.layout.pages[r-1];i.calculatePageBounds(n?n.bottom:0);const o=t.getLayoutOtherPageAreasInfo();o.headerPageArea&&i.setHeaderBounds(o.headerPageArea.columns[0].height),o.footerPageArea&&i.setFooterBounds(o.footerPageArea.columns[0].height),i.calculateMainPageAreaBounds(-1),i.calculateColumnBounds(i.mainPageAreasBounds[i.mainPageAreasBounds.length-1])}createNewLayoutPage(e,t){const r=new JV(e.pageIndex,wV.Updated,[],[]);e.page=e.page.deepCopy(),e.pageArea=e.page.mainSubDocumentPageAreas[e.pageAreaIndex],e.column=e.pageArea.columns[e.columnIndex],e.row=e.column.rows[e.rowIndex],this.manager.removeRedundantHelper.removeRedundantPageAreas(e.page,e.pageAreaIndex+1,r);const i=new $V(e.pageAreaIndex,wV.Updated);r.mainPageAreaChanges.push(i),this.manager.removeRedundantHelper.removeRedundantColumnsFromArea(e.pageArea,e.columnIndex+1,i);const n=new qV(e.columnIndex,wV.Updated);i.columnChanges.push(n),this.manager.removeRedundantHelper.removeRedundantRowsFromColumn(e.column,e.rowIndex,n);const o=f.ListUtils.indexBy(e.column.tablesInfo,(e=>e.logicInfo.grid.table.getStartPosition()>=t));return this.manager.removeRedundantHelper.removeRedundantTableInfosFromColumn(e.column,-1==o?e.column.tablesInfo.length:o,n),r}}class ej{constructor(e,t){this.layoutRowBoundsCalculator=new bW,this.pageBreakPositions=[],this.manager=e,this.rowFormatter=new uz(e,t),this.state=AV.PageAreaStart,this.stateMap={},this.stateMap[AV.PageAreaStart]=this.processStatePageAreaStart,this.stateMap[AV.ColumnStart]=this.processStateColumnStart,this.stateMap[AV.RowFormatting]=this.processStateRowFormatting,this.stateMap[AV.ColumnEnd]=this.processStateColumnEnd}initDocumentStart(){this.rowFormatter.documentStart(),this.lastRowInfo=new Qz(this.subDocument.paragraphs),this.lastRowInfo.reset(this.rowFormatter)}get subDocument(){return this.rowFormatter.subDocument}get currColumnHeight(){return 0==this.layoutPosition.rowIndex?0:this.layoutPosition.column.rows[this.layoutPosition.rowIndex-1].bottom}formatPageArea(e,t,r){for(O.print(L.LayoutFormatter,"formatPageArea",`pageIndex: ${r.index}`),this.pageAreaBounds=e,this.columnBounds=t,this.layoutPosition||(this.layoutPosition=new Kp(Hu.None),this.layoutPosition.page=r,this.layoutPosition.pageIndex=r.index);this.stateMap[this.state].call(this)&&this.state!=AV.PageAreaEnd;);}processStatePageAreaStart(){return this.manager.activeFormatter=this,O.print(L.LayoutFormatter,"processStatePageAreaStart",(()=>` SubDocId: ${this.subDocument.id}, LayPos: ${KV.layoutPositionShort(this.layoutPosition)}`)),this.createNextPageArea(),this.subDocument.isMain()?this.layoutPosition.page.mainSubDocumentPageAreas.push(this.layoutPosition.pageArea):this.layoutPosition.page.otherPageAreas[this.subDocument.id]=this.layoutPosition.pageArea,!0}processStateColumnStart(){this.manager.activeFormatter=this,O.print(L.LayoutFormatter,"processStateColumnStart",(()=>` SubDocId: ${this.subDocument.id}, LayPos: ${KV.layoutPositionShort(this.layoutPosition)}`));const e=this.columnBounds[this.layoutPosition.columnIndex];this.createNextColumn(e),this.layoutPosition.pageArea.columns.push(this.layoutPosition.column),this.tableFormatter&&this.tableFormatter.columnStart(this.layoutPosition.column);const t=new on.FixedInterval(this.layoutPosition.pageArea.x+e.x,e.width);return this.layoutRowBoundsCalculator.resetByColumn(this.layoutPosition.page.anchoredObjectHolder.objects,t,this.subDocument.isTextBox()),!0}initializeTextBoxSizeForAutoFitTables(){const e=this.rowFormatter.getNextBoxWrapInfo().info.tablePosition[0];0==e.rowIndex&&0==e.cellIndex&&b.j.forEach(this.manager.anchoredObjectsManager.textBoxContextSizeCalculators,(t=>{const r=t.wrap.info.tablePosition;r&&r[0].table.index==e.table.index&&t.calculateSize(this.manager.boundsCalculator)}))}processStateRowFormatting(){var e,t;this.manager.activeFormatter=this;const r=this.rowFormatter.getPosition();if(this.tryBreakPageByPosition(r))return!0;const i=this.rowFormatter.getNextBoxWrapInfo(),n=i.box.rowOffset;if(O.print(L.LayoutFormatter,"processStateRowFormatting",(()=>`pos:${n}, SubDocId: ${this.subDocument.id}, LayPos: ${KV.layoutPositionShort(this.layoutPosition)}`)),!this.tableFormatter&&this.applyPageBreakBefore())return!0;if(!this.tableFormatter&&i.info.tablePosition){const r=new Xc.Point(0,this.getTableStartYOffsetPosition()),n=SD.findSectionColumnWithMinimumWidth(this.columnBounds);if($z.checkIsTableCannotBePlacedOnCurrentPage(this.rowFormatter,i.info.tablePosition[0].table,r.y,n)){if(this.layoutPosition.rowIndex>0)return null!==(e=(t=i.info).pageIndexFromWhichTableWasMoved)&&void 0!==e||(t.pageIndexFromWhichTableWasMoved=this.layoutPosition.pageIndex),this.state=AV.ColumnEnd,!0;if(this.tryExcludeAnchoredObjectFromCurrentPage())return!0}this.initializeTextBoxSizeForAutoFitTables(),this.tableFormatter=new Yz(this.rowFormatter,i.info.tablePosition,this.layoutPosition.column,n,r,null,0,null,null,i.info.pageIndexFromWhichTableWasMoved),this.tableFormatter.tableInfo.currLayoutTableColumnInfo.logicInfo.isEditable=this.tableIsEditable(this.tableFormatter.tableInfo.table)}const o=this.createRow();if(o.flags.get(DV.NotEnoughChunks))return!1;const a=this.tableFormatter?this.tableFormatter.addLayoutRow(o,i.info):new pr.Flag(BV.RowAdded);if(a.get(BV.RowAdded)){const e=o.row;if(this.subDocument.isMain()&&!this.tableFormatter&&this.cantPlaceRowOnThisColumn(e)){if(0!==this.layoutPosition.rowIndex)return this.rowFormatter.setPosition(n,!1,!this.tableFormatter),this.state=AV.ColumnEnd,!0;if(this.tryExcludeAnchoredObjectFromCurrentPage())return!0}if(this.pushRow(e,n,o.paragraphIndex),this.placeAnchorObjects(o)){if(this.tableFormatter){const e=new on.FixedInterval(this.layoutPosition.pageArea.x+this.layoutPosition.column.x+this.layoutPosition.row.tableCellInfo.x,this.layoutPosition.row.tableCellInfo.width),t=f.ListUtils.elementBy(o.newAnchoredObjects,(e=>e.levelType==dc.InText));this.layoutRowBoundsCalculator.addTableInTextObject(t,e),this.tableFormatter.resetCaseInTextAnchorObject(i.info,t)&&(this.layoutPosition.column.rows[0]?this.state=AV.ColumnEnd:(this.manager.floatingRestartInfoHolder.storeInfo(this.layoutPosition),new Zz(this.manager).restartFromPage(this.layoutPosition.pageIndex,!1,!1)))}else this.manager.floatingRestartInfoHolder.storeInfo(this.layoutPosition),new Zz(this.manager).restartByAnchoredObject(this.layoutPosition.page),this.subDocument.isMain()||(this.state=AV.PageAreaEnd);return this.isColumnOk(),!0}this.tableFormatter&&this.tableFormatter.actualFormatter.findNextCell(a,i.info)}return this.tableFormatter&&this.tableFormatter.applyResultOfTopLevelFormatters(a,i.info),a.get(BV.TableFinished)&&(this.tableFormatter=null),this.shouldEndColumn(a)&&(this.isColumnOk(),this.state=AV.ColumnEnd),!0}tryBreakPageByPosition(e){for(;this.pageBreakPositions.length>0&&e>=this.pageBreakPositions[this.pageBreakPositions.length-1];){if(this.pageBreakPositions.pop()===e)return this.finishPage(),!0}return!1}tryExcludeAnchoredObjectFromCurrentPage(){const e=this.layoutPosition.page.anchoredObjectHolder.getUnapprovedObj();if(e&&e.belongsToSubDocId===uu.MAIN_SUBDOCUMENT_ID){const t=this.manager.layout.anchorObjectsPositionInfo.getPosition(e.objectId);return!(t<=this.rowFormatter.getPosition())&&(this.pageBreakPositions.push(this.subDocument.getParagraphByPosition(t).startLogPosition.value),this.manager.layout.anchorObjectsPositionInfo.delete(e.objectId),this.layoutPosition.page.anchoredObjectHolder.removeObject(e),new Zz(this.manager).restartFromPage(this.layoutPosition.pageIndex,!1,!1),!0)}return!1}shouldEndColumn(e){const t=[xV.ColumnEnd,xV.DocumentEnd,xV.SectionEnd,xV.PageEnd];return e.get(BV.GoToNextColumn)||e.get(BV.RowAdded)&&this.layoutPosition.row.flags.anyOf(...t)}processStateColumnEnd(){this.manager.activeFormatter=this,O.print(L.LayoutFormatter,"processStateColumnEnd",(()=>` SubDocId: ${this.subDocument.id}, LayPos: ${KV.layoutPositionShort(this.layoutPosition)}`));const e=this.layoutPosition.column;e.rows.sort(((e,t)=>e.columnOffset-t.columnOffset)),ej.correctRowOffsets(e),this.tableFormatter&&this.tableFormatter.columnEnd(),e.tablesInfo.sort(((e,t)=>e.logicInfo.grid.table.index-t.logicInfo.grid.table.index)),f.ListUtils.forEach(e.rows,((e,t)=>{e.tableCellInfo&&(e.indexInColumn=t)}));const t=e.getLastRow();if(t.flags.set(xV.ColumnEnd,!0),this.manager.innerClientProperties.viewsSettings.isSimpleView){const e=b.j.max(this.layoutPosition.page.anchoredObjectHolder.objects,(e=>e.bottom)),r=this.manager.innerClientProperties.viewsSettings.paddings,i=this.manager.innerClientProperties.viewsSettings.pageVerticalInfo,n=t.bottom+r.top,o=(e?Math.max(e.bottom,n):n)+r.bottom,a=o+i.topMargin+i.topPageBorderWidth+i.bottomPageBorderWidth+i.bottomMargin,s=o+Math.floor(Math.max(0,this.manager.controlHeightProvider.getVisibleAreaHeight(!1)-a)),l=s-r.vertical;this.layoutPosition.column.height=l,this.layoutPosition.pageArea.height=l,this.layoutPosition.page.height=s,this.layoutPosition.page.minContentHeight=a}return e.paragraphFrames=gW.collect(this.manager.model.colorProvider,e,this.subDocument.isMain()?this.layoutPosition.page.getPosition()+this.layoutPosition.pageArea.pageOffset:0,this.subDocument.paragraphs),t.flags.anyOf(xV.DocumentEnd,xV.PageEnd,xV.SectionEnd)?(this.layoutPosition.detailsLevel=Hu.PageArea,this.state=AV.PageAreaEnd):this.layoutPosition.columnIndex+1<this.columnBounds.length?(this.state=AV.ColumnStart,this.layoutPosition.columnIndex++,this.layoutPosition.column=null):this.state=AV.PageAreaEnd,!0}createNextPageArea(){const e=new uW(this.subDocument);e.setGeomerty(this.pageAreaBounds),e.pageOffset=this.subDocument.isMain()?0:this.rowFormatter.getPosition(),this.state=AV.ColumnStart,this.layoutPosition.pageArea=e,this.layoutPosition.columnIndex=0,this.layoutPosition.column=null,this.layoutPosition.detailsLevel=Hu.PageArea}createNextColumn(e){const t=new SD;t.setGeomerty(e),t.pageAreaOffset=0!=this.layoutPosition.columnIndex&&this.subDocument.isMain()?this.rowFormatter.getPosition()-this.layoutPosition.pageArea.pageOffset-this.layoutPosition.page.getPosition():0,this.state=AV.RowFormatting,this.layoutPosition.column=t,this.layoutPosition.rowIndex=0,this.layoutPosition.detailsLevel=Hu.Column}pushRow(e,t,r){this.layoutPosition.row=e,this.layoutPosition.column.rows.push(e),this.layoutPosition.rowIndex++,this.lastRowInfo.setFullRowInfo(e,t,r),ej.correctBoxOffsets(e)}createRow(){const e=this.tableFormatter?new pz(this.lastRowInfo.row,this.subDocument.paragraphs,this.tableFormatter.isCurrLayoutRowIsFirstInCell,this.tableFormatter.isCurrTableCellFirstInRow,this.tableFormatter.isCurrTableRowIsFirstInTable):new gz(this.subDocument.documentModel.compatibilitySettings,this.lastRowInfo,this.subDocument.paragraphs,0==this.layoutPosition.rowIndex),t=this.layoutPosition.getOffsetRelativeColumn(),r=this.tableFormatter?t.clone().offsetByPoint(this.tableFormatter.currLayoutRowOffset):this.getCurrOffsetForRow(t);let i=Bo.Constants.MIN_SAFE_INTEGER;if(!this.tableFormatter&&this.lastRowInfo.row&&this.manager.innerClientProperties.viewsSettings.isSimpleView&&f.ListUtils.unsafeAnyOf(this.lastRowInfo.row.boxes,(e=>I.Y.isAnyOf(e.getType(),lc.ColumnBreak,lc.PageBreak,lc.SectionMark)))){const e=this.lastRowInfo.row.bottom;let t=null;b.j.forEach(this.layoutPosition.page.anchoredObjectHolder.objects,(r=>{!r.isInText()&&r.bottom>e&&(!t||r.bottom>t.bottom)&&(t=r)})),t&&(i=t.bottom+1)}const n=this.tableFormatter?this.tableFormatter.currLayoutRowContentWidth:this.layoutPosition.column.width;this.rowFormatter.formatRow(Math.max(i,r.y),new on.FixedInterval(r.x,n),e);const o=this.rowFormatter.result;return o.row&&o.row.moveRectangleByPoint(t.multiply(-1,-1)),o}getCurrOffsetForRow(e){const t=f.ListUtils.last(this.layoutPosition.column.rows);if(!t)return e;const r=e.clone();return r.y+=t.tableCellInfo?t.tableCellInfo.parentRow.parentTable.getTopLevelColumn().bottom:t.bottom,r}applyPageBreakBefore(){const e=this.rowFormatter.getNextBoxWrapInfo();return!!(e&&this.lastRowInfo.isNextRowFirstInParagraph()&&this.subDocument.paragraphs[e.info.paragraphIndex].getParagraphMergedProperties().pageBreakBefore&&0!==this.layoutPosition.rowIndex&&this.manager.innerClientProperties.viewsSettings.isPrintLayoutView)&&(this.finishPage(),!0)}finishPage(){this.lastRowInfo.row.flags.set(xV.PageEnd,!0),this.state=AV.ColumnEnd}cantPlaceRowOnThisColumn(e){return e.y+e.lineHeight>this.layoutPosition.column.height&&e.hasEffectToPageHeight}tableIsEditable(e){const t=on.FixedInterval.fromPositions(e.getStartPosition(),e.getEndPosition());return this.subDocument.isEditable([t])}placeAnchorObjects(e){if(!e.newAnchoredObjects.length)return!1;let t=!1;return f.ListUtils.forEach(e.newAnchoredObjects,(e=>{switch(this.manager.layout.anchorObjectsPositionInfo.add(e,e.rowOffset),e.getType()){case lc.AnchorTextBox:{const t=e;if(t.internalSubDocId>=0){this.manager.otherPageAreaFormatter.setTextBoxContent(this.layoutPosition.page,t),this.layoutPosition.page.anchoredObjectHolder.addObject(this.manager,t);const e=this.layoutPosition.page.otherPageAreas[t.internalSubDocId],r=t.getContentBounds();e.x=r.x,e.y=r.y}break}case lc.AnchorPicture:this.layoutPosition.page.anchoredObjectHolder.addObject(this.manager,e);break;default:throw new Error(R.D.InternalException)}e.levelType==dc.InText?t=!0:e.isApproved=!0})),t}getTableStartYOffsetPosition(){return this.lastRowInfo.row&&this.layoutPosition.column.rows.length?this.lastRowInfo.row.tableCellInfo?this.lastRowInfo.row.tableCellInfo.parentRow.parentTable.getTopLevelColumn().bottom:this.lastRowInfo.row.bottom:0}static correctColumnOffsets(e){const t=e.columns;if(!t.length)return;const r=t[0].pageAreaOffset;if(0!=r){e.pageOffset+=r;for(let e of t)e.pageAreaOffset-=r}}static correctRowOffsets(e){const t=e.rows;if(!t.length)return;const r=t[0].columnOffset;if(0!=r){e.pageAreaOffset+=r;for(let e of t)e.columnOffset-=r}}static correctBoxOffsets(e){const t=e.boxes;if(!t)return;const r=t[0].rowOffset;if(0!=r){e.columnOffset+=r;for(let e of t)e.rowOffset-=r}}isColumnOk(){if(this.state==AV.ColumnEnd&&!this.layoutPosition.column.rows[0])throw new Error(R.D.InternalException)}}class tj{constructor(){this.cache={}}reset(){this.cache={}}isEquivalent(e,t){const r=e.tableCellInfo,i=t.tableCellInfo;return!r&&!i||!(r&&!i||!r&&i)&&(this.isCellsEquivalent(r,i)&&tj.rowsEqualIndex(r,e,i,t))}isCellsEquivalent(e,t){const r=tj.getKey(e),i=tj.getKey(t);let n=this.cache[r];n||(n=this.cache[r]={});const o=n[i];return void 0===o?n[i]=tj.compareCells(e,t):o}static compareCells(e,t){const r=e.parentRow,i=t.parentRow,n=r.parentTable,o=i.parentTable;return n.logicInfo.grid.table==o.logicInfo.grid.table&&r.rowIndex==i.rowIndex&&e.cellGridIndex==t.cellGridIndex&&e.layoutRows.length==t.layoutRows.length&&tj.equalLengthAndPosition(r.rowCells,e,i.rowCells,t)&&tj.equalLengthAndPosition(n.tableRows,r,o.tableRows,i)}static equalLengthAndPosition(e,t,r,i){return e.length==r.length&&e.indexOf(t)==r.indexOf(i)}static getKey(e){const t=e.parentRow;return t.parentTable.logicInfo.grid.table.index<<32|t.rowIndex<<16|e.cellGridIndex}static rowsEqualIndex(e,t,r,i){return e.layoutRows.indexOf(t)==r.layoutRows.indexOf(i)}}class rj{static collectHeaderFooterChanges(e,t,r){return new JV(e,wV.Updated,[],rj.collectMapChanges(t,r,$V,((e,t)=>!0),rj.collectColumnsChanges))}static collectPageChanges(e,t){const r=e[t.index];if(r){const e=b.j.anyOf(t.anchoredObjectHolder.objects,((e,i)=>{const n=r.anchoredObjectHolder.objects[i];return n&&e.rendererLevel!=n.rendererLevel?new JV(t.index,wV.Replaced):null}));if(e)return e;if(!r.renderLevelCalculator.equals(t.renderLevelCalculator))return new JV(t.index,wV.Replaced)}return rj.makeChange(r,t,t.index,JV,((e,t)=>e.equals(t)&&e.layoutPageIndex==t.layoutPageIndex),((e,t,r)=>{e.mainPageAreaChanges=rj.collectListChanges(t.mainSubDocumentPageAreas,r.mainSubDocumentPageAreas,$V,((e,t)=>!0),rj.collectColumnsChanges),e.anchoredPictureChanges=rj.collectMapChanges(rj.getOnlyPictureObjects(t.anchoredObjectHolder.objects),rj.getOnlyPictureObjects(r.anchoredObjectHolder.objects),HV,((e,t)=>e.equals(t)),((e,t,r)=>{})),e.otherPageAreaChanges=rj.collectMapChanges(t.otherPageAreas,r.otherPageAreas,$V,((e,i)=>!e.subDocument.isTextBox()||t.anchoredObjectHolder.getTextBoxByInternalSubDocId(e.subDocument.id).equals(r.anchoredObjectHolder.getTextBoxByInternalSubDocId(i.subDocument.id))),rj.collectColumnsChanges)})).reduceChanges()}static getOnlyPictureObjects(e){return b.j.reducedMap(e,(e=>e.getType()==lc.AnchorPicture?e:null))}static collectColumnsChanges(e,t,r){const i=new tj;e.columnChanges=rj.collectListChanges(t.columns,r.columns,qV,((e,t)=>!0),((e,t,r)=>{e.rowChanges=rj.collectListChanges(t.rows,r.rows,WV,((e,t)=>rj.isLayoutRowEquivalent(e,t,i)),((e,t,r)=>{})),e.paragraphFrameChanges=mW.collect(t.paragraphFrames,r.paragraphFrames),e.tableChanges=rj.collectListChanges(t.tablesInfo,r.tablesInfo,zV,((e,t)=>e===t),((e,t,r)=>{}))}))}static collectListChanges(e,t,r,i,n){const o=[];for(let a,s=0;a=t[s];s++)o.push(rj.makeChange(e[s],a,s,r,((e,t)=>e.equals(t)&&i(e,t)),n));return f.ListUtils.reverseForEach(e,((e,t)=>o.push(new r(t,wV.Deleted))),e.length-1,t.length),o}static collectMapChanges(e,t,r,i,n){const o=[],a=b.j.map(e,(e=>e));return b.j.forEach(t,((e,t)=>{o.push(rj.makeChange(a[t],e,t,r,((e,t)=>e.equals(t)&&i(e,t)),n)),delete a[t]})),b.j.forEach(a,((e,t)=>o.push(new r(t,wV.Deleted)))),o}static makeChange(e,t,r,i,n,o){if(!e)return new i(r,wV.Inserted);if(n(e,t)){const n=new i(r,wV.Updated);return o(n,e,t),n}return new i(r,wV.Replaced)}static isLayoutRowEquivalent(e,t,r){return!(e.x!=t.x||e.y!=t.y||e.width!=t.width||e.height!=t.height||e.baseLine!=t.baseLine||e.boxes.length!=t.boxes.length||e.bookmarkBoxes.length!=t.bookmarkBoxes.length||e.tableCellInfo&&e.indexInColumn!=t.indexInColumn)&&(!(f.ListUtils.anyOf2(e.boxes,t.boxes,((e,t)=>!e.equals(t)))||f.ListUtils.anyOf2(e.bookmarkBoxes,t.bookmarkBoxes,((e,t)=>!e.equals(t)))||(e.numberingListBox?!e.numberingListBox.equals(t.numberingListBox):t.numberingListBox))&&r.isEquivalent(e,t))}}!function(e){e[e.CreateNewPage=1]="CreateNewPage",e[e.UseOldPage=2]="UseOldPage",e[e.RestartFromTableStartPosition=3]="RestartFromTableStartPosition"}(NV||(NV={}));class ij extends ej{constructor(e){super(e,uu.MAIN_SUBDOCUMENT_ID),this.state=AV.DocumentStart,this.stateMap[AV.DocumentStart]=this.processStateDocumentStart,this.stateMap[AV.PageStart]=this.processStatePageStart,this.stateMap[AV.PageAreaEnd]=this.processStatePageAreaEnd,this.stateMap[AV.PageEnd]=this.processStatePageEnd,this.stateMap[AV.DocumentEnd]=this.processStateDocumentEnd,this.stateMap[AV.End]=this.processStateEnd}formatNext(){do{if(!this.stateMap[this.state].call(this))return!1}while(ij.notAllowBreakOnState[this.state](this.layoutPosition));return!0}processStateDocumentStart(){return this.manager.activeFormatter=this,this.initDocumentStart(),this.layoutPosition=new Kp(Hu.None),this.layoutPosition.pageIndex=0,this.state=AV.PageStart,!0}processStatePageStart(){this.manager.activeFormatter=this;const e=this.rowFormatter.iterator.getWrap(!1);if(!e)return!1;O.print(L.LayoutFormatter,"processStatePageStart",(()=>`SubDocId: ${this.subDocument.id}, LayPos: ${KV.layoutPositionShort(this.layoutPosition)}`));const t=this.manager.layout.pages,r=this.manager.boundsCalculator,i=t[this.layoutPosition.pageIndex-1],n=i?i.layoutPageIndex+1:0;r.initWhenPageStart(n);const o=i?this.manager.model.getSectionByPosition(i.getPosition()):null,a=e.info.sectionIndex,s=this.manager.model.sections[a],l=o!=s,d=this.manager.model.mirrorMargins;if(this.manager.innerClientProperties.viewsSettings.isSimpleView){const e=this.manager.innerClientProperties.viewsSettings.widthOfPage,t=new Ch(s.documentModel,s.startLogPosition,s.getLength(),yh.createSimpleSectionProperties(e,Bo.Constants.MAX_SAFE_INTEGER));t.sectionProperties.margins.copyFrom(this.manager.innerClientProperties.viewsSettings.paddings),t.sectionProperties.margins.applyConverter(g.u.pixelsToTwips),r.init(t),r.setHeaderBounds(0),r.setFooterBounds(0)}else(l||d)&&r.init(s);r.calculatePageBounds(i?i.bottom:0);const c=this.manager.floatingRestartInfoHolder.isRestartByAnchorObjects?[NV.CreateNewPage]:this.tryReusePage(r.pageBounds);switch(c[0]){case NV.CreateNewPage:this.createNextPage(r.pageBounds),this.manager.floatingRestartInfoHolder.setCalculatedObjects(this.layoutPosition);break;case NV.UseOldPage:break;case NV.RestartFromTableStartPosition:return this.manager.invalidator.onIntervalChanged(this.subDocument.id,new on.FixedInterval(c[1],1)),!0}const h=this.layoutPosition.pageIndex,u=this.layoutPosition.page;u.flags.set(Wu.IsFirstPageOfSection,l),u.index=h,u.layoutPageIndex=n,u.pageOrdinal=this.calculatePageOrdinal(i,l,s),u.startPageSectionIndex=a;const p=(0,S.isEven)(n);if(i&&l&&(s.sectionProperties.startType===Vs.EvenPage&&!p||s.sectionProperties.startType===Vs.OddPage&&p)&&u.layoutPageIndex++,!this.manager.innerClientProperties.viewsSettings.isSimpleView){if(this.formatOtherHeaderFooterPageArea(s.headers,(e=>this.manager.otherPageAreaFormatter.formatHeaderPageArea(u,e))),this.manager.floatingRestartInfoHolder.isRestartByAnchorObjects)return!0;if(this.formatOtherHeaderFooterPageArea(s.footers,(e=>this.manager.otherPageAreaFormatter.formatFooterPageArea(u,e))),this.manager.floatingRestartInfoHolder.isRestartByAnchorObjects)return!0}return r.calculateMainPageAreaBounds(-1),r.calculateColumnBounds(f.ListUtils.last(r.mainPageAreasBounds)),this.pageAreaBounds=f.ListUtils.last(r.mainPageAreasBounds),this.columnBounds=f.ListUtils.last(r.mainColumnsBounds),!0}calculatePageOrdinal(e,t,r){var i;const n=r.sectionProperties.startType;let o;o=t&&!r.sectionProperties.continueNumbering?r.sectionProperties.firstPageNumber:(null!==(i=null==e?void 0:e.pageOrdinal)&&void 0!==i?i:0)+1;const a=o%2!=0;switch(n){case Vs.OddPage:return a?o:o+1;case Vs.EvenPage:return a?o+1:o;default:case Vs.Continuous:return o}}processStatePageAreaEnd(){return this.manager.activeFormatter=this,ej.correctColumnOffsets(this.layoutPosition.pageArea),O.print(L.LayoutFormatter,"processStatePageAreaEnd",(()=>`SubDocId: ${this.subDocument.id}, LayPos: ${KV.layoutPositionShort(this.layoutPosition)}`)),this.layoutPosition.detailsLevel=Hu.Page,this.state=AV.PageEnd,!0}processStatePageEnd(){this.manager.activeFormatter=this;const e=this.manager.layout;O.print(L.LayoutFormatter,"processStatePageEnd",(()=>`SubDocId: ${this.subDocument.id}, LayPos: ${KV.layoutPositionShort(this.layoutPosition)}`));const t=this.layoutPosition.page;t.anchoredObjectHolder.removeOrphanedObjects(this),t.isValid=!0,ij.correctPageOffsets(t),this.state=this.lastRowInfo.row.flags.get(xV.DocumentEnd)?AV.DocumentEnd:AV.PageStart,this.tableFormatter||(e.validPageCount=this.layoutPosition.pageIndex+1,e.lastMaxNumPages=Math.max(e.lastMaxNumPages,t.layoutPageIndex+1)),t.calculateContentIntervals(this.manager.layout.anchorObjectsPositionInfo,!1),t.setRenderLevelCalculator(this.manager.layout.anchorObjectsPositionInfo,this.manager.model.compatibilitySettings.compatibilityMode);const r=rj.collectPageChanges(e.pages,t);this.manager.changesManager.addPageChange(r),this.copyFlagsFromOldPage(e.pages[t.index],t),e.pages[t.index]=t;const i=f.ListUtils.last(t.mainSubDocumentPageAreas[0].columns[0].rows).tableCellInfo;return i&&(i.parentRow.rowIndex!=i.parentRow.parentTable.logicInfo.grid.table.rows.length-1||i.parentRow.parentTable.isBoundWithNext())||this.manager.onPagesReady(),this.layoutPosition.detailsLevel=Hu.None,this.layoutPosition.pageIndex++,this.layoutPosition.page=null,!0}processStateDocumentEnd(){this.manager.activeFormatter=this,O.print(L.LayoutFormatter,"processStateDocumentEnd",(()=>`SubDocId: ${this.subDocument.id}, LayPos: ${KV.layoutPositionShort(this.layoutPosition)}`));const e=this.manager.layout;return this.manager.removeRedundantHelper.removeRedundantPage(e,e.validPageCount),e.isFullyFormatted=!0,e.lastMaxNumPages=f.ListUtils.last(this.manager.layout.pages).layoutPageIndex+1,this.manager.layoutDependentRunCache.recalculateHeaderFooterPageAreas(),this.manager.onPagesReady(),O.print(L.LayoutFormatter,"processStateDocumentEnd(end)\n",O.w(3,O.join)("\n")(O.map(((e,t)=>`\tPage[${t}]Intervals: ${sg.level_1(lg.fixedInterval,e.getContentIntervals(),"\t\t","\t")()}`),this.manager.layout.pages))),this.state=AV.End,this.manager.anchoredObjectsManager.reset(),!1}processStateEnd(){return!1}copyFlagsFromOldPage(e,t){if(e){const r=e.flags.clone();r.set(Wu.IsFirstPageOfSection,t.flags.get(Wu.IsFirstPageOfSection)),r.set(Wu.IsIntervalsCorrect,t.flags.get(Wu.IsIntervalsCorrect)),t.flags=r}}createNextPage(e){const t=new ig;t.setGeomerty(e),t.setAbsolutePosition(this.rowFormatter.getPosition()),this.state=AV.PageAreaStart,this.layoutPosition.page=t,this.layoutPosition.pageAreaIndex=0,this.layoutPosition.pageArea=null,this.layoutPosition.detailsLevel=Hu.Page}tryReusePage(e){const t=this.manager.layout.pages[this.layoutPosition.pageIndex];if(!t||!t.isValid||this.tableFormatter||!t.equals(e)||t.getPosition()!=this.rowFormatter.getPosition())return[NV.CreateNewPage];this.layoutPosition.pageAreaIndex=t.mainSubDocumentPageAreas.length-1;const r=f.ListUtils.last(t.mainSubDocumentPageAreas),i=r.getLastColumn();this.lastRowInfo.setRowInfo(i.getLastRow(),t.getPosition()+r.pageOffset+i.pageAreaOffset,!1);const n=Tz.getFirstCellInPageThatBoundWithCellPlacedInNextPage(i.tablesInfo),o=n?t.getPosition()+r.pageOffset+i.pageAreaOffset+n.getEndPosition():t.getEndPosition(),a=this.manager.layout.pages[t.index+1],s=this.getLastWidowTableColumn(i);return!s||a&&a.isValid&&o==a.getPosition()?(this.rowFormatter.setPosition(o,!1,!this.tableFormatter),this.state=AV.PageEnd,this.layoutPosition.detailsLevel=Hu.Page,this.layoutPosition.page=t.deepCopy(),[NV.UseOldPage]):[NV.RestartFromTableStartPosition,this.getTableRestartPosition(s)]}getTableRestartPosition(e){return e.getTopLevelColumn().logicInfo.grid.table.interval.start}getLastWidowTableColumn(e){if(!e.tablesInfo[0])return null;const t=this.getWidowTableLastColumnIndex(e);return e.tablesInfo[t]}getWidowTableLastColumnIndex(e){const t=e.tablesInfo[0].logicInfo.grid.table;for(let r=1;r<e.tablesInfo.length;r++)if(t!=e.tablesInfo[r].logicInfo.grid.table)return r-1;return e.tablesInfo.length-1}formatOtherHeaderFooterPageArea(e,t){const r=(0,S.isEven)(this.layoutPosition.page.layoutPageIndex),i=this.layoutPosition.page.flags.get(Wu.IsFirstPageOfSection);t(e.getActualObject(i,r))}setParamsForRestart(e,t,r,i){this.state=e,this.layoutPosition=t,this.lastRowInfo=r,i&&(this.tableFormatter=null)}setBoundsForRestart(e,t){this.pageAreaBounds=e,this.columnBounds=t}static correctPageOffsets(e){const t=e.mainSubDocumentPageAreas;if(!t.length)return;const r=t[0].pageOffset;if(0!=r){e.setAbsolutePosition(e.getPosition()+r);for(let e of t)e.pageOffset-=r}}}ij.notAllowBreakOnState={[AV.DocumentStart]:e=>!0,[AV.PageStart]:e=>0==e.pageIndex,[AV.PageAreaStart]:e=>0==e.pageAreaIndex,[AV.ColumnStart]:e=>0==e.columnIndex,[AV.RowFormatting]:e=>0==e.rowIndex,[AV.DocumentEnd]:e=>!1,[AV.PageEnd]:e=>!1,[AV.PageAreaEnd]:e=>!1,[AV.ColumnEnd]:e=>!1};class nj{constructor(e){this.invalidator=e}modelChanged(e){switch(e.type){case pd.PageColor:O.print(L.LayoutFormatterNotifier,"modelChanged.PageColor",`pageColor:${e.newColor}`),this.invalidator.onChangedAllLayout();break;case pd.DefaultTabWidth:O.print(L.LayoutFormatterNotifier,"modelChanged.DefaultTabWidth",`defaultTabWidth:${e.newDefaultTabWidth}`),this.invalidator.onChangedAllLayout();break;case pd.DifferentOddAndEvenPages:O.print(L.LayoutFormatterNotifier,"modelChanged.DifferentOddAndEvenPages",`newValue:${e.newValue}`),this.invalidator.onChangedAllLayout();break;case pd.HeaderFooterCreated:O.print(L.LayoutFormatterNotifier,"modelChanged.HeaderFooterCreated",(()=>`isHeader:${e.isHeader}, type:${Ws[e.headerFooterType]}, subDocumentInfo:${lg.headerFooterSubDocumentInfoBase(e.subDocumentInfo)}`)),this.invalidator.onChangedAllLayout();break;case pd.HeaderFooterIndexChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.HeaderFooterIndexChanged",(()=>`sectionIndex:${e.sectionIndex}, isHeader:${e.isHeader}, type:${Ws[e.headerFooterType]}, newIndex:${e.newIndex}`)),this.invalidator.onHeaderFooterIndexChanged(e.sectionIndex,e.headerFooterType);break;case pd.SectionFormattingChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.SectionFormattingChanged",(()=>`property:${Hc[e.property]}, newState:${lg.historyItemState(lg.historyItemSectionStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onChangedSections(e.startSectionIndex,e.endSectionIndex);break;case pd.CreateStyleLink:O.print(L.LayoutFormatterNotifier,"modelChanged.CreateStyleLink",`paragraphStyleName:${e.paragraphStyleName}`);break;case pd.DeleteStyleLink:O.print(L.LayoutFormatterNotifier,"modelChanged.DeleteStyleLink",`paragraphStyleName:${e.paragraphStyleName}`);break;case pd.AbstractNumberingListAdded:O.print(L.LayoutFormatterNotifier,"modelChanged.AbstractNumberingListAdded",`index:${e.index}`);break;case pd.AbstractNumberingListDeleted:O.print(L.LayoutFormatterNotifier,"modelChanged.AbstractNumberingListDeleted",`index:${e.index}`);break;case pd.NumberingListAdded:O.print(L.LayoutFormatterNotifier,"modelChanged.NumberingListAdded",`index:${e.index}`);break;case pd.NumberingListDeleted:O.print(L.LayoutFormatterNotifier,"modelChanged.NumberingListDeleted",`index:${e.index}`);break;case pd.ListLevelPropertyChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.ListLevelPropertyChanged",`property:${yl[e.property]}, newState:${lg.historyItemState(lg.historyItemListLevelStateObject,e.newState,"\t","\n")()}`),this.invalidator.onListLevelChanged(e.newState);break;case pd.ListLevelParagraphPropertyChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.ListLevelParagraphPropertyChanged",(()=>`property:${Ee[e.property]}, newState:${lg.historyItemState(lg.historyItemListLevelUseStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onListLevelChanged(e.newState);break;case pd.ListLevelCharacterPropertyChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.ListLevelCharacterPropertyChanged",(()=>`property:${v[e.property]}, newState:${lg.historyItemState(lg.historyItemListLevelUseStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onListLevelChanged(e.newState);break;case pd.IOverrideListLevelChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.IOverrideListLevelChanged",(()=>`property:${wl[e.property]}, newState:${lg.historyItemState(lg.historyItemListLevelStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onListLevelChanged(e.newState);break;case pd.BookmarkCreated:O.print(L.LayoutFormatterNotifier,"modelChanged.BookmarkCreated",(()=>`subDocumentId:${e.subDocumentId}`)),this.invalidator.onIntervalChanged(e.subDocumentId,on.FixedInterval.makeByConstInterval(e.bkmTempate.interval));break;case pd.BookmarkDeleted:O.print(L.LayoutFormatterNotifier,"modelChanged.BookmarkDeleted",(()=>`subDocumentId:${e.subDocumentId}`)),this.invalidator.onIntervalChanged(e.subDocumentId,on.FixedInterval.makeByConstInterval(e.bkmTempate.interval));break;case pd.TabInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.TabInserted",(()=>`subDocumentId:${e.subDocumentId}, newState:${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.newState.interval);break;case pd.TabDeleted:O.print(L.LayoutFormatterNotifier,"modelChanged.TabDeleted",(()=>`subDocumentId:${e.subDocumentId}, newState:${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.newState.interval);break;case pd.InlinePictureInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.InlinePictureInserted",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}, id:${e.picInfo.cacheInfo.currId}`)),this.invalidator.onContentInserted(e.subDocumentId,e.position,1,!1);break;case pd.InlinePicturesUpdated:O.print(L.LayoutFormatterNotifier,"modelChanged.InlinePicturesUpdated",(()=>`subDocumentId:${e.subDocumentId}`)),this.invalidator.onIntervalChanged(e.subDocumentId,new on.FixedInterval(e.updatedImageInfo.position,1));break;case pd.AnchoredPictureInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.AnchoredPictureInserted",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}, id:${e.id}, scaleX:${e.size.scale.width}, scaleY:${e.size.scale.height}, anchorInfo:${e.anchorInfo}`)),this.invalidator.onContentInserted(e.subDocumentId,e.position,1,!1);break;case pd.AnchoredPictureSizeChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.AnchoredPictureSizeChanged",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,new on.FixedInterval(e.position,1));break;case pd.InlineObjectRunPropertyChanged:{O.print(L.LayoutFormatterNotifier,"modelChanged.InlineObjectRunPropertyChanged",(()=>`subDocumentId:${e.subDocumentId}, property:${Fc[e.property]}, position:${e.position}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`));const t=e.newState.interval;this.invalidator.onIntervalChanged(e.subDocumentId,on.FixedInterval.fromPositions(Math.max(0,t.start-1),t.end));break}case pd.HyperlinkInfoChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.HyperlinkInfoChanged",(()=>`subDocumentId:${e.subDocumentId}, fieldResultInterval:${lg.fixedInterval(e.fieldResultInterval)}, newHyperlinkInfo:${lg.hyperlinkInfo(e.newHyperlinkInfo)}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.fieldResultInterval);break;case pd.FieldsShowCodeChanged:this.invalidator.onIntervalChanged(e.subDocumentId,e.fieldInterval);break;case pd.SimpleRunInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.SimpleRunInserted",(()=>`subDocumentId:${e.subDocumentId}, logPosition:${e.position}, length:${length} type:${cs[e.runType]}`)),this.invalidator.onContentInserted(e.subDocumentId,e.position,e.length,!1);break;case pd.TextBufferChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.SimpleRunInserted",(()=>`subDocumentId:${e.subDocumentId}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.newState.interval);break;case pd.ParagraphInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.TextBufferChanged",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}`)),this.invalidator.onContentInserted(e.subDocumentId,e.position,1,!0);break;case pd.SectionInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.SectionInserted",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}`)),this.invalidator.onChangedSections(e.sectionIndex,e.sectionIndex);break;case pd.AnchoredTextBoxInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.AnchoredTextBoxInserted",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}, anchorInfo:${e.anchorInfo}`)),this.invalidator.onContentInserted(e.subDocumentId,e.position,1,!1);break;case pd.AnchorObjectRemoved:O.print(L.LayoutFormatterNotifier,"modelChanged.AnchorObjectRemoved",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}`)),this.invalidator.onIntervalChanged(e.subDocumentId,new on.FixedInterval(e.position,1));break;case pd.IntervalRemoved:O.print(L.LayoutFormatterNotifier,"modelChanged.IntervalRemoved",(()=>`subDocumentId:${e.subDocumentId}, position:${e.interval.start}, length:${e.interval.length}`)),this.invalidator.onContentInserted(e.subDocumentId,e.interval.start,-e.interval.length,!1);break;case pd.ParagraphMerged:O.print(L.LayoutFormatterNotifier,"modelChanged.ParagraphMerged",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}, getPropertiesFromNext:${e.getPropertiesFromNext}`)),this.invalidator.onContentInserted(e.subDocumentId,e.position,-1,!0);break;case pd.SectionMerged:O.print(L.LayoutFormatterNotifier,"modelChanged.SectionMerged",(()=>`sectionIndex:${e.sectionIndex}, getPropertiesFromNext:${e.getPropertiesFromNext}`)),this.invalidator.onChangedSections(e.sectionIndex,e.sectionIndex);break;case pd.CharacterFormattingChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.CharacterFormattingChanged",(()=>`subDocumentId:${e.subDocumentId}, property:${v[e.property]}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.newState.interval);break;case pd.CharacterPropertiesChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.CharacterPropertiesChanged",(()=>`subDocumentId:${e.subDocumentId}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.newState.interval);break;case pd.ParagraphFormattingChanged:{O.print(L.LayoutFormatterNotifier,"modelChanged.ParagraphFormattingChanged",(()=>`subDocumentId:${e.subDocumentId}, property:${Ee[e.property]}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`));const t=e.newState.interval;this.invalidator.onIntervalChanged(e.subDocumentId,on.FixedInterval.fromPositions(Math.max(0,t.start-1),t.end));break}case pd.ParagraphPropertiesChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.ParagraphPropertiesChanged",(()=>`subDocumentId:${e.subDocumentId}, paragraphIndex: ${e.paragraphIndex}}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.paragraphInterval);break;case pd.ParagraphAndCharacterMergedPropertiesReset:O.print(L.LayoutFormatterNotifier,"modelChanged.ParagraphAndCharacterMergedPropertiesReset",(()=>`subDocumentId:${e.subDocumentId}, interval:${lg.fixedInterval(e.interval)}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.interval);break;case pd.AnchoredTextBoxSizeChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.AnchoredTextBoxSizeChanged",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,new on.FixedInterval(e.position,1));break;case pd.AnchoredTextBoxPropertiesChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.AnchoredTextBoxPropertiesChanged",(()=>`subDocumentId:${e.subDocumentId}, position:${e.position}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,new on.FixedInterval(e.position,1));break;case pd.AnchorInfoPropertyChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.AnchorInfoPropertyChanged",(()=>`subDocumentId:${e.subDocumentId}, property:${Mc[e.property]}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),e.property===Mc.ZOrder?this.invalidator.onChangedAllLayout():this.invalidator.onIntervalChanged(e.subDocumentId,new on.FixedInterval(e.newState.interval.start,1));break;case pd.ShapeChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.ShapePropertyChanged",(()=>`subDocumentId:${e.subDocumentId}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,new on.FixedInterval(e.newState.interval.start,1));break;case pd.ShapePropertyChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.ShapePropertyChanged",(()=>`subDocumentId:${e.subDocumentId}, property:${Pc[e.property]}, newState:\n${lg.historyItemState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,new on.FixedInterval(e.newState.interval.start,1));break;case pd.CharacterStyleApplied:O.print(L.LayoutFormatterNotifier,"modelChanged.CharacterStyleApplied",(()=>`subDocumentId:${e.subDocumentId}, newState:${lg.historyItemIntervalState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.newState.interval);break;case pd.ParagraphStyleApplied:O.print(L.LayoutFormatterNotifier,`modelChanged.ParagraphStyleApplied. subDocumentId:${e.subDocumentId}, newState:`,e.newState),this.invalidator.onIntervalChanged(e.subDocumentId,e.newState.interval);break;case pd.TableStyleChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.TableStyleChanged",(()=>`subDocumentId:${e.subDocumentId}, tableIndex:${e.table.index}, newStyleName:${e.newStyle.styleName}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.table.getTopLevelParent().interval);break;case pd.ParagraphNumberingListChanged:{O.print(L.LayoutFormatterNotifier,"modelChanged.ParagraphNumberingListChanged",(()=>`subDocumentId:${e.subDocumentId}, newState:${lg.historyItemIntervalState(lg.historyItemIntervalStateObject,e.newState,"\t","\n")()}, oldAbstractNumberingListIndex: ${e.oldAbstractNumberingListIndex}`));const t=[e.newState.interval],r=e.newState.interval.start,i=C.SearchUtils.normedInterpolationIndexOf(e.subDocument.paragraphs,(e=>e.startLogPosition.value),r),n=e.subDocument.paragraphs[i].getAbstractNumberingListIndex();for(let r,o=i+1;r=e.subDocument.paragraphs[o];o++){const i=r.getAbstractNumberingListIndex();i!==e.oldAbstractNumberingListIndex&&i!==n||t.push(r.interval)}const o=nn.IntervalAlgorithms.getMergedIntervals(t,!0);for(let t of o)this.invalidator.onIntervalChanged(e.subDocumentId,t);break}case pd.TableCreated:O.print(L.LayoutFormatterNotifier,"modelChanged.TableCreated",(()=>`subDocumentId:${e.subDocumentId}, tableIndex:${e.table.index}`)),this.invalidator.onIntervalChanged(e.subDocumentId,e.table.getTopLevelParent().interval);break;case pd.TableRemoved:O.print(L.LayoutFormatterNotifier,"modelChanged.TableRemoved",(()=>`subDocumentId:${e.subDocumentId}, startPosition:${e.startPosition}, endPosition:${e.endPosition}, nestedLevel:${e.nestedLevel}`)),this.invalidator.onIntervalChanged(e.subDocumentId,on.FixedInterval.fromPositions(e.startPosition,e.endPosition));break;case pd.TableStartPositionShifted:O.print(L.LayoutFormatterNotifier,"modelChanged.TableStartPositionShifted",(()=>`subDocumentId:${e.subDocumentId}, oldPosition:${e.oldPosition}, newPosition:${e.newPosition}, tableIndex:${e.table.index}`)),this.invalidator.onTableChanged(e.subDocumentId,e.table.index,e.table.nestedLevel);break;case pd.TableCellPropertyChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.TableCellPropertyChanged",(()=>`subDocumentId:${e.subDocumentId}, property:${cl[e.property]}, newState:\n${lg.historyItemState(lg.historyItemTableCellStateObject,e.newState,"\t","\n")()}`));for(let t of e.newState.objects)this.invalidator.onTableChanged(e.subDocumentId,t.tableIndex,t.tableNestedLevel);break;case pd.TablePropertyChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.TablePropertyChanged",(()=>`subDocumentId:${e.subDocumentId}, property:${ks[e.property]}, newState:\n${lg.historyItemState(lg.historyItemTableStateObject,e.newState,"\t","\n")()}`));for(let t of e.newState.objects)this.invalidator.onTableChanged(e.subDocumentId,t.tableIndex,t.tableNestedLevel);break;case pd.TableRowPropertyChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.TableRowPropertyChanged",(()=>`subDocumentId:${e.subDocumentId}, property:${ml[e.property]}, newState:\n${lg.historyItemState(lg.historyItemTableRowStateObject,e.newState,"\t","\n")()}`));for(let t of e.newState.objects)this.invalidator.onTableChanged(e.subDocumentId,t.tableIndex,t.tableNestedLevel);break;case pd.TableCellSplittedHorizontally:O.print(L.LayoutFormatterNotifier,"modelChanged.TableCellSplittedHorizontally",(()=>`subDocumentId:${e.subDocumentId}, tableIndex:${e.table.index}, rowIndex:${e.rowIndex}, cellIndex:${e.cellIndex}, rightDirection:${e.rightDirection}`)),this.invalidator.onTableChanged(e.subDocumentId,e.table.index,e.table.nestedLevel);break;case pd.TableCellMergedHorizontally:O.print(L.LayoutFormatterNotifier,"modelChanged.TableCellMergedHorizontally",(()=>`subDocumentId:${e.subDocumentId}, tableIndex:${e.table.index}, rowIndex:${e.rowIndex}, cellIndex:${e.cellIndex}, rightDirection:${e.rightDirection}`)),this.invalidator.onTableChanged(e.subDocumentId,e.table.index,e.table.nestedLevel);break;case pd.TableRowInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.TableRowInserted",(()=>`subDocumentId:${e.subDocumentId}, tableIndex:${e.table.index}, rowIndex:${e.rowIndex}`)),this.invalidator.onTableChanged(e.subDocumentId,e.table.index,e.table.nestedLevel);break;case pd.TableRowRemoved:O.print(L.LayoutFormatterNotifier,"modelChanged.TableRowRemoved",(()=>`subDocumentId:${e.subDocumentId}, tableIndex:${e.table.index}, rowIndex:${e.rowIndex}`)),this.invalidator.onTableChanged(e.subDocumentId,e.table.index,e.table.nestedLevel);break;case pd.TableCellRemoved:O.print(L.LayoutFormatterNotifier,"modelChanged.TableCellRemoved",(()=>`subDocumentId:${e.subDocumentId}, tableIndex:${e.table.index}, rowIndex:${e.rowIndex}, cellIndex:${e.cellIndex}`)),this.invalidator.onTableChanged(e.subDocumentId,e.table.index,e.table.nestedLevel);break;case pd.TableCellInserted:O.print(L.LayoutFormatterNotifier,"modelChanged.TableCellInserted",(()=>`subDocumentId:${e.subDocumentId}, tableIndex:${e.table.index}, rowIndex:${e.rowIndex}, cellIndex:${e.cellIndex}`)),this.invalidator.onTableChanged(e.subDocumentId,e.table.index,e.table.nestedLevel);break;case pd.DocumentProtectionChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.DocumentProtectionChanged",`enforceProtection:${e.documentProtectionProperties.enforceProtection}`),this.invalidator.onChangedAllLayout();break;case pd.RangePermissionsChanged:O.print(L.LayoutFormatterNotifier,"modelChanged.RangePermissionsChanged",(()=>`subDocumentId:${e.subDocumentId},  interval:${lg.fixedInterval(e.permission.interval)}, userName:${e.permission.userName}, group:${e.permission.group}`)),this.invalidator.onIntervalChanged(e.subDocumentId,on.FixedInterval.makeByConstInterval(e.permission.interval))}}}class oj{constructor(e){this.manager=e}formatOtherPageArea(e,t,r,i,n){if(!t)return void r(0);O.print(L.LayoutFormatter,"formatHeaderOrFooterPageArea",(()=>`headerSubDocumentInfo: ${lg.subDocumentInfoBase(t)}`));const o=this.manager.activeFormatter;r(-1),this.shiftFooterObjectByVertical(e.otherPageAreas,t,e.anchoredObjectHolder,((e,t)=>{t&&(t.y+=e.yShift),e.y+=e.yShift,e.yShift=0}));const a=new ej(this.manager,t.subDocumentId);a.initDocumentStart(),a.formatPageArea(i(),[n()],e);const s=a.layoutPosition.pageArea;if(s){r(f.ListUtils.last(s.columns[0].rows).bottom);const o=s.columns[0];let a=s.y+o.y;s.setGeomerty(i()),a-=s.y+o.y,o.setGeomerty(n()),oj.reduceRowHeight(o),this.shiftFooterObjectByVertical(e.otherPageAreas,t,e.anchoredObjectHolder,((e,t)=>{t&&(t.y-=a),e.y-=a,e.yShift=a}))}else r(0);this.manager.activeFormatter=o}shiftFooterObjectByVertical(e,t,r,i){t.isFooter&&b.j.forEach(r.objects,(r=>{r.belongsToSubDocId!=t.subDocumentId||!r.anchorInfo.isUsedVerticalAbsolutePosition()&&!r.anchorInfo.isUsedVerticalRelativePosition()||r.anchorInfo.verticalPositionType!=fc.Paragraph&&r.anchorInfo.verticalPositionType!=fc.Line||i(r,r.getType()==lc.AnchorTextBox?e[r.internalSubDocId]:null)}))}setTextBoxContent(e,t){const r=this.manager.model.subDocuments[t.internalSubDocId].info;if(!r.isTextBox)throw new Error(R.D.InternalException);const i=r,n=t.textBoxProperties.getContentMargins(),o=t.getContentBounds(),a=new Va.Rectangle(0,0,o.width,o.height),s=a.clone().applyOffsetsInside(n);if(this.formatOtherPageArea(e,i,(e=>{}),(()=>a),(()=>s)),t.textBoxProperties.resizeShapeToFitText){const r=e.otherPageAreas[t.internalSubDocId],i=r.columns[0],n=i.getLastRow().bottom,o=i.height-n;Number.isNaN(o)||(i.height-=o,r.height-=o,t.height-=o)}}formatHeaderPageArea(e,t){const r=this.manager.boundsCalculator;this.formatOtherPageArea(e,t,(e=>r.setHeaderBounds(e)),(()=>r.headerPageAreaBounds),(()=>r.headerColumnBounds))}formatFooterPageArea(e,t){const r=this.manager.boundsCalculator;this.formatOtherPageArea(e,t,(e=>r.setFooterBounds(e)),(()=>r.footerPageAreaBounds),(()=>r.footerColumnBounds))}static reduceRowHeight(e){const t=e.height;for(let r of e.rows)r.y>=t&&!r.tableCellInfo&&(r.y=t,r.height=0)}}class aj{constructor(){this.anchorRestartFromPageIndex=-1,this.oldAnchorObjectsFromPage={},this.oldOtherTextBoxPageAreas={},this.init()}init(){this.anchorRestartFromPageIndex=-1,this.oldAnchorObjectsFromPage={},this.oldOtherTextBoxPageAreas={}}storeInfo(e){this.anchorRestartFromPageIndex=e.pageIndex,this.oldAnchorObjectsFromPage=e.page.anchoredObjectHolder.objects,this.oldOtherTextBoxPageAreas=b.j.reducedMap(e.page.otherPageAreas,(e=>e.subDocument.isTextBox()?e:null)),this.oldTableAnchorObjects=e.page.tableAnchoredObjectsHolder.holder}get isRestartByAnchorObjects(){return-1!=this.anchorRestartFromPageIndex}setCalculatedObjects(e){this.isRestartByAnchorObjects&&(this.anchorRestartFromPageIndex==e.pageIndex&&(e.page.anchoredObjectHolder.objects=this.oldAnchorObjectsFromPage,b.j.forEach(this.oldOtherTextBoxPageAreas,(t=>e.page.otherPageAreas[t.subDocument.id]=t)),e.page.tableAnchoredObjectsHolder.holder=this.oldTableAnchorObjects),this.init())}}class sj{constructor(e){this.manager=e,this.reset()}reset(){this.cache={}}add(e,t){const r=this.cache[e];r?f.ListUtils.unsafeAnyOf(r,(e=>e==t))||r.push(t):this.cache[e]=[t]}recalculateHeaderFooterPageAreas(){const e=this.manager.layout.pages;b.j.forEach(this.cache,((t,r)=>{const i=e[r];if(!i)return;const n=b.j.shallowCopy(i.otherPageAreas);f.ListUtils.forEach(t,(e=>{const t=i.otherPageAreas[e];if(!t||!t.subDocument.isHeaderFooter())return;const r=this.manager.model.sections[i.startPageSectionIndex];this.manager.boundsCalculator.init(r),t.subDocument.isHeader()?this.manager.otherPageAreaFormatter.formatHeaderPageArea(i,t.subDocument.info):this.manager.otherPageAreaFormatter.formatFooterPageArea(i,t.subDocument.info)})),this.manager.changesManager.addPageChange(rj.collectHeaderFooterChanges(r,n,i.otherPageAreas))}))}}class lj{constructor(e){this.changesManager=e}static removeRendundant(e,t,r){const i=e<t.length;for(let i=t.length-1;i>=e;i--)t.pop(),r(i);return i}removeRedundantPage(e,t){return lj.removeRendundant(t,e.pages,(e=>this.changesManager.addPageChange(new JV(e,wV.Deleted,[],[]))))}removeRedundantPageAreas(e,t,r){return lj.removeRendundant(t,e.mainSubDocumentPageAreas,(e=>r.mainPageAreaChanges.push(new $V(e,wV.Deleted,[]))))}removeRedundantColumnsFromArea(e,t,r){return lj.removeRendundant(t,e.columns,(e=>r.columnChanges.push(new qV(e,wV.Deleted,[],[],[]))))}removeRedundantRowsFromColumn(e,t,r){return lj.removeRendundant(t,e.rows,(e=>r.rowChanges.push(new WV(e,wV.Deleted))))}removeRedundantTableInfosFromColumn(e,t,r){return lj.removeRendundant(t,e.tablesInfo,(e=>r.tableChanges.push(new zV(e,wV.Deleted))))}}class dj{constructor(e,t,r){this.model=e,this.layout=t,this.headerFooterType=r}isNoPages(){return this.startPageIndex=0,this.endPageIndex=0,0==this.layout.pages.length}initByPageIndex(e){this.isNoPages()||(this.initPageIndex=Math.min(e,this.layout.pages.length-1),this.initSectionIndex=Ch.getPageSectionIndex(this.layout.pages[this.initPageIndex],this.model.sections),this.calculatePageIndexes())}initBySectionIndex(e){if(this.isNoPages())return;this.initSectionIndex=e;const t=this.model.sections[this.initSectionIndex].startLogPosition.value;this.initPageIndex=C.SearchUtils.normedInterpolationIndexOf(this.layout.pages,(e=>e.getPosition()),t),this.calculatePageIndexes()}calculatePageIndexes(){this.calcStartPageIndex();const e=e=>++e;this.endPageIndex=this.getPageIndex(this.getSectionIndex(e)-this.initSectionIndex+1,e),this.endPageIndex<=this.startPageIndex&&(this.endPageIndex=this.startPageIndex+1)}calcStartPageIndex(){const e=e=>--e,t=this.getSectionIndex(e);this.startPageIndex=this.getPageIndex(this.initSectionIndex-t+1,e)}getSectionIndex(e){const t=this.model.sections;let r=this.initSectionIndex;for(let i;(i=t[r])&&mh.isLinkedToPrevious(i,this.headerFooterType);r=e(r));return Math.max(0,r)}getPageIndex(e,t){const r=this.layout.pages;let i=this.initPageIndex;for(let n;n=r[i];i=t(i))if(n.flags.get(Wu.IsFirstPageOfSection)){if(!(e>0))break;e--}return Math.max(0,i)}}class cj{static deleteInterval(e,t,r,i){cj.deleteElementContent(0,[new uj(on.FixedInterval.fromPositions(0,r.end),i),new pj(t,e.pages),new gj(t),new mj(t),new fj(t)],r)}static deleteElementContent(e,t,r){const i=t[e];i.contentDeleted=!1;let n=i.getElementInterval(),o=n.start,a=nn.IntervalAlgorithms.getIntersection(n,r),s=!1;if(a&&a.length>0){if(n.length==a.length&&e>0)return t[e-1].addChange(t[e].deleteElement()),!0;if(e+1==t.length){const e=n.length-a.length,t=new yW(null,null,rn.StringUtils.repeat(" ",e));t.rowOffset=0;i.getElement().boxes=[t],i.contentDeleted=!0}else{const r=new on.FixedInterval(a.start-o,a.length),n=t[e+1];for(e>0&&i.assignChanges(t[e-1]);n.setElement();)this.deleteElementContent(e+1,t,r)||n.incElementIndex(),n.contentDeleted&&(1==e&&(i.layoutPosition.page.isValid=!1),i.contentDeleted=!0);s=!0}}if(a?o==a.start&&i.setElementOffset(r.start):o>=r.end&&i.setElementOffset(Math.max(0,o-r.length)),s&&i.correctOffsets(),1==e){const e=i.updatePage(!!a);if(e)return t[0].addChange(e),!0}return!1}}class hj{}class uj extends hj{constructor(e,t){super(),this.delInterval=e,this.pageChanges=t}setElement(){return null}incElementIndex(){}getElementInterval(){return this.delInterval}setElementOffset(e){}deleteElement(){return null}correctOffsets(){}addChange(e){this.pageChanges.push(e)}assignChanges(e){}}class pj extends hj{constructor(e,t){super(),this.layoutPosition=e,this.pages=t}updatePage(e){const t=this.layoutPosition.page;e&&t.markPageIntervalsAsIncorrect();const r=this.layoutPosition.pageIndex,i=this.pages[r-1];return i&&t.getPosition()<=i.getPosition()?(t.index=r-1,t.y=t.index>0?this.pages[t.index-1].bottom:0,this.deleteElement(t.index)):(t.index=r,t.y=i?i.bottom:0,null)}checkTableExceptionCase(){const e=this.layoutPosition.pageIndex;return e-1>=0&&this.pages[e].getPosition()<=this.pages[e-1].getPosition()?this.deleteElement(e-1):null}setElement(){return!!(this.layoutPosition.page=this.pages[this.layoutPosition.pageIndex])}incElementIndex(){this.layoutPosition.pageIndex++}getElementInterval(){const e=this.layoutPosition.page;return on.FixedInterval.fromPositions(e.getPosition(),e.getEndPosition())}setElementOffset(e){this.layoutPosition.page.setAbsolutePosition(e)}deleteElement(e=this.layoutPosition.pageIndex){return this.pages.splice(e,1),new JV(e,wV.Deleted,[],[])}correctOffsets(){pj.correctPageOffsets(this.layoutPosition.page)}addChange(e){this.pageAreaChanges.push(e)}assignChanges(e){this.pageAreaChanges=[],e.pageChanges.push(new JV(this.layoutPosition.pageIndex,wV.Updated,this.pageAreaChanges,[]))}static correctPageOffsets(e){const t=e.mainSubDocumentPageAreas;if(!t.length)return;const r=t[0].pageOffset;if(r>0){e.setAbsolutePosition(e.getPosition()+r);for(let e of t)e.pageOffset-=r}}}class gj extends hj{constructor(e){super(),this.layoutPosition=e}setElement(){return!!(this.layoutPosition.pageArea=this.layoutPosition.page.mainSubDocumentPageAreas[this.layoutPosition.pageAreaIndex])||(this.layoutPosition.pageAreaIndex=0,!1)}incElementIndex(){this.layoutPosition.pageAreaIndex++}getElementInterval(){const e=this.layoutPosition.pageArea;return on.FixedInterval.fromPositions(e.pageOffset,e.getEndPosition())}setElementOffset(e){this.layoutPosition.pageArea.pageOffset=e}deleteElement(){const e=this.layoutPosition.pageAreaIndex;return this.layoutPosition.page.mainSubDocumentPageAreas.splice(e,1),new $V(e,wV.Deleted,[])}correctOffsets(){gj.correctColumnOffsets(this.layoutPosition.pageArea)}addChange(e){this.columnChanges.push(e)}assignChanges(e){this.columnChanges=[],e.pageAreaChanges.push(new $V(this.layoutPosition.pageAreaIndex,wV.Updated,this.columnChanges))}static correctColumnOffsets(e){const t=e.columns;if(!t.length)return;const r=t[0].pageAreaOffset;if(r>0){e.pageOffset+=r;for(let e of t)e.pageAreaOffset-=r}}}class mj extends hj{constructor(e){super(),this.layoutPosition=e}setElement(){return!!(this.layoutPosition.column=this.layoutPosition.pageArea.columns[this.layoutPosition.columnIndex])||(this.layoutPosition.columnIndex=0,!1)}incElementIndex(){this.layoutPosition.columnIndex++}getElementInterval(){const e=this.layoutPosition.column;return on.FixedInterval.fromPositions(e.pageAreaOffset,e.getEndPosition())}setElementOffset(e){this.layoutPosition.column.pageAreaOffset=e}deleteElement(){const e=this.layoutPosition.columnIndex;return this.layoutPosition.pageArea.columns.splice(e,1),new qV(e,wV.Deleted,[],[],[])}correctOffsets(){mj.correctRowOffsets(this.layoutPosition.column)}addChange(e){this.rowChanges.push(e)}assignChanges(e){this.rowChanges=[],e.columnChanges.push(new qV(this.layoutPosition.columnIndex,wV.Updated,this.rowChanges,[],[]))}static correctRowOffsets(e){const t=e.rows;if(!t.length)return;const r=t[0].columnOffset;if(r>0){e.pageAreaOffset+=r;for(let e of t)e.columnOffset-=r}}}class fj extends hj{constructor(e){super(),this.layoutPosition=e}getElement(){return this.layoutPosition.row}getElementParentContainer(){return this.layoutPosition.column.rows}setElement(){return!!(this.layoutPosition.row=this.layoutPosition.column.rows[this.layoutPosition.rowIndex])||(this.layoutPosition.rowIndex=0,!1)}incElementIndex(){this.layoutPosition.rowIndex++}getElementInterval(){const e=this.layoutPosition.row;return on.FixedInterval.fromPositions(e.columnOffset,e.getEndPosition())}setElementOffset(e){if(e<0)throw new Error(R.D.InternalException);this.layoutPosition.row.columnOffset=e}deleteElement(){const e=this.layoutPosition.rowIndex;return this.getElementParentContainer().splice(e,1),new WV(e,wV.Deleted)}correctOffsets(){}addChange(e){}assignChanges(e){}}class bj{get model(){return this.manager.model}get layout(){return this.manager.layout}get mainSubDoc(){return this.model.mainSubDocument}constructor(e){this.manager=e}onContentInserted(e,t,r,i){const n=this.model.subDocuments[e];if(0==this.layout.pages.length)return;if(!n.isMain())return O.print(L.LayoutFormatterInvalidator,"onContentInserted(header\\footer\\textBox)",`subDocument.id:${n.id}, logPosition:${t}, length:${r}, restartFromParagraphStart:${i}`),void this.otherSubDocChanged();const o=new on.FixedInterval(t,r);if(r>0)this.contentOfMainSubDocumentInsertedOrDeleted(o,i,(e=>this.advanceForward(e,r)));else{if(!(r<0))throw new Error(R.D.InternalException);this.contentOfMainSubDocumentInsertedOrDeleted(o,i,(e=>cj.deleteInterval(this.layout,e,o,this.manager.changesManager.getPageChanges())))}}contentOfMainSubDocumentInsertedOrDeleted(e,t,r){O.print(L.LayoutFormatterInvalidator,"contentInserted",`subDocument.id:0, logPosition:${e.start}, length:${e.length}, restartFromParagraphStart:${t}`);const i=[];t&&this.addRestartFromParagraph(i,e.start);const n=this.findLayoutPositionInAllLayout(this.mainSubDoc,e.start,Hu.Row,!1,!0),o=n.page.isValid;if(n.page.invalidate(),i.push(this.prevRowPositions(n)),r(n),!o){const e=f.ListUtils.last(i);e.modelPosition=e.layoutPosition.page.getPosition(),e.layoutPosition.initByIndexes(e.layoutPosition.pageIndex,0,0,0),e.layoutPosition.applyObjectsAsMainSubDocument(this.layout,-1)}this.callRestart(i)}onTableChanged(e,t,r){const i=this.model.subDocuments[e],n=i.tables[t].getTopLevelParent(),o=n.interval;if(r>0)return void this.onIntervalChanged(e,o);if(!i.isMain())return O.print(L.LayoutFormatterInvalidator,"onIntervalChanged(header\\footer)",`subDocument.id:${i.id}, interval:${lg.fixedInterval(o)}`),void this.otherSubDocChanged();const a=this.findLayoutPositionInAllLayout(i,o.start,Hu.Row,!1,!0),s=a.column.tablesInfo.find((e=>e.logicInfo.grid.table===n));let l=a.pageIndex;s&&null!==s.logicInfo.pageIndexFromWhichTableWasMoved&&(l=s.logicInfo.pageIndexFromWhichTableWasMoved),this.invalidatePagesByEndPosition(l,o.end),this.manager.restartManager.restartFromPage(l,o.start,!1)}onIntervalChanged(e,t){const r=this.model.subDocuments[e];if(0==t.length||!this.layout.pages.length)return;if(!r.isMain())return O.print(L.LayoutFormatterInvalidator,"onIntervalChanged(header\\footer)",`subDocument.id:${r.id}, interval:${lg.fixedInterval(t)}`),void this.otherSubDocChanged();O.print(L.LayoutFormatterInvalidator,"onIntervalChanged",`subDocument.id:${r.id}, interval:${lg.fixedInterval(t)}`);const i=this.findLayoutPositionInAllLayout(r,t.start,Hu.Row,!1,!0);this.invalidatePagesByEndPosition(i.pageIndex,t.end),this.manager.restartManager.restartFromPage(i.pageIndex,t.start,!1)}onChangedSections(e,t){O.print(L.LayoutFormatterInvalidator,"onChangedSection",`sectionIndex:${e}-${t}`);const r=this.model.sections[e],i=this.model.sections[t],n=this.layout.pages,o=r.startLogPosition.value,a=bj.getSectionFirstPageIndex(n,this.layout.validPageCount,r.startLogPosition.value),s=i.getEndPosition();for(let e,t=a;(e=n[t])&&e.getPosition()<=s;t++)e.invalidate();this.manager.restartManager.restartFromPage(a,o,!0)}onListLevelChanged(e){O.print(L.LayoutFormatterInvalidator,"onListLevelChanged newState\n",lg.historyItemState(lg.historyItemListLevelStateObject,e,"\t","\n"));for(let t of e.objects)b.j.forEach(this.model.subDocuments,(e=>{const r=t.isAbstractNumberingList?t.numberingListIndex:e.documentModel.numberingLists[t.numberingListIndex].abstractNumberingListIndex,i=t.listLevelIndex,n=[];for(let t of e.paragraphs)t.getAbstractNumberingListIndex()===r&&t.getListLevelIndex()===i&&n.push(t.interval);if(n.length>0){const t=nn.IntervalAlgorithms.getMergedIntervals(n,!0);for(let r of t)this.onIntervalChanged(e.id,r)}}))}onHeaderFooterIndexChanged(e,t){const r=new dj(this.model,this.layout,t);r.initBySectionIndex(e);const i=this.layout.pages[r.startPageIndex];i&&(f.ListUtils.forEach(this.layout.pages,(e=>e.invalidate()),r.startPageIndex,r.endPageIndex),this.manager.restartManager.restartFromPage(r.startPageIndex,i.getPosition(),!0))}onPagesChanged(e,t){const r=this.layout.pages[e];r&&(f.ListUtils.forEach(this.layout.pages,(e=>e.invalidate()),e,t),this.manager.restartManager.restartFromPage(e,r.getPosition(),!0))}onChangedAllLayout(){O.print(L.LayoutFormatterInvalidator,"onChangedAllLayout",""),this.manager.restartManager.restartAllLayout()}prevRowPositions(e){const t=e.clone();t.advanceToPrevRow(this.layout);const r=!t.row.tableCellInfo||e.row.tableCellInfo&&e.row.tableCellInfo.parentRow.parentTable.getTopLevelColumn()==t.row.tableCellInfo.parentRow.parentTable.getTopLevelColumn()?t:e;return new jp(r,this.getStartModelPositionOfRow(r))}callRestart(e){const t=f.ListUtils.minMax(e,(e=>e.modelPosition)),r=t.minElement.layoutPosition.pageIndex;f.ListUtils.forEach(this.layout.pages,(e=>e.invalidate()),r,t.maxElement.layoutPosition.pageIndex+1),this.layout.pages[r]&&this.manager.restartManager.restartFromPage(r,t.minElement.modelPosition,!1)}advanceForward(e,t){f.ListUtils.forEach(this.layout.pages,(e=>e.setAbsolutePosition(e.getPosition()+t)),e.pageIndex+1),this.moveRowsToRight(e,t),this.moveColumnsToRight(e,t),this.movePageAreasToRight(e,t)}moveRowsToRight(e,t){const r=e.column.rows;for(let i,n=e.rowIndex+1;i=r[n];n++)i.columnOffset+=t}moveColumnsToRight(e,t){const r=e.pageArea.columns;for(let i,n=e.columnIndex+1;i=r[n];n++)i.pageAreaOffset+=t}movePageAreasToRight(e,t){const r=e.page.mainSubDocumentPageAreas;f.ListUtils.forEach(r,(e=>e.pageOffset+=t),e.pageAreaIndex+1)}otherSubDocChanged(){f.ListUtils.forEach(this.layout.pages,(e=>e.invalidate())),this.manager.restartManager.restartFromPage(0,0,!0)}static getSectionFirstPageIndex(e,t,r){if(!t)return 0;const i=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.getPosition()),r,0,t-1));return e[i].getPosition()<r?Math.min(i+1,t):i}invalidatePagesByEndPosition(e,t){this.invalidatePages(e,(e=>t<e.getEndPosition()))}invalidatePages(e,t){const r=this.layout.pages;for(let i,n=e;(i=r[n])&&(i.invalidate(),!t(i));n++);}findLayoutPositionInAllLayout(e,t,r,i,n){const o=this.layout,a=o.validPageCount,s=o.isFullyFormatted;o.validPageCount=o.pages.length,o.isFullyFormatted=!0;const l=new ug(o,e,t,r,!0).create((new cg).setDefault(i),(new cg).setDefault(n));return o.validPageCount=a,o.isFullyFormatted=s,l}getStartModelPositionOfRow(e){var t;const r=e.clone();if(r.advanceToPrevRow(this.layout)){const i=r.row.tableCellInfo;if(!i)return r.getLogPosition(Hu.Row)+r.row.getLastBox().getEndPosition();const n=null===(t=e.row)||void 0===t?void 0:t.tableCellInfo,o=n?n.parentRow.parentTable.getTopLevelColumn():null,a=i?i.parentRow.parentTable.getTopLevelColumn():null;return n&&o.logicInfo==a.logicInfo?a.logicInfo.grid.table.getStartPosition():a.logicInfo.grid.table.getEndPosition()}return 0}extendByMultipageTables(e,t,r){if(!this.model.mainSubDocument.tables.length)return-1;const i=this.layout.pages[e];if(!i)return-1;const n=this.isPageStartWithMultipageTable(i);return n?t<n.getEndPosition()||r?n.getStartPosition():n.getEndPosition():-1}isPageStartWithMultipageTable(e){if(!e)return null;const t=e.mainSubDocumentPageAreas[0];if(!t)return null;const r=t.columns[0];if(!r)return null;const i=r.rows[0];if(!i)return null;const n=i.tableCellInfo;return bj.isLayoutRowRowStartWithMultipageTable(i)?n.parentRow.parentTable.getTopLevelColumn().logicInfo.grid.table:null}static isLayoutRowRowStartWithMultipageTable(e){const t=e.tableCellInfo;return this.isTableCellIsPartOfMultipageTable(t)}static isTableCellIsPartOfMultipageTable(e){return!!e&&(0!=e.parentRow.rowIndex||e.parentRow.parentTable.isBoundWithPrev()||this.isTableCellIsPartOfMultipageTable(e.parentRow.parentTable.parentCell))}addRestartFromParagraph(e,t){const r=this.mainSubDoc.getParagraphByPosition(t).startLogPosition.value,i=this.findLayoutPositionInAllLayout(this.mainSubDoc,r,Hu.Row,!1,!0);i.page.invalidate(),e.push(this.prevRowPositions(i))}}class Cj{constructor(e){this.manager=e}get restartPreparer(){return new Zz(this.manager)}restartOtherSubDocument(e,t){return new Sj(this.manager,e,t)}restartMainSubDocumentFromPage(e){return new Ij(this.manager,e)}restartMainSubDocumentFromRow(e,t){return Cj.isNeedRestartFromPage(e)?new Ij(this.manager,e.pageIndex):new wj(this.manager,e,t)}restart(){O.print(L.PositionSaver,"restart(from Base)","")}static isNeedRestartFromPage(e){return 0==e.pageAreaIndex&&0==e.columnIndex&&0==e.rowIndex}}class Sj extends Cj{constructor(e,t,r){super(e),this.subDocument=t,this.pageIndex=r}restartOtherSubDocument(e,t){return this.getNextState(t)}restartMainSubDocumentFromPage(e){return this.getNextState(e)}restartMainSubDocumentFromRow(e,t){return this.getNextState(e.pageIndex)}restart(){O.print(L.PositionSaver,"restart(from OherSubDocument)",`pageIndex: ${this.pageIndex}, subDocInfo:${lg.subDocumentInfoBase(this.subDocument.info)}`),this.restartPreparer.restartHeaderFooterInternal(this.subDocument,this.pageIndex)}getNextState(e){return new Ij(this.manager,Math.min(e,this.pageIndex))}}class Ij extends Cj{constructor(e,t){super(e),this.pageIndex=t}restartOtherSubDocument(e,t){return this.getNextState(t)}restartMainSubDocumentFromPage(e){return this.getNextState(e)}restartMainSubDocumentFromRow(e,t){return e.pageIndex<this.pageIndex?new wj(this.manager,e,t):this.getNextState(e.pageIndex)}restart(){O.print(L.PositionSaver,"restart(from page)",`pageIndex: ${this.pageIndex}`),this.restartPreparer.restartFromPage(this.pageIndex,!0,!0)}getNextState(e){return this.pageIndex=Math.min(e,this.pageIndex),this}}class Pj extends Cj{restartOtherSubDocument(e,t){return this}restartMainSubDocumentFromPage(e){return this}restartMainSubDocumentFromRow(e,t){return this}restart(){O.print(L.PositionSaver,"restart(all layout)",""),this.restartPreparer.restartFormatingAllLayout()}}class wj extends Cj{constructor(e,t,r){super(e),this.layoutPosition=t,this.modelPosition=r}restartOtherSubDocument(e,t){return this.getNextState(t)}restartMainSubDocumentFromRow(e,t){return e.pageIndex<=this.layoutPosition.pageIndex&&Cj.isNeedRestartFromPage(e)?new Ij(this.manager,e.pageIndex):(t<=this.modelPosition&&(this.modelPosition=t,this.layoutPosition=e),this)}restartMainSubDocumentFromPage(e){return this.getNextState(e)}restart(){O.print(L.PositionSaver,"restart(from row)",`modelPosition: ${this.modelPosition}, LP:${KV.layoutPositionShort(this.layoutPosition)}`),this.restartPreparer.restartFromRow(this.layoutPosition,this.modelPosition,!1)}getNextState(e){return e<=this.layoutPosition.pageIndex?new Ij(this.manager,e):this}}class yj{constructor(e){this.manager=e,this.reset()}reset(){this.layoutFormatterPositionSaver=new Cj(this.manager)}startFormatting(){this.layoutFormatterPositionSaver.restart(),this.reset()}restartFromPage(e,t,r){O.print(L.RestartManager,"restartFromPage",`pageIndex:${e}, minPosition:${t}, forceRestartFullPage:${r}`);const i=this.manager.invalidator.extendByMultipageTables(e,t,r);if(-1==i)this.restartTemplate(e,(()=>this.layoutFormatterPositionSaver.restartMainSubDocumentFromPage(e)));else{const t=this.manager.invalidator.findLayoutPositionInAllLayout(this.manager.model.mainSubDocument,i,Hu.Row,!1,!0);t.posIsStartPage()&&0!=t.pageIndex&&(t.advanceToPrevRow(this.manager.layout),t.rowIndex++,t.row=null),f.ListUtils.forEach(this.manager.layout.pages,(e=>e.invalidate()),t.pageIndex,e),this.restartFromRow(t,this.manager.invalidator.getStartModelPositionOfRow(t))}}restartFromRow(e,t){O.print(L.RestartManager,"restartFromRow",`modelPosition:${t}, lp:${KV.layoutPositionShort(e)}`),this.restartTemplate(e.pageIndex,(()=>this.layoutFormatterPositionSaver.restartMainSubDocumentFromRow(e,t)))}restartHeaderFooter(e,t){this.restartTemplate(t,(()=>this.layoutFormatterPositionSaver.restartOtherSubDocument(e,t)))}restartAllLayout(){this.restartTemplate(0,(()=>new Pj(this.manager)))}restartTemplate(e,t){this.manager.layout&&(this.manager.layout.isFullyFormatted=!1,this.manager.layout.validPageCount=Math.min(this.manager.layout.validPageCount,e)),this.layoutFormatterPositionSaver=t(),this.manager.isUpdateLocked()||this.manager.onUpdateUnlocked(0)}}class xj extends Lb.IS{get activeSubDocument(){return this.activeSubDocumentHolder.activeSubDocument}get isDocumentOpened(){return this._isDocumentOpened}constructor(e,t,r,i,n,o,a,s,l,d,c){super(),this.formatterProcessID=null,this.unhideProcessID=null,this._isDocumentOpened=!1,this.onLayoutChangedDispatcher=new Nb,this.measurer=e,this.innerClientProperties=t,this.model=r,this.layout=i,this.activeSubDocumentHolder=n,this.bookmarksSettings=o,this.documentProtectionSettings=a,this.controlHeightProvider=s,this.stringResources=l,f.ListUtils.forEach(d,(e=>this.onLayoutChangedDispatcher.add(e))),this.floatingRestartInfoHolder=new aj,this.mainFormatter=new ij(this),this.activeFormatter=this.mainFormatter,this.formatters={},this.changesManager=new oW,this.boundsCalculator=new vS,this.invalidator=new bj(this),this.modelChangesListener=new nj(this.invalidator),this.removeRedundantHelper=new lj(this.changesManager),this.otherPageAreaFormatter=new oj(this),this.layoutDependentRunCache=new sj(this),this.restartManager=new yj(this),this.anchoredObjectsManager=new cW(this),this.browserUtils=null!=c?c:{MacOSPlatform:yH.Browser.MacOSPlatform}}dispose(){clearTimeout(this.formatterProcessID),clearTimeout(this.unhideProcessID)}onUpdateUnlocked(e){this._isDocumentOpened&&this.restartManager.startFormatting()}getLayoutFormatter(e){const t=this.formatters[e];return t||(this.formatters[e]=new ej(this,e))}openDocument(){this._isDocumentOpened=!0,this.activeFormatter=this.mainFormatter}closeDocument(){this._isDocumentOpened=!1,this.stopFormatting(),this.formatters={},this.changesManager.reset(),this.layoutDependentRunCache.reset(),this.restartManager.reset()}runFormatting(e){if(this._isDocumentOpened){if(this.isUpdateLocked())throw new Error(R.D.InternalException);this.formatPage(e),this.runFormattingAsync()}}runFormattingAsync(){if(this.formatterProcessID||this.isUpdateLocked()||!this._isDocumentOpened)return;const e=()=>{if(this.isLocked())this.formatterProcessID=null;else{for(let e=10;e>0;e--)if(!this.mainFormatter.formatNext()){this.formatterProcessID=null;break}null!==this.formatterProcessID&&(this.formatterProcessID=setTimeout(e,0)),this.checkMeasureValid()}};this.formatterProcessID=setTimeout(e,0)}checkMeasureValid(){this.measurer.resultsIsInvalid&&(this.stopFormatting(),null===this.unhideProcessID&&(this.unhideProcessID=setInterval((()=>{if(this.measurer.resultsIsInvalid){const e=Fn.getRareCharProperty(this.model.cache.fontInfoCache.fontMeasurer);e.fontInfo.reset(),this.measurer.measure([new Mg("SomeUnusualText",e)]),e.clearSizes(),e.fontInfo.reset()}this.measurer.resultsIsInvalid||(this.unhideProcessID&&(clearInterval(this.unhideProcessID),this.unhideProcessID=null),this.invalidator.onChangedAllLayout())}),1e3)))}forceFormatPage(e){if(!this._isDocumentOpened)return;this.suspendUpdate();const t=this.formatPage(e);return this.continueUpdate(),t}formatSyncAllDocument(){for(this.suspendUpdate();this.mainFormatter.formatNext(););this.checkMeasureValid(),this.continueUpdate()}onPagesReady(){const e=this.changesManager.getMergedPageChanges();this.changesManager.reset(),this.onLayoutChangedDispatcher.listeners.forEach((t=>t.NotifyPagesReady(e))),this.layout.isFullyFormatted&&this.onLayoutChangedDispatcher.listeners.forEach((e=>e.NotifyFullyFormatted(this.layout.pages.length)))}formatPage(e){if(this.isUpdateLocked())throw new Error("isUpdateLocked(). You can't call formatNext");for(;e>=this.layout.validPageCount&&this.mainFormatter.formatNext(););return this.checkMeasureValid(),this.layout.pages[e]}stopFormatting(){this.formatterProcessID&&(clearTimeout(this.formatterProcessID),this.formatterProcessID=null)}}class Tj extends UV{constructor(e,t,r){super(e,t),this.selection=r}reduceChanges(){throw new Error(R.D.InternalException)}}class vj extends UV{constructor(e,t,r=[]){super(e,t),this.areaChanges=r}reduceChanges(){throw new Error(R.D.InternalException)}}class Mj{constructor(){this.oldItems=[],this.newItems=[],this.isChanged=!1}beforeRecreatePageSelection(){this.newItems=[],this.isChanged=this.oldItems.length>0}changesCollected(){this.isChanged&&(this.oldItems=this.newItems,this.newItems=[],this.isChanged=!1)}}class Ej{constructor(e,t){this.pageInfos=[],this.changes=[],this.layoutPageFlag=e,this.innerClientProperties=t}changesApplied(){this.changes=[]}reset(){this.pageInfos.splice(0),this.changes.splice(0)}needAtLeastPageIndex(e){for(;this.pageInfos.length<=e;)this.pageInfos.push(new Mj)}registerItem(e,t){this.needAtLeastPageIndex(e);const r=this.pageInfos[e];r.newItems.push(t),r.isChanged=!0}collectPageChanges(e){const t=e.pages;if(this.pageInfos.splice(t.length),this.innerClientProperties.viewsSettings.isSimpleView)this.pageInfos[0]&&this.pageInfos[0].changesCollected();else for(let e,r=0;e=this.pageInfos[r];r++){const i=t[r].flags;if(i.get(Wu.MustBeRendered)&&e.isChanged){const t=Math.max(e.oldItems.length,e.newItems.length),n=[];i.get(this.layoutPageFlag)||(e.oldItems=[]);for(let r=0;r<t;r++){const t=e.oldItems[r],i=e.newItems[r];if(!t){for(;r<e.newItems.length;r++)n.push(new Tj(r,wV.Inserted,e.newItems[r]));break}if(!i){for(let i=e.oldItems.length-1;i>=r;i--)n.push(new Tj(i,wV.Deleted,t));break}t.equals(i)||n.push(new Tj(r,wV.Replaced,i))}n.length&&this.changes.push(new vj(r,wV.Updated,n))}e.changesCollected()}}}class Dj{constructor(e,t,r){this.subDocumentInfo=null,this.pageIndex=-1,this.firstPageIndexWithSelection=0,this.lastPageIndexWithSelection=0,this.selectionInfo=new Ej(Wu.IsSelectionRendered,r),this.searchInfo=new Ej(Wu.IsSearchSelectionRendered,r),this.misspelledInfo=new Ej(Wu.IsMisspelledSelectionRendered,r),this.rangePermissionInfo=new Ej(Wu.IsRangePermissionsRendered,r),this.subDocumentInfo=e,this.pageIndex=t}updatePageIndexWithSelection(){this.firstPageIndexWithSelection=-1,this.lastPageIndexWithSelection=0;for(let e,t=0;e=this.selectionInfo.pageInfos[t];t++)e.oldItems.length&&(this.firstPageIndexWithSelection<0&&(this.firstPageIndexWithSelection=t),this.lastPageIndexWithSelection=t)}}!function(e){e[e.Simple=0]="Simple",e[e.PrintLayout=1]="PrintLayout"}(kV||(kV={}));class Fj{constructor(){this.topPageBorderWidth=1,this.bottomPageBorderWidth=1,this.topMargin=15,this.bottomMargin=15}get betweenPageSpacing(){return this.topPageBorderWidth+this.bottomPageBorderWidth+Math.max(this.topMargin,this.bottomMargin)}init(e){this.topPageBorderWidth=fn.DomUtils.pxToFloat(e.borderTopWidth),this.bottomPageBorderWidth=fn.DomUtils.pxToFloat(e.borderBottomWidth),this.topMargin=fn.DomUtils.pxToFloat(e.marginTop),this.bottomMargin=fn.DomUtils.pxToFloat(e.marginBottom)}clone(){const e=new Fj;return e.copyFrom(this),e}copyFrom(e){e&&(this.topPageBorderWidth=e.topPageBorderWidth,this.bottomPageBorderWidth=e.bottomPageBorderWidth,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin)}equals(e){return this.topMargin==e.topMargin&&this.bottomMargin==e.bottomMargin&&this.topPageBorderWidth==e.topPageBorderWidth&&this.bottomPageBorderWidth==e.bottomPageBorderWidth}}class Rj{get isFixedWidthMode(){return void 0!==this.fixedWidth&&null!==this.fixedWidth}set widthOfPage(e){this._widthOfPage=e}get widthOfPage(){return Math.max(50,this.isFixedWidthMode?this.fixedWidth:this._widthOfPage)}get widthOfContent(){return Math.max(50,this.widthOfPage-this.paddings.horizontal)}get isSimpleView(){return this.viewType==kV.Simple}get isPrintLayoutView(){return this.viewType==kV.PrintLayout}constructor(){this.viewType=kV.PrintLayout,this.paddings=new jc.m(15,15,15,15),this.pageVerticalInfo=new Fj,this.showHorizontalRuler=!0}copyFrom(e){this.paddings=new jc.m(e.paddings.left,e.paddings.right,e.paddings.top,e.paddings.bottom),this.viewType=e.viewType,this._widthOfPage=e._widthOfPage,this.fixedWidth=e.fixedWidth,this.showHorizontalRuler=e.showHorizontalRuler,this.pageVerticalInfo.copyFrom(e.pageVerticalInfo)}}class Lj{constructor(e){this.showHiddenSymbols=!1,this.showTableGridLines=!1,this.viewsSettings=new Rj,this.viewsSettings.copyFrom(e)}}class Bj{constructor(e){this.spellChecker=e}modelChanged(e){switch(e.type){case pd.InlinePictureInserted:case pd.AnchoredPictureInserted:case pd.ParagraphInserted:case pd.AnchoredTextBoxInserted:this.spellChecker.onModelIntervalChanged(e.position,1,!0);break;case pd.SimpleRunInserted:this.spellChecker.onModelIntervalChanged(e.position,e.length,1==e.length&&an.isWhitespace.test(e.text));break;case pd.AnchorObjectRemoved:break;case pd.IntervalRemoved:this.spellChecker.onModelIntervalChanged(e.interval.start,-e.interval.length,!1);break;case pd.ParagraphMerged:this.spellChecker.onModelIntervalChanged(e.position,-1,!1)}}}class Aj{constructor(e){this.spellChecker=e}NotifyPagesReady(e){this.spellChecker.onLayoutChanged()}NotifyFullyFormatted(e){}}var Nj=__webpack_require__(1695);class kj{get subDocument(){return this.control.selection.activeSubDocument}constructor(e){this.control=e}revise(){const e=this.control.selection.lastSelectedInterval.start,t=this.control.selection.activeSubDocument.getText(new on.FixedInterval(e-1,1));if(this.isTriggerChar(t)){const r=Xh.getWordStartPositionByCharCondition(this.control.selection.activeSubDocument,e-1,(e=>this.isSeparator(e))),i=(this.includeTriggerChar(t)?e:e-1)-r,n=new on.FixedInterval(r,i),o=this.control.selection.activeSubDocument.getText(n);let a=null;this.includeTriggerChar(t)||(a=this.control.selection.getFloatingState());const s=this.reviseCore(o,n);return a&&(s?this.control.selection.restoreFloatingState(a):a.finalize()),s}return!1}isSeparator(e){return!an.isAlphanumeric.test(e)}isTriggerChar(e){return this.isSeparator(e)}includeTriggerChar(e){return!1}}class Oj extends kj{reviseCore(e,t){this.control.modelManager.history.beginTransaction();const r=this.control.clientSideEvents.raiseAutoCorrect(e,t);return this.control.modelManager.history.endTransaction(),r}isTriggerChar(e){return!0}includeTriggerChar(e){return!0}}class _j extends kj{reviseCore(e,t){if(e.length>2&&e[0]===e[0].toUpperCase()&&e[1]===e[1].toUpperCase()){for(let t=2;t<e.length;t++)if(e[t]!==e[t].toLowerCase()||e[t]==e[t].toUpperCase())return!1;const r=e.substring(0,1)+e[1].toLowerCase()+e.slice(2);return this.control.modelManager.history.beginTransaction(),this.control.modelManager.modelManipulator.range.removeInterval(new gu(this.control.selection.activeSubDocument,t),!1,!1),this.control.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(this.control.selection.activeSubDocument,t.start),(new ju).setIntervals(tp.fromPosition(this.control.selection.activeSubDocument,t.start)).charPropsBundle,cs.TextRun,r)),this.control.modelManager.history.endTransaction(),!0}return!1}}class Uj extends kj{constructor(){super(...arguments),this.numberingRegEx=/^[0-9]+[\.\)]$/}reviseCore(e,t){const r=this.control.selection.activeSubDocument,i=t.end,n=r.getParagraphIndexByPosition(i),o=r.paragraphs[n];if(o.isInList())return!1;const a=o.startLogPosition.value;if(a!==t.start)return!1;const s=this.getTargetNumberingListType(e);if(void 0===s)return!1;if(this.control.modelManager.history.beginTransaction(),this.control.modelManager.modelManipulator.range.removeInterval(new gu(r,on.FixedInterval.fromPositions(a,i+1)),!1,!1),this.control.selection.changeState((e=>e.setPosition(a))),s===tn.Bullet)this.control.commandManager.getCommand(FF.ToggleBulletedListItem).execute(this.control.commandManager.isPublicApiCall);else{const t=parseInt(e.slice(0,-1));this.control.commandManager.getCommand(FF.ToggleNumberingListItem).execute(this.control.commandManager.isPublicApiCall,t);const r=this.control.modelManager.model.numberingLists.length-1,i=e[e.length-1];for(var l=0,d=this.control.modelManager.model.numberingLists[r].levels.length;l<d;l++)this.control.modelManager.history.addAndRedo(new eD(this.control.modelManager.modelManipulator,!1,r,l,`{${l}}${i}`))}return this.control.modelManager.history.endTransaction(),!0}isSeparator(e){return an.isWhitespace.test(e)}isTriggerChar(e){return e.charCodeAt(0)!=KU.VD.Enter&&an.isWhitespace.test(e)}getTargetNumberingListType(e){return 1===e.length&&0===e.indexOf("*")?tn.Bullet:this.numberingRegEx.test(e)?tn.Simple:void 0}}class Hj extends kj{constructor(){super(...arguments),this.urlRegex=/^(?:[a-z][\w-]+:(?:\/{1,3}([^./]*:[^./]*@){0,1})|www\d{0,3}[.]|ftp[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?=((?:[^\s()<>]+|\([^\s<>]*\))+(?:\([^\s<>]*\)|[^\s`!()\[\]{};:'"".,<>?«»“”‘’])))\2$/i,this.emailRegex=/^(mailto:)?[-\w!#$%&'*+/=?^_`{|}~]+(?:\.[-\w!#$%&'*+/=?^_`{|}~]+)*@(?:\w+([-\w]*\w)\.)[\w]+$/,this.localRegex=/^(([a-zA-Z][:][\\])|(\\\\))(((?![<>:"\\|?*]).)+((?![ .])\\)?)*$/}reviseCore(e,t){if(this.urlRegex.test(e)||this.emailRegex.test(e)||this.localRegex.test(e)){this.control.modelManager.history.beginTransaction(),this.control.modelManager.history.addAndRedo(new TU(this.control.modelManager.modelManipulator,this.control.selection,this.control.selection.getState(),this.control.selection.getState().setIntervals([t])));const r=this.control.commandManager.getCommand(FF.ShowHyperlinkForm),i=new vU(this.control).setIntervalsInfo(tp.fromInterval(this.subDocument,t)),n=r.getState(i),o=r.createParameters(i),a=o.clone();o.text=e,o.url=this.createNavigateUri(e);const s=r.applyParameters(new HU(n.enabled,t),o,a);return this.control.modelManager.history.endTransaction(),s}return!1}createNavigateUri(e){return-1==e.indexOf(":")&&e.indexOf("@")>0?"mailto:"+e:0==e.indexOf("www")?"http://"+e:0==e.indexOf("\\")?"file://"+e.replace(/\\/g,"\\\\"):e}isSeparator(e){return an.isWhitespace.test(e)}}class Vj extends kj{constructor(e,t){super(e),this.replaceInfoCollection=[],this.caseSensitiveReplacement=t.caseSensitiveReplacement,t.replaceInfoCollection.sort(((e,t)=>this.compare(e.replace,t.replace))),this.initReplaceInfo(t.replaceInfoCollection)}compare(e,t){return this.caseSensitiveReplacement||(e=e.toLocaleLowerCase(),t=t.toLocaleLowerCase()),e===t?0:e<t?-1:1}performReplace(e,t){const r=(0,yd.Ev)(t),i=this.control.inputPosition.charPropsBundle;this.control.modelManager.modelManipulator.range.removeInterval(new gu(this.subDocument,e),!0,!1);let n=e.start;for(let e=0;e<r.length;e++){if(n=this.control.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(this.subDocument,n),i,cs.TextRun,r[e])).insertedInterval.end,r[e+1]){n=this.control.modelManager.modelManipulator.paragraph.insertParagraphViaHistory(new Ag(new pu(this.subDocument,n),i)).end}}return n}}class Wj extends Vj{initReplaceInfo(e){f.ListUtils.forEach(e,(e=>{an.isAlphanumeric.test(e.replace)&&this.replaceInfoCollection.push(e)}))}reviseCore(e,t){const r=C.SearchUtils.binaryIndexOf(this.replaceInfoCollection,(t=>this.compare(t.replace,e)));if(r>=0){this.control.modelManager.history.beginTransaction(),EU.addSelectionBefore(this.control);const e=this.performReplace(t,this.replaceInfoCollection[r].with);return EU.addSelectionAfter(this.control,e+1),this.control.modelManager.history.endTransaction(),!0}return!1}}class zj extends Vj{initReplaceInfo(e){f.ListUtils.forEach(e,(e=>{const t=e.replace[e.replace.length-1];!an.isAlphanumeric.test(e.replace)&&an.isAlphanumeric.test(t)&&this.replaceInfoCollection.push(e)}))}reviseCore(e,t){for(let r of this.replaceInfoCollection)if(this.isEndOf(r.replace,e)){const i=r.replace.length-e.length,n=t.start-i;if(n>=0){const e=new on.FixedInterval(n,t.end-n),i=this.control.selection.activeSubDocument.getText(e);if(this.isEndOf(r.replace,i)){this.control.modelManager.history.beginTransaction();const t=this.performReplace(e,r.with);return this.control.modelManager.history.addAndRedo(new TU(this.control.modelManager.modelManipulator,this.control.selection,this.control.selection.getState(),this.control.selection.getState().setPosition(t))),this.control.modelManager.history.endTransaction(),!0}}}return!1}isEndOf(e,t){return 0==this.compare(e.substr(-1*t.length,t.length),t)}}class jj extends zj{initReplaceInfo(e){this.triggeredChar=[],f.ListUtils.forEach(e,(e=>{const t=e.replace[e.replace.length-1];an.isAlphanumeric.test(t)||(this.triggeredChar.push(t),this.replaceInfoCollection.push(e))}))}isTriggerChar(e){return f.ListUtils.unsafeAnyOf(this.triggeredChar,(t=>t==e))}includeTriggerChar(e){return!0}}class Xj{constructor(e,t){this.control=e,this.settings=t,this.providers=[],this.registerDefaultProviders()}registerDefaultProviders(){this.providers.push(new Oj(this.control)),this.settings.replaceTextAsYouType&&(this.providers.push(new Wj(this.control,this.settings)),this.providers.push(new zj(this.control,this.settings)),this.providers.push(new jj(this.control,this.settings))),this.settings.correctTwoInitialCapitals&&this.providers.push(new _j(this.control)),this.settings.enableAutomaticNumbering&&this.providers.push(new Uj(this.control)),this.settings.detectUrls&&this.providers.push(new Hj(this.control))}performAutoCorrect(){if(this.control.selection.isCollapsed())for(let e of this.providers)if(e.revise())return void this.control.inputController.inputEditor.clearInputElement()}}const Gj={TOP_LEVEL_SERVICE_CONTAINER:"dxre-servicecontainer",SERVICE_CONTAINER:"dxrePageService",SELECTION_CONTAINER:"dxreSelection",SEARCH_SELECTION_CONTAINER:"dxreSearchSelection",MISSPELLED_SELECTION_CONTAINER:"dxreMisspelledSelection",RANGE_PERMISSIONS_CONTAINER:"dxreRangePermissions",MAIN_PAGE_AREA_CONTAINER:"dxreMainPa",OTHER_PAGE_AREA_CONTAINER:"dxreOtherPa",FLOATING_OBJECTS_CONTAINER:"dxreFloatingPic",SHAPE_BG_CONTAINER:"dxreShapeBgContainer",PAGES:"dxrePages",PAGE_AREA:"dxrePageArea",TEXT_BOX_BG:"dxreTextBoxBg",ROWS_CONTAINER:"dxreRows",PARAGRAPHFRAMES_CONTAINER:"dxreParFrames",TABLES_CONTAINER:"dxreTables",TABLE_ELEMENTS_CONTAINER:"dxreTable",TABLE_BORDERS_CONTAINER:"dxreTableBrds",TABLE_ROW_BACKGROUND_CONTAINER:"dxreTableRowBgds",TABLE_CELL_BACKGROUND_CONTAINER:"dxreTableCellBgds",TABLE_CURSORS_CONTAINER:"dxreTableCursors",ANCHORED_PICTURE:"dxreAncPic",SIMPLE_VIEW:"dxreSimpleView",PAGE:"dxrePage",SIMPLE_PAGE_FLOW_MODE:"dxreSimplePage",COLUMN:"dxreColumn",ROW:"dxreRow",BLACKOUT:"dxreBlackout",TABLE_CELL_BG:"dxreTableCellBg",TABLE_ROW_BG:"dxreTableRowBg",PARAGRAPH_FRAME:"dxreParFrame",BOX_BG:"dxreBoxBg",FIELD_BG:"dxreFieldBg",FIELD_BOX_LEVEL1:"dxreFieldBoxLevel1",FIELD_BOX_LEVEL2:"dxreFieldBoxLevel2",FIELD_BOX_LEVEL3:"dxreFieldBoxLevel3",BOX_SPACE:"dxreBoxSpace",BOX:"dxreBox",HIDDEN_BOX:"dxreHiddenBox",PICTURE:"dxrePic",START_BOOKMARK:"dxreStartBookmark",END_BOOKMARK:"dxreEndBookmark",TABLE_BORDER:"dxreTableBrd",SELECTION_RANGE_PERMISSION:"dxreSelRangePerm",SELECTION_MISSPELLED:"dxreSelMisspelled",SELECTION_SEARCH:"dxreSelSearch",SELECTION_ROW:"dxreSelRow",SELECTION_CURSOR:"dxreSelCursor",SELECTION_FLOATING_OBJECTS:"dxreSelFloatingObjects",ANCHOR:"dxreAnchor",TABLE_ROW_CURSOR:"dxreTableRowCursor",TABLE_BORDER_LINE:"dxreTableBorderLine",DRAG_CARET:"dxreDragCaret",HEADER_INFO:"dxreHeaderInfo",FOOTER_INFO:"dxreFooterInfo",FULL_TABLE_SELECTOR:"dxreTblSelector",AUTO_SCROLL:"dxreAutoScroll",AUTO_SCROLL_CURSOR:"dxreAutoScrollCursor",AUTO_SCROLL_CURSOR_N:"dxreAutoScrollCursorN",AUTO_SCROLL_CURSOR_NS:"dxreAutoScrollCursorNS",AUTO_SCROLL_CURSOR_S:"dxreAutoScrollCursorS",FLOATING_OBJECT_TEXT_BOX_AREA:"dxreTextBoxArea",TABLE_COLUMN_CURSOR:"dxreTableColumnCursor",SELECTED_TEXTBOX:"dxreSelectedTextBox",CURSOR_NO_BLINK_CLASS_NAME:"dxreSelNoblink"};var Kj;!function(e){e[e.TextBoxBg=0]="TextBoxBg",e[e.TblRowBg=1]="TblRowBg",e[e.TblCellBg=2]="TblCellBg",e[e.ParBg=3]="ParBg",e[e.BoxBg=4]="BoxBg",e[e.FieldBg=5]="FieldBg",e[e.SelRange=6]="SelRange",e[e.BoxSpace=7]="BoxSpace",e[e.SelSearch=8]="SelSearch",e[e.SelRow=9]="SelRow",e[e.Box=10]="Box",e[e.Bookmark=11]="Bookmark",e[e.TableBorder=12]="TableBorder",e[e.SelMissp=13]="SelMissp",e[e.SelCursor=14]="SelCursor",e[e.SelTouchBar=15]="SelTouchBar",e[e.TblCursor=16]="TblCursor",e[e.AnchoredPicture=17]="AnchoredPicture",e[e.TextBox=18]="TextBox"}(Kj||(Kj={}));class qj{static getClassName(e,t){return`dxre${qj.names[t]}ZL${e}`}}qj.names={[Kj.TextBoxBg]:"TextBoxBg",[Kj.TblRowBg]:"TblRowBg",[Kj.TblCellBg]:"TblCellBg",[Kj.ParBg]:"ParBg",[Kj.BoxBg]:"BoxBg",[Kj.FieldBg]:"FieldBg",[Kj.SelRange]:"SelRange",[Kj.BoxSpace]:"BoxSpace",[Kj.SelSearch]:"SelSearch",[Kj.SelRow]:"SelRow",[Kj.Box]:"Box",[Kj.Bookmark]:"Bookmark",[Kj.TableBorder]:"TableBorder",[Kj.SelMissp]:"SelMissp",[Kj.SelCursor]:"SelCursor",[Kj.SelTouchBar]:"SelTouchBar",[Kj.TblCursor]:"TblCursor",[Kj.AnchoredPicture]:"AnchoredPicture",[Kj.TextBox]:"TextBox"};class $j{static buildHyperlinkTipString(e,t,r){return e||(e=""),r.createHyperlinkTooltip(e,`\nCtrl + ${t}`).replace(/['|"]/g,"&quot;")}}class Jj{constructor(e,t){this.size=new so.Size(0,0),this.isSizeObserving=!1,this.sizeUpdated=!1,this.resizeFrameId=null,this.canvasManager=e,this.control=t,this.resizeObserver=new ResizeObserver((()=>{this.sizeUpdated=!1,this.resizeFrameId=requestAnimationFrame((()=>{this.sizeUpdated||this.changeSize(!1),this.sizeUpdated=!0,this.resizeFrameId=null}))}))}dispose(){this.resizeFrameId&&cancelAnimationFrame(this.resizeFrameId),this.resizeFrameId=null,this.resizeObserver.disconnect()}changeSize(e){const t=new so.Size(this.canvasManager.getCanvasWidth(),this.canvasManager.controlHeightProvider.getVisibleAreaHeight(!1));!e&&t.equals(this.size)||(this.size=t,this.changeSizeCore())}setViewMode(e){e?(this.changeSize(!0),this.isSizeObserving||(this.resizeObserver.observe(this.canvasManager.canvas),this.isSizeObserving=!0)):(this.isSizeObserving&&(this.resizeObserver.unobserve(this.canvasManager.canvas),this.isSizeObserving=!1),this.changeSizeCore()),this.sizeUpdated=!0}changeSizeCore(){f.ListUtils.forEach(this.control.viewManager.cache,(e=>this.control.viewManager.renderer.removePage(1)),1),this.control.viewManager.ensureFirstPageIsRendered(),this.control.innerClientProperties.viewsSettings.widthOfPage=this.canvasManager.getCanvasWidth(),this.control.layoutFormatterManager&&(this.control.layoutFormatterManager.invalidator.onChangedAllLayout(),this.control.selection.scrollManager.setScroll((new xD).byModelPosition(this.control.selection).setModelPosition(this.control.selection.lastSelectedInterval.start).useStdRelativePosition().useStdOffset())),this.control.owner.adjustControl(),this.control.horizontalRulerControl.update()}}class Yj{get cache(){return this.viewManager.cache}constructor(e){this.viewManager=e,this.viewManager.innerClientProperties.viewsSettings.isSimpleView&&fn.DomUtils.addClassName(this.viewManager.canvas,Gj.SIMPLE_VIEW)}onViewTypeChanged(){switch(this.viewManager.innerClientProperties.viewsSettings.viewType){case kV.Simple:fn.DomUtils.addClassName(this.viewManager.canvas,Gj.SIMPLE_VIEW);break;case kV.PrintLayout:fn.DomUtils.removeClassName(this.viewManager.canvas,Gj.SIMPLE_VIEW)}}applyPageChange(e,t){O.print(L.DocumentRenderer,"applyPageChanges",`pageIndex ${t.index}`);const r=this.cache[t.index];for(let i of t.mainPageAreaChanges)this.applyMainPageAreaChange(r,e,i);for(let i of t.otherPageAreaChanges)this.applyOtherPageAreaChange(r,e,i);for(let i of t.anchoredPictureChanges)this.applyAnchorPictureChange(r,e,i)}applyAnchorPictureChange(e,t,r){const i=r.index;switch(r.changeType){case wV.Deleted:Yj.removeFromContainerByObject(i,Yj.getAnchoredObjectsContainer(e.page),e.anchoredPicture);break;case wV.Replaced:{const r=t.anchoredObjectHolder.getObjById(i);Yj.replaceFromContainerByObject(i,Yj.getAnchoredObjectsContainer(e.page),e.anchoredPicture,this.renderFloatingPicture(r,t.renderLevelCalculator));break}case wV.Updated:break;case wV.Inserted:{const r=t.anchoredObjectHolder.getObjById(i);Yj.insertToContainerByObject(i,Yj.getAnchoredObjectsContainer(e.page),e.anchoredPicture,this.renderFloatingPicture(r,t.renderLevelCalculator));break}default:throw new Error(R.D.InternalException)}}applyMainPageAreaChange(e,t,r){switch(r.changeType){case wV.Deleted:Yj.removeFromContainerByIndex(e.page,r.canvasIndex,Yj.getMainPageAreaContainerCore);break;case wV.Replaced:Yj.replaceInContainer(e.page,r.canvasIndex,this.renderPageArea(t.renderLevelCalculator,e,t.mainSubDocumentPageAreas[r.layoutIndex],null),Yj.getMainPageAreaContainerCore);break;case wV.Updated:{const i=t.mainSubDocumentPageAreas[r.layoutIndex],n=Yj.getMainPageAreaContainerCore(e.page).childNodes[r.canvasIndex];for(let e of r.columnChanges)this.applyColumnChange(n,i,e,t.renderLevelCalculator.renderMainPageAreaLevel);break}default:throw new Error(R.D.InternalException)}}applyOtherPageAreaChange(e,t,r){const i=r.index,n=t.otherPageAreas[i];switch(r.changeType){case wV.Deleted:Yj.removeFromContainerByObject(i,Yj.getOtherPageAreaContainerCore(e.page),e.otherAreas),Yj.removeFromContainerByObject(i,Yj.getTextBoxBackgroundContainer(e.page),e.textBoxBgElements);break;case wV.Replaced:Yj.replaceFromContainerByObject(i,Yj.getOtherPageAreaContainerCore(e.page),e.otherAreas,this.renderPageArea(t.renderLevelCalculator,e,n,n.subDocument.isTextBox()?t.anchoredObjectHolder.getTextBoxByInternalSubDocId(i):null));break;case wV.Updated:{const o=e.otherAreas[i],a=n.subDocument.isTextBox()?t.renderLevelCalculator.getRenderLevel(t.anchoredObjectHolder.getTextBoxByInternalSubDocId(i).rendererLevel):t.renderLevelCalculator.renderHeaderFooterPageAreasLevel;for(let e of r.columnChanges)this.applyColumnChange(o,n,e,a);break}case wV.Inserted:Yj.insertToContainerByObject(i,Yj.getOtherPageAreaContainerCore(e.page),e.otherAreas,this.renderPageArea(t.renderLevelCalculator,e,n,n.subDocument.isTextBox()?t.anchoredObjectHolder.getTextBoxByInternalSubDocId(i):null));break;default:throw new Error(R.D.InternalException)}}applyColumnChange(e,t,r,i){switch(r.changeType){case wV.Deleted:Yj.removeFromContainerByIndex(e,r.canvasIndex,Yj.getColumnsContainerCore);break;case wV.Replaced:{const n=this.renderColumn(t.columns[r.layoutIndex],i,t.subDocument.isMain());Yj.replaceInContainer(e,r.canvasIndex,n,Yj.getColumnsContainerCore);break}case wV.Updated:{const s=t.columns[r.layoutIndex],l=Yj.getColumnsContainerCore(e).childNodes[r.canvasIndex];for(var n of r.rowChanges)Yj.applyChange(l,n,Yj.getRowsContainerCore,(()=>this.renderRow(s.rows[n.layoutIndex],i)));for(var o of r.tableChanges)Yj.applyChange(l,o,Yj.getTablesContainerCore,(()=>Yj.renderTable(s.tablesInfo[o.layoutIndex],i,this.viewManager.innerClientProperties.showTableGridLines)));for(var a of r.paragraphFrameChanges)Yj.applyChange(l,a,Yj.getParagraphFramesContainerCore,(()=>Yj.renderParagraphFrame(s.paragraphFrames[a.layoutIndex],i)));break}case wV.Inserted:{const n=this.renderColumn(t.columns[r.layoutIndex],i,t.subDocument.isMain());Yj.insertInContainer(e,r.canvasIndex,n,Yj.getColumnsContainerCore);break}default:throw new Error(R.D.InternalException)}}static applyChange(e,t,r,i){switch(t.changeType){case wV.Deleted:Yj.removeFromContainerByIndex(e,t.canvasIndex,r);break;case wV.Replaced:Yj.replaceInContainer(e,t.canvasIndex,i(),r);break;case wV.Inserted:Yj.insertInContainer(e,t.canvasIndex,i(),r);break;case wV.Updated:break;default:throw new Error(R.D.InternalException)}}getPageRender(e,t){const r=this.cache[e].page;return Yj.isPageElementConsiderAllContainers(r)||this.renderPageContent(t,e),this.cache[e].page}renderPage(e,t,r){e.flags.set(Wu.IsSelectionRendered,!1),e.flags.set(Wu.IsMisspelledSelectionRendered,!1),e.flags.set(Wu.IsRangePermissionsRendered,!1);let i=this.cache[t];if(i){const r=i.page;this.updatePageClasses(r),this.updatePageSize(e,r),Yj.updatePageColor(r,this.viewManager.layout.pageColor),Yj.isPageElementEmpty(r)||this.removePageContent(t)}else{const r=Yj.renderContainer("");r.appendChild(Yj.renderContainer(Gj.SERVICE_CONTAINER)),Yj.updatePageColor(r,this.viewManager.layout.pageColor),this.updatePageClasses(r),this.updatePageSize(e,r),Yj.insertInContainer(this.viewManager.pagesContainer,t,r,(e=>e)),this.cache.splice(t,0,new Qj(r))}r&&this.renderPageContent(e,t)}removePage(e){const t=this.cache[e];t&&(t.page.parentNode.removeChild(t.page),this.cache.splice(e,1))}updatePageSize(e,t){t.offsetHeight==e.height&&t.offsetWidth==e.width||fn.DomUtils.setStyleSize(t.style,e)}updatePageClasses(e){e.className=Gj.PAGE,this.viewManager.innerClientProperties.viewsSettings.isSimpleView&&!this.viewManager.innerClientProperties.viewsSettings.isFixedWidthMode&&fn.DomUtils.addClassName(e,Gj.SIMPLE_PAGE_FLOW_MODE)}removePageContent(e){const t=this.cache[e];t&&t.removeContent()}renderPageContainers(e){e.page.appendChild(Yj.renderContainer(Gj.SELECTION_CONTAINER)),e.page.appendChild(Yj.renderContainer(Gj.SEARCH_SELECTION_CONTAINER)),e.page.appendChild(Yj.renderContainer(Gj.MISSPELLED_SELECTION_CONTAINER)),e.page.appendChild(Yj.renderContainer(Gj.RANGE_PERMISSIONS_CONTAINER));const t=[e.page.appendChild(Yj.renderContainer(Gj.MAIN_PAGE_AREA_CONTAINER)),e.page.appendChild(Yj.renderContainer(Gj.OTHER_PAGE_AREA_CONTAINER)),e.page.appendChild(Yj.renderContainer(Gj.FLOATING_OBJECTS_CONTAINER))];return e.page.appendChild(Yj.renderContainer(Gj.SHAPE_BG_CONTAINER)),t}renderPageContent(e,t){const r=this.cache[t],[i,n,o]=this.renderPageContainers(r);f.ListUtils.forEach(e.mainSubDocumentPageAreas,(t=>i.appendChild(this.renderPageArea(e.renderLevelCalculator,r,t,null)))),this.viewManager.innerClientProperties.viewsSettings.isSimpleView||b.j.forEach(e.otherPageAreas,((t,i)=>{t.subDocument.isTextBox()||Yj.insertToContainerByObject(i,n,r.otherAreas,this.renderPageArea(e.renderLevelCalculator,r,t,null))}));for(let t of this.renderPageContentGetFloatingObjects(e))switch(t.getType()){case lc.AnchorTextBox:const i=t.internalSubDocId;Yj.insertToContainerByObject(i,n,r.otherAreas,this.renderPageArea(e.renderLevelCalculator,r,e.otherPageAreas[i],t));break;case lc.AnchorPicture:Yj.insertToContainerByObject(t.objectId,o,r.anchoredPicture,this.renderFloatingPicture(t,e.renderLevelCalculator))}}static updatePageColor(e,t){const r=w.i.colorToHash(t);e.style.backgroundColor!=r&&(e.style.backgroundColor=y.isEmptyBgColor(t)?"":r)}static getPageAreaClassname(e){switch(e.subDocument.info.getType()){case yo.Main:case yo.Header:case yo.Footer:return Gj.PAGE_AREA;case yo.TextBox:return`${Gj.PAGE_AREA} ${Gj.FLOATING_OBJECT_TEXT_BOX_AREA}`}throw new Error(R.D.InternalException)}renderPageArea(e,t,r,i,n=!0){const o=Yj.renderContainer(Yj.getPageAreaClassname(r));let a;switch(r.subDocument.isTextBox()&&(o.style.overflow="hidden"),fn.DomUtils.setStyleSizeAndPosition(o.style,r),r.subDocument.info.getType()){case yo.TextBox:a=e.getRenderLevel(i.rendererLevel);break;case yo.Footer:case yo.Header:a=e.renderHeaderFooterPageAreasLevel;break;case yo.Main:a=e.renderMainPageAreaLevel;break;default:throw new Error(R.D.NotImplemented)}if(r.subDocument.isTextBox()){const e=Yj.renderContainer(Gj.TEXT_BOX_BG+" "+qj.getClassName(a,Kj.TextBoxBg)),n=t.textBoxBgElements[r.subDocument.id];n&&fn.DomUtils.hideNode(n),t.textBoxBgElements[r.subDocument.id]=e,Yj.setShapePropertiesToElement(e,i.shape,!0),fn.DomUtils.setStyleSize(e.style,r),fn.DomUtils.setStylePosition(e.style,i.getExtendedBounds()),Yj.setRotationInRadians(e,i.rotationInRadians),Yj.getTextBoxBackgroundContainer(t.page).appendChild(e),fn.DomUtils.setStylePosition(o.style,r),Yj.setRotationInRadians(o,i.rotationInRadians)&&fn.DomUtils.addClassName(o,qj.getClassName(a,Kj.TextBox))}else{const e=y.isEmptyBgColor(this.viewManager.layout.pageColor)?w.i.LIGHT_COLOR:this.viewManager.layout.pageColor;Yj.updatePageColor(o,e)}if(n)for(let e of r.columns)o.appendChild(this.renderColumn(e,a,r.subDocument.isMain()));return o}renderColumn(e,t,r){const i=Yj.renderContainer(Gj.COLUMN);fn.DomUtils.setStyleSizeAndPosition(i.style,e);const n=i.appendChild(Yj.renderContainer(Gj.ROWS_CONTAINER)),o=i.appendChild(Yj.renderContainer(Gj.PARAGRAPHFRAMES_CONTAINER)),a=i.appendChild(Yj.renderContainer(Gj.TABLES_CONTAINER));for(let r of e.rows)n.appendChild(this.renderRow(r,t));for(let r of e.paragraphFrames)o.appendChild(Yj.renderParagraphFrame(r,t));for(let r of e.tablesInfo)a.appendChild(Yj.renderTable(r,t,this.viewManager.innerClientProperties.showTableGridLines));return i}renderRow(e,t){const r=e.getLastBoxIndexWhatCanStrikeoutAndUnderline(),i=Yj.renderContainer(Gj.ROW);if(i.innerHTML="",e.numberingListBox){let n=this.renderBox(e,e.numberingListBox.textBox,0>r,t).html;if("string"==typeof n?i.innerHTML+=n:i.appendChild(n),e.numberingListBox.separatorBox){let n=this.renderBox(e,e.numberingListBox.separatorBox,0>r,t).html;"string"==typeof n?i.innerHTML+=n:i.appendChild(n)}}let n=!1;for(let o,a=0;o=e.boxes[a];a++){if(o.getType()==lc.AnchorTextBox||o.getType()==lc.AnchorPicture)continue;const s=this.renderBox(e,o,a>r,t),l=s.html;"string"==typeof l?i.innerHTML+=l:i.appendChild(l),n=n||s.increaseRowHeight}for(let r of e.bookmarkBoxes)i.appendChild(Yj.renderBookmark(r,t));return fn.DomUtils.setStyleSizeAndPosition(i.style,new Va.Rectangle(e.x,e.y+e.getSpacingBefore(),e.width,e.height-e.getSpacingBefore()+(n?1:0))),i}renderBox(e,t,r,i){let n=t.renderGetContent(this),o=t.getTop(e);const a=t.x;if(t.characterProperties.script===ne.Subscript){const e=t.characterProperties.fontInfo.scriptMultiplier;o+=g.u.pointsToPixelsF(t.characterProperties.fontSize)*(t.characterProperties.fontInfo.subScriptOffset*e-e+1)}const s=t.height>e.height&&o>=0?3*P.MathUtils.round(t.height-e.height)/4:0;let l=[];l.push("left: "+P.MathUtils.round(a,3)+"px"),l.push("top: "+P.MathUtils.round(o-s,3)+"px");const d=P.MathUtils.round(t.height,3);l.push("height: "+d+"px"),(yH.Browser.MacOSPlatform||yH.Browser.MacOSMobilePlatform)&&l.push("line-height: "+d+"px"),t.characterProperties.smallCaps&&l.push("font-variant: small-caps");const c=t.renderGetCharacterProperties(),h=c.initProps,u=c.colorInfo,p=u.underlineColor,m=u.strikeoutColor,f=u.textColor,b=!(r||h.fontUnderlineType==le.None||t.getType()==lc.Space&&h.underlineWordsOnly),C=!(r||h.fontStrikeoutType==se.None||t.getType()==lc.Space&&h.strikeoutWordsOnly),S=C&&b||C&&m!=y.AUTOMATIC_COLOR||b&&p!=y.AUTOMATIC_COLOR;let I;if(S){I=Nn.getCssRules(h,f,t.renderIsWordBox(),S,!0),l=l.concat(Nn.getSizeSignificantRules(h)),l.push(Nn.getForeColorRule(f));const e=m!=y.AUTOMATIC_COLOR||p!=y.AUTOMATIC_COLOR;if(e&&(!C||m!=y.AUTOMATIC_COLOR)){const e=document.createElement("span");e.style.cssText=I.join(";")+";color: "+y.getCssString(f,!0),"string"==typeof n?e.innerHTML=n:e.appendChild(n),n=e}if(C){const t=e?"color: "+y.getCssString(m==y.AUTOMATIC_COLOR?f:m,!0):"",r=document.createElement("span");r.style.cssText=I.join(";")+";text-decoration: line-through;"+t,"string"==typeof n?r.innerHTML=n:r.appendChild(n),n=r}if(b){const t=e?"color: "+y.getCssString(p==y.AUTOMATIC_COLOR?f:p,!0):"",r=document.createElement("span");r.style.cssText=I.join(";")+";text-decoration: underline;"+t,"string"==typeof n?r.innerHTML=n:r.appendChild(n),n=r}}else l=l.concat(Nn.getCssRules(h,f,t.renderIsWordBox(),r,!0));let x="";switch(t.getType()){case lc.Text:case lc.LayoutDependent:case lc.FieldCodeEnd:case lc.FieldCodeStart:case lc.ColumnBreak:case lc.LineBreak:case lc.PageBreak:case lc.ParagraphMark:case lc.SectionMark:x=Gj.BOX+" "+qj.getClassName(i,Kj.Box);break;default:x=Gj.BOX_SPACE+" "+qj.getClassName(i,Kj.BoxSpace)}h.hidden&&this.viewManager.innerClientProperties.showHiddenSymbols&&(x+=" "+Gj.HIDDEN_BOX);const T=new DocumentFragment,v=document.createElement("span");v.style.cssText=l.join(";"),v.setAttribute("class",x),"string"==typeof n?v.innerHTML=n:n&&v.appendChild(n),T.appendChild(v);const M=u.foregroundColor;if(t.fieldLevel&&(M==y.AUTOMATIC_COLOR||M==y.NO_COLOR)){let e=Gj.FIELD_BG+" "+qj.getClassName(i,Kj.FieldBg);switch(t.fieldLevel){case 1:e+=" "+Gj.FIELD_BOX_LEVEL1;break;case 2:e+=" "+Gj.FIELD_BOX_LEVEL2;break;default:e+=" "+Gj.FIELD_BOX_LEVEL3}const r=document.createElement("span");r.setAttribute("class",e),r.style.cssText="top: "+P.MathUtils.round(o,3)+"px; left: "+P.MathUtils.round(a,3)+"px; width: "+P.MathUtils.round(t.width,3)+"px; height: "+P.MathUtils.round(t.height,3)+"px",T.appendChild(r)}if(w.i.getAlpha(M)>0&&!r){const r=e.height-e.getSpacingAfter(),n="top: 0px; left: "+Math.floor(t.x)+"px; width: "+Math.ceil(t.width)+"px; height: "+P.MathUtils.round(r,3)+"px; background: "+y.getCssStringInternal(M)+";",o=document.createElement("span");o.setAttribute("class",Gj.BOX_BG+" "+qj.getClassName(i,Kj.BoxBg)),o.style.cssText=n,T.appendChild(o)}if(t.hyperlinkTip){const e=$j.buildHyperlinkTipString(t.hyperlinkTip,this.viewManager.stringResources.commonLabels.clickToFollowHyperlink,this.viewManager.fieldOptions);if(e){const t=document.createElement("span");t.setAttribute("title",e),T.replaceChild(t,v),t.appendChild(v)}}return new Zj(T,h.hidden)}static renderBookmark(e,t){const r=(e.boxType==EV.StartBox?Gj.START_BOOKMARK:Gj.END_BOOKMARK)+" "+qj.getClassName(t,Kj.Bookmark),i=document.createElement("div");return i.setAttribute("class",r),i.style.cssText=`width: ${P.MathUtils.round(e.width,3)}px; height: ${P.MathUtils.round(e.height,3)}px; left: ${P.MathUtils.round(e.x,3)}px; top: ${P.MathUtils.round(e.y,3)}px; border-color: ${e.color}`,i}renderPicture(e){return this.renderPictureBoxContent(e.createSize(),e.cacheInfo,e.hyperlinkTip,e.description)}renderFloatingPicture(e,t){const r=Yj.renderContainer(Gj.ANCHORED_PICTURE+" "+qj.getClassName(t.getRenderLevel(e.rendererLevel),Kj.AnchoredPicture));fn.DomUtils.setStyleSize(r.style,e),fn.DomUtils.setStylePosition(r.style,new Xc.Point(e.x-e.shape.outlineWidth,e.y-e.shape.outlineWidth)),Yj.setShapePropertiesToElement(r,e.shape,!1),Yj.setRotationInRadians(r,e.rotationInRadians);const i=e.renderGetContent(this);return r.innerHTML="","string"==typeof i?r.innerHTML=i:r.appendChild(i),r}static setShapePropertiesToElement(e,t,r){e.style.backgroundColor=y.getCssStringInternal(t.fillColor),e.style.borderStyle=Yj.borderTypeToString(de.Single),e.style.borderColor=y.getCssString(t.outlineColor,!1),e.style.borderWidth=Math.max(r?1:0,t.outlineWidth).toString()+"px",e.style.boxSizing="content-box"}static setRotationInRadians(e,t){const r=0!=t;return e.style.transform=r?"rotate("+t+"rad)":"none",r}static renderParagraphFrame(e,t){const r=Yj.renderContainer(Gj.PARAGRAPH_FRAME+" "+qj.getClassName(t,Kj.ParBg));return Yj.updateParagraphFrame(e,r),r}static updateParagraphFrame(e,t){fn.DomUtils.setStyleSizeAndPosition(t.style,e),t.style.background=y.getCssStringInternal(e.paragraphColor)}static renderTable(e,t,r){const i=e.x,n=e.y,o=e.logicInfo.backgroundColor,a=Yj.renderContainer(Gj.TABLE_ELEMENTS_CONTAINER);fn.DomUtils.setStylePosition(a.style,e);const s=a.appendChild(Yj.renderContainer(Gj.TABLE_BORDERS_CONTAINER)),l=a.appendChild(Yj.renderContainer(Gj.TABLE_ROW_BACKGROUND_CONTAINER)),d=a.appendChild(Yj.renderContainer(Gj.TABLE_CELL_BACKGROUND_CONTAINER)),c=Yj.renderContainer(Gj.TABLE_CURSORS_CONTAINER);c.style.width=e.width+"px",c.style.height=e.height+"px",a.appendChild(c),c.dxTableIndex=e.logicInfo.grid.table.index;for(let i,n=0;i=e.horizontalBorders[n];n++)Yj.renderHorizontalBorder(s,i,t,r);for(let i,n=0;i=e.verticalBorders[n];n++)Yj.renderVerticalBorder(s,i,t,r);if(e.logicInfo.isEditable){for(let r of e.verticalCursorBorders){let e=Yj.renderContainer(Gj.TABLE_COLUMN_CURSOR+" "+qj.getClassName(t,Kj.TblCursor));fn.DomUtils.setStylePosition(e.style,new Xc.Point(r.xPos,r.yPos)),e.style.height=r.length+"px",c.appendChild(e)}for(let r of e.horizontalCursorBorders){let e=Yj.renderContainer(Gj.TABLE_ROW_CURSOR+" "+qj.getClassName(t,Kj.TblCursor));fn.DomUtils.setStylePosition(e.style,new Xc.Point(r.xPos,r.yPos)),e.style.width=r.length+"px",e.dxLayoutRowIndex=r.layoutRowIndex,c.appendChild(e)}}for(let r of e.tableRows){Yj.renderTableBackgroundElement(Gj.TABLE_ROW_BG+" "+qj.getClassName(t,Kj.TblRowBg),l,r,i,n,o);for(let e of r.backgroundInfos)Yj.renderTableBackgroundElement(Gj.TABLE_CELL_BG+" "+qj.getClassName(t,Kj.TblCellBg),d,e,0,0,e.color)}return a}static renderTableBackgroundElement(e,t,r,i,n,o){if(y.isEmptyBgColor(o))return;const a=Yj.renderContainer(e);fn.DomUtils.setStylePosition(a.style,new Xc.Point(r.x-i,r.y-n)),fn.DomUtils.setStyleSize(a.style,r),a.style.backgroundColor=w.i.colorToHash(o),t.appendChild(a)}static renderVerticalBorder(e,t,r,i){const n=t.borderInfo;if(Yj.isNotRenderTableBorder(n)){if(i){const i=Yj.createBorderElement(w.i.LIGHT_COLOR,r);fn.DomUtils.setStyleSizeAndPosition(i.style,new Va.Rectangle(t.xPos,t.yPos,0,t.length)),i.style.borderStyle="None",i.style.borderRightWidth=Yj.getTableGridLineBorderWidth(),i.style.borderRightStyle="dashed",e.appendChild(i)}}else{const i=Yj.createBorderElement(n.color,r);fn.DomUtils.setStyleSizeAndPosition(i.style,new Va.Rectangle(t.xPos,t.yPos,0,t.length)),i.style.backgroundColor="",i.style.borderStyle="None",i.style.borderRightColor=w.i.colorToHash(n.color),i.style.borderRightWidth=Yj.getBorderTypeWidth(n),i.style.borderRightStyle=Yj.borderTypeToString(n.style),e.appendChild(i)}}static getTableGridLineBorderWidth(){const e=window.devicePixelRatio;return yH.Browser.Chrome&&e>1&&e<1.5?"1.5px":"1px"}static renderHorizontalBorder(e,t,r,i){const n=t.borderInfo;if(Yj.isNotRenderTableBorder(n)){if(!i)return;const n=Yj.createBorderElement(w.i.LIGHT_COLOR,r);fn.DomUtils.setStyleSizeAndPosition(n.style,new Va.Rectangle(t.xPos,t.yPos,t.length,0)),n.style.borderStyle="None",n.style.borderBottomWidth=Yj.getTableGridLineBorderWidth(),n.style.borderBottomStyle="dashed",e.appendChild(n)}else{const i=Yj.createBorderElement(n.color,r);fn.DomUtils.setStyleSizeAndPosition(i.style,new Va.Rectangle(t.xPos,t.yPos,t.length,0)),i.style.backgroundColor="",i.style.borderStyle="None",i.style.borderBottomColor=w.i.colorToHash(n.color),i.style.borderBottomWidth=Yj.getBorderTypeWidth(n),i.style.borderBottomStyle=Yj.borderTypeToString(n.style),e.appendChild(i)}}static createBorderElement(e,t){const r=Yj.renderContainer(Gj.TABLE_BORDER+" "+qj.getClassName(t,Kj.TableBorder));return r.style.backgroundColor=w.i.colorToHash(e),r}static isNotRenderTableBorder(e){return!e||e.style==de.None||e.style==de.Nil}static borderTypeToString(e){const t=Yj.mapBorderTypeToString[e];return t||"solid"}static getBorderTypeWidth(e){const t=this.getBorderTypeMinWidth(e.style);return Math.max(t,e.width)+"px"}static getBorderTypeMinWidth(e){return e==de.Double?3:1}static getServiceContainerCore(e){return e.firstChild}static getSelectionContainerCore(e){return e.childNodes[1]}static getSearchSelectionContainerCore(e){return e.childNodes[2]}static getMisspelledSelectionContainerCore(e){return e.childNodes[3]}static getRangePermissionsContainerCore(e){return e.childNodes[4]}static isPageElementConsiderAllContainers(e){return e.childNodes.length>1}static getMainPageAreaContainerCore(e){return e.childNodes[5]}static getOtherPageAreaContainerCore(e){return e.childNodes[6]}static getAnchoredObjectsContainer(e){return e.childNodes[7]}static getTextBoxBackgroundContainer(e){return e.childNodes[8]}static getRowsContainerCore(e){return e.firstChild}static getParagraphFramesContainerCore(e){return yH.Browser.Chrome?e.firstChild.nextSibling:e.childNodes[1]}static getTablesContainerCore(e){return e.lastChild}static getColumnsContainerCore(e){return e}static renderContainer(e){const t=document.createElement("DIV");return t.className=e,t}static removeFromContainerByIndex(e,t,r){const i=r(e),n=i.childNodes[t];n&&i.removeChild(n)}static replaceInContainer(e,t,r,i){const n=i(e);n.replaceChild(r,n.childNodes[t])}static insertInContainer(e,t,r,i){const n=i(e);t<n.childNodes.length?n.insertBefore(r,n.childNodes[t]):n.appendChild(r)}static removeFromContainerByObject(e,t,r){const i=r[e];i&&(t.removeChild(i),delete r[e])}static replaceFromContainerByObject(e,t,r,i){t.replaceChild(i,r[e]),r[e]=i}static insertToContainerByObject(e,t,r,i){r[e]=i,t.appendChild(i)}static isPageElementEmpty(e){return 0==e.childNodes.length}renderPictureBoxContent(e,t,r,i){const n=r?$j.buildHyperlinkTipString(r,this.viewManager.stringResources.commonLabels.clickToFollowHyperlink,this.viewManager.fieldOptions):"",o=document.createElement("img");return o.setAttribute("src",t.base64),n&&o.setAttribute("title",n),(0,S.isDefined)(i)&&!rn.StringUtils.isNullOrEmpty(i)&&(o.alt=i),o.style.cssText=`height: ${P.MathUtils.round(e.height,3)}px; width: ${P.MathUtils.round(e.width,3)}px; vertical-align: baseline`,o.setAttribute("class",Gj.PICTURE),o}}Yj.mapBorderTypeToString=(new Eu).add(de.Single,"solid").add(de.Dotted,"dotted").add(de.Dashed,"dashed").add(de.Double,"double").add(de.DashSmallGap,"dashed").add(de.DotDash,"dashed").add(de.DotDotDash,"dashed").get();class Qj{constructor(e){this.page=e,this.init()}removeContent(){const e=Yj.getServiceContainerCore(this.page);fn.DomUtils.clearInnerHtml(this.page),this.page.appendChild(e),this.init()}init(){this.otherAreas={},this.anchoredPicture={},this.textBoxBgElements={}}}class Zj{constructor(e,t){this.html=e,this.increaseRowHeight=t}toString(){if("string"==typeof this.html)return this.html;{const e=[];if(this.html){const t=this.html.children.length;for(let r=0;r<t;r++)e.push(this.html.children.item(r).outerHTML)}return e.join("")}}}var eX,tX=__webpack_require__(3714),rX=__webpack_require__(6136),iX=__webpack_require__(499);class nX{constructor(e,t,r){this.mouseWheelEvent=!1,this.control=e,this.boxVisualizerManager=r,this.defaultState=new t(this),this.switchToDefaultState()}dispose(){this.state.dispose()}switchToDefaultState(){this.switchState(this.defaultState)}switchState(e){this.state&&this.state.finish(),this.state=e,this.state.start()}getHyperlinkFieldResult(e){const t=this.control.selection.activeSubDocument,r=this.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,t);if(r.exactlyDetailLevel==Hu.None)return null;const i=r.floatingObject?this.control.layout.anchorObjectsPositionInfo.getPosition(r.floatingObject.objectId):r.getPosition(),n=Ed.getRelativeVisabilityInfo(i,t.fields),o=f.ListUtils.reverseElementBy(n,(e=>e.showResult&&e.field.getResultInterval().containsWithIntervalEnd(i)&&e.field.isHyperlinkField()));return o?o.field:null}}class oX{constructor(){this.isAnyGroupSet=!1}applyMask(e){return this.isAnyGroupSet?e!=this.ignoredGroupMask&&(this.ignoredGroupMask=eX.NoOne,!!this.mask.get(eX.DiffersFromAll)||(this.mask.set(e,!0),!(!this.prevMask||this.prevMask.getValue()==this.mask.getValue())||(this.prevMask=this.mask.clone(),!1))):(this.isAnyGroupSet=!0,this.whileNoOneGroupSet(e),!1)}}class aX extends oX{constructor(e){super(),this.initGroup=e?eX.Space:eX.NoOne}whileNoOneGroupSet(e){e!=eX.DiffersFromAll?(this.ignoredGroupMask=e,this.prevMask=new pr.Flag(this.initGroup),this.mask=new pr.Flag(this.initGroup)):this.mask=new pr.Flag(e)}}class sX extends oX{whileNoOneGroupSet(e){e==eX.Space?(this.ignoredGroupMask=eX.Space,this.mask=new pr.Flag(eX.NoOne),this.prevMask=null):(this.mask=new pr.Flag(e),this.prevMask=this.mask.clone())}}class lX{constructor(e,t,r,i,n){if(this.isInitOk=!0,this.isFirstCallNextSymbol=!0,e.validPageCount<1)return this.startResultPosition=-1,void(this.isInitOk=!1);this.boxIterator=t.isMain()?new rm(t,e,i,n):new im(t,e,i,n,r.pageIndex)}isSet(){return!!this.isInitOk&&(!!this.boxIterator.isInitialized()||(this.startResultPosition=-1,!1))}currSymbolStartPosition(){return this.boxIterator.position.getLogPosition(Hu.Box)+this.charOffset}getNextSymbolGroup(){return!!this.getNextSymbol()&&(this.groupMask=this.getGroupMask(),!0)}getNextSymbol(){return this.isFirstCallNextSymbol?(this.isFirstCallNextSymbol=!1,!!this.moveIterator()&&(this.charOffset=this.boxIterator.position.charOffset,this.needExcessMoveBoxIterator()&&this.moveIterator(),!0)):!!this.nextCallsSetCharOffset()||!!this.moveIterator()&&(this.setCharacterOffsetOnNextCalls(),!0)}getGroupMask(){switch(this.boxIterator.position.box.getType()){case lc.Text:return this.getTextGroupMask();case lc.Space:return eX.Space;case lc.Dash:return eX.PunctuationMark;case lc.Picture:case lc.ParagraphMark:case lc.PageBreak:case lc.ColumnBreak:case lc.SectionMark:case lc.TabSpace:case lc.LineBreak:case lc.NumberingList:case lc.FieldCodeStart:case lc.FieldCodeEnd:case lc.LayoutDependent:case lc.AnchorPicture:case lc.AnchorTextBox:default:return eX.DiffersFromAll}}getTextGroupMask(){switch(this.boxIterator.position.box.renderGetContent(null)[this.charOffset]){case an.specialCharacters.QmSpace:case an.specialCharacters.EmSpace:case an.specialCharacters.EnSpace:case an.specialCharacters.NonBreakingSpace:return eX.Space;case an.specialCharacters.LeftSingleQuote:return eX.LeftSingleQuote;case an.specialCharacters.LeftDoubleQuote:return eX.LeftDoubleQuote;case an.specialCharacters.RightDoubleQuote:return eX.RightDoubleQuote;case'"':return eX.DoubleQuote;case"(":case")":case"«":case"»":case"<":case">":case"/":case"№":case"%":case"!":case":":case"?":case";":case"|":case"+":case",":case".":case"*":case"=":case"\\":return eX.PunctuationMark;default:return eX.Others}}}class dX extends lX{constructor(e,t,r,i){const n=t.isMain()?e.getLastValidPage().getEndPosition():e.pages[r.pageIndex].otherPageAreas[t.id].getEndPosition();super(e,t,r,i,n),i>=n&&(this.isInitOk=!1,this.startResultPosition=n)}moveIterator(){return this.boxIterator.moveNext((new cg).setDefault(!1),(new cg).setDefault(!1))}nextCallsSetCharOffset(){return this.charOffset++,this.charOffset<this.boxIterator.position.box.getLength()}setCharacterOffsetOnNextCalls(){this.charOffset=this.boxIterator.position.charOffset}needExcessMoveBoxIterator(){return!1}}class cX extends lX{constructor(e,t,r,i){const n=e.pages[0].getPosition();if(super(e,t,r,n,i),i<=n)return this.startResultPosition=0,void(this.isInitOk=!1);const o=t.isMain()?e.getLastValidPage().getEndPosition():e.pages[r.pageIndex].otherPageAreas[t.id].getEndPosition();i>=o&&(this.startResultPosition=o,this.isInitOk=!1)}moveIterator(){return this.boxIterator.movePrev((new cg).setDefault(!1),(new cg).setDefault(!1))}nextCallsSetCharOffset(){return this.charOffset--,this.charOffset>=0}setCharacterOffsetOnNextCalls(){this.charOffset=this.boxIterator.position.box.getLength()-1}needExcessMoveBoxIterator(){return 0!=this.boxIterator.position.charOffset}}!function(e){e[e.NoOne=0]="NoOne",e[e.Space=1]="Space",e[e.LeftSingleQuote=2]="LeftSingleQuote",e[e.RightSingleQuote=4]="RightSingleQuote",e[e.LeftDoubleQuote=8]="LeftDoubleQuote",e[e.RightDoubleQuote=16]="RightDoubleQuote",e[e.DoubleQuote=32]="DoubleQuote",e[e.PunctuationMark=64]="PunctuationMark",e[e.DiffersFromAll=128]="DiffersFromAll",e[e.Others=256]="Others"}(eX||(eX={}));class hX{constructor(e){this.prevSymbolStartPos=-1,this.groupSeparator=e}static getLayoutWordStartBound(e,t,r,i){return(new pX).getBound(new cX(e,t,r,i))}static getLayoutWordEndBound(e,t,r,i,n){return new uX(n).getBound(new dX(e,t,r,i))}getBound(e){if(this.iterator=e,!this.iterator.isSet())return this.iterator.startResultPosition;for(;this.iterator.getNextSymbolGroup();){if(this.groupSeparator.applyMask(this.iterator.groupMask))return this.getFinalPosition(!0);this.prevSymbolStartPos=this.iterator.currSymbolStartPosition()}return this.getFinalPosition(!1)}}class uX extends hX{constructor(e){super(new aX(e))}getFinalPosition(e){return this.prevSymbolStartPos+(e?1:0)}}class pX extends hX{constructor(){super(new sX)}getFinalPosition(e){return this.iterator.currSymbolStartPosition()+1}}class gX extends EU{getState(){let e=new UU(this.isEnabled());return e.visible=this.selection.tableInfo.extendedData.numRows>0,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}addSelection(e,t,r,i=wD.StandartScrollPosition){r?this.selection.deprecatedSetSelection(e,t,!1,-1,!0,!0,!1,i):(this.selection.changeState((r=>{r.addInterval(on.FixedInterval.fromPositions(Math.min(e,t),Math.max(e,t))).resetKeepX().setEndOfLine(!1),r.forwardDirection=t>=e})),i!==wD.DontChangeScrollPosition&&this.selection.scrollManager.setScroll((new xD).byModelPosition(this.selection).setModelPosition(t).useStdRelativePosition().useStdOffset()))}isEnabledInReadOnlyMode(){return!0}}class mX extends gX{executeCore(e,t){const r=this.selection.tableInfo;let i=!0;return r.extendedData.foreach((()=>{}),(e=>{const t=e.cell.startParagraphPosition.value,r=e.cell.endParagrapPosition.value;this.addSelection(t,r,i),i=!1})),!0}}class fX extends mX{addSelection(e,t,r){this.selection.changeState((r=>r.addInterval(on.FixedInterval.fromPositions(e,t)).resetKeepX().setEndOfLine(!1)))}}class bX extends gX{DEPRECATEDConvertOptionsParameter(e){if(e)return e;const t=[],r=this.selection.tableInfo,i=r.table,n={};return r.extendedData.foreach((()=>{}),((e,i)=>{const o=r.gridInfoManager.tableCellInfos[i.rowIndex][e.cellIndex].getGridCellIndex();for(let r=0;r<e.cell.columnSpan;r++){let e=o+r;n[e]||(t.push(e),n[e]=!0)}})),{table:i,columnIndices:t}}executeCore(e,t){let r=t.param.table,i=t.param.columnIndices,n=!0,o=null;for(let e,t=0;void 0!==(e=i[t]);t++)for(let t,i=0;t=r.rows[i];i++){let r=oc.getCellIndexByColumnIndex(t,e),i=t.cells[r];if(i&&o!==i){let e=i.startParagraphPosition.value,t=i.endParagrapPosition.value;this.addSelection(e,t,n,wD.DontChangeScrollPosition),n=!1}o=i}return!0}}class CX extends bX{addSelection(e,t,r){this.selection.changeState((r=>r.addInterval(on.FixedInterval.fromPositions(e,t)).resetKeepX().setEndOfLine(!1)))}}class SX extends vU{constructor(e,t,r,i){super(e),t?(this.forwardDirection=i,this.rows=f.ListUtils.map(r,(e=>t.rows[e]))):(this.forwardDirection=e.selection.forwardDirection,this.rows=f.ListUtils.map(e.selection.tableInfo.extendedData.rows,(e=>e.row)))}}class IX extends gX{executeCore(e,t){t.isSetManually||(t=new SX(this.control,null,[],!1));for(let e,r=0;e=t.rows[r];r++)this.addSelection(t.forwardDirection?e.getStartPosition():e.getEndPosition(),t.forwardDirection?e.getEndPosition():e.getStartPosition(),0===r);return!0}}class PX extends IX{addSelection(e,t,r){this.selection.changeState((r=>r.addInterval(on.FixedInterval.fromPositions(e,t)).resetKeepX().setEndOfLine(!1)))}}class wX extends gX{executeCore(e){let t=Ja.getTableByPosition(this.selection.activeSubDocument.tables,this.selection.intervals[0].start,!0);if(!(0,S.isDefined)(t))return!1;let r=t.getFirstCell().startParagraphPosition.value,i=t.getLastCell().endParagrapPosition.value;return this.addSelection(r,i,!0),!0}}class yX extends wX{addSelection(e,t,r){this.selection.changeState((r=>r.addInterval(on.FixedInterval.fromPositions(e,t)).resetKeepX().setEndOfLine(!1)))}}class xX extends gX{executeCore(e,t){const r=t.param;let i=r.firstCell.startParagraphPosition.value<=r.lastCell.startParagraphPosition.value;if(r.lastCell.parentRow.parentTable!==r.firstCell.parentRow.parentTable)throw new Error("cells should be from the same table");let n=r.firstCell.parentRow.parentTable,o=oc.getStartColumnIndex(r.firstCell),a=oc.getStartColumnIndex(r.lastCell),s=Math.min(o,a),l=Math.max(o+r.firstCell.columnSpan-1,a+r.lastCell.columnSpan-1),d=C.SearchUtils.normedInterpolationIndexOf(n.rows,(e=>e.getStartPosition()),r.firstCell.startParagraphPosition.value),c=C.SearchUtils.normedInterpolationIndexOf(n.rows,(e=>e.getStartPosition()),r.lastCell.startParagraphPosition.value),h=Math.min(d,c),u=Math.max(d,c),p=!0;for(let e=h;e<=u;e++){let t=n.rows[e],o=Math.max(t.gridBefore,s);if(o>l)continue;let a=oc.getCellIndexByColumnIndex(t,o);for(;o<=l;){let e=t.cells[a];if(!e)break;this.addSelection(i?e.startParagraphPosition.value:e.endParagrapPosition.value,i?e.endParagrapPosition.value:e.startParagraphPosition.value,p&&!r.extendSelection),p=!1,o+=e.columnSpan,a++}}return!0}}class TX extends EU{getState(){const e=this.isEnabled();return new UU(e,!!e&&this.getValue())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.sections)&&Bb.isEnabled(this.control.modelManager.richOptions.control.headersFooters)&&this.control.innerClientProperties.viewsSettings.isPrintLayoutView&&this.selection.activeSubDocument.isHeaderFooter()}getValue(){return null}getSectionIndex(e){const t=this.control.layoutFormatterManager.forceFormatPage(e),r=t||this.control.layout.getLastValidPage();return r?Ch.getPageSectionIndex(r,this.control.modelManager.model.sections):0}static getObjectsCache(e,t){return e?t.modelManager.model.headers:t.modelManager.model.footers}static getSectionHeadersFooters(e,t){return e?t.headers:t.footers}}class vX{getPageIndex(e,t){let r=0;for(let i;(i=e.layoutFormatterManager.forceFormatPage(r))&&!f.ListUtils.elementBy(this.getPageAreas(i.getLayoutOtherPageAreasInfo()),(e=>e&&e.subDocument.id==t.id));r++);return P.MathUtils.restrictValue(r,0,e.selection.layout.pages.length-1)}}class MX extends vU{constructor(e,t,r){super(e),this.pageIndex=t,this.isHeader=r}}class EX extends EU{getState(){return new UU(this.isEnabled())}finishChanges(e,t,r){const i=this.selection;return!!this.setNewSelectionProps(i,this.control.modelManager.model,e,t)&&(r=this.validateSelectionPosition(t,r),i.changeState((i=>i.setPosition(r).resetKeepX().setEndOfLine(!1).setSubDocument(t).setPageIndex(e))),this.isNeedScrollAfter()&&i.scrollManager.setScroll((new xD).byModelPosition(i).setModelPosition(r).useStdRelativePosition().useStdOffset()),!0)}canSetSelectionBeforeRun(e){return!((e instanceof ah||e instanceof sh)&&e.anchorInfo.horizontalPositionType!=gc.Character)}validateSelectionPosition(e,t){const r=new jh(e,!0);r.setPosition(t);do{if(r.charOffset>0||this.canSetSelectionBeforeRun(r.run))break}while(r.moveToNextRun());return r.getAbsolutePosition()}invalidatePages(e,t){if(t.isHeaderFooter){const r=new dj(this.control.modelManager.model,this.control.layout,t.headerFooterType);r.initByPageIndex(e),this.control.layoutFormatterManager.invalidator.onPagesChanged(r.startPageIndex,r.endPageIndex)}else this.control.layoutFormatterManager.invalidator.onPagesChanged(e,e+1)}setNewSelectionProps(e,t,r,i){if(e.pageIndex==r&&i==e.activeSubDocument)return!1;if(i.isTextBox()&&(!e.specialRunInfo.isSelectedAnchorObject||e.specialRunInfo.getTextBoxInnerSubDocumentId()!=i.id)){const r=t.subDocuments[i.info.parentSubDocumentId],n=new jh(r,!0);n.setPosition(0);do{if(n.run.getType()==cs.AnchoredTextBoxRun&&n.run.subDocId==i.id)break}while(n.moveToNextRun());e.specialRunInfo.init(tp.fromInterval(r,new on.FixedInterval(n.getAbsolutePosition(),1)),this.modelManipulator.model)}return!0}isNeedScrollAfter(){return!1}isEnabledInReadOnlyMode(){return!0}}class DX extends EX{executeCore(e,t){const r=this.selection,i=r.pageIndex;if(i<0)return!1;this.invalidatePages(i,t.subDocument.info);let n=this.control.layoutFormatterManager.forceFormatPage(i);return n||(n=r.layout.getLastValidPage()),this.finishChanges(-1,this.control.modelManager.model.mainSubDocument,n?n.getPosition():0)}}class FX extends EX{executeCore(e,t){const r=t.pageIndex;if(r>=this.control.layout.pages.length)return!1;this.invalidatePages(r,this.selection.activeSubDocument.info);const i=this.control.layoutFormatterManager.forceFormatPage(r);if(!i)return!1;this.history.beginTransaction();const n=this.getNewSubDocument(i,t.isHeader);if(!n)return!1;const o=this.finishChanges(r,n,0);return this.history.endTransaction(),o}getNewSubDocument(e,t){const r=e.getLayoutOtherPageAreasInfo(),i=t?r.headerPageArea:r.footerPageArea;if(i)return i.subDocument;if(this.control.modelManager.model.isDocumentProtectionEnabled||this.control.readOnly==RF.Persistent)return null;const n=this.control.modelManager.model.sections,o=Ch.getPageSectionIndex(this.control.layoutFormatterManager.forceFormatPage(e.index),n),a=mh.getActualObjectType(n[o],e.flags.get(Wu.IsFirstPageOfSection),(0,S.isEven)(e.layoutPageIndex));return this.insertSubDocument(t,o,a)}insertSubDocument(e,t,r){const i=this.createHeaderFooter(e,t,r);return TX.getObjectsCache(e,this.control)[i].getSubDocument(this.control.modelManager.model)}createHeaderFooter(e,t,r){const i=this.control.modelManager.modelManipulator.header.getHeaderFooterManipulator(e).createObject(r);return this.changeHeaderFooterObjectIndex(e,t,r,i),i}changeHeaderFooterObjectIndex(e,t,r,i){this.history.addAndRedo(new(e?TC:vC)(this.modelManipulator,t,r,i,(e=>{this.control.selection.activeSubDocument.isHeaderFooter()&&-1==e&&this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(this.control.commandManager.isPublicApiCall)})))}isNeedScrollAfter(){return!0}isEnabled(){return super.isEnabled()&&this.control.innerClientProperties.viewsSettings.isPrintLayoutView}}class RX extends EX{executeCore(e,t){const r=t.param;let i;return i=this.selection.specialRunInfo.isTextBoxSelected()&&this.selection.specialRunInfo.getTextBoxInnerSubDocumentId()==r.id&&this.selection.pageIndex>=0?this.selection.pageIndex:r.info.getType()!=yo.Main?LX.MapTypeToPageIndexHelper[r.info.getType()].getPageIndex(this.control,r):this.selection.pageIndex,this.invalidatePages(i,this.selection.activeSubDocument.info),this.control.layoutFormatterManager.forceFormatPage(i)&&this.finishChanges(i,r,0)}isNeedScrollAfter(){return!0}}RX.MapTypeToPageIndexHelper=(new Eu).add(yo.Header,new class extends vX{getPageAreas(e){return[e.headerPageArea]}}).add(yo.Footer,new class extends vX{getPageAreas(e){return[e.footerPageArea]}}).add(yo.TextBox,new class extends vX{getPageAreas(e){return e.textBoxesPageAreas}}).get();class LX extends RX{isEnabled(){return super.isEnabled()&&this.control.innerClientProperties.viewsSettings.isPrintLayoutView}}class BX extends RX{getState(){if(!this.isEnabled())return new UU(!1);const e=this.selection.specialRunInfo;if(!e.isTextBoxSelected())return new UU(!1);const t=this.selection.activeSubDocument.getRunByPosition(e.getTextBoxPosition());return new UU(t.getType()==cs.AnchoredTextBoxRun,this.control.modelManager.model.subDocuments[t.subDocId])}executeCore(e,t){if(e.value instanceof uu)return super.executeCore(e,new MU(this.control,e.value));throw new Error(R.D.InternalException)}}var AX=__webpack_require__(5596);class NX extends Kp{constructor(e){super(Hu.None),this.subDocument=null,this.deviations={},this.subDocument=e}correctAsVisibleBox(){if(!this.box||this.box.isVisible())return;this.deviations[Hu.Box]=void 0,this.exactlyDetailLevel=Math.min(this.exactlyDetailLevel,Hu.Row);const e=this.row.getLastVisibleBoxIndex();this.boxIndex=Math.max(0,e),this.box=this.row.boxes[this.boxIndex],this.charOffset=e<0?0:this.box.getLength()}getPosition(){var e=0;return this.page&&this.subDocument.isMain()&&(e+=this.page.getPosition()),this.pageArea&&(e+=this.pageArea.pageOffset),this.column&&(e+=this.column.pageAreaOffset),this.row&&(e+=this.row.columnOffset),this.box&&(e+=this.box.rowOffset),this.charOffset>=0&&(e+=this.charOffset),e}}class kX{constructor(e,t){this.documentLayout=e,this.measurer=t,this.result=null,this.point=null}calculate(e,t,r,i=!1){return this.point=e,this.subDocument=r,this.excludeTextBoxesFromSubDocuments=i,this.result=new NX(r),this.result.detailsLevel=t,this.result.exactlyDetailLevel=Hu.None,e&&!e.isEmpty()&&this.calcPage(),this.result}calcPage(){const e=this.documentLayout.pages[this.point.pageIndex];this.result.pageIndex=this.point.pageIndex,this.result.page=e;const t=kX.getDeviation(this.point,new Va.Rectangle(0,0,e.width,e.height));this.result.deviations[Hu.Page]=t,t==Va.HitTestDeviation.None&&(this.result.exactlyDetailLevel=Hu.Page),this.calcFloatingObject(!1),this.result.detailsLevel>Hu.Page&&this.calcPageArea(this.point.x,this.point.y)}calcFloatingObject(e){var t,r;if(this.result.floatingObject)return;const i=this.result.page.anchoredObjectHolder.getObjectsForRenderer(this.documentLayout.anchorObjectsPositionInfo).reverse();for(let n,o=0;n=i[o];o++){const i=null!==(r=null===(t=this.subDocument)||void 0===t?void 0:t.isHeaderFooter())&&void 0!==r?r:b.j.anyOf(this.result.page.otherPageAreas,(e=>e.subDocument.id===n.belongsToSubDocId&&e.subDocument.isHeaderFooter())),o=this.documentLayout.pages[0].mainSubDocumentPageAreas[0].subDocument.documentModel.compatibilitySettings.compatibilityMode;if(e||n.anchorInfo.getLevelTypeForRendering(i,o)!=dc.BehindText){let e=0==n.rotationInRadians?this.point:(0,yd.xj)(this.point,-n.rotationInRadians,n.center);if(n.containsPoint(e))return void(this.result.floatingObject=n)}}}calcPageArea(e,t){const r=new Xc.Point(e,t);let i,n;if(this.subDocument){if(this.subDocument.isMain()){const e=this.result.page.mainSubDocumentPageAreas;n=kX.findNearest(t,e,(e=>e.y),(e=>e.bottom)),i=e[n]}else if(i=this.result.page.otherPageAreas[this.subDocument.id],n=0,!i)return}else{const e=f.ListUtils.shallowCopy(this.result.page.mainSubDocumentPageAreas);b.j.forEach(this.result.page.otherPageAreas,(t=>{t.subDocument.isHeaderFooter()&&e.push(t)}));const t=[];this.excludeTextBoxesFromSubDocuments||f.ListUtils.forEach(this.result.page.anchoredObjectHolder.getObjectsForRenderer(this.documentLayout.anchorObjectsPositionInfo).reverse(),(e=>{e.getType()==lc.AnchorTextBox&&t.push(this.result.page.otherPageAreas[e.internalSubDocId])})),f.ListUtils.addListOnTail(t,e),i=kX.hitTestRectangles(r,t)[0].obj,n=i.subDocument.isMain()?this.result.page.mainSubDocumentPageAreas.indexOf(i):0,this.result.subDocument=i.subDocument}this.result.pageArea=i,this.result.pageAreaIndex=n;const o=kX.getDeviation(r,i)|this.result.deviations[Hu.Page];this.result.deviations[Hu.PageArea]=o,o==Va.HitTestDeviation.None?this.result.exactlyDetailLevel=Hu.PageArea:this.calcFloatingObject(!0),this.result.detailsLevel>Hu.PageArea&&this.calcColumn(e-i.x,t-i.y)}calcColumn(e,t){let r=this.result.pageArea.columns,i=kX.findNearest(e,r,(e=>e.x),(e=>e.right)),n=r[i];this.result.columnIndex=i,this.result.column=n;const o=kX.getDeviation(new Xc.Point(e,t),n)|this.result.deviations[Hu.PageArea];this.result.deviations[Hu.Column]=o,o==Va.HitTestDeviation.None?this.result.exactlyDetailLevel=Hu.Column:this.calcFloatingObject(!0),this.result.detailsLevel>Hu.Column&&this.calcRow(e-n.x,t-n.y)}calcRow(e,t){const r=this.result.column.rows,i=this.getClosestTable(e,t);this.result.rowIndex=i?this.getLayoutRowIndexCaseInTable(e,t,i):Math.max(0,C.SearchUtils.normedInterpolationIndexOf(r,(e=>e.y),t));const n=r[this.result.rowIndex];this.result.row=n;const o=kX.getDeviation(new Xc.Point(e,t),n)|this.result.deviations[Hu.Column];this.result.deviations[Hu.Row]=o,o==Va.HitTestDeviation.None?this.result.exactlyDetailLevel=Hu.Row:this.calcFloatingObject(!0),this.result.detailsLevel>Hu.Row&&this.calcBox(e-n.x,t-n.y)}calcBox(e,t){const r=this.result.row.boxes,i=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(r,(e=>e.x),e)),n=r[i],o=n.x,a=o+n.width,s=this.result.row.baseLine-n.getAscent();let l=n.height+s;l>this.result.row.height&&(l=this.result.row.height),this.result.boxIndex=i,this.result.box=this.result.row.boxes[i];const d=kX.getDeviation(new Xc.Point(e,t),new Va.Rectangle(o,s,a-o,l-s))|this.result.deviations[Hu.Row];this.result.deviations[Hu.Box]=d,d==Va.HitTestDeviation.None?this.result.exactlyDetailLevel=Hu.Box:this.calcFloatingObject(!0),this.result.detailsLevel>Hu.Box&&this.calcCharacter(e-o,t-s)}calcCharacter(e,t){const r=this.result.deviations[Hu.Box];let i=-1;i=r&Va.HitTestDeviation.Left?0:r&Va.HitTestDeviation.Right?this.result.box.getLength():this.result.box.calculateCharOffsetByPointX(this.measurer,e),this.result.charOffset=i,this.result.deviations[Hu.Character]=r,r==Va.HitTestDeviation.None?this.result.exactlyDetailLevel=Hu.Character:this.calcFloatingObject(!0)}static getDeviation(e,t){return new Va.RectangleDeviation(t,e).calcDeviation().deviation.getValue()}static findNearest(e,t,r,i){let n=t[0],o=1;for(let a;(a=t[o])&&!(e-i(n)<=r(a)-e);o++)n=a;return o-1}getClosestTable(e,t){const r=this.result.column.tablesInfo;if(0==r.length)return null;const i=[],n=[],o=[],a=f.ListUtils.reverseElementBy(r,(r=>{const a=new Va.RectangleDeviation(r,new Xc.Point(e,t)).calcDeviation(),s=a.deviation;return s.getValue()==Va.HitTestDeviation.None||(s.get(Va.HitTestDeviation.Top)?i.push(a):s.get(Va.HitTestDeviation.Bottom)?n.push(a):o.push(a),!1)}));if(a)return a;const s=this.result.column.rows[0].tableCellInfo&&t<=r[0].y;if(i.length&&s)return kX.choiseClosestTable(i,!1);const l=f.ListUtils.last(this.result.column.rows).tableCellInfo&&t>=f.ListUtils.last(r).y;return n.length&&l?kX.choiseClosestTable(n,!0):o.length?kX.choiseClosestTable(o,!1):null}static choiseClosestTable(e,t){return f.ListUtils.forEach(e,(e=>e.calcAdditionalParams())),(t?f.ListUtils.max:f.ListUtils.min)(e,(e=>e.offsetToInside.y)).initRectangle}getLayoutRowIndexCaseInTable(e,t,r){let i;for(;i=this.getCell(e,t,r),!i.layoutRows.length;)r=i.internalTables[0];const n=new Xc.Point(e,t),o=new Va.RectangleDeviation(i,n).calcDeviation().deviation.getValue();this.result.deviations[Hu.TableCell]=o,o==Va.HitTestDeviation.None&&(this.result.exactlyDetailLevel=Hu.TableCell);const a=[],s=b.j.elementBy(i.internalTables,(e=>!!e.containsPoint(n)||(a.push(new Va.RectangleDeviation(e,n).calcDeviation().calcAdditionalParams()),!1)));if(s)return this.getLayoutRowIndexCaseInTable(e,t,s);const l=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(i.layoutRows,(e=>e.y),t)),d=i.layoutRows[l],c=f.ListUtils.min(a,(e=>e.offsetToInside.y));return!c||new Va.RectangleDeviation(d,new Xc.Point(e,t)).calcDeviation().calcAdditionalParams().offsetToInside.y<=c.offsetToInside.y?d.indexInColumn:this.getLayoutRowIndexCaseInTable(e,t,c.initRectangle)}static getCellInRow(e,t,r,i){const n=r.rowCells,o=n[Math.max(0,C.SearchUtils.normedInterpolationIndexOf(n,(e=>e.x),e))];return i||o.containsPoint(new Xc.Point(e,t))?o:null}getCell(e,t,r){const i=r.tableRows,n=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(i,(e=>e.y),t)),o=i[n],a=kX.getCellInRow(e,t,o,!0);if(a.containsPoint(new Xc.Point(e,t)))return a;const s=f.ListUtils.unsafeReverseAnyOf(i,(r=>kX.getCellInRow(e,t,r,!1)),n-1);return s||a}static isPointInTexBoxArea(e,t,r){let i=0==r?e:(0,yd.xj)(e,-r,t.center);return i.x>t.x+5&&i.x<t.x+t.width-5&&i.y>t.y+5&&i.y<t.y+t.height-5}static hitTestRectangles(e,t){const r=[],i=f.ListUtils.map(t,(t=>{const i=new Va.RectangleDeviation(t,e).calcDeviation().calcAdditionalParams();return i.deviation.getValue()==Va.HitTestDeviation.None&&r.push(new OX(t,i)),new OX(t,i)}));return r.length?r:[f.ListUtils.min(i,(e=>AX.Metrics.euclideanDistance(new Xc.Point(0,0),e.deviation.offsetToInside)))]}}class OX{constructor(e,t){this.obj=e,this.deviation=t}}class _X{constructor(e,t,r,i){let n,o;void 0===i?(n=0,o=e.validPageCount):(n=i,o=Math.min(i+1,e.validPageCount));for(let i;(i=e.pages[n])&&n<o;n++){const n=b.j.elementBy(i.anchoredObjectHolder.objects,(i=>e.anchorObjectsPositionInfo.getPosition(i.objectId)==t&&i.belongsToSubDocId===r));if(n)return this.page=i,void(this.obj=n)}}}class UX{constructor(e,t,r){this.rendererCache=e,this.stringResources=t,this.fieldOptions=r,this.initFrameElement()}initFrameElement(){this.baseFrame&&this.NotifyHide(),this.baseFrame=Yj.renderContainer(this.baseFrameClassName())}NotifyHide(){fn.DomUtils.hideNode(this.baseFrame)}NotifyShow(e,t,r,i,n,o){fn.DomUtils.setStyleSizeAndPosition(this.baseFrame.style,t),r&&(this.baseFrame.title=$j.buildHyperlinkTipString(r,this.stringResources.commonLabels.clickToFollowHyperlink,this.fieldOptions)),this.toggleClass(Yj.setRotationInRadians(this.baseFrame,o),UX.CLASSNAMES.IS_BOX_ROTATED),this.toggleClass(i,UX.CLASSNAMES.TEXTBOX_AREA),this.toggleClass(n,UX.CLASSNAMES.ANCHORED_OBJECT),Yj.getServiceContainerCore(this.rendererCache[e].page).appendChild(this.baseFrame)}toggleClass(e,t){e?fn.DomUtils.addClassName(this.baseFrame,t):fn.DomUtils.removeClassName(this.baseFrame,t)}}var HX,VX,WX;UX.CLASSNAMES={CONTAINER:"dxreResBox",CORNER_ELEM_PREFIX:"dxreResBoxCornerElem",CORNER_LINE_PREFIX:"dxreResBoxCornerLine",CORNER_TOUCH_POSTFIX:"Touch",ROTATION_BOX:"dxreResBoxRotation",ROTATION_LINE:"dxreResBoxRotationLine",ANCHORED_OBJECT:"dxreResBoxAnchored",TEXTBOX_AREA:"dxreResBoxTextBoxArea",IS_BOX_ROTATED:"dxreResBoxRotated"},function(e){e[e.Undefined=0]="Undefined",e[e.ResizeBox_NW=1]="ResizeBox_NW",e[e.ResizeBox_NE=2]="ResizeBox_NE",e[e.ResizeBox_SE=3]="ResizeBox_SE",e[e.ResizeBox_SW=4]="ResizeBox_SW",e[e.ResizeBox_N=5]="ResizeBox_N",e[e.ResizeBox_E=6]="ResizeBox_E",e[e.ResizeBox_S=7]="ResizeBox_S",e[e.ResizeBox_W=8]="ResizeBox_W"}(HX||(HX={}));class zX{constructor(e){this.onChanged=new Nb,this.control=e,this.reset()}closeDocument(){this.reset(),this.raiseHide()}reset(){this.pageIndex=-1,this.bounds=null,this.tip=null}hide(){this.reset(),this.raiseHide()}raiseShow(){this.onChanged.listeners.forEach((e=>e.NotifyShow(this.pageIndex,this.bounds,this.tip,this.isTextBox,this.isAnchoredObject,this.rotation)))}raiseHide(){this.onChanged.listeners.forEach((e=>e.NotifyHide()))}}class jX extends zX{NotifySelectionChanged(e){e.specialRunInfo.isSelected()?this.setBox():this.initBounds&&this.hide()}NotifyScrollPositionChanged(){}NotifyFullyFormatted(e){}NotifyPagesReady(e){const t=this.control.selection.specialRunInfo;if(!t.isSelected())return;const r=t.getParentSubDocument(),i=t.getPosition();r.isMain()?f.ListUtils.unsafeAnyOf(e,(e=>e.changeType==wV.Deleted?null:new _X(this.control.layout,i,r.id,e.index).obj||f.ListUtils.unsafeAnyOf(this.control.layout.pages[e.index].getContentIntervals(),(t=>t.contains(i)?e:null))))&&this.setBox():f.ListUtils.unsafeAnyOf(e,(e=>e.changeType==wV.Deleted?null:b.j.containsBy(this.control.layout.pages[e.index].otherPageAreas,(e=>e.subDocument.id==r.id))))&&this.setBox()}setBox(){const e=this.control.selection.specialRunInfo,t=e.getPosition();if(e.isSelectedAnchorObject){const r=e.getParentSubDocument(),i=new _X(this.control.layout,t,r.id,r.isHeaderFooter()?this.control.selection.pageIndex:void 0);return void(i.obj&&this.show(i.page.index,null,null,null,i.obj))}const r=this.control.selection.activeSubDocument,i=(r.isMain()?new ug(this.control.layout,r,t,Hu.Box):new pg(this.control.layout,r,t,this.control.selection.pageIndex,Hu.Box)).create((new cg).setDefault(!1),(new cg).setDefault(!1));i&&this.show(i.pageIndex,i.pageArea,i.column,i.row,i.box)}reset(){this.initBounds=null,super.reset()}show(e,t,r,i,n){this.pageIndex=e,this.tip=n.hyperlinkTip;const o=n.getType();if(this.isTextBox=o==lc.AnchorTextBox,this.isAnchoredObject=o==lc.AnchorPicture||o==lc.AnchorTextBox,this.initBounds=new Va.Rectangle(0,0,0,0),this.isAnchoredObject)this.initBounds.copyFrom(n),this.rotation=o==lc.AnchorTextBox&&this.control.selection.activeSubDocument.isTextBox()?0:n.rotationInRadians;else{const e=Math.max(0,i.baseLine-n.getAscent());this.initBounds.setPosition(new Xc.Point(t.x+r.x+i.x+n.x,t.y+r.y+i.y+e)).setSize(n),this.rotation=0}this.recalculate(null,null,null)}showAtPos(e,t){this.pageIndex=e,this.initBounds.x=t.x,this.initBounds.y=t.y,this.recalculate(null,null,null)}recalculate(e,t,r){this.bounds=null!=e?new Va.Rectangle(this.initBounds.x+t.width,this.initBounds.y+t.height,e.width,e.height):this.initBounds.createRectangle(),null!=r&&(this.rotation=r),this.raiseShow()}isResizeBoxVisible(){return!!this.bounds}shouldCapture(e){return!this.control.isReadOnlyPersistent&&!!jX.shouldCaptureEvents[e.source]}static shouldRotate(e,t){return t.readOnly!=RF.Persistent&&jX.isEventSourceHasClassName(e,UX.CLASSNAMES.ROTATION_BOX)&&t.selection.activeSubDocument.isEditable([new on.FixedInterval(t.selection.specialRunInfo.getPosition(),1)])}static shouldHandleTextBoxAreaClick(e){return jX.isEventSourceHasClassName(e,UX.CLASSNAMES.TEXTBOX_AREA)||jX.isEventSourceHasClassName(e,Gj.SELECTED_TEXTBOX)}static isEventSourceHasClassName(e,t){let r=tX.g.getEventSource(e.mouseEvent);for(;r;){if(r.className.indexOf(t)>-1)return!0;if(r.className.indexOf(Gj.PAGES)>-1)return!1;r=r.parentElement}return!1}}jX.shouldCaptureEvents={[HX.ResizeBox_E]:!0,[HX.ResizeBox_N]:!0,[HX.ResizeBox_NE]:!0,[HX.ResizeBox_NW]:!0,[HX.ResizeBox_S]:!0,[HX.ResizeBox_SE]:!0,[HX.ResizeBox_SW]:!0,[HX.ResizeBox_W]:!0};class XX{constructor(){this.endOfLine=!0,this.keepX=-1,this.correctIntervalDueToFields=!0,this.correctIntervalDueToTables=!0,this.useFieldUiChecks=!0}setInterval(e){return this._intervals=[e.clone()],this}resetKeepX(){return this.keepX=-1,this}setPosition(e){return this._intervals=[new on.FixedInterval(e,0)],this}setEndOfLine(e){return this.endOfLine=e,this}setKeepX(e){return this.keepX=e,this}setCorrectIntervalDueToFields(e){return this.correctIntervalDueToFields=e,this}setCorrectIntervalDueToTables(e){return this.correctIntervalDueToTables=e,this}setUseFieldUiChecks(e){return this.useFieldUiChecks=e,this}}class GX extends XX{get interval(){return this._intervals[0]}}class KX{isXDirection(){return!0}}class qX extends KX{init(e){return this.obj=e,this}get position(){return this.obj.x}set position(e){this.obj.x=e}get anotherPosition(){return this.obj.y}set anotherPosition(e){this.obj.y=e}}class $X extends KX{init(e){return this.obj=e,this}get length(){return this.obj.width}set length(e){this.obj.width=e}get anotherLength(){return this.obj.height}set anotherLength(e){this.obj.height=e}}class JX extends qX{init(e){return this.obj=e,this}get length(){return this.obj.width}set length(e){this.obj.width=e}get anotherLength(){return this.obj.height}set anotherLength(e){this.obj.height=e}}class YX{isXDirection(){return!1}}class QX extends YX{init(e){return this.obj=e,this}get position(){return this.obj.y}set position(e){this.obj.y=e}get anotherPosition(){return this.obj.x}set anotherPosition(e){this.obj.x=e}}class ZX extends YX{init(e){return this.obj=e,this}get length(){return this.obj.height}set length(e){this.obj.height=e}get anotherLength(){return this.obj.width}set anotherLength(e){this.obj.width=e}}class eG extends QX{init(e){return this.obj=e,this}get length(){return this.obj.height}set length(e){this.obj.height=e}get anotherLength(){return this.obj.width}set anotherLength(e){this.obj.width=e}}class tG{constructor(e,t,r){this.modelTableIndex=e,this.offset=t,this.layoutTable=r}}class rG extends tG{constructor(e,t,r,i){super(e,t,r),this.layoutRowIndex=i}}class iG extends tG{constructor(e,t,r,i,n){super(e,t,r),this.oldBorderPosition=i,this.callFromRuler=n}}class nG extends EU{getState(){return new UU(this.isEnabled())}DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.position=this.selection.reversedAnchorPostion}getLayoutTableBySelection(e,t){const r=this.selection,i=hg.createLightLayoutPosition(this.control.layout,e,t,r.pageIndex,Hu.TableCell,!0,!1);return i.row.tableCellInfo?i.row.tableCellInfo.parentRow.parentTable:hg.createLightLayoutPosition(this.control.layout,e,t,r.pageIndex,Hu.TableCell,!1,!1).row.tableCellInfo.parentRow.parentTable}tableIsEditable(e){const t=this.selection.activeSubDocument.tables[e],r=on.FixedInterval.fromPositions(t.getStartPosition(),t.getEndPosition());return this.selection.activeSubDocument.isEditable([r])}}class oG extends nG{executeCore(e,t){if(!this.tableIsEditable(t.param.modelTableIndex))return!1;const r=this.modelManipulator,i=t.subDocument,n=t.param.layoutTable||this.getLayoutTableBySelection(i,t.intervalsInfo.intervals[0].start),o=n.tableRows[t.param.layoutRowIndex].rowIndex,a=n.logicInfo.grid.table.rows[o],s=n.tableRows[t.param.layoutRowIndex],l=(new dr).init(g.u.pixelsToTwips(s.height+t.param.offset),a.height.type==$e.Exact?$e.Exact:$e.Minimum);return this.history.addAndRedo(new jd(r,i,t.param.modelTableIndex,o,l)),!0}}class aG extends nG{executeCore(e,t){const r=t.param;if(!this.tableIsEditable(r.modelTableIndex))return!1;r.oldBorderPosition+r.offset<0&&(r.offset=-r.oldBorderPosition);const i=this.modelManipulator,n=t.subDocument,o=r.layoutTable||this.getLayoutTableBySelection(n,t.intervalsInfo.intervals[0].start),a=o.logicInfo.grid,s=r.oldBorderPosition-o.x,l=cG.findNearestColumnIndex(a.columns.positions,s),d=this.getNewTableSizes(a,l,r.offset,r.callFromRuler),c=this.history;c.beginTransaction();let h=f.ListUtils.last(d.newColumnsXPositions);if(a.table.preferredWidth.type==Je.ModelUnits&&a.table.preferredWidth.value==h||c.addAndRedo(new Jm(i,n,r.modelTableIndex,this.toTableWidthUnit(h))),a.table.properties.layoutType!=Oe.Fixed&&c.addAndRedo(new Qm(i,n,r.modelTableIndex,Oe.Fixed,!0)),0!=d.tableIndentOffset){const e=a.table.getActualTableIndent(i.model.defaultTableProperties).value;c.addAndRedo(new $m(i,n,r.modelTableIndex,this.toTableWidthUnit(g.u.twipsToPixelsF(e)+d.tableIndentOffset),!0))}for(let e,t=0;e=a.table.rows[t];t++)for(let o,s=0;o=e.cells[s];s++){const e=a.tableCellInfos[t][s].getGridCellIndex(),l=e+o.columnSpan,h=d.newColumnsXPositions[l]-d.newColumnsXPositions[e],u=this.toTableWidthUnit(h);o.preferredWidth.equals(u)||c.addAndRedo(new tc(i,n,r.modelTableIndex,t,s,u))}return c.endTransaction(),!0}toTableWidthUnit(e){return(new lr).init(g.u.pixelsToTwips(e),Je.ModelUnits)}getNewTableSizes(e,t,r,i){let n=f.ListUtils.shallowCopy(e.columns.positions);if(0==t){if(!i)for(let e=1;e<n.length;e++)n[e]-=r;return new sG(n,r)}if(n[t]+=r,i)for(let e=t+1;e<n.length;e++)n[e]+=r;return new sG(n,0)}}class sG{constructor(e,t){this.newColumnsXPositions=e,this.tableIndentOffset=t}}class lG{constructor(e,t,r){this.setAdaptors(),this.control=e,this.resizeTableVisualizer=t;const i=tX.g.getEventSource(r.mouseEvent);if(this.setIndexes(i),!this.isInited())return;const n=this.getPartialLayoutPosition(r.layoutPoint.pageIndex);this.columnBoundsRelativePage=n.pageArea.createRectangle(),this.columnBoundsRelativePage.moveRectangleByPoint(n.column),this.sourceElementSize=new so.Size(i.offsetWidth,i.offsetHeight),this.startPositionRelativeTable=new Xc.Point(fn.DomUtils.pxToInt(i.style.left),fn.DomUtils.pxToInt(i.style.top)),this.pointDirAdp.init(this.startPositionRelativeTable).position+=Math.round(this.sizeDirAdp.init(this.sourceElementSize).length/2),this.pointDirAdp.anotherPosition=0,this.currPositionRelativeTable=this.startPositionRelativeTable.clone();const o=new so.Size(this.layoutTable.width,this.layoutTable.height);this.sizeDirAdp.init(o).length=1,this.resizeTableVisualizer.init(r.layoutPoint.pageIndex,o),this.updateVisualizer(),this.setSpecific()}isInited(){return void 0!==this.tableIndex}move(e){if(!e.layoutPoint||!this.isInited())return;const t=this.pointDirAdp.init(e.layoutPoint.point).position-this.rectDirAdp.init(this.columnBoundsRelativePage).position-this.rectDirAdp.init(this.layoutTable).position;t>=this.minValueRelativeTable&&t<=this.maxValueRelativeTable&&(this.pointDirAdp.init(this.currPositionRelativeTable).position=t,this.updateVisualizer())}end(e){this.isInited()&&(this.move(e),Math.abs(this.pointDirAdp.init(this.currPositionRelativeTable).position-this.pointDirAdp.init(this.startPositionRelativeTable).position)>lG.DIFFERENT_BY_PIXELS_ALLOW_CHANGE_MODEL&&this.applyChanges(),this.resizeTableVisualizer.hide())}updateVisualizer(){this.resizeTableVisualizer.show(new Xc.Point(this.columnBoundsRelativePage.x+this.layoutTable.x+this.currPositionRelativeTable.x,this.columnBoundsRelativePage.y+this.layoutTable.y+this.currPositionRelativeTable.y))}getPartialLayoutPosition(e){const t=this.control.layout.pages[e],r=this.control.selection.activeSubDocument;if(!r.isMain()){const e=t.otherPageAreas[r.id],i=e.columns[0];return this.layoutTable=lG.getLayoutTable(i,this.tableIndex),new hG(e,i)}return f.ListUtils.unsafeAnyOf(t.mainSubDocumentPageAreas,(e=>{const t=f.ListUtils.unsafeAnyOf(e.columns,(e=>(this.layoutTable=lG.getLayoutTable(e,this.tableIndex))?e:null));return t?new hG(e,t):null}))}static getLayoutTable(e,t){return f.ListUtils.elementBy(e.tablesInfo,(e=>e.logicInfo.grid.table.index==t))}setIndexes(e){this.tableIndex=e.parentNode.dxTableIndex}}lG.DIFFERENT_BY_PIXELS_ALLOW_CHANGE_MODEL=5,lG.TABLE_SEPARATOR_DIVISION_MARGIN_X=7,lG.TABLE_SEPARATOR_DIVISION_MARGIN_Y=7;class dG extends lG{setAdaptors(){this.rectDirAdp=new eG,this.pointDirAdp=new QX,this.sizeDirAdp=new ZX}static canHandleResize(e){return tX.g.getEventSource(e.mouseEvent).className.indexOf(Gj.TABLE_ROW_CURSOR)>-1}isInited(){return super.isInited()&&void 0!==this.layoutRowIndex}setIndexes(e){super.setIndexes(e),this.layoutRowIndex=e.dxLayoutRowIndex}setSpecific(){this.isInited()&&(this.minValueRelativeTable=this.layoutTable.tableRows[this.layoutRowIndex].y-this.layoutTable.y+lG.TABLE_SEPARATOR_DIVISION_MARGIN_Y,this.maxValueRelativeTable=this.columnBoundsRelativePage.height-this.layoutTable.y)}applyChanges(){this.isInited()&&this.control.commandManager.getCommand(FF.RulerChangeTableRowHeight).execute(this.control.commandManager.isPublicApiCall,new rG(this.tableIndex,this.currPositionRelativeTable.y-this.startPositionRelativeTable.y,this.layoutTable,this.layoutRowIndex))}}class cG extends lG{setAdaptors(){this.rectDirAdp=new JX,this.pointDirAdp=new qX,this.sizeDirAdp=new $X}static canHandleResize(e){return tX.g.getEventSource(e.mouseEvent).className.indexOf(Gj.TABLE_COLUMN_CURSOR)>-1}applyChanges(){this.control.commandManager.getCommand(FF.RulerChangeTableColumnWidth).execute(this.control.commandManager.isPublicApiCall,new iG(this.tableIndex,this.currPositionRelativeTable.x-this.startPositionRelativeTable.x,this.layoutTable,this.startPositionRelativeTable.x+this.layoutTable.x,!1))}setSpecific(){const e=this.layoutTable.logicInfo.grid.columns.positions,t=cG.findNearestColumnIndex(e,this.startPositionRelativeTable.x);this.minValueRelativeTable=0==t?-this.layoutTable.x:e[t-1]+lG.TABLE_SEPARATOR_DIVISION_MARGIN_X,this.maxValueRelativeTable=t==e.length-1?Number.MAX_VALUE:e[t+1]-lG.TABLE_SEPARATOR_DIVISION_MARGIN_X}static findNearestColumnIndex(e,t){const r=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e),t)),i=[r];return r+1<e.length&&i.push(r+1),r-1>0&&i.unshift(r-1),f.ListUtils.min(i,(r=>Math.abs(e[r]-t)))}}class hG{constructor(e,t){this.pageArea=e,this.column=t}}class uG{constructor(e){this.serviceContainer=e,this.baseFrame=Yj.renderContainer(Gj.AUTO_SCROLL),this.top=Yj.renderContainer(Gj.AUTO_SCROLL_CURSOR),this.center=Yj.renderContainer(Gj.AUTO_SCROLL_CURSOR),this.bottom=Yj.renderContainer(Gj.AUTO_SCROLL_CURSOR),fn.DomUtils.addClassName(this.top,Gj.AUTO_SCROLL_CURSOR_N),fn.DomUtils.addClassName(this.center,Gj.AUTO_SCROLL_CURSOR_NS),fn.DomUtils.addClassName(this.bottom,Gj.AUTO_SCROLL_CURSOR_S)}NotifyHide(){fn.DomUtils.hideNode(this.baseFrame),fn.DomUtils.hideNode(this.top),fn.DomUtils.hideNode(this.center),fn.DomUtils.hideNode(this.bottom)}NotifyShow(e,t,r,i,n,o){fn.DomUtils.setStyleSizeAndPosition(this.baseFrame.style,t),this.top.style.top="0px",this.top.style.height=`${t.y}px`,this.center.style.top=`${t.y}px`,this.center.style.height=`${t.height}px`,this.bottom.style.top=`${t.bottom}px`,this.bottom.style.height="100%",this.serviceContainer.appendChild(this.baseFrame),this.serviceContainer.appendChild(this.top),this.serviceContainer.appendChild(this.center),this.serviceContainer.appendChild(this.bottom)}}uG.HALF_SIZE=10;class pG{start(){}finish(){}constructor(e){this.handler=e}dispose(){}resizeRotationChecker(e){const t=this.handler.control.selection.activeSubDocument,r=this.handler.control.selection.specialRunInfo,i=t.isTextBox()?r.getParentSubDocument():t,n=t.isTextBox()?[new on.FixedInterval(r.getTextBoxPosition(),1)]:this.handler.control.selection.intervals;return!!i.isEditable(n)&&(this.handler.control.isReadOnlyPersistent||e(),!0)}}class gG extends pG{onMouseDoubleClick(e){}onMouseDown(e){}onMouseUp(e){}onMouseMove(e){}onMouseWheel(e){}onShortcut(e){}}class mG{constructor(e){this.timerId=null,this.control=e}start(e){this.stop();const t=Math.exp(nn.IntervalAlgorithms.reflectionOfPointOnInterval(P.MathUtils.restrictValue(Math.abs(e),23,300),on.FixedInterval.fromPositions(23,301),on.FixedInterval.fromPositions(-2,1.7))),r=(e>0?Math.max(e,23):Math.min(e,-23))*t/mG.STEPS;let i=this.control.viewManager.canvasScrollManager.scrollTop;this.timerId=setInterval((()=>{i+=r,this.control.viewManager.canvasScrollManager.scrollTop=i}),0)}stop(){null!==this.timerId&&(clearTimeout(this.timerId),this.timerId=null)}}mG.STEPS=8;class fG extends gG{constructor(e){super(e),this.scroller=new mG(this.handler.control)}onMouseDoubleClick(e){}onMouseDown(e){this.absStartPoint=e.absolutePoint,this.handler.boxVisualizerManager.autoScrollVisualizer.show(Va.Rectangle.fromCenter(e.absolutePoint,uG.HALF_SIZE))}onMouseUp(e){this.handler.switchToDefaultState()}onMouseMove(e){const t=e.absolutePoint.y-this.absStartPoint.y;Math.abs(t)>uG.HALF_SIZE?this.scroller.start(t+(t>0?-1:1)*uG.HALF_SIZE):this.scroller.stop()}onMouseWheel(e){}onShortcut(e){}finish(){this.scroller.stop(),this.handler.boxVisualizerManager.autoScrollVisualizer.hide()}}class bG extends gG{constructor(e,t,r){super(t),this.dragState=r,this.startPoint=e.clone()}start(){var e;this.handler.control.inputPositionModelChangesListener.beginUpdate(),null===(e=this.handler.control.barHolder.ribbon)||void 0===e||e.beginUpdate(),this.handler.control.barHolder.publicUiChangesListener.beginUpdate(),this.handler.control.horizontalRulerControl.beginUpdate()}finish(){var e;this.handler.control.inputPositionModelChangesListener.endUpdate(),null===(e=this.handler.control.barHolder.ribbon)||void 0===e||e.endUpdate(),this.handler.control.barHolder.publicUiChangesListener.endUpdate(),this.handler.control.horizontalRulerControl.endUpdate(),this.handler.control.barHolder.updateItemsState(),this.handler.control.horizontalRulerControl.update()}cancelOnRightMouseUp(){return!0}onMouseWheel(e){this.handler.switchState(this.dragState),this.dragState.onMouseWheel(e)}onMouseMove(e){e.layoutPoint.equals(this.startPoint)||(this.handler.switchState(this.dragState),this.dragState.onMouseMove(e))}onMouseUp(e){(e.button==WX.Left||this.cancelOnRightMouseUp()&&e.button&WX.Right)&&(this.handler.switchToDefaultState(),this.handler.onMouseUp(e))}}class CG extends gG{onMouseDown(e){this.helper=new(this.getHelperConstructor())(this.handler.control,this.handler.boxVisualizerManager.resizeTableVisualizer,e)}onMouseMove(e){this.helper.move(e)}onMouseUp(e){this.helper.end(e),this.handler.switchToDefaultState()}getHelperConstructor(){throw new Error(R.D.NotImplemented)}}class SG extends CG{getHelperConstructor(){return dG}}class IG extends CG{getHelperConstructor(){return cG}}class PG extends bG{constructor(e,t,r){super(e,t,r),this.resetSelectionOnMouseUp=!0}onMouseUp(e){if(super.onMouseUp(e),!(this.cancelOnRightMouseUp()&&e.button&WX.Right)&&this.resetSelectionOnMouseUp){var t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);if(t.correctAsVisibleBox(),t.exactlyDetailLevel>Hu.None){var r=this.handler.control.selection,i=t.getPosition();r.deprecatedSetSelection(i,i,!1,-1,!0)}}}}class wG extends gG{onShortcut(e){e===KU.VD.Esc&&this.handler.switchToDefaultState()}calculateHitTest(e){const t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);return t.correctAsVisibleBox(),t}onMouseMove(e){this.continueDrag(e)}onMouseWheel(e){this.continueDrag(e)}onMouseUp(e){this.commitDrag(e),this.handler.switchToDefaultState()}continueDrag(e){}commitDrag(e){}}class yG extends wG{constructor(e){super(e),this.allowedToDrag=this.handler.control.commandManager.getCommand(FF.DragMoveContent).getState().enabled}start(){let e=this.allowedToDrag?VX.Default:VX.NoDrop;this.handler.setCursorPointer(e)}finish(){this.handler.restoreCursorPointer(),this.handler.boxVisualizerManager.dragCaretVisualizer.hide()}continueDrag(e){if(this.allowedToDrag){var t=this.calculateHitTest(e);this.handler.boxVisualizerManager.dragCaretVisualizer.show(t)}}commitDrag(e){if(this.allowedToDrag){var t=this.calculateHitTest(e);if(t.exactlyDetailLevel>Hu.None){var r=this.handler.control.selection.activeSubDocument,i=new on.FixedInterval(t.getPosition(),0);Md.correctIntervalDueToFields(r,i);var n=e.modifiers&KU.tx.Ctrl?FF.DragCopyContent:FF.DragMoveContent;this.handler.control.commandManager.getCommand(n).execute(this.handler.control.commandManager.isPublicApiCall,i.start)}}}}class xG extends Ze{constructor(e,t,r,i){super(e),this.oldSubDocument=t,this.textBoxParentSubDocument=r,this.position=i}redo(){const e=this.textBoxParentSubDocument.getRunAndIndexesByPosition(this.position).run;this.newSubDocument=this.modelManipulator.model.subDocuments[e.subDocId],this.modelManipulator.model.subDocumentsCollection.replace(this.oldSubDocument.id,this.newSubDocument.id),this.copyPropertiesToLastParagraph(this.oldSubDocument,this.newSubDocument)}undo(){this.modelManipulator.model.subDocumentsCollection.replace(this.newSubDocument.id,this.oldSubDocument.id)}copyPropertiesToLastParagraph(e,t){const r=t.paragraphs[t.paragraphs.length-1],i=e.paragraphs[t.paragraphs.length-1];this.modelManipulator.paragraph.applyParagraphProperties(r,i,!1,i.getParagraphBundleFull(e.documentModel))}}class TG{constructor(e,t,r,i,n,o){this.newPosition=t,this.subDocumentId=e,this.pageIntervals=r,this.pageIndex=i,this.objectX=n,this.objectY=o,0==this.pageIndex&&0!=this.pageIntervals[0].start&&this.pageIntervals.splice(0,1,new on.FixedInterval(0,this.pageIntervals[0].end))}}class vG extends EU{get activeSubDocument(){return this.selection.activeSubDocument}getState(){return new UU(this.isEnabled())}canModify(){return!0}isEnabled(){const e=this.selection.specialRunInfo;return super.isEnabled()&&e.isSelected()&&e.isSelectedAnchorObject&&this.getFloatingObjectParentSubDocument().isEditable([new on.FixedInterval(e.getPosition(),1)])}executeCore(e,t){const r=this.control.viewManager.canvasManager.getScrollTopInfo(),i=this.activeSubDocument.getRunAndIndexesByPosition(this.selection.specialRunInfo.getPosition()),n=i.run.clone(),o=i.getAbsoluteRunPosition(),a=t.finalClickPoint,s=new zp(t.endPageIndex,a.x,a.y),l=this.control.hitTestManager.calculate(s,Hu.Character,null,!0);if(l.pageArea)return l.correctAsVisibleBox(),this.history.beginTransaction(),l.pageArea.subDocument.id!==this.activeSubDocument.id&&this.changeActiveSubDocument(l,a),this.move(n,o,l,t.endPageIndex,t.finalPoint),this.history.endTransaction(),this.selection.scrollManager.setScroll((new xD).byScrollInfo.setPageInfo(r)),!0}changeActiveSubDocument(e,t){const r=this.selection.activeSubDocument;if(!r.isHeaderFooter())return!1;if(e.exactlyDetailLevel==Hu.None)return!1;if(e.pageArea.subDocument.isHeaderFooter()){if(e.pageArea.subDocument.id!=r.id||this.selection.pageIndex!=e.pageIndex)return this.changeActiveSubDocumentToHeaderFooter(e.pageIndex,e.pageArea.subDocument.isHeader()),!0}else if(e.pageArea.subDocument.isMain()){const r=this.getPageClientBounds(e.page).center,i=new Va.Rectangle(r.x,r.y,0,0),n=new Va.RectangleDeviation(i,t).calcDeviation().deviation.getValue();if(n&Va.HitTestDeviation.Top)return this.changeActiveSubDocumentToHeaderFooter(e.pageIndex,!0),!0;if(n&Va.HitTestDeviation.Bottom)return this.changeActiveSubDocumentToHeaderFooter(e.pageIndex,!1),!0}return!1}changeActiveSubDocumentToHeaderFooter(e,t){this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(this.control.commandManager.isPublicApiCall,new MX(this.control,e,t))}getPageClientBounds(e){const t=e.mainSubDocumentPageAreas;let r=t[0];for(let e=1;e<t.length;e++)r=Va.Rectangle.union(t[e],r);return r}move(e,t,r,i,n){if(this.shouldMoveInsideTable(e,r)){const i=this.findParagraphStartOnThisPage(r),o=this.getNewLogPosition(this.activeSubDocument,i),a=new TG(this.activeSubDocument.id,o,i.page.getContentIntervals(),i.pageIndex,n.x,n.y);this.control.owner.raiseFloatingObjectMovedObject(a),o!=a.newPosition||n.x!=a.objectX||n.y!=a.objectY?this.handleEvent(a,e,t,!1):this.moveInsideTable(e,t,o,i,n,!1)}else this.moveOutsideTable(e,t,i,n)}shouldMoveInsideTable(e,t){return!!t.row.tableCellInfo&&!!this.modelManipulator.model.compatibilitySettings.getActualLayoutInTableCell(e.anchorInfo)}handleEvent(e,t,r,i){const n=this.activeSubDocument.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,this.activeSubDocument,e.newPosition,Hu.Character,(new cg).setDefault(!1),(new cg).setDefault(!1)):new pg(this.control.layout,this.activeSubDocument,e.newPosition,this.control.selection.pageIndex,Hu.Character).create((new cg).setDefault(!1),(new cg).setDefault(!0)),o=new Xc.Point(e.objectX,e.objectY);if(n.row.tableCellInfo)this.moveInsideTable(t,r,e.newPosition,n,o,i);else{const a=new Xc.Point(o.x-n.getLayoutX(null,Hu.Column),o.y),s=this.getNewAnchorInfo(t.anchorInfo,a);i||this.removeOldRun(t,r),this.addRun(t,e.newPosition,s),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(new on.FixedInterval(e.newPosition,1))))}}moveInsideTable(e,t,r,i,n,o){const a=i.row.tableCellInfo?new Xc.Point(i.row.tableCellInfo.x,i.row.tableCellInfo.y):new Xc.Point(0,0),s=new Xc.Point(n.x-i.getLayoutX(null,Hu.Column)-a.x,n.y-i.getLayoutY(Hu.Column)-a.y);o||this.removeOldRun(e,t),this.control.layoutFormatterManager.forceFormatPage(i.pageIndex);const l=r+(t<r?-1:0);this.addRun(e,l,this.getNewAnchorInfo(e.anchorInfo,s)),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(new on.FixedInterval(l,1))))}moveOutsideTable(e,t,r,i){this.removeOldRun(e,t),this.control.layoutFormatterManager.forceFormatPage(r);const n=new zp(Math.min(r,this.control.layout.pages.length),i.x,i.y),o=this.control.hitTestManager.calculate(n,Hu.Row,this.activeSubDocument),a=this.findParagraphStartOnThisPage(o),s=this.getNewLogPosition(this.activeSubDocument,a),l=new TG(this.activeSubDocument.id,s,a.page.getContentIntervals(),a.pageIndex,i.x,i.y);if(this.control.owner.raiseFloatingObjectMovedObject(l),s!=l.newPosition||i.x!=l.objectX||i.y!=l.objectY)this.handleEvent(l,e,t,!0);else{const t=new Xc.Point(i.x-o.getLayoutX(null,Hu.Column),i.y),r=this.getNewAnchorInfo(e.anchorInfo,t);this.addRun(e,s,r),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(new on.FixedInterval(s,1))))}}removeOldRun(e,t){const r=e.paragraph.subDocument;this.rangeCopy=fb.create(new mu(r,[on.FixedInterval.fromPositions(t,t+1)]));const i=new gu(r,new on.FixedInterval(t,1));this.modelManipulator.range.removeInterval(i,!1,!1)}findParagraphStartOnThisPage(e){const t=this.selection.activeSubDocument.getParagraphByPosition(e.getLogPosition());for(;e.stepBackRow();)if(!t.interval.contains(e.getLogPosition())){e.stepForwardRow();break}return e}addRun(e,t,r){if(this.rangeCopy){this.rangeCopy.model.mainSubDocument.getFirstRun().anchorInfo=r.clone(),this.rangeCopy.insertTo(this.modelManipulator,new pu(this.activeSubDocument,t))}this.rangeCopy=null;if(this.activeSubDocument.getRunAndIndexesByPosition(t).run.getType()==cs.AnchoredTextBoxRun){const r=e,i=this.control.modelManager.model.subDocumentsCollection.collection[r.subDocId];this.history.addAndRedo(new xG(this.modelManipulator,i,this.activeSubDocument,t))}}getNewAnchorInfo(e,t){return(e=e.clone()).horizontalPositionAlignment=mc.None,e.verticalPositionAlignment=bc.None,e.horizontalPositionType=gc.Column,e.verticalPositionType=fc.Page,e.percentOffset.x=0,e.percentOffset.y=0,e.offset.x=g.u.pixelsToTwips(t.x),e.offset.y=g.u.pixelsToTwips(t.y),e}getNewLogPosition(e,t){const r=t.getLogPosition(Hu.Row);if(!e.fields.length)return r;const i=Math.max(0,Md.normedBinaryIndexOf(e.fields,r)),n=e.fields[i].getAbsolutelyTopLevelField(),o=n.getFieldStartPosition();for(let t,i=n.index;(t=e.fields[i])&&!(t.getFieldStartPosition()>=n.getFieldEndPosition());i++)if(r==t.getResultStartPosition()){const t=e.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,e,r,Hu.Character,(new cg).setDefault(!0),(new cg).setDefault(!0)):new pg(this.control.layout,e,r,this.control.selection.pageIndex,Hu.Character).create((new cg).setDefault(!0),(new cg).setDefault(!0));if(o>=t.getLogPosition(Hu.Row)+t.row.getLastBox().getEndPosition())return o;break}return r}}class MG extends vU{constructor(e,t,r,i,n){super(e),this.startPageIndex=t,this.endPageIndex=r,this.finalPoint=i,this.finalClickPoint=n}}class EG{constructor(e,t){this.control=e,this.resizeBoxVisualizer=t}start(e){const t=this.control.layout;this.startPoint=Xc.Point.plus(e.absolutePoint,e.scroll),this.startLayoutPoint=e.layoutPoint,this.startPageIndex=e.layoutPoint.pageIndex,this.pageIndex=this.startPageIndex,this.box=t.pages[this.startPageIndex].anchoredObjectHolder.getObjectByModelPosition(t,this.control.selection.specialRunInfo.getPosition(),this.control.selection.activeSubDocument.id),this.boxPoint=new Xc.Point(this.box.x,this.box.y),this.clickBoxDistance=Xc.Point.minus(this.startLayoutPoint,this.boxPoint)}move(e){this.pageIndex=e.layoutPoint.pageIndex;const t=Xc.Point.minus(e.layoutPoint,this.clickBoxDistance);this.resizeBoxVisualizer.showAtPos(this.pageIndex,t)}end(e){if(this.getDelta(e).isZero()||!e.layoutPoint)return;let t=e.layoutPoint.pageIndex;const r=Xc.Point.minus(e.layoutPoint,this.clickBoxDistance),i=new MG(this.control,this.startPageIndex,t,r,e.layoutPoint.point);let n;for(this.control.commandManager.getCommand(FF.FloatingObjectDragDropChangePosition).execute(this.control.commandManager.isPublicApiCall,i);n=new _X(this.control.layout,this.control.selection.specialRunInfo.getPosition(),this.control.selection.activeSubDocument.id),!n.page;)this.control.layoutFormatterManager.forceFormatPage(this.control.layout.validPageCount);this.resizeBoxVisualizer.show(n.page.index,null,null,null,n.obj)}rollback(){this.resizeBoxVisualizer.showAtPos(this.startPageIndex,this.boxPoint),this.control.modelManager.history.endTransaction()}getDelta(e){return Xc.Point.minus(Xc.Point.plus(e.absolutePoint,e.scroll),this.startPoint)}}class DG extends wG{constructor(e,t){super(e),this.dragFloatingObjectsHelper=new EG(this.handler.control,this.handler.boxVisualizerManager.resizeBoxVisualizer),this.dragFloatingObjectsHelper.start(t)}onMouseMove(e){this.dragFloatingObjectsHelper.move(e)}commitDrag(e){this.dragFloatingObjectsHelper.end(e)}onShortcut(e){e===KU.VD.Esc&&this.dragFloatingObjectsHelper.rollback(),super.onShortcut(e)}}class FG extends gG{constructor(e,t,r){super(e),this.layoutPoint=t.layoutPoint,this.startSelectedWordInterval=r,this.timerId=setTimeout((()=>{this.handler.switchToDefaultState(),this.timerId=null}),FG.TIMEOUT)}dispose(){super.dispose(),clearTimeout(this.timerId)}onMouseDoubleClick(e){this.handler.switchToDefaultState(),this.handler.state.onMouseDoubleClick(e)}onMouseDown(e){e.layoutPoint.equals(this.layoutPoint)?(this.handler.control.selection.setSelection((new GX).setInterval(this.handler.control.selection.activeSubDocument.getParagraphByPosition(this.startSelectedWordInterval).interval)),this.handler.switchToDefaultState()):(this.handler.switchToDefaultState(),this.handler.state.onMouseDown(e))}onMouseUp(e){this.handler.switchToDefaultState(),this.handler.state.onMouseUp(e)}onMouseMove(e){this.handler.switchToDefaultState(),this.handler.state.onMouseMove(e)}onMouseWheel(e){this.handler.switchToDefaultState(),this.handler.state.onMouseWheel(e)}onShortcut(e){this.handler.switchToDefaultState(),this.handler.state.onShortcut(e)}finish(){null!==this.timerId&&clearTimeout(this.timerId)}}FG.TIMEOUT=450;class RG{constructor(e,t){this.control=e,this.resizeBoxVisualizer=t}start(e){const t=this.control.selection.specialRunInfo;let r=t.getPosition();const i=this.control.selection.activeSubDocument.getRunByPosition(r);if(t.isSelectedAnchorObject){const e=t.getParentSubDocument(),i=new _X(this.control.layout,r,e.id,e.isHeaderFooter()?this.control.selection.pageIndex:void 0);this.startSize=new so.Size(i.obj.width,i.obj.height)}else this.startSize=so.Size.initByCommonAction((e=>g.u.twipsToPixelsF(e(i.size.actualSize))));this.lockAspectRatio=i.size.lockAspectRatio,this.rotation=g.u.twipsToDegrees(i.size.rotation)*Math.PI/180,this.startX=e.absolutePoint.x,this.startY=e.absolutePoint.y,this.startScrollLeft=e.scroll.x,this.startScrollTop=e.scroll.y,this.lockH=e.source==HX.ResizeBox_S||e.source==HX.ResizeBox_N,this.lockV=e.source==HX.ResizeBox_E||e.source==HX.ResizeBox_W,this.sideH=e.source==HX.ResizeBox_E||e.source==HX.ResizeBox_NE||e.source==HX.ResizeBox_SE,this.sideV=e.source==HX.ResizeBox_SE||e.source==HX.ResizeBox_S||e.source==HX.ResizeBox_SW}move(e){this.size=this.getSize(e),this.positionDelta=this.getPositionDelta(this.size),this.resizeBoxVisualizer.recalculate(this.size,this.positionDelta,null)}end(e){let t=this.control.selection.activeSubDocument.getRunByPosition(this.control.selection.specialRunInfo.getPosition());if(this.size||(this.size=this.getSize(e),this.positionDelta=this.getPositionDelta(this.size)),t.getType()==cs.InlinePictureRun){let e=this.control.commandManager.getCommand(FF.ChangeInlinePictureScale),r=t.size.originalSize,i=g.u.pixelsToTwips(100*this.size.width/r.width),n=g.u.pixelsToTwips(100*this.size.height/r.height);e.execute(this.control.commandManager.isPublicApiCall,[i,n])}else{let e=this.control.commandManager.getCommand(FF.ShowLayoutOptionsForm),t=e.createParameters(new vU(this.control));const r=t.clone();t.useAbsoluteWidth=!0,t.useAbsoluteHeight=!0,t.absoluteWidth=g.u.pixelsToTwips(this.size.width),t.absoluteHeight=g.u.pixelsToTwips(this.size.height),t.offsetX=t.offsetX+g.u.pixelsToTwips(this.positionDelta.width),t.offsetY=t.offsetY+g.u.pixelsToTwips(this.positionDelta.height),e.applyParameters(e.getState(),t,r)}}getSize(e){var t,r,i=e.absolutePoint.x-(this.startScrollLeft-e.scroll.x)-this.startX,n=e.absolutePoint.y-(this.startScrollTop-e.scroll.y)-this.startY,o=i*Math.cos(this.rotation)- -n*Math.sin(this.rotation),a=-(i*Math.sin(this.rotation)+-n*Math.cos(this.rotation));return a=!this.sideV&&a>0?Math.min(this.startSize.height+1,a):a,o=!this.sideH&&o>0?Math.min(this.startSize.width+1,o):o,this.lockH||this.lockV||!this.lockAspectRatio?(o=this.lockH?0:o,a=this.lockV?0:a,t=Math.max(1,this.sideH?this.startSize.width+o:this.startSize.width-o),r=Math.max(1,this.sideV?this.startSize.height+a:this.startSize.height-a)):Math.abs(o)>Math.abs(a)?(t=this.sideH?Math.max(1,this.startSize.width+o):this.startSize.width-o,r=this.startSize.height*(t/this.startSize.width)):(r=this.sideV?Math.max(1,this.startSize.height+a):this.startSize.height-a,t=this.startSize.width*(r/this.startSize.height)),new so.Size(t,r)}getPositionDelta(e){let t=this.startSize.width-e.width,r=this.startSize.height-e.height,i=(!this.lockV&&(this.sideH&&!this.sideV||!this.sideH&&this.sideV)?-t:t)/2,n=r/2,o=i*Math.cos(this.rotation)-n*Math.sin(this.rotation),a=n*Math.cos(this.rotation)+i*Math.sin(this.rotation);return!this.sideH&&!this.sideV||!this.lockV&&this.sideH&&!this.sideV||(o=-o,a=-a),new so.Size(o+t/2,a+r/2)}}class LG extends wG{start(){this.resizeBoxHelper=new RG(this.handler.control,this.handler.boxVisualizerManager.resizeBoxVisualizer)}onMouseDown(e){this.resizeBoxHelper.start(e),this.setCursor()}onMouseMove(e){this.resizeBoxHelper.move(e)}onMouseUp(e){super.onMouseUp(e),this.resizeBoxHelper.end(e)}setCursor(){this.resizeBoxHelper.lockH?this.handler.setCursorPointer(VX.SResize):this.resizeBoxHelper.lockV?this.handler.setCursorPointer(VX.WResize):this.resizeBoxHelper.sideH&&this.resizeBoxHelper.sideV?this.handler.setCursorPointer(VX.SEResize):this.resizeBoxHelper.sideH&&!this.resizeBoxHelper.sideV?this.handler.setCursorPointer(VX.NEResize):!this.resizeBoxHelper.sideH&&this.resizeBoxHelper.sideV?this.handler.setCursorPointer(VX.SWResize):this.resizeBoxHelper.sideH||this.resizeBoxHelper.sideV||this.handler.setCursorPointer(VX.NWResize)}finish(){this.handler.setCursorPointer(VX.Auto)}}class BG{constructor(e,t){this.control=e,this.resizeBoxVisualizer=t}start(e){let t=this.control.layout.pages[e.layoutPoint.pageIndex],r=this.control.selection.activeSubDocument.id,i=t.anchoredObjectHolder.getObjectByModelPosition(this.control.layout,this.control.selection.specialRunInfo.getPosition(),r);this.centerPoint=i.center}move(e){this.resizeBoxVisualizer.recalculate(null,null,this.getRotation(this.centerPoint,e.layoutPoint))}end(e){let t=this.getRotation(this.centerPoint,e.layoutPoint),r=this.control.commandManager.getCommand(FF.ShowLayoutOptionsForm),i=r.createParameters(new vU(this.control));const n=i.clone();i.rotation=g.u.radiansToDegrees(t),r.applyParameters(r.getState(),i,n),this.resizeBoxVisualizer.recalculate(null,null,t)}getRotation(e,t){let r=Math.atan2(e.y-t.y,e.x-t.x);r-=Math.PI/2,r=r<0?r+2*Math.PI:r;const i=[0,Math.PI/2,Math.PI,3*Math.PI/2,2*Math.PI];for(let e=0;e<i.length;e++)Math.abs(r-i[e])<.05&&(r=i[e]);return r==2*Math.PI&&(r=0),r}}class AG extends wG{onMouseDown(e){this.rotateBoxHelper=new BG(this.handler.control,this.handler.boxVisualizerManager.resizeBoxVisualizer),this.rotateBoxHelper.start(e)}onMouseMove(e){this.rotateBoxHelper.move(e)}onMouseUp(e){super.onMouseUp(e),this.rotateBoxHelper.end(e)}}class NG extends gG{onMouseMove(e){var t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);t.exactlyDetailLevel>Hu.None&&this.continueSelection(t,e)}onMouseUp(e){this.stopProcessing()}start(){var e;this.handler.control.inputPositionModelChangesListener.beginUpdate(),null===(e=this.handler.control.barHolder.ribbon)||void 0===e||e.beginUpdate(),this.handler.control.barHolder.publicUiChangesListener.beginUpdate(),this.handler.control.horizontalRulerControl.beginUpdate()}finish(){var e;this.handler.control.inputPositionModelChangesListener.endUpdate(),this.handler.control.inputPosition.reset(),null===(e=this.handler.control.barHolder.ribbon)||void 0===e||e.endUpdate(),this.handler.control.barHolder.publicUiChangesListener.endUpdate(),this.handler.control.horizontalRulerControl.endUpdate(),this.handler.control.barHolder.updateItemsState(),this.handler.control.horizontalRulerControl.update()}stopProcessing(){this.handler.switchToDefaultState()}continueSelection(e,t){var r=this.getExtendSelectionCommand(),i=this.getExtendSelectionCommandParameter(e);r.execute(this.handler.control.commandManager.isPublicApiCall,i)}getExtendSelectionCommand(){throw new Error(R.D.NotImplemented)}getExtendSelectionCommandParameter(e){}}class kG extends gG{constructor(e,t){super(e),this.startPosition=t}onMouseUp(e){this.handler.switchToDefaultState(),this.handler.state.onMouseUp(e)}onMouseMove(e){this.updateSelection(e)}onMouseWheel(e){this.updateSelection(e)}updateSelection(e){const t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument);if(t.exactlyDetailLevel>Hu.None){var r=t.getPosition();r!==this.startPosition&&(this.handler.control.selection.changeState((e=>{e.addInterval(on.FixedInterval.fromPositions(this.startPosition,r)).resetKeepX().setEndOfLine(!1)})),this.handler.switchState(new OG(this.handler)))}}}class OG extends NG{constructor(){super(...arguments),this.prevLayoutPoint=new zp(-1,-1,-1)}extendToPoints(e,t){e.changeState((e=>{e.interval.start=Math.min(e.interval.start,t.minElement),e.interval.end=Math.max(e.interval.end,t.maxElement),e.resetKeepX().setEndOfLine(!1)}))}isForwardMouseDirection(e){const t=e.layoutPoint;return t.pageIndex>this.prevLayoutPoint.pageIndex||t.y>this.prevLayoutPoint.y||t.x>this.prevLayoutPoint.x}extendForward(e,t){const r=e.lastSelectedInterval,i=this.handler.control.selection.activeSubDocument.getParagraphByPosition(Math.max(0,Math.max(t,r.end)-1)).interval;return!(!(i.length>1)||i.end-1!=t&&i.end!=t||!r.contains(i.start))&&(e.changeState((e=>{e.extendLastInterval(Math.max(i.end,r.end)).resetKeepX().setEndOfLine(!1)})),!0)}extendBackward(e,t){const r=e.lastSelectedInterval,i=this.handler.control.selection.activeSubDocument.getParagraphByPosition(Math.min(t,r.start)).interval;let n=!1,o=new xl.MinMaxNumber(r.start,r.end);if(i.length>1&&i.start==t&&r.containsWithIntervalEnd(i.end-1)&&!r.containsWithIntervalEnd(i.end)&&(o.minElement=Math.min(o.minElement,i.start),o.maxElement=Math.max(o.maxElement,i.end),n=!0),r.end>i.end&&!e.forwardDirection){const e=this.handler.control.selection.activeSubDocument.getParagraphByPosition(Math.max(t,r.end)).interval;e.length>1&&r.contains(e.start)&&r.end==e.end-1&&(o.minElement=Math.min(o.minElement,e.start),o.maxElement=Math.max(o.maxElement,e.end),n=!0)}return!!n&&(this.extendToPoints(e,o),!0)}extendSelectionToFullParagraph(e,t){const r=this.handler.control.selection;if(this.isForwardMouseDirection(e)){if(this.extendForward(r,t))return!0}else if(this.extendBackward(r,t))return!0;return!1}continueSelection(e,t,r=!1){const i=e.getPosition();!r&&this.extendSelectionToFullParagraph(t,i)||this.handler.control.selection.changeState((e=>{e.extendLastInterval(i).resetKeepX().setEndOfLine(!1)})),this.prevLayoutPoint=t.layoutPoint.clone()}}class _G extends NG{getExtendSelectionCommand(){return this.handler.control.commandManager.getCommand(FF.ExtendSelectLineNoUpdateControlState)}getExtendSelectionCommandParameter(e){return e.getRelatedSubDocumentPagePosition()+e.pageArea.pageOffset+e.column.pageAreaOffset+e.row.columnOffset}}class UG extends NG{constructor(e,t,r,i){super(e),this.table=t,this.startColumnIndex=r,this.lastColumnIndex=r,this.columnOffsetX=i}onMouseMove(e){if(e.layoutPoint.isEmpty())return;let t=e.layoutPoint.x-this.columnOffsetX-this.table.x,r=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(this.table.logicInfo.grid.columns.positions,(e=>e),t));if(r!==this.lastColumnIndex){let t=e.modifiers&KU.tx.Ctrl,i=this.handler.control.commandManager.getCommand(t?FF.ExtendSelectTableColumn:FF.SelectTableColumn),n=[],o=Math.min(this.startColumnIndex,r),a=Math.max(this.startColumnIndex,r);for(let e=o;e<=a;e++)n.push(e);i.execute(this.handler.control.commandManager.isPublicApiCall,{table:this.table.logicInfo.grid.table,columnIndices:n}),this.lastColumnIndex=r}}}class HG extends OG{constructor(e,t,r){super(e),this.table=t,this.startRowIndex=r,this.lastRowIndex=r}onMouseMove(e){let t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);if(t.exactlyDetailLevel==Hu.None)return;let r,i,n=e.modifiers&KU.tx.Ctrl,o=t.getPosition(),a=this.table.logicInfo.grid.table,s=!1;o<a.getStartPosition()?(r=0,s=!0,i=!1):o>a.getEndPosition()?(r=a.rows.length-1,s=!0,i=!0):(r=C.SearchUtils.normedInterpolationIndexOf(a.rows,(e=>e.getStartPosition()),o),i=r>=this.startRowIndex);let l=this.handler.control.selection;if(this.lastRowIndex!==r||!s&&(l.intervals[0].start<a.getStartPosition()||l.intervals[l.intervals.length-1].end>a.getEndPosition())){let e=this.handler.control.commandManager.getCommand(n?FF.ExtendSelectTableRow:FF.SelectTableRow),t=[],o=Math.min(this.startRowIndex,r),a=Math.max(this.startRowIndex,r);for(let e=o;e<=a;e++)t.push(e);r<this.startRowIndex&&(t=t.reverse()),e.execute(this.handler.control.commandManager.isPublicApiCall,new SX(this.handler.control,this.table.logicInfo.grid.table,t,i)),this.lastRowIndex=r}s&&this.continueSelection(t,e)}}class VG extends OG{constructor(e,t,r,i,n){super(e);let o=t.logicInfo.grid.table.rows[r];const a=t.logicInfo.grid.tableCellGridInfos[r][i].getCellIndexAbs(r);for(this.startCell=o.cells[a],this.lastCell=this.startCell,this.startParentCell=this.startCell,this.startPosition=n;this.startParentCell.parentRow.parentTable.parentCell;)this.startParentCell=this.startParentCell.parentRow.parentTable.parentCell}onMouseMove(e){let t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);if(t.exactlyDetailLevel==Hu.None)return;let r=this.handler.control.selection,i=!!(e.modifiers&KU.tx.Ctrl);if(!t.row.tableCellInfo)return void this.selectWholeInterval(t,e,i);let n=t.row.tableCellInfo.parentRow.parentTable.logicInfo.grid.table.rows[t.row.tableCellInfo.parentRow.rowIndex],o=n.cells[oc.getCellIndexByColumnIndex(n,t.row.tableCellInfo.cellGridIndex)],a=oc.getSameTableCells(this.startCell,o);if(!a)return void this.selectWholeInterval(t,e,i);if(this.startCell===a.lastCell){if(i||1===r.intervals.length&&(r.intervals[0].start===this.startPosition||r.intervals[0].end===this.startPosition)){t.row.tableCellInfo&&t.row.tableCellInfo.boundFlags.get(_a.EndOnThisColumn)&&f.ListUtils.last(t.row.tableCellInfo.layoutRows)==t.row&&t.exactlyDetailLevel>=Hu.TableCell&&t.deviations[Hu.Character]&Va.HitTestDeviation.Right&&t.isLastBoxInRow()&&t.charOffset==t.box.getLength()||this.continueSelection(t,e,!0)}else this.handler.control.selection.deprecatedSetSelection(this.startPosition,t.getPosition(),!1,-1,!0);return void(this.lastCell=this.startCell)}if(this.lastCell===a.lastCell)return;let s={firstCell:a.firstCell,lastCell:a.lastCell,extendSelection:i};this.handler.control.commandManager.getCommand(FF.SelectTableCellsRange).execute(this.handler.control.commandManager.isPublicApiCall,s),this.lastCell=a.lastCell}selectWholeInterval(e,t,r){let i=this.handler.control.selection,n=e.getPosition(),o=n>=this.startCell.endParagrapPosition.value?this.startParentCell.parentRow.getStartPosition():this.startParentCell.parentRow.getEndPosition();i.multiselection?i.changeState((e=>{const t=on.FixedInterval.fromPositions(o,n);r?e.addInterval(t):e.setInterval(t),e.resetKeepX().setEndOfLine(!0)})):this.continueSelection(e,t)}}class WG extends gG{onMouseDoubleClick(e){var t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument);if(t.exactlyDetailLevel==Hu.None)return;if(this.isLeftAreaOffset(t,e))return void this.handler.control.commandManager.getCommand(FF.SelectParagraph).execute(this.handler.control.commandManager.isPublicApiCall,t.getPosition());const r=this.handler.control.selection.activeSubDocument;if(t.exactlyDetailLevel<Hu.PageArea)if(r.isMain()){if(t.deviations[Hu.PageArea]&Va.HitTestDeviation.Top)return void this.handler.control.commandManager.getCommand(FF.InsertHeader).execute(this.handler.control.commandManager.isPublicApiCall,t.pageIndex);if(t.deviations[Hu.PageArea]&Va.HitTestDeviation.Bottom)return void this.handler.control.commandManager.getCommand(FF.InsertFooter).execute(this.handler.control.commandManager.isPublicApiCall,t.pageIndex)}else if(this.shouldActivateMainArea(r,t))return void this.handler.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(this.handler.control.commandManager.isPublicApiCall);if(this.isLeftArea(t,e)||t.exactlyDetailLevel>=Hu.PageArea){var i=t.getRelatedSubDocumentPagePosition()+t.pageArea.pageOffset+t.column.pageAreaOffset+t.row.columnOffset+t.box.rowOffset+t.charOffset;t.boxIndex==t.row.boxes.length-1&&t.charOffset==t.box.getLength()&&i--;const n=this.handler.control.selection,o=hX.getLayoutWordStartBound(this.handler.control.layout,r,n,i),a=hX.getLayoutWordEndBound(this.handler.control.layout,r,n,i,!0);if(a<=o)return;n.changeState((t=>{const r=on.FixedInterval.fromPositions(o,a);e.modifiers&KU.tx.Ctrl?t.addInterval(r):t.setInterval(r),t.resetKeepX().setEndOfLine(!1)})),this.handler.switchState(new FG(this.handler,e,o))}}shouldActivateMainArea(e,t){return e.isHeader()&&!!(t.deviations[Hu.PageArea]&Va.HitTestDeviation.Bottom)||e.isFooter()&&!!(t.deviations[Hu.PageArea]&Va.HitTestDeviation.Top)||e.isHeaderFooter()&&!t.pageArea}changeActiveSubDocument(e){const t=this.handler.control,r=t.selection.activeSubDocument;if(!r.isHeaderFooter())return!1;var i=t.hitTestManager.calculate(e.layoutPoint,Hu.PageArea,null,!0);return i.exactlyDetailLevel!=Hu.None&&(i.pageArea.subDocument.isHeaderFooter()?(i.pageArea.subDocument.id!=r.id||t.selection.pageIndex!=i.pageIndex)&&(t.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(t.commandManager.isPublicApiCall,new MX(t,i.pageIndex,i.pageArea.subDocument.isHeader())),!0):!!i.pageArea.subDocument.isMain()&&(i.deviations[Hu.PageArea]&Va.HitTestDeviation.Top?(t.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(t.commandManager.isPublicApiCall,new MX(t,i.pageIndex,!0)),!0):!!(i.deviations[Hu.PageArea]&Va.HitTestDeviation.Bottom)&&(t.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(t.commandManager.isPublicApiCall,new MX(t,i.pageIndex,!1)),!0)))}onMouseDown(e){var t;let r=this.handler.control.selection.activeSubDocument;if(this.handler.control.barHolder.contextMenu.onCanvasMouseDown(),null===(t=this.handler.control.barHolder.ribbon)||void 0===t||t.onCanvasMouseDown(),e.middleButtonPressed)return this.handler.switchState(new fG(this.handler)),void this.handler.state.onMouseDown(e);if(this.changeActiveSubDocument(e))return;if(WG.canHandleFullTableSelection(e))return void this.handler.control.selection.setSelection((new GX).setInterval(this.handler.control.selection.tableInfo.table.interval));if(cG.canHandleResize(e)&&!this.handler.control.readOnly){if(this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.PageArea,null).pageArea.subDocument==r)return this.handler.switchState(new IG(this.handler)),void this.handler.state.onMouseDown(e)}if(dG.canHandleResize(e)&&!this.handler.control.readOnly){if(this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.PageArea,null).pageArea.subDocument==r)return this.handler.switchState(new SG(this.handler)),void this.handler.state.onMouseDown(e)}if(this.shouldProcessResizeBoxVisualizer(e)&&this.resizeRotationChecker((()=>{r.isTextBox()&&zG.selectParentsTextBox(this.handler.control),this.beginResizeBoxMouseHandler(e)})))return;if(jX.shouldRotate(e,this.handler.control)&&this.resizeRotationChecker((()=>{r.isTextBox()&&zG.selectParentsTextBox(this.handler.control),this.beginRotate(e)})))return;let i=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,r);(i.exactlyDetailLevel!=Hu.None||i.floatingObject)&&(!jX.shouldHandleTextBoxAreaClick(e)&&r.isTextBox()&&(zG.changeActiveSubDocumentToParent(this.handler.control),i=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument)),this.processMouseDownOnMaxDetailsLevel(e,i,r))}processMouseDownOnMaxDetailsLevel(e,t,r){if(t.floatingObject){t.floatingObject.belongsToSubDocId!=this.handler.control.selection.activeSubDocument.id&&zG.changeActiveSubDocumentToParent(this.handler.control);const i=t.floatingObject;this.selectFloatingObject(i);const n=this.handler.control.selection.specialRunInfo;if(n.isSelectedAnchorObject)if(i.getType()==lc.AnchorTextBox&&kX.isPointInTexBoxArea(e.layoutPoint,i,r.isTextBox()?0:i.rotationInRadians))this.handler.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToTextBox).execute(this.handler.control.commandManager.isPublicApiCall),this.handler.boxVisualizerManager.resizeBoxVisualizer.show(t.pageIndex,null,null,null,i),t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument);else{if(this.resizeRotationChecker((()=>{const t=new DG(this.handler,e);this.handler.switchState(new bG(e.layoutPoint,this.handler,t))})))return;if(n.isPictureSelected())return void this.handler.control.selection.setSelection((new GX).setInterval(new on.FixedInterval(n.getPicturePosition(),1)))}}yH.Browser.TouchUI&&t.subDocument.isMain()&&t.exactlyDetailLevel<Hu.PageArea&&(t.deviations[Hu.PageArea]&Va.HitTestDeviation.Top||t.deviations[Hu.PageArea]&Va.HitTestDeviation.Bottom)&&this.handler.control.viewManager.canvasScrollManager.waitForDblClick(),e.button===WX.Right&&this.handler.control.selection.lastSelectedInterval.contains(t.getPosition())||(this.shouldSelectEntireTableColumn(t)?this.beginSelectEntireTableColumn(t,e):this.shouldSelectEntireTableRow(t)?this.beginSelectEntireTableRow(t,e):this.shouldBeginDragExistingSelection(t,e)?this.beginDragExistingSelection(e,!0):this.shouldSelectEntireTableCell(t,e)?this.shouldSelectPicture(t,!!(e.modifiers&KU.tx.Ctrl))?this.selectImage(e,t):this.beginSelectEntireTableCell(t,e):this.isLeftArea(t,e)?e.modifiers&KU.tx.Ctrl&&this.handler.control.selection.isCollapsed()?this.handler.control.commandManager.getCommand(FF.SelectAll).execute(this.handler.control.commandManager.isPublicApiCall,t.getPosition()):this.isLeftAreaOffset(t,e)?this.beginLineSelection(t,e):this.beginCharacterSelection(e,t,!!(e.modifiers&KU.tx.Shift)):this.shouldSelectPicture(t,!!(e.modifiers&KU.tx.Ctrl))?this.selectImage(e,t):t.exactlyDetailLevel>=Hu.Character&&e.modifiers&KU.tx.Ctrl?this.beginCharacterMultiSelection(t):t.exactlyDetailLevel>=Hu.PageArea&&this.beginCharacterSelection(e,t,!!(e.modifiers&KU.tx.Shift)))}onMouseUp(e){if((e.button===WX.Right||e.button===WX.Left&&yH.Browser.MacOSPlatform&&e.modifiers&KU.tx.Ctrl)&&!e.middleButtonPressed&&e.layoutPoint&&this.handler.control.popupMenuManager.showByMouseClick(e.absolutePoint),this.handler.control.modelManager.richOptions.fields.openHyperlinkOnClick||e.modifiers&KU.tx.Ctrl){const t=this.handler.getHyperlinkFieldResult(e);t&&(this.handler.control.clientSideEvents.raiseHyperlinkClick(e.mouseEvent,t)||this.handler.control.commandManager.getCommand(FF.OpenHyperlink).execute(this.handler.control.commandManager.isPublicApiCall,t))}}static canHandleFullTableSelection(e){return tX.g.getEventSource(e.mouseEvent).className.indexOf(Gj.FULL_TABLE_SELECTOR)>-1}shouldSelectEntireTableColumn(e){return!!e.row&&(!!e.row.tableCellInfo&&!!(e.deviations[Hu.TableCell]&Va.HitTestDeviation.Top))}shouldSelectEntireTableRow(e){return!!e.row&&(!!e.row.tableCellInfo&&!!(e.deviations[Hu.TableCell]&Va.HitTestDeviation.Left))}shouldSelectEntireTableCell(e,t){return!!e.row&&(!!e.row.tableCellInfo&&(!e.deviations[Hu.TableCell]&&!(t.modifiers&KU.tx.Shift)))}beginSelectEntireTableColumn(e,t){let r=t.modifiers&KU.tx.Ctrl,i=this.handler.control.commandManager.getCommand(r?FF.ExtendSelectTableColumn:FF.SelectTableColumn),n=e.row.tableCellInfo.parentRow.parentTable.logicInfo.grid.table,o=e.row.tableCellInfo.cellGridIndex;i.execute(this.handler.control.commandManager.isPublicApiCall,{table:n,columnIndices:[o]});let a=new UG(this.handler,e.row.tableCellInfo.parentRow.parentTable,o,e.column.x+e.pageArea.x),s=new bG(t.layoutPoint,this.handler,a);this.handler.switchState(s)}beginSelectEntireTableRow(e,t){let r=t.modifiers&KU.tx.Ctrl,i=this.handler.control.commandManager.getCommand(r?FF.ExtendSelectTableRow:FF.SelectTableRow),n=e.row.tableCellInfo.parentRow.parentTable.logicInfo.grid.table,o=e.row.tableCellInfo.parentRow.rowIndex;i.execute(this.handler.control.commandManager.isPublicApiCall,new SX(this.handler.control,n,[o],!0));let a=new HG(this.handler,e.row.tableCellInfo.parentRow.parentTable,o),s=new bG(t.layoutPoint,this.handler,a);this.handler.switchState(s)}beginSelectEntireTableCell(e,t){let r=!!(t.modifiers&KU.tx.Ctrl);var i=this.getPosition(e);this.handler.control.selection.changeState((e=>{const n=new on.FixedInterval(i,0);r||t.button&WX.Right?e.addInterval(n):e.setInterval(n),e.resetKeepX().setEndOfLine(!1)}));let n=e.row.tableCellInfo.parentRow.rowIndex,o=e.row.tableCellInfo.cellGridIndex,a=new VG(this.handler,e.row.tableCellInfo.parentRow.parentTable,n,o,this.getPosition(e)),s=new bG(t.layoutPoint,this.handler,a);this.handler.switchState(s)}beginCharacterMultiSelection(e){var t=e.getPosition();this.handler.switchState(new kG(this.handler,t))}isLeftArea(e,t){return!!e&&!!(e.exactlyDetailLevel>=Hu.Page&&e.deviations[Hu.Column]&Va.HitTestDeviation.Left&&t.layoutPoint.x<=e.pageArea.x+e.column.x)}isLeftAreaOffset(e,t){if(e){if(e.exactlyDetailLevel>=Hu.Page&&e.deviations[Hu.Column]&Va.HitTestDeviation.Left&&t.layoutPoint.x<=e.pageArea.x+e.column.x-jG.LEFT_AREA_COMMANDS_OFFSET)return!0;if(e.detailsLevel>=Hu.Box&&e.exactlyDetailLevel>=Hu.Row&&e.box==e.row.boxes[0]&&e.deviations[Hu.Box]&Va.HitTestDeviation.Left&&t.layoutPoint.x<=e.pageArea.x+e.column.x+e.row.x+e.box.x-jG.LEFT_AREA_COMMANDS_OFFSET){const e=this.handler.control.hitTestManager.calculate(t.layoutPoint,Hu.Max,null);if(e.floatingObject&&e.floatingObject.isInText())return!0}}return!1}shouldProcessResizeBoxVisualizer(e){return this.handler.boxVisualizerManager.resizeBoxVisualizer.shouldCapture(e)&&this.handler.control.selection.activeSubDocument.isEditable([new on.FixedInterval(this.handler.control.selection.specialRunInfo.getPosition(),1)])}beginResizeBoxMouseHandler(e){this.handler.switchState(new LG(this.handler)),this.handler.state.onMouseDown(e)}beginRotate(e){this.handler.switchState(new AG(this.handler)),this.handler.state.onMouseDown(e)}beginCharacterSelection(e,t,r){this.setStartSelection(t,r),this.handler.switchState(new bG(e.layoutPoint,this.handler,new OG(this.handler)))}setStartSelection(e,t){this.handler.control.inputController.setEditableDocumentContent("");var r=this.handler.control.selection,i=this.getPosition(e);const n=i===e.getRelatedSubDocumentPagePosition()+e.pageArea.pageOffset+e.column.pageAreaOffset+e.row.getEndPosition();r.changeState((e=>{t?e.extendLastInterval(i):e.setInterval(new on.FixedInterval(i,0)),e.resetKeepX().setEndOfLine(n)}))}getPosition(e){var t=e.getRelatedSubDocumentPagePosition()+e.pageArea.pageOffset+e.column.pageAreaOffset+e.row.columnOffset;if(e.deviations[Hu.Box]&Va.HitTestDeviation.Right){var r=e.row.getLastVisibleBox();r&&(t+=r.getEndPosition())}else t+=e.box.rowOffset+e.charOffset,e.boxIndex!=e.row.boxes.length-1||e.charOffset!=e.box.getLength()||e.box.isVisible()||(t-=1);return t}beginLineSelection(e,t){var r=e.getRelatedSubDocumentPagePosition()+e.pageArea.pageOffset+e.column.pageAreaOffset+e.row.columnOffset;t.modifiers&KU.tx.Shift?this.handler.control.commandManager.getCommand(FF.ExtendSelectLineNoUpdateControlState).execute(this.handler.control.commandManager.isPublicApiCall,r):t.modifiers&KU.tx.Ctrl?this.handler.control.commandManager.getCommand(FF.AddSelectedLineCommandNoUpdateControlState).execute(this.handler.control.commandManager.isPublicApiCall,r):this.handler.control.commandManager.getCommand(FF.SelectLineNoUpdateControlState).execute(this.handler.control.commandManager.isPublicApiCall,r),this.handler.switchState(new bG(t.layoutPoint,this.handler,new _G(this.handler)))}shouldSelectPicture(e,t){return!(e.exactlyDetailLevel<Hu.Box)&&(e.box.getType()==lc.Picture&&!t)}shouldBeginDragExistingSelection(e,t){if(!(t.modifiers&KU.tx.Shift)&&Bb.isEnabled(this.handler.control.modelManager.richOptions.control.drag)&&!this.handler.control.selection.isCollapsed()&&e.exactlyDetailLevel>=Hu.Box){let t=e.getPosition();return f.ListUtils.unsafeAnyOf(this.handler.control.selection.intervals,(e=>e.contains(t)))}return!1}selectImage(e,t){var r=t.getPosition()-t.charOffset;this.handler.control.selection.deprecatedSetSelection(r,r+1,!1,-1,!0),Bb.isEnabled(this.handler.control.modelManager.richOptions.control.drag)&&this.beginDragExistingSelection(e,!1)}beginDragExistingSelection(e,t){var r=new yG(this.handler),i=new PG(e.layoutPoint,this.handler,r);i.resetSelectionOnMouseUp=t,this.handler.switchState(i)}selectFloatingObject(e){const t=this.handler.control.layout.anchorObjectsPositionInfo.getPosition(e.objectId);this.handler.control.selection.setSelection((new GX).setInterval(new on.FixedInterval(t,1)))}}class zG{static selectParentsTextBox(e){const t=e.selection.specialRunInfo.getTextBoxPosition();t>-1&&(this.changeActiveSubDocumentToParent(e),e.selection.setSelection((new GX).setInterval(new on.FixedInterval(t,1))))}static changeActiveSubDocumentToParent(e){const t=e.selection,r=t.specialRunInfo.getParentSubDocument();r&&(r.isMain()?e.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(e.commandManager.isPublicApiCall):e.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(e.commandManager.isPublicApiCall,new MX(e,t.pageIndex,r.isHeader())))}}class jG extends nX{constructor(e,t){super(e,WG,t)}onMouseDoubleClick(e){this.state.onMouseDoubleClick(e)}onMouseDown(e){this.state.onMouseDown(e)}onMouseUp(e){this.state.onMouseUp(e)}onMouseMove(e){this.state.onMouseMove(e)}onMouseWheel(e){this.state.onMouseWheel(e)}onShortcut(e){this.state.onShortcut(e)}setCursorPointer(e){this.control.viewManager.canvasManager.setCursorPointer(e)}restoreCursorPointer(){this.control.viewManager.canvasManager.setCursorPointer(VX.Auto)}}jG.LEFT_AREA_COMMANDS_OFFSET=20,jG.WAIT_FOR_DBLCLICK_INTERVAL=300,function(e){e[e.Default=0]="Default",e[e.Move=1]="Move",e[e.Copy=2]="Copy",e[e.NoDrop=3]="NoDrop",e[e.EResize=4]="EResize",e[e.NResize=5]="NResize",e[e.SResize=6]="SResize",e[e.WResize=7]="WResize",e[e.SEResize=8]="SEResize",e[e.SWResize=9]="SWResize",e[e.NWResize=10]="NWResize",e[e.NEResize=11]="NEResize",e[e.EWResize=12]="EWResize",e[e.NSResize=13]="NSResize",e[e.Auto=14]="Auto"}(VX||(VX={}));class XG extends pG{constructor(){super(...arguments),this.TOUCH_SCROLL_SENSITIVITY_IN_ROWS=2}dispose(){super.dispose(),clearTimeout(this.popupMenuId)}onTouchStart(e){}onDoubleTap(e){}onTouchEnd(e){}onTouchMove(e){return!0}captureInputFocus(e){this.handler.control.focusManager.captureFocus()}showPopupMenu(){this.popupMenuId=setTimeout((()=>this.handler.control.popupMenuManager.showByTouchClick()),20)}setEditableDocumentContent(){if(!yH.Browser.IE&&!yH.Browser.Edge){var e=this.handler.control.selection.activeSubDocument;let t=this.handler.control.selection.lastSelectedInterval.start,r=hX.getLayoutWordStartBound(this.handler.control.layout,e,this.handler.control.selection,t);if(this.createLayoutPosition(new pu(e,r),Hu.Box).isLastBoxInRow()){const i=this.createLayoutPosition(new pu(e,t-1),Hu.Box);i.detailsLevel===Hu.Box&&i.box.getType()===lc.PageBreak||(r=hX.getLayoutWordStartBound(this.handler.control.layout,e,this.handler.control.selection,t-1))}let i=hX.getLayoutWordEndBound(this.handler.control.layout,e,this.handler.control.selection,r,!1),n=t>=r&&t<=i?e.getText(new on.FixedInterval(r,i-r)):"";this.handler.control.inputController.setEditableDocumentContent(n),n.length&&this.handler.control.inputController.setEditableDocumentCursorPosition(t-r)}}setLastLayoutPosition(){var e=this.handler.control.selection.activeSubDocument,t=this.handler.control.selection.lastSelectedInterval.start;this.lastLayoutPosition=this.createLayoutPosition(new pu(e,t),Hu.Character,!0)}createLayoutPosition(e,t,r=!1){const i=e.subDocument,n=e.position,o=(new cg).setDefault(this.handler.control.selection.endOfLine),a=(new cg).setDefault(r);return(i.isMain()?new ug(this.handler.control.layout,i,n,t):new pg(this.handler.control.layout,i,n,this.handler.control.selection.pageIndex,t)).create(o,a)}}class GG extends XG{constructor(e,t){super(e),this.dragState=t}start(){var e;null===(e=this.handler.control.barHolder.ribbon)||void 0===e||e.beginUpdate(),this.handler.control.horizontalRulerControl.beginUpdate()}finish(){var e;null===(e=this.handler.control.barHolder.ribbon)||void 0===e||e.endUpdate(),this.handler.control.horizontalRulerControl.endUpdate(),this.handler.control.barHolder.updateItemsState(),this.handler.control.horizontalRulerControl.update()}onTouchMove(e){return this.handler.switchState(this.dragState),this.dragState.onTouchMove(e),!1}onTouchEnd(e){this.handler.switchToDefaultState(),this.handler.onTouchEnd(e)}}class KG extends XG{onTouchStart(e){this.dragFloatingObjectsHelper=new EG(this.handler.control,this.handler.boxVisualizerManager.resizeBoxVisualizer),this.dragFloatingObjectsHelper.start(e)}onTouchMove(e){return this.dragFloatingObjectsHelper.move(e),!1}onTouchEnd(e){this.dragFloatingObjectsHelper.end(e),this.handler.switchToDefaultState()}}class qG extends XG{onTouchEnd(e){this.handler.switchToDefaultState(),this.setLastLayoutPosition(),this.captureInputFocus(e),this.showPopupMenu()}}class $G extends XG{constructor(e,t){super(e);let r=this.handler.control.hitTestManager.calculate(t,Hu.Max,this.handler.control.selection.activeSubDocument),i=this.handler.control.selection.activeSubDocument;if(i.isMain()){if(r.deviations[Hu.PageArea]&Va.HitTestDeviation.Top)return void this.handler.control.commandManager.getCommand(FF.InsertHeader).execute(this.handler.control.commandManager.isPublicApiCall,r.pageIndex);if(r.deviations[Hu.PageArea]&Va.HitTestDeviation.Bottom)return void this.handler.control.commandManager.getCommand(FF.InsertFooter).execute(this.handler.control.commandManager.isPublicApiCall,r.pageIndex)}else this.shouldActivateMainArea(i,r)&&this.handler.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(this.handler.control.commandManager.isPublicApiCall);this.handler.switchToDefaultState()}shouldActivateMainArea(e,t){return e.isHeader()&&!!(t.deviations[Hu.PageArea]&Va.HitTestDeviation.Bottom)||e.isFooter()&&!!(t.deviations[Hu.PageArea]&Va.HitTestDeviation.Top)}onTouchStart(e){this.handler.switchToDefaultState(),this.handler.state.onTouchStart(e)}onDoubleTap(e){let t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument),r=this.handler.control.selection.activeSubDocument;this.shouldActivateMainArea(r,t)&&this.handler.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(this.handler.control.commandManager.isPublicApiCall),this.handler.switchToDefaultState()}}class JG extends qG{constructor(e,t){super(e),this.selectWordUnderCursor(t)}onTouchStart(e){this.selectWordUnderCursor(e)}onTouchMove(e){return this.selectWordUnderCursor(e),!1}selectWordUnderCursor(e){const t=this.handler.control.selection.activeSubDocument;var r=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument);if(r.exactlyDetailLevel>Hu.None){var i=r.getRelatedSubDocumentPagePosition()+r.pageArea.pageOffset+r.column.pageAreaOffset+r.row.columnOffset+r.box.rowOffset+r.charOffset;const e=hX.getLayoutWordStartBound(this.handler.control.layout,t,this.handler.control.selection,i),n=hX.getLayoutWordEndBound(this.handler.control.layout,t,this.handler.control.selection,i,!1);n>e&&this.handler.control.selection.deprecatedSetSelection(e,n,!1,-1,!0)}}}class YG extends qG{constructor(e){super(e)}onTouchMove(e){this.setTouchBarsVisibility(!1),e.layoutPoint.y-=sK.TOUCH_RADIUS_HANDLE;var t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);return t.exactlyDetailLevel>Hu.None&&this.extendSelection(t),!1}setTouchBarsVisibility(e){this.handler.control.viewManager.selection.touchSelectionCircleElementsManager.setVisibilityTouchBars(e)}onTouchEnd(e){this.handler.control.popupMenuManager.rejectNextShowContextMenu(),super.onTouchEnd(e),this.setTouchBarsVisibility(!0),this.setEditableDocumentContent()}extendSelection(e){}}class QG extends YG{onTouchMove(e){this.handler.control.viewManager.selection.touchSelectionCircleElementsManager.setVisibilityTouchBars(!1),e.layoutPoint.y-=sK.TOUCH_RADIUS_HANDLE;var t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);return t.exactlyDetailLevel>Hu.None&&(this.startPosition||(this.setLastLayoutPosition(),this.startPosition=this.lastLayoutPosition),this.extendSelection(t)),!1}onTouchEnd(e){this.captureInputFocus(e),this.setLastLayoutPosition(),this.startPosition||(this.startPosition=this.lastLayoutPosition),this.startPosition.equals(this.lastLayoutPosition)&&this.showPopupMenu(),this.handler.switchToDefaultState(),this.handler.control.viewManager.selection.touchSelectionCircleElementsManager.setVisibilityTouchBars(!0),this.setEditableDocumentContent()}extendSelection(e){let t=this.getLayoutPosition(e),r=t===(e.pageArea.subDocument.isMain()?e.page.getPosition():0)+e.pageArea.pageOffset+e.column.pageAreaOffset+e.row.getEndPosition();this.handler.control.selection.deprecatedSetSelection(t,t,r,-1,!1)}getLayoutPosition(e){var t=(e.pageArea.subDocument.isMain()?e.page.getPosition():0)+e.pageArea.pageOffset+e.column.pageAreaOffset+e.row.columnOffset;if(e.deviations[Hu.Row]&Va.HitTestDeviation.Right){var r=e.row.getLastVisibleBox();r&&(t+=r.getEndPosition())}else t+=e.box.rowOffset+e.charOffset,e.boxIndex!=e.row.boxes.length-1||e.charOffset!=e.box.getLength()||e.box.isVisible()||(t-=1);return t}}class ZG extends YG{constructor(e,t=!0){super(e),this.isDragLeftEdge=!1,this.isDragLeftEdge=t}extendSelection(e){this.extendLastSelectionOnOneSide(Math.min(e.getPosition(),e.subDocument.getDocumentEndPosition()-1),this.isDragLeftEdge)}extendLastSelectionOnOneSide(e,t){const r=this.handler.control.selection,i=r.intervalsInfo.interval;let n=null;const o=e>=r.anchorPosition;t?e<i.end&&(n=new on.FixedInterval(e,i.length-(e-i.start))):e-i.start>=1&&(n=new on.FixedInterval(i.start,e-i.start)),!n||0==r.endOfLine&&i.equals(n)||r.changeState((e=>e.setInterval(n).setForwardDirection(o).setEndOfLine(!1)))}setTouchBarsVisibility(e){this.isDragLeftEdge?this.handler.control.viewManager.selection.touchSelectionCircleElementsManager.setFirstTouchBarVisibility(e):this.handler.control.viewManager.selection.touchSelectionCircleElementsManager.setSecondTouchBarVisibility(e)}}class eK extends XG{constructor(e){super(e)}finish(){this.handler.boxVisualizerManager.dragCaretVisualizer.hide()}onTouchMove(e){return this.continueDrag(e),!1}onTouchEnd(e){this.commitDrag(e),this.handler.switchToDefaultState()}continueDrag(e){var t=this.calculateHitTest(e);t.exactlyDetailLevel>=Hu.Character&&this.handler.boxVisualizerManager.dragCaretVisualizer.show(t)}commitDrag(e){var t=this.calculateHitTest(e);if(t.exactlyDetailLevel>=Hu.Character){var r=this.handler.control.selection.activeSubDocument,i=new on.FixedInterval(t.getPosition(),0);Md.correctIntervalDueToFields(r,i);var n=FF.DragMoveContent;this.handler.control.commandManager.getCommand(n).execute(this.handler.control.commandManager.isPublicApiCall,i.start)}}calculateHitTest(e){const t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);return t.exactlyDetailLevel>Hu.None&&t.correctAsVisibleBox(),t}}class tK extends XG{constructor(e,t,r){super(e),this.action=r,this.timerID=setTimeout((()=>{this.timerID=-1,this.action()}),t)}dispose(){super.dispose(),clearTimeout(this.timerID)}onTouchEnd(e){this.finish()}onTouchMove(e){return this.finish(),this.handler.switchToDefaultState(),!0}finish(){-1!=this.timerID&&clearTimeout(this.timerID)}handleTap(e){var t=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Character,this.handler.control.selection.activeSubDocument);if(t.exactlyDetailLevel>Hu.None&&this.shouldSelectPicture(t))this.selectImage(t);else if(t.exactlyDetailLevel>Hu.None){this.setLastLayoutPosition();var r=this.getLayoutPosition(t);if(this.shouldChangeSelection(r)){var i=r===(t.pageArea.subDocument.isMain()?t.page.getPosition():0)+t.pageArea.pageOffset+t.column.pageAreaOffset+t.row.getEndPosition();this.handler.control.selection.deprecatedSetSelection(r,r,i,-1,!0)}this.setEditableDocumentContent(),this.captureInputFocus(e),this.handler.control.viewManager.selection.touchSelectionCircleElementsManager.setVisibilityTouchBars(!0)}}getLayoutPosition(e){var t=(e.pageArea.subDocument.isMain()?e.page.getPosition():0)+e.pageArea.pageOffset+e.column.pageAreaOffset+e.row.columnOffset;if(e.deviations[Hu.Row]&Va.HitTestDeviation.Right){var r=e.row.getLastVisibleBox();r&&(t+=r.getEndPosition())}else t+=e.box.rowOffset+e.charOffset,e.boxIndex!=e.row.boxes.length-1||e.charOffset!=e.box.getLength()||e.box.isVisible()||(t-=1);return t}shouldChangeSelection(e){return!0}shouldSelectPicture(e){return!(e.exactlyDetailLevel<Hu.Box)&&e.box instanceof LE}selectImage(e){var t=e.getPosition()-e.charOffset;this.handler.control.selection.deprecatedSetSelection(t,t+1,!1,-1,!0),this.handler.control.viewManager.selection.touchSelectionCircleElementsManager.setVisibilityTouchBars(!1)}beginDragExistingSelection(){var e=new eK(this.handler),t=new GG(this.handler,e);this.handler.switchState(t)}}class rK extends tK{constructor(e,t){super(e,500,(()=>{this.handler.boxVisualizerManager.resizeBoxVisualizer.isResizeBoxVisible()?this.beginDragExistingSelection():e.switchState(new iK(e,t))}))}onTouchStart(e){this.finish(),this.handler.switchState(new JG(this.handler,e))}onTouchEnd(e){this.handleTap(e),this.finish(),this.handler.switchToDefaultState()}}class iK extends tK{constructor(e,t){super(e,100,(()=>{this.handleTap(t),this.showPopupMenu(),this.finish(),this.handler.switchToDefaultState()}))}shouldChangeSelection(e){return!f.ListUtils.anyOf(this.handler.control.selection.intervals,((t,r)=>t.contains(e)))}}class nK extends XG{onTouchStart(e){let t=!1;for(let r,i=0;r=this.handler.control.selection.intervals[i];i++)if(this.isLeftOrRightEdge(e.layoutPoint,r)){t=!0;break}t&&this.handler.control.focusManager.isInFocus||this.handler.switchState(this.getNextState(e))}onTouchMove(e){return this.handler.switchState(this.getNextState(e)),!1}onTouchEnd(e){this.showPopupMenu(),this.handler.switchToDefaultState()}getNextState(e){var t=this.getLayoutPosition(this.handler.control.selection.intervals[0].start);if(this.canExtendSelection(e.layoutPoint,t))return new QG(this.handler);for(let r,i=0;r=this.handler.control.selection.intervals[i];i++)if(this.canExtendSelectionOnOneSide(e.layoutPoint,r))return new ZG(this.handler,this.isHitPoints(e.layoutPoint,t.getPositionRelativePage(this.handler.control.measurer),t.row.height));return new rK(this.handler,e)}canExtendSelection(e,t){return this.handler.control.focusManager.isInFocus&&this.handler.control.selection.isCollapsed()&&this.isHitPoints(e,t.getPositionRelativePage(this.handler.control.measurer),t.row.height)}canExtendSelectionOnOneSide(e,t){return this.handler.control.focusManager.isInFocus&&this.isLeftOrRightEdge(e,t)}getLayoutPosition(e){var t=this.handler.control.selection.activeSubDocument;return t.isMain()?ug.ensureLayoutPosition(this.handler.control.layoutFormatterManager,t,e,Hu.Character,(new cg).setDefault(this.handler.control.selection.endOfLine),(new cg).setDefault(!1)):new pg(this.handler.control.layout,t,e,this.handler.control.selection.pageIndex,Hu.Character).create((new cg).setDefault(this.handler.control.selection.endOfLine),(new cg).setDefault(!1))}isLeftOrRightEdge(e,t){var r=this.getLayoutPosition(t.start),i=this.getLayoutPosition(t.end);return this.isHitPoints(e,r.getPositionRelativePage(this.handler.control.measurer),r.row.height)||this.isHitPoints(e,i.getPositionRelativePage(this.handler.control.measurer),i.row.height)}isHitPoints(e,t,r){var i=Math.abs(e.x-t.x)<sK.TOUCH_RADIUS_HANDLE,n=!1;return n=e.y<t.y?Math.abs(e.y-t.y)<sK.TOUCH_RADIUS_HANDLE:e.y-t.y<sK.TOUCH_RADIUS_HANDLE+r,i&&n}}class oK extends XG{start(){this.resizeBoxHelper=new RG(this.handler.control,this.handler.boxVisualizerManager.resizeBoxVisualizer)}onTouchStart(e){this.resizeBoxHelper.start(e)}onTouchMove(e){return this.resizeBoxHelper.move(e),!1}onTouchEnd(e){this.resizeBoxHelper.end(e),this.handler.switchToDefaultState()}}class aK extends XG{onTouchStart(e){this.rotateBoxHelper=new BG(this.handler.control,this.handler.boxVisualizerManager.resizeBoxVisualizer),this.rotateBoxHelper.start(e)}onTouchMove(e){return this.rotateBoxHelper.move(e),!1}onTouchEnd(e){this.rotateBoxHelper.end(e),this.handler.switchToDefaultState()}}class sK extends XG{onTouchStart(e){let t=this.handler.control.selection.activeSubDocument;if(!(this.shouldProcessResizeBoxVisualizer(e)&&this.resizeRotationChecker((()=>{t.isTextBox()&&zG.selectParentsTextBox(this.handler.control),this.beginResizeBoxTouchHandler(e)}))||jX.shouldRotate(e,this.handler.control)&&this.resizeRotationChecker((()=>{t.isTextBox()&&zG.selectParentsTextBox(this.handler.control),this.handler.switchState(new aK(this.handler)),this.handler.state.onTouchStart(e)})))){var r=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,t);if(r.exactlyDetailLevel!=Hu.None){if(!jX.shouldHandleTextBoxAreaClick(e)&&t.isTextBox()&&(zG.changeActiveSubDocumentToParent(this.handler.control),r=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument)),r.floatingObject&&r.floatingObject.belongsToSubDocId==this.handler.control.selection.activeSubDocument.id){const i=r.floatingObject,n=this.handler.control.layout.anchorObjectsPositionInfo.getPosition(i.objectId),o=new on.FixedInterval(n,1),a=1==this.handler.control.selection.intervals.length&&this.handler.control.selection.intervals[0].equals(o);if(this.handler.control.selection.setSelection((new GX).setInterval(o)),i.getType()==lc.AnchorTextBox&&kX.isPointInTexBoxArea(e.layoutPoint,i,t.isTextBox()?0:i.rotationInRadians))this.handler.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToTextBox).execute(this.handler.control.commandManager.isPublicApiCall),this.handler.boxVisualizerManager.resizeBoxVisualizer.show(r.pageIndex,null,null,null,i),r=this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument);else{if(this.resizeRotationChecker((()=>{a&&(this.handler.switchState(new KG(this.handler)),this.handler.state.onTouchStart(e))})))return;{const e=this.handler.control.selection.specialRunInfo;if(e.isPictureSelected()&&e.isSelectedAnchorObject)return void this.handler.control.selection.setSelection((new GX).setInterval(new on.FixedInterval(e.getPicturePosition(),1)))}}}if(this.handler.control.selection.isCollapsed()||!this.isAreaToLeftOfText(r,e)&&!this.isAreaToRightOfText(r,e)){if(this.handler.control.modelManager.richOptions.fields.openHyperlinkOnClick){const t=this.handler.getHyperlinkFieldResult(e);if(t)return void(this.handler.control.clientSideEvents.raiseHyperlinkClick(e.mouseEvent,t)||this.handler.control.commandManager.getCommand(FF.OpenHyperlink).execute(this.handler.control.commandManager.isPublicApiCall,t))}this.handler.switchState(new nK(this.handler)),this.handler.state.onTouchStart(e)}else this.collapseSelection(r)}}}onTouchMove(e){return!0}onDoubleTap(e){this.handler.control.hitTestManager.calculate(e.layoutPoint,Hu.Max,this.handler.control.selection.activeSubDocument).exactlyDetailLevel>=Hu.Box?(this.handler.switchState(new JG(this.handler,e)),this.handler.control.popupMenuManager.rejectNextShowContextMenu()):this.handler.switchState(new $G(this.handler,e.layoutPoint))}shouldProcessResizeBoxVisualizer(e){return!(!this.handler.boxVisualizerManager.resizeBoxVisualizer.shouldCapture(e)||!this.handler.control.selection.activeSubDocument.isEditable([new on.FixedInterval(this.handler.control.selection.specialRunInfo.getPosition(),1)]))&&(this.beginResizeBoxTouchHandler(e),!0)}beginResizeBoxTouchHandler(e){this.handler.switchState(new oK(this.handler)),this.handler.state.onTouchStart(e)}isAreaToLeftOfText(e,t){return e.exactlyDetailLevel==Hu.PageArea&&e.deviations[Hu.Column]&Va.HitTestDeviation.Left&&t.layoutPoint.x<=e.pageArea.x+e.column.x}isAreaToRightOfText(e,t){return e.exactlyDetailLevel==Hu.PageArea&&e.deviations[Hu.Column]&Va.HitTestDeviation.Right&&t.layoutPoint.x>=e.pageArea.x+e.column.x+e.column.width}collapseSelection(e){var t=this.handler.control.selection,r=e.row.getLastVisibleBox().getEndPosition();t.deprecatedSetSelection(r,r,!1,-1,!0)}}sK.TOUCH_RADIUS_HANDLE=20;class lK extends nX{constructor(e,t){super(e,sK,t)}onTouchStart(e){this.state.onTouchStart(e)}onDoubleTap(e){this.state.onDoubleTap(e)}onTouchEnd(e){this.state.onTouchEnd(e)}onTouchMove(e){return this.state.onTouchMove(e)}onGestureStart(e){this.switchToDefaultState()}}class dK{static richMouseEvent(e){const t=[];return t.push(`absPoint: ${lg.point(e.absolutePoint)}`),t.push(`scroll: ${lg.point(e.scroll)}`),t.push(`layoutPoint: ${KV.layoutPoint(e.layoutPoint)}`),t.push(`modifiers: ${O.mask(KU.tx,e.modifiers,KU.tx.None)}`),t.push(`button: ${O.mask(WX,e.button,WX.None)}`),t.push(`middleButtonPressed: ${e.middleButtonPressed}`),t.push(`mouseEvent: ${e.mouseEvent}`),t.push(`source: ${HX[e.source]}`),t.join("\n")}}class cK{static modifyTextUnderCursor(e,t){const r=e.selection.activeSubDocument;let i=e.selection.lastSelectedInterval.start,n=hX.getLayoutWordStartBound(e.layout,r,e.selection,i);(r.isMain()?new ug(e.layout,r,n,Hu.Box):new pg(e.layout,r,n,e.selection.pageIndex,Hu.Box)).create((new cg).setDefault(e.selection.endOfLine),(new cg).setDefault(!1)).isLastBoxInRow()&&(n=hX.getLayoutWordStartBound(e.layout,r,e.selection,i-1));let o=hX.getLayoutWordEndBound(e.layout,r,e.selection,n,!1),a=new on.FixedInterval(n,o-n);const s=e.inputPosition.charPropsBundle;e.modelManager.history.beginTransaction(),e.modelManager.modelManipulator.range.removeInterval(new gu(r,a),!0,!1);const l=e.modelManager.modelManipulator.text.insertTextViaHistory(new op(new pu(r,a.start),s,cs.TextRun,t));e.modelManager.history.addAndRedo(new TU(e.modelManager.modelManipulator,e.selection,e.selection.getState(),e.selection.getState().setPosition(l.insertedInterval.end))),e.modelManager.history.endTransaction()}}!function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Middle=4]="Middle"}(WX||(WX={}));class hK{set mouseWheelEvent(e){this.mouseHandler.mouseWheelEvent=e,this.touchHandler.mouseWheelEvent=e}constructor(e,t){this.moveLocked=!1,this.shouldPreventContextMenuEvent=!0,this.accumulatedText="",this.accumulatedTextInsertId=null,this.accumulatedTextMaxLength=yH.Browser.Chrome?3:9,this.control=e,this.mouseHandler=new jG(e,t),this.touchHandler=new lK(e,t),this.inputTypeHandlers=this.createInputTypeHandlers()}dispose(){clearTimeout(this.accumulatedTextInsertId),clearTimeout(this.lockMouseMoveTimerId),clearTimeout(this.onMouseUpTimerId)}onShortcut(e){this.accumulatedText.length&&this.insertFunc(),this.control.shortcutManager.processShortcut(e),this.mouseHandler.onShortcut(e),I.Y.isAnyOf(e,KU.VD.Enter,KU.VD.Tab,KU.VD.Space)&&this.control.selection.lastSelectedInterval.start>0&&this.control.autoCorrectService.performAutoCorrect()}onMouseDown(e){O.print(L.EventManager,"onMouseDown",dK.richMouseEvent(e)),this.control.clientSideEvents.raisePointerDown(e.mouseEvent)||(this.lockMouseMove(),this.mouseHandler.onMouseDown(e))}onMouseMove(e){O.print(L.EventManager,"onMouseMove",dK.richMouseEvent(e)),this.moveLocked||this.mouseHandler.onMouseMove(e)}onMouseUp(e){O.print(L.EventManager,"onMouseUp",dK.richMouseEvent(e));let t=!1;e.layoutPoint&&(t=this.control.clientSideEvents.raisePointerUp(e.mouseEvent)),t||(this.lockMouseMove(),this.mouseHandler.onMouseUp(e),e.layoutPoint&&(yH.Browser.TouchUI&&this.control.inputController.setPosition(e.absolutePoint.x+2,e.absolutePoint.y+2),this.onMouseUpTimerId=setTimeout((()=>this.control.focusManager.captureFocus()),0)))}onTouchStart(e){O.print(L.EventManager,"onTouchStart",dK.richMouseEvent(e)),this.control.clientSideEvents.raisePointerDown(e.mouseEvent)||this.touchHandler.onTouchStart(e)}onTouchEnd(e){O.print(L.EventManager,"onTouchEnd",dK.richMouseEvent(e));let t=!1;e.layoutPoint&&(t=this.control.clientSideEvents.raisePointerUp(e.mouseEvent)),t||this.touchHandler.onTouchEnd(e)}onTouchMove(e){return O.print(L.EventManager,"onTouchMove",dK.richMouseEvent(e)),this.touchHandler.onTouchMove(e)}onDoubleTap(e){O.print(L.EventManager,"onDoubleTap",dK.richMouseEvent(e)),this.touchHandler.onDoubleTap(e)}onGestureStart(e){this.touchHandler.onGestureStart(e)}onMouseDblClick(e){O.print(L.EventManager,"onMouseDoubleClick",dK.richMouseEvent(e)),this.mouseHandler.onMouseDoubleClick(e),this.control.inputController.setPosition(e.absolutePoint.x,e.absolutePoint.y)}onMouseWheel(e){O.print(L.EventManager,"onMouseWheel",dK.richMouseEvent(e)),this.mouseHandler.onMouseWheel(e)}onText(e,t){t?this.modifyLastInsertedSymbol(e):null===this.control.commandManager.clipboardTimerId&&(this.accumulatedText+=e,this.accumulatedTextInsertId&&(clearTimeout(this.accumulatedTextInsertId),this.accumulatedTextInsertId=null),this.accumulatedText.length>this.accumulatedTextMaxLength?this.insertFunc():this.accumulatedTextInsertId=setTimeout((()=>this.insertFunc.apply(this)),1))}onTextReplace(e,t){null!=t?this.modifyLastText(e,t):cK.modifyTextUnderCursor(this.control,e)}modifyLastText(e,t){if(0===t)return rn.StringUtils.isNullOrEmpty(e)||(this.control.beginUpdate(),this.control.commandManager.getCommand(FF.InsertText).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,e)),this.control.endUpdate()),!0;let r=this.control.selection.lastSelectedInterval.start,i=r-t,n=new on.FixedInterval(i,r-i);const o=this.control.modelManager.modelManipulator.text.getLastModifiableHistoryItem((e=>e instanceof nm));if(!o)return!1;if(rn.StringUtils.isNullOrEmpty(e))this.control.modelManager.modelManipulator.range.removeIntervalInner(o.params.subDocPos.subDocument,n,!1);else{const t=this.control.modelManager.modelManipulator.text.getLastModifiableHistoryItem((e=>e instanceof TU));this.control.modelManager.modelManipulator.range.removeIntervalWithoutHistory(o.params.subDocPos.subDocument,n,!1),this.control.modelManager.modelManipulator.text.insertTextInner(new op(new pu(o.params.subDocPos.subDocument,n.start),o.params.charPropsBundle,cs.TextRun,e)),t.newState.intervalsInfo.intervals[0].start=i+e.length,o.params.text=e;var a=t.newState.intervalsInfo.intervals[0].start;this.control.selection.changeState((e=>e.setPosition(a))),this.control.commandManager.lastTextInsertDate=new Date(0)}return!0}modifyLastInsertedSymbol(e){if(1!==e.length)throw new Error(R.D.InternalException);const t=this.control.modelManager.modelManipulator.text.getLastModifiableHistoryItem((e=>e instanceof nm));if(!t)throw new Error(R.D.InternalException);const r=t.params.text.length;t.params.text=t.params.text.substr(0,r-1)+e,this.updateSymbol(t.params.subDocPos.subDocument,t.params.subDocPos.position+r-1,e)}updateSymbol(e,t,r){const i=new If,n=C.SearchUtils.normedInterpolationIndexOf(e.chunks,(e=>e.startLogPosition.value),t),o=e.chunks[n],a=t-o.startLogPosition.value,s=o.textBuffer.substr(a,1);return i.register(new yf(t,r)),o.textBuffer=o.textBuffer.substr(0,a)+r+o.textBuffer.substr(a+1),this.control.modelManager.modelManipulator.notifyModelChanged(new VI(e.id,i)),s}insertFunc(){const e=this.control.commandManager.getCommand(FF.InsertText).execute(this.control.commandManager.isPublicApiCall,this.accumulatedText);this.accumulatedText="",this.accumulatedTextInsertId=-1,e&&this.control.autoCorrectService.performAutoCorrect()}onFocusIn(){this.control.readOnly===RF.None&&(this.isFocused()||this.control.clientSideEvents.raiseGotFocus(),this.control.focusManager.isInFocus=!0)}onFocusOut(){this.isFocused()&&this.control.clientSideEvents.raiseLostFocus(),this.control.focusManager.isInFocus=!1}isFocused(){return this.control.focusManager.isInFocus}lockMouseMove(){this.moveLocked=!0,this.lockMouseMoveTimerId=setTimeout((()=>this.moveLocked=!1),0)}onInput(e){const t=this.inputTypeHandlers[e];if(!t)return!1;return this.control.commandManager.getCommand(t).execute(!1),!0}createInputTypeHandlers(){const e={};return e.insertParagraph=FF.InsertParagraph,e.deleteContentBackward=FF.ToggleBackspaceKey,e}}class uK{constructor(e,t,r,i,n){this.layoutPoint=t,this.absolutePoint=new Xc.Point(tX.g.getEventX(e),tX.g.getEventY(e)),this.scroll=new Xc.Point(n,i),this.modifiers=KU.LN.getKeyModifiers(e),this.button=this.isLeftButtonPressed(e)?WX.Left:WX.Right,this.middleButtonPressed=!!(e.buttons&WX.Middle),this.source=r,this.mouseEvent=e}isLeftButtonPressed(e){return yH.Browser.MSTouchUI?2!=e.button:tX.g.isLeftButtonPressed(e)}}class pK extends UX{baseFrameClassName(){return UX.CLASSNAMES.CONTAINER}static getCornerPrefix(){return UX.CLASSNAMES.CORNER_ELEM_PREFIX+(yH.Browser.TouchUI?UX.CLASSNAMES.CORNER_TOUCH_POSTFIX:"")}constructor(e,t,r,i){super(e,t,i),this.readOnlyPropertyHolder=r,this.initElement(!1)}initElement(e){e&&this.initFrameElement(),this.isReadOnly=this.readOnlyPropertyHolder.isReadOnlyPersistent;const t=pK.getCornerPrefix();f.ListUtils.forEach(pK.cornerLinesInfo,(e=>{const r=Yj.renderContainer(UX.CLASSNAMES.CORNER_LINE_PREFIX+e[0]);this.baseFrame.appendChild(r),this.isReadOnly?r.style.cursor="auto":f.ListUtils.forEach(e,(e=>{r.appendChild(Yj.renderContainer(t+e))}),1)})),this.isReadOnly||(this.baseFrame.appendChild(Yj.renderContainer(UX.CLASSNAMES.ROTATION_BOX)),this.baseFrame.appendChild(Yj.renderContainer(UX.CLASSNAMES.ROTATION_LINE)))}NotifyShow(e,t,r,i,n,o){this.readOnlyPropertyHolder.isReadOnlyPersistent!=this.isReadOnly&&this.initElement(!0),super.NotifyShow(e,t,r,i,n,o),this.setCursorsConsiderRotation(o)}setCursorsConsiderRotation(e){const t=pK.getCornerPrefix(),r=Math.round(180*e/Math.PI/45);this.baseFrame.querySelectorAll(`[class^=${UX.CLASSNAMES.CORNER_ELEM_PREFIX}]`).forEach((e=>{const i=e.className.substr(t.length),n=(pK.directions.indexOf(i)+r)%pK.directions.length;e.style.cursor=pK.cursorNames[n]}))}}pK.cornerLinesInfo=[["W","W"],["E","E"],["N","NW","N","NE"],["S","SW","S","SE"]],pK.directions=["N","NE","E","SE","S","SW","W","NW"],pK.cursorNames=["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],pK.directionToSource={NW:HX.ResizeBox_NW,NE:HX.ResizeBox_NE,SE:HX.ResizeBox_SE,SW:HX.ResizeBox_SW,N:HX.ResizeBox_N,E:HX.ResizeBox_E,S:HX.ResizeBox_S,W:HX.ResizeBox_W};class gK{static getClientWidth(e){const t=getComputedStyle(e),r=parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth)+parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),i=gK.getOffsetWidth(e)-r;return i-(Math.round(i)-e.clientWidth)}static getClientHeight(e){const t=getComputedStyle(e),r=parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth)+parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),i=gK.getOffsetHeight(e)-r;return i-(Math.round(i)-e.clientHeight)}static getOffsetSize(e){return e.getBoundingClientRect()}static getOffsetWidth(e){return gK.getOffsetSize(e).width}static getOffsetHeight(e){return gK.getOffsetSize(e).height}}const mK="dxreInFocus";class fK extends Lb.IS{get sizes(){return this.viewManager.sizes}get scroll(){return this.viewManager.scroll}get controlHeightProvider(){return this.sizes}constructor(e,t){super(),this.lastMousePosition={x:-1,y:-1},this.canvasPosition={x:-1,y:-1},this.pointer=VX.Auto,this.blockNotPointerEvents=!1,this.lastPointerPosition={x:-1,y:-1},this.evtHandlersHolder=new rX.$,this.viewManager=e,this.eventManager=t,this.initCommonEvents(),yH.Browser.WebKitTouchUI||this.initMouseEvents(),yH.Browser.TouchUI&&this.initTouchEvents(),yH.Browser.MSTouchUI&&(yH.Browser.MajorVersion>10?this.initPointerEvents():this.initMSPointerEvents())}get canvas(){return this.viewManager.canvas}dispose(){this.evtHandlersHolder.removeAllListeners()}onUpdateUnlocked(e){this.viewManager.canvasListener.updateVisibleParts()}setCursorPointer(e){if(O.print(L.CanvasManager,"setCursorPointer",(()=>`pointer: ${VX[e]}`)),this.pointer===e)return;this.pointer!==VX.Auto&&fn.DomUtils.removeClassName(this.viewManager.canvas,fK.getCursorClassName(this.pointer));const t=fK.getCursorClassName(e);t&&fn.DomUtils.addClassName(this.viewManager.canvas,t),this.pointer=e}closeDocument(){this.scroll.init(this.viewManager.canvas,this.sizes)}focusChanged(e){O.print(L.CanvasManager,"focusChanged",`to: ${e}`),e?fn.DomUtils.addClassName(this.viewManager.canvas,mK):fn.DomUtils.removeClassName(this.viewManager.canvas,mK)}getCanvasWidth(){return gK.getClientWidth(this.viewManager.canvas)}onCanvasMouseWheel(e){if(!this.viewManager.layout)return;const t=this.getLayoutPoint(e,!1);t.y+=e.deltaY,this.eventManager.mouseWheelEvent=!0,this.eventManager.onMouseMove(new uK(e,t,fK.getMouseEventSource(tX.g.getEventSource(e)),this.scroll.lastScrollTop,this.scroll.lastScrollLeft)),this.eventManager.mouseWheelEvent=!1,this.viewManager.canvasListener.updateVisibleParts()}onCanvasMouseDown(e){O.print(L.CanvasManager,"onCanvasMouseDown",`evt.button: ${e.button}, evt.buttons: ${e.buttons}`),this.blockNotPointerEvents||this.onCanvasMouseDownInternal(e),tX.g.preventEvent(e)}onCanvasMouseDownInternal(e){const t=this.getLayoutPoint(e,!0);this.eventManager.onMouseDown(new uK(e,t,fK.getMouseEventSource(tX.g.getEventSource(e)),this.scroll.lastScrollTop,this.scroll.lastScrollLeft)),this.saveMousePosition(e),this.resetScrollInterval(),this.canvasPosition.x=fn.DomUtils.getAbsolutePositionX(this.viewManager.canvas),this.canvasPosition.y=fn.DomUtils.getAbsolutePositionY(this.viewManager.canvas),t.isEmpty()||(this.scrollIntervalID=setInterval((()=>{this.onScrollIntervalTick()}),50))}onCanvasMouseUp(e){O.print(L.CanvasManager,"onCanvasMouseUp",""),this.blockNotPointerEvents||this.onCanvasMouseUpInternal(e)}onCanvasMouseUpInternal(e){this.eventManager.onMouseUp(new uK(e,this.getLayoutPoint(e,!1),fK.getMouseEventSource(tX.g.getEventSource(e)),this.scroll.lastScrollTop,this.scroll.lastScrollLeft)),this.resetScrollInterval()}onCanvasMouseMove(e){this.blockNotPointerEvents||this.onCanvasMouseMoveInternal(e)}onCanvasMouseMoveInternal(e){this.eventManager.onMouseMove(new uK(e,this.getLayoutPoint(e,!1),fK.getMouseEventSource(tX.g.getEventSource(e)),this.scroll.lastScrollTop,this.scroll.lastScrollLeft))}onCanvasMouseDblClick(e){return this.eventManager.onMouseDblClick(new uK(e,this.getLayoutPoint(e,!0),fK.getMouseEventSource(tX.g.getEventSource(e)),this.scroll.lastScrollTop,this.scroll.lastScrollLeft)),tX.g.preventEventAndBubble(e)}onCanvasTouchStart(e){return this.blockNotPointerEvents||this.onCanvasTouchStartInternal(e),!0}onCanvasTouchStartInternal(e){this.saveMousePosition(e);let t=new uK(e,this.getLayoutPoint(e,!0),fK.getMouseEventSource(tX.g.getEventSource(e)),this.scroll.lastScrollTop,this.scroll.lastScrollLeft);this.doubleTapStartDate&&new Date-this.doubleTapStartDate<600?(this.doubleTapStartDate=null,this.onCanvasDoubleTap(t)):(this.doubleTapStartDate=new Date,this.eventManager.onTouchStart(t))}onCanvasDoubleTap(e){this.eventManager.onDoubleTap(e)}onCanvasTouchEnd(e){this.blockNotPointerEvents||this.onCanvasTouchEndInternal(e),tX.g.preventEventAndBubble(e)}onCanvasTouchEndInternal(e){return this.eventManager.onTouchEnd(new uK(e,this.getLayoutPoint(e,!1),fK.getMouseEventSource(tX.g.getEventSource(e)),this.scroll.lastScrollTop,this.scroll.lastScrollLeft))}onCanvasTouchMove(e){return!!this.blockNotPointerEvents||this.onCanvasTouchMoveInternal(e)}onCanvasTouchMoveInternal(e){if(this.eventManager.onTouchMove(new uK(e,this.getLayoutPoint(e,!1),fK.getMouseEventSource(tX.g.getEventSource(e)),this.scroll.lastScrollTop,this.scroll.lastScrollLeft)))return!0;tX.g.preventEventAndBubble(e)}onCanvasPointerDown(e){"mouse"==e.pointerType?this.onCanvasMouseDownInternal(e):"touch"==e.pointerType&&this.onCanvasTouchStartInternal(e),this.blockNotPointerEvents=!0,this.lastPointerPosition.x=e.x,this.lastPointerPosition.y=e.y}onCanvasPointerMove(e){if(Math.abs(e.x-this.lastPointerPosition.x)>5||Math.abs(e.y-this.lastPointerPosition.y)>5){if("mouse"==e.pointerType)this.onCanvasMouseMoveInternal(e);else if("touch"==e.pointerType)return void this.onCanvasTouchMoveInternal(e);tX.g.preventEventAndBubble(e)}}onCanvasPointerUp(e){"mouse"==e.pointerType?this.onCanvasMouseUpInternal(e):"touch"==e.pointerType&&this.onCanvasTouchEndInternal(e),setTimeout((()=>{this.blockNotPointerEvents=!1}),0),tX.g.preventEventAndBubble(e)}onCanvasGestureStart(e){this.eventManager.onGestureStart(e)}onDocumentMouseUp(e){fn.DomUtils.isItParent(this.viewManager.canvas,tX.g.getEventSource(e))?(tX.g.isLeftButtonPressed(e)||this.eventManager.shouldPreventContextMenuEvent&&iX.y.preventContextMenu(e),this.onCanvasMouseUp(e)):(this.eventManager.onMouseUp(new uK(e,null,HX.Undefined,this.scroll.lastScrollTop,this.scroll.lastScrollLeft)),this.resetScrollInterval())}onDocumentContextMenu(e){if(this.viewManager.canvas.parentNode)return this.shouldPreventContextMenuEvent(e)&&this.eventManager.shouldPreventContextMenuEvent?(iX.y.preventContextMenu(e),tX.g.cancelBubble(e)):void 0}shouldPreventContextMenuEvent(e){const t=tX.g.getEventSource(e);return this.viewManager.control.isClientMode()?fn.DomUtils.isItParent(this.viewManager.canvas.parentNode,t):fn.DomUtils.isItParent(this.viewManager.canvas.parentNode.parentNode,t)}onDocumentMouseMove(e){this.saveMousePosition(e)}onDocumentTouchEnd(e){fn.DomUtils.isItParent(this.viewManager.canvas,tX.g.getEventSource(e))||(this.eventManager.onTouchEnd(new uK(e,null,HX.Undefined,this.scroll.lastScrollTop,this.scroll.lastScrollLeft)),this.resetScrollInterval())}onDocumentTouchMove(e){this.saveMousePosition(e)}getScale(e,t){return 0!=e&&0!=t?e/t:1}getLayoutPoint(e,t){if(!this.viewManager.layout)return zp.Empty();const r=this.viewManager.canvas,i=r.getBoundingClientRect(),n=this.getScale(i.width,r.offsetWidth),o=this.getScale(i.height,r.offsetHeight),a=tX.g.getEventX(e)/n,s=tX.g.getEventY(e)/o,l=fn.DomUtils.getAbsolutePositionX(r)/n,d=fn.DomUtils.getAbsolutePositionY(r)/o,c=r.scrollTop+s-d,h=this.sizes.findPageIndexByOffsetY(this.viewManager.layout.pages,c);if(t){if(this.sizes.scrollYVisible&&l+this.sizes.getVisibleAreaWidth(!1)-a<0)return zp.Empty();if(this.sizes.scrollXVisible&&d+this.sizes.getVisibleAreaHeight(!1)-s<0)return zp.Empty()}const u=this.viewManager.layout.pages[h],p=this.viewManager.cache[h];return u&&p?new zp(h,r.scrollLeft+a-(l+p.page.offsetLeft),c-this.sizes.getPageOffsetY(u)):zp.Empty()}isVisiblePosition(e){const t=this.viewManager.layout.pages;if(this.scroll.updatePageIndexesInfo(t),e.pageIndex<this.scroll.startVisiblePageIndex||e.pageIndex>this.scroll.endVisiblePageIndex)return!1;const r=this.sizes.getPageOffsetY(t[e.pageIndex]),i=this.viewManager.cache[e.pageIndex].page.offsetLeft+e.x,n=r+e.y;return i>=this.scroll.lastScrollLeft&&i<=this.sizes.getVisibleAreaWidth(!1)+this.scroll.lastScrollLeft&&n>=this.scroll.lastScrollTop&&n<=this.sizes.getVisibleAreaHeight(!1)+this.scroll.lastScrollTop}initCommonEvents(){this.evtHandlersHolder.addListener(this.viewManager.canvas,"scroll",(()=>this.viewManager.canvasListener.onCanvasScroll())),this.evtHandlersHolder.addListener(this.viewManager.canvas,"focus",(()=>this.viewManager.control.focusManager.captureFocus()))}initMouseEvents(){this.evtHandlersHolder.addListener(this.viewManager.canvas,"mousedown",this.onCanvasMouseDown.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"mousemove",this.onCanvasMouseMove.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"dblclick",this.onCanvasMouseDblClick.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,tX.g.getMouseWheelEventName(),this.onCanvasMouseWheel.bind(this),{passive:!0}),this.evtHandlersHolder.addListenerToDocument("mouseup",this.onDocumentMouseUp.bind(this)),this.evtHandlersHolder.addListenerToDocument("mousemove",this.onDocumentMouseMove.bind(this)),this.evtHandlersHolder.addListenerToDocument("contextmenu",this.onDocumentContextMenu.bind(this))}initTouchEvents(){this.evtHandlersHolder.addListener(this.viewManager.canvas,"touchstart",this.onCanvasTouchStart.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"touchend",this.onCanvasTouchEnd.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"touchmove",this.onCanvasTouchMove.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"gesturestart",this.onCanvasGestureStart.bind(this)),this.evtHandlersHolder.addListenerToDocument("touchend",this.onDocumentTouchEnd.bind(this)),this.evtHandlersHolder.addListenerToDocument("touchmove",this.onDocumentTouchMove.bind(this))}initPointerEvents(){this.evtHandlersHolder.addListener(this.viewManager.canvas,"pointerdown",this.onCanvasPointerDown.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"pointermove",this.onCanvasPointerMove.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"pointerup",this.onCanvasPointerUp.bind(this))}initMSPointerEvents(){this.evtHandlersHolder.addListener(this.viewManager.canvas,"mspointerdown",this.onCanvasPointerDown.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"mspointermove",this.onCanvasPointerMove.bind(this)),this.evtHandlersHolder.addListener(this.viewManager.canvas,"mspointerup",this.onCanvasPointerUp.bind(this))}resetScrollInterval(){this.scrollIntervalID&&(clearInterval(this.scrollIntervalID),this.scrollIntervalID=null)}saveMousePosition(e){this.lastMousePosition.x=tX.g.getEventX(e),this.lastMousePosition.y=tX.g.getEventY(e)}onScrollIntervalTick(){const e=this.lastMousePosition.x,t=this.lastMousePosition.y,r=e>=this.canvasPosition.x&&e<=this.canvasPosition.x+this.sizes.getVisibleAreaWidth(!0),i=t>=this.canvasPosition.y&&t<=this.canvasPosition.y+this.sizes.getVisibleAreaHeight(!0);(r||i)&&(r&&t-this.canvasPosition.y<=10?this.viewManager.canvas.scrollTop-=10:r&&this.canvasPosition.y+this.sizes.getVisibleAreaHeight(!0)-t<=10&&(this.viewManager.canvas.scrollTop+=10),i&&e-this.canvasPosition.x<=10?this.viewManager.canvas.scrollLeft-=10:i&&this.canvasPosition.x+this.sizes.getVisibleAreaWidth(!0)-e<=10&&(this.viewManager.canvas.scrollLeft+=10))}static getCursorClassName(e){switch(e){case VX.Copy:return"dxreCursorCopy";case VX.NoDrop:return"dxreCursorNoDrop";case VX.EResize:return"dxreCursorEResize";case VX.NResize:return"dxreCursorNResize";case VX.SResize:return"dxreCursorSResize";case VX.WResize:return"dxreCursorWResize";case VX.SEResize:return"dxreCursorSEResize";case VX.SWResize:return"dxreCursorSWResize";case VX.NWResize:return"dxreCursorNWResize";case VX.NEResize:return"dxreCursorNEResize";case VX.NSResize:return"dxreCursorNSResize";case VX.EWResize:return"dxreCursorEWResize";case VX.Move:case VX.Default:return"dxreCursorDefault"}}static getMouseEventSource(e){const t=(e.nodeType===Node.ELEMENT_NODE?e:e.parentNode).className,r=pK.getCornerPrefix(),i=t.indexOf(r);return 0!=i?HX.Undefined:pK.directionToSource[t.substr(i+r.length,2).trim()]}getScrollTopInfo(){const e=this.viewManager.layout.pages,t=this.viewManager.canvas.scrollTop,r=this.sizes.findPageIndexByOffsetY(e,t);return new bK(r,t-this.sizes.getPageOffsetY(e[r]))}}class bK{constructor(e,t){this.pageIndex=e,this.topPositionRelativePage=t}}class CK{constructor(e,t,r){this.lastScrollTop=-1,this.lastScrollLeft=-1,this.startVisiblePageIndex=0,this.endVisiblePageIndex=0,this._needUpdatePageIndexes=!1,this.internalApi=r,this.init(e,t)}init(e,t){this.canvas=e,this.sizes=t,this.renderPagesOffset=yH.Browser.TouchUI?CK.VISIBLE_PAGES_RANGE_TOUCH:CK.VISIBLE_PAGES_RANGE}getStartRenderPageIndex(){return Math.max(0,this.startVisiblePageIndex-this.renderPagesOffset)}getEndRenderPageIndex(){return this.endVisiblePageIndex+this.renderPagesOffset}renderPageIndexInterval(){return on.FixedInterval.fromPositions(this.getStartRenderPageIndex(),this.getEndRenderPageIndex()+1)}updatePageIndexesInfo(e){if(!e.length)return;const t=this.getScrollTop();this.lastScrollLeft=this.canvas.scrollLeft,this.startVisiblePageIndex>=0&&t==this.lastScrollTop&&!this._needUpdatePageIndexes||(this._needUpdatePageIndexes=!1,this.startVisiblePageIndex=this.sizes.findPageIndexByOffsetY(e,t),this.endVisiblePageIndex=this.sizes.findPageIndexByOffsetY(e,t+this.getVisibleHeight()),this.lastScrollTop=t)}getVisibleInterval(){const e=this.getScrollTop(),t=this.getVisibleHeight(),r=new on.FixedInterval(e,t),i=r.length*CK.VISIBLE_AREA_HEIGHT_MULTIPLIER;return Cn.e.makeByConstInterval(new on.FixedInterval(Math.max(0,r.center-Math.floor(i/2)),i))}getScrollTop(){return this.canvas.scrollTop+(this.internalApi.getVerticalScrollOffset?this.internalApi.getVerticalScrollOffset():0)}getVisibleHeight(){return this.internalApi.getVisibleAreaHeight?this.internalApi.getVisibleAreaHeight():this.sizes.getVisibleAreaHeight(!1)}onCanvasSizeChanged(){this._needUpdatePageIndexes=!0}}CK.VISIBLE_PAGES_RANGE=2,CK.VISIBLE_PAGES_RANGE_TOUCH=0,CK.VISIBLE_AREA_HEIGHT_MULTIPLIER=2;class SK{get canvas(){return this.viewManager.canvas}get sizes(){return this.viewManager.sizes}constructor(e,t){this.updateScrollTimeoutId=null,this.waitForDblClickTimeoutId=null,this.viewManager=e,this.horizontalRuler=t}dispose(){clearTimeout(this.updateScrollTimeoutId),clearTimeout(this.waitForDblClickTimeoutId)}get scrollTop(){return this.canvas.scrollTop}set scrollTop(e){this.canvas.scrollTop=e}setScrollEnabled(e){this.canvas.style.overflow=e?"":"hidden",this.updateScrollVisibility()}updateScrollVisibility(){this.scrollMeasurer||(this.scrollMeasurer=document.createElement("div"),this.scrollMeasurer.style.position="absolute",this.scrollMeasurer.style.top="0",this.scrollMeasurer.style.bottom="0",this.scrollMeasurer.style.right="0",this.scrollMeasurer.style.left="0"),this.canvas.appendChild(this.scrollMeasurer);const e=this.sizes.scrollYVisible;this.sizes.updateScrollVisibility(this.scrollMeasurer.offsetWidth,this.scrollMeasurer.offsetHeight),this.canvas.removeChild(this.scrollMeasurer),e!==this.sizes.scrollYVisible&&this.horizontalRuler&&this.horizontalRuler.adjust()}scrollToX(e){const t=e.lp,r=e.relativePosition;let i=this.sizes.getPageOffsetY(this.viewManager.layout.pages[t.pageIndex]),n=0;if(t.detailsLevel>=Hu.PageArea?(i+=t.pageArea.y,t.detailsLevel>=Hu.Column?(i+=t.column.y,t.detailsLevel>=Hu.Row?(i+=t.row.y,r===eE.Bottom?i+=t.row.height:r===eE.Inside&&(n=t.row.height)):r===eE.Bottom?i+=t.column.height:r===eE.Inside&&(n=t.column.height)):r===eE.Bottom?i+=t.pageArea.height:r===eE.Inside&&(n=t.pageArea.height)):r===eE.Bottom?i+=t.page.height:r===eE.Inside&&(n=t.page.height),r===eE.Bottom&&(i-=this.sizes.getVisibleAreaHeight(!1)),i+=e.getVerticalOffset(this.sizes),r===eE.Inside){let e=this.canvas.scrollTop;const t=this.sizes.getVisibleAreaHeight(!1);i<e?this.canvas.scrollTop=i:i+n>t+e&&(this.canvas.scrollTop=i+n-t)}else this.canvas.scrollTop=i}NotifyScrollPositionChanged(e){this.updateScrollTimeoutId&&(clearTimeout(this.updateScrollTimeoutId),this.updateScrollTimeoutId=null),this.waitForDblClickTimeoutId>0?this.updateScrollTimeoutId=setTimeout((()=>{this.scrollToX(e)}),jG.WAIT_FOR_DBLCLICK_INTERVAL):this.scrollToX(e)}waitForDblClick(){this.waitForDblClickTimeoutId&&clearTimeout(this.waitForDblClickTimeoutId),this.waitForDblClickTimeoutId=setTimeout((()=>{this.waitForDblClickTimeoutId=null}),jG.WAIT_FOR_DBLCLICK_INTERVAL)}}class IK{constructor(){this.topSpacing=-1,this.betweenPageSpacing=1,this.visibleAreaSize=new so.Size(-1,-1),this.scrollWidth=-1,this.pageVerticalInfo=new Fj,this.scrollWidth=fn.DomUtils.getVerticalScrollBarWidth()}isInitialized(){return this.topSpacing>=0}initialize(e,t){this.pageVerticalInfo.init(fn.DomUtils.getCurrentStyle(e)),this.topSpacing=this.pageVerticalInfo.topPageBorderWidth+this.pageVerticalInfo.topMargin,this.betweenPageSpacing=this.pageVerticalInfo.betweenPageSpacing,this.setVisibleAreaSize(t.offsetWidth,t.offsetHeight)}findPageIndexByOffsetY(e,t){return Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e,(e=>this.getPageOffsetY(e)),t))}getPageOffsetY(e){return e.y+(this.topSpacing+e.index*this.betweenPageSpacing)}setVisibleAreaSize(e,t){this.visibleAreaSize.width=e,this.visibleAreaSize.height=t}getVisibleAreaWidth(e){return e?this.visibleAreaSize.width:this.scrollYVisible?this.visibleAreaSize.width-this.scrollWidth:this.visibleAreaSize.width}getVisibleAreaHeight(e){return e?this.visibleAreaSize.height:this.scrollXVisible?this.visibleAreaSize.height-this.scrollWidth:this.visibleAreaSize.height}updateScrollVisibility(e,t){this.scrollXVisible=t<this.visibleAreaSize.height,this.scrollYVisible=e<this.visibleAreaSize.width}isChanged(e){return this.visibleAreaSize.width!==e.offsetWidth||this.visibleAreaSize.height!==e.offsetHeight}}var PK;!function(e){e[e.None=0]="None",e[e.TableBounds=1]="TableBounds",e[e.LayoutBounds=2]="LayoutBounds"}(PK||(PK={}));class wK{static showPageVisibleInfoElement(e,t,r){wK.createAtLeast(r);let i=wK.pageVisibleInfoElements[r];i.innerHTML=t(),fn.DomUtils.hideNode(i),Yj.getServiceContainerCore(e[r].page).appendChild(i)}static hidePageVisibleInfoElement(e){const t=wK.pageVisibleInfoElements[e];t&&(wK.pageVisibleInfoElements.splice(e,1),fn.DomUtils.hideNode(t))}static createAtLeast(e){for(;wK.pageVisibleInfoElements.length<=e;)wK.pageVisibleInfoElements.push(wK.createPageVisibleInfoElement())}static createPageVisibleInfoElement(){const e=Yj.renderContainer("dxre-debug-page-visible-info-element");return e.style.left="5px",e.style.top="5px",e.style.width="150px",e.style.height="50px",e.style.zIndex="100",e}}wK.pageVisibleInfoElements=[];class yK{get layout(){return this.viewManager.layout}constructor(e,t){this.viewManager=e,this.renderer=t}closeDocument(){}static mergeInnerPageChanges(e){e.mainPageAreaChanges=(new ZV).merge(e.mainPageAreaChanges);for(let t of e.mainPageAreaChanges){t.columnChanges=(new eW).merge(t.columnChanges);for(let e of t.columnChanges)e.rowChanges=(new tW).merge(e.rowChanges),e.tableChanges=(new rW).merge(e.tableChanges),e.paragraphFrameChanges=(new iW).merge(e.paragraphFrameChanges)}}}class xK extends yK{constructor(e,t){super(e,t),this.handledPageIndexes=[]}onPagesReady(e){const t=[],r=[];for(let i of e)i.changeType==wV.Updated?t.push(i):r.push(i);if(O.print(L.CanvasManager,"onPagesReady - handled pages",sg.level_1((e=>`${e}`),this.handledPageIndexes,"\t","\t")),O.print(L.CanvasManager,"onPagesReady - pageFlags\n",sg.level_1((e=>`${O.mask(Wu,e.flags.getValue())}`),this.viewManager.layout.pages,"\t","\n")),r.length>0){for(let e of r){const t=e.index,r=this.viewManager.layout.pages[t];switch(e.changeType){case wV.Inserted:this.viewManager.renderer.renderPage(r,t,!1),r.flags.set(Wu.ContentRendered,!1),this.viewManager.adjust(!1);break;case wV.Deleted:this.renderer.removePage(t);break;case wV.Replaced:r.flags.get(Wu.ContentRendered)&&r.flags.set(Wu.NeedDeleteContent,!0),this.renderer.renderPage(r,t,!1),r.flags.set(Wu.ContentRendered,!1);break;default:throw new Error(R.D.NotImplemented)}}this.updateVisiblePages(),this.viewManager.canvasScrollManager.updateScrollVisibility()}for(let e of t){const t=this.layout.pages[e.index];t.flags.get(Wu.ContentRendered)&&(yK.mergeInnerPageChanges(e),this.renderer.applyPageChange(t,e),this.viewManager.changeActiveSubDocumentRenderer.updatePage(this.viewManager.selection.layoutSelection,t.index))}this.handleDeferredPagesOperations(),this.viewManager.lastUsedRendererType=kV.PrintLayout,O.print(L.DiplayPageInfo,"",(()=>f.ListUtils.map(e,(e=>{e.changeType==wV.Deleted?wK.hidePageVisibleInfoElement(e.index):wK.showPageVisibleInfoElement(this.viewManager.cache,(()=>`pageIndex=${e.index}`),e.index)})))),O.print(L.DiplayTableBoundsInfo,"",(()=>f.ListUtils.map(e,(e=>{e.changeType==wV.Deleted?O.paramsHolder.visualizerManager.hide(PK.TableBounds,e.index):O.paramsHolder.visualizerManager.show(PK.TableBounds,this.layout,e.index)})))),O.print(L.DiplayLayoutBoundsInfo,"",(()=>f.ListUtils.map(e,(e=>{e.changeType==wV.Deleted?O.paramsHolder.visualizerManager.hide(PK.LayoutBounds,e.index):O.paramsHolder.visualizerManager.show(PK.LayoutBounds,this.layout,e.index)}))))}updateVisiblePages(){const e=this.layout.pages;this.viewManager.scroll.updatePageIndexesInfo(e);const t=this.viewManager.scroll.renderPageIndexInterval();for(let r of this.handledPageIndexes)if(!t.contains(r)){const t=e[r];t&&(t.flags.set(Wu.NeedDeleteContent,!0),t.flags.set(Wu.MustBeRendered,!1))}const r=Math.min(t.end-1,this.layout.pages.length-1);for(let i=t.start;i<=r;i++){const t=e[i];t.flags.get(Wu.ContentRendered)||(t.flags.set(Wu.NeedRenderContent,!0),t.flags.set(Wu.MustBeRendered,!0),this.handledPageIndexes.push(i))}}handleDeferredPagesOperations(){const e=this.layout.pages,t=[];this.handledPageIndexes.sort(Qe.Comparers.number);let r=-1;for(let i of this.handledPageIndexes){if(i==r)continue;const n=e[i];n&&(this.handlePageFlags(n),n.flags.get(Wu.MustBeRendered)&&t.push(i),r=i)}this.handledPageIndexes=t}handlePageFlags(e){const t=e.flags.get(Wu.NeedDeleteContent);if(e.index>=this.layout.validPageCount)return void(t&&(O.print(L.CanvasManager,"handleDeferredPagesOperations",`pageIndex: ${e.index} content deleted`),this.renderer.renderPage(e,e.index,!1),e.flags.set(Wu.ContentRendered,!1),e.flags.set(Wu.NeedDeleteContent,!1),e.flags.set(Wu.IsSelectionRendered,!1),e.flags.set(Wu.IsMisspelledSelectionRendered,!1)));const r=e.flags.get(Wu.ContentRendered),i=e.flags.get(Wu.NeedRenderContent),n=t||i;n&&(O.print(L.CanvasManager,"handlePageFlags",`pageIndex: ${e.index} content ${i?"rendered":"deleted"}`),this.renderer.renderPage(e,e.index,i),this.viewManager.changeActiveSubDocumentRenderer.updatePage(this.viewManager.selection.layoutSelection,e.index)),e.flags.set(Wu.ContentRendered,i||!n&&r),e.flags.set(Wu.NeedDeleteContent,!1),e.flags.set(Wu.NeedRenderContent,!1),n&&(e.flags.set(Wu.IsSelectionRendered,!1),e.flags.set(Wu.IsMisspelledSelectionRendered,!1))}updateVisibleParts(){this.updateVisiblePages(),this.handleDeferredPagesOperations()}onCanvasScroll(){this.updateVisibleParts();for(let e of this.handledPageIndexes)this.viewManager.selection.renderAllPageSelection(this.layout,e,!1),this.viewManager.searchSelection.renderAllPageSelection(this.layout,e,!1),this.viewManager.misspelledSelection.renderAllPageSelection(this.layout,e,!1),this.viewManager.rangePermission.renderAllPageSelection(this.layout,e,!1)}}class TK{constructor(e,t,r){this.rows=e,this.tables=t,this.parFrames=r}}class vK extends TK{constructor(e,t,r,i,n){super(e,t,r),this.ancPictureObjs=i,this.ancTextBoxObjs=n}}class MK extends vK{}class EK extends vK{}class DK extends yK{onPagesReady(e){if(e.length>1&&!f.ListUtils.allOf(e,(e=>e.changeType==wV.Deleted),1))throw new Error(R.D.InternalException);if(this.layout.pages.length>1)throw new Error(R.D.InternalException);const t=e[0];if(t){const e=this.layout.pages[0];switch(t.changeType){case wV.Inserted:this.viewManager.sizes.isInitialized()||(this.renderer.renderPage(e,0,!1),this.viewManager.adjust(!1)),this.renderer.pageInserted(e,this.getCurrentIndexes());break;case wV.Replaced:this.renderer.removePageContent(0),this.renderer.renderPage(e,0,!1),this.viewManager.adjust(!1),this.renderer.pageInserted(e,this.getCurrentIndexes());break;case wV.Updated:yK.mergeInnerPageChanges(t),this.renderer.pageUpdated(t,this.getCurrentIndexes());break;case wV.Deleted:this.renderer.removePage(0)}}this.viewManager.lastUsedRendererType=kV.Simple}getCurrentIndexes(){const e=this.layout.pages[0],t=this.viewManager.scroll.getVisibleInterval(),r=e.mainSubDocumentPageAreas[0].columns[0],i=r.rows,n=this.determineVisibleObjectsForRows(i,t),o=this.determineVisibleObjectsForTables(r.tablesInfo,t),a=this.determineVisibleObjects(r.paragraphFrames,t),s=b.j.reducedMap(e.anchoredObjectHolder.objects,((e,r)=>e.getType()==lc.AnchorPicture&&nn.IntervalAlgorithms.getIntersectionNonNullLength(e.createVerticalInterval(),t)?e:null)),l=b.j.reducedMap(e.anchoredObjectHolder.objects,((e,r)=>e.getType()==lc.AnchorTextBox&&nn.IntervalAlgorithms.getIntersectionNonNullLength(e.createVerticalInterval(),t)?e:null));return new MK(n,o,a,s,l)}determineVisibleObjects(e,t){if(!e.length)return new Cn.e(-1,-1);const r=Math.max(0,f.ListUtils.reverseIndexBy(e,(e=>!nn.IntervalAlgorithms.getIntersection(e.createVerticalInterval(),t)),C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.y),t.start)-1));let i=Math.max(r,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.y),t.end));for(let r;r=e[i];i++)if(!nn.IntervalAlgorithms.getIntersection(r.createVerticalInterval(),t)){i++;break}return new Cn.e(r,i)}determineVisibleObjectsForTables(e,t){if(!e.length)return new Cn.e(-1,-1);let r=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.y),t.start));for(let i;(i=e[r])&&(i.logicInfo.grid.table.nestedLevel||nn.IntervalAlgorithms.getIntersection(i.createVerticalInterval(),t));r--);r=Math.max(0,r);const i=this.findBoundaryMinIndex(r,e,t);return new Cn.e(r,i)}findBoundaryMinIndex(e,t,r){let i=Math.max(e,C.SearchUtils.normedInterpolationIndexOf(t,(e=>e.y),r.end));for(let e;e=t[i];i++)if(!nn.IntervalAlgorithms.getIntersection(e.createVerticalInterval(),r)){i++;break}return i}determineVisibleObjectsForRows(e,t){if(!e.length)return new Cn.e(-1,-1);const r=Math.max(0,f.ListUtils.reverseIndexBy(e,(e=>e.bottom<t.start&&!e.tableCellInfo),C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.y),t.start)-1));let i=Math.max(r,C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.y),t.end));for(let r;r=e[i];i++)if(r.y>t.end&&!r.tableCellInfo){i++;break}return new Cn.e(r,i)}updateVisibleParts(){this.layout.pages.length&&this.renderer.pageScrolled(this.layout.pages[0],this.getCurrentIndexes())}onCanvasScroll(){this.updateVisibleParts()}}class FK{constructor(e){this.renderer=e,this.init()}init(){this.pageIndex=-2,this.subDocumentInfo=null,this.handledPages={}}update(e,t){this.innerUpdate(e,t,(()=>{const e=this.renderer.scroll.renderPageIndexInterval(),t=this.pageIndex==this.newPageIndex&&this.subDocumentInfo.subDocumentId==this.newSubDocumentInfo.subDocumentId?this.handledPages:{};this.handledPages={},b.j.forEach(t,(t=>{e.contains(t)||this.handlePageHide(t)||(this.handledPages[t]=t)})),f.ListUtils.forEachOnInterval(e,(e=>{void 0===t[e]&&this.handlePageRender(e,!1)&&(this.handledPages[e]=e)}))}))}updatePage(e,t,r){this.innerUpdate(t,r,(()=>{this.handlePageRender(e,!0)&&(this.handledPages[e]=e)}))}innerUpdate(e,t,r){e&&(this.newSubDocumentInfo=e,this.newPageIndex=t,r(),this.subDocumentInfo=e,this.pageIndex=t)}isHeaderFooterActive(e){if(this.newSubDocumentInfo.isHeaderFooter)return!0;if(!this.newSubDocumentInfo.isTextBox)return!1;const t=this.newSubDocumentInfo.parentSubDocumentId,r=e.otherPageAreas[t];return r&&r.subDocument.isHeaderFooter()}}class RK extends FK{handlePageHide(e){return!0}handlePageRender(e,t){const r=this.renderer.cache[e],i=this.renderer.layout.pages[e];if(!r||!i)return!1;const n=this.newSubDocumentInfo.subDocumentId;return b.j.forEach(r.anchoredPicture,((e,t)=>{const r=i.anchoredObjectHolder.getObjById(t).belongsToSubDocId;r==n||this.newSubDocumentInfo.isTextBox&&this.newSubDocumentInfo.parentSubDocumentId==r?fn.DomUtils.removeClassName(e,Gj.BLACKOUT):fn.DomUtils.addClassName(e,Gj.BLACKOUT)})),!0}}class LK extends FK{constructor(e,t){super(e),this.stringResources=t,this.elementsMap={}}handlePageHide(e){const t=this.elementsMap[e];return t&&(t.hide(),delete this.elementsMap[e]),!0}handlePageRender(e,t){const r=this.renderer.layout.pages[e],i=this.renderer.cache[e];if(!i||!r)return!1;const n=r.getLayoutOtherPageAreasInfo(),o=this.getDocumentModel();if(!o)return!1;let a=this.elementsMap[e],s=!0;if(this.isHeaderFooterActive(r))if(!a||t){const t=Yj.getServiceContainerCore(i.page),a=Ch.getPageSectionIndex(r,o.sections),l=o.sections[a],d=this.getInfoTexts(a,l,r,n,o),c=this.elementsMap[e]=new AK;s=!1,this.updateElementInfo(d.headerInfo,t,r.mainSubDocumentPageAreas[0],c.headerInfoElement,LK.getHeaderInfoTopPosition),this.updateElementInfo(d.footerInfo,t,f.ListUtils.last(r.mainSubDocumentPageAreas),c.footerInfoElement,LK.getFooterInfoTopPosition)}else a=null;return a&&(a.hide(),s&&delete this.elementsMap[e]),!0}getDocumentModel(){const e=this.renderer.layout.pages[0];if(!e)return null;const t=e.mainSubDocumentPageAreas[0]||b.j.anyOf(e.otherPageAreas,(e=>e));return t?t.subDocument.documentModel:null}getInfoTexts(e,t,r,i,n){const o=new BK;if(t.sectionProperties.differentFirstPage&&r.flags.get(Wu.IsFirstPageOfSection)?(o.headerInfo.push(this.stringResources.firstPageHeader),o.footerInfo.push(this.stringResources.firstPageFooter)):n.differentOddAndEvenPages?(0,S.isEven)(r.layoutPageIndex)?(o.headerInfo.push(this.stringResources.evenPageHeader),o.footerInfo.push(this.stringResources.evenPageFooter)):(o.headerInfo.push(this.stringResources.oddPageHeader),o.footerInfo.push(this.stringResources.oddPageFooter)):(o.headerInfo.push(this.stringResources.header),o.footerInfo.push(this.stringResources.footer)),n.sections.length>1){const t=` -Section ${e+1}-`;o.headerInfo[0]+=t,o.footerInfo[0]+=t}return i.headerPageArea&&t.headers.isLinkedToPrevious(i.headerPageArea.subDocument.info.headerFooterType)&&o.headerInfo.push(this.stringResources.sameAsPrevious),i.footerPageArea&&t.footers.isLinkedToPrevious(i.footerPageArea.subDocument.info.headerFooterType)&&o.footerInfo.push(this.stringResources.sameAsPrevious),o}updateElementInfo(e,t,r,i,n){if(!r)return;const o=e[1];i.innerHTML=`<b>${e[0]}</b>${o?`<b>${o}</b>`:""}`,t.appendChild(i),i.style.top=n(r,i)+"px"}static getHeaderInfoTopPosition(e,t){return e.y+1}static getFooterInfoTopPosition(e,t){return e.bottom-t.offsetHeight-1}}class BK{constructor(){this.headerInfo=[],this.footerInfo=[]}}class AK{constructor(){this.headerInfoElement=Yj.renderContainer(Gj.HEADER_INFO),this.footerInfoElement=Yj.renderContainer(Gj.FOOTER_INFO)}hide(){fn.DomUtils.hideNode(this.headerInfoElement),fn.DomUtils.hideNode(this.footerInfoElement)}}class NK extends FK{handlePageHide(e){return!0}activateElement(e){return!!e&&(fn.DomUtils.removeClassName(e,Gj.BLACKOUT),!0)}deactivateElement(e){fn.DomUtils.addClassName(e,Gj.BLACKOUT)}}class kK extends NK{handlePageRender(e,t){const r=this.renderer.cache[e],i=this.renderer.layout.pages[e];if(!r||!i)return!1;b.j.forEach(r.otherAreas,((e,t)=>{const r=i.otherPageAreas[t];r&&r.subDocument.isHeaderFooter()&&(this.isHeaderFooterActive(i)?this.activateElement(e):this.deactivateElement(e))}))}}class OK extends NK{handlePageRender(e,t){const r=this.renderer.cache[e];return r&&this.applyToMainPageAreas(r,this.isActive()?this.activateElement:this.deactivateElement)}applyToMainPageAreas(e,t){if(!Yj.isPageElementConsiderAllContainers(e.page))return!1;const r=Yj.getMainPageAreaContainerCore(e.page).childNodes;for(let e,i=0;e=r[i];i++)t.call(this,e);return!0}isActive(){return!!this.newSubDocumentInfo.isMain||!!this.newSubDocumentInfo.isTextBox&&0==this.newSubDocumentInfo.parentSubDocumentId}}class _K extends FK{handlePageHide(e){return!0}handlePageRender(e){const t=this.renderer.cache[e],r=this.renderer.layout.pages[e];if(!t||!r)return!1;const i=this.newSubDocumentInfo.subDocumentId;return b.j.forEach(t.otherAreas,((e,n)=>{const o=r.anchoredObjectHolder.getTextBoxByInternalSubDocId(n);if(o){const a=n==i,s=t.textBoxBgElements[n],l=r.renderLevelCalculator.getRenderLevel(r.anchoredObjectHolder.getTextBoxByInternalSubDocId(n).rendererLevel);a?(0==o.rotationInRadians?fn.DomUtils.removeClassName(e,qj.getClassName(l,Kj.TextBox)):fn.DomUtils.addClassName(e,qj.getClassName(l,Kj.TextBox)),fn.DomUtils.addClassName(e,Gj.SELECTED_TEXTBOX),fn.DomUtils.addClassName(s,Gj.SELECTED_TEXTBOX)):(fn.DomUtils.removeClassName(e,Gj.SELECTED_TEXTBOX),fn.DomUtils.removeClassName(s,Gj.SELECTED_TEXTBOX),fn.DomUtils.addClassName(e,qj.getClassName(l,Kj.TextBox))),a||o.belongsToSubDocId==i||this.newSubDocumentInfo.isTextBox&&this.newSubDocumentInfo.parentSubDocumentId==o.belongsToSubDocId?fn.DomUtils.removeClassName(e,Gj.BLACKOUT):fn.DomUtils.addClassName(e,Gj.BLACKOUT)}})),!0}}class UK{get cache(){return this.viewManager.cache}get canvas(){return this.viewManager.canvas}get layout(){return this.viewManager.layout}get scroll(){return this.viewManager.scroll}get canvasScrollManager(){return this.viewManager.canvasScrollManager}constructor(e,t){this.viewManager=e,this.renderers=[new RK(this),new _K(this),new kK(this),new OK(this),new LK(this,t.headerFooter)]}init(){for(let e of this.renderers)e.init()}update(e){const t=e.pageIndex,r=e.subDocumentInfo;for(let e of this.renderers)e.update(r,t)}updatePage(e,t){const r=e.pageIndex,i=e.subDocumentInfo;for(let e of this.renderers)e.updatePage(t,i,r)}}class HK extends Yj{renderPageContentGetFloatingObjects(e){return e.anchoredObjectHolder.getObjectsForRenderer(this.viewManager.layout.anchorObjectsPositionInfo)}}var VK=__webpack_require__(448);class WK extends Yj{constructor(){super(...arguments),this.rowIndexInterval=new Cn.e(0,0),this.paragraphFramesIndexInterval=new Cn.e(0,0),this.tableIndexInterval=new Cn.e(0,0),this.updateDataChunk=new MK(new on.FixedInterval(0,0),new on.FixedInterval(0,0),new on.FixedInterval(0,0),{},{})}pageInserted(e,t){this.updateDataChunk=t,this.renderPage(e,0,!0)}renderPageContentGetFloatingObjects(e){const t=b.j.shallowCopy(this.updateDataChunk.ancPictureObjs);return b.j.forEach(this.updateDataChunk.ancTextBoxObjs,((e,r)=>t[r]=e)),e.anchoredObjectHolder.getObjectsForRenderer(this.viewManager.layout.anchorObjectsPositionInfo,t)}collectScrollChanges(e,t,r,i){const n=[],o=new VK.SparseIntervals(nn.IntervalAlgorithms.getMergedIntervalsTemplate([e,t],!0,new Cn.e(0,0))).getNativeIterator();for(let a=0;o.moveNext();)if(e.contains(o.index))if(t.contains(o.index))r&&n.push(new i(o.index,a,wV.Updated)),a++;else if(o.index<t.start)n.push(new i(o.index,a,wV.Deleted));else do{n.push(new i(o.index,t.length,wV.Deleted))}while(o.moveNext());else n.push(new i(o.index,a++,wV.Inserted));return n}collectScrollChangesMap(e,t,r,i,n){let o=[];b.j.forEach(e,(e=>o.push(e.objectId))),b.j.forEach(t,(e=>o.push(e.objectId))),o=f.ListUtils.uniqueNumber(o);const a=[];return f.ListUtils.forEach(o,(o=>{void 0!==e[o]?void 0!==t[o]?r&&a.push(new n(i?t[o].internalSubDocId:o,wV.Updated)):a.push(new n(i?e[o].internalSubDocId:o,wV.Deleted)):a.push(new n(i?t[o].internalSubDocId:o,wV.Inserted))})),a}collectAllScrollChanges(e,t){return new EK(this.collectScrollChanges(this.updateDataChunk.rows,e.rows,t,jV),this.collectScrollChanges(this.updateDataChunk.tables,e.tables,t,XV),this.collectScrollChanges(this.updateDataChunk.parFrames,e.parFrames,t,GV),this.collectScrollChangesMap(this.updateDataChunk.ancPictureObjs,e.ancPictureObjs,t,!1,HV),this.collectScrollChangesMap(this.updateDataChunk.ancTextBoxObjs,e.ancTextBoxObjs,t,!0,$V))}pageScrolled(e,t){const r=this.collectAllScrollChanges(t,!1),i=this.makePageChange(r);O.print(L.SimpleViewRenderer,"mergedPageChanges - Changes\n",sg.level_1((e=>KV.pageChange(e,"")),[i],"","\n")),this.applyPageChange(e,i),this.updateDataChunk=t}applyFormatterChanges(e,t){if(!t.length||!e.length)return;const r=f.ListUtils.minMaxExtended(t,(e=>e.layoutIndex)),i=new Cn.e(r.minValue,r.maxValue+1),n=f.ListUtils.accumulate(e,{},((e,t)=>(t.changeType==wV.Replaced&&i.contains(t.layoutIndex)&&(e[t.layoutIndex]=!0),e)));for(let e of t)n[e.layoutIndex]&&e.changeType!=wV.Inserted&&(e.changeType=wV.Replaced)}applyFormatterChangesMap(e,t){const r=f.ListUtils.accumulate(t,{},((e,t)=>(e[t.layoutIndex]=t,e)));f.ListUtils.forEach(e,(e=>{const t=r[e.layoutIndex];t&&!I.Y.isAnyOf(t.changeType,wV.Deleted,wV.Inserted)&&t&&t.changeType!=wV.Deleted&&(t.changeType=wV.Replaced),e.changeType==wV.Updated&&e instanceof $V&&t&&t instanceof $V&&t.changeType==wV.Updated&&(t.columnChanges=e.columnChanges)}))}makePageChange(e){const t=[new qV(0,wV.Updated,e.rows,e.tables,e.parFrames)],r=[new $V(0,wV.Updated,t)],i=new JV(0,wV.Updated,r,e.ancTextBoxObjs);return i.anchoredPictureChanges=e.ancPictureObjs,i}pageUpdated(e,t){const r=this.collectAllScrollChanges(t,!0);e.mainPageAreaChanges.length&&(this.applyFormatterChanges(e.mainPageAreaChanges[0].columnChanges[0].rowChanges,r.rows),this.applyFormatterChanges(e.mainPageAreaChanges[0].columnChanges[0].paragraphFrameChanges,r.parFrames),this.applyFormatterChanges(e.mainPageAreaChanges[0].columnChanges[0].tableChanges,r.tables)),this.applyFormatterChangesMap(e.anchoredPictureChanges,r.ancPictureObjs),this.applyFormatterChangesMap(e.otherPageAreaChanges,r.ancTextBoxObjs);const i=this.makePageChange(r);O.print(L.SimpleViewRenderer,"mergedPageChanges - Changes\n",sg.level_1((e=>KV.pageChange(e,"")),[i],"","\n")),this.applyPageChange(this.viewManager.layout.pages[0],i),this.updateDataChunk=t}renderColumn(e,t,r){const i=Yj.renderContainer(Gj.COLUMN);fn.DomUtils.setStyleSizeAndPosition(i.style,e);const n=i.appendChild(Yj.renderContainer(Gj.ROWS_CONTAINER)),o=i.appendChild(Yj.renderContainer(Gj.PARAGRAPHFRAMES_CONTAINER)),a=i.appendChild(Yj.renderContainer(Gj.TABLES_CONTAINER)),s=r?this.updateDataChunk:new TK(new Cn.e(0,e.rows.length),new Cn.e(0,e.tablesInfo.length),new Cn.e(0,e.paragraphFrames.length));return f.ListUtils.forEach(e.rows,(e=>n.appendChild(this.renderRow(e,t))),s.rows.start,s.rows.end),f.ListUtils.forEach(e.paragraphFrames,(e=>o.appendChild(Yj.renderParagraphFrame(e,t))),s.parFrames.start,s.parFrames.end),f.ListUtils.forEach(e.tablesInfo,(e=>a.appendChild(Yj.renderTable(e,t,this.viewManager.innerClientProperties.showTableGridLines))),s.tables.start,s.tables.end),i}updatePageSize(e,t){if(e.minContentHeight<e.height){const r=this.viewManager.canvas.offsetHeight;t.style.height=`${e.minContentHeight}px`,this.viewManager.canvas.offsetHeight<r&&(e.height=e.minContentHeight)}super.updatePageSize(e,t)}}class zK extends Va.Rectangle{constructor(){super(0,0,0,0)}isCursor(){return!1}get zIndexClassType(){return Kj.SelRow}get baseClassName(){return Gj.SELECTION_ROW}static create(e,t,r,i){const n=new i;return n.floatingObjectId=r,n.setPosition(new Xc.Point(e.pageArea.x+e.column.x+e.row.x,e.pageArea.y+e.column.y+e.row.y)).setSize(t)}equals(e){return this.floatingObjectId==e.floatingObjectId&&super.equals(e)}}zK.mainPageAreaSelection=-1,zK.headerFooterPageAreaSelection=-2;class jK extends zK{isCursor(){return!0}get zIndexClassType(){return Kj.SelCursor}get baseClassName(){return[Gj.SELECTION_CURSOR,Gj.CURSOR_NO_BLINK_CLASS_NAME].join(" ")}}class XK extends zK{get zIndexClassType(){return Kj.SelRow}get baseClassName(){return[Gj.SELECTION_ROW,Gj.SELECTION_FLOATING_OBJECTS].join(" ")}}class GK{constructor(e,t){this.cache=e,this.layoutSelection=t}closeDocument(){}applySelectionChanges(e){for(let t of this.getLayoutSelectionInfo().changes){const r=e.pages[t.index];if(r&&r.flags.get(Wu.ContentRendered)){r.flags.set(this.layoutPageFlag,!0);for(let e of t.areaChanges)Yj.applyChange(this.cache[t.index].page,e,this.getContainer,(()=>this.renderItem(e.selection,r)))}}this.getLayoutSelectionInfo().changesApplied()}renderAllPageSelection(e,t,r){const i=this.cache[t];if(!i)return;const n=this.getContainer(i.page),o=this.getLayoutSelectionInfo().pageInfos[t],a=e.pages[t];if(n&&(r||0==n.childNodes.length)&&o&&a){a.flags.set(this.layoutPageFlag,!0),r&&fn.DomUtils.clearInnerHtml(n);for(let e of o.oldItems)n.appendChild(this.renderItem(e,a))}}renderItem(e,t){const r=t.anchoredObjectHolder;let i;switch(e.floatingObjectId){case zK.mainPageAreaSelection:i=t.renderLevelCalculator.renderMainPageAreaLevel;break;case zK.headerFooterPageAreaSelection:i=t.renderLevelCalculator.renderHeaderFooterPageAreasLevel;break;default:i=t.renderLevelCalculator.getRenderLevel(r.getObjById(e.floatingObjectId).rendererLevel)}const n=Yj.renderContainer(e.baseClassName+" "+qj.getClassName(i,e.zIndexClassType));return fn.DomUtils.setStyleSizeAndPosition(n.style,e),n}}class KK extends GK{constructor(){super(...arguments),this.layoutPageFlag=Wu.IsMisspelledSelectionRendered}renderAllPageSelection(e,t,r){super.renderAllPageSelection(e,t,r),O.print(L.SelectionRenderer,"renderAllPageMisspelledSelection",`pageIndex: ${t}`)}closeDocument(){this.getLayoutSelectionInfo().reset()}getLayoutSelectionInfo(){return this.layoutSelection.misspelledInfo}getContainer(e){return Yj.getMisspelledSelectionContainerCore(e)}}class qK extends GK{constructor(){super(...arguments),this.layoutPageFlag=Wu.IsRangePermissionsRendered}renderAllPageSelection(e,t,r){super.renderAllPageSelection(e,t,r),O.print(L.SelectionRenderer,"renderAllPageRangePermissions",`pageIndex: ${t}`)}renderItem(e,t){const r=super.renderItem(e,t);return r.style.backgroundColor=e.color,r}closeDocument(){this.getLayoutSelectionInfo().reset()}getLayoutSelectionInfo(){return this.layoutSelection.rangePermissionInfo}getContainer(e){return Yj.getRangePermissionsContainerCore(e)}}class $K extends GK{constructor(){super(...arguments),this.layoutPageFlag=Wu.IsSearchSelectionRendered}renderAllPageSelection(e,t,r){super.renderAllPageSelection(e,t,r),O.print(L.SelectionRenderer,"renderAllPageSearchSelection",`pageIndex: ${t}`)}closeDocument(){this.getLayoutSelectionInfo().reset()}getLayoutSelectionInfo(){return this.layoutSelection.searchInfo}getContainer(e){return Yj.getSearchSelectionContainerCore(e)}}class JK{constructor(e,t){this.firstElement=Yj.renderContainer(JK.BAR_CLASS_NAME),this.secondElement=Yj.renderContainer(JK.BAR_CLASS_NAME),this.layoutSelection=t,this.cache=e}getSecondElement(){return this.secondElement}update(){if(!yH.Browser.TouchUI||this.layoutSelection.firstPageIndexWithSelection<0||!this.cache.length)return;if(!this.isCreated()){let e=Yj.getServiceContainerCore(this.cache[this.layoutSelection.firstPageIndexWithSelection].page);e.appendChild(this.firstElement),e.appendChild(this.secondElement),this.radius=this.firstElement.offsetWidth/2}const e=this.layoutSelection.selectionInfo.pageInfos[this.layoutSelection.firstPageIndexWithSelection].oldItems[0];fn.DomUtils.setStylePosition(this.firstElement.style,new Xc.Point(e.x-this.radius,e.bottom));const t=f.ListUtils.last(this.layoutSelection.selectionInfo.pageInfos[this.layoutSelection.lastPageIndexWithSelection].oldItems);fn.DomUtils.setStylePosition(this.secondElement.style,new Xc.Point(t.right-this.radius,t.bottom))}setVisibilityTouchBars(e){this.setFirstTouchBarVisibility(e),this.setSecondTouchBarVisibility(e)}setFirstTouchBarVisibility(e){this.setVisible(this.firstElement,e)}setSecondTouchBarVisibility(e){this.setVisible(this.secondElement,e)}setVisible(e,t){this.isElementVisible(e)!=t&&(e.style.display=t?"":"none")}isElementVisible(e){return"none"!=e.style.display}isCreated(){let e=Yj.getServiceContainerCore(this.cache[this.layoutSelection.firstPageIndexWithSelection].page);return!!fn.DomUtils.getChildNodesByClassName(e,JK.BAR_CLASS_NAME).length}}JK.BAR_CLASS_NAME="dxreSelBar";class YK extends GK{constructor(e,t){super(e,t),this.layoutPageFlag=Wu.IsSelectionRendered,this.processIdChangeCursorToBlink=null,this.touchSelectionCircleElementsManager=new JK(e,t)}dispose(){clearTimeout(this.processIdChangeCursorToBlink)}applySelectionChanges(e){this.switchCursorToBlinkState(),super.applySelectionChanges(e),this.touchSelectionCircleElementsManager.update()}renderAllPageSelection(e,t,r){this.switchCursorToBlinkState(),super.renderAllPageSelection(e,t,r),O.print(L.SelectionRenderer,"renderAllPageSelection",`pageIndex: ${t}`),this.touchSelectionCircleElementsManager.update()}closeDocument(){this.switchCursorToBlinkState(),this.getLayoutSelectionInfo().reset(),this.layoutSelection.pageIndex=-1,this.layoutSelection.subDocumentInfo=null}renderItem(e,t){if(e instanceof XK){const t=Yj.renderContainer(e.baseClassName);return fn.DomUtils.setStyleSizeAndPosition(t.style,e),t}const r=super.renderItem(e,t);return e.isCursor()&&(this.processIdChangeCursorToBlink=setTimeout((()=>{fn.DomUtils.removeClassName(r,Gj.CURSOR_NO_BLINK_CLASS_NAME),this.processIdChangeCursorToBlink=null}),350)),r}getLayoutSelectionInfo(){return this.layoutSelection.selectionInfo}getContainer(e){return Yj.getSelectionContainerCore(e)}switchCursorToBlinkState(){null===this.processIdChangeCursorToBlink&&(clearTimeout(this.processIdChangeCursorToBlink),this.processIdChangeCursorToBlink=null)}}class QK{get renderer(){return this.renderers[this.innerClientProperties.viewsSettings.viewType]}get printLayoutRenderer(){return this.renderers[kV.PrintLayout]}get canvasListener(){return this.canvasListeners[this.innerClientProperties.viewsSettings.viewType]}constructor(e,t,r,i,n,o,a,s,l,d,c){this.cache=[],this.sizes=new IK,this.control=e,this.readOnlyPropertyHolder=s,this.layoutFormatterManagerHolder=l,this.internalApi=d,this.fieldOptions=c,this.canvas=t,this.stringResources=i,this.inputController=o,this.innerClientProperties=a,this.addTopLevelContainers(),this.canvasManager=new fK(this,r),this.scroll=new CK(t,this.sizes,this.internalApi),this.canvasScrollManager=new SK(this,n),this.renderers=(new Eu).add(kV.PrintLayout,new HK(this)).add(kV.Simple,new WK(this)).get(),this.canvasListeners=(new Eu).add(kV.PrintLayout,new xK(this,this.renderers[kV.PrintLayout])).add(kV.Simple,new DK(this,this.renderers[kV.Simple])).get();const h=null;this.selection=new YK(this.cache,h),this.searchSelection=new $K(this.cache,h),this.misspelledSelection=new KK(this.cache,h),this.rangePermission=new qK(this.cache,h),this.changeActiveSubDocumentRenderer=new UK(this,i)}dispose(){this.canvasManager.dispose(),this.canvasScrollManager.dispose(),this.selection.dispose(),this.pagesContainer=null}adjust(e){if((e||!this.sizes.isInitialized())&&this.cache.length>0){const t=Math.min(this.cache.length,Math.max(0,f.ListUtils.indexBy(this.layout.pages,(e=>e.flags.get(Wu.ContentRendered)))));this.sizes.initialize(this.cache[t].page,this.canvas);const r=this.innerClientProperties.viewsSettings.pageVerticalInfo.clone();if(this.innerClientProperties.viewsSettings.pageVerticalInfo.copyFrom(this.sizes.pageVerticalInfo),this.innerClientProperties.viewsSettings.isSimpleView&&!this.innerClientProperties.viewsSettings.pageVerticalInfo.equals(r)){const e=this.layout.pages[t];this.layoutFormatterManagerHolder.layoutFormatterManager&&e&&this.layoutFormatterManagerHolder.layoutFormatterManager.invalidator.onChangedAllLayout()}e&&(this.canvasScrollManager.updateScrollVisibility(),this.canvasListener.onCanvasScroll())}else if(this.sizes.isChanged(this.canvas)){const e=gK.getOffsetSize(this.canvas);this.sizes.setVisibleAreaSize(e.width,e.height),this.scroll.onCanvasSizeChanged()}}NotifyPagesReady(e){this.canvasListener.onPagesReady(e)}NotifyFullyFormatted(e){}NotifySelectionLayoutChanged(){const e=this.selection.layoutSelection;this.changeActiveSubDocumentRenderer.update(e),O.print(L.CanvasManager,"onSelectionLayoutChanged\n",sg.level_1(O.w(2,O.flip(KV.pageSelectionChange,0,1))(""),this.selection.layoutSelection.selectionInfo.changes,"","\n")),this.innerClientProperties.viewsSettings.isSimpleView?this.selection.renderAllPageSelection(this.layout,0,!0):this.selection.applySelectionChanges(this.layout);const t=f.ListUtils.reverseIndexBy(e.selectionInfo.pageInfos,(e=>e.oldItems.length>0));if(t>-1){const r=e.selectionInfo.pageInfos[t].oldItems[0],i=this.layout.pages[t];this.inputController.setPosition(i.x+this.cache[t].page.offsetLeft+r.x,this.sizes.getPageOffsetY(i)+r.y)}}NotifySearchSelectionLayoutChanged(){O.print(L.CanvasManager,"onSearchSelectionLayoutChanged\n",sg.level_1(O.w(2,O.flip(KV.pageSelectionChange,0,1))(""),this.selection.layoutSelection.searchInfo.changes,"","\n")),this.innerClientProperties.viewsSettings.isSimpleView?this.searchSelection.renderAllPageSelection(this.layout,0,!0):this.searchSelection.applySelectionChanges(this.layout)}NotifyMisspelledSelectionLayoutChanged(){O.print(L.CanvasManager,"onMisspelledSelectionLayoutChanged\n",sg.level_1(O.w(2,O.flip(KV.pageSelectionChange,0,1))(""),this.selection.layoutSelection.misspelledInfo.changes,"","\n")),this.innerClientProperties.viewsSettings.isSimpleView?this.misspelledSelection.renderAllPageSelection(this.layout,0,!0):this.misspelledSelection.applySelectionChanges(this.layout)}NotifyRangePermissionLayoutChanged(){O.print(L.CanvasManager,"onRangePermissionsLayoutChanged\n",sg.level_1(O.w(2,O.flip(KV.pageSelectionChange,0,1))(""),this.selection.layoutSelection.rangePermissionInfo.changes,"","\n")),this.innerClientProperties.viewsSettings.isSimpleView?this.rangePermission.renderAllPageSelection(this.layout,0,!0):this.rangePermission.applySelectionChanges(this.layout)}addTopLevelContainers(){this.pagesContainer=Yj.renderContainer(Gj.PAGES),this.serviceContainer=Yj.renderContainer(Gj.TOP_LEVEL_SERVICE_CONTAINER),Yj.insertInContainer(this.canvas,0,this.pagesContainer,(e=>e)),this.canvas.appendChild(this.serviceContainer)}setWorkSession(e,t,r){this.layout=e,this.imageCache=r,this.changeActiveSubDocumentRenderer.init(),this.selection.layoutSelection=t,this.searchSelection.layoutSelection=t,this.misspelledSelection.layoutSelection=t,this.rangePermission.layoutSelection=t,this.selection.touchSelectionCircleElementsManager.layoutSelection=t}closeDocument(){fn.DomUtils.clearInnerHtml(this.pagesContainer),this.cache.splice(0),this.canvasManager.closeDocument(),this.selection.closeDocument(),this.searchSelection.closeDocument(),this.misspelledSelection.closeDocument(),this.rangePermission.closeDocument(),b.j.forEach(this.canvasListeners,(e=>e.closeDocument())),this.layout.setEmptyLayout(y.NO_COLOR)}ensureFirstPageIsRendered(){var e,t;const r=null===(t=null===(e=this.layout)||void 0===e?void 0:e.pages)||void 0===t?void 0:t[0];r&&(this.lastUsedRendererType!==kV.PrintLayout||r.flags.get(Wu.ContentRendered)||(this.printLayoutRenderer.renderPage(r,r.index,!0),this.changeActiveSubDocumentRenderer.updatePage(this.searchSelection.layoutSelection,r.index),r.flags.set(Wu.ContentRendered,!0)))}}class ZK{constructor(e){this.owner=e}raiseHyperlinkClick(e,t){return this.owner.raiseHyperlinkClick(e,t)}raiseKeyDown(e){return this.owner.raiseKeyDown(e)}raiseKeyUp(e){this.owner.raiseKeyUp(e)}raisePointerDown(e){return this.owner.raisePointerDown(e)}raisePointerUp(e){return this.owner.raisePointerUp(e)}raiseContentInserted(e,t){this.owner.raiseContentInserted(e,t)}raiseContentRemoved(e,t,r){this.owner.raiseContentRemoved(e,t,r)}raiseCharacterPropertiesChanged(e,t){this.owner.raiseCharacterPropertiesChanged(e,t)}raiseParagraphPropertiesChanged(e,t){this.owner.raiseParagraphPropertiesChanged(e,t)}raiseAutoCorrect(e,t){return this.owner.raiseAutoCorrect(e,t)}raiseDocumentChanged(){this.owner.raiseDocumentChanged()}raiseDocumentFormatted(e){this.owner.raiseDocumentFormatted(e)}raiseActiveSubDocumentChanged(){this.owner.raiseActiveSubDocumentChanged()}raiseSelectionChanged(){this.owner.raiseSelectionChanged()}raiseDocumentLoaded(){this.owner.raiseDocumentLoaded()}raiseGotFocus(){this.owner.raiseGotFocus()}raiseLostFocus(){this.owner.raiseLostFocus()}raiseHorizontalRulerVisibleChanged(e){this.owner.raiseHorizontalRulerVisibleChanged(e)}}class eq{static findTocFieldBySelection(e,t){const r=e.fields;if(!r.length)return null;let i,n=!1,o=t.intervals[0].clone();if(t.isCollapsed()){o.length++;const t=Md.normedBinaryIndexOf(r,o.start);if(t<0)return null;i=r[t];do{n=this.isTocField(e,i)}while(!n&&(i=i.parent))}else{let t=Math.max(0,Md.normedBinaryIndexOf(r,o.start));for(i=r[t].getAbsolutelyTopLevelField(),t=i.index;(i=r[t])&&!(n=this.isTocField(e,i)||i.getFieldStartPosition()>=o.end);t++);}return n&&nn.IntervalAlgorithms.getIntersectionNonNullLength(i.getAllFieldInterval(),o)?i:null}static isTocField(e,t){const r=new jh(e,!0);return r.setPosition(t.getCodeStartPosition()),Jg.findName(r).fieldName==Jg.TOC_NAME}}class tq extends EU{canModify(){return!0}static updateFields(e,t,r,i){return e.history.beginTransaction(),e.control.beginUpdate(),e.modelManipulator.field.updateFields(e.control.layoutFormatterManager,e.control.createFieldRequestManager(),new Sb(t,(t=>{e.control.endUpdate(),e.history.endTransaction(),r&&r(t)}),i))}}class rq{constructor(e,t,r){this.options=new $g,this.subDocument=e,this.intervals=t,this.callbackFunc=r}}class iq extends tq{getState(){var e=new UU(this.isEnabled());return e.visible=yb.showUpdateAndToogleCodeItems(this.selection.activeSubDocument.fields,this.selection.intervals),e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)}executeCore(e,t){let r=t.param;if(!r){let e=this.selection.intervals,t=null;const i=eq.findTocFieldBySelection(this.selection.activeSubDocument,this.selection);i&&(e=nn.IntervalAlgorithms.getMergedIntervals(e.concat(i.getAllFieldInterval()),!0),t=()=>{this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(i.getFieldStartPosition())))}),r=new rq(this.selection.activeSubDocument,e,t)}const i=this.selection.getFloatingState();return tq.updateFields(this,[new mu(r.subDocument,r.intervals)],(()=>{const e=i.finalize();this.selection.setState(e),r.callbackFunc&&r.callbackFunc()}),r.options)}}class nq{constructor(e,t,r,i){this.canvasManager=e,this.owner=t,this.inputController=r,this.eventManager=i}set isInFocus(e){this.isFocus!==e&&(this.isFocus=e,this.canvasManager.focusChanged(e))}get isInFocus(){return this.isFocus}captureFocus(){this.owner.canCaptureFocus()&&(this.owner.onCaptureFocus(),this.inputController.captureFocus(),this.eventManager.onFocusIn())}}var oq;!function(e){e[e.None=0]="None",e[e.DocumentLoaded=1]="DocumentLoaded",e[e.ModelChanged=2]="ModelChanged",e[e.SelectionChanged=3]="SelectionChanged",e[e.DocumentFormatted=4]="DocumentFormatted"}(oq||(oq={}));class aq{constructor(e,t,r){this.type=e,this.action=t,this.change=r}}class sq extends Lb.IS{constructor(e,t){super(),this.deferredEvents=[],this.locked=!1,this.rich=e,this.onModelChanged=t}addDeferredEvent(e,t,r=oq.None){this.rich.commandManager.isPublicApiCall&&!this.rich.modelManager.richOptions.control.raiseClientEventsOnModificationsViaAPI||(this.deferredEvents.push(new aq(r,e,t)),this.handleDeferredEvents())}isCharacterPropertiesChangedType(e){return e==pd.CharacterPropertiesChanged||e==pd.CharacterFormattingChanged}equals(e,t){if(!e||!t)return!1;if(this.isCharacterPropertiesChangedType(e.type)&&this.isCharacterPropertiesChangedType(t.type)){const r=e,i=t;return r.subDocumentId==i.subDocumentId&&r.newState.interval.equals(i.newState.interval)}return!1}handleDeferredEvents(){if(!this.isLocked()&&(!this.rich.commandManager.isPublicApiCall||this.rich.modelManager.richOptions.control.raiseClientEventsOnModificationsViaAPI)){const e=[],t=[];let r=null;if(this.deferredEvents=f.ListUtils.reducedMap(this.deferredEvents,(i=>{if(i.type==oq.None){const e=i.change;if(e){if(this.isCharacterPropertiesChangedType(e.type)){if(!(f.ListUtils.indexBy(t,(e=>this.equals(e.change,i.change)))<0))return null;t.push(i)}if(e instanceof nb){if(this.tryAppendInsertingEvent(r,e))return null;r=i}}return i}return e.push(i),null})),f.ListUtils.addListOnTail(this.deferredEvents,f.ListUtils.unique(e,((e,t)=>e.type-t.type))),!this.locked){this.locked=!0;for(let e;e=this.deferredEvents.shift();)e.action();this.locked=!1}}}tryAppendInsertingEvent(e,t){if(e){const r=e.change;if(r.canContinuesWith(t))return r.length+=t.length,e.action=()=>this.rich.clientSideEvents.raiseContentInserted(r.subDocumentId,new on.FixedInterval(r.position,r.length)),!0}return!1}onUpdateUnlocked(e){this.handleDeferredEvents()}processModelChanged(){this.addDeferredEvent((()=>this.onModelChanged()),null,oq.ModelChanged)}NotifyDocumentLoaded(){this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseDocumentLoaded()),null,oq.DocumentLoaded)}NotifyPagesReady(e){}NotifyFullyFormatted(e){this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseDocumentFormatted(e)),null,oq.DocumentFormatted)}NotifySelectionChanged(e){e.prevState.intervalsInfo.subDocument!=e.currState.intervalsInfo.subDocument&&this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseActiveSubDocumentChanged()),null,oq.SelectionChanged),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseSelectionChanged()),null,oq.SelectionChanged)}NotifyScrollPositionChanged(){}modelChanged(e){switch(e.type){case pd.PageColor:case pd.DefaultTabWidth:case pd.DifferentOddAndEvenPages:case pd.HeaderFooterIndexChanged:case pd.SectionFormattingChanged:case pd.AbstractNumberingListAdded:case pd.AbstractNumberingListDeleted:case pd.NumberingListAdded:case pd.NumberingListDeleted:case pd.ListLevelPropertyChanged:case pd.ListLevelParagraphPropertyChanged:case pd.ListLevelCharacterPropertyChanged:case pd.IOverrideListLevelChanged:case pd.BookmarkCreated:case pd.BookmarkDeleted:case pd.TabInserted:case pd.TabDeleted:case pd.LoadPicturesInfo:case pd.InlinePicturesUpdated:case pd.AnchoredPictureSizeChanged:case pd.InlineObjectRunPropertyChanged:case pd.FieldInserted:case pd.FieldDeleted:case pd.HyperlinkInfoChanged:case pd.FieldsShowCodeChanged:case pd.TextBufferChanged:case pd.ParagraphAndCharacterMergedPropertiesReset:case pd.AnchoredTextBoxSizeChanged:case pd.AnchoredTextBoxPropertiesChanged:case pd.AnchorInfoPropertyChanged:case pd.ShapeChanged:case pd.ShapePropertyChanged:case pd.CreateStyleLink:case pd.DeleteStyleLink:case pd.CharacterStyleApplied:case pd.ParagraphStyleApplied:case pd.TableStyleChanged:case pd.ParagraphNumberingListChanged:case pd.TableCreated:case pd.TableStartPositionShifted:case pd.TableCellPropertyChanged:case pd.TablePropertyChanged:case pd.TableRowPropertyChanged:case pd.TableCellSplittedHorizontally:case pd.TableCellMergedHorizontally:case pd.TableRowInserted:case pd.TableRowRemoved:case pd.TableCellRemoved:case pd.TableCellInserted:this.processModelChanged();break;case pd.SectionMerged:this.processModelChanged(),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseContentRemoved(uu.MAIN_SUBDOCUMENT_ID,e.removedInterval,an.specialCharacters.SectionMark)),e);break;case pd.ParagraphMerged:this.processModelChanged(),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseContentRemoved(e.subDocumentId,e.removedInterval,an.specialCharacters.ParagraphMark)),e);break;case pd.HeaderFooterCreated:case pd.InlinePictureInserted:case pd.AnchoredPictureInserted:case pd.ParagraphInserted:case pd.SectionInserted:case pd.AnchoredTextBoxInserted:this.processModelChanged(),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseContentInserted(e.subDocumentId,new on.FixedInterval(e.position,1))),e);break;case pd.SimpleRunInserted:this.processModelChanged(),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseContentInserted(e.subDocumentId,new on.FixedInterval(e.position,e.length))),e);break;case pd.AnchorObjectRemoved:break;case pd.IntervalRemoved:this.processModelChanged(),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseContentRemoved(e.subDocumentId,e.interval,e.removedText)),e);break;case pd.CharacterFormattingChanged:case pd.CharacterPropertiesChanged:this.processModelChanged(),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseCharacterPropertiesChanged(e.subDocumentId,e.newState.interval)),e);break;case pd.ParagraphFormattingChanged:{this.processModelChanged();const t=this.rich.modelManager.model.subDocuments[e.subDocumentId].getParagraphsIndices(e.newState.interval);for(let r=t.start;r<t.end;r++){const t=r;this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseParagraphPropertiesChanged(e.subDocumentId,t)),e)}break}case pd.ParagraphPropertiesChanged:this.processModelChanged(),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseParagraphPropertiesChanged(e.subDocumentId,e.paragraphIndex)),e);break;case pd.TableRemoved:this.processModelChanged(),this.addDeferredEvent((()=>this.rich.clientSideEvents.raiseContentRemoved(e.subDocumentId,on.FixedInterval.fromPositions(e.startPosition,e.endPosition),e.removedText)),e);break;case pd.DocumentProtectionChanged:case pd.RangePermissionsChanged:case pd.RangePermissionsPropertiesChanged:this.processModelChanged()}}}var lq=__webpack_require__(8475);class dq{constructor(e){this.control=e,this.processed=!1}insert(e){const t=lq.F.getPlainTextItem(e.clipboardData.items),r=lq.F.getRtfTextItem(e.clipboardData.items),i=lq.F.getTransferItemByType(e.clipboardData.items,Ru.HtmlMimeType);if(r)return this.loadingPanelManager=this.control.loadingPanelManager.loadingPanel.showPanelDelayed(400),tX.g.preventEvent(e),r&&this.insertClipboardRtf(r),i&&this.insertClipboardHtml(i),!0;if(!t){const t=lq.F.getImageItem(e.clipboardData.items);if(t)return tX.g.preventEvent(e),this.insertClipboardPicture(t),!0}return!1}insertClipboardHtml(e){try{e.getAsString((e=>{if(this.processed)return;this.control.commandManager.getCommand(FF.InsertHtml).execute(!0,e),this.processed=!0}))}catch(e){console.warn("Html insert error")}finally{this.loadingPanelManager.hidePanel()}}insertClipboardPicture(e){this.control.beginUpdate(),this.control.isLoadingPictureFromClipboard=!0;const t=this.control.modelManager.model.cache.imageCache.createUnloadedInfoByFile(e),r=this.control.selection.activeSubDocument,i=this.control.selection.currState.interval.clone();this.control.modelManager.history.addTransaction((()=>{EU.addSelectionBefore(this.control),this.control.modelManager.modelManipulator.range.removeInterval(new gu(r,i),!0,!0),this.control.modelManager.modelManipulator.picture.insertInlinePictureViaHistory(new pu(r,i.start),this.control.inputPosition.charPropsBundle,nh.defaultInfo(t),new Mb(!0,void 0,(()=>this.control.isLoadingPictureFromClipboard=!1))),EU.addSelectionAfter(this.control,i.start+1)})),this.control.endUpdate()}insertClipboardRtf(e){this.control.isLoadingPictureFromClipboard=!0,e.getAsString((e=>{if(this.processed||!e)return;e.length>1e5&&this.loadingPanelManager.executeIfTimerExpired();const t=new Iw((()=>{}));new lM(t).importFromString(e,this.control.modelManager.richOptions,((e,t)=>{this.loadingPanelManager.executeIfTimerExpired(),t.whenAllPicturesLoaded((t=>{this.loadingPanelManager.executeIfTimerExpired(),this.control.beginUpdate();const r=this.control.selection.activeSubDocument,i=this.control.selection.currState.interval.clone();this.control.modelManager.history.addTransaction((()=>{EU.addSelectionBefore(this.control),this.control.modelManager.modelManipulator.range.removeInterval(new gu(r,i),!0,!0);const t=this.control.modelManager.modelManipulator.subDocument.insertSubDocument(new pu(r,i.start),new gu(e.mainSubDocument,e.mainSubDocument.interval));EU.addSelectionAfter(this.control,t.insetedInterval.end),e.updateHyperlinkFields(this.control,new gu(r,t.insetedInterval),t.newSubDocuments)})),this.control.endUpdate(),this.control.isLoadingPictureFromClipboard=!1,this.control.commandManager.abortClipboardCommandExecution()}),5e3);const r=new cP(e,this.control.modelManager.richOptions,new Lb.m1);t.import(r.modelManipulator),this.loadingPanelManager.hidePanel(),this.processed=!0}),(e=>{console.warn("Rtf insert error"),this.loadingPanelManager.hidePanel()}))}))}}const cq=229;var hq,uq;!function(e){e[e.None=0]="None",e[e.Start=1]="Start",e[e.Process=2]="Process"}(hq||(hq={}));class pq{constructor(e,t,r){this.newLineRegexp=/(\r\n|\n|\r)/gm,this.IMEState=hq.None,this.processTextOnKeyPress=!1,this.evtHandlersHolder=new rX.$,this.control=e,this.eventManager=t,this.canInsertTextOnInputEvent=this.canUseInputEvent(),this.createHierarchy(r),this.initialize(),this.inputWithAlt=!1}dispose(){this.evtHandlersHolder.removeAllListeners(),clearTimeout(this.keyPressTimerId),clearTimeout(this.imeTimerId),clearTimeout(this.onInputTimerId),clearTimeout(this.onBlurTimerId),clearTimeout(this.onKeyUpTimerId)}initialize(){this.initializeIfNotReadOnly(),this.initEvents(),this.prevKeyCode=cq}initializeIfNotReadOnly(){this.control.readOnly===RF.Persistent&&!this.control.modelManager.clientMode||this.initializedIfNotReadOnly||(this.initializedIfNotReadOnly=!0,this.initializeIfNotReadOnlyCore())}initializeIfNotReadOnlyCore(){}initEvents(){this.evtHandlersHolder.addListener(this.getEditableDocument(),"keydown",this.onKeyDown.bind(this)),this.evtHandlersHolder.addListener(this.getEditableDocument(),"keyup",(e=>this.onKeyUpTimerId=setTimeout((()=>this.onKeyUp(e)),0))),this.evtHandlersHolder.addListener(this.getEditableDocument(),"keypress",this.onKeyPress.bind(this)),this.evtHandlersHolder.addListener(this.getEditableDocument(),"focus",this.onFocus.bind(this)),this.evtHandlersHolder.addListener(this.getEditableDocument(),"blur",(e=>this.onBlurTimerId=setTimeout((()=>this.onBlur(e)),10))),this.evtHandlersHolder.addListener(this.getEditableDocument(),"contextmenu",this.onContextMenu.bind(this)),this.evtHandlersHolder.addListener(this.getEditableDocument(),"input",(e=>this.onInput(e)))}createHierarchy(e){this.inputElement=this.createInputElement(),this.inputElement.classList.add("dxreInputTarget"),e.appendChild(this.inputElement),this.createHierarchyCore(),this.inputElement.addEventListener("load",(()=>this.recreateIfNeeded()),!0)}createHierarchyCore(){}createInputElement(){return null}onInput(e){if(!this.processTextOnKeyPress)if("insertText"===e.inputType){const t=this.getEditableTextOwner().innerText;if(rn.StringUtils.isNullOrEmpty(t))return;this.newLineRegexp.test(t)?(this.eventManager.onInput("insertParagraph"),this.clearInputElement()):this.onInputTimerId=setTimeout((()=>this.onTextInput(e.data)),0)}else this.eventManager.onInput(e.inputType)&&this.clearInputElement()}onBlur(e){const t=document.activeElement;t&&this.control.isRibbon(t)&&!fn.DomUtils.isInteractiveControl(t)||this.eventManager.onFocusOut(),this.clearInputElement()}onFocus(){this.selectEditableDocumentContent(),this.eventManager.onFocusIn()}onKeyDown(e){if(this.control.clientSideEvents.raiseKeyDown(e))tX.g.preventEvent(e);else if(this.IMEState===hq.None){e=this.getNormalizedEvent(e);const t=KU.LN.getEventKeyCode(e);if(this.needProcessShortcut=!t||t==cq,this.canInsertTextOnInputEvent=this.canUseInputEvent(),(e.altKey||e.ctrlKey||e.metaKey)&&(this.canInsertTextOnInputEvent=!1),e.altKey&&(t>=KU.VD.Numpad_0&&t<=KU.VD.Numpad_9?this.inputWithAlt=!0:18!=t&&(this.inputWithAlt=!1)),!this.needProcessShortcut){if(this.isProcessShortcut(t)&&this.onShortcut(e)||9===t&&!this.control.modelManager.richOptions.control.acceptsTab)return void(this.prevKeyCode=t)}this.canInsertTextOnInputEvent||this.control.isTouchMode()||(this.processTextOnKeyPress=!0),this.prevKeyCode=t}}isProcessShortcut(e){return!(e==KU.VD.Space&&this.prevKeyCode==KU.VD.SingleQuote&&!yH.Browser.MacOSPlatform)}onKeyUp(e){this.control.clientSideEvents.raiseKeyUp(e),this.needProcessShortcut&&this.onShortcut(e)}onKeyPress(e){e.altKey||(this.inputWithAlt?this.keyPressTimerId=setTimeout((()=>this.onTextInput(void 0)),0):this.processTextOnKeyPress&&(this.imeTimerId=setTimeout((()=>{this.onTextInput(void 0),this.processTextOnKeyPress=!1}),0)),this.inputWithAlt=!1)}onContextMenu(e){iX.y.preventContextMenu(e),e.preventDefault(),this.control.popupMenuManager.showByKey()}onShortcut(e){const t=this.getShortcutCode(e);return!!this.control.shortcutManager.isKnownShortcut(t)&&(this.onShortcutCore(e,t),!0)}onShortcutCore(e,t){yH.Browser.WebKitTouchUI||this.clearInputElement(),this.selectEditableDocumentContent(),this.control.shortcutManager.isClipboardCommandShortcut(t)||yH.Browser.MacOSMobilePlatform||tX.g.preventEvent(e),this.eventManager.onShortcut(t)}onText(e,t,r){this.canInsertTextOnInputEvent||(this.needProcessShortcut=!1),this.eventManager.onText(e,r),this.previousText=t}onTextReplace(e,t){this.previousText=t}onTextInput(e){const t=this.getEditableDocumentText();if(t)if(this.previousText){const e=this.previousText,r=e.length-1;t[r]&&t[r]!=e[r]&&this.onText(t[r],t,!0);const i=t.length-e.length;if(i>0)for(let e=t.length-i;e<t.length;e++)this.onText(t[e],t,!1)}else this.onText(t,t,!1)}tryObtainCodeFromChar(e){return"\n"==e?KU.VD.Enter:cq}captureFocus(){}canUseInputEvent(){return yH.Browser.Firefox&&yH.Browser.MajorVersion>=14||yH.Browser.WebKitTouchUI}getEditableDocumentText(e=!1){const t=fn.DomUtils.getInnerText(this.getEditableTextOwner());return e?t:t.replace(this.newLineRegexp,"")}getEditableTextOwner(){return null}setPosition(e,t){this.inputElement.style.left=e+"px",this.inputElement.style.top=t+"px"}clearInputElement(){this.previousText=""}setEditableDocumentContent(e){this.previousText=""}setEditableDocumentCursorPosition(e){}selectEditableDocumentContent(){this.control.barHolder.updateItemsState({[FF.CopySelection]:!0,[FF.PasteSelection]:!0,[FF.CutSelection]:!0})}getEditableDocumentContent(){return""}getNormalizedEvent(e){if(yH.Browser.IE&&yH.Browser.MajorVersion<9){const t={};for(let r in e)t[r]=e[r];return t}return e}recreateIfNeeded(){}getShortcutCode(e){const t=KU.LN.getEventKeyCode(e);let r=0;return e.altKey&&(r|=KU.tx.Alt),e.ctrlKey&&(r|=KU.tx.Ctrl),e.shiftKey&&(r|=KU.tx.Shift),e.metaKey&&yH.Browser.MacOSPlatform&&(r|=KU.tx.Meta),r|t}}class gq extends pq{constructor(e,t,r){super(e,t,r)}dispose(){super.dispose(),clearTimeout(this.clearInputTimerId),clearTimeout(this.composUpdateTimerId),clearTimeout(this.composEndTimerId),clearTimeout(this.onTextInputTimerId)}initializeIfNotReadOnlyCore(){this.inputElement.contentEditable="true",this.clearInputElement()}setPosition(e,t){super.setPosition(e,t)}createInputElement(){const e=document.createElement("DIV");return e.autocapitalize="off",yH.Browser.MacOSMobilePlatform&&(Number(yH.Browser.PlaformMajorVersion)>=16||yH.Browser.Safari&&yH.Browser.MajorVersion>=16)&&e.classList.add("dxreiOS16"),e}initEvents(){super.initEvents(),this.evtHandlersHolder.addListener(this.getEditableDocument(),"compositionstart",this.onCompositionStart.bind(this)),this.evtHandlersHolder.addListener(this.getEditableDocument(),"compositionupdate",(e=>yH.Browser.IE||yH.Browser.Edge?this.onCompositionUpdate(e):this.composUpdateTimerId=setTimeout((()=>this.onCompositionUpdate(e)),0))),this.evtHandlersHolder.addListener(this.getEditableDocument(),"compositionend",(e=>yH.Browser.Safari?this.composEndTimerId=setTimeout((()=>this.onCompositionEnd(e)),0):this.onCompositionEnd(e)))}onKeyDown(e){var t;this.handled=!1,window.getSelection().anchorNode||((null===(t=this.getEditableDocumentContent())||void 0===t?void 0:t.length)?this.setEditableDocumentCursorPosition(this.lastCursorPosition):this.selectEditableDocumentContent()),super.onKeyDown(e),this.canSkipInputEvent=KU.LN.getEventKeyCode(e)!=cq}onKeyUp(e){super.onKeyUp(e),this.control.owner.hidePopupMenu(),this.onTextInput(void 0),this.lastCursorPosition=window.getSelection().anchorOffset}onInput(e){this.canSkipInputEvent||(this.handled=!1,super.onInput(e)),this.control.owner.hidePopupMenu(),this.canSkipInputEvent=!1}onFocus(){this.canSkipFocusAndBlur||super.onFocus(),this.canSkipFocusAndBlur=!1}onBlur(e){this.canSkipFocusAndBlur||super.onBlur(e)}onShortcutCore(e,t){t===KU.VD.Space&&yH.Browser.MacOSMobilePlatform||(this.handled=!0,this.clearInputTimerId=setTimeout((()=>this.clearInputElement()),0),super.onShortcutCore(e,t))}onTextReplace(e,t){this.eventManager.onTextReplace(e),super.onTextReplace(e,t)}onTextInput(e){let t=this.getEditableDocumentText();if(!this.handled){if(!(yH.Browser.AndroidMobilePlatform&&this.needProcessShortcut&&this.tryHandleShortcutByInputString(e))){let r=!this.cursorWasSetOnLastPosition&&this.getEditableDocumentCursorPosition()===this.getEditableDocumentFullText().length,i=0;if(!r&&this.previousText){let e=this.previousText,n=e.lastIndexOf(" ");n>=0&&(i=n+1);let o=(t.length>e.length?e.length:t.length)-i-1;t.substr(i,o)!==e.substr(i,o)&&(r=!0)}r?this.onTextReplace(t.substr(i),t):super.onTextInput(e),this.cursorWasSetOnLastPosition=!0}this.handled=!0," "==t[t.length-1]&&this.clearInputElement()}}tryHandleShortcutByInputString(e){if(e&&this.IMEState===hq.None){let t=e.charAt(e.length-1);const r=this.tryObtainCodeFromChar(t);if(r!=cq&&this.isProcessShortcut(r)&&this.control.shortcutManager.isKnownShortcut(r))return this.eventManager.onShortcut(r),r===KU.VD.Space&&yH.Browser.MacOSMobilePlatform||this.clearInputElement(),!0}return!1}getEditableTextOwner(){return this.inputElement}captureFocus(){this.inputElement.focus()}getEditableDocument(){return this.inputElement}clearInputElement(){super.clearInputElement(),fn.DomUtils.clearInnerHtml(this.inputElement),this.cursorWasSetOnLastPosition=!0}setEditableDocumentContent(e){e?"string"==typeof e?this.inputElement.innerHTML=e:(this.inputElement.innerHTML="",e.forEach((e=>this.inputElement.appendChild(e)))):this.clearInputElement()}setEditableDocumentCursorPosition(e){let t=this.getEditableDocumentFullText().length;if(e>t&&(e=t),this.inputElement.childNodes.length>0){let r=document.createRange(),i=window.getSelection(),n=this.inputElement.childNodes[this.inputElement.childNodes.length-1];e<=n.textContent.length&&(r.setStart(n,e),r.collapse(!0),i.removeAllRanges(),i.addRange(r),this.previousText=this.getEditableDocumentText(),this.cursorWasSetOnLastPosition=e===t)}}getEditableDocumentText(){return this.getEditableDocumentFullText().substring(0,this.getEditableDocumentCursorPosition())}getEditableDocumentFullText(){return super.getEditableDocumentText().replace(/\s/g," ")}getEditableDocumentContent(){const e=this.inputElement.cloneNode(!0).childNodes;return e.length?e:this.inputElement.innerText}getEditableDocumentCursorPosition(){let e=window.getSelection().focusOffset;if(yH.Browser.MacOSMobilePlatform){let t=this.getEditableDocumentFullText();" "===t[t.length-1]&&t.length>1&&e++}return e}selectEditableDocumentContent(){const e=window.getSelection();let t=null;this.inputElement.childNodes.length&&(t=this.inputElement.childNodes[0],!t.childNodes.length)||(e.removeAllRanges(),e.selectAllChildren(this.inputElement),super.selectEditableDocumentContent())}onCompositionStart(e){this.IMEState=hq.Start,this.needProcessShortcut=!1,this.clearInputElement()}onCompositionUpdate(e){const t=this.getEditableDocumentText();t.length&&this.previousText!=t&&(this.IMEState===hq.Start?this.onText(t,t,this.previousText.length>0):this.IMEState===hq.Process&&this.onTextReplace(t,t)),this.IMEState=hq.Process}onCompositionEnd(e){const t=this.getEditableDocumentText();this.previousText!=t&&(t.length>0?this.onTextReplace(t,t):this.onShortcutCore(e,KU.VD.Backspace)),this.IMEState=hq.None}}class mq extends pq{constructor(e,t,r){super(e,t,r)}dispose(){super.dispose(),clearTimeout(this.onTextInputTimerId),clearTimeout(this.composUpdateTimerId),clearTimeout(this.composEndTimerId)}createHierarchyCore(){let e="<!DOCTYPE html>";e+="<html>",e+="<head>",e+="</head>",e+='<body loaded="true">',e+="</body>",e+="</html>",this.editableDocument=this.inputElement.contentDocument||this.inputElement.contentWindow.document,yH.Browser.Firefox?(this.editableDocument.open(),this.editableDocument.write(e),this.editableDocument.close()):this.editableDocument.documentElement.innerHTML=e;const t=this.editableDocument.documentElement.querySelector("body");t.style.padding="0px",t.style.margin="0px",t.style.overflow="hidden"}initializeIfNotReadOnlyCore(){yH.Browser.WebKitFamily?this.editableDocument.body.setAttribute("contenteditable","true"):this.editableDocument.designMode="on"}createInputElement(){const e=document.createElement("IFRAME");return e.src="about:blank",yH.Browser.Safari&&(e.style.width="100%",e.style.minWidth="100%",e.style.overflow="hidden"),e}initEvents(){super.initEvents(),this.evtHandlersHolder.addListener(this.getEditableDocument(),"compositionstart",this.onCompositionStart.bind(this)),this.evtHandlersHolder.addListener(this.getEditableDocument(),"compositionupdate",(e=>yH.Browser.IE||yH.Browser.Edge?this.onCompositionUpdate(e):this.composUpdateTimerId=setTimeout((()=>this.onCompositionUpdate(e)),0))),this.evtHandlersHolder.addListener(this.getEditableDocument(),"compositionend",(e=>yH.Browser.Safari?this.composEndTimerId=setTimeout((()=>this.onCompositionEnd(e)),0):this.onCompositionEnd(e))),this.evtHandlersHolder.addListener(this.getEditableDocument(),"copy",(e=>{if(!Bb.isEnabled(this.control.modelManager.richOptions.control.copy))return tX.g.preventEvent(e);this.control.commandManager.getCommand(FF.CopySelection).copyEventRaised()})),this.evtHandlersHolder.addListener(this.getEditableDocument(),"cut",(e=>{if(!this.isModifyEnabled(this.control.modelManager.richOptions.control.cut))return tX.g.preventEvent(e)})),this.evtHandlersHolder.addListener(this.getEditableDocument(),"paste",(e=>{if(!this.isModifyEnabled(this.control.modelManager.richOptions.control.paste)||this.control.isClosed())return tX.g.preventEvent(e);if(e&&e.clipboardData&&e.clipboardData.items){if(new dq(this.control).insert(e))return}this.control.commandManager.getCommand(FF.PasteSelection).pasteEventRaised()}))}isModifyEnabled(e){const t=this.control.selection;return Bb.isEnabled(e)&&this.control.readOnly!=RF.Persistent&&t.activeSubDocument.isEditable(t.intervals)}captureFocus(){yH.Browser.Opera&&yH.Browser.MajorVersion<=12||yH.Browser.Chrome&&this.inputElement===document.activeElement||(yH.Browser.IE||yH.Browser.Edge)&&this.control.readOnly==RF.Persistent||yH.Browser.Firefox?this.inputElement.contentWindow.focus():fn.DomUtils.setFocus(this.control.readOnly==RF.Persistent?this.inputElement:this.editableDocument.body)}setPosition(e,t,r=!1){(this.IMEState===hq.None||r)&&super.setPosition(e,t),e&&t&&this.selectEditableDocumentContent()}clearInputElement(){this.previousText!=this.getEditableDocumentText()&&super.onTextInput(""),super.clearInputElement(),fn.DomUtils.clearInnerHtml(this.editableDocument.body)}setEditableDocumentContent(e){if(super.setEditableDocumentContent(e),this.IMEState=hq.None,this.editableDocument.body.innerHTML="","string"==typeof e)this.editableDocument.body.innerHTML=e;else if(e){const t=[...e];for(let e=0;e<t.length;e++)this.editableDocument.body.appendChild(t[e])}}getEditableDocumentContent(){const e=this.editableDocument.body.cloneNode(!0).childNodes;return e.length?e:this.editableDocument.body.innerText}selectEditableDocumentContent(){const e=this.editableDocument.body.childNodes[0];if(e&&!e.childNodes.length&&(3!==e.nodeType||""!==e.nodeValue))return;const t=this.editableDocument.getSelection?this.editableDocument.getSelection():this.editableDocument.selection;if(t)if(t.removeAllRanges?t.removeAllRanges():t.empty&&t.empty(),t.selectAllChildren)t.selectAllChildren(this.editableDocument.body);else if(t.createRange){const e=t.createRange();try{e.moveToElementText(this.editableDocument.body)}catch(e){}e.select()}super.selectEditableDocumentContent()}getEditableDocument(){return this.editableDocument}getEditableTextOwner(){return this.editableDocument.body}onBlur(e){super.onBlur(e),this.IMEState=hq.None,this.endInputIME()}onShortcutCore(e,t){const r=this.control.selection.lastSelectedInterval;super.onShortcutCore(e,t),this.control.selection.lastSelectedInterval!=r&&this.selectEditableDocumentContent()}onTextInput(e){this.onTextInputTimerId=setTimeout((()=>{const t=this.getEditableDocumentText();(12288==t.charCodeAt(0)||rn.StringUtils.trim(t))&&super.onTextInput(e)}),0)}onTextReplace(e,t){this.eventManager.onTextReplace(e,this.previousText.length),super.onTextReplace(e,t)}recreateIfNeeded(){(this.inputElement.contentDocument||this.inputElement.contentWindow.document).body.hasAttribute("loaded")||(this.initializedIfNotReadOnly=!1,this.createHierarchyCore(),this.initialize())}onCompositionStart(e){this.IMEState=hq.Start,this.needProcessShortcut=!1,yH.Browser.IE||yH.Browser.Edge||this.clearInputElement(),this.startInputIME()}onCompositionUpdate(e){const t=this.getEditableDocumentText();this.IMEState!==hq.None&&(t.length&&this.previousText!=t&&(this.onTextReplace(t,t),this.updateInputIME()),this.IMEState=hq.Process)}onCompositionEnd(e){const t=this.getEditableDocumentText();this.previousText!=t?this.onTextReplace(t,t):yH.Browser.Edge||this.clearInputElement(),12288==t.charCodeAt(t.length-1)&&this.clearInputElement(),this.IMEState=hq.None,this.endInputIME()}startInputIME(){this.inputElement.style.position="absolute";const e=this.control.selection.lastSelectedInterval.start,t=this.control.selection.activeSubDocument,r=t.isMain()?new ug(this.control.selection.layout,t,e,Hu.Character).create((new cg).setDefault(!1),(new cg).setDefault(!0)):new pg(this.control.selection.layout,t,e,this.control.selection.pageIndex,Hu.Box).create((new cg).setDefault(!1),(new cg).setDefault(!0));if(!r)return null;const i=this.editableDocument.body.style.textIndent,n=Nn.getSizeSignificantRules(this.control.inputPosition.getMergedCharacterPropertiesRaw()).join(";");this.editableDocument.body.style.cssText="padding: 0px; margin: 0px; overflow: hidden; color: transparent; "+n,this.editableDocument.body.style.textIndent=i;let o=r.getLayoutX(this.control.measurer,Hu.Row);const a=new zp(r.pageIndex,o,r.getLayoutY(Hu.Row)),s=this.control.viewManager.cache[a.pageIndex].page;a.offset(s.offsetLeft,s.offsetTop),this.setPosition(a.x,a.y,!0),this.editableDocument.body.style.textIndent=this.previousText.length?i:r.getLayoutX(this.control.measurer,Hu.Box)+r.box.getCharOffsetXInPixels(this.control.measurer,r.charOffset)-o+"px",this.inputElement.style.width=r.row.width+"px",this.inputElement.style.minWidth=r.row.width+"px",(yH.Browser.IE||yH.Browser.Edge)&&(this.editableDocument.body.style.width=this.inputElement.style.width,this.editableDocument.body.style.height=this.inputElement.style.height=r.row.height+"px"),r.row.boxes.length>1&&(this.editableDocument.body.style.lineHeight=r.row.height+"px",this.editableDocument.body.style.marginTop=(r.box.height-r.row.height)/2+"px")}updateInputIME(){const e=this.control.selection.lastSelectedInterval.start,t=this.control.selection.activeSubDocument,r=t.isMain()?new ug(this.control.selection.layout,t,e,Hu.Character).create((new cg).setDefault(!1),(new cg).setDefault(!0)):new pg(this.control.selection.layout,t,e,this.control.selection.pageIndex,Hu.Box).create((new cg).setDefault(!1),(new cg).setDefault(!0));if(!r)return null;const i=this.control.selection.activeSubDocument.getParagraphByPosition(e).getParagraphMergedProperties();2===this.getEditableDocumentText().length&&(this.inputElement.style.height=(i.alignment==Ae.Left?r.pageArea.height:0)+"px");const n=parseInt(this.inputElement.style.width);if(n&&n!=r.row.width){const e=r.row.width-parseInt(this.inputElement.style.width);this.inputElement.style.width=r.row.width+"px",this.editableDocument.body.style.textIndent=parseInt(this.editableDocument.body.style.textIndent)+e+"px",this.inputElement.style.left=parseInt(this.inputElement.style.left)-e+"px"}}endInputIME(){this.inputElement.style.width="0px",this.inputElement.style.height="0px"}}class fq{constructor(e,t,r){this.control=e,this.inputEditor=this.createInputEditor(r,t)}initExporter(){this.exporter=new AE(this.control.getExportModelOptions(),{sanitaizeHyperlinkURIs:!0,convertRelativeURIsToAbsolute:!0})}dispose(){this.inputEditor.dispose()}createInputEditor(e,t){return this.control.isTouchMode()?new gq(this.control,t,e):new mq(this.control,t,e)}getEditableDocument(){return this.inputEditor.getEditableDocument()}getExportedRangeCopy(){return this.exporter.rangeCopy}captureFocus(){this.inputEditor.captureFocus()}setPosition(e,t){this.inputEditor.setPosition(e,t)}renderSelectionToEditableDocument(){const e=this.control.selection;if(0===e.intervals.length||e.isCollapsed())return;const t=fb.create(e.subDocumentIntervals),r=t.model,i=new on.FixedInterval(0,r.mainSubDocument.getDocumentEndPosition()-(t.addedUselessParagraphMarkInEnd?1:0)),n=an.getCopyPasteGuidLabel(this.control.getGuidParams());let o="",a=this.exporter.getHtmlElementsByInterval(r,r.mainSubDocument,i,n);if(a.isEmpty()||(o=fq.getCopyPasteHtmlContentForEditable(a,n),this.exporter.rangeCopy=t),"string"==typeof o)this.setEditableDocumentContent(o);else{const e=document.createDocumentFragment();e.appendChild(o),this.setEditableDocumentContent(e.childNodes)}this.selectEditableDocumentContent()}static getCopyPasteHtmlContentForEditable(e,t){const r=new BE,i=t.replace('id="',"").replace('"',"");return r.startChild("a").configure((e=>{e.setAttribute("id",i)})).startChild("span").configure((e=>{e.setAttribute("id",i)})).startChild("b").configure((t=>{t.style.cssText="font-weight: normal;",t.setAttribute("id",i),"string"==typeof e&&(t.innerHTML=e)})),"string"!=typeof e&&r.assignFrom(e),r.endChild("b"),r.endChild("span"),r.endChild("a"),r.childElements[0]}setEditableDocumentContent(e){this.inputEditor.setEditableDocumentContent(e)}setEditableDocumentCursorPosition(e){this.inputEditor.setEditableDocumentCursorPosition(e)}getEditableDocumentContent(){return this.inputEditor.getEditableDocumentContent()}selectEditableDocumentContent(){this.inputEditor.selectEditableDocumentContent()}}!function(e){e[e.Search=0]="Search",e[e.Misspelled=1]="Misspelled",e[e.RangePermission=2]="RangePermission"}(uq||(uq={}));class bq extends Lb.IS{get highlightRanges(){return this.documentProtectionSettings.highlightRanges}constructor(e,t,r,i){super(),this.onSelectionLayoutChanged=new Nb,this.selection=e,this.measurer=t,this.layoutSelection=r,this.documentProtectionSettings=i}modelChanged(e){e.type==pd.RangePermissionsPropertiesChanged&&this.onRangePermissionPropertiesChanged()}onRangePermissionPropertiesChanged(){for(let e of this.layoutSelection.rangePermissionInfo.pageInfos)e.beforeRecreatePageSelection();this.highlightRanges?f.ListUtils.forEach(this.selection.layout.pages,(e=>{this.buildRangePermissionSelection(this.selection.model.mainSubDocument,e.index),b.j.forEach(e.otherPageAreas,(e=>this.buildRangePermissionSelection(e.subDocument,this.selection.pageIndex)))})):this.layoutSelection.rangePermissionInfo.changes=[],this.isUpdateLocked()||this.raiseRangePermissionLayoutChanged()}NotifySelectionChanged(e){O.print(L.SelectionFormatter,"NotifySelectionChanged",(()=>`intervals: ${f.ListUtils.map(this.selection.intervals,(e=>lg.fixedInterval(e))).join(" ")}, subDocId: ${this.selection.activeSubDocument.id}`)),this.updateSubDocumentInfo(),this.selectionChanged()}NotifySearchSelectionChanged(){O.print(L.SelectionFormatter,"NotifySearchSelectionChanged",""),this.layoutSelection.searchInfo.changes=[];for(let e of this.layoutSelection.searchInfo.pageInfos)e.beforeRecreatePageSelection();const e=this.selection.activeSubDocument;this.createSimpleLayout(e,this.intersectModelIntervalsWithValidPageIntervals(e,this.selection.searchIntervals,this.layoutSelection.pageIndex),this.layoutSelection.searchInfo,uq.Search),this.isUpdateLocked()||this.raiseSearchSelectionLayoutChanged()}NotifyMisspelledSelectionChanged(){O.print(L.SelectionFormatter,"NotifyMisspelledSelectionChanged",""),this.layoutSelection.misspelledInfo.changes=[];for(let e of this.layoutSelection.misspelledInfo.pageInfos)e.beforeRecreatePageSelection();const e=this.selection.activeSubDocument;this.createSimpleLayout(e,this.intersectModelIntervalsWithValidPageIntervals(e,this.selection.misspelledIntervals,this.layoutSelection.pageIndex),this.layoutSelection.misspelledInfo,uq.Misspelled),this.isUpdateLocked()||this.raiseMisspelledSelectionLayoutChanged()}NotifyPagesReady(e){O.print(L.SelectionFormatter,"NotifyPagesReady","");for(let t of e)if(t.changeType==wV.Deleted)this.layoutSelection.selectionInfo.pageInfos.splice(t.index,1),this.layoutSelection.selectionInfo.changes.push(new vj(t.index,wV.Deleted,[])),this.highlightRanges&&(this.layoutSelection.rangePermissionInfo.pageInfos.splice(t.index,1),this.layoutSelection.rangePermissionInfo.changes.push(new vj(t.index,wV.Deleted,[])));else if(this.buildPageSelection(t.index),this.highlightRanges){const e=this.layoutSelection.rangePermissionInfo.pageInfos[t.index];e&&e.beforeRecreatePageSelection(),this.buildRangePermissionSelection(this.selection.model.mainSubDocument,t.index),b.j.forEach(this.selection.layout.pages[t.index].otherPageAreas,(e=>this.buildRangePermissionSelection(e.subDocument,t.index)))}this.isUpdateLocked()||(this.raiseSelectionLayoutChanged(),this.highlightRanges?this.raiseRangePermissionLayoutChanged():this.layoutSelection.rangePermissionInfo.reset())}NotifyFullyFormatted(e){}onUpdateUnlocked(e){this.updateSubDocumentInfo(),O.print(L.SelectionFormatter,"onUpdateUnlocked",""),this.raiseSelectionLayoutChanged(),this.raiseSearchSelectionLayoutChanged(),this.raiseMisspelledSelectionLayoutChanged(),this.highlightRanges?this.raiseRangePermissionLayoutChanged():this.layoutSelection.rangePermissionInfo&&this.layoutSelection.rangePermissionInfo.reset()}selectionChanged(){this.layoutSelection.selectionInfo.changes=[];for(let e of this.layoutSelection.selectionInfo.pageInfos)e.beforeRecreatePageSelection();this.buildContiniousSelection(),this.isUpdateLocked()||this.raiseSelectionLayoutChanged()}updateSubDocumentInfo(){(this.layoutSelection.pageIndex!=this.selection.pageIndex||this.layoutSelection.subDocumentInfo!=this.selection.activeSubDocument.info)&&(this.layoutSelection.pageIndex=this.selection.pageIndex,this.layoutSelection.subDocumentInfo=this.selection.activeSubDocument.info,this.selectionChanged())}buildContiniousSelection(){if(this.selection.isCollapsed())this.createCollapsedSelectionLayout(-1);else{const e=this.selection.layout,t=this.selection.intervals,r=this.selection.activeSubDocument;let i;if(r.isMain())i=nn.IntervalAlgorithms.getMergedIntervals(f.ListUtils.accumulate(e.pages,[],((e,t)=>f.ListUtils.addListOnTail(e,t.getContentIntervals())),0,e.validPageCount),!0);else if(this.selection.pageIndex<e.validPageCount){i=e.pages[this.selection.pageIndex].otherPageAreas[r.id]?[new on.FixedInterval(0,r.getDocumentEndPosition())]:[]}else i=[];for(let e of nn.IntervalAlgorithms.getIntersectionsTwoArraysOfInterval(i,t))this.createExtendedSelectionLayout(e,this.layoutSelection.selectionInfo,t)}}buildPageSelection(e){const t=this.selection,r=this.layoutSelection.selectionInfo.pageInfos[e];if(r&&r.beforeRecreatePageSelection(),t.isCollapsed())this.layoutSelection.selectionInfo.changes=[],this.createCollapsedSelectionLayout(e);else{const r=t.layout.pages[e],i=t.activeSubDocument;let n=[];i.isMain()?n=nn.IntervalAlgorithms.getIntersectionsTwoArraysOfInterval(t.intervals,r.getContentIntervals()):r.otherPageAreas[i.id]&&e==t.pageIndex&&(n=t.intervals);for(let e of n)e.length>0&&this.createExtendedSelectionLayout(e,this.layoutSelection.selectionInfo,t.intervals)}}buildRangePermissionSelection(e,t){const r=this.selection.layout.pages[t],i=f.ListUtils.map(e.availableRangePermissions,(e=>e.interval)),n=e.isMain()?nn.IntervalAlgorithms.getIntersectionsTwoArraysOfInterval(i,r.getContentIntervals()):i;this.createSimpleLayout(e,bq.translateInteralsToIterators(this.selection.layout,e,t,n),this.layoutSelection.rangePermissionInfo,uq.RangePermission)}createCollapsedSelectionLayout(e){const t=this.selection,r=t.intervals[0].start,i=t.layout,n=t.activeSubDocument,o=n.isMain()?new ug(i,n,r,Hu.Character).create((new cg).setDefault(t.endOfLine),(new cg).setDefault(!1)):new pg(i,n,r,t.pageIndex,Hu.Character).create((new cg).setDefault(t.endOfLine),(new cg).setDefault(!1));if(!o||e>=0&&o.pageIndex!=e||!o.page.isValid)return;let a=!0;for(;I.Y.isAnyOf(o.box.getType(),lc.AnchorPicture,lc.AnchorTextBox);)if(a)o.advanceToPrevBoxInRow()||(a=!1);else if(!o.advanceToNextBoxInRow())break;const s=o.row.tableCellInfo;if(s&&s.boundFlags.get(_a.EndOnThisColumn)){const e=s.parentRow,t=e.parentTable.logicInfo.grid,i=t.tableCellGridInfos[e.rowIndex][s.cellGridIndex];if(r==t.table.rows[i.getStartRowIndex()].cells[i.getCellIndex(0)].endParagrapPosition.value-1)for(let e of o.column.tablesInfo)if(e.logicInfo.grid.table.getEndPosition()==r){const t=f.ListUtils.last(e.verticalBorders),r=o.column.rows[o.rowIndex-1],i=o.row.boxes[0].height,a=bq.getFloatingObjId(n,o.page),s=new jK;return s.setPosition(new Xc.Point(o.pageArea.x+o.column.x+e.x+t.xPos+Math.max(1,t.borderInfo.width)+1,o.pageArea.y+o.column.y+r.bottom-i)),s.setSize(new so.Size(1,i)),s.floatingObjectId=a,void this.layoutSelection.selectionInfo.registerItem(o.pageIndex,s)}}if(bq.setPositionOnVisibleBox(o),0==o.row.height||0==o.row.width)return;const l=bq.getFloatingObjId(n,o.page),d=zK.create(o,new so.Size(1,o.box.height),l,jK);if(d.x+=o.box.x+(o.box.isVisible()?o.box.getCharOffsetXInPixels(this.measurer,o.charOffset):0),d.y+=o.row.getSpacingBefore()+o.row.baseLine-o.box.getAscent()-o.row.getSpacingBefore(),o.box.characterProperties.script===ne.Subscript){const e=o.box.characterProperties.fontInfo.scriptMultiplier;d.y+=g.u.pointsToPixelsF(o.box.characterProperties.fontSize)*(o.box.characterProperties.fontInfo.subScriptOffset*e-e+1)}this.layoutSelection.selectionInfo.registerItem(o.pageIndex,d)}createExtendedSelectionLayout(e,t,r){const i=this.selection.layout;if(0==i.pages.length)return;const n=this.selection.activeSubDocument,o=n.isMain(),a=o?i.getLastValidPage():i.pages[this.layoutSelection.pageIndex];if(!a)return;if(this.selection.specialRunInfo.isPictureSelected()||this.selection.specialRunInfo.isTextBoxSelected()&&!n.isTextBox())return;const s=e.start,l=Math.min(e.end,o?a.getEndPosition():a.otherPageAreas[n.id].getEndPosition()),d=o?new rm(n,i,s,l):new im(n,i,s,l,this.layoutSelection.pageIndex);if(!d.isInitialized())throw new Error(R.D.InternalException);let c=null,h=null;const u=new Cq;let p=-1;for(let o=!0;d.moveNext((new cg).setDefault(!o),(new cg).setDefault(!0));o=!1){p<d.position.pageIndex&&(p=d.position.pageIndex,b.j.forEach(d.position.page.anchoredObjectHolder.objects,(r=>{const n=i.anchorObjectsPositionInfo.getPosition(r.objectId);if(r.belongsToSubDocId==this.layoutSelection.subDocumentInfo.subDocumentId&&e.containsInterval(new on.FixedInterval(n,1))){const e=new XK;e.copyFrom(r.getOuterBounds(!1)),t.registerItem(p,e)}})));const o=d.position,a=o.row;if(a.tableCellInfo){const e=Ja.getTableCellByPosition(n.tables,o.getLogPosition(Hu.Box));if(bq.isCellFullySelected(e,r)){if(u.isNeedAddCellToSelection(e,a.tableCellInfo)){c=a;const e=a.tableCellInfo.createRectangle();e.x+=o.pageArea.x+o.column.x,e.y+=o.pageArea.y+o.column.y,h=new zK,h.floatingObjectId=bq.getFloatingObjId(n,o.page),h.copyFrom(e),t.registerItem(o.pageIndex,h)}continue}}const s=Math.min(l-o.getLogPosition(Hu.Box),o.box.getLength()),g=o.box.getCharOffsetXInPixels(this.measurer,o.charOffset),m=o.box.getCharOffsetXInPixels(this.measurer,s),f=o.pageArea.x+o.column.x+o.row.x,C=o.box.x+g+f,S=!!h&&!P.MathUtils.numberCloseTo(C,h.x+h.width);if(a!==c||S){c=a;const e=bq.getFloatingObjId(n,o.page);h=zK.create(o,new so.Size(0,a.height),e,zK),h.x+=o.box.x+g,t.registerItem(o.pageIndex,h)}h.width+=m-g}}static isCellFullySelected(e,t){if(!e)return!1;for(let r of t)if(e.startParagraphPosition.value>=r.start&&e.endParagrapPosition.value<=r.end)return!0;return!1}static translateInteralsToIterators(e,t,r,i){const n=t.isMain()?r=>new rm(t,e,r.start,r.end):i=>new im(t,e,i.start,i.end,r);return f.ListUtils.reducedMap(i,(e=>{if(e.length>0){const t=n(e);return t.isInitialized()?t:null}return null}))}intersectModelIntervalsWithValidPageIntervals(e,t,r){const i=this.selection.layout;if(0==i.pages.length)return[];if(e.isMain()){const n=f.ListUtils.accumulate(i.pages,[],((e,t)=>f.ListUtils.addListOnTail(e,t.getContentIntervals())),0,i.validPageCount),o=nn.IntervalAlgorithms.getMergedIntervals(n,!0),a=nn.IntervalAlgorithms.getIntersectionsTwoArraysOfInterval(t,o);return bq.translateInteralsToIterators(this.selection.layout,e,r,a)}{const n=i.pages[r];return n&&n.otherPageAreas[e.id]?bq.translateInteralsToIterators(this.selection.layout,e,r,t):[]}}createSimpleLayout(e,t,r,i){for(let n of t){let t=null,o=null,a=this.documentProtectionSettings.rangeHighlightColor;if(i==uq.RangePermission){const t=new on.FixedInterval(n.intervalStart,n.intervalEnd-n.intervalStart),r=f.ListUtils.filter(e.availableRangePermissions,(e=>null!=nn.IntervalAlgorithms.getIntersection(e.interval,t)));r.length&&(a=f.ListUtils.last(r).getRangePermissionColor(e.documentModel,this.documentProtectionSettings))}for(let s=!0;n.moveNext((new cg).setDefault(!s),(new cg).setDefault(!0));s=!1){const s=n.position,l=s.row,d=Math.min(n.intervalEnd-s.getLogPosition(Hu.Box),s.box.getLength()),c=s.box.getCharOffsetXInPixels(this.measurer,s.charOffset),h=s.box.getCharOffsetXInPixels(this.measurer,d),u=s.pageArea.x+s.column.x+s.row.x,p=s.box.x+c+u,g=!!o&&!P.MathUtils.numberCloseTo(p,o.x+o.width);if(l!==t||g){t=l;const n=i==uq.Misspelled?l.baseLine:l.height-l.getSpacingAfter()-l.getSpacingBefore(),d=i==uq.Misspelled?0:l.getSpacingBefore(),h=bq.getFloatingObjId(e,s.page);o=zK.create(s,new so.Size(0,n),h,bq.itemConstructorsMap[i]),i==uq.RangePermission&&(o.color=a),o.x+=s.box.x+c,o.y+=d,r.registerItem(s.pageIndex,o)}o.width+=h-c}}}raiseSelectionLayoutChanged(){this.layoutSelection.selectionInfo.collectPageChanges(this.selection.layout),this.layoutSelection.updatePageIndexWithSelection(),this.onSelectionLayoutChanged.listeners.forEach((e=>e.NotifySelectionLayoutChanged()))}raiseSearchSelectionLayoutChanged(){this.layoutSelection.searchInfo.collectPageChanges(this.selection.layout),this.onSelectionLayoutChanged.listeners.forEach((e=>e.NotifySearchSelectionLayoutChanged()))}raiseMisspelledSelectionLayoutChanged(){this.layoutSelection.misspelledInfo.collectPageChanges(this.selection.layout),this.onSelectionLayoutChanged.listeners.forEach((e=>e.NotifyMisspelledSelectionLayoutChanged()))}raiseRangePermissionLayoutChanged(){this.layoutSelection.rangePermissionInfo.collectPageChanges(this.selection.layout),this.onSelectionLayoutChanged.listeners.forEach((e=>e.NotifyRangePermissionLayoutChanged()))}static setPositionOnVisibleBox(e){if(0==e.charOffset)for(let t=e.boxIndex-1;t>=0;t--)if(e.row.boxes[t].isVisible())return e.boxIndex=t,e.box=e.row.boxes[e.boxIndex],void(e.charOffset=e.box.getLength())}static getFloatingObjId(e,t){return e.isMain()?zK.mainPageAreaSelection:e.isHeaderFooter()?zK.headerFooterPageAreaSelection:t.anchoredObjectHolder.getTextBoxByInternalSubDocId(e.id).objectId}}bq.itemConstructorsMap=(new Eu).add(uq.Misspelled,class extends zK{get zIndexClassType(){return Kj.SelMissp}get baseClassName(){return Gj.SELECTION_MISSPELLED}}).add(uq.RangePermission,class extends zK{get zIndexClassType(){return Kj.SelRange}get baseClassName(){return Gj.SELECTION_RANGE_PERMISSION}equals(e){return this.color==e.color&&super.equals(e)}}).add(uq.Search,class extends zK{get zIndexClassType(){return Kj.SelSearch}get baseClassName(){return[Gj.SELECTION_ROW,Gj.SELECTION_SEARCH].join(" ")}}).get();class Cq{constructor(){this.fullySelectedCells={}}isNeedAddCellToSelection(e,t){const r=e.endParagrapPosition.value,i=this.fullySelectedCells[r];if(void 0===i)return this.fullySelectedCells[r]=[t],!0;for(let e of i)if(e===t)return!1;return i.push(t),!0}}class Sq extends UX{baseFrameClassName(){return Gj.ANCHOR}constructor(e,t,r,i){super(e,t,i),this.readOnlyPropertyHolder=r}NotifyShow(e,t,r,i,n,o){this.readOnlyPropertyHolder.isReadOnlyPersistent?super.NotifyHide():super.NotifyShow(e,t,r,i,n,o)}}class Iq extends UX{baseFrameClassName(){return Gj.DRAG_CARET}}Iq.CARET_WIDTH=1;class Pq extends UX{baseFrameClassName(){return Gj.FULL_TABLE_SELECTOR}}class wq extends UX{baseFrameClassName(){return Gj.TABLE_BORDER_LINE}}class yq extends zX{NotifySelectionChanged(e){this.isFloatingObjectSelected()?this.show():this.hide()}NotifyScrollPositionChanged(){}NotifyPagesReady(e){this.isFloatingObjectSelected()&&this.show()}NotifyFullyFormatted(e){}show(){const e=this.control.selection.specialRunInfo.getPosition(),t=this.control.selection.specialRunInfo.getParentSubDocument(),r=(t.isMain()?new ug(this.control.layout,t,e,Hu.Character):new pg(this.control.layout,t,e,this.control.selection.pageIndex,Hu.Character)).create((new cg).setDefault(!1),(new cg).setDefault(!0));if(null!=r){const e=r.getLayoutX(this.control.measurer),t=r.getLayoutY();this.bounds=new Va.Rectangle(e-16,t,16,16),this.pageIndex=r.pageIndex,this.raiseShow()}}isFloatingObjectSelected(){return this.control.selection.specialRunInfo.isSelected()&&this.control.selection.specialRunInfo.isSelectedAnchorObject}}class xq extends zX{show(e){this.pageIndex=-1,this.bounds=e,this.tip=null,this.isTextBox=!1,this.rotation=0,this.isAnchoredObject=!1,this.raiseShow()}}class Tq extends zX{show(e){const t=e.pageIndex,r=new Va.Rectangle(e.getLayoutX(this.control.measurer,Hu.Character),e.getLayoutY(Hu.Row),Iq.CARET_WIDTH,e.row.height-e.row.getSpacingBefore());this.bounds&&this.pageIndex==t&&r.equals(this.bounds)||(this.pageIndex=t,this.bounds=r,this.raiseShow())}}class vq extends zX{NotifyPagesReady(e){for(let t of e)if(t.changeType!=wV.Deleted){this.NotifySelectionChanged(this.control.selection);break}}NotifyFullyFormatted(e){}NotifySelectionChanged(e){const t=e.tableInfo;if(t.extendedData.numRows){const r=e.activeSubDocument,i=r.tables[t.table.index];if(i){const e=i.getStartPosition(),t=(r.isMain()?new ug(this.control.layout,r,e,Hu.Row):new pg(this.control.layout,r,e,this.control.selection.pageIndex,Hu.Row)).create((new cg).setDefault(!1),(new cg).setDefault(!1));if(t&&t.row.tableCellInfo){this.pageIndex=t.pageIndex;const e=t.row.tableCellInfo.parentRow.parentTable.createRectangle();return e.setPosition(new Xc.Point(t.getLayoutX(null,Hu.Column)+e.x-vq.OFFSET,t.getLayoutY(Hu.Column)+e.y-vq.OFFSET)),e.setSize(new so.Size(vq.SIZE,vq.SIZE)),this.bounds=e,void this.raiseShow()}}}this.raiseHide()}show(e){const t=e.pageIndex,r=new Va.Rectangle(e.getLayoutX(this.control.measurer,Hu.Character),e.getLayoutY(Hu.Row),Iq.CARET_WIDTH,e.row.height-e.row.getSpacingBefore());this.bounds&&this.pageIndex==t&&r.equals(this.bounds)||(this.pageIndex=t,this.bounds=r,this.raiseShow())}}vq.SIZE=12,vq.OFFSET=vq.SIZE;class Mq extends zX{init(e,t){this.pageIndex=e,this.bounds=new Va.Rectangle(0,0,t.width,t.height)}show(e){this.bounds.x=e.x,this.bounds.y=e.y,this.raiseShow()}}class Eq{constructor(e){this.dragCaretVisualizer=new Tq(e),this.resizeBoxVisualizer=new jX(e),this.resizeTableVisualizer=new Mq(e),this.anchorVisualizer=new yq(e),this.autoScrollVisualizer=new xq(e),this.fullTableSelectorVisualizer=new vq(e)}initListeners(e){const t=e.cache;this.dragCaretVisualizer.onChanged.add(new Iq(t,e.stringResources,e.fieldOptions)),this.resizeBoxVisualizer.onChanged.add(new pK(t,e.stringResources,e.readOnlyPropertyHolder,e.fieldOptions)),this.resizeTableVisualizer.onChanged.add(new wq(t,e.stringResources,e.fieldOptions)),this.anchorVisualizer.onChanged.add(new Sq(t,e.stringResources,e.readOnlyPropertyHolder,e.fieldOptions)),this.autoScrollVisualizer.onChanged.add(new uG(e.serviceContainer)),this.fullTableSelectorVisualizer.onChanged.add(new Pq(t,e.stringResources,e.fieldOptions))}closeDocument(){this.resizeBoxVisualizer.closeDocument(),this.dragCaretVisualizer.closeDocument(),this.resizeTableVisualizer.closeDocument(),this.anchorVisualizer.closeDocument(),this.autoScrollVisualizer.closeDocument(),this.fullTableSelectorVisualizer.closeDocument()}}class Dq{constructor(e,t,r,i){this.rejectNextShowContextMenuId=null,this.controlOwner=e,this.viewManager=t,this.measurer=r,this.selection=i}setSelection(e){this.selection=e}rejectNextShowContextMenu(){this.rejectNextShowContextMenuId=setTimeout((()=>{this.rejectNextShowContextMenuId=null}),300)}showByKey(){this.controlOwner.showPopupMenu((e=>{const t=this.getContextMenuAbsPoint(this.selection.lastSelectedInterval.start);return t||this.undefinedPoint()}))}showByMouseClick(e){this.controlOwner.showPopupMenu((t=>{if(t.isSpellingMenu){const e=this.getContextMenuAbsPoint(this.selection.lastSelectedInterval.start);if(e)return e}return e}))}showByTouchClick(){null===this.rejectNextShowContextMenuId&&this.controlOwner.showPopupMenu((e=>{const t=this.getContextMenuAbsPoint(this.selection.lastSelectedInterval.start);return t||this.undefinedPoint()}))}undefinedPoint(){return new Xc.Point(fn.DomUtils.getAbsolutePositionX(this.viewManager.canvas),fn.DomUtils.getAbsolutePositionY(this.viewManager.canvas))}getContextMenuAbsPoint(e){const t=this.selection.activeSubDocument,r=t.isMain()?new ug(this.selection.layout,t,e,Hu.Character).create((new cg).setDefault(!1),(new cg).setDefault(!0)):new pg(this.selection.layout,t,e,this.selection.pageIndex,Hu.Box).create((new cg).setDefault(!1),(new cg).setDefault(!0));if(!r)return null;const i=new zp(r.pageIndex,r.getLayoutX(this.measurer),r.getLayoutY(Hu.Row)+r.row.height);if(this.viewManager.canvasManager.isVisiblePosition(i)){const e=this.viewManager.cache[i.pageIndex].page;return i.offset(fn.DomUtils.getAbsolutePositionX(e),fn.DomUtils.getAbsolutePositionY(e))}return null}}class Fq extends Lb.IS{constructor(e){super(),this.onScrollLayoutChanged=new Nb,this.selection=e}NotifyPagesReady(e){this.process()}NotifyFullyFormatted(e){this.process()}NotifyScrollChanged(){this.process()}onUpdateUnlocked(e){this.process()}process(){const e=this.selection.scrollManager.state;e&&(this.canvasState=e.getCanvasState(this.selection.layout),(this.canvasState||this.selection.layout.isFullyFormatted)&&this.selection.scrollManager.init()),this.isUpdateLocked()||this.canvasState&&(this.raiseScrollChanged(),this.canvasState=null)}raiseScrollChanged(){this.onScrollLayoutChanged.listeners.forEach((e=>e.NotifyScrollPositionChanged(this.canvasState)))}}var Rq;!function(e){e[e.None=0]="None",e[e.FullReset=1]="FullReset",e[e.ResetSectionProperties=2]="ResetSectionProperties",e[e.CheckSelectionChange=4]="CheckSelectionChange"}(Rq||(Rq={}));class Lq extends Lb.IS{constructor(e,t){super(),this.updateEnabled=!0,this.inputPosition=e,this.selection=t}onUpdateUnlocked(e){this.applyEvent(e)}NotifySelectionChanged(){this.applyEvent(this.getSelectionChangeEvent())}modelChanged(e){const t=this.getModelChangeEvent(e);this.isUpdateLocked()?this.registerOccurredEvent(t):this.applyEvent(t)}applyEvent(e){if(!this.updateEnabled)return;const t=new pr.Flag(e);t.get(Rq.CheckSelectionChange)&&t.add(this.getSelectionChangeEvent()),t.get(Rq.FullReset)?this.inputPosition.reset():t.get(Rq.ResetSectionProperties)&&this.inputPosition.resetSectionMergedProperties()}getSelectionChangeEvent(){return this.selection.shouldResetInputPosition()?Rq.FullReset:Rq.None}getModelChangeEvent(e){switch(e.type){case pd.DifferentOddAndEvenPages:case pd.PageColor:return Rq.ResetSectionProperties;case pd.DefaultTabWidth:case pd.HeaderFooterCreated:case pd.HeaderFooterIndexChanged:case pd.LoadFontInfo:case pd.SectionFormattingChanged:case pd.CreateStyleLink:case pd.DeleteStyleLink:case pd.AbstractNumberingListAdded:case pd.AbstractNumberingListDeleted:case pd.NumberingListAdded:case pd.NumberingListDeleted:case pd.ListLevelPropertyChanged:case pd.ListLevelParagraphPropertyChanged:case pd.ListLevelCharacterPropertyChanged:case pd.IOverrideListLevelChanged:return Rq.FullReset;case pd.BookmarkCreated:case pd.BookmarkDeleted:return Rq.None;case pd.TabInserted:case pd.TabDeleted:return Rq.FullReset;case pd.LoadPicturesInfo:case pd.InlinePicturesUpdated:return Rq.None;case pd.InlinePictureInserted:case pd.AnchoredPictureInserted:return Rq.FullReset;case pd.AnchoredPictureSizeChanged:return Rq.None;case pd.InlineObjectRunPropertyChanged:return Rq.FullReset;case pd.FieldInserted:case pd.FieldDeleted:return Rq.None;case pd.HyperlinkInfoChanged:return Rq.FullReset;case pd.FieldsShowCodeChanged:return Rq.None;case pd.SimpleRunInserted:case pd.TextBufferChanged:case pd.ParagraphInserted:case pd.SectionInserted:case pd.AnchoredTextBoxInserted:case pd.AnchorObjectRemoved:case pd.IntervalRemoved:case pd.ParagraphMerged:case pd.SectionMerged:case pd.CharacterFormattingChanged:case pd.CharacterPropertiesChanged:case pd.ParagraphFormattingChanged:case pd.ParagraphPropertiesChanged:case pd.ParagraphAndCharacterMergedPropertiesReset:return Rq.FullReset;case pd.AnchoredTextBoxSizeChanged:return Rq.None;case pd.AnchoredTextBoxPropertiesChanged:case pd.AnchorInfoPropertyChanged:case pd.ShapeChanged:case pd.ShapePropertyChanged:case pd.CharacterStyleApplied:case pd.ParagraphStyleApplied:case pd.TableStyleChanged:case pd.ParagraphNumberingListChanged:case pd.TableCreated:case pd.TableRemoved:case pd.TableStartPositionShifted:case pd.TableCellPropertyChanged:case pd.TablePropertyChanged:case pd.TableRowPropertyChanged:case pd.TableCellSplittedHorizontally:case pd.TableCellMergedHorizontally:case pd.TableRowInserted:case pd.TableRowRemoved:case pd.TableCellRemoved:case pd.TableCellInserted:return Rq.FullReset;default:return Rq.None}}}class Bq extends Lb.IS{constructor(e){super(),this.selection=e}modelChanged(e){switch(e.type){case pd.InlinePictureInserted:case pd.AnchoredPictureInserted:case pd.FieldInserted:case pd.FieldDeleted:case pd.SimpleRunInserted:case pd.TextBufferChanged:case pd.ParagraphInserted:case pd.SectionInserted:case pd.AnchoredTextBoxInserted:case pd.AnchorObjectRemoved:case pd.IntervalRemoved:case pd.ParagraphMerged:case pd.SectionMerged:case pd.TableCreated:case pd.TableRemoved:case pd.TableStartPositionShifted:case pd.TableRowInserted:case pd.TableRowRemoved:case pd.TableCellRemoved:case pd.TableCellInserted:this.raiseSelectionChange()}}onUpdateUnlocked(e){0!=e&&this.raiseSelectionChangeCore()}raiseSelectionChange(){this.isUpdateLocked()?this.registerOccurredEvent(1):this.raiseSelectionChangeCore()}raiseSelectionChangeCore(){this.selection.changeState((e=>e),(new FD).forceUpdate())}}class Aq{constructor(e){this.spellChecker=e}dispose(){clearTimeout(this.updBoxesTimerId)}NotifySelectionChanged(e){if(!this.spellChecker.settings.isEnabled)return;e.prevState.intervalsInfo.subDocument!=e.currState.intervalsInfo.subDocument&&(this.spellChecker.initialize(e.activeSubDocument),this.spellChecker.check(),this.updBoxesTimerId=setTimeout((()=>this.spellChecker.updateMisspelledBoxes()),0));let t=e.anchorPosition;if(this.lastStartPosition===t)return;this.lastStartPosition=t;let r=Xh.getWordStartPosition(e.activeSubDocument,t);this.lastWordStartPosition!==r&&(t!=r||t-this.lastWordStartPosition!=1?(this.lastWordStartPosition=r,this.spellChecker.onCurrentSelectedWordChanged()):this.lastWordStartPosition=r)}}const Nq="dxre-",kq=Nq+"ruler";var Oq;!function(e){e[e.Auto=0]="Auto",e[e.Visible=1]="Visible",e[e.Hidden=2]="Hidden"}(Oq||(Oq={}));class _q{}class Uq{get activeSubControl(){return this.subControls[this.handleControlIndex]}constructor(e,t){this.subControls=[],this.handleControlIndex=-1,this.viewState=[],this.modelData=e,this.controls=t}dispose(){for(let e of this.subControls)e.dispose();this.subControls=[]}update(){this.updateModelState(),this.updateView()}updateModelState(){this.currModelState=this.getModelState(),this.prevModelState=this.currModelState.clone()}onMouseMove(e,t){this.calculateNewModelState(e),this.updateView(),this.activeSubControl.lineControlSetPosition()}onEscPress(){this.currModelState=this.prevModelState.clone(),this.finishHandle()}finishHandle(){this.controls.lineControl.hide();const e=this.activeSubControl;e&&e.hideShadow()}setCount(e){let t=this.subControls.length-e;if(t>0)for(;t--;)this.subControls.pop().dispose();else for(t=Math.abs(t);t--;)this.subControls.push(this.createSubControl())}}const Hq=" table";var Vq,Wq;!function(e){e[e.LeftSide=0]="LeftSide",e[e.RightSide=1]="RightSide"}(Vq||(Vq={})),function(e){e[e.Normal=0]="Normal",e[e.TableColumn=1]="TableColumn"}(Wq||(Wq={}));class zq{constructor(e,t,r){this.borderWidth=0,this.rulerControlLeft=0,this.rulerControlWidth=0,this.viewElementLeft=0,this.canvas=e,this.rulerControlElement=r,this.rootElement=Yj.renderContainer(t),this.rootElement.style.display="block",this.borderWidth=fn.DomUtils.getHorizontalBordersWidth(this.rootElement)}dispose(){fn.DomUtils.hideNode(this.rootElement),this.rootElement=null}show(e){e==Wq.TableColumn?fn.DomUtils.addClassName(this.rootElement,Hq):fn.DomUtils.removeClassName(this.rootElement,Hq),this.rootElement.style.height=this.canvas.clientHeight+"px",this.rootElement.style.top=this.canvas.offsetTop+"px",this.rulerControlLeft=this.rulerControlElement.offsetLeft,this.rulerControlWidth=this.rulerControlElement.offsetWidth,this.viewElementLeft=this.canvas.offsetLeft,this.canvas.parentElement.insertBefore(this.rootElement,this.canvas)}hide(){fn.DomUtils.hideNode(this.rootElement)}setPosition(e,t){t==Vq.RightSide?e=this.rulerControlLeft+this.rulerControlWidth-5-e:t==Vq.LeftSide&&(e=this.rulerControlLeft+5+e-this.borderWidth),this.rootElement.style.left=this.viewElementLeft+e+"px"}}const jq=g.u.centimeterToPixel(1.5),Xq=g.u.centimeterToPixel(.25),Gq=Nq+"columnHandle",Kq=Nq+"columnHandleLeftPart",qq=Nq+"columnHandleRightPart";class $q{constructor(e,t){this.width=e,this.space=t}clone(){return new $q(this.width,this.space)}equals(e){return this.width==e.width&&this.space==e.space}}var Jq;!function(e){e[e.None=0]="None",e[e.ColumnMove=1]="ColumnMove",e[e.ColumnSpace=2]="ColumnSpace",e[e.ColumnWidth=3]="ColumnWidth"}(Jq||(Jq={}));class Yq{get rightPos(){return this.leftPos+this.width}constructor(e,t,r){this.leftPos=e,this.width=t,this.space=r}clone(){return new Yq(this.leftPos,this.width,this.space)}equals(e){return this.leftPos==e.leftPos&&this.width==e.width&&this.space==e.space}}class Qq{constructor(e,t,r,i){this.columns=e,this.equalWidth=t,this.columnActiveIndex=r,this.enabled=i}get activeColumn(){return this.columns[this.columnActiveIndex]}clone(){return new Qq(f.ListUtils.deepCopy(this.columns),this.equalWidth,this.columnActiveIndex,this.enabled)}}class Zq extends Uq{getModelState(){const e=this.modelData.commandManager.getCommand(FF.RulerSectionColumnsSettings).getState();let t=0;const r=f.ListUtils.map(e.value,(e=>{const r=new Yq(t,e.width,e.space);return t=r.rightPos+r.space,r}));return new Qq(r,e.equalWidth,e.activeIndex,e.enabled)}updateView(){if(this.controls.tables.currModelState.columnSeparators.hasItems||!this.modelData.selection.activeSubDocument.isMain())this.viewState=[],this.setCount(0);else{const e=this.controls.leftMargin.currModelState.modelValue;this.viewState=f.ListUtils.map(this.currModelState.columns,(t=>{const r=t.clone();return r.leftPos+=e,r}),0,this.currModelState.columns.length-1),this.setCount(this.viewState.length),f.ListUtils.forEach2(this.subControls,this.viewState,((e,t)=>e.setValue(t)))}}createSubControl(){return new e$(this.controls)}marginsChanged(e){if(this.prevModelState.equalWidth){const t=e/this.prevModelState.columns.length;let r=0;this.currModelState.columns=this.prevModelState.columns.map((e=>{const i=new Yq(r,e.width-t,e.space);return r=i.rightPos+i.space,i}))}}onMouseDown(e,t){return!!this.currModelState.enabled&&(!!f.ListUtils.unsafeAnyOf(this.subControls,((t,r)=>(this.action=t.getAction(e),this.action!=Jq.None&&(this.handleControlIndex=r,!0))))&&(this.controls.lineControl.show(Wq.Normal),this.activeSubControl.lineControlSetPosition(),this.activeSubControl.showShadow(),!0))}onMouseUp(){this.modelData.commandManager.getCommand(FF.RulerSectionColumnsSettings).execute(this.modelData.commandManager.isPublicApiCall,this.currModelState.columns.map((e=>new $q(e.width,e.space)))),this.finishHandle()}calculateNewModelState(e){switch(this.action){case Jq.ColumnMove:return void this.calculateNewModelStateColumnMove(e);case Jq.ColumnSpace:return void this.calculateNewModelStateColumnSpace(e,!1);case Jq.ColumnWidth:return void this.calculateNewModelStateColumnSpace(e,!0)}}calculateNewModelStateColumnMove(e){const t=this.controls.leftMargin.prevModelState.modelValue,r=this.prevModelState.columns[this.handleControlIndex],i=t+r.rightPos,n=this.controls.chooseClosestAnchorPosition(i+e,[i],new xl.MinMaxNumber(t+r.leftPos+jq,t+this.prevModelState.columns[this.handleControlIndex+1].rightPos-jq-r.space))-i,o=this.currModelState.columns[this.handleControlIndex]=this.prevModelState.columns[this.handleControlIndex].clone(),a=this.currModelState.columns[this.handleControlIndex+1]=this.prevModelState.columns[this.handleControlIndex+1].clone();o.width+=n,a.leftPos+=n,a.width-=n}calculateNewModelStateColumnSpace(e,t){if(this.prevModelState.equalWidth){const r=this.currModelState.columns.length,i=this.controls.leftMargin.prevModelState.modelValue,n=this.prevModelState.columns[this.handleControlIndex],o=(f.ListUtils.last(this.prevModelState.columns).rightPos-jq*r)/(r-1),a=(f.ListUtils.last(this.prevModelState.columns).rightPos-Xq*(r-1))/r,s=t?new xl.MinMaxNumber(i+jq*(this.handleControlIndex+1)+o*this.handleControlIndex,i+a*(this.handleControlIndex+1)+Xq*this.handleControlIndex):new xl.MinMaxNumber(i+(a+Xq)*(this.handleControlIndex+1),i+(jq+o)*(this.handleControlIndex+1)),l=i+n.rightPos+(t?0:n.space),d=this.controls.chooseClosestAnchorPosition(l+e,[l],s)-l,c=t?-d*r/(r-(this.handleControlIndex+1)):d*r/(this.handleControlIndex+1),h=c-c/r;this.currModelState=this.prevModelState.clone();let u=0;f.ListUtils.forEach(this.currModelState.columns,((e,t)=>{e.leftPos=u,e.space+=t==r-1?0:c,e.width-=h,u=e.rightPos+e.space}))}else{const r=this.controls.leftMargin.prevModelState.modelValue,i=this.prevModelState.columns[this.handleControlIndex],n=t?new xl.MinMaxNumber(r+i.leftPos+jq,r+this.prevModelState.columns[this.handleControlIndex+1].leftPos-Xq):new xl.MinMaxNumber(r+i.rightPos+Xq,r+this.prevModelState.columns[this.handleControlIndex+1].rightPos-jq),o=r+i.rightPos+(t?0:i.space),a=this.controls.chooseClosestAnchorPosition(o+e,[o],n)-o,s=this.currModelState.columns[this.handleControlIndex]=this.prevModelState.columns[this.handleControlIndex].clone(),l=this.currModelState.columns[this.handleControlIndex+1]=this.prevModelState.columns[this.handleControlIndex+1].clone();t?(s.width+=a,s.space-=a):(s.space+=a,l.leftPos+=a,l.width-=a)}}}class e${constructor(e){this.controls=e,this.rootElement=Yj.renderContainer(Gq),this.leftElement=Yj.renderContainer(Kq),this.rightElement=Yj.renderContainer(qq),this.rootElement.appendChild(this.leftElement),this.rootElement.appendChild(this.rightElement),e.ruler.rootElement.appendChild(this.rootElement)}dispose(){fn.DomUtils.hideNode(this.rootElement),this.rootElement=null}showShadow(){}hideShadow(){}lineControlSetPosition(){let e;switch(this.controls.columns.action){case Jq.ColumnMove:e=this.viewState.rightPos+this.viewState.space/2;break;case Jq.ColumnSpace:e=this.viewState.rightPos+this.viewState.space;break;case Jq.ColumnWidth:e=this.viewState.rightPos}this.controls.lineControl.setPosition(e,Vq.LeftSide)}setValue(e){this.viewState&&this.viewState.equals(e)||(this.viewState=e.clone(),this.rootElement.style.left=5+e.rightPos+"px",this.rootElement.style.width=e.space+"px")}getAction(e){return e==this.rightElement?Jq.ColumnSpace:e==this.leftElement?Jq.ColumnWidth:e!=this.rootElement||this.controls.columns.currModelState.equalWidth?Jq.None:Jq.ColumnMove}}class t${constructor(e,t){this.modelValue=e,this.enabled=t}clone(){return new t$(this.modelValue,this.enabled)}}class r${get visible(){return this._visible}constructor(e,t){this._visible=!0,this.modelData=e,this.controls=t,this.rootElement=Yj.renderContainer(this.getRootClassName())}dispose(){fn.DomUtils.hideNode(this.rootElement),this.rootElement=null}setVisible(e){this._visible!=e&&(this._visible=e,this.rootElement.style.display=e?"block":"none")}}const i$=kq+"Divisions",n$="Division",o$=kq+"Minor"+n$,a$=kq+"Major"+n$,s$=kq+"Number"+n$;class l$ extends r${getRootClassName(){return i$}constructor(e,t,r,i){super(e,t),this.height=0;const n=Math.ceil(i/r.unitSize);this.rootElement.style.width=r.unitSize*(2*n+1)+"px",this.controls.ruler.rootElement.appendChild(this.rootElement),yH.Browser.IE&&yH.Browser.MajorVersion<=9&&this.rootElement.offsetParent,this.height=gK.getOffsetHeight(this.rootElement),function(e,t,r,i){let n=0;const o=(e,t)=>{const o=r.stepSize,a=Yj.renderContainer("");return a.style.left=n+"px",a.style.width=o+"px",a.style.height=i-2*t+"px",a.style.marginTop=t+"px",a.style.marginBottom=t+"px",a.className=e,n+=o,a},a=(e,t)=>{const r=o(e,null);if(0!=t){const e=Yj.renderContainer("");e.innerHTML=t.toString(),r.appendChild(e)}return r},s=e=>{const t=document.createDocumentFragment();for(let i of r.unitMap)switch(i){case d$.Number:t.appendChild(a(s$,e));break;case d$.Major:t.appendChild(o(a$,2));break;case d$.Minor:t.appendChild(o(o$,4))}return t};for(let r=t;r>0;r--)e.appendChild(s(r));for(let r=0;r<=t;r++)e.appendChild(s(r))}(this.rootElement,n,r,this.height),this.initialLeft=-(n*r.unitSize-5)}update(){this.updateModelState(),this.updateView()}updateModelState(){}updateView(){const e=this.getViewValue();e!=this.viewState&&(this.viewState=e,this.rootElement.style.left=this.viewState+this.initialLeft+"px")}getViewValue(){if(!this.controls.tables.currModelState.columnSeparators.hasItems)return this.controls.paragraphLeftPosition;const e=this.controls.tables.currModelState.columnSeparators.items[0];return this.controls.leftMargin.currModelState.modelValue+this.controls.columns.currModelState.activeColumn.leftPos+this.controls.tables.currModelState.columnSeparators.cellSpacing+e.leftMargin+e.position}}var d$;!function(e){e[e.Number=0]="Number",e[e.Minor=1]="Minor",e[e.Major=2]="Major"}(d$||(d$={}));class c${constructor(e,t){this.unitMap=e,this.unitSize=t,this.stepSize=this.unitSize/this.unitMap.length}static create(e){return e==KM.Inch?new c$([d$.Number,d$.Minor,d$.Minor,d$.Minor,d$.Major,d$.Minor,d$.Minor,d$.Minor],g.u.inchesToPixels(1)):new c$([d$.Number,d$.Minor,d$.Major,d$.Minor],g.u.centimeterToPixelF(1))}}class h$ extends vU{constructor(e,t,r){super(e),this.hanging=t,this.firstLine=r}}class u$ extends EU{DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.subDocument=this.selection.activeSubDocument,e.intervalsInfo.intervals=this.selection.intervals}getState(e=this.convertToCommandOptions(void 0)){e.subDocument||this.DEPRECATEDCorrectlMainCommandOptions(e);var t=an.getSelectedParagraphs(e.intervalsInfo.intervals,e.subDocument).paragraphs[0].getParagraphMergedProperties(),r=g.u.twipsToPixelsF(t.leftIndent),i=g.u.twipsToPixelsF(t.firstLineIndent);switch(t.firstLineIndentType){case ke.Indented:return new UU(this.isEnabled(),new h$(this.control,r,r+i));case ke.None:return new UU(this.isEnabled(),new h$(this.control,r,r));case ke.Hanging:return new UU(this.isEnabled(),new h$(this.control,r,r-i))}return new UU(this.isEnabled())}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}executeCore(e,t){const r=t,i=t.subDocument;var n=g.u.pixelsToTwips(r.hanging),o=g.u.pixelsToTwips(r.firstLine),a=Math.abs(n-o),s=ke.None;n<o?s=ke.Indented:n>o&&(s=ke.Hanging);var l=this.modelManipulator;this.history.beginTransaction();for(let e of t.intervalsInfo.intervals)this.history.addAndRedo(new pt(l,new gu(i,e),a,!0)),this.history.addAndRedo(new gt(l,new gu(i,e),s,!0)),this.history.addAndRedo(new ft(l,new gu(i,e),n,!0));return this.history.endTransaction(),!0}}class p$ extends EU{getState(e=this.convertToCommandOptions(void 0)){for(var t,r=an.getSelectedParagraphs(e.intervalsInfo.intervals,e.subDocument),i=r.paragraphs[0],n=1;t=r.paragraphs[n];n++)t.getParagraphMergedProperties().rightIndent>i.getParagraphMergedProperties().rightIndent&&(i=t);var o=g.u.twipsToPixelsF(i.getParagraphMergedProperties().rightIndent);return new UU(this.isEnabled(),new h$(this.control,o,void 0))}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}executeCore(e,t){this.history.beginTransaction();for(var r,i=0;r=e.value.intervalsInfo.intervals[i];i++)this.history.addAndRedo(new Pt(this.modelManipulator,new gu(t.subDocument,r),g.u.pixelsToTwips(t.param),!0));return this.history.endTransaction(),!0}}class g${static getLeftIndentTopElementTemplate(){return null}static getLeftIndentBodyElementTemplate(){return null}static getRightIndentElementTemplate(){return null}static getFirstLineIndentElementTemplate(){return null}static getLeftTabElementTemplate(){return null}static getCenterTabElementTemplate(){return null}static getRightTabElementTemplate(){return null}static getDecimalTabElementTemplate(){return null}static getTableColumnDragElementTemplate(){return null}}class m${constructor(e){this.element=e.cloneNode(!0),this.element.style.opacity="0.5",this.element.style.display="",e.parentNode.appendChild(this.element)}dispose(){fn.DomUtils.hideNode(this.element)}}class f$ extends r${constructor(){super(...arguments),this.viewState=0}updateModelState(){this.currModelState=this.getModelState(),this.prevModelState=this.currModelState.clone()}onMouseDown(e,t){return!(!this.canHandle(e)||!this.currModelState.enabled)&&(this.controls.lineControl.show(Wq.Normal),this.lineControlSetPosition(),this.shadow=new m$(this.rootElement),!0)}onMouseMove(e,t){this.calculateNewModelState(e),this.updateView(),this.lineControlSetPosition()}onEscPress(){this.currModelState=this.prevModelState.clone(),this.finishHandle()}finishHandle(){this.controls.lineControl.hide(),this.shadow.dispose()}lineControlSetPosition(){this.controls.lineControl.setPosition(this.viewState,Vq.LeftSide)}}class b$ extends f${get heightOfProtrudingPart(){return this.modelData.showLeftIndent?this._heightOfProtrudingPart:0}getRootClassName(){return this.modelData.styles.firstLineIndentImage.spriteCssClass+" "+this.modelData.styles.firstLineIndent.className}constructor(e,t){super(e,t);const r=g$.getFirstLineIndentElementTemplate();r&&(this.rootElement.innerHTML=r),this.rootElement.title=this.modelData.titles.firstLineIndent,this.controls.ruler.rootElement.appendChild(this.rootElement),this.adjustByTop(),this.leftCorrection=Math.round(gK.getOffsetWidth(this.rootElement)/2),this._heightOfProtrudingPart=gK.getOffsetHeight(this.rootElement)-this.controls.divisions.height/2}adjustByTop(){const e=gK.getOffsetHeight(this.rootElement),t=this.controls.divisions.height;this.rootElement.style.marginTop=(e-t)/2+"px"}getModelState(){const e=this.modelData.commandManager.getCommand(FF.RulerParagraphLeftIndents).getState();return new t$(e.value.firstLine,e.enabled)}updateView(){const e=this.controls.paragraphLeftPosition+this.currModelState.modelValue;e!=this.viewState&&(this.viewState=e,this.modelData.showLeftIndent?this.rootElement.style.left=this.viewState+5-this.leftCorrection+"px":this.setVisible(!1))}canHandle(e){return e==this.rootElement}onMouseUp(){const e=new h$(null,this.controls.leftIndent.currModelState.modelValue,this.currModelState.modelValue);e.setIntervalsInfo(this.modelData.selection.intervalsInfo),this.modelData.commandManager.getCommand(FF.RulerParagraphLeftIndents).execute(this.modelData.commandManager.isPublicApiCall,e),this.finishHandle()}calculateNewModelState(e){const t=this.controls.paragraphLeftPosition;this.currModelState.modelValue=this.controls.chooseClosestAnchorPosition(t+this.prevModelState.modelValue+e,[t+this.prevModelState.modelValue],new xl.MinMaxNumber(0,Math.max(0,this.controls.rightIndent.viewStateRelativeLeft-10)))-t}}const C$=Nq+"leftIndentDragHandleBody";class S$ extends f${get heightOfProtrudingPart(){return this.modelData.showLeftIndent?this._heightOfProtrudingPart:0}getRootClassName(){return this.modelData.styles.leftIndent.className}constructor(e,t){super(e,t),this.isActionLeftIndent=!1,this.topElement=Yj.renderContainer(this.modelData.styles.leftIndentImage.spriteCssClass),this.bodyElement=Yj.renderContainer(C$);const r=g$.getLeftIndentTopElementTemplate();r&&(this.topElement.innerHTML=r);const i=g$.getLeftIndentBodyElementTemplate();i&&(this.bodyElement.innerHTML=i),this.rootElement.appendChild(this.topElement),this.rootElement.appendChild(this.bodyElement),this.controls.ruler.rootElement.appendChild(this.rootElement),this.adjustByTop();const n=this.topElement.offsetWidth;this.bodyElement.style.width=n+"px";const o=this.rootElement.style;o.height=gK.getOffsetHeight(this.topElement)+gK.getOffsetHeight(this.bodyElement)+"px",o.width=n+"px",o.marginTop=this.controls.divisions.height/2+"px",this.bodyElement.title=this.modelData.titles.leftIndent,this.topElement.title=this.modelData.titles.hangingIndent,this.leftCorrection=Math.round(gK.getOffsetWidth(this.rootElement)/2),this._heightOfProtrudingPart=gK.getOffsetHeight(this.rootElement)-this.controls.divisions.height/2}adjustByTop(){const e=gK.getOffsetHeight(this.rootElement),t=this.controls.divisions.height;this.rootElement.style.marginTop=(e-t)/2+"px"}getModelState(){const e=this.modelData.commandManager.getCommand(FF.RulerParagraphLeftIndents).getState();return new t$(e.value.hanging,e.enabled)}updateView(){const e=this.controls.paragraphLeftPosition+this.currModelState.modelValue;e!=this.viewState&&(this.viewState=e,this.modelData.showLeftIndent?this.rootElement.style.left=this.viewState+5-this.leftCorrection+"px":this.setVisible(!1))}canHandle(e){return this.bodyElement==e?(this.isActionLeftIndent=!0,!0):this.topElement==e&&(this.isActionLeftIndent=!1,!0)}onMouseUp(){const e=new h$(null,this.currModelState.modelValue,this.controls.firstLineIndent.currModelState.modelValue);e.setIntervalsInfo(this.modelData.selection.intervalsInfo),this.modelData.commandManager.getCommand(FF.RulerParagraphLeftIndents).execute(this.modelData.commandManager.isPublicApiCall,e),this.finishHandle()}onEscPress(){super.onEscPress(),this.controls.firstLineIndent.currModelState=this.controls.firstLineIndent.prevModelState.clone()}calculateNewModelState(e){const t=this.controls.paragraphLeftPosition;if(this.isActionLeftIndent){const r=Math.min(this.prevModelState.modelValue,this.controls.firstLineIndent.prevModelState.modelValue),i=Math.max(this.prevModelState.modelValue,this.controls.firstLineIndent.prevModelState.modelValue)-r,n=this.controls.chooseClosestAnchorPosition(t+r+e,[t+r],new xl.MinMaxNumber(0,Math.max(0,this.controls.rightIndent.viewStateRelativeLeft-i-10)))-t;this.prevModelState.modelValue<this.controls.firstLineIndent.prevModelState.modelValue?(this.currModelState.modelValue=n,this.controls.firstLineIndent.currModelState.modelValue=n+i):(this.currModelState.modelValue=n+i,this.controls.firstLineIndent.currModelState.modelValue=n)}else this.currModelState.modelValue=this.controls.chooseClosestAnchorPosition(t+this.prevModelState.modelValue+e,[t+this.prevModelState.modelValue],new xl.MinMaxNumber(0,Math.max(0,this.controls.rightIndent.viewStateRelativeLeft-10)))-t}}class I$ extends f${get viewStateRelativeLeft(){return this.controls.ruler.pageWidth-this.viewState}getRootClassName(){return this.modelData.styles.rightIndentImage.spriteCssClass+" "+this.modelData.styles.rightIndent.className}constructor(e,t){super(e,t);const r=g$.getRightIndentElementTemplate();r&&(this.rootElement.innerHTML=r),this.rootElement.title=this.modelData.titles.rightIndent,this.controls.ruler.rootElement.appendChild(this.rootElement),this.adjustByTop(),this.leftCorrection=Math.round(this.rootElement.offsetWidth/2)}adjustByTop(){const e=this.controls.divisions.height;this.rootElement.style.marginTop=e/2+"px"}getModelState(){const e=this.modelData.commandManager.getCommand(FF.RulerParagraphRightIndent).getState();return new t$(e.value.hanging,e.enabled)}updateView(){const e=this.correctRelativeLeftIndents(this.controls.ruler.pageWidth-this.controls.paragraphRightPosition+this.currModelState.modelValue);e!=this.viewState&&(this.viewState=e,this.modelData.showRightIndent?this.rootElement.style.right=this.viewState+5-this.leftCorrection+"px":this.setVisible(!1))}correctRelativeLeftIndents(e){const t=Math.max(this.controls.leftIndent.viewState,this.controls.firstLineIndent.viewState);return Math.min(this.controls.ruler.pageWidth-(t+5),e)}canHandle(e){return e==this.rootElement}onMouseUp(){this.modelData.commandManager.getCommand(FF.RulerParagraphRightIndent).execute(this.modelData.commandManager.isPublicApiCall,this.currModelState.modelValue),this.finishHandle()}lineControlSetPosition(){this.controls.lineControl.setPosition(this.viewState,Vq.RightSide)}calculateNewModelState(e){const t=this.controls.paragraphRightPosition,r=Math.max(this.controls.leftIndent.viewState,this.controls.firstLineIndent.viewState);this.currModelState.modelValue=t-this.controls.chooseClosestAnchorPosition(t-this.prevModelState.modelValue+e,[t-this.prevModelState.modelValue],new xl.MinMaxNumber(Math.max(0,r+10),this.controls.ruler.pageWidth))}}class P$ extends r${constructor(){super(...arguments),this.viewState=0}updateModelState(){this.currModelState=this.getModelState(),this.prevModelState=this.currModelState.clone()}updateView(){const e=this.getViewState();if(e!=this.viewState){this.viewState=e;for(let e of[this.marginPanelElement,this.handlePanelElement])this.setViewStateToElement(e)}}canHandle(e){return e==this.handlePanelElement&&!this.controls.tables.currModelState.columnSeparators.hasItems&&(this.modelData.selection.activeSubDocument.isMain()||this.modelData.selection.activeSubDocument.isHeaderFooter())}onMouseDown(e,t){return!(!this.canHandle(e)||!this.currModelState.enabled)&&(this.controls.lineControl.show(Wq.Normal),this.lineControlSetPosition(),!0)}onMouseMove(e,t){this.calculateNewModelState(e),this.controls.columns.marginsChanged(this.currModelState.modelValue-this.prevModelState.modelValue),this.updateView(),this.lineControlSetPosition()}onMouseUp(){this.modelData.commandManager.getCommand(this.commandType).execute(this.modelData.commandManager.isPublicApiCall,this.currModelState.modelValue),this.finishHandle()}onEscPress(){this.currModelState=this.prevModelState.clone(),this.finishHandle()}getModelState(){const e=this.modelData.commandManager.getCommand(this.commandType).getState();return new t$(e.value,e.enabled)}finishHandle(){this.controls.lineControl.hide()}}const w$=kq+"MarginLeftHandlePanel",y$=kq+"MarginLeftPanel";class x$ extends P${getRootClassName(){return""}get commandType(){return FF.RulerSectionMarginLeft}constructor(e,t,r){super(e,t),this.initialLeft=-(Math.ceil(r)-5),this.marginPanelElement=Yj.renderContainer(y$),this.handlePanelElement=Yj.renderContainer(w$),this.marginPanelElement.style.width=r+"px",this.handlePanelElement.style.width=r+"px",this.handlePanelElement.title=this.modelData.titles.marginLeft,this.controls.ruler.rootElement.appendChild(this.marginPanelElement),this.controls.ruler.rootElement.appendChild(this.handlePanelElement)}setViewStateToElement(e){e.style.left=this.viewState+this.initialLeft+"px"}getViewState(){return this.controls.tables.currModelState.columnSeparators.hasItems?this.controls.leftMargin.currModelState.modelValue+this.controls.columns.currModelState.activeColumn.leftPos+this.controls.tables.currModelState.columnSeparators.items[0].position:this.controls.leftMargin.currModelState.modelValue}lineControlSetPosition(){this.controls.lineControl.setPosition(this.viewState,Vq.LeftSide)}calculateNewModelState(e){this.currModelState.modelValue=this.controls.chooseClosestAnchorPosition(this.prevModelState.modelValue+e,[this.prevModelState.modelValue],new xl.MinMaxNumber(0,Math.max(0,this.controls.rightMargin.viewStateRelativeLeft-50)))}}const T$=kq+"MarginRightPanel",v$=kq+"MarginRightHandlePanel";class M$ extends P${get viewStateRelativeLeft(){return this.controls.ruler.pageWidth-this.viewState}getRootClassName(){return""}get commandType(){return FF.RulerSectionMarginRight}constructor(e,t,r){super(e,t),this.marginPanelElement=Yj.renderContainer(T$),this.handlePanelElement=Yj.renderContainer(v$),this.marginPanelElement.style.width=r+"px",this.handlePanelElement.style.width=r+"px",this.handlePanelElement.title=this.modelData.titles.marginRight,this.controls.ruler.rootElement.appendChild(this.marginPanelElement),this.controls.ruler.rootElement.appendChild(this.handlePanelElement)}setViewStateToElement(e){e.style.width=this.viewState+5+"px"}getViewState(){const e=this.controls.tables.currModelState.columnSeparators;if(e.hasItems){const t=this.controls.leftMargin.currModelState.modelValue+this.controls.columns.currModelState.activeColumn.leftPos+f.ListUtils.last(e.items).position;return this.controls.ruler.pageWidth-t}return this.currModelState.modelValue}lineControlSetPosition(){this.controls.lineControl.setPosition(this.viewState,Vq.RightSide)}calculateNewModelState(e){this.currModelState.modelValue=this.controls.ruler.pageWidth-this.controls.chooseClosestAnchorPosition(this.controls.ruler.pageWidth-this.prevModelState.modelValue+e,[this.controls.ruler.pageWidth-this.prevModelState.modelValue],new xl.MinMaxNumber(Math.max(0,this.controls.leftMargin.viewState+50),this.controls.ruler.pageWidth))}}var E$=__webpack_require__(1632);class D$ extends r${getRootClassName(){return this.modelData.styles.control.className}get pageWidth(){return this.currPageWidth}constructor(e,t){super(e,t),this.canHandleScroll=!1,this.initialMarginLeftElement=0,this.currPageWidth=0,this.prevPageWidth=0,this.rootElement=Yj.renderContainer(this.modelData.styles.control.className),yH.Browser.MSTouchUI&&fn.DomUtils.addClassName(this.rootElement,E$.TouchUtils.msTouchDraggableClassName),this.controls.wrapper.rootElement.appendChild(this.rootElement)}init(){this.rootElement.style.height=this.controls.divisions.height+"px",this.setPaddings()}setPaddings(){this.rootElement.style.paddingBottom=this.controls.leftIndent.heightOfProtrudingPart+"px",this.rootElement.style.paddingTop=this.controls.firstLineIndent.heightOfProtrudingPart+"px"}updateModelState(){this.currPageWidth=g.u.twipsToPixelsF(this.modelData.inputPosition.getMergedSectionPropertiesRaw().pageSize.width)}updateView(){this.prevPageWidth!=this.currPageWidth&&(this.prevPageWidth=this.currPageWidth,this.rootElement.style.width=this.pageWidth+10+"px",this.adjust())}adjust(){const e=this.controls.canvas.clientWidth;if(e>this.controls.ruler.pageWidth)this.initialMarginLeftElement=(e-this.pageWidth-10)/2;else{const e=fn.DomUtils.pxToInt(fn.DomUtils.getCurrentStyle(this.controls.canvas).paddingLeft),t=(this.controls.canvas.scrollWidth-e-this.pageWidth)/2;this.initialMarginLeftElement=e+t-5}this.rootElement.style.left=this.calculateLeftOffset(),this.setPaddings(),this.canHandleScroll=this.controls.canvas.scrollWidth>this.controls.canvas.offsetWidth}onScroll(){this.canHandleScroll&&(this.rootElement.style.left=this.calculateLeftOffset())}calculateLeftOffset(){return Math.round(this.initialMarginLeftElement-this.controls.canvas.scrollLeft)+"px"}}class F${static getTabTitlePropertyName(e){let t="";switch(e){case Ha.Left:t="Left";break;case Ha.Right:t="Right";break;case Ha.Center:t="Center";break;case Ha.Decimal:t="Decimal"}return"tab"+t}static getSpriteClassName(e,t){switch(e){case Ha.Left:return t.tabImages.left.spriteCssClass;case Ha.Right:return t.tabImages.right.spriteCssClass;case Ha.Center:return t.tabImages.center.spriteCssClass;case Ha.Decimal:return t.tabImages.decimal.spriteCssClass}return""}static getTemplate(e){switch(e){case Ha.Left:return g$.getLeftTabElementTemplate();case Ha.Right:return g$.getRightTabElementTemplate();case Ha.Center:return g$.getCenterTabElementTemplate();case Ha.Decimal:return g$.getDecimalTabElementTemplate()}}}var R$;!function(e){e[e.None=0]="None",e[e.Insert=1]="Insert",e[e.Delete=2]="Delete",e[e.Move=3]="Move"}(R$||(R$={}));class L${constructor(e,t){this.tabs=e,this.enabled=t}clone(){return new L$(f.ListUtils.deepCopy(this.tabs),this.enabled)}}class B${constructor(e,t){this.position=e,this.align=t}equals(e){return this.position==e.position&&this.align==e.align}clone(){return new B$(this.position,this.align)}}class A$ extends Uq{constructor(){super(...arguments),this.tabAction=R$.None,this.newTab=null,this.deleteTab=!1}getModelState(){if(this.modelData.showTabs=this.modelData.commandManager.getCommand(FF.InsertTabRuler).getState().enabled,this.modelData.showTabs){const e=this.modelData.selection.activeSubDocument.getParagraphByPosition(this.modelData.selection.intervalsInfo.interval.start),t=f.ListUtils.map(e.getTabs().positions,(e=>{const t=e.clone();return t.position=g.u.twipsToPixelsF(e.position),t}));return new L$(t,!0)}return new L$([],!1)}updateView(){const e=this.controls.paragraphLeftPosition;this.viewState=f.ListUtils.map(this.currModelState.tabs,(t=>new B$(e+t.position,t.alignment))),this.setCount(this.viewState.length),f.ListUtils.forEach2(this.subControls,this.viewState,((e,t)=>e.setValue(t)))}createSubControl(){return new N$(this.modelData,this.controls)}isTabMarkZone(e){return tX.g.getEventY(e)-fn.DomUtils.getAbsolutePositionY(this.controls.ruler.rootElement)>=6}onMouseDown(e,t){if(!this.currModelState.enabled||this.modelData.isReadOnly)return!1;return!!this.calculateExactHit(e)||!!this.tryInsertNewTab(t)}calculateExactHit(e){return f.ListUtils.unsafeAnyOf(this.subControls,((t,r)=>!!t.canHandle(e)&&(this.handleControlIndex=r,this.updatePresentation(),!0)))}updatePresentation(){this.controls.lineControl.show(Wq.Normal),this.activeSubControl.lineControlSetPosition()}tryInsertNewTab(e){const t=tX.g.getEventX(e)-fn.DomUtils.getAbsolutePositionX(this.controls.ruler.rootElement)-5-this.controls.paragraphLeftPosition;if(this.isTabMarkZone(e)&&t>=this.minPosition()&&t<=this.maxPosition()){this.tabAction=R$.Insert,this.handleControlIndex=this.currModelState.tabs.length;const e=this.controls.chooseClosestAnchorPosition(t,[],new xl.MinMaxNumber(this.minPosition(),this.maxPosition()));return this.newTab=new rs(e,this.controls.tabTypeBox.align,Sg.None,!1,!1),this.currModelState.tabs.push(this.newTab.clone()),this.updateView(),this.updatePresentation(),!0}return!1}onMouseMove(e,t){const r=!fn.DomUtils.isItParent(this.controls.ruler.rootElement,t);r!=this.deleteTab&&(this.deleteTab=r,this.activeSubControl.setVisible(!this.deleteTab)),super.onMouseMove(e,t),this.tabAction==R$.None&&(this.tabAction=R$.Move,this.activeSubControl.showShadow())}onMouseUp(){switch(this.activeSubControl.setVisible(!this.deleteTab),this.tabAction){case R$.Insert:if(this.deleteTab)this.currModelState=this.prevModelState.clone(),this.updateView();else{const e=this.currModelState.tabs[this.handleControlIndex];this.modelData.commandManager.getCommand(FF.InsertTabRuler).execute(this.modelData.commandManager.isPublicApiCall,{position:e.position,align:e.alignment})}break;case R$.Move:this.deleteTab?this.modelData.commandManager.getCommand(FF.DeleteTabRuler).execute(this.modelData.commandManager.isPublicApiCall,this.prevModelState.tabs[this.handleControlIndex].position):this.modelData.commandManager.getCommand(FF.MoveTabRuler).execute(this.modelData.commandManager.isPublicApiCall,{start:this.prevModelState.tabs[this.handleControlIndex].position,end:this.currModelState.tabs[this.handleControlIndex].position})}this.finishHandle()}finishHandle(){super.finishHandle(),this.tabAction=R$.None,this.newTab=null,this.deleteTab=!1,this.subControls.forEach((e=>e.setVisible(!0)))}minPosition(){return Math.min(this.controls.leftIndent.currModelState.modelValue,this.controls.firstLineIndent.currModelState.modelValue)}maxPosition(){return this.controls.paragraphRightPosition-this.controls.rightIndent.currModelState.modelValue-this.controls.paragraphLeftPosition}calculateNewModelState(e){switch(this.tabAction){case R$.Insert:{const t=this.newTab.position;this.currModelState.tabs[this.handleControlIndex].position=this.controls.chooseClosestAnchorPosition(t+e,[t],new xl.MinMaxNumber(this.minPosition(),this.maxPosition()));break}case R$.Move:{const t=this.prevModelState.tabs[this.handleControlIndex].position;this.currModelState.tabs[this.handleControlIndex].position=this.controls.chooseClosestAnchorPosition(t+e,[t],new xl.MinMaxNumber(this.minPosition(),this.maxPosition()));break}}}}class N${constructor(e,t){this.viewState=new B$(0,-1),this.shadow=null,this.controls=t,this.modelData=e,this.rootElement=Yj.renderContainer(e.styles.tab.className+" "+F$.getSpriteClassName(this.viewState.align,e.styles)),this.applyTemplate(),t.ruler.rootElement.appendChild(this.rootElement),this.rootElement.style.marginTop=t.divisions.height-this.rootElement.offsetHeight+"px",this.setCorrection()}dispose(){this.hideShadow(),fn.DomUtils.hideNode(this.rootElement),this.rootElement=null}setVisible(e){this.rootElement.style.display=e?"block":"none"}canHandle(e){return e==this.rootElement&&this.modelData.showTabs}showShadow(){this.shadow=new m$(this.rootElement)}hideShadow(){this.shadow&&(this.shadow.dispose(),this.shadow=null)}lineControlSetPosition(){this.controls.lineControl.setPosition(this.viewState.position,Vq.LeftSide)}setValue(e){this.viewState&&e.equals(this.viewState)||(this.viewState=e.clone(),this.changeAlign(),this.rootElement.style.left=e.position-this.leftCorrection+5+"px")}setCorrection(){switch(this.viewState.align){case Ha.Left:this.leftCorrection=0;break;case Ha.Right:this.leftCorrection=this.rootElement.offsetWidth;break;case Ha.Center:case Ha.Decimal:this.leftCorrection=Math.round(this.rootElement.offsetWidth/2)}}changeAlign(){this.rootElement.className=this.modelData.styles.tab.className+" "+F$.getSpriteClassName(this.viewState.align,this.modelData.styles),this.applyTemplate(),this.rootElement.title=this.modelData.titles[F$.getTabTitlePropertyName(this.viewState.align)],this.setCorrection()}applyTemplate(){const e=F$.getTemplate(this.viewState.align);e&&(this.rootElement.innerHTML=e)}}const k$=Nq+"rulertabAlignBox";class O$ extends r${getRootClassName(){return k$}constructor(e,t){super(e,t),this.evtHandlersHolder=new rX.$,this.align=Ha.Left,this.innerSquareElement=Yj.renderContainer(""),this.alignElement=Yj.renderContainer(F$.getSpriteClassName(this.align,this.modelData.styles)),this.applyTemplate(),this.innerSquareElement.appendChild(this.alignElement),this.rootElement.appendChild(this.innerSquareElement),this.controls.wrapper.rootElement.appendChild(this.rootElement),this.evtHandlersHolder.addListener(this.innerSquareElement,E$.TouchUtils.touchMouseDownEventName,this.onMouseDown.bind(this))}init(){this.adjust()}dispose(){super.dispose(),this.innerSquareElement=null,this.alignElement=null,this.evtHandlersHolder.removeAllListeners()}adjust(){const e=this.controls.divisions.rootElement.offsetTop+this.controls.ruler.rootElement.offsetTop,t=this.controls.divisions.height;this.innerSquareElement.style.width=t+"px",this.innerSquareElement.style.height=t+"px",this.innerSquareElement.style.top=e+"px",this.innerSquareElement.style.left=e+"px",this.rootElement.style.width=t+2*e+"px",this.rootElement.style.height=t+2*e+"px",this.adjustAlignElement()}adjustAlignElement(){const e=this.innerSquareElement.offsetWidth;this.alignElement.style.top=(e-this.alignElement.offsetHeight)/2+"px",this.alignElement.style.left=(e-this.alignElement.offsetWidth)/2+"px",this.alignElement.title=this.modelData.titles[F$.getTabTitlePropertyName(this.align)]}onMouseDown(e){this.modelData.isReadOnly||(this.align++,this.align>Ha.Decimal&&(this.align=Ha.Left),this.alignElement.className=F$.getSpriteClassName(this.align,this.modelData.styles),this.applyTemplate(),this.adjustAlignElement(),tX.g.preventEvent(e))}applyTemplate(){const e=F$.getTemplate(this.align);e&&(this.alignElement.innerHTML=e)}}class _${constructor(){this.parentCell=null,this.parentLink=null,this.layoutRowIndexInParentCell=-1}createParentLink(){return this.createParentLinkInternal(this)}createParentLinkInternal(e){if(e.parentLink)return this.createParentLinkInternal(e.parentLink);var t=new _$;return e.parentLink=t,t}}class U${get tableCellInfo(){return this.tableCellInfoInternal}get isInTable(){return this.layoutRowIndexInCell>-1}constructor(e,t,r){if(this.tableIndex=-1,this.tableRowIndex=-1,this.tableCellIndex=-1,this.layoutRowIndexInCell=-1,this.layoutRowIndexInLayout=-1,this.layoutRowIndexInLayoutInitial=-1,this.pageIndex=0,this.pageAreaIndex=0,this.columnIndex=0,this.skipCalculateCellIndex=!1,this.canCalculateLastCellIndex=!1,this.position=e,this.layout=t,this.measurer=r,this.setPositionProperties(),this.readTables(this.position.column.tablesInfo))for(let e,t=0;e=this.position.column.tablesInfo[t];t++)if(e==this.tableInfo){this.tableIndex=t;break}}readTables(e,t=null,r=-1){for(let a,s=0;a=e[s];s++)for(let e,s=0;e=a.tableRows[s];s++)for(let l,d=0;l=a.tableRows[s].rowCells[d];d++){for(var i in l.internalTables)if(this.readTables(this.getConvertedObjectToArray(l.internalTables),l,parseInt(i))){var n=this.parentLink.createParentLink();return n.parentCell=t,n.layoutRowIndexInParentCell=r,!0}var o=C.SearchUtils.binaryIndexOf(l.layoutRows,(e=>e.indexInColumn-this.position.rowIndex));if(o>=0)return this.tableInfo=a,this.tableRowIndex=s,this.tableRowInfo=e,this.tableCellIndex=d,this.tableCellInfoInternal=l,this.layoutRowIndexInCell=o,this.layoutRowIndexInLayout=l.layoutRows[o].indexInColumn,this.layoutRowIndexInLayoutInitial=this.layoutRowIndexInLayout,this.parentLink=new _$,this.parentLink.parentCell=t,this.parentLink.layoutRowIndexInParentCell=r,!0}return!1}getConvertedObjectToArray(e){return b.j.toList(e)}setPositionProperties(){this.pageIndex=this.position.pageIndex,this.pageAreaIndex=this.position.pageAreaIndex,this.columnIndex=this.position.columnIndex}isMainSubDocument(){return this.position.pageArea.subDocument.isMain()}getSelectedInterval(){return this.tableInfo.logicInfo.grid.table.rows[this.tableRowIndex].cells[this.tableCellInfoInternal.cellGridIndex].interval}getModifyPosition(){var e=this.position.clone();return this.isMainSubDocument()&&(e.pageIndex=this.pageIndex,e.pageAreaIndex=this.pageAreaIndex,e.columnIndex=this.columnIndex,e.page=this.layout.pages[e.pageIndex],e.pageArea=e.page.mainSubDocumentPageAreas[e.pageAreaIndex],e.column=e.pageArea.columns[e.columnIndex]),e.rowIndex=this.layoutRowIndexInLayout,e.row=e.column.rows[e.rowIndex],e}tryAdvanceToRightCell(){return this.skipCalculateCellIndex=!0,this.tableCellIndex++,this.tableCellIndex>=this.tableRowInfo.rowCells.length?(this.tableCellIndex=0,this.tryAdvanceToBelowRowInternal()):this.updateTableInfosIfAdvanceToBelowRow()}tryAdvanceToLeftCell(){return this.skipCalculateCellIndex=!0,this.tableCellIndex--,this.tableCellIndex<0?(this.canCalculateLastCellIndex=!0,this.tryAdvanceToAboveRowInternal()):this.updateTableInfosIfAdvanceToAboveRow()}tryAdvanceToBelowRow(){return!!this.canAdvanceToBelowRow()&&this.tryAdvanceToBelowRowInternal()}tryAdvanceToBelowRowInternal(){if(this.isDownDirection=!0,this.tableRowIndex++,this.tableRowIndex>=this.tableInfo.tableRows.length){if(this.tableRowIndex=0,this.tableIndex=0,!this.isMainSubDocument())return this.tryAdvanceToLayoutRowBelowTable();if(this.columnIndex++,this.columnIndex>=this.position.pageArea.columns.length&&(this.columnIndex=0,this.pageAreaIndex++,this.pageAreaIndex>=this.position.page.mainSubDocumentPageAreas.length&&(this.pageAreaIndex=0,this.pageIndex++,this.pageIndex>=this.layout.validPageCount)))return this.tryAdvanceToLayoutRowBelowTable()}return!!this.updateTableInfosIfAdvanceToBelowRow()||this.tryAdvanceToLayoutRowBelowTable()}updateTableInfosIfAdvanceToBelowRow(){var e=this.getTables();if(e.length>0&&this.isEqualTables(e[this.tableIndex],this.tableInfo)){for(this.tableInfo=e[this.tableIndex],this.tableRowInfo=this.tableInfo.tableRows[this.tableRowIndex],this.skipCalculateCellIndex||(this.tableCellIndex=this.findNextCellIndex(this.tableRowInfo)),this.tableCellInfoInternal=this.tableRowInfo.rowCells[this.tableCellIndex];!this.tableCellInfoInternal.layoutRows.length;)this.tableInfo=this.tableCellInfoInternal.internalTables[0],this.tableRowIndex=0,this.tableRowInfo=this.tableInfo.tableRows[this.tableRowIndex],this.tableCellIndex=0,this.tableCellInfoInternal=this.tableRowInfo.rowCells[this.tableCellIndex];return this.layoutRowIndexInLayout=this.tableCellInfoInternal.layoutRows[0].indexInColumn,this.goToInternalTableIfExistInFirstBelowRow(),!0}return!1}tryAdvanceToAboveRow(){return!!this.canAdvanceToAboveRow()&&this.tryAdvanceToAboveRowInternal()}getLayoutTablesAssociatedWithLogicGrid(){var e=[];for(this.setPositionProperties(),e.push(this.tableInfo);this.tryAdvanceToAboveTable();)e.push(this.tableInfo);return e}tryAdvanceToAboveTable(){var e=!1,t=!1;if(this.columnIndex--,this.columnIndex<0&&(e=!0,this.pageAreaIndex--,this.pageAreaIndex<0&&(t=!0),this.pageIndex--,this.pageIndex<0))return!1;t&&(this.pageAreaIndex=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas.length-1),e&&(this.columnIndex=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas[this.pageAreaIndex].columns.length-1);var r=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas[this.pageAreaIndex].columns[this.columnIndex].tablesInfo;for(let e,t=0;e=r[t];t++)if(e.logicInfo.grid==this.tableInfo.logicInfo.grid)return this.tableInfo=e,!0;return!1}tryAdvanceToAboveRowInternal(){var e=!1,t=!1,r=!1;if(this.isDownDirection=!1,1==this.tableCellInfoInternal.layoutRows.length&&this.tableCellInfoInternal.internalTables[this.layoutRowIndexInCell]&&this.goToInternalTableIfExistInLastAboveRow())return!0;var i=[];if(this.tableRowIndex--,this.tableRowIndex<0){if(!this.isMainSubDocument())return this.tryAdvanceToLayoutRowAboveTable();if(e=!0,this.columnIndex--,this.columnIndex<0&&(t=!0,this.pageAreaIndex--,this.pageAreaIndex<0&&(r=!0,this.pageIndex--,this.pageIndex<0)))return this.tryAdvanceToLayoutRowAboveTable();if(r&&(this.pageAreaIndex=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas.length-1),t&&(this.columnIndex=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas[this.pageAreaIndex].columns.length-1),e){if(0==(i=this.getTables()).length)return!1;this.tableIndex=i.length-1,this.tableRowIndex=i[this.tableIndex].tableRows.length-1}}return!!this.updateTableInfosIfAdvanceToAboveRow()||this.tryAdvanceToLayoutRowAboveTable()}updateTableInfosIfAdvanceToAboveRow(){var e=this.getTables();return!!(e.length>0&&this.isEqualTables(e[this.tableIndex],this.tableInfo))&&(this.tableInfo=e[this.tableIndex],this.tableRowInfo=this.tableInfo.tableRows[this.tableRowIndex],this.skipCalculateCellIndex||(this.tableCellIndex=this.findNextCellIndex(this.tableRowInfo),this.tableRowInfo=this.tableInfo.tableRows[this.tableRowIndex]),this.canCalculateLastCellIndex&&(this.tableCellIndex=this.tableRowInfo.rowCells.length-1),this.tableCellInfoInternal=this.tableRowInfo.rowCells[this.tableCellIndex],this.layoutRowIndexInLayout=this.tableCellInfoInternal.layoutRows[this.tableCellInfoInternal.layoutRows.length-1].indexInColumn,this.goToInternalTableIfExistInLastAboveRow(),!0)}tryAdvanceToLayoutRowBelowTable(){this.setPositionProperties();var e=f.ListUtils.last(f.ListUtils.last(f.ListUtils.last(this.tableInfo.tableRows).rowCells).layoutRows),t=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas[this.pageAreaIndex].columns[this.columnIndex];if(this.layoutRowIndexInLayout=e.indexInColumn+1,this.layoutRowIndexInLayout>=t.rows.length){if(this.columnIndex++,this.columnIndex>=this.position.pageArea.columns.length&&(this.columnIndex=0,this.pageAreaIndex++,this.pageAreaIndex>=this.position.page.mainSubDocumentPageAreas.length&&(this.pageAreaIndex=0,this.pageIndex++,this.pageIndex>=this.layout.validPageCount)))return this.setPositionProperties(),this.resetLayoutRowIndex(),!0;this.layoutRowIndexInLayout=0}return!0}isAboveLayoutRowOuterTable(){return this.parentLink&&this.parentLink.parentCell&&0==this.parentLink.layoutRowIndexInParentCell}tryAdvanceToLayoutRowOuterTable(e){var t=e.parentCell.parentRow,r=t.parentTable;if(0==t.rowIndex&&e.parentLink.parentCell)return this.tryAdvanceToLayoutRowOuterTable(e.parentLink);if(t.rowIndex>0){var i=this.findNextCellIndex(r.tableRows[t.rowIndex-1],!0);return this.layoutRowIndexInLayout=f.ListUtils.last(r.tableRows[t.rowIndex-1].rowCells[i].layoutRows).indexInColumn,!0}return!1}tryAdvanceToLayoutRowAboveTable(){if(this.setPositionProperties(),this.isAboveLayoutRowOuterTable())return this.tryAdvanceToLayoutRowOuterTable(this.parentLink);var e=!1,t=!1,r=this.tableInfo.tableRows[0].rowCells[0].layoutRows[0];if(this.layoutRowIndexInLayout=r.indexInColumn-1,this.layoutRowIndexInLayout<0){if(this.columnIndex--,this.columnIndex<0&&(e=!0,this.pageAreaIndex--,this.pageAreaIndex<0&&(t=!0,this.pageIndex--,this.pageIndex<0)))return this.setPositionProperties(),this.resetLayoutRowIndex(),!0;t&&(this.pageAreaIndex=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas.length-1),e&&(this.columnIndex=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas[this.pageAreaIndex].columns.length-1);var i=this.layout.pages[this.pageIndex].mainSubDocumentPageAreas[this.pageAreaIndex].columns[this.columnIndex].rows;this.layoutRowIndexInLayout=i.length-1}return!0}goToInternalTableIfExistInFirstBelowRow(){if(this.tableCellInfoInternal.internalTables&&this.tableCellInfoInternal.internalTables[0]){var e=this.tableCellInfoInternal.internalTables[0];return this.tableCellInfoInternal=e.tableRows[0].rowCells[this.findNextCellIndex(e.tableRows[0])],this.goToInternalTableIfExistInFirstBelowRow()?!0:(this.layoutRowIndexInLayout=this.tableCellInfoInternal.layoutRows[0].indexInColumn,!0)}return!1}goToInternalTableIfExistInLastAboveRow(){var e=this.tableCellInfoInternal.layoutRows.length-1;if(this.tableCellInfoInternal.internalTables&&this.tableCellInfoInternal.internalTables[e]){var t=this.tableCellInfoInternal.internalTables[e],r=t.tableRows.length-1,i=this.findNextCellIndex2(t.tableRows[r]),n=t.tableRows[r].rowCells[i].layoutRows.length-1;return this.layoutRowIndexInLayout=t.tableRows[r].rowCells[i].layoutRows[n].indexInColumn,!0}return!1}canAdvanceToBelowRow(){return this.isInTable&&this.layoutRowIndexInCell==this.tableCellInfoInternal.layoutRows.length-1}canAdvanceToAboveRow(){return this.isInTable&&0==this.layoutRowIndexInCell}resetLayoutRowIndex(){this.layoutRowIndexInLayout=this.layoutRowIndexInLayoutInitial}isEqualTables(e,t){return e.logicInfo.grid==t.logicInfo.grid}getTables(){return this.isMainSubDocument()?this.layout.pages[this.pageIndex].mainSubDocumentPageAreas[this.pageAreaIndex].columns[this.columnIndex].tablesInfo:this.position.column.tablesInfo}findNextCellIndex(e,t=!1){var r=this.position.box.getCharOffsetXInPixels(this.measurer,this.position.charOffset)+this.position.box.x+this.position.row.x;if(!this.isDownDirection&&!t)for(let e=this.tableRowIndex;e>=0;e--){const t=this.tableInfo.tableRows[e],n=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(t.rowCells,(e=>e.x),r));var i=t.rowCells[n];if(r>=i.x&&r<=i.x+i.width)return this.tableRowIndex=e,n}for(var n=0;n<e.rowCells.length;n++){var o=e.rowCells[n];if(r>=o.x&&r<=o.right)return n}return 0}findNextCellIndex2(e){var t=this.position.box.getCharOffsetXInPixels(this.measurer,this.position.charOffset)+this.position.box.x+this.position.row.x;if(!this.isDownDirection){const i=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(e.rowCells,(e=>e.x),t));var r=e.rowCells[i];if(t>=r.x&&t<=r.right)return this.tableRowIndex=e.rowIndex,i}for(var i=0;i<e.rowCells.length;i++){var n=e.rowCells[i];if(t>=n.x&&t<=n.right)return i}return 0}}class H${constructor(){this.index=0,this.tableIndex=0,this.cellSpacing=0,this.minValue=-1,this.maxValue=-1,this.items=[]}get currItem(){return this.items[this.index]}get hasItems(){return this.items.length>0}createItem(e,t,r){this.items.push(new V$(e,t,r))}clone(){const e=new H$;return e.index=this.index,e.tableIndex=this.tableIndex,e.minValue=this.minValue,e.maxValue=this.maxValue,e.items=f.ListUtils.deepCopy(this.items),e}}class V${constructor(e,t,r){this.position=e,this.leftMargin=t,this.rightMargin=r}clone(){return new V$(this.position,this.leftMargin,this.rightMargin)}}class W$ extends EU{DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.interval=this.selection.lastSelectedInterval}getState(e=this.convertToCommandOptions(void 0)){return new UU(this.isEnabled(),this.getColumnSeparatorsInfo(e.intervalsInfo.position,e.subDocument))}executeCore(e,t){return!0}getLogicCell(e,t,r){return e.table.rows[t].cells[e.tableCellGridInfos[t][r].getCellIndex(0)]}getMergedCell(e,t,r){let i=e[0];if(e.length>1)for(let t,n=0;t=e[n];n++){if(t.tableRows[r]){i=t;break}r-=t.tableRows.length}return this.findLayoutCellByCellGridIndex(i.tableRows[r].rowCells,t.getGridCellIndex())}getColumnSeparatorsInfo(e,t){let r=null;const i=e=>{if(null==r){const t=e.parentRow.parentTable,i=new Xa(this.control.modelManager.model,t,e.parentRow.tablePropertiesException).getProperty(e.parentRow.properties,t.style,e.conditionalFormatting,this.control.modelManager.model.defaultTableRowProperties);r=g.u.twipsToPixelsF(i.value)}return r};let n=new H$;if(this.selection.tableInfo.extendedData.numRows){let r=(t.isMain()?new ug(this.control.layout,t,e,Hu.Character):new pg(this.control.layout,t,e,this.selection.pageIndex,Hu.Character)).create((new cg).setDefault(!1),(new cg).setDefault(!1));if(r){let e=new U$(r,this.control.layout,this.control.measurer),t=e.tableCellInfo;if(t){let r=e.getLayoutTablesAssociatedWithLogicGrid(),a=t.parentRow.parentTable,s=a.logicInfo.grid,l=t.parentRow.rowIndex,d=s.tableCellInfos[l],c=!1;for(let e,t=0;e=d[t];t++){var o=e.getStartRowIndex();if(o!=l){let a=this.getMergedCell(r,e,o);if(a){let e=this.getLogicCell(s,o,a.cellGridIndex),r=a.x;t==d.length-1&&(c=!0,n.createItem(r+a.width,0,0),i(e)),n.createItem(r,this.getMarginLeft(e),this.getMarginRight(e)),i(e)}}}for(let e,r=0;e=t.parentRow.rowCells[r];r++){let t=this.getLogicCell(s,l,e.cellGridIndex);n.createItem(e.x,this.getMarginLeft(t),this.getMarginRight(t)),i(t)}if(!c){let e=f.ListUtils.last(t.parentRow.rowCells);n.createItem(e.right,0,0)}n.tableIndex=s.table.index,n.items=n.items.sort(((e,t)=>e.position-t.position)),n.index=C.SearchUtils.normedInterpolationIndexOf(n.items,(e=>e.position),t.x),a.parentCell&&(n.minValue=a.parentCell.x,n.maxValue=a.parentCell.right)}}}return n.cellSpacing=null==r?0:r,n}getMarginLeft(e){let t=e.parentRow.parentTable,r=new Hr(t,this.control.modelManager.model,e.parentRow.tablePropertiesException).getProperty(e.properties,t.style,e.conditionalFormatting,this.control.modelManager.model.defaultTableCellProperties);return g.u.twipsToPixelsF(r.value)}getMarginRight(e){let t=e.parentRow.parentTable,r=new Vr(t,this.control.modelManager.model,e.parentRow.tablePropertiesException).getProperty(e.properties,t.style,e.conditionalFormatting,this.control.modelManager.model.defaultTableCellProperties);return g.u.twipsToPixelsF(r.value)}findLayoutCellByCellGridIndex(e,t){return e[C.SearchUtils.normedInterpolationIndexOf(e,(e=>e.cellGridIndex),t)]}}const z$=Nq+"rulerTableColumnSeparatorHandle";class j${constructor(e,t,r){this.columnSeparators=e,this.tableIndex=t,this.enabled=r}clone(){return new j$(this.columnSeparators.clone(),this.tableIndex,this.enabled)}}class X${constructor(e,t,r){this.leftMargin=e,this.rightMarginOfPrevColumn=t,this.position=r}equals(e){return this.leftMargin==e.leftMargin&&this.rightMarginOfPrevColumn==e.rightMarginOfPrevColumn&&this.position==e.position}clone(){return new X$(this.leftMargin,this.rightMarginOfPrevColumn,this.position)}}class G$ extends Uq{getModelState(){const e=this.modelData.commandManager.getCommand(FF.RulerTableColumnSeparators).getState();return e.enabled?new j$(e.value,e.value.tableIndex,e.enabled):new j$(new H$,-1,!1)}updateView(){const e=this.controls.leftMargin.currModelState.modelValue+this.controls.columns.currModelState.activeColumn.leftPos;let t=0;const r=this.currModelState.columnSeparators.cellSpacing;this.viewState=f.ListUtils.map(this.currModelState.columnSeparators.items,(i=>{const n=new X$(i.leftMargin+r,t+r,i.position+e);return t=i.rightMargin,n})),this.setCount(this.viewState.length),f.ListUtils.forEach2(this.subControls,this.viewState,((e,t)=>e.setValue(t)))}createSubControl(){return new K$(this.modelData,this.controls)}onMouseDown(e,t){return!!this.currModelState.enabled&&f.ListUtils.unsafeAnyOf(this.subControls,((t,r)=>!!t.canHandle(e)&&(this.handleControlIndex=r,this.controls.lineControl.show(Wq.TableColumn),this.activeSubControl.lineControlSetPosition(),this.activeSubControl.showShadow(),!0)))}onMouseUp(){const e=this.prevModelState.columnSeparators.items[this.handleControlIndex].position,t=this.currModelState.columnSeparators.items[this.handleControlIndex].position,r=new iG(this.currModelState.tableIndex,t-e,null,e,!0);this.modelData.commandManager.getCommand(FF.RulerChangeTableColumnWidth).execute(this.modelData.commandManager.isPublicApiCall,r),this.finishHandle()}calculateNewModelState(e){const t=this.controls.leftMargin.currModelState.modelValue+this.controls.columns.currModelState.activeColumn.leftPos,r=this.prevModelState.columnSeparators.items,i=t+(0==this.handleControlIndex?0:r[this.handleControlIndex-1].position+15),n=t+(this.handleControlIndex==r.length-1?this.controls.columns.currModelState.activeColumn.width:r[this.handleControlIndex+1].position-15),o=t+r[this.handleControlIndex].position,a=this.controls.chooseClosestAnchorPosition(o+e,[o],new xl.MinMaxNumber(i,n));this.currModelState.columnSeparators.items[this.handleControlIndex].position=this.prevModelState.columnSeparators.items[this.handleControlIndex].position+a-o}}class K${constructor(e,t){this.controls=t,this.rootElement=Yj.renderContainer(z$),this.separatorElement=Yj.renderContainer(e.styles.columnSeparatorImage.spriteCssClass);const r=g$.getTableColumnDragElementTemplate();r&&(this.separatorElement.innerHTML=r),this.rootElement.appendChild(this.separatorElement),t.ruler.rootElement.appendChild(this.rootElement),this.corectionValue=Math.floor(this.separatorElement.offsetWidth/2)}dispose(){fn.DomUtils.hideNode(this.rootElement),this.rootElement=null,this.separatorElement=null}showShadow(){}hideShadow(){}lineControlSetPosition(){this.controls.lineControl.setPosition(this.viewState.position,Vq.LeftSide)}canHandle(e){return e==this.separatorElement}setValue(e){this.viewState&&e.equals(this.viewState)||(this.viewState=e.clone(),this.rootElement.style.width=e.leftMargin+e.rightMarginOfPrevColumn+"px",this.rootElement.style.left=e.position-e.rightMarginOfPrevColumn+5+"px",this.separatorElement.style.left=e.rightMarginOfPrevColumn-this.corectionValue+"px")}}class q$ extends r${getRootClassName(){return this.modelData.styles.wrapper.className}constructor(e,t){super(e,t),this.controls.canvas.parentElement.insertBefore(this.rootElement,this.controls.canvas)}}class $${constructor(){this.canMouseMoveHandle=!1,this.touchID=-1,this.listeners=[],this.evtHandlersHolder=new rX.$}dispose(){this.evtHandlersHolder.removeAllListeners(),this.listener=null}addListener(e){0==this.listeners.length&&this.init(),this.listeners.push(e)}removeListener(e){const t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1),0==this.listeners.length&&this.dispose()}init(){this.evtHandlersHolder.addListener(document.documentElement,E$.TouchUtils.touchMouseDownEventName,this.onMouseDown.bind(this)),this.evtHandlersHolder.addListener(document.documentElement,E$.TouchUtils.touchMouseMoveEventName,this.onMouseMove.bind(this)),this.evtHandlersHolder.addListener(document.documentElement,E$.TouchUtils.touchMouseUpEventName,this.onMouseUp.bind(this)),this.evtHandlersHolder.addListener(document.documentElement,"dblclick",this.onDoubleClick.bind(this)),yH.Browser.TouchUI||this.evtHandlersHolder.addListener(document.documentElement,"keydown",this.onKeyBoardEvent.bind(this))}onDoubleClick(e){this.listener=this.getCurrentListener(e),this.listener&&this.listener.canHandle(tX.g.getEventSource(e))&&this.listener.onDoubleClick(e),this.listener=null}onKeyBoardEvent(e){this.canMouseMoveHandle&&KU.LN.getEventKeyCode(e)==KU.VD.Esc&&(this.listener.onEscPress(),this.reset())}onMouseDown(e){yH.Browser.TouchUI&&(this.touchID=this.getChangedTouchesIdentifier(e)),this.startX=tX.g.getEventX(e),this.listener=this.getCurrentListener(e),tX.g.isLeftButtonPressed(e)&&this.listener&&(this.canMouseMoveHandle=!0,this.listener.onMouseDown(e),tX.g.preventEventAndBubble(e))}onMouseMove(e){!this.listener||yH.Browser.TouchUI&&this.touchID!=this.getChangedTouchesIdentifier(e)||this.canMouseMoveHandle&&(this.listener.onMouseMove(tX.g.getEventX(e)-this.startX,tX.g.getEventSource(e)),tX.g.preventEventAndBubble(e))}onMouseUp(e){this.listener&&(this.listener.onMouseUp(),this.reset())}reset(){this.listener=null,this.canMouseMoveHandle=!1,this.touchID=-1}getCurrentListener(e){for(let t of this.listeners)if(t.canHandle(tX.g.getEventSource(e)))return t;return null}getChangedTouchesIdentifier(e){return yH.Browser.MSTouchUI?this.touchID:e.changedTouches[0].identifier}}class J${constructor(){this.controls=[],this.evtHandlersHolder=new rX.$}dispose(){this.evtHandlersHolder.removeAllListeners()}addListener(e,t){let r=f.ListUtils.elementBy(this.controls,(e=>e.view==t));r||(r=new Y$(t),this.evtHandlersHolder.addListener(r.view,"scroll",(e=>this.onScroll(this.controls.length-1))),this.controls.push(r)),r.listeners.push(e)}removeListener(e,t){const r=f.ListUtils.indexBy(this.controls,(e=>e.view==t));if(r>=0){const t=this.controls[r],i=t.listeners.indexOf(e);i>=0&&t.listeners.splice(i,1),0==t.listeners.length&&this.controls.splice(r,1)}0==this.controls.length&&this.dispose()}onScroll(e){this.controls[e].listeners.forEach((e=>e.onScroll()))}}class Y${constructor(e){this.listeners=[],this.view=e}}class Q${constructor(e,t){this.listener=null,this._enable=!0,this._visible=!0,this.modelData=e,this.controls=t,this.controlsList=[this.controls.firstLineIndent,this.controls.leftIndent,this.controls.rightIndent,this.controls.tables,this.controls.leftMargin,this.controls.rightMargin,this.controls.columns,this.controls.tabs]}setEnable(e){this._enable!=e&&(e||this.onEscPress(),this._enable=e)}setVisible(e){this._visible!=e&&(e||this.onEscPress(),this._visible=e)}canHandle(e){return fn.DomUtils.isItParent(this.controls.ruler.rootElement,e)}notHandle(){return this.modelData.isReadOnly||!this._enable||!this._visible}onDoubleClick(e){const t=tX.g.getEventSource(e),r=this.controls.rightMargin.canHandle(t)||this.controls.leftMargin.canHandle(t)?FF.ShowPageSetupForm:FF.ShowTabsForm;this.modelData.commandManager.getCommand(r).execute(this.modelData.commandManager.isPublicApiCall)}onMouseDown(e){if(this.notHandle())return;const t=tX.g.getEventSource(e);for(let r of this.controlsList)if(r.onMouseDown(t,e)){this.listener=r;break}}onMouseMove(e,t){!this.notHandle()&&this.listener&&(this.listener.onMouseMove(e,t),this.controls.updateView())}onMouseUp(){!this.notHandle()&&this.listener&&(this.listener.onMouseUp(),this.reset())}onEscPress(){!this.notHandle()&&this.listener&&(this.listener.onEscPress(),this.reset())}reset(){this.listener=null}}class Z${get paragraphLeftPosition(){let e=this.leftMargin.currModelState.modelValue+this.columns.currModelState.activeColumn.leftPos;if(this.tables.currModelState.columnSeparators.hasItems){const t=this.tables.currModelState.columnSeparators.currItem;e+=this.tables.currModelState.columnSeparators.cellSpacing+t.leftMargin+t.position}return e}get paragraphRightPosition(){const e=this.tables.currModelState.columnSeparators;if(e.hasItems){const t=e.items[e.index+1];return this.leftMargin.currModelState.modelValue+this.columns.currModelState.activeColumn.leftPos+(t.position-e.cellSpacing-e.currItem.rightMargin)}return this.leftMargin.currModelState.modelValue+this.columns.currModelState.activeColumn.rightPos}constructor(e,t){this.mouseEventsManager=new $$,this.viewElementScrollManager=new J$,this.canvas=e;const r=c$.create(t.unitType),i=g.u.twipsToPixelsF(Ih.calculatePaperSize(Vc.PrcEnvelopeNumber10Rotated).width);this.moveStepSize=t.unitType==KM.Inch?r.stepSize/2:r.stepSize,this.wrapper=new q$(t,this),this.ruler=new D$(t,this),this.tabTypeBox=new O$(t,this),this.divisions=new l$(t,this,r,i),this.leftMargin=new x$(t,this,i),this.rightMargin=new M$(t,this,i),this.leftIndent=new S$(t,this),this.firstLineIndent=new b$(t,this),this.rightIndent=new I$(t,this),this.columns=new Zq(t,this),this.tables=new G$(t,this),this.tabs=new A$(t,this),this.ruler.init(),this.tabTypeBox.init(),this.lineControl=new zq(this.canvas,t.styles.line.className,this.ruler.rootElement),this.mouseHandler=new Q$(t,this),this.mouseEventsManager.addListener(this.mouseHandler),this.viewElementScrollManager.addListener(this.ruler,this.canvas)}dispose(){this.lineControl.dispose(),this.wrapper.dispose(),this.ruler.dispose(),this.tabTypeBox.dispose(),this.divisions.dispose(),this.leftMargin.dispose(),this.rightMargin.dispose(),this.leftIndent.dispose(),this.firstLineIndent.dispose(),this.rightIndent.dispose(),this.columns.dispose(),this.tables.dispose(),this.tabs.dispose(),this.mouseEventsManager.dispose(),this.viewElementScrollManager.dispose()}update(){this.updateModelState(),this.updateView()}updateModelState(){this.ruler.updateModelState(),this.leftMargin.updateModelState(),this.rightMargin.updateModelState(),this.divisions.updateModelState(),this.columns.updateModelState(),this.tables.updateModelState(),this.rightIndent.updateModelState(),this.leftIndent.updateModelState(),this.firstLineIndent.updateModelState(),this.tabs.updateModelState()}updateView(){this.ruler.updateView(),this.leftMargin.updateView(),this.rightMargin.updateView(),this.divisions.updateView(),this.columns.updateView(),this.tables.updateView(),this.rightIndent.updateView(),this.leftIndent.updateView(),this.firstLineIndent.updateView(),this.tabs.updateView()}adjust(){this.ruler.adjust()}chooseClosestAnchorPosition(e,t,r){const i=new Cn.e(r.minElement,r.maxElement);let n=f.ListUtils.addListOnTail(this.getClosestAnchorPositions(e,0),t);return n.push(r.minElement),n.push(r.maxElement),n=f.ListUtils.reducedMap(n,(e=>i.containsWithIntervalEnd(e)?e:null)).sort(((e,t)=>e-t)),n.length?f.ListUtils.min(n,(t=>Math.abs(t-e))):f.ListUtils.min([r.minElement,r.maxElement],(t=>Math.abs(t-e)))}getClosestAnchorPositions(e,t){const r=(e-t)/this.moveStepSize;return[this.moveStepSize*Math.floor(r),this.moveStepSize*Math.ceil(r)]}}class eJ{get showLeftIndent(){return this.settings.showLeftIndent}get showRightIndent(){return this.settings.showRightIndent}get titles(){return this.settings.titles}get styles(){return this.settings.styles}get inputPosition(){return this.core.inputPosition}get commandManager(){return this.core.commandManager}get isClosed(){return this.core.isClosed()}get innerClientProperties(){return this.core.innerClientProperties}get isReadOnly(){return this.core.readOnly!=RF.None}get unitType(){return this.core.uiUnitConverter.getUnits()}get selection(){return this.core.selection}constructor(e,t){this.core=e,this.settings=this.fixSettings(t),this.visibility=this.settings.visibility,this.showTabs=this.settings.showTabs}fixSettings(e){return e.styles.firstLineIndent||(e.styles.firstLineIndent=this.getDefaultStyle("dxreFirstLineIndentDragHandle")),e.styles.leftIndent||(e.styles.leftIndent=this.getDefaultStyle("dxreLeftIndentDragHandle")),e.styles.tab||(e.styles.tab=this.getDefaultStyle("dxreTabDragHandle")),e.styles.line||(e.styles.line=this.getDefaultStyle("dxreRulerLine")),e.styles.control||(e.styles.control=this.getDefaultStyle("dxreRuler")),e.styles.wrapper||(e.styles.wrapper=this.getDefaultStyle("dxreRulerWrapper")),e}getDefaultStyle(e){const t=new _q;return t.className=e,t.style="",t}}var tJ,rJ,iJ,nJ,oJ,aJ,sJ;!function(e){e[e.None=0]="None",e[e.FullReset=1]="FullReset",e[e.CheckSelectionChange=2]="CheckSelectionChange"}(tJ||(tJ={}));class lJ extends Lb.IS{get initialized(){return!!this.controls}constructor(e,t,r){super(),this.controls=null,this._innerVisible=!0,this._visible=!0,this.isTestMode=!1,this.selection=null,this.updateEnabled=!0,this.modelData=new eJ(e,t),this.canvas=r}dispose(){this.initialized&&this.controls.dispose()}initialize(e){this.isTestMode=e,this.initializeCore()}onUpdateUnlocked(e){this.applyEvent(e)}modelChanged(e){const t=this.getModelChangeEvent(e);this.isUpdateLocked()?this.registerOccurredEvent(t):this.applyEvent(t)}NotifySelectionChanged(e){this.selection=e,this.isUpdateLocked()?this.registerOccurredEvent(tJ.CheckSelectionChange):this.applyEvent(this.getSelectionChangeEvent())}applyEvent(e){const t=new pr.Flag(e);t.get(tJ.CheckSelectionChange)&&t.add(this.getSelectionChangeEvent()),t.get(tJ.FullReset)&&this.update()}getSelectionChangeEvent(){return this.selection&&!this.selection.shouldResetInputPosition()?tJ.None:tJ.FullReset}getModelChangeEvent(e){switch(e.type){case pd.DifferentOddAndEvenPages:case pd.PageColor:return tJ.None;case pd.DefaultTabWidth:return tJ.FullReset;case pd.HeaderFooterCreated:case pd.HeaderFooterIndexChanged:case pd.LoadFontInfo:case pd.SectionFormattingChanged:case pd.CreateStyleLink:case pd.DeleteStyleLink:case pd.AbstractNumberingListAdded:case pd.AbstractNumberingListDeleted:case pd.NumberingListAdded:case pd.NumberingListDeleted:case pd.ListLevelPropertyChanged:case pd.ListLevelParagraphPropertyChanged:case pd.ListLevelCharacterPropertyChanged:case pd.IOverrideListLevelChanged:case pd.BookmarkCreated:case pd.BookmarkDeleted:return tJ.None;case pd.TabInserted:case pd.TabDeleted:return tJ.FullReset;case pd.LoadPicturesInfo:case pd.InlinePicturesUpdated:case pd.InlinePictureInserted:case pd.AnchoredPictureInserted:case pd.AnchoredPictureSizeChanged:case pd.InlineObjectRunPropertyChanged:case pd.FieldInserted:case pd.FieldDeleted:case pd.HyperlinkInfoChanged:case pd.FieldsShowCodeChanged:return tJ.None;case pd.SimpleRunInserted:case pd.TextBufferChanged:case pd.ParagraphInserted:case pd.SectionInserted:case pd.AnchoredTextBoxInserted:case pd.AnchorObjectRemoved:case pd.IntervalRemoved:case pd.ParagraphMerged:case pd.SectionMerged:return tJ.FullReset;case pd.CharacterFormattingChanged:case pd.CharacterPropertiesChanged:return tJ.None;case pd.ParagraphFormattingChanged:case pd.ParagraphPropertiesChanged:case pd.ParagraphAndCharacterMergedPropertiesReset:case pd.AnchoredTextBoxSizeChanged:return tJ.FullReset;case pd.AnchoredTextBoxPropertiesChanged:case pd.AnchorInfoPropertyChanged:case pd.ShapeChanged:case pd.ShapePropertyChanged:case pd.CharacterStyleApplied:return tJ.None;case pd.ParagraphStyleApplied:case pd.TableStyleChanged:case pd.ParagraphNumberingListChanged:case pd.TableCreated:case pd.TableRemoved:case pd.TableStartPositionShifted:case pd.TableCellPropertyChanged:case pd.TablePropertyChanged:case pd.TableRowPropertyChanged:case pd.TableCellSplittedHorizontally:case pd.TableCellMergedHorizontally:case pd.TableRowInserted:case pd.TableRowRemoved:case pd.TableCellRemoved:case pd.TableCellInserted:return tJ.FullReset;default:return tJ.None}}forceUpdate(e){this.isUpdateLocked()?this.registerOccurredEvent(tJ.FullReset):this.update()}update(){this.initialized&&this.updateEnabled&&!this.isUpdateLocked()&&!this.modelData.isClosed&&this.controls.update()}adjust(){!this.initialized&&this.modelData.inputPosition&&(this.initializeCore(),this.initialized&&this.update()),this.initialized&&this.controls.adjust()}setEnable(e){this.initialized&&this.controls.mouseHandler.setEnable(e)}setVisible(e){e==this._innerVisible&&e==this._visible||(this.modelData.visibility=e?Oq.Visible:Oq.Hidden,this._visible=e,this.innerSetVisible(e))}innerSetVisible(e){e=e&&!this.modelData.innerClientProperties.viewsSettings.isSimpleView,this.initialized&&this._innerVisible!=e&&(this._innerVisible=e,this.controls.mouseHandler.setVisible(this._innerVisible),this.controls.wrapper.setVisible(this._innerVisible))}getVisible(){return this._visible}getHeight(){return this.initialized?gK.getOffsetHeight(this.controls.wrapper.rootElement):0}onViewTypeChanged(){this.innerSetVisible(this._visible&&!this.modelData.innerClientProperties.viewsSettings.isSimpleView)}initializeCore(){this.isTestMode||(!this.initialized&&this.canvas.offsetWidth&&(this.controls=new Z$(this.canvas,this.modelData)),this.setVisible(this.modelData.visibility!=Oq.Hidden),this.onViewTypeChanged())}}class dJ extends vU{constructor(e,t,r,i,n){super(e),this.text=t,this.matchCase=r,this.highlightResults=i,this.results=n}}class cJ extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=new hm(this.control.modelManager,this.control.layoutFormatterManager,this.control.layout,t.subDocument,t.text,t.matchCase,t.highlightResults,this.selection.pageIndex,(e=>{this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setIntervals([e])))})),i=this.modelManipulator.model.findAll(r);return r.highlightResults&&this.selection.setSearchSelectionIntervals(i),t.results&&(t.results.splice(0,t.results.length),i.forEach((function(e){t.results.push(e)}))),!0}isEnabledInReadOnlyMode(){return!0}}class hJ extends vU{constructor(e,t,r,i){super(e),this.text=t,this.replaceText=r,this.matchCase=i}}class uJ extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=t;let i=new om(this.control.modelManager,this.control.layoutFormatterManager,this.selection.pageIndex,t.subDocument,this.control.layout,(e=>{this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setIntervals([e])))}));return i.setSearchParams(r.text,r.replaceText,Pg.All,r.matchCase,!1,0,!1),i.replaceAll(this.selection.lastSelectedInterval.start),!0}}class pJ extends hJ{}class gJ extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=t;let i=new om(this.control.modelManager,this.control.layoutFormatterManager,this.control.selection.pageIndex,t.subDocument,this.control.layout,(e=>{this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setIntervals([e])))}));return i.setSearchParams(r.text,r.replaceText,Pg.All,r.matchCase,!1,this.selection.intervals[0].start,!1),i.findNext()===Ig.Found&&(i.replaceLastFound(),!0)}}class mJ{constructor(e){this.onChanged=new Nb,this.control=e,this.foundIntervals=[],this.whatFind=null}dispose(){this.control&&(this.control=null,this.onChanged.dispose())}raiseSearchReset(){this.resetSearch(),this.onChanged.listeners.forEach((e=>e.NotifySearchReset()))}NotifySelectionChanged(e){e.prevState.intervalsInfo.subDocument!=e.currState.intervalsInfo.subDocument&&this.raiseSearchReset()}findAll(e,t){this.whatFind=e,this.control.commandManager.getCommand(FF.FindAll).execute(this.control.commandManager.isPublicApiCall,new dJ(this.control,e,t,!0,this.foundIntervals))}replaceAll(e,t,r){this.control.commandManager.getCommand(FF.ReplaceAll).execute(this.control.commandManager.isPublicApiCall,new hJ(this.control,e,t,r))}replace(e,t,r){return this.findIntervalIndex(this.control.selection.intervals[0])>=0&&(this.control.commandManager.getCommand(FF.ReplaceNext).execute(this.control.commandManager.isPublicApiCall,new pJ(this.control,e,t,r)),!0)}resetSearch(){this.foundIntervals=[],this.control.selection.searchIntervals.length&&this.control.selection.resetSearchSelection()}findNextIntervalIndex(){for(let e,t=0;e=this.foundIntervals[t];t++)if(e.start>=this.control.selection.intervals[0].end)return t;return this.foundIntervals.length?0:null}findPrevIntervalIndex(){for(let e,t=this.foundIntervals.length-1;e=this.foundIntervals[t];t--)if(e.start<this.control.selection.intervals[0].start)return t;return this.foundIntervals.length?this.foundIntervals.length-1:null}findIntervalIndex(e){return f.ListUtils.indexBy(this.foundIntervals,(t=>t.start==e.start&&t.end==e.end))}selectIntervalByIndex(e){let t=this.foundIntervals[e];this.control.selection.deprecatedSetSelection(t.start,t.end,!1,-1,!0)}scrollToIntervalByIndex(e){this.control.beginUpdate();let t=this.foundIntervals[e];this.control.selection.scrollManager.setScroll((new xD).byModelPosition(this.control.selection).setModelPosition(t.start).useStdRelativePosition().useStdOffset()),this.control.endUpdate()}}class fJ{get isReadOnlyPersistent(){return this.readOnly==RF.Persistent}get model(){return this.modelManager.model}get isDisposed(){return this._isDisposed}constructor(e,t,r,i,n,o,a,s,l,d,c){this.isLoadingPictureFromClipboard=!1,this.readOnly=RF.None,this._isDisposed=!1,this.lastSavedHistoryItemId=-1,this.isClientMode()&&(t=""),this.beforeInitialization(l),this.barHolder=o,this.barHolder.initialize(this),ir.fontInfo.defaultValue=_n.defaultFontInfo,this.pdfHelperFrame=new Nj.E(r,"dxre-helperFrame"),this.owner=e,this.clientGuid=i,this.readOnly=n?RF.Persistent:RF.None,this.modelManager=this.createModelManager(l),this.stringResources=c,this.measurer=new hM(t),this.boxVisualizerManager=new Eq(this),this.eventManager=new hK(this,this.boxVisualizerManager),this.uiUnitConverter=function(e){switch(e){case KM.Centimeter:return new FE;case KM.Inch:return new RE;default:throw new Error(R.D.InternalException)}}(a);const h=this.createViewElement(t,r);this.horizontalRulerControl=new lJ(this,s,h),this.barHolder.horizontalRuler=this.horizontalRulerControl,this.inputController=new fq(this,this.eventManager,h),this.innerClientProperties=new Lj(d),this.viewManager=new QK(this,h,this.eventManager,this.stringResources,this.horizontalRulerControl,this.inputController,this.innerClientProperties,this,this,this.owner.internalApi,this.modelManager.richOptions.fields),this.loadingPanelManager=this.createLoadingPanelManager(),this.popupMenuManager=new Dq(this.owner,this.viewManager,this.measurer,null),this.focusManager=new nq(this.viewManager.canvasManager,this.owner,this.inputController,this.eventManager),this.commandManager=this.createCommandManager(),this.shortcutManager=this.createShortcutManager(),this.searchManager=new mJ(this),this.boxVisualizerManager.initListeners(this.viewManager),this.autoCorrectService=new Xj(this,this.modelManager.richOptions.autoCorrect),this.clientSideEvents=new ZK(this.owner),this.globalEventDispatcher=new sq(this,(()=>{this.searchManager.raiseSearchReset(),this.clientSideEvents.raiseDocumentChanged()})),this.simpleViewCanvasSizeManager=new Jj(this.viewManager.canvasManager,this),this.innerClientProperties.viewsSettings.isSimpleView&&this.simpleViewCanvasSizeManager.setViewMode(!0),(0,bn.lX)()&&(0,bn.mw)((()=>{this.invalidateLayoutAfterFontsLoaded()}))}beforeInitialization(e){}registerActiveContextTabManager(){}registerFontChangesListeners(){}initialize(e,t,r,i,n=!1){this.closed=!1,i||(i=new cm(this.modelManager.richOptions,r)),this.setWorkSession(e,t),this.modelManager.model=i,this.measurer.setCharacterPropertiesCache(this.modelManager.model.cache.mergedCharacterPropertiesCache),this.layout=new AD(new BD(i)),this.selection=new RD(this.modelManager.model,this.layout,this.modelManager.model.mainSubDocument),this.inputPosition=new PD(this.selection),this.inputPositionModelChangesListener=new Lq(this.inputPosition,this.selection),this.selection.inputPosition=this.inputPosition,this.popupMenuManager.setSelection(this.selection),this.selectionModelChangesListener=new Bq(this.selection);const o=new Dj(this.selection.activeSubDocument.info,-1,this.innerClientProperties);this.viewManager.setWorkSession(this.layout,o,this.modelManager.model.cache.imageCache),this.hitTestManager=new kX(this.layout,this.measurer),this.selectionFormatter=new bq(this.selection,this.measurer,o,this.modelManager.richOptions.documentProtection),this.selectionFormatter.onSelectionLayoutChanged.add(this.viewManager),this.selection.onChanged.add(this.inputPositionModelChangesListener),this.selection.onChanged.add(this.selectionFormatter),this.selection.onChanged.add(this.boxVisualizerManager.fullTableSelectorVisualizer),this.selection.onSearchChanged.add(this.selectionFormatter),this.selection.onMisspelledSelectionChanged.add(this.selectionFormatter),this.scrollFormatter=new Fq(this.selection),this.selection.scrollManager.onChanged.add(this.scrollFormatter),this.scrollFormatter.onScrollLayoutChanged.add(this.viewManager.canvasScrollManager),this.createSpellChecker(),this.layoutFormatterManager=new xj(this.measurer,this.innerClientProperties,this.modelManager.model,this.layout,this.selection,this.modelManager.richOptions.bookmarks,this.modelManager.richOptions.documentProtection,this.viewManager.canvasManager.controlHeightProvider,this.stringResources,[this.viewManager,this.globalEventDispatcher,this.selectionFormatter,this.scrollFormatter,this.boxVisualizerManager.resizeBoxVisualizer,this.boxVisualizerManager.anchorVisualizer,this.boxVisualizerManager.fullTableSelectorVisualizer,new Aj(this.spellChecker)]),this.modelManager.modelManipulator.clearListeners(),this.modelManager.history.clear(),this.modelManager.modelManipulator.modelListeners.push(this.inputPositionModelChangesListener),this.modelManager.modelManipulator.modelListeners.push(this.layoutFormatterManager.modelChangesListener),this.modelManager.modelManipulator.modelListeners.push(this.selectionModelChangesListener),this.modelManager.modelManipulator.modelListeners.push(new Bj(this.spellChecker)),this.barHolder.ribbon&&this.modelManager.modelManipulator.modelListeners.push(this.barHolder.ribbon),this.modelManager.modelManipulator.modelListeners.push(this.barHolder.contextMenu),this.modelManager.modelManipulator.modelListeners.push(this.horizontalRulerControl),this.modelManager.modelManipulator.modelListeners.push(this.selectionFormatter),this.registerFontChangesListeners(),this.selection.onChanged.add(this.searchManager),this.selection.onChanged.add(this.boxVisualizerManager.resizeBoxVisualizer),this.selection.onChanged.add(this.boxVisualizerManager.anchorVisualizer),this.selection.onChanged.add(this.barHolder.contextMenu),this.barHolder.ribbon&&this.selection.onChanged.add(this.barHolder.ribbon),this.barHolder.setEnabled(!1),this.horizontalRulerControl.initialize(n),this.horizontalRulerControl.setEnable(!1),this.selection.onChanged.add(this.horizontalRulerControl),this.spellChecker.initialize(this.selection.activeSubDocument),this.selection.onChanged.add(new Aq(this.spellChecker)),this.selection.onChanged.add(this.globalEventDispatcher),this.selection.onChanged.add(this.barHolder.publicUiChangesListener),this.registerActiveContextTabManager(),this.modelManager.modelManipulator.modelListeners.push(this.globalEventDispatcher),this.modelManager.modelManipulator.modelListeners.push(this.barHolder.publicUiChangesListener),this.inputController.initExporter()}dispose(){var e,t;this.isDisposed||(this.pdfHelperFrame.dispose(),this.measurer.dispose(),this.horizontalRulerControl.dispose(),this.searchManager.dispose(),this.inputController.dispose(),this.viewManager.dispose(),this.layoutFormatterManager.dispose(),this.eventManager.dispose(),this.simpleViewCanvasSizeManager.dispose(),this.loadingPanelManager.dispose(),this.commandManager.dispose(),this.spellChecker.dispose(),this.selection.dispose(),null===(t=(e=this.barHolder).dispose)||void 0===t||t.call(e),this.modelManager=null,this.commandManager=null,this.shortcutManager=null,this.selection=null,this.inputPosition=null,this.hitTestManager=null,this.measurer=null,this.uiUnitConverter=null,this.horizontalRulerControl=null,this.spellChecker=null,this.autoCorrectService=null,this.searchManager=null,this.clientSideEvents=null,this.innerClientProperties=null,this.focusManager=null,this.inputController=null,this.layout=null,this.viewManager=null,this.layoutFormatterManager=null,this.barHolder=null,this.popupMenuManager=null,this.owner=null,this.eventManager=null,this.selectionFormatter=null,this.scrollFormatter=null,this.boxVisualizerManager=null,this.globalEventDispatcher=null,this.simpleViewCanvasSizeManager=null,this.selectionModelChangesListener=null,this.loadingPanelManager=null,this.inputPositionModelChangesListener=null,this._isDisposed=!0)}beginUpdate(){var e;this.layoutFormatterManager.beginUpdate(),this.selectionFormatter.beginUpdate(),this.scrollFormatter.beginUpdate(),this.viewManager.canvasManager.beginUpdate(),this.selectionModelChangesListener.beginUpdate(),this.selection.beginUpdate(),this.inputPositionModelChangesListener.beginUpdate(),null===(e=this.barHolder.ribbon)||void 0===e||e.beginUpdate(),this.barHolder.contextMenu.beginUpdate(),this.horizontalRulerControl.beginUpdate(),this.globalEventDispatcher.beginUpdate(),this.barHolder.publicUiChangesListener.beginUpdate()}endUpdate(){var e;this.layoutFormatterManager.endUpdate(),this.selectionFormatter.endUpdate(),this.scrollFormatter.endUpdate(),this.viewManager.canvasManager.endUpdate(),this.layoutFormatterManager.runFormattingAsync(),this.selectionModelChangesListener.endUpdate(),this.selection.endUpdate(),this.inputPositionModelChangesListener.endUpdate(),null===(e=this.barHolder.ribbon)||void 0===e||e.endUpdate(),this.barHolder.contextMenu.endUpdate(),this.horizontalRulerControl.endUpdate(),this.globalEventDispatcher.endUpdate(),this.barHolder.publicUiChangesListener.endUpdate()}setPersistentReadOnly(e){e?this.readOnly=RF.Persistent:e||this.readOnly!==RF.Persistent||(this.readOnly=RF.None,this.inputController.inputEditor.initializeIfNotReadOnly())}setWorkSession(e,t){this.sessionGuid=e,this.documentInfo=t,this.owner&&this.owner.syncSessionGuid(e)}beginLoading(){if(this.readOnly===RF.None){this.readOnly=RF.Temporary;const e=this.barHolder.ribbon;e&&(e.suspendUpdate(),e.updateItemsState(),e.continueUpdate()),this.loadingPanelManager.statusBarLoadingPanel.setVisible(!0)}}endLoading(){if(this.readOnly===RF.Temporary){this.readOnly=RF.None;const e=this.barHolder.ribbon;e&&(e.suspendUpdate(),e.updateItemsState(),e.continueUpdate()),this.loadingPanelManager.statusBarLoadingPanel.setVisible(!1)}}closeDocument(){this.selection.onChanged.remove(this.globalEventDispatcher);for(let e=0;e<this.modelManager.modelManipulator.modelListeners.length;e++)if(this.modelManager.modelManipulator.modelListeners[e]==this.globalEventDispatcher){this.modelManager.modelManipulator.modelListeners.splice(e,1);break}this.barHolder.setEnabled(!1),this.horizontalRulerControl&&this.horizontalRulerControl.setEnable(!1),this.layoutFormatterManager.closeDocument(),this.viewManager.closeDocument(),this.boxVisualizerManager.closeDocument(),this.closed=!0}importHtml(e){const t=this.selection.lastSelectedInterval;this.beginUpdate();var r=this.inputController.getExportedRangeCopy();const i=this.inputPosition.charPropsBundle,n=this.selection.activeSubDocument;let o;this.modelManager.history.beginTransaction(),EU.addSelectionBefore(this),this.modelManager.modelManipulator.range.removeInterval(new gu(n,t),!0,!0),o=r&&this.isUsedInnerClipboard(e)?this.importInnerClipboard(r,this.selection):new EE(this.modelManager,this.measurer,new pu(this.selection.activeSubDocument,t.start),e,i).import();const a=n.positionManager.registerPosition(o.end),s=()=>{EU.addSelectionAfter(this,a.value),n.positionManager.unregisterPosition(a),this.modelManager.history.endTransaction(),this.endUpdate()},l=this.commandManager.getCommand(FF.UpdateField);if(o.length>0&&this.modelManager.richOptions.fields.updateFieldsOnPaste&&l.getState().enabled){const e=new rq(n,[o],(()=>s()));e.options.updateFillIn=!1;const t=new MU(this,e);l.execute(this.commandManager.isPublicApiCall,t)}else s()}importInnerClipboard(e,t){const r=t.lastSelectedInterval,i=this.selection.activeSubDocument,n=new pu(i,r.start);return t.tableInfo.isSelected?e.insertToTable(this.modelManager.modelManipulator,n,t.tableInfo):e.insertTo(this.modelManager.modelManipulator,n)}onViewTypeChanged(){this.viewManager.renderer.onViewTypeChanged(),this.horizontalRulerControl.onViewTypeChanged(),this.simpleViewCanvasSizeManager.setViewMode(this.innerClientProperties.viewsSettings.isSimpleView)}getModifiedState(){return this.lastSavedHistoryItemId!=this.modelManager.history.getCurrentItemId()?n.True:n.False}setModifiedFalse(){this.lastSavedHistoryItemId=this.modelManager.history.getCurrentItemId()}getGuidParams(){return{sguid:this.sessionGuid,cguid:this.clientGuid}}isTouchMode(){return yH.Browser.TouchUI&&!yH.Browser.MSTouchUI}isRibbon(e){return this.owner.isRibbon(e)}isClosed(){return this.closed}invalidateLayoutAfterFontsLoaded(){!this.isDisposed&&this.measurer&&this.layoutFormatterManager&&this.layoutFormatterManager.invalidator&&(this.measurer.clearCache(),this.layoutFormatterManager.invalidator.onChangedAllLayout())}getExportModelOptions(e={}){return{modelManager:(0,S.isDefined)(e.modelManager)?e.modelManager:this.modelManager,pictureRenderer:this.viewManager.renderer,uiUnitConverter:this.uiUnitConverter,lastMaxNumPages:this.layout.lastMaxNumPages,pageIndex:this.selection.pageIndex,sessionGuid:this.sessionGuid,clientGuid:this.clientGuid,documentFormat:(0,S.isDefined)(e.documentFormat)?e.documentFormat:this.getExportDocumentFormat()}}createViewElement(e,t){const r=document.createElement("DIV");return r.id=e+"_View",r.className="dxreView",r.tabIndex=0,r.setAttribute("role","document"),t.appendChild(r),r}isUsedInnerClipboard(e){const t=e[0];return t&&fn.DomUtils.isHTMLElementNode(t)&&t.id==an.getCopyPasteGuid(this.getGuidParams())}getExportDocumentFormat(){const e=this.documentInfo.documentFormat;return null!=e?e:Fu.OpenXml}}class bJ{get fileName(){return this._fileName}set fileName(e){this._fileName=e}get documentFormat(){return this._documentFormat}set documentFormat(e){this._documentFormat="string"==typeof e?QU.convertExtensionToDocumentFormat(e):e,this._documentExtension=QU.convertToString(e)}get documentExtension(){return this._documentExtension}constructor(e,t,r=bJ.defaultDocumentFormat,i=QU.convertToString(r)){this._fileName=e,this._documentFormat=r,this._documentExtension=i,this.documentHasSource=t}getFileNameForDownload(e){return rn.StringUtils.isNullOrEmpty(e)?rn.StringUtils.isNullOrEmpty(this._fileName)?bJ.defaultDocumentName:this._fileName:e}}bJ.defaultDocumentName="document1",bJ.defaultDocumentFormat=Fu.OpenXml;class CJ{constructor(){this.detectUrls=!0,this.correctTwoInitialCapitals=!1,this.replaceTextAsYouType=!1,this.enableAutomaticNumbering=!0,this.caseSensitiveReplacement=!1,this.replaceInfoCollection=[]}copyFrom(e){this.detectUrls=e.detectUrls,this.correctTwoInitialCapitals=e.correctTwoInitialCapitals,this.replaceTextAsYouType=e.replaceTextAsYouType,this.enableAutomaticNumbering=e.enableAutomaticNumbering,this.caseSensitiveReplacement=e.caseSensitiveReplacement,this.replaceInfoCollection=f.ListUtils.map(e.replaceInfoCollection,(e=>new SJ(e.replace,e.with)))}clone(){const e=new CJ;return e.copyFrom(this),e}}class SJ{constructor(e,t){this.replace=e,this.with=t}clone(){return new SJ(this.replace,this.with)}}class IJ{constructor(){this.openHyperlinkOnClick=!1,this.updateFieldsBeforePrint=!0,this.updateFieldsOnPaste=!0,this.defaultTimeFormat=IJ.DEFAULT_TIME_FORMAT,this.defaultDateFormat=IJ.DEFAULT_DATE_FORMAT,this.openHyperlinkOnClick=!1,this.keepHyperlinkResultForInvalidReference=!1,this.createHyperlinkTooltip=(e,t)=>`${e}${t}`}copyFrom(e){(0,S.isDefined)(e.updateFieldsBeforePrint)&&(this.updateFieldsBeforePrint=e.updateFieldsBeforePrint),(0,S.isDefined)(e.updateFieldsOnPaste)&&(this.updateFieldsOnPaste=e.updateFieldsOnPaste),(0,S.isNonNullString)(e.defaultTimeFormat)&&(this.defaultTimeFormat=e.defaultTimeFormat),(0,S.isNonNullString)(e.defaultDateFormat)&&(this.defaultDateFormat=e.defaultDateFormat),(0,S.isDefined)(e.openHyperlinkOnClick)&&(this.openHyperlinkOnClick=e.openHyperlinkOnClick),(0,S.isDefined)(e.keepHyperlinkResultForInvalidReference)&&(this.keepHyperlinkResultForInvalidReference=e.keepHyperlinkResultForInvalidReference),(0,S.isDefined)(e.createHyperlinkTooltip)&&""!==e.createHyperlinkTooltip&&(this.createHyperlinkTooltip=(0,yd.tm)(e.createHyperlinkTooltip)),(0,S.isDefined)(e.allowedHyperlinkUriSchemes)&&(this.allowedHyperlinkUriSchemes=e.allowedHyperlinkUriSchemes)}clone(){const e=new IJ;return e.copyFrom(this),e}}IJ.DEFAULT_TIME_FORMAT="h:mm am/pm",IJ.DEFAULT_DATE_FORMAT="M/d/yyyy";class PJ{constructor(e,t){this.defaultFontName=e,this.rules=t||[]}copyFrom(e){var t;this.defaultFontName=e.defaultFontName,this.rules=f.ListUtils.map(null!==(t=e.rules)&&void 0!==t?t:[],(e=>new wJ(e.sourceFontFamily,e.destinationFontName)))}}class wJ{constructor(e,t){this.sourceFontFamily=e,this.destinationFontName=t}}class yJ{constructor(){this._defaultFolder=yJ.defaultBaseUrl,this.fonts=[],this.mappings=new PJ,this.fontsMap=Object.create(null),this.mapRules=Object.create(null)}static get defaultBaseUrl(){return window.location.origin+"/fonts/"}get defaultFolder(){return this._defaultFolder}set defaultFolder(e){rn.StringUtils.endsAt(e,"\\")||rn.StringUtils.endsAt(e,"/")||(e+="/"),this._defaultFolder=e}get useMappingRules(){return this.limitedFonts&&(!!this.mappings.rules.length||!!this.mappings.defaultFontName)}get limitedFonts(){return!!this.fonts.length}getPermittedFont(e,t){var r;if(!this.useMappingRules||this.fontsMap[t.name])return t;const i=this.mapRules[t.getFontFamilies()[0]];if(i){const t=e.getItemByName(i.destinationFontName);if(t)return t}return e.getItemByName(null!==(r=this.mappings.defaultFontName)&&void 0!==r?r:this.fonts[0].name)}copyFrom(e){this.defaultFolder=e.defaultFolder,this.fonts=f.ListUtils.map(e.fonts,(e=>yJ.createFont(e))),this.mappings.copyFrom(e.mappings),this.initInternal()}init(e){var t,r,i;e&&(this.defaultFolder=null!==(t=e.defaultFolder)&&void 0!==t?t:yJ.defaultBaseUrl,this.fonts=f.ListUtils.map(null!==(r=e.fonts)&&void 0!==r?r:[],(e=>yJ.createFont(e))),this.mappings.copyFrom(null!==(i=e.mappings)&&void 0!==i?i:{}),this.initInternal())}clone(){const e=new yJ;return e.copyFrom(this),e}initInternal(){this.fontsMap=Object.create(null),this.fonts.forEach((e=>this.fontsMap[e.name]=!0)),this.mapRules=Object.create(null),this.mappings.rules.forEach((e=>this.mapRules[e.sourceFontFamily]=e))}static createFont(e){return{name:e.name,fontFamily:e.fontFamily,googleFontsResponse:e.googleFontsResponse,useGoogleFonts:e.useGoogleFonts,italicFontUri:e.italicFontUri,boldFontUri:e.boldFontUri,boldItalicFontUri:e.boldItalicFontUri,regularFontUri:e.regularFontUri}}}class xJ{constructor(){this.isEnabled=!1,this.viewMergedData=!1,this.activeRecordIndex=0,this.recordCount=0,this.allowInsertFields=!1}copyFrom(e){this.isEnabled=e.isEnabled,this.viewMergedData=e.viewMergedData,this.activeRecordIndex=e.activeRecordIndex,this.recordCount=e.recordCount,this.allowInsertFields=e.allowInsertFields}clone(){const e=new xJ;return e.copyFrom(this),e}}class TJ{constructor(){this._pdfDocument=window.PDFDocument,this._blobStream=window.BlobStream}get pdfDocument(){return this._pdfDocument?this._pdfDocument:window.PDFDocument}set pdfDocument(e){this._pdfDocument=e}get blobStream(){return this._blobStream?this._blobStream:window.BlobStream}set blobStream(e){this._blobStream=e}copyFrom(e){this._pdfDocument=e.pdfDocument,this._blobStream=e.blobStream,this.exportUrl=e.exportUrl,this.pdfKitScriptUrl=e.pdfKitScriptUrl,this.convertImageToCompatibleFormat=e.convertImageToCompatibleFormat}clone(){const e=new TJ;return e.copyFrom(this),e}}class vJ{constructor(){this.mode=rJ.ServerPdf,this.closePrintDialogWithHtmlPreview=!0}copyFrom(e){this.mode=e.mode,this.closePrintDialogWithHtmlPreview=e.closePrintDialogWithHtmlPreview}clone(){const e=new vJ;return e.copyFrom(this),e}}!function(e){e[e.ServerPdf=0]="ServerPdf",e[e.ClientHtml=1]="ClientHtml",e[e.ClientPdf=2]="ClientPdf"}(rJ||(rJ={}));class MJ{copyFrom(e){this.filterInterval=e.filterInterval}clone(){const e=new MJ;return e.copyFrom(this),e}}class EJ{constructor(){this.isEnabled=!1,this.customDictionaryGuid="",this.canAddWord=!1,this.suggestionCount=4}copyFrom(e){this.isEnabled=e.isEnabled,this.suggestionCount=e.suggestionCount,this.customDictionaryGuid=e.customDictionaryGuid,this.canAddWord=e.canAddWord,this.maxRequestLength=e.maxRequestLength&&e.maxRequestLength>0?e.maxRequestLength:300,this.checkWordSpelling=e.checkWordSpelling,this.addWordToDictionary=e.addWordToDictionary}clone(){const e=new EJ;return e.copyFrom(this),e}}class DJ{get maxSpellRequestLength(){return this.spellChecker.maxRequestLength}constructor(e){this.control=new Bb,this.mailMerge=new xJ,this.fields=new IJ,this.documentProtection=new fo,this.printing=new vJ,this.bookmarks=new BW,this.spellChecker=new EJ,this.autoCorrect=new CJ,this.pdf=new TJ,this.search=new MJ,this.fonts=new yJ,this.cultureOpts=e}clone(){const e=new DJ(this.cultureOpts);return e.control=this.control.clone(),e.mailMerge=this.mailMerge.clone(),e.fields=this.fields.clone(),e.documentProtection=this.documentProtection.clone(),e.printing=this.printing.clone(),e.bookmarks=this.bookmarks.clone(),e.spellChecker=this.spellChecker.clone(),e.autoCorrect=this.autoCorrect.clone(),e.cultureOpts=this.cultureOpts.clone(),e.pdf=this.pdf.clone(),e.search=this.search.clone(),e.fonts=this.fonts.clone(),e.nonce=this.nonce,e}}class FJ{constructor(){this.headerFooter=new RJ,this.seqCaptionPrefixes=new LJ,this.commonLabels=new BJ,this.quickSearchPanel=new AJ}}class RJ{}class LJ{}class BJ{}class AJ{}!function(e){e.AccentAsBackgroundColor="dx-theme-accent-as-background-color",e.AccentAsBorderColor="dx-theme-accent-as-border-color",e.AccentAsTextColor="dx-theme-accent-as-text-color",e.BackgroundColor="dx-theme-background-color",e.BackgroundColorAsBorderColor="dx-theme-background-color-as-border-color",e.BackgroundColorAsTextColor="dx-theme-background-color-as-text-color",e.BorderColor="dx-theme-border-color",e.BorderColorAsBackgroundColor="dx-theme-border-color-as-background-color",e.BorderColorAsTextColor="dx-theme-border-color-as-text-color ",e.TextColor="dx-theme-text-color",e.TextColorAsBackgroundColor="dx-theme-text-color-as-background-color",e.TextColorAsBorderColor="dx-theme-text-color-as-border-color"}(iJ||(iJ={}));class NJ{static createPresetStylesLocalizedNames(){const e={};return NJ.add(e,es.normalStyleName,"XtraRichEditStringId.LocalizedStyleName_Normal"),NJ.add(e,zl.hyperlinkStyleName,"XtraRichEditStringId.LocalizedStyleName_Hyperlink"),NJ.add(e,zl.defaultParagraphCharacterStyleName,"XtraRichEditStringId.DefaultStyleName_DefaultParagraphFont"),NJ.add(e,zl.lineNumberingStyleName,"XtraRichEditStringId.DefaultStyleName_linenumber"),NJ.add(e,NJ.ArticleSection,"XtraRichEditStringId.DefaultStyleName_ArticleSection"),NJ.add(e,NJ.AnnotationText,"XtraRichEditStringId.DefaultStyleName_annotationtext"),NJ.add(e,NJ.AnnotationReference,"XtraRichEditStringId.DefaultStyleName_annotationreference"),NJ.add(e,NJ.AnnotationSubject,"XtraRichEditStringId.DefaultStyleName_annotationsubject"),NJ.add(e,NJ.BalloonText,"XtraRichEditStringId.DefaultStyleName_BalloonText"),NJ.add(e,NJ.BlockText,"XtraRichEditStringId.DefaultStyleName_BlockText"),NJ.add(e,NJ.BodyText,"XtraRichEditStringId.DefaultStyleName_BodyText"),NJ.add(e,NJ.BodyText2,"XtraRichEditStringId.DefaultStyleName_BodyText2"),NJ.add(e,NJ.BodyText3,"XtraRichEditStringId.DefaultStyleName_BodyText3"),NJ.add(e,NJ.BodyTextFirstIndent,"XtraRichEditStringId.DefaultStyleName_BodyTextFirstIndent"),NJ.add(e,NJ.BodyTextFirstIndent2,"XtraRichEditStringId.DefaultStyleName_BodyTextFirstIndent2"),NJ.add(e,NJ.BodyTextIndent,"XtraRichEditStringId.DefaultStyleName_BodyTextIndent"),NJ.add(e,NJ.BodyTextIndent2,"XtraRichEditStringId.DefaultStyleName_BodyTextIndent2"),NJ.add(e,NJ.BodyTextIndent3,"XtraRichEditStringId.DefaultStyleName_BodyTextIndent3"),NJ.add(e,NJ.Caption,"XtraRichEditStringId.DefaultStyleName_caption"),NJ.add(e,NJ.Closing,"XtraRichEditStringId.DefaultStyleName_Closing"),NJ.add(e,NJ.CommentReference,"XtraRichEditStringId.DefaultStyleName_CommentReference"),NJ.add(e,NJ.CommentSubject,"XtraRichEditStringId.DefaultStyleName_CommentSubject"),NJ.add(e,NJ.CommentText,"XtraRichEditStringId.DefaultStyleName_CommentText"),NJ.add(e,NJ.Date,"XtraRichEditStringId.DefaultStyleName_Date"),NJ.add(e,NJ.DocumentMap,"XtraRichEditStringId.DefaultStyleName_DocumentMap"),NJ.add(e,NJ.EmailSignature,"XtraRichEditStringId.DefaultStyleName_EmailSignature"),NJ.add(e,NJ.EndnoteReference,"XtraRichEditStringId.DefaultStyleName_endnotereference"),NJ.add(e,NJ.EndnoteText,"XtraRichEditStringId.DefaultStyleName_endnotetext"),NJ.add(e,NJ.EnvelopeAddress,"XtraRichEditStringId.DefaultStyleName_envelopeaddress"),NJ.add(e,NJ.EnvelopeReturn,"XtraRichEditStringId.DefaultStyleName_envelopereturn"),NJ.add(e,NJ.Footer,"XtraRichEditStringId.DefaultStyleName_footer"),NJ.add(e,NJ.FootnoteText,"XtraRichEditStringId.DefaultStyleName_footnotetext"),NJ.add(e,NJ.FootnoteReference,"XtraRichEditStringId.DefaultStyleName_footnotereference"),NJ.add(e,NJ.Header,"XtraRichEditStringId.DefaultStyleName_header"),NJ.add(e,NJ.HTMLAcronym,"XtraRichEditStringId.DefaultStyleName_HTMLAcronym"),NJ.add(e,NJ.HTMLAddress,"XtraRichEditStringId.DefaultStyleName_HTMLAddress"),NJ.add(e,NJ.HTMLBottomOfForm,"XtraRichEditStringId.DefaultStyleName_HTMLBottomofForm"),NJ.add(e,NJ.HTMLCite,"XtraRichEditStringId.DefaultStyleName_HTMLCite"),NJ.add(e,NJ.HTMLCode,"XtraRichEditStringId.DefaultStyleName_HTMLCode"),NJ.add(e,NJ.HTMLDefinition,"XtraRichEditStringId.DefaultStyleName_HTMLDefinition"),NJ.add(e,NJ.HTMLKeyboard,"XtraRichEditStringId.DefaultStyleName_HTMLKeyboard"),NJ.add(e,NJ.HTMLPreformatted,"XtraRichEditStringId.DefaultStyleName_HTMLPreformatted"),NJ.add(e,NJ.HTMLSample,"XtraRichEditStringId.DefaultStyleName_HTMLSample"),NJ.add(e,NJ.HTMLTopOfForm,"XtraRichEditStringId.DefaultStyleName_HTMLTopofForm"),NJ.add(e,NJ.HTMLTypewriter,"XtraRichEditStringId.DefaultStyleName_HTMLTypewriter"),NJ.add(e,NJ.HTMLVariable,"XtraRichEditStringId.DefaultStyleName_HTMLVariable"),NJ.add(e,NJ.HyperlinkFollowed,"XtraRichEditStringId.DefaultStyleName_HyperlinkFollowed"),NJ.add(e,NJ.HyperlinkStrongEmphasis,"XtraRichEditStringId.DefaultStyleName_HyperlinkStrongEmphasis"),NJ.add(e,NJ.Emphasis,"XtraRichEditStringId.DefaultStyleName_Emphasis"),NJ.add(e,NJ.FollowedHyperlink,"XtraRichEditStringId.DefaultStyleName_FollowedHyperlink"),NJ.add(e,NJ.Index1,"XtraRichEditStringId.DefaultStyleName_index1"),NJ.add(e,NJ.Index2,"XtraRichEditStringId.DefaultStyleName_index2"),NJ.add(e,NJ.Index3,"XtraRichEditStringId.DefaultStyleName_index3"),NJ.add(e,NJ.Index4,"XtraRichEditStringId.DefaultStyleName_index4"),NJ.add(e,NJ.Index5,"XtraRichEditStringId.DefaultStyleName_index5"),NJ.add(e,NJ.Index6,"XtraRichEditStringId.DefaultStyleName_index6"),NJ.add(e,NJ.Index7,"XtraRichEditStringId.DefaultStyleName_index7"),NJ.add(e,NJ.Index8,"XtraRichEditStringId.DefaultStyleName_index8"),NJ.add(e,NJ.Index9,"XtraRichEditStringId.DefaultStyleName_index9"),NJ.add(e,NJ.IndexHeading,"XtraRichEditStringId.DefaultStyleName_indexheading"),NJ.add(e,NJ.List,"XtraRichEditStringId.DefaultStyleName_List"),NJ.add(e,NJ.List2,"XtraRichEditStringId.DefaultStyleName_List2"),NJ.add(e,NJ.List3,"XtraRichEditStringId.DefaultStyleName_List3"),NJ.add(e,NJ.List4,"XtraRichEditStringId.DefaultStyleName_List4"),NJ.add(e,NJ.List5,"XtraRichEditStringId.DefaultStyleName_List5"),NJ.add(e,NJ.ListBullet,"XtraRichEditStringId.DefaultStyleName_ListBullet"),NJ.add(e,NJ.ListBullet2,"XtraRichEditStringId.DefaultStyleName_ListBullet2"),NJ.add(e,NJ.ListBullet3,"XtraRichEditStringId.DefaultStyleName_ListBullet3"),NJ.add(e,NJ.ListBullet4,"XtraRichEditStringId.DefaultStyleName_ListBullet4"),NJ.add(e,NJ.ListBullet5,"XtraRichEditStringId.DefaultStyleName_ListBullet5"),NJ.add(e,NJ.ListContinue,"XtraRichEditStringId.DefaultStyleName_ListContinue"),NJ.add(e,NJ.ListContinue2,"XtraRichEditStringId.DefaultStyleName_ListContinue2"),NJ.add(e,NJ.ListContinue3,"XtraRichEditStringId.DefaultStyleName_ListContinue3"),NJ.add(e,NJ.ListContinue4,"XtraRichEditStringId.DefaultStyleName_ListContinue4"),NJ.add(e,NJ.ListContinue5,"XtraRichEditStringId.DefaultStyleName_ListContinue5"),NJ.add(e,NJ.ListNumber,"XtraRichEditStringId.DefaultStyleName_ListNumber"),NJ.add(e,NJ.ListNumber2,"XtraRichEditStringId.DefaultStyleName_ListNumber2"),NJ.add(e,NJ.ListNumber3,"XtraRichEditStringId.DefaultStyleName_ListNumber3"),NJ.add(e,NJ.ListNumber4,"XtraRichEditStringId.DefaultStyleName_ListNumber4"),NJ.add(e,NJ.ListNumber5,"XtraRichEditStringId.DefaultStyleName_ListNumber5"),NJ.add(e,NJ.MacroText,"XtraRichEditStringId.DefaultStyleName_MacroText"),NJ.add(e,NJ.MacroToAHeading,"XtraRichEditStringId.DefaultStyleName_macrotoaheading"),NJ.add(e,NJ.MessageHeader,"XtraRichEditStringId.DefaultStyleName_MessageHeader"),NJ.add(e,NJ.NoList,"XtraRichEditStringId.DefaultStyleName_NoList"),NJ.add(e,NJ.NormalIndent,"XtraRichEditStringId.DefaultStyleName_NormalIndent"),NJ.add(e,NJ.NormalTable,"XtraRichEditStringId.DefaultStyleName_NormalTable"),NJ.add(e,NJ.NormalWeb,"XtraRichEditStringId.DefaultStyleName_NormalWeb"),NJ.add(e,NJ.NoteHeading,"XtraRichEditStringId.DefaultStyleName_NoteHeading"),NJ.add(e,NJ.OutlineList1,"XtraRichEditStringId.DefaultStyleName_OutlineList1"),NJ.add(e,NJ.OutlineList2,"XtraRichEditStringId.DefaultStyleName_OutlineList2"),NJ.add(e,NJ.OutlineList3,"XtraRichEditStringId.DefaultStyleName_OutlineList3"),NJ.add(e,NJ.PageNumber,"XtraRichEditStringId.DefaultStyleName_pagenumber"),NJ.add(e,NJ.PlainText,"XtraRichEditStringId.DefaultStyleName_PlainText"),NJ.add(e,NJ.Salutation,"XtraRichEditStringId.DefaultStyleName_Salutation"),NJ.add(e,NJ.Signature,"XtraRichEditStringId.DefaultStyleName_Signature"),NJ.add(e,NJ.Strong,"XtraRichEditStringId.DefaultStyleName_Strong"),NJ.add(e,NJ.TableOfAuthorities,"XtraRichEditStringId.DefaultStyleName_tableofauthorities"),NJ.add(e,NJ.TableOfFigures,"XtraRichEditStringId.DefaultStyleName_tableoffigures"),NJ.add(e,NJ.Table3DEffects1,"XtraRichEditStringId.DefaultStyleName_Table3Deffects1"),NJ.add(e,NJ.Table3DEffects2,"XtraRichEditStringId.DefaultStyleName_Table3Deffects2"),NJ.add(e,NJ.Table3DEffects3,"XtraRichEditStringId.DefaultStyleName_Table3Deffects3"),NJ.add(e,NJ.TableClassic1,"XtraRichEditStringId.DefaultStyleName_TableClassic1"),NJ.add(e,NJ.TableClassic2,"XtraRichEditStringId.DefaultStyleName_TableClassic2"),NJ.add(e,NJ.TableClassic3,"XtraRichEditStringId.DefaultStyleName_TableClassic3"),NJ.add(e,NJ.TableClassic4,"XtraRichEditStringId.DefaultStyleName_TableClassic4"),NJ.add(e,NJ.TableColorful1,"XtraRichEditStringId.DefaultStyleName_TableColorful1"),NJ.add(e,NJ.TableColorful2,"XtraRichEditStringId.DefaultStyleName_TableColorful2"),NJ.add(e,NJ.TableColorful3,"XtraRichEditStringId.DefaultStyleName_TableColorful3"),NJ.add(e,NJ.TableColumns1,"XtraRichEditStringId.DefaultStyleName_TableColumns1"),NJ.add(e,NJ.TableColumns2,"XtraRichEditStringId.DefaultStyleName_TableColumns2"),NJ.add(e,NJ.TableColumns3,"XtraRichEditStringId.DefaultStyleName_TableColumns3"),NJ.add(e,NJ.TableColumns4,"XtraRichEditStringId.DefaultStyleName_TableColumns4"),NJ.add(e,NJ.TableColumns5,"XtraRichEditStringId.DefaultStyleName_TableColumns5"),NJ.add(e,NJ.TableContemporary,"XtraRichEditStringId.DefaultStyleName_TableContemporary"),NJ.add(e,NJ.TableElegant,"XtraRichEditStringId.DefaultStyleName_TableElegant"),NJ.add(e,NJ.TableGrid,"XtraRichEditStringId.DefaultStyleName_TableGrid"),NJ.add(e,NJ.TableGrid1,"XtraRichEditStringId.DefaultStyleName_TableGrid1"),NJ.add(e,NJ.TableGrid2,"XtraRichEditStringId.DefaultStyleName_TableGrid2"),NJ.add(e,NJ.TableGrid3,"XtraRichEditStringId.DefaultStyleName_TableGrid3"),NJ.add(e,NJ.TableGrid4,"XtraRichEditStringId.DefaultStyleName_TableGrid4"),NJ.add(e,NJ.TableGrid5,"XtraRichEditStringId.DefaultStyleName_TableGrid5"),NJ.add(e,NJ.TableGrid6,"XtraRichEditStringId.DefaultStyleName_TableGrid6"),NJ.add(e,NJ.TableGrid7,"XtraRichEditStringId.DefaultStyleName_TableGrid7"),NJ.add(e,NJ.TableGrid8,"XtraRichEditStringId.DefaultStyleName_TableGrid8"),NJ.add(e,NJ.TableList1,"XtraRichEditStringId.DefaultStyleName_TableList1"),NJ.add(e,NJ.TableList2,"XtraRichEditStringId.DefaultStyleName_TableList2"),NJ.add(e,NJ.TableList3,"XtraRichEditStringId.DefaultStyleName_TableList3"),NJ.add(e,NJ.TableList4,"XtraRichEditStringId.DefaultStyleName_TableList4"),NJ.add(e,NJ.TableList5,"XtraRichEditStringId.DefaultStyleName_TableList5"),NJ.add(e,NJ.TableList6,"XtraRichEditStringId.DefaultStyleName_TableList6"),NJ.add(e,NJ.TableList7,"XtraRichEditStringId.DefaultStyleName_TableList7"),NJ.add(e,NJ.TableList8,"XtraRichEditStringId.DefaultStyleName_TableList8"),NJ.add(e,NJ.TableWeb1,"XtraRichEditStringId.DefaultStyleName_TableWeb1"),NJ.add(e,NJ.TableWeb2,"XtraRichEditStringId.DefaultStyleName_TableWeb2"),NJ.add(e,NJ.TableWeb3,"XtraRichEditStringId.DefaultStyleName_TableWeb3"),NJ.add(e,NJ.TableNormal,"XtraRichEditStringId.DefaultStyleName_TableNormal"),NJ.add(e,NJ.TableProfessional,"XtraRichEditStringId.DefaultStyleName_TableProfessional"),NJ.add(e,NJ.TableSimple1,"XtraRichEditStringId.DefaultStyleName_TableSimple1"),NJ.add(e,NJ.TableSimple2,"XtraRichEditStringId.DefaultStyleName_TableSimple2"),NJ.add(e,NJ.TableSimple3,"XtraRichEditStringId.DefaultStyleName_TableSimple3"),NJ.add(e,NJ.TableSubtle1,"XtraRichEditStringId.DefaultStyleName_TableSubtle1"),NJ.add(e,NJ.TableSubtle2,"XtraRichEditStringId.DefaultStyleName_TableSubtle2"),NJ.add(e,NJ.TableTheme,"XtraRichEditStringId.DefaultStyleName_TableTheme"),NJ.add(e,NJ.TOAHeading,"XtraRichEditStringId.DefaultStyleName_toaheading"),NJ.addAndLink(e,NJ.Title,"XtraRichEditStringId.DefaultStyleName_Title"),NJ.addAndLink(e,NJ.Subtitle,"XtraRichEditStringId.DefaultStyleName_Subtitle"),NJ.addAndLink(e,NJ.TOC1,"XtraRichEditStringId.DefaultStyleName_toc1"),NJ.addAndLink(e,NJ.TOC2,"XtraRichEditStringId.DefaultStyleName_toc2"),NJ.addAndLink(e,NJ.TOC3,"XtraRichEditStringId.DefaultStyleName_toc3"),NJ.addAndLink(e,NJ.TOC4,"XtraRichEditStringId.DefaultStyleName_toc4"),NJ.addAndLink(e,NJ.TOC5,"XtraRichEditStringId.DefaultStyleName_toc5"),NJ.addAndLink(e,NJ.TOC6,"XtraRichEditStringId.DefaultStyleName_toc6"),NJ.addAndLink(e,NJ.TOC7,"XtraRichEditStringId.DefaultStyleName_toc7"),NJ.addAndLink(e,NJ.TOC8,"XtraRichEditStringId.DefaultStyleName_toc8"),NJ.addAndLink(e,NJ.TOC9,"XtraRichEditStringId.DefaultStyleName_toc9"),NJ.addAndLink(e,NJ.Heading1,"XtraRichEditStringId.DefaultStyleName_heading1"),NJ.addAndLink(e,NJ.Heading2,"XtraRichEditStringId.DefaultStyleName_heading2"),NJ.addAndLink(e,NJ.Heading3,"XtraRichEditStringId.DefaultStyleName_heading3"),NJ.addAndLink(e,NJ.Heading4,"XtraRichEditStringId.DefaultStyleName_heading4"),NJ.addAndLink(e,NJ.Heading5,"XtraRichEditStringId.DefaultStyleName_heading5"),NJ.addAndLink(e,NJ.Heading6,"XtraRichEditStringId.DefaultStyleName_heading6"),NJ.addAndLink(e,NJ.Heading7,"XtraRichEditStringId.DefaultStyleName_heading7"),NJ.addAndLink(e,NJ.Heading8,"XtraRichEditStringId.DefaultStyleName_heading8"),NJ.addAndLink(e,NJ.Heading9,"XtraRichEditStringId.DefaultStyleName_heading9"),NJ.addAndLink(e,NJ.Quote,"XtraRichEditStringId.DefaultStyleName_Quote"),NJ.addAndLink(e,NJ.IntenseQuote,"XtraRichEditStringId.DefaultStyleName_IntenseQuote"),NJ.add(e,NJ.NoSpacing,"XtraRichEditStringId.DefaultStyleName_NoSpacing"),NJ.add(e,NJ.ListParagraph,"XtraRichEditStringId.DefaultStyleName_ListParagraph"),NJ.add(e,NJ.IntenseEmphasis,"XtraRichEditStringId.DefaultStyleName_IntenseEmphasis"),NJ.add(e,NJ.SubtleEmphasis,"XtraRichEditStringId.DefaultStyleName_SubtleEmphasis"),NJ.add(e,NJ.BookTitle,"XtraRichEditStringId.DefaultStyleName_BookTitle"),e}static add(e,t,r){e[t.toLocaleLowerCase()]=(0,OV.formatMessage)(r)}static addAndLink(e,t,r){NJ.add(e,t,r),e[t.toLocaleLowerCase()+" char"]=(0,OV.formatMessage)("XtraRichEditStringId.LinkedCharacterStyleFormatString",(0,OV.formatMessage)(r))}}NJ.AnnotationText="annotation text",NJ.AnnotationReference="annotation reference",NJ.AnnotationSubject="annotation subject",NJ.ArticleSection="Article / Section",NJ.BalloonText="Balloon Text",NJ.BlockText="Block Text",NJ.BodyText="Body Text",NJ.BodyText2="Body Text 2",NJ.BodyText3="Body Text 3",NJ.BodyTextFirstIndent="Body Text First Indent",NJ.BodyTextFirstIndent2="Body Text First Indent 2",NJ.BodyTextIndent="Body Text Indent",NJ.BodyTextIndent2="Body Text Indent 2",NJ.BodyTextIndent3="Body Text Indent 3",NJ.Caption="Caption",NJ.Closing="Closing",NJ.CommentReference="Comment Reference",NJ.CommentSubject="Comment Subject",NJ.CommentText="Comment Text",NJ.Date="Date",NJ.DocumentMap="Document Map",NJ.EmailSignature="E-mail Signature",NJ.EndnoteReference="Endnote Reference",NJ.EndnoteText="Endnote Text",NJ.EnvelopeAddress="Envelope Address",NJ.EnvelopeReturn="Envelope Return",NJ.Footer="Footer",NJ.FootnoteText="Footnote Text",NJ.FootnoteReference="Footnote Reference",NJ.Header="Header",NJ.Heading1="Heading 1",NJ.Heading2="Heading 2",NJ.Heading3="Heading 3",NJ.Heading4="Heading 4",NJ.Heading5="Heading 5",NJ.Heading6="Heading 6",NJ.Heading7="Heading 7",NJ.Heading8="Heading 8",NJ.Heading9="Heading 9",NJ.HTMLAcronym="HTML Acronym",NJ.HTMLAddress="HTML Address",NJ.HTMLBottomOfForm="HTML Bottom of Form",NJ.HTMLCite="HTML Cite",NJ.HTMLCode="HTML Code",NJ.HTMLDefinition="HTML Definition",NJ.HTMLKeyboard="HTML Keyboard",NJ.HTMLPreformatted="HTML Preformatted",NJ.HTMLSample="HTML Sample",NJ.HTMLTopOfForm="HTML Top of Form",NJ.HTMLTypewriter="HTML Typewriter",NJ.HTMLVariable="HTML Variable",NJ.HyperlinkFollowed="HyperlinkFollowed",NJ.HyperlinkStrongEmphasis="HyperlinkStrongEmphasis",NJ.Emphasis="Emphasis",NJ.FollowedHyperlink="FollowedHyperlink",NJ.Index1="Index 1",NJ.Index2="Index 2",NJ.Index3="Index 3",NJ.Index4="Index 4",NJ.Index5="Index 5",NJ.Index6="Index 6",NJ.Index7="Index 7",NJ.Index8="Index 8",NJ.Index9="Index 9",NJ.IndexHeading="Index Heading",NJ.List="List",NJ.List2="List 2",NJ.List3="List 3",NJ.List4="List 4",NJ.List5="List 5",NJ.ListBullet="List Bullet",NJ.ListBullet2="List Bullet 2",NJ.ListBullet3="List Bullet 3",NJ.ListBullet4="List Bullet 4",NJ.ListBullet5="List Bullet 5",NJ.ListContinue="List Continue",NJ.ListContinue2="List Continue 2",NJ.ListContinue3="List Continue 3",NJ.ListContinue4="List Continue 4",NJ.ListContinue5="List Continue 5",NJ.ListNumber="List Number",NJ.ListNumber2="List Number 2",NJ.ListNumber3="List Number 3",NJ.ListNumber4="List Number 4",NJ.ListNumber5="List Number 5",NJ.MacroText="Macro Text",NJ.MacroToAHeading="macro to a heading",NJ.MessageHeader="Message Header",NJ.NoList="No List",NJ.NormalIndent="Normal Indent",NJ.NormalWeb="Normal (Web)",NJ.NoteHeading="Note Heading",NJ.NormalTable="Normal Table",NJ.OutlineList1="Outline List 1",NJ.OutlineList2="Outline List 2",NJ.OutlineList3="Outline List 3",NJ.PageNumber="Page Number",NJ.PlainText="Plain Text",NJ.Salutation="Salutation",NJ.Signature="Signature",NJ.Strong="Strong",NJ.Subtitle="Subtitle",NJ.TableOfAuthorities="Table of Authorities",NJ.TableOfFigures="Table of Figures",NJ.Table3DEffects1="Table 3D effects 1",NJ.Table3DEffects2="Table 3D effects 2",NJ.Table3DEffects3="Table 3D effects 3",NJ.TableClassic1="Table Classic 1",NJ.TableClassic2="Table Classic 2",NJ.TableClassic3="Table Classic 3",NJ.TableClassic4="Table Classic 4",NJ.TableColorful1="Table Colorful 1",NJ.TableColorful2="Table Colorful 2",NJ.TableColorful3="Table Colorful 3",NJ.TableColumns1="Table Columns 1",NJ.TableColumns2="Table Columns 2",NJ.TableColumns3="Table Columns 3",NJ.TableColumns4="Table Columns 4",NJ.TableColumns5="Table Columns 5",NJ.TableContemporary="Table Contemporary",NJ.TableElegant="Table Elegant",NJ.TableGrid="Table Grid",NJ.TableGrid1="Table Grid 1",NJ.TableGrid2="Table Grid 2",NJ.TableGrid3="Table Grid 3",NJ.TableGrid4="Table Grid 4",NJ.TableGrid5="Table Grid 5",NJ.TableGrid6="Table Grid 6",NJ.TableGrid7="Table Grid 7",NJ.TableGrid8="Table Grid 8",NJ.TableList1="Table List 1",NJ.TableList2="Table List 2",NJ.TableList3="Table List 3",NJ.TableList4="Table List 4",NJ.TableList5="Table List 5",NJ.TableList6="Table List 6",NJ.TableList7="Table List 7",NJ.TableList8="Table List 8",NJ.TableNormal="Table Normal",NJ.TableProfessional="Table Professional",NJ.TableSimple1="Table Simple 1",NJ.TableSimple2="Table Simple 2",NJ.TableSimple3="Table Simple 3",NJ.TableSubtle1="Table Subtle 1",NJ.TableSubtle2="Table Subtle 2",NJ.TableTheme="Table Theme",NJ.TableWeb1="Table Web 1",NJ.TableWeb2="Table Web 2",NJ.TableWeb3="Table Web 3",NJ.Title="Title",NJ.TOAHeading="TOA Heading",NJ.TOC1="TOC 1",NJ.TOC2="TOC 2",NJ.TOC3="TOC 3",NJ.TOC4="TOC 4",NJ.TOC5="TOC 5",NJ.TOC6="TOC 6",NJ.TOC7="TOC 7",NJ.TOC8="TOC 8",NJ.TOC9="TOC 9",NJ.Quote="Quote",NJ.IntenseQuote="Intense Quote",NJ.NoSpacing="No Spacing",NJ.ListParagraph="List Paragraph",NJ.IntenseEmphasis="Intense Emphasis",NJ.SubtleEmphasis="Subtle Emphasis",NJ.BookTitle="Book Title";class kJ{static getFontSizesList(){return[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72]}static getParagraphStylesList(){return kJ.getLocalizedDefaultPresetStyles()[1].filter((e=>0==e[4])).map((e=>({text:Wh.paragraphPrefix+e[5],value:Wh.paragraphPrefix+e[0]})))}static getTableStylesList(){return kJ.getLocalizedDefaultPresetStyles()[2].map((e=>({text:e[5],value:e[0]}))).sort()}static getLocalizedDefaultPresetStyles(){if(kJ.localizedDefaultPresetStyles)return kJ.localizedDefaultPresetStyles;kJ.localizedDefaultPresetStyles={5:{1:{0:{28:0,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:0,6:0,5:0,4:0,3:0,2:0,1:0,0:0},4:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:1,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:240,6:0,5:0,4:0,3:0,2:0,1:0,0:0},7:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:2,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:40,6:0,5:0,4:0,3:0,2:0,1:0,0:0},8:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:3,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:40,6:0,5:0,4:0,3:0,2:0,1:0,0:0},9:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:4,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:40,6:0,5:0,4:0,3:0,2:0,1:0,0:0},10:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:5,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:40,6:0,5:0,4:0,3:0,2:0,1:0,0:0},11:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:6,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:40,6:0,5:0,4:0,3:0,2:0,1:0,0:0},12:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:7,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:40,6:0,5:0,4:0,3:0,2:0,1:0,0:0},13:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:8,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:40,6:0,5:0,4:0,3:0,2:0,1:0,0:0},14:{28:65560,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:9,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:40,6:0,5:0,4:0,3:0,2:0,1:0,0:0},19:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:0,2:0,1:0,0:0},20:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:220,2:0,1:0,0:0},21:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:440,2:0,1:0,0:0},22:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:660,2:0,1:0,0:0},23:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:880,2:0,1:0,0:0},24:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:1100,2:0,1:0,0:0},25:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:1320,2:0,1:0,0:0},26:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:1540,2:0,1:0,0:0},27:{28:58,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:100,7:0,6:0,5:3,4:1.08,3:1760,2:0,1:0,0:0},29:{28:48,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:0,6:0,5:0,4:0,3:0,2:0,1:0,0:0},33:{28:15,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:200,6:864,5:0,4:0,3:864,2:0,1:0,0:2},37:{28:31,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:360,7:360,6:864,5:0,4:0,3:864,2:0,1:0,0:2},39:{28:57,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:0,6:0,5:0,4:0,3:0,2:0,1:0,0:0},40:{28:34,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:0,6:0,5:0,4:0,3:720,2:0,1:0,0:0},41:{28:1,27:{6:0,5:0,4:0,3:0,2:0,0:0},26:0,25:0,24:{6:0,5:0,4:0,3:0,2:0,0:0},23:{6:0,5:0,4:0,3:0,2:0,0:0},22:{6:0,5:0,4:0,3:0,2:0,0:0},21:{6:0,5:0,4:0,3:0,2:0,0:0},20:0,18:0,17:1,16:0,15:0,14:0,13:0,12:0,11:0,10:0,9:0,8:0,7:0,6:0,5:0,4:0,3:0,2:0,1:0,0:1}},6:{0:{1:.65,4:.14,5:"Angsana New",2:"'Angsana New', serif",3:1,0:"Angsana New"},1:{1:.65,4:.14,5:"Arial",2:"Arial, Helvetica, sans-serif",3:1,0:"Arial"},2:{1:.65,4:.06,5:"Arial Black",2:"'Arial Black', Gadget, sans-serif",3:1,0:"Arial Black"},3:{1:.65,4:.14,5:"Batang",2:"Batang, 바탕, serif",3:1,0:"Batang"},4:{1:.65,4:.14,5:"Book Antiqua",2:"'Book Antiqua', serif",3:1,0:"Book Antiqua"},5:{1:.65,4:.14,5:"Bookman Old Style",2:"'Bookman Old Style', serif",3:1,0:"Bookman Old Style"},6:{1:.65,4:.14,5:"Calibri",2:"Calibri, sans-serif",3:1,0:"Calibri"},7:{1:.65,4:.14,5:"Calibri Light",2:"'Calibri Light', 'Microsoft Sans Serif'",3:1,0:"Calibri Light"},8:{1:.65,4:.08,5:"Cambria",2:"Cambria, serif",3:1,0:"Cambria"},9:{1:.65,4:.14,5:"Candara",2:"Candara, sans-serif",3:1,0:"Candara"},10:{1:.65,4:.14,5:"Century",2:"Century, serif",3:1,0:"Century"},11:{1:.65,4:.14,5:"Century Gothic",2:"'Century Gothic', sans-serif",3:1,0:"Century Gothic"},12:{1:.65,4:.14,5:"Century Schoolbook",2:"'Century Schoolbook', serif",3:1,0:"Century Schoolbook"},13:{1:.65,4:.14,5:"Comic Sans MS",2:"'Comic Sans MS', fantasy, cursive, sans-serif",3:1,0:"Comic Sans MS"},14:{1:.65,4:.14,5:"Consolas",2:"Consolas, monospace",3:1,0:"Consolas"},15:{1:.65,4:.14,5:"Constantia",2:"Constantia, serif",3:1,0:"Constantia"},16:{1:.65,4:.14,5:"Corbel",2:"Corbel, sans-serif",3:1,0:"Corbel"},17:{1:.65,4:.14,5:"Cordia New",2:"'Cordia New', sans-serif",3:1,0:"Cordia New"},18:{1:.65,4:.14,5:"Courier New",2:"'Courier New', Courier, monospace",3:1,0:"Courier New"},19:{1:.65,4:.14,5:"DaunPenh",2:"DaunPenh, sans-serif",3:1,0:"DaunPenh"},20:{1:.65,4:.14,5:"Dotum",2:"Dotum, 돋움, sans-serif",3:1,0:"Dotum"},21:{1:.65,4:.14,5:"FangSong",2:"FangSong, serif",3:1,0:"FangSong"},22:{1:.65,4:.14,5:"Franklin Gothic Book",2:"'Franklin Gothic Book', sans-serif",3:1,0:"Franklin Gothic Book"},23:{1:.65,4:.14,5:"Franklin Gothic Medium",2:"'Franklin Gothic Medium', sans-serif",3:1,0:"Franklin Gothic Medium"},24:{1:.65,4:.14,5:"Garamond",2:"Garamond, serif",3:1,0:"Garamond"},25:{1:.65,4:.14,5:"Gautami",2:"Gautami, sans-serif",3:1,0:"Gautami"},26:{1:.65,4:.08,5:"Georgia",2:"Georgia, serif",3:1,0:"Georgia"},27:{1:.65,4:.14,5:"Gill Sans MT",2:"'Gill Sans MT', sans-serif",3:1,0:"Gill Sans MT"},28:{1:.65,4:.14,5:"Gulim",2:"Gulim, 굴림, sans-serif",3:1,0:"Gulim"},29:{1:.65,4:.14,5:"GungSuh",2:"GungSuh, serif",3:1,0:"GungSuh"},30:{1:.53,4:0,5:"Impact",2:"Impact, Charcoal, sans-serif",3:1,0:"Impact"},31:{1:.65,4:.14,5:"Iskoola Pota",2:"'Iskoola Pota', sans-serif",3:1,0:"Iskoola Pota"},32:{1:.65,4:.14,5:"KaiTi",2:"KaiTi, sans-serif",3:1,0:"KaiTi"},33:{1:.65,4:.14,5:"Kalinga",2:"Kalinga, sans-serif",3:1,0:"Kalinga"},34:{1:.65,4:.14,5:"Kartika",2:"Kartika, sans-serif",3:1,0:"Kartika"},35:{1:.65,4:.14,5:"Latha",2:"Latha, sans-serif",3:1,0:"Latha"},36:{1:.65,4:.08,5:"Lucida Console",2:"'Lucida Console', Monaco, monospace",3:1,0:"Lucida Console"},37:{1:.65,4:.14,5:"Lucida Sans",2:"'Lucida Sans', sans-serif",3:1,0:"Lucida Sans"},38:{1:.65,4:.08,5:"Lucida Sans Unicode",2:"'Lucida Sans Unicode', 'Lucida Grande', sans-serif",3:1,0:"Lucida Sans Unicode"},39:{1:.65,4:.14,5:"Malgun Gothic",2:"'Malgun Gothic', '맑은 고딕', sans-serif",3:1,0:"Malgun Gothic"},40:{1:.65,4:.14,5:"Mangal",2:"Mangal, sans-serif",3:1,0:"Mangal"},41:{1:.65,4:.14,5:"Meiryo",2:"Meiryo, メイリオ, sans-serif",3:1,0:"Meiryo"},42:{1:.65,4:.14,5:"Microsoft JhengHei",2:"'Microsoft JhengHei', 微軟正黑體, sans-serif",3:1,0:"Microsoft JhengHei"},43:{1:.65,4:.14,5:"Microsoft YaHei",2:"'Microsoft YaHei', 微软雅黑, sans-serif",3:1,0:"Microsoft YaHei"},44:{1:.5,4:0,5:"MingLiU",2:"MingLiU, 細明體, serif",3:1,0:"MingLiU"},45:{1:.5,4:0,5:"MingLiU_HKSCS",2:"MingLiU_HKSCS, 細明體_HKSCS, serif",3:1,0:"MingLiU_HKSCS"},46:{1:.5,4:.36,5:"MS Gothic",2:"'MS Gothic', 'ＭＳ ゴシック', sans-serif",3:1,0:"MS Gothic"},47:{1:.65,4:.14,5:"MS Mincho",2:"'MS Mincho', 'ＭＳ 明朝', serif",3:1,0:"MS Mincho"},48:{1:.65,4:.14,5:"MS PGothic",2:"'MS PGothic', 'ＭＳ Ｐゴシック', sans-serif",3:1,0:"MS PGothic"},49:{1:.65,4:.14,5:"MS PMincho",2:"'MS PMincho', 'ＭＳ Ｐ明朝', serif",3:1,0:"MS PMincho"},50:{1:.65,4:.14,5:"Nyala",2:"Nyala, sans-serif",3:1,0:"Nyala"},51:{1:.6,4:0,5:"Palatino Linotype",2:"'Palatino Linotype', 'Book Antiqua', Palatino, serif",3:1,0:"Palatino Linotype"},52:{1:.5,4:0,5:"PMingLiU",2:"PMingLiU, 新細明體, serif",3:1,0:"PMingLiU"},53:{1:.5,4:0,5:"PMingLiU-ExtB",2:"PMingLiU-ExtB, 新細明體-ExtB, 新細明體-ExtB, PMingLiU, serif",3:1,0:"PMingLiU-ExtB"},54:{1:.65,4:.14,5:"Raavi",2:"Raavi, sans-serif",3:1,0:"Raavi"},55:{1:.65,4:.14,5:"Rockwell",2:"Rockwell, serif",3:1,0:"Rockwell"},56:{1:.65,4:.14,5:"Segoe UI",2:"'Segoe UI', sans-serif",3:1,0:"Segoe UI"},57:{1:.65,4:.14,5:"Segoe UI Light",2:"'Segoe UI Light', sans-serif",3:1,0:"Segoe UI Light"},58:{1:.65,4:.14,5:"Shruti",2:"Shruti, sans-serif",3:1,0:"Shruti"},59:{1:.65,4:.14,5:"SimHei",2:"SimHei, 黑体, sans-serif",3:1,0:"SimHei"},60:{1:.5,4:.06,5:"SimSun",2:"SimSun, 宋体, serif",3:1,0:"SimSun"},61:{1:.5,4:.06,5:"SimSun-ExtB",2:"SimSun-ExtB, serif",3:1,0:"SimSun-ExtB"},62:{1:.6,4:0,5:"Sylfaen",2:"Sylfaen, serif",3:1,0:"Sylfaen"},63:{1:.65,4:.14,5:"Tahoma",2:"Tahoma, Geneva, sans-serif",3:1,0:"Tahoma"},64:{1:.65,4:.14,5:"Times",2:"Times, 'Times New Roman', serif",3:1,0:"Times"},65:{1:.65,4:.14,5:"Times New Roman",2:"'Times New Roman', Times, serif",3:1,0:"Times New Roman"},66:{1:.65,4:.14,5:"Trebuchet MS",2:"'Trebuchet MS', Helvetica, sans-serif",3:1,0:"Trebuchet MS"},67:{1:.65,4:.14,5:"Tunga",2:"Tunga, sans-serif",3:1,0:"Tunga"},68:{1:.65,4:.14,5:"TW Cen MT",2:"'TW Cen MT', sans-serif",3:1,0:"TW Cen MT"},69:{1:.65,4:.14,5:"Verdana",2:"Verdana, Geneva, sans-serif",3:1,0:"Verdana"},70:{1:.65,4:.14,5:"Vrinda",2:"Vrinda, sans-serif",3:1,0:"Vrinda"}},7:{0:{3:0,0:0,4:0},3:{3:0,0:0,4:-11566659},4:{3:0,0:0,4:-12566464},5:{3:0,0:0,4:-13732683},6:{3:0,0:0,4:-14725768},7:{3:0,0:0,4:-14211289},8:{3:0,0:0,4:-10855846},9:{3:0,0:0,4:-10773547},2:{3:0,0:0,4:-16777216},10:{3:0,0:0,4:-4210753},11:{3:0,0:0,4:-8421505},14:{3:0,0:0,4:-6710887},15:{3:0,0:0,4:-10066330},13:{3:0,0:0,4:-1},17:{3:0,0:0,4:-4335890},18:{3:0,0:0,4:-6503707},20:{3:0,0:0,4:-537940},21:{3:0,0:0,4:-1213135},23:{3:0,0:0,4:-2368549},24:{3:0,0:0,4:-5921371},26:{3:0,0:0,4:-6759},27:{3:0,0:0,4:-16384},29:{3:0,0:0,4:-4929817},30:{3:0,0:0,4:-12291388},32:{3:0,0:0,4:-3809101},33:{3:0,0:0,4:-9392825},12:{3:0,0:0,4:-855310},16:{3:0,0:0,4:-3355444},19:{3:0,0:0,4:-2168074},22:{3:0,0:0,4:-269099},25:{3:0,0:0,4:-1184275},28:{3:0,0:0,4:-3380},31:{3:0,0:0,4:-2497805},34:{3:0,0:0,4:-1904679}},4:{118:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:33,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},117:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:22,9:1273856,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},116:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:22,9:1290240,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},115:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:22,9:1232896,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},114:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:22,9:1236992,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},113:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:23,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},112:{1:{1:{6:0,5:0,4:0,3:10,2:33,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:33,0:1},3:{6:0,5:0,4:0,3:10,2:33,0:1},0:{6:0,5:0,4:0,3:10,2:33,0:1}},6:0,4:0,5:0,8:22,9:1306624,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},111:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:33,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},110:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:33,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},109:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:33,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},108:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:33,0:3}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},107:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:21,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},106:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:33,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},105:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:33,0:3}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},104:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:30,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},103:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:19,9:1273856,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},102:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:19,9:1290240,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},101:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:19,9:1232896,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},100:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:19,9:1236992,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},99:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:20,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},98:{1:{1:{6:0,5:0,4:0,3:10,2:30,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:30,0:1},3:{6:0,5:0,4:0,3:10,2:30,0:1},0:{6:0,5:0,4:0,3:10,2:30,0:1}},6:0,4:0,5:0,8:19,9:1306624,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},97:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:30,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},96:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:30,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},95:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:30,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},94:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:30,0:3}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},93:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:18,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},92:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:30,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},91:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:30,0:3}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},90:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:27,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},89:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:16,9:1273856,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},88:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:16,9:1290240,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},87:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:16,9:1232896,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},86:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:16,9:1236992,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},85:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:17,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},84:{1:{1:{6:0,5:0,4:0,3:10,2:27,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:27,0:1},3:{6:0,5:0,4:0,3:10,2:27,0:1},0:{6:0,5:0,4:0,3:10,2:27,0:1}},6:0,4:0,5:0,8:16,9:1306624,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},83:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:27,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},82:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:27,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},81:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:27,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},80:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:27,0:3}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},79:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:15,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},78:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:27,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},77:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:27,0:3}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},76:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:24,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},75:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:13,9:1273856,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},74:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:13,9:1290240,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},73:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:13,9:1232896,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},72:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:13,9:1236992,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},71:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:14,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},70:{1:{1:{6:0,5:0,4:0,3:10,2:24,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:24,0:1},3:{6:0,5:0,4:0,3:10,2:24,0:1},0:{6:0,5:0,4:0,3:10,2:24,0:1}},6:0,4:0,5:0,8:13,9:1306624,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},69:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:24,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},68:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:24,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},67:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:24,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},66:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:24,0:3}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},65:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:12,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},64:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:24,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},63:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:24,0:3}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},62:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:21,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},61:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:10,9:1273856,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},60:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:10,9:1290240,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},59:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:10,9:1232896,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},58:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:10,9:1236992,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},57:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:11,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},56:{1:{1:{6:0,5:0,4:0,3:10,2:21,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:21,0:1},3:{6:0,5:0,4:0,3:10,2:21,0:1},0:{6:0,5:0,4:0,3:10,2:21,0:1}},6:0,4:0,5:0,8:10,9:1306624,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},55:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:21,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},54:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:21,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},53:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:21,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},52:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:21,0:3}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},51:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:9,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},50:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:21,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},49:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:21,0:3}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},48:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:18,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},47:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:7,9:1273856,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},46:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:7,9:1290240,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},45:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:7,9:1232896,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},44:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:7,9:1236992,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},43:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:8,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},42:{1:{1:{6:0,5:0,4:0,3:10,2:9,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:9,0:1},3:{6:0,5:0,4:0,3:10,2:9,0:1},0:{6:0,5:0,4:0,3:10,2:9,0:1}},6:0,4:0,5:0,8:7,9:1306624,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},41:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:9,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},40:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:18,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},39:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:18,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},38:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:18,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},37:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:18,0:3}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},36:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:6,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},35:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:18,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},34:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:18,0:3}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},33:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:15,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},32:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:4,9:1273856,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},31:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:4,9:1290240,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},30:{1:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:4,9:1232896,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},29:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},6:0,4:0,5:0,8:4,9:1236992,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},28:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:5,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},27:{1:{1:{6:0,5:0,4:0,3:10,2:2,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:2,0:1},3:{6:0,5:0,4:0,3:10,2:2,0:1},0:{6:0,5:0,4:0,3:10,2:2,0:1}},6:0,4:0,5:0,8:4,9:1306624,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},26:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:2,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},25:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1273856,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},24:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1290240,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},23:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1298432,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},22:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1302528,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},21:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:15,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},20:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:15,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},19:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:15,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},18:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:15,0:3}},6:0,4:0,5:0,8:2,9:1294336,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},17:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:3,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},16:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:30,2:15,0:3},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},15:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:5,2:15,0:3}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},14:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:11,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1081344,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},13:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:11,0:1}},6:0,4:0,5:0,8:2,9:1064960,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},12:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:11,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1056768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},11:{1:{1:{6:0,5:0,4:0,3:10,2:11,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:2,9:1052672,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},10:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},9:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:11,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:8192,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},8:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:4096,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},7:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:8192,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},6:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:11,0:1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:32768,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},5:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:11,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},4:{1:{1:{6:0,5:0,4:0,3:10,2:11,0:1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:10,2:11,0:1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:12288,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},3:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:11,0:1},0:{6:0,5:0,4:0,3:10,2:11,0:1}},6:0,4:0,5:0,8:0,9:49152,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},2:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:10,2:10,0:1}},6:0,4:0,5:0,8:0,9:16384,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},1:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:1,9:1048576,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}},0:{1:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},6:0,4:0,5:0,8:0,9:0,2:0,3:0,0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}}}},8:{0:{3:0,0:0,4:0},1:{3:0,0:0,4:12},2:{3:0,0:0,4:13},3:{3:0,0:0,4:16},4:{3:0,0:0,4:2},5:{3:0,0:0,4:14},6:{3:0,0:0,4:19},7:{3:0,0:0,4:9},8:{3:0,0:0,4:17},9:{3:0,0:0,4:22},10:{3:0,0:0,4:21},11:{3:0,0:0,4:20},12:{3:0,0:0,4:25},13:{3:0,0:0,4:24},14:{3:0,0:0,4:23},15:{3:0,0:0,4:28},16:{3:0,0:0,4:27},17:{3:0,0:0,4:26},18:{3:0,0:0,4:31},19:{3:0,0:0,4:30},20:{3:0,0:0,4:29},21:{3:0,0:0,4:34},22:{3:0,0:0,4:33},23:{3:0,0:0,4:32}},3:{0:{1:0,6:0,4:3,5:0,2:0,3:0,0:{0:0,1:0}}},0:{0:{13:0,14:"Calibri",8:0,9:0,21:0,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},4:{13:4,14:"Calibri",8:0,9:0,21:0,25:0,11:{2:"",0:"",1:""},2:1,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},5:{13:8,14:"Calibri",8:0,9:0,21:0,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},6:{13:136,14:"Calibri",8:0,9:0,21:3,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},7:{13:136,14:"Calibri",8:0,9:0,21:4,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},8:{13:12,14:"Calibri",8:0,9:0,21:0,25:0,11:{2:"",0:"",1:""},2:1,3:1,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},11:{13:131,14:"Calibri Light",8:0,9:0,21:5,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:7,1:16,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},13:{13:131,14:"Calibri Light",8:0,9:0,21:5,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:7,1:13,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},15:{13:131,14:"Calibri Light",8:0,9:0,21:6,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:7,1:12,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},17:{13:137,14:"Calibri Light",8:0,9:0,21:5,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:7,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},16:{13:129,14:"Calibri Light",8:0,9:0,21:5,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:7,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},14:{13:129,14:"Calibri Light",8:0,9:0,21:6,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:7,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},18:{13:137,14:"Calibri Light",8:0,9:0,21:6,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:7,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},20:{13:131,14:"Calibri Light",8:0,9:0,21:7,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:7,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},21:{13:139,14:"Calibri Light",8:0,9:0,21:7,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:7,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},22:{13:128,14:"Calibri",8:0,9:0,21:8,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},23:{13:3,14:"Calibri Light",8:0,9:0,21:0,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:7,1:28,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},25:{13:137,14:"Calibri Light",8:0,9:0,21:4,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:7,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},26:{13:137,14:"Calibri Light",8:0,9:0,21:9,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:7,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},28:{13:68,14:"Calibri",8:0,9:0,21:0,25:0,11:{2:"",0:"",1:""},2:1,3:0,0:6,1:11,6:1,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},30:{13:10,14:"Calibri",8:0,9:0,21:0,25:0,11:{2:"",0:"",1:""},2:0,3:1,0:6,1:13,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},31:{13:132,14:"Calibri",8:0,9:0,21:13,25:0,11:{2:"",0:"",1:""},2:1,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},32:{13:128,14:"Calibri",8:0,9:0,21:2,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},33:{13:128,14:"Calibri",8:0,9:0,21:9,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},34:{13:128,14:"Calibri",8:0,9:0,21:21,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},35:{13:128,14:"Calibri",8:0,9:0,21:24,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},36:{13:128,14:"Calibri",8:0,9:0,21:27,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},37:{13:128,14:"Calibri",8:0,9:0,21:30,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0},38:{13:128,14:"Calibri",8:0,9:0,21:33,25:0,11:{2:"",0:"",1:""},2:0,3:0,0:6,1:11,6:0,7:0,4:0,5:0,12:0,23:0,10:0,22:0,24:0}}},2:[{1:0,6:0,4:0,5:"Normal Table",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:3,1:108},3:{0:3,1:0},0:{0:3,1:0},1:{0:3,1:108}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:15}},9:{},2:0,0:"Normal Table"},{1:0,6:0,4:0,5:"Grid Table Light",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:10,0:1},4:{6:0,5:0,4:0,3:10,2:10,0:1},5:{6:0,5:0,4:0,3:10,2:10,0:1},2:{6:0,5:0,4:0,3:10,2:10,0:1},3:{6:0,5:0,4:0,3:10,2:10,0:1},0:{6:0,5:0,4:0,3:10,2:10,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:516096}},9:{},2:0,3:"Normal Table",0:"Grid Table Light"},{1:0,6:0,4:0,5:"Plain Table 1",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:10,0:1},4:{6:0,5:0,4:0,3:10,2:10,0:1},5:{6:0,5:0,4:0,3:10,2:10,0:1},2:{6:0,5:0,4:0,3:10,2:10,0:1},3:{6:0,5:0,4:0,3:10,2:10,0:1},0:{6:0,5:0,4:0,3:10,2:10,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:2,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:1,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:1,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Plain Table 1"},{1:0,6:0,4:0,5:"Plain Table 2",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:10,2:11,0:1},0:{6:0,5:0,4:0,3:10,2:11,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:99840}},9:{64:{1:0,4:0,5:[],2:4,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:3,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:6,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:4,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:5,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Plain Table 2"},{1:0,6:0,4:0,5:"Plain Table 3",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:1536}},9:{256:{1:0,4:28,5:[],2:8,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:28,5:[],2:10,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:28,5:[],2:9,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:7,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:8,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:1,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:28,5:[],2:6,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:1,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Plain Table 3"},{1:0,6:0,4:0,5:"Plain Table 4",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:1536}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:1,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:1,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Plain Table 4"},{1:0,6:0,4:0,5:"Plain Table 5",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:1536}},9:{1:{1:0,4:0,5:[],2:7,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:30,5:[],2:13,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:30,5:[],2:12,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:7,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:8,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:1,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:30,5:[],2:14,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:30,5:[],2:11,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2:{1:0,4:0,5:[],2:8,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:1,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Plain Table 5"},{1:0,6:0,4:0,5:"Grid Table 1 Light",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:14,0:1},4:{6:0,5:0,4:0,3:10,2:14,0:1},5:{6:0,5:0,4:0,3:10,2:14,0:1},2:{6:0,5:0,4:0,3:10,2:14,0:1},3:{6:0,5:0,4:0,3:10,2:14,0:1},0:{6:0,5:0,4:0,3:10,2:14,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:516096}},9:{1024:{1:0,4:4,5:[],2:15,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:16,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 1 Light"},{1:0,6:0,4:0,5:"Grid Table 2",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:5,2:15,0:3},5:{6:0,5:0,4:0,3:5,2:15,0:3},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:5,2:15,0:3},0:{6:0,5:0,4:0,3:5,2:15,0:3}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:493056}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:18,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:19,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 2"},{1:0,6:0,4:0,5:"Grid Table 3",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:15,0:1},4:{6:0,5:0,4:0,3:10,2:15,0:1},5:{6:0,5:0,4:0,3:10,2:15,0:1},2:{6:0,5:0,4:0,3:10,2:15,0:1},3:{6:0,5:0,4:0,3:10,2:15,0:1},0:{6:0,5:0,4:0,3:10,2:15,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517120}},9:{256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:21,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:21,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1:{1:0,4:0,5:[],2:20,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 3"},{1:0,6:0,4:0,5:"Grid Table 4",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:15,0:1},4:{6:0,5:0,4:0,3:10,2:15,0:1},5:{6:0,5:0,4:0,3:10,2:15,0:1},2:{6:0,5:0,4:0,3:10,2:15,0:1},3:{6:0,5:0,4:0,3:10,2:15,0:1},0:{6:0,5:0,4:0,3:10,2:15,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:26,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:27,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 4"},{1:0,6:0,4:0,5:"Grid Table 5 Dark",8:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:10,2:13,0:1},5:{6:0,5:0,4:0,3:10,2:13,0:1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:31,5:[],2:29,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:31,5:[],2:31,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:31,5:[],2:30,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:28,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:32,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:28,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 5 Dark"},{1:0,6:0,4:0,5:"Grid Table 6 Colorful",8:{1:0,4:32,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:15,0:1},4:{6:0,5:0,4:0,3:10,2:15,0:1},5:{6:0,5:0,4:0,3:10,2:15,0:1},2:{6:0,5:0,4:0,3:10,2:15,0:1},3:{6:0,5:0,4:0,3:10,2:15,0:1},0:{6:0,5:0,4:0,3:10,2:15,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:20,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:33,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 6 Colorful"},{1:0,6:0,4:0,5:"Grid Table 7 Colorful",8:{1:0,4:32,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:15,0:1},4:{6:0,5:0,4:0,3:10,2:15,0:1},5:{6:0,5:0,4:0,3:10,2:15,0:1},2:{6:0,5:0,4:0,3:10,2:15,0:1},3:{6:0,5:0,4:0,3:10,2:15,0:1},0:{6:0,5:0,4:0,3:10,2:15,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{1:{1:0,4:0,5:[],2:20,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:21,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:21,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2:{1:0,4:0,5:[],2:20,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:17,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 7 Colorful"},{1:0,6:0,4:0,5:"Grid Table 1 Light Accent 1",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:17,0:1},4:{6:0,5:0,4:0,3:10,2:17,0:1},5:{6:0,5:0,4:0,3:10,2:17,0:1},2:{6:0,5:0,4:0,3:10,2:17,0:1},3:{6:0,5:0,4:0,3:10,2:17,0:1},0:{6:0,5:0,4:0,3:10,2:17,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:516096}},9:{1024:{1:0,4:4,5:[],2:34,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:35,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 1 Light Accent 1"},{1:0,6:0,4:0,5:"Grid Table 2 Accent 1",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:5,2:18,0:3},5:{6:0,5:0,4:0,3:5,2:18,0:3},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:5,2:18,0:3},0:{6:0,5:0,4:0,3:5,2:18,0:3}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:493056}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:37,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:38,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 2 Accent 1"},{1:0,6:0,4:0,5:"Grid Table 3 Accent 1",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:18,0:1},4:{6:0,5:0,4:0,3:10,2:18,0:1},5:{6:0,5:0,4:0,3:10,2:18,0:1},2:{6:0,5:0,4:0,3:10,2:18,0:1},3:{6:0,5:0,4:0,3:10,2:18,0:1},0:{6:0,5:0,4:0,3:10,2:18,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517120}},9:{256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:40,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:40,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1:{1:0,4:0,5:[],2:39,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 3 Accent 1"},{1:0,6:0,4:0,5:"Grid Table 4 Accent 1",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:18,0:1},4:{6:0,5:0,4:0,3:10,2:18,0:1},5:{6:0,5:0,4:0,3:10,2:18,0:1},2:{6:0,5:0,4:0,3:10,2:18,0:1},3:{6:0,5:0,4:0,3:10,2:18,0:1},0:{6:0,5:0,4:0,3:10,2:18,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:41,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:42,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 4 Accent 1"},{1:0,6:0,4:0,5:"Grid Table 5 Dark Accent 1",8:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:10,2:13,0:1},5:{6:0,5:0,4:0,3:10,2:13,0:1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:31,5:[],2:44,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:31,5:[],2:46,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:31,5:[],2:45,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:43,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:47,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:43,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 5 Dark Accent 1"},{1:0,6:0,4:0,5:"Grid Table 6 Colorful Accent 1",8:{1:0,4:33,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:18,0:1},4:{6:0,5:0,4:0,3:10,2:18,0:1},5:{6:0,5:0,4:0,3:10,2:18,0:1},2:{6:0,5:0,4:0,3:10,2:18,0:1},3:{6:0,5:0,4:0,3:10,2:18,0:1},0:{6:0,5:0,4:0,3:10,2:18,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:39,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:48,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 6 Colorful Accent 1"},{1:0,6:0,4:0,5:"Grid Table 7 Colorful Accent 1",8:{1:0,4:33,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:18,0:1},4:{6:0,5:0,4:0,3:10,2:18,0:1},5:{6:0,5:0,4:0,3:10,2:18,0:1},2:{6:0,5:0,4:0,3:10,2:18,0:1},3:{6:0,5:0,4:0,3:10,2:18,0:1},0:{6:0,5:0,4:0,3:10,2:18,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{1:{1:0,4:0,5:[],2:39,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:40,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:40,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2:{1:0,4:0,5:[],2:39,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:36,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 7 Colorful Accent 1"},{1:0,6:0,4:0,5:"Grid Table 1 Light Accent 2",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:20,0:1},4:{6:0,5:0,4:0,3:10,2:20,0:1},5:{6:0,5:0,4:0,3:10,2:20,0:1},2:{6:0,5:0,4:0,3:10,2:20,0:1},3:{6:0,5:0,4:0,3:10,2:20,0:1},0:{6:0,5:0,4:0,3:10,2:20,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:516096}},9:{1024:{1:0,4:4,5:[],2:49,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:50,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 1 Light Accent 2"},{1:0,6:0,4:0,5:"Grid Table 2 Accent 2",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:5,2:21,0:3},5:{6:0,5:0,4:0,3:5,2:21,0:3},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:5,2:21,0:3},0:{6:0,5:0,4:0,3:5,2:21,0:3}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:493056}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:52,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:53,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 2 Accent 2"},{1:0,6:0,4:0,5:"Grid Table 3 Accent 2",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:21,0:1},4:{6:0,5:0,4:0,3:10,2:21,0:1},5:{6:0,5:0,4:0,3:10,2:21,0:1},2:{6:0,5:0,4:0,3:10,2:21,0:1},3:{6:0,5:0,4:0,3:10,2:21,0:1},0:{6:0,5:0,4:0,3:10,2:21,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517120}},9:{256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:55,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:55,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1:{1:0,4:0,5:[],2:54,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 3 Accent 2"},{1:0,6:0,4:0,5:"Grid Table 4 Accent 2",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:21,0:1},4:{6:0,5:0,4:0,3:10,2:21,0:1},5:{6:0,5:0,4:0,3:10,2:21,0:1},2:{6:0,5:0,4:0,3:10,2:21,0:1},3:{6:0,5:0,4:0,3:10,2:21,0:1},0:{6:0,5:0,4:0,3:10,2:21,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:54,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:56,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 4 Accent 2"},{1:0,6:0,4:0,5:"Grid Table 5 Dark Accent 2",8:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:10,2:13,0:1},5:{6:0,5:0,4:0,3:10,2:13,0:1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:31,5:[],2:58,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:31,5:[],2:60,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:31,5:[],2:59,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:57,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:61,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:57,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 5 Dark Accent 2"},{1:0,6:0,4:0,5:"Grid Table 6 Colorful Accent 2",8:{1:0,4:34,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:21,0:1},4:{6:0,5:0,4:0,3:10,2:21,0:1},5:{6:0,5:0,4:0,3:10,2:21,0:1},2:{6:0,5:0,4:0,3:10,2:21,0:1},3:{6:0,5:0,4:0,3:10,2:21,0:1},0:{6:0,5:0,4:0,3:10,2:21,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:54,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:62,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 6 Colorful Accent 2"},{1:0,6:0,4:0,5:"Grid Table 7 Colorful Accent 2",8:{1:0,4:34,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:21,0:1},4:{6:0,5:0,4:0,3:10,2:21,0:1},5:{6:0,5:0,4:0,3:10,2:21,0:1},2:{6:0,5:0,4:0,3:10,2:21,0:1},3:{6:0,5:0,4:0,3:10,2:21,0:1},0:{6:0,5:0,4:0,3:10,2:21,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{1:{1:0,4:0,5:[],2:54,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:55,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:55,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2:{1:0,4:0,5:[],2:54,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:51,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 7 Colorful Accent 2"},{1:0,6:0,4:0,5:"Grid Table 1 Light Accent 3",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:23,0:1},4:{6:0,5:0,4:0,3:10,2:23,0:1},5:{6:0,5:0,4:0,3:10,2:23,0:1},2:{6:0,5:0,4:0,3:10,2:23,0:1},3:{6:0,5:0,4:0,3:10,2:23,0:1},0:{6:0,5:0,4:0,3:10,2:23,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:516096}},9:{1024:{1:0,4:4,5:[],2:63,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:64,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 1 Light Accent 3"},{1:0,6:0,4:0,5:"Grid Table 2 Accent 3",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:5,2:24,0:3},5:{6:0,5:0,4:0,3:5,2:24,0:3},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:5,2:24,0:3},0:{6:0,5:0,4:0,3:5,2:24,0:3}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:493056}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:66,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:67,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 2 Accent 3"},{1:0,6:0,4:0,5:"Grid Table 3 Accent 3",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:24,0:1},4:{6:0,5:0,4:0,3:10,2:24,0:1},5:{6:0,5:0,4:0,3:10,2:24,0:1},2:{6:0,5:0,4:0,3:10,2:24,0:1},3:{6:0,5:0,4:0,3:10,2:24,0:1},0:{6:0,5:0,4:0,3:10,2:24,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517120}},9:{256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:69,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:69,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1:{1:0,4:0,5:[],2:68,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 3 Accent 3"},{1:0,6:0,4:0,5:"Grid Table 4 Accent 3",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:24,0:1},4:{6:0,5:0,4:0,3:10,2:24,0:1},5:{6:0,5:0,4:0,3:10,2:24,0:1},2:{6:0,5:0,4:0,3:10,2:24,0:1},3:{6:0,5:0,4:0,3:10,2:24,0:1},0:{6:0,5:0,4:0,3:10,2:24,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:68,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:70,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 4 Accent 3"},{1:0,6:0,4:0,5:"Grid Table 5 Dark Accent 3",8:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:10,2:13,0:1},5:{6:0,5:0,4:0,3:10,2:13,0:1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:31,5:[],2:72,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:31,5:[],2:74,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:31,5:[],2:73,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:71,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:75,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:71,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 5 Dark Accent 3"},{1:0,6:0,4:0,5:"Grid Table 6 Colorful Accent 3",8:{1:0,4:35,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:24,0:1},4:{6:0,5:0,4:0,3:10,2:24,0:1},5:{6:0,5:0,4:0,3:10,2:24,0:1},2:{6:0,5:0,4:0,3:10,2:24,0:1},3:{6:0,5:0,4:0,3:10,2:24,0:1},0:{6:0,5:0,4:0,3:10,2:24,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:68,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:76,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 6 Colorful Accent 3"},{1:0,6:0,4:0,5:"Grid Table 7 Colorful Accent 3",8:{1:0,4:35,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:24,0:1},4:{6:0,5:0,4:0,3:10,2:24,0:1},5:{6:0,5:0,4:0,3:10,2:24,0:1},2:{6:0,5:0,4:0,3:10,2:24,0:1},3:{6:0,5:0,4:0,3:10,2:24,0:1},0:{6:0,5:0,4:0,3:10,2:24,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{1:{1:0,4:0,5:[],2:68,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:69,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:69,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2:{1:0,4:0,5:[],2:68,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:65,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 7 Colorful Accent 3"},{1:0,6:0,4:0,5:"Grid Table 1 Light Accent 4",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:26,0:1},4:{6:0,5:0,4:0,3:10,2:26,0:1},5:{6:0,5:0,4:0,3:10,2:26,0:1},2:{6:0,5:0,4:0,3:10,2:26,0:1},3:{6:0,5:0,4:0,3:10,2:26,0:1},0:{6:0,5:0,4:0,3:10,2:26,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:516096}},9:{1024:{1:0,4:4,5:[],2:77,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:78,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 1 Light Accent 4"},{1:0,6:0,4:0,5:"Grid Table 2 Accent 4",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:5,2:27,0:3},5:{6:0,5:0,4:0,3:5,2:27,0:3},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:5,2:27,0:3},0:{6:0,5:0,4:0,3:5,2:27,0:3}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:493056}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:80,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:81,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 2 Accent 4"},{1:0,6:0,4:0,5:"Grid Table 3 Accent 4",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:27,0:1},4:{6:0,5:0,4:0,3:10,2:27,0:1},5:{6:0,5:0,4:0,3:10,2:27,0:1},2:{6:0,5:0,4:0,3:10,2:27,0:1},3:{6:0,5:0,4:0,3:10,2:27,0:1},0:{6:0,5:0,4:0,3:10,2:27,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517120}},9:{256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:83,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:83,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1:{1:0,4:0,5:[],2:82,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 3 Accent 4"},{1:0,6:0,4:0,5:"Grid Table 4 Accent 4",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:27,0:1},4:{6:0,5:0,4:0,3:10,2:27,0:1},5:{6:0,5:0,4:0,3:10,2:27,0:1},2:{6:0,5:0,4:0,3:10,2:27,0:1},3:{6:0,5:0,4:0,3:10,2:27,0:1},0:{6:0,5:0,4:0,3:10,2:27,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:82,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:84,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 4 Accent 4"},{1:0,6:0,4:0,5:"Grid Table 5 Dark Accent 4",8:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:10,2:13,0:1},5:{6:0,5:0,4:0,3:10,2:13,0:1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:31,5:[],2:86,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:31,5:[],2:88,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:31,5:[],2:87,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:85,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:89,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:85,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 5 Dark Accent 4"},{1:0,6:0,4:0,5:"Grid Table 6 Colorful Accent 4",8:{1:0,4:36,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:27,0:1},4:{6:0,5:0,4:0,3:10,2:27,0:1},5:{6:0,5:0,4:0,3:10,2:27,0:1},2:{6:0,5:0,4:0,3:10,2:27,0:1},3:{6:0,5:0,4:0,3:10,2:27,0:1},0:{6:0,5:0,4:0,3:10,2:27,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:82,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:90,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 6 Colorful Accent 4"},{1:0,6:0,4:0,5:"Grid Table 7 Colorful Accent 4",8:{1:0,4:36,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:27,0:1},4:{6:0,5:0,4:0,3:10,2:27,0:1},5:{6:0,5:0,4:0,3:10,2:27,0:1},2:{6:0,5:0,4:0,3:10,2:27,0:1},3:{6:0,5:0,4:0,3:10,2:27,0:1},0:{6:0,5:0,4:0,3:10,2:27,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{1:{1:0,4:0,5:[],2:82,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:83,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:83,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2:{1:0,4:0,5:[],2:82,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:79,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 7 Colorful Accent 4"},{1:0,6:0,4:0,5:"Grid Table 1 Light Accent 5",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:29,0:1},4:{6:0,5:0,4:0,3:10,2:29,0:1},5:{6:0,5:0,4:0,3:10,2:29,0:1},2:{6:0,5:0,4:0,3:10,2:29,0:1},3:{6:0,5:0,4:0,3:10,2:29,0:1},0:{6:0,5:0,4:0,3:10,2:29,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:516096}},9:{1024:{1:0,4:4,5:[],2:91,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:92,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 1 Light Accent 5"},{1:0,6:0,4:0,5:"Grid Table 2 Accent 5",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:5,2:30,0:3},5:{6:0,5:0,4:0,3:5,2:30,0:3},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:5,2:30,0:3},0:{6:0,5:0,4:0,3:5,2:30,0:3}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:493056}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:94,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:95,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 2 Accent 5"},{1:0,6:0,4:0,5:"Grid Table 3 Accent 5",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:30,0:1},4:{6:0,5:0,4:0,3:10,2:30,0:1},5:{6:0,5:0,4:0,3:10,2:30,0:1},2:{6:0,5:0,4:0,3:10,2:30,0:1},3:{6:0,5:0,4:0,3:10,2:30,0:1},0:{6:0,5:0,4:0,3:10,2:30,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517120}},9:{256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:97,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:97,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1:{1:0,4:0,5:[],2:96,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 3 Accent 5"},{1:0,6:0,4:0,5:"Grid Table 4 Accent 5",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:30,0:1},4:{6:0,5:0,4:0,3:10,2:30,0:1},5:{6:0,5:0,4:0,3:10,2:30,0:1},2:{6:0,5:0,4:0,3:10,2:30,0:1},3:{6:0,5:0,4:0,3:10,2:30,0:1},0:{6:0,5:0,4:0,3:10,2:30,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:96,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:98,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 4 Accent 5"},{1:0,6:0,4:0,5:"Grid Table 5 Dark Accent 5",8:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:10,2:13,0:1},5:{6:0,5:0,4:0,3:10,2:13,0:1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:31,5:[],2:100,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:31,5:[],2:102,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:31,5:[],2:101,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:99,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:103,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:99,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 5 Dark Accent 5"},{1:0,6:0,4:0,5:"Grid Table 6 Colorful Accent 5",8:{1:0,4:37,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:30,0:1},4:{6:0,5:0,4:0,3:10,2:30,0:1},5:{6:0,5:0,4:0,3:10,2:30,0:1},2:{6:0,5:0,4:0,3:10,2:30,0:1},3:{6:0,5:0,4:0,3:10,2:30,0:1},0:{6:0,5:0,4:0,3:10,2:30,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:96,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:104,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 6 Colorful Accent 5"},{1:0,6:0,4:0,5:"Grid Table 7 Colorful Accent 5",8:{1:0,4:37,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:30,0:1},4:{6:0,5:0,4:0,3:10,2:30,0:1},5:{6:0,5:0,4:0,3:10,2:30,0:1},2:{6:0,5:0,4:0,3:10,2:30,0:1},3:{6:0,5:0,4:0,3:10,2:30,0:1},0:{6:0,5:0,4:0,3:10,2:30,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{1:{1:0,4:0,5:[],2:96,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:97,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:97,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2:{1:0,4:0,5:[],2:96,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:93,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 7 Colorful Accent 5"},{1:0,6:0,4:0,5:"Grid Table 1 Light Accent 6",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:32,0:1},4:{6:0,5:0,4:0,3:10,2:32,0:1},5:{6:0,5:0,4:0,3:10,2:32,0:1},2:{6:0,5:0,4:0,3:10,2:32,0:1},3:{6:0,5:0,4:0,3:10,2:32,0:1},0:{6:0,5:0,4:0,3:10,2:32,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:516096}},9:{1024:{1:0,4:4,5:[],2:105,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:106,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 1 Light Accent 6"},{1:0,6:0,4:0,5:"Grid Table 2 Accent 6",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:5,2:33,0:3},5:{6:0,5:0,4:0,3:5,2:33,0:3},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:5,2:33,0:3},0:{6:0,5:0,4:0,3:5,2:33,0:3}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:493056}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:108,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:109,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 2 Accent 6"},{1:0,6:0,4:0,5:"Grid Table 3 Accent 6",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:33,0:1},4:{6:0,5:0,4:0,3:10,2:33,0:1},5:{6:0,5:0,4:0,3:10,2:33,0:1},2:{6:0,5:0,4:0,3:10,2:33,0:1},3:{6:0,5:0,4:0,3:10,2:33,0:1},0:{6:0,5:0,4:0,3:10,2:33,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517120}},9:{256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:111,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:111,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1:{1:0,4:0,5:[],2:110,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 3 Accent 6"},{1:0,6:0,4:0,5:"Grid Table 4 Accent 6",8:{1:0,4:0,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:33,0:1},4:{6:0,5:0,4:0,3:10,2:33,0:1},5:{6:0,5:0,4:0,3:10,2:33,0:1},2:{6:0,5:0,4:0,3:10,2:33,0:1},3:{6:0,5:0,4:0,3:10,2:33,0:1},0:{6:0,5:0,4:0,3:10,2:33,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:110,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:112,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 4 Accent 6"},{1:0,6:0,4:0,5:"Grid Table 5 Dark Accent 6",8:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:13,0:1},4:{6:0,5:0,4:0,3:10,2:13,0:1},5:{6:0,5:0,4:0,3:10,2:13,0:1},2:{6:0,5:0,4:0,3:10,2:13,0:1},3:{6:0,5:0,4:0,3:10,2:13,0:1},0:{6:0,5:0,4:0,3:10,2:13,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:31,5:[],2:114,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:31,5:[],2:116,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:31,5:[],2:115,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:113,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:31,5:[],2:117,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:113,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 5 Dark Accent 6"},{1:0,6:0,4:0,5:"Grid Table 6 Colorful Accent 6",8:{1:0,4:38,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:33,0:1},4:{6:0,5:0,4:0,3:10,2:33,0:1},5:{6:0,5:0,4:0,3:10,2:33,0:1},2:{6:0,5:0,4:0,3:10,2:33,0:1},3:{6:0,5:0,4:0,3:10,2:33,0:1},0:{6:0,5:0,4:0,3:10,2:33,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{256:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:110,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:4,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:118,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 6 Colorful Accent 6"},{1:0,6:0,4:0,5:"Grid Table 7 Colorful Accent 6",8:{1:0,4:38,5:[],2:0,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:10,2:33,0:1},4:{6:0,5:0,4:0,3:10,2:33,0:1},5:{6:0,5:0,4:0,3:10,2:33,0:1},2:{6:0,5:0,4:0,3:10,2:33,0:1},3:{6:0,5:0,4:0,3:10,2:33,0:1},0:{6:0,5:0,4:0,3:10,2:33,0:1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:517632}},9:{1:{1:0,4:0,5:[],2:110,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},1024:{1:0,4:4,5:[],2:24,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},512:{1:0,4:5,5:[],2:23,3:41,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},4:{1:0,4:0,5:[],2:111,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},8:{1:0,4:0,5:[],2:111,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},128:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2048:{1:0,4:4,5:[],2:25,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},256:{1:0,4:5,5:[],2:22,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},2:{1:0,4:0,5:[],2:110,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}},32:{1:0,4:0,5:[],2:107,3:0,0:{14:0,8:0,9:1,21:1,15:0,2:{0:0,1:0},0:{2:{0:0,1:0},3:{0:0,1:0},0:{0:0,1:0},1:{0:0,1:0}},1:{0:0,1:0},25:0,7:1,12:3,5:1,6:1,23:0,4:{1:{6:0,5:0,4:0,3:0,2:2,0:-1},4:{6:0,5:0,4:0,3:0,2:2,0:-1},5:{6:0,5:0,4:0,3:0,2:2,0:-1},2:{6:0,5:0,4:0,3:0,2:2,0:-1},3:{6:0,5:0,4:0,3:0,2:2,0:-1},0:{6:0,5:0,4:0,3:0,2:2,0:-1}},19:0,17:0,16:0,20:0,18:0,13:0,22:1,24:0}}},2:0,3:"Normal Table",0:"Grid Table 7 Colorful Accent 6"}],1:[{1:0,6:1,4:0,5:"Normal",8:0,9:0,13:[],14:-1,15:0,12:0,2:0,0:"Normal"},{13:[],14:-1,8:11,9:4,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 1",1:0,6:0,12:0,5:"Heading 1",4:0,10:"Heading 1 Char"},{13:[],14:-1,8:13,9:7,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 2",1:0,6:0,12:0,5:"Heading 2",4:0,10:"Heading 2 Char"},{13:[],14:-1,8:15,9:8,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 3",1:0,6:0,12:0,5:"Heading 3",4:1,10:"Heading 3 Char"},{13:[],14:-1,8:17,9:9,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 4",1:0,6:0,12:0,5:"Heading 4",4:1,10:"Heading 4 Char"},{13:[],14:-1,8:16,9:10,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 5",1:0,6:0,12:0,5:"Heading 5",4:1,10:"Heading 5 Char"},{13:[],14:-1,8:14,9:11,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 6",1:0,6:0,12:0,5:"Heading 6",4:1,10:"Heading 6 Char"},{13:[],14:-1,8:18,9:12,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 7",1:0,6:0,12:0,5:"Heading 7",4:1,10:"Heading 7 Char"},{13:[],14:-1,8:20,9:13,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 8",1:0,6:0,12:0,5:"Heading 8",4:1,10:"Heading 8 Char"},{13:[],14:-1,8:21,9:14,15:0,11:"Normal",2:0,3:"Normal",0:"Heading 9",1:0,6:0,12:0,5:"Heading 9",4:1,10:"Heading 9 Char"},{13:[],14:-1,8:0,9:19,15:0,11:"Normal",2:0,3:"Normal",0:"toc 1",1:0,6:0,12:0,5:"toc 1",4:1,10:"toc 1 Char"},{13:[],14:-1,8:0,9:20,15:0,11:"Normal",2:0,3:"Normal",0:"toc 2",1:0,6:0,12:0,5:"toc 2",4:1,10:"toc 2 Char"},{13:[],14:-1,8:0,9:21,15:0,11:"Normal",2:0,3:"Normal",0:"toc 3",1:0,6:0,12:0,5:"toc 3",4:1,10:"toc 3 Char"},{13:[],14:-1,8:0,9:22,15:0,11:"Normal",2:0,3:"Normal",0:"toc 4",1:0,6:0,12:0,5:"toc 4",4:1,10:"toc 4 Char"},{13:[],14:-1,8:0,9:23,15:0,11:"Normal",2:0,3:"Normal",0:"toc 5",1:0,6:0,12:0,5:"toc 5",4:1,10:"toc 5 Char"},{13:[],14:-1,8:0,9:24,15:0,11:"Normal",2:0,3:"Normal",0:"toc 6",1:0,6:0,12:0,5:"toc 6",4:1,10:"toc 6 Char"},{13:[],14:-1,8:0,9:25,15:0,11:"Normal",2:0,3:"Normal",0:"toc 7",1:0,6:0,12:0,5:"toc 7",4:1,10:"toc 7 Char"},{13:[],14:-1,8:0,9:26,15:0,11:"Normal",2:0,3:"Normal",0:"toc 8",1:0,6:0,12:0,5:"toc 8",4:1,10:"toc 8 Char"},{13:[],14:-1,8:0,9:27,15:0,11:"Normal",2:0,3:"Normal",0:"toc 9",1:0,6:0,12:0,5:"toc 9",4:1,10:"toc 9 Char"},{13:[],14:-1,8:22,9:0,15:0,11:"Normal",2:0,3:"Normal",0:"Subtitle",1:0,6:0,12:0,5:"Subtitle",4:0,10:"Subtitle Char"},{13:[],14:-1,8:23,9:29,15:0,11:"Normal",2:0,3:"Normal",0:"Title",1:0,6:0,12:0,5:"Title",4:0,10:"Title Char"},{13:[],14:-1,8:25,9:33,15:0,11:"Normal",2:0,3:"Normal",0:"Quote",1:0,6:0,12:0,5:"Quote",4:0,10:"Quote Char"},{13:[],14:-1,8:26,9:37,15:0,11:"Normal",2:0,3:"Normal",0:"Intense Quote",1:0,6:0,12:0,5:"Intense Quote",4:0,10:"Intense Quote Char"},{1:0,6:0,4:0,5:"No Spacing",8:0,9:39,13:[],14:-1,15:0,12:0,2:0,0:"No Spacing"},{14:-1,8:0,9:40,15:0,2:0,3:"Normal",0:"List Paragraph",1:0,6:0,12:0,5:"List Paragraph",4:0,13:[]}],0:[{1:0,6:1,4:1,5:"Default Paragraph Font",9:0,2:0,0:"Default Paragraph Font"},{1:0,6:0,4:0,5:"Strong",9:4,2:0,3:"Default Paragraph Font",0:"Strong"},{1:0,6:0,4:0,5:"Emphasis",9:5,2:0,3:"Default Paragraph Font",0:"Emphasis"},{1:0,6:0,4:0,5:"Intense Emphasis",9:6,2:0,3:"Default Paragraph Font",0:"Intense Emphasis"},{1:0,6:0,4:0,5:"Subtle Emphasis",9:7,2:0,3:"Default Paragraph Font",0:"Subtle Emphasis"},{1:0,6:0,4:0,5:"Book Title",9:8,2:0,3:"Default Paragraph Font",0:"Book Title"},{1:0,6:0,4:0,5:"Heading 1 Char",8:"Heading 1",9:11,2:0,3:"Default Paragraph Font",0:"Heading 1 Char"},{1:0,6:0,4:0,5:"Heading 2 Char",8:"Heading 2",9:13,2:0,3:"Default Paragraph Font",0:"Heading 2 Char"},{1:0,6:0,4:1,5:"Heading 3 Char",8:"Heading 3",9:15,2:0,3:"Default Paragraph Font",0:"Heading 3 Char"},{1:0,6:0,4:1,5:"Heading 4 Char",8:"Heading 4",9:17,2:0,3:"Default Paragraph Font",0:"Heading 4 Char"},{1:0,6:0,4:1,5:"Heading 5 Char",8:"Heading 5",9:16,2:0,3:"Default Paragraph Font",0:"Heading 5 Char"},{1:0,6:0,4:1,5:"Heading 6 Char",8:"Heading 6",9:14,2:0,3:"Default Paragraph Font",0:"Heading 6 Char"},{1:0,6:0,4:1,5:"Heading 7 Char",8:"Heading 7",9:18,2:0,3:"Default Paragraph Font",0:"Heading 7 Char"},{1:0,6:0,4:1,5:"Heading 8 Char",8:"Heading 8",9:20,2:0,3:"Default Paragraph Font",0:"Heading 8 Char"},{1:0,6:0,4:1,5:"Heading 9 Char",8:"Heading 9",9:21,2:0,3:"Default Paragraph Font",0:"Heading 9 Char"},{1:0,6:0,4:1,5:"toc 1 Char",8:"toc 1",9:0,2:0,3:"Default Paragraph Font",0:"toc 1 Char"},{1:0,6:0,4:1,5:"toc 2 Char",8:"toc 2",9:0,2:0,3:"Default Paragraph Font",0:"toc 2 Char"},{1:0,6:0,4:1,5:"toc 3 Char",8:"toc 3",9:0,2:0,3:"Default Paragraph Font",0:"toc 3 Char"},{1:0,6:0,4:1,5:"toc 4 Char",8:"toc 4",9:0,2:0,3:"Default Paragraph Font",0:"toc 4 Char"},{1:0,6:0,4:1,5:"toc 5 Char",8:"toc 5",9:0,2:0,3:"Default Paragraph Font",0:"toc 5 Char"},{1:0,6:0,4:1,5:"toc 6 Char",8:"toc 6",9:0,2:0,3:"Default Paragraph Font",0:"toc 6 Char"},{1:0,6:0,4:1,5:"toc 7 Char",8:"toc 7",9:0,2:0,3:"Default Paragraph Font",0:"toc 7 Char"},{1:0,6:0,4:1,5:"toc 8 Char",8:"toc 8",9:0,2:0,3:"Default Paragraph Font",0:"toc 8 Char"},{1:0,6:0,4:1,5:"toc 9 Char",8:"toc 9",9:0,2:0,3:"Default Paragraph Font",0:"toc 9 Char"},{1:0,6:0,4:0,5:"Subtitle Char",8:"Subtitle",9:22,2:0,3:"Default Paragraph Font",0:"Subtitle Char"},{1:0,6:0,4:0,5:"Title Char",8:"Title",9:23,2:0,3:"Default Paragraph Font",0:"Title Char"},{1:0,6:0,4:0,5:"Quote Char",8:"Quote",9:25,2:0,3:"Default Paragraph Font",0:"Quote Char"},{1:0,6:0,4:0,5:"Intense Quote Char",8:"Intense Quote",9:26,2:0,3:"Default Paragraph Font",0:"Intense Quote Char"}]};const e=NJ.createPresetStylesLocalizedNames();return kJ.localizeStyles(kJ.localizedDefaultPresetStyles[hs.Character],e),kJ.localizeStyles(kJ.localizedDefaultPresetStyles[hs.Paragraph],e),kJ.localizeStyles(kJ.localizedDefaultPresetStyles[hs.Table],e),kJ.localizedDefaultPresetStyles}static localizeStyles(e,t){f.ListUtils.forEach(e,(e=>{const r=e[ps.StyleName],i=t[r.toLocaleLowerCase()];i&&(e[ps.LocalizedStyleName]=i)}))}}kJ.ruler={titles:{firstLineIndent:"First Line Indent",hangingIndent:"Hanging Indent",leftIndent:"Left Indent",rightIndent:"Right Indent",marginLeft:"Margin Left",marginRight:"Margin Right",tabLeft:"Left Tab",tabRight:"Right Tab",tabCenter:"Center Tab",tabDecimal:"Decimal Title"},styles:{firstLineIndent:{className:"dxreFirstLineIndentDragHandle"},firstLineIndentImage:{spriteCssClass:"dxRichEdit_FirstLineIndentDragHandle"},leftIndent:{className:"dxreLeftIndentDragHandle"},leftIndentImage:{spriteCssClass:"dxRichEdit_LeftIndentDragHandle"},rightIndent:{className:"dxreRightIndentDragHandle"},rightIndentImage:{spriteCssClass:"dxRichEdit_RightIndentDragHandle"},columnSeparatorImage:{spriteCssClass:"dxRichEdit_ColumnSeparatorDragHandle"},tabImages:{left:{spriteCssClass:"dxRichEdit_LeftTabDragHandle"},right:{spriteCssClass:"dxRichEdit_RightTabDragHandle"},center:{spriteCssClass:"dxRichEdit_CenterTabDragHandle"},decimal:{spriteCssClass:"dxRichEdit_DecimalTabDragHandle"}},tab:{className:"dxreTabDragHandle"},line:{className:"dxreRulerLine"},control:{className:"dxreRuler"},wrapper:{className:"dxreRulerWrapper"}},visibility:0,showLeftIndent:!0,showRightIndent:!0,showTabs:!0},kJ.defaultFontsList=[{2:"'Angsana New', serif",3:1,0:"Angsana New",1:.65,4:.14},{2:"Arial, Helvetica, sans-serif",3:1,0:"Arial",1:.65,4:.14},{2:"'Arial Black', Gadget, sans-serif",3:1,0:"Arial Black",1:.65,4:.06},{2:"Batang, 바탕, serif",3:1,0:"Batang",1:.65,4:.14},{2:"'Book Antiqua', serif",3:1,0:"Book Antiqua",1:.65,4:.09},{2:"'Bookman Old Style', serif",3:1,0:"Bookman Old Style",1:.65,4:.08},{2:"Calibri, sans-serif",3:1,0:"Calibri",1:.65,4:.14},{2:"'Calibri Light', 'Microsoft Sans Serif'",3:1,0:"Calibri Light",1:.65,4:.14},{2:"Cambria, serif",3:1,0:"Cambria",1:.65,4:.08},{2:"Candara, sans-serif",3:1,0:"Candara",1:.65,4:.14},{2:"Century, serif",3:1,0:"Century",1:.65,4:.07},{2:"'Century Gothic', sans-serif",3:1,0:"Century Gothic",1:.65,4:.07},{2:"'Century Schoolbook', serif",3:1,0:"Century Schoolbook",1:.65,4:.14},{2:"'Comic Sans MS', fantasy, cursive, sans-serif",3:1,0:"Comic Sans MS",1:.65,4:.14},{2:"Consolas, monospace",3:1,0:"Consolas",1:.65,4:.14},{2:"Constantia, serif",3:1,0:"Constantia",1:.65,4:.14},{2:"Corbel, sans-serif",3:1,0:"Corbel",1:.65,4:.14},{2:"'Cordia New', sans-serif",3:1,0:"Cordia New",1:.65,4:.14},{2:"'Courier New', Courier, monospace",3:1,0:"Courier New",1:.65,4:.14},{2:"DaunPenh, sans-serif",3:1,0:"DaunPenh",1:.65,4:.14},{2:"Dotum, 돋움, sans-serif",3:1,0:"Dotum",1:.65,4:.14},{2:"FangSong, serif",3:1,0:"FangSong",1:.65,4:.14},{2:"'Franklin Gothic Book', sans-serif",3:1,0:"Franklin Gothic Book",1:.65,4:.14},{2:"'Franklin Gothic Medium', sans-serif",3:1,0:"Franklin Gothic Medium",1:.65,4:.14},{2:"Garamond, serif",3:1,0:"Garamond",1:.65,4:.09},{2:"Gautami, sans-serif",3:1,0:"Gautami",1:.65,4:.14},{2:"Georgia, serif",3:1,0:"Georgia",1:.65,4:.08},{2:"'Gill Sans MT', sans-serif",3:1,0:"Gill Sans MT",1:.65,4:.14},{2:"Gulim, 굴림, sans-serif",3:1,0:"Gulim",1:.65,4:.14},{2:"GungSuh, serif",3:1,0:"GungSuh",1:.65,4:.14},{2:"Impact, Charcoal, sans-serif",3:1,0:"Impact",1:.53,4:0},{2:"'Iskoola Pota', sans-serif",3:1,0:"Iskoola Pota",1:.65,4:.14},{2:"KaiTi, sans-serif",3:1,0:"KaiTi",1:.65,4:.14},{2:"Kalinga, sans-serif",3:1,0:"Kalinga",1:.65,4:.14},{2:"Kartika, sans-serif",3:1,0:"Kartika",1:.65,4:.14},{2:"Latha, sans-serif",3:1,0:"Latha",1:.65,4:.14},{2:"'Lucida Console', Monaco, monospace",3:1,0:"Lucida Console",1:.65,4:.08},{2:"'Lucida Sans', sans-serif",3:1,0:"Lucida Sans",1:.65,4:.14},{2:"'Lucida Sans Unicode', 'Lucida Grande', sans-serif",3:1,0:"Lucida Sans Unicode",1:.65,4:.08},{2:"'Malgun Gothic', '맑은 고딕', sans-serif",3:1,0:"Malgun Gothic",1:.65,4:.14},{2:"Mangal, sans-serif",3:1,0:"Mangal",1:.65,4:.14},{2:"Meiryo, メイリオ, sans-serif",3:1,0:"Meiryo",1:.65,4:.14},{2:"'Microsoft JhengHei', 微軟正黑體, sans-serif",3:1,0:"Microsoft JhengHei",1:.65,4:.14},{2:"'Microsoft YaHei', 微软雅黑, sans-serif",3:1,0:"Microsoft YaHei",1:.65,4:.14},{2:"MingLiU, 細明體, serif",3:1,0:"MingLiU",1:.65,4:.14},{2:"MingLiU_HKSCS, 細明體_HKSCS, serif",3:1,0:"MingLiU_HKSCS",1:.65,4:.14},{2:"'MS Gothic', 'ＭＳ ゴシック', sans-serif",3:1,0:"MS Gothic",1:.5,4:.36},{2:"'MS Mincho', 'ＭＳ 明朝', serif",3:1,0:"MS Mincho",1:.65,4:.14},{2:"'MS PGothic', 'ＭＳ Ｐゴシック', sans-serif",3:1,0:"MS PGothic",1:.65,4:.14},{2:"'MS PMincho', 'ＭＳ Ｐ明朝', serif",3:1,0:"MS PMincho",1:.65,4:.14},{2:"Nyala, sans-serif",3:1,0:"Nyala",1:.65,4:.14},{2:"'Palatino Linotype', 'Book Antiqua', Palatino, serif",3:1,0:"Palatino Linotype",1:.6,4:0},{2:"PMingLiU, 新細明體, serif",3:1,0:"PMingLiU",1:.65,4:.14},{2:"PMingLiU-ExtB, 新細明體-ExtB, 新細明體-ExtB, PMingLiU, serif",3:1,0:"PMingLiU-ExtB",1:.5,4:0},{2:"Raavi, sans-serif",3:1,0:"Raavi",1:.65,4:.14},{2:"Rockwell, serif",3:1,0:"Rockwell",1:.65,4:.14},{2:"'Segoe UI', sans-serif",3:1,0:"Segoe UI",1:.65,4:.14},{2:"'Segoe UI Light', sans-serif",3:1,0:"Segoe UI Light",1:.65,4:.14},{2:"Shruti, sans-serif",3:1,0:"Shruti",1:.65,4:.14},{2:"SimHei, 黑体, sans-serif",3:1,0:"SimHei",1:.65,4:.14},{2:"SimSun, 宋体, serif",3:1,0:"SimSun",1:.5,4:.06},{2:"SimSun-ExtB, serif",3:1,0:"SimSun-ExtB",1:.5,4:.06},{2:"Sylfaen, serif",3:1,0:"Sylfaen",1:.6,4:0},{2:"'Symbol', 'Microsoft Sans Serif'",3:1,0:"Symbol",1:.65,4:.14},{2:"Tahoma, Geneva, sans-serif",3:1,0:"Tahoma",1:.65,4:.14},{2:"Times, 'Times New Roman', serif",3:1,0:"Times",1:.65,4:.14},{2:"'Times New Roman', Times, serif",3:1,0:"Times New Roman",1:.65,4:.14},{2:"'Trebuchet MS', Helvetica, sans-serif",3:1,0:"Trebuchet MS",1:.65,4:.14},{2:"Tunga, sans-serif",3:1,0:"Tunga",1:.65,4:.14},{2:"'TW Cen MT', sans-serif",3:1,0:"TW Cen MT",1:.65,4:.14},{2:"Verdana, Geneva, sans-serif",3:1,0:"Verdana",1:.65,4:.14},{2:"Vrinda, sans-serif",3:1,0:"Vrinda",1:.65,4:.14}],function(e){e[e.Button=0]="Button",e[e.SelectBox=1]="SelectBox",e[e.Menu=2]="Menu",e[e.NumberBox=3]="NumberBox",e[e.ColorBox=4]="ColorBox",e[e.SubMenu=5]="SubMenu"}(nJ||(nJ={}));class OJ{constructor(e,t=!1){this.beginGroup=!1,this.id=e,this.beginGroup=t}}!function(e){e[e.File=0]="File",e[e.Home=1]="Home",e[e.Insert=2]="Insert",e[e.PageLayout=3]="PageLayout",e[e.References=4]="References",e[e.MailMerge=5]="MailMerge",e[e.View=6]="View",e[e.HeadersFooters=7]="HeadersFooters",e[e.TableDesign=8]="TableDesign",e[e.TableLayout=9]="TableLayout",e[e.FloatingObjectsFormat=10]="FloatingObjectsFormat"}(oJ||(oJ={}));class _J{get contextTab(){return!1}constructor(e,t,r=[],i){this.id=t,this.items=r,this.title=e,this.localizationId=i}removeItem(e){this.forEachItem(e instanceof OJ?(t,r,i)=>{t==e&&i.items.splice(r,1)}:(t,r,i)=>{t.id==e&&i.items.splice(r,1)},!0)}getItem(e){let t=null;return this.forEachItem((r=>{r.id==e&&(t=r)})),t}insertItem(e,t=this.items.length){return e=e.type==nJ.SubMenu?e.convertToButton():e,this.items.splice(t,0,e),e}insertItemBefore(e,t){return zJ(this,e,t,!0)}insertItemAfter(e,t){return zJ(this,e,t,!1)}forEachItem(e,t=!0){const r=i=>{i.items.forEach(((n,o)=>{e(n,o,i),t&&WJ(n)&&r(n)}))};r(this)}}class UJ extends _J{get contextTab(){return!0}constructor(e,t,r,i,n){super(e,t,i,n),this.category=r}}class HJ{constructor(e,t,r){this.parent=e,this.item=t,this.itemIndex=r}}function VJ(e,t){for(let r,i=0;r=e.items[i];i++){if(t(r))return new HJ(e,r,i);if(WJ(r)){const e=VJ(r,t);if(e)return e}}return null}function WJ(e){return e.type===nJ.SubMenu||e.type===nJ.Menu}function zJ(e,t,r,i){const n=function(e,t){return(0,S.isNumber)(t)||(0,S.isString)(t)?VJ(e,(e=>e.id==t)):VJ(e,(e=>e===t))}(e,r);if(n){const e=t.type==nJ.SubMenu&&n.parent instanceof _J?t.convertToButton():t;n.parent.items.splice(i?n.itemIndex:n.itemIndex+1,0,e)}else t=t.type==nJ.SubMenu?t.convertToButton():t,e.items.push(t);return t}!function(e){e[e.Common=0]="Common",e[e.Picture=1]="Picture",e[e.TextBox=2]="TextBox",e[e.Table=3]="Table",e[e.HeaderFooter=4]="HeaderFooter",e[e.NUMBER=5]="NUMBER"}(aJ||(aJ={}));class jJ{constructor(e,t){this.tabIndex=null,this.initialTabIndex=null,this.setted=!1,this.tabId=e,this.contextTabItemId=t}setInitialTabIndex(e){this.initialTabIndex=e,this.tabIndex=e}}class XJ{constructor(e){this.currCategoryType=aJ.Common,this.ribbonVisible=!1,this.forbidChangeActiveTabIndex=!1,this.barHolder=e,this.categories=[],f.ListUtils.initByCallback(aJ.NUMBER,(e=>this.categories[e]=new jJ(XJ.categoryToInitialTabId[e],XJ.categoryToContextTabItemId[e])))}init(e){this.ribbonVisible=e.visible,this.ribbonVisible&&this.setState(e)}NotifySelectionChanged(e){if(!this.ribbonVisible)return;let t=null;const r=e=>{if(this.currCategoryType!==e){const r=this.categories[this.currCategoryType];r.tabIndex=this.barHolder.ribbon.getActiveTabIndex(),r.tabId=this.apiTabs[r.tabIndex].id,this.currCategoryType=e;const i=this.categories[e];t=null===i.tabIndex?r.tabIndex:i.tabIndex}},i={};let n=!1;for(const t of XJ.selectionOrder){const o=t.check(e),a=this.categories[t.category].contextTabItemId;i[a]||(i[a]=o),!n&&o&&(r(t.category),n=!0)}n||r(aJ.Common),b.j.forEach(i,((e,t)=>this.barHolder.ribbon.setContextItemVisible(t,e))),null===t||this.forbidChangeActiveTabIndex||this.setActiveTab(t)}setActiveTab(e){this.apiTabs[e].contextTab&&(this.barHolder.ribbon.getTabVisible(e)||null==(e=this.categories[this.currCategoryType].initialTabIndex)&&(e=this.categories[aJ.Common].tabIndex)),this.barHolder.ribbon.setActiveTabIndex(e)}setState(e){this.apiTabs=e.tabs;const t=()=>(this.apiTabs.forEach(((e,t)=>{for(const r of this.categories)r.setted||r.tabId==e.id&&(r.setInitialTabIndex(t),r.setted=!0)})),f.ListUtils.allOf(this.categories,(e=>e.setted)));for(const e of this.categories)e.setted=!1,e.setInitialTabIndex(null);if(t())return;if(this.categories.forEach(((e,t)=>{e.setted||(e.tabId=XJ.categoryToInitialTabId[t])})),t())return;const r=this.categories[aJ.Common];r.setted||r.setInitialTabIndex(e.activeTabIndex)}}XJ.categoryToInitialTabId={[aJ.Common]:oJ.Home,[aJ.Picture]:oJ.FloatingObjectsFormat,[aJ.TextBox]:oJ.FloatingObjectsFormat,[aJ.Table]:oJ.TableDesign,[aJ.HeaderFooter]:oJ.HeadersFooters},XJ.categoryToContextTabItemId={[aJ.Common]:null,[aJ.Picture]:FF.ContextItem_FloatingObjects,[aJ.TextBox]:FF.ContextItem_FloatingObjects,[aJ.Table]:FF.ContextItem_Tables,[aJ.HeaderFooter]:FF.ContextItem_HeadersFooters},XJ.selectionOrder=[{category:aJ.Picture,check:e=>e.specialRunInfo.isPictureSelected()},{category:aJ.Table,check:e=>e.tableInfo.isSelected},{category:aJ.TextBox,check:e=>e.specialRunInfo.isTextBoxSelected()},{category:aJ.HeaderFooter,check:e=>e.getState().intervalsInfo.subDocument.isHeaderFooter()}],function(e){e[e.None=0]="None",e[e.FullReset=1]="FullReset",e[e.CheckSelectionChange=2]="CheckSelectionChange",e[e.PartialReset=4]="PartialReset"}(sJ||(sJ={}));class GJ extends Lb.IS{constructor(e){super(),this._raiseUpdate=e,this.selection=null,this.updateEnabled=!0,this._occuredEvents=new pr.Flag(sJ.None)}onUpdateUnlocked(){this.applyEvents()}modelChanged(e){this._occuredEvents.add(this.getModelChangeEvent(e)),this.isUpdateLocked()||this.applyEvents()}NotifySelectionChanged(e){this.selection=e,this.isUpdateLocked()?this._occuredEvents.set(sJ.CheckSelectionChange,!0):(this._occuredEvents.add(this.getSelectionChangeEvent()),this.applyEvents())}forceUpdate(e){this.addCommands(e),this.isUpdateLocked()||this.applyEvents()}getModelChangeEvent(e){switch(e.type){case pd.DifferentOddAndEvenPages:case pd.PageColor:case pd.DefaultTabWidth:case pd.HeaderFooterCreated:case pd.HeaderFooterIndexChanged:return sJ.None;case pd.LoadFontInfo:return sJ.FullReset;case pd.CreateStyleLink:case pd.DeleteStyleLink:case pd.AbstractNumberingListAdded:case pd.AbstractNumberingListDeleted:case pd.NumberingListAdded:case pd.NumberingListDeleted:case pd.ListLevelPropertyChanged:case pd.ListLevelParagraphPropertyChanged:case pd.ListLevelCharacterPropertyChanged:case pd.IOverrideListLevelChanged:case pd.BookmarkCreated:case pd.BookmarkDeleted:case pd.TabInserted:case pd.TabDeleted:case pd.LoadPicturesInfo:case pd.InlinePicturesUpdated:case pd.InlinePictureInserted:case pd.AnchoredPictureInserted:case pd.AnchoredPictureSizeChanged:case pd.InlineObjectRunPropertyChanged:case pd.FieldInserted:case pd.FieldDeleted:case pd.HyperlinkInfoChanged:case pd.FieldsShowCodeChanged:return sJ.None;case pd.SimpleRunInserted:case pd.TextBufferChanged:case pd.ParagraphInserted:case pd.SectionInserted:case pd.AnchoredTextBoxInserted:case pd.AnchorObjectRemoved:case pd.IntervalRemoved:case pd.ParagraphMerged:case pd.SectionMerged:case pd.CharacterFormattingChanged:case pd.CharacterPropertiesChanged:case pd.ParagraphFormattingChanged:case pd.ParagraphPropertiesChanged:case pd.ParagraphAndCharacterMergedPropertiesReset:case pd.SectionFormattingChanged:return sJ.FullReset;case pd.AnchoredTextBoxSizeChanged:case pd.AnchoredTextBoxPropertiesChanged:case pd.AnchorInfoPropertyChanged:case pd.ShapeChanged:case pd.ShapePropertyChanged:return sJ.None;case pd.CharacterStyleApplied:case pd.ParagraphStyleApplied:case pd.TableStyleChanged:case pd.ParagraphNumberingListChanged:case pd.TableCreated:case pd.TableRemoved:case pd.TableStartPositionShifted:case pd.TableCellPropertyChanged:case pd.TablePropertyChanged:case pd.TableRowPropertyChanged:case pd.TableCellSplittedHorizontally:case pd.TableCellMergedHorizontally:case pd.TableRowInserted:case pd.TableRowRemoved:case pd.TableCellRemoved:case pd.TableCellInserted:return sJ.FullReset;default:return sJ.None}}applyEvents(){const e=this._occuredEvents.clone(),t=this.queryCommands;if(this._occuredEvents=new pr.Flag(sJ.None),this.queryCommands=void 0,this.updateEnabled)if(e.get(sJ.CheckSelectionChange)&&e.add(this.getSelectionChangeEvent()),e.get(sJ.FullReset))this.raiseUpdate(null);else if(e.get(sJ.PartialReset)){const e=b.j.toListBy(t,((e,t)=>t));this.raiseUpdate(e.length?e:null)}}raiseUpdate(e){setTimeout((()=>this._raiseUpdate(e)),0)}getSelectionChangeEvent(){const e=new pr.Flag(sJ.None);return(!this.selection||this.selection.shouldResetInputPosition()||this.selection&&this.checkActivateHeaderFooter(this.selection))&&e.set(sJ.FullReset,!0),e.getValue()}checkActivateHeaderFooter(e){return e.prevState.intervalsInfo.subDocument!=e.currState.intervalsInfo.subDocument&&e.currState.intervalsInfo.subDocument.isHeaderFooter()}addCommands(e){e?(this._occuredEvents.set(sJ.PartialReset,!0),this.queryCommands||(this.queryCommands={}),b.j.forEach(e,((e,t)=>this.queryCommands[t]=e))):this._occuredEvents.set(sJ.FullReset,!0)}}class KJ{constructor(e,t,r){this.ribbon=e,this.contextMenu=t,this.publicUiChangesListener=new GJ(r)}initialize(e){var t;null===(t=this.ribbon)||void 0===t||t.initialize(e),this.contextMenu.initialize(e)}updateItemsState(e){var t;null===(t=this.ribbon)||void 0===t||t.updateItemsState(e),this.contextMenu.updateItemsState(e),this.publicUiChangesListener.forceUpdate(e)}setEnabled(e){}removeRibbonBar(){var e;null===(e=this.ribbon)||void 0===e||e.dispose(),this.ribbon=null}dispose(){var e;this.contextMenu.dispose(),null===(e=this.ribbon)||void 0===e||e.dispose()}forceUpdate(e){var t;null===(t=this.ribbon)||void 0===t||t.forceUpdate(e),this.contextMenu.forceUpdate(e),this.horizontalRuler.forceUpdate(e),this.publicUiChangesListener.forceUpdate(e)}enableUpdate(e){this.ribbon&&(this.ribbon.updateEnabled=e),this.contextMenu.updateEnabled=e,this.horizontalRuler.updateEnabled=e,this.publicUiChangesListener.updateEnabled=e}}var qJ,$J,JJ,YJ,QJ,ZJ,eY,tY,rY,iY,nY,oY,aY,sY,lY,dY=DevExpress.ui.dxContextMenu,cY=__webpack_require__.n(dY);class hY extends Lb.IS{get isInitialized(){return!!this.core}constructor(e){super(),this.updateEnabled=!0,this.owner=e}initialize(e){this.core=e}updateItemsState(e){if(this.isInitialized&&!this.isUpdateLocked())if(void 0===e){for(const e of this.getCommandKeys())this.updateBarItem(e);for(const e of this.getContextKeys())this.updateContextItem(e)}else{for(const t of this.getCommandKeys())void 0!==e[t]&&this.updateBarItem(t);for(const t of this.getContextKeys())void 0!==e[t]&&this.updateContextItem(t)}}updateBarItem(e){const t=e,r=this.core.commandManager.getCommand(t);if(r){const i=r.getState();if(this.setItemVisible(t,i.visible),i.visible&&(this.setItemEnabled(e,i.enabled),!i.denyUpdateValue)){const e=this.getItemValue(i);i.items&&this.setItemSubItems(t,i.items),this.setItemValue(t,e)}}else this.setItemEnabled(e,this.core.commandManager.commandIsEnabled(e))}raiseBarCommandExecuted(e,t){const r=parseInt(e);if(isNaN(r)||void 0===FF[r])this.owner.raiseCustomCommandExecuted(e,t);else{this.core.commandManager.getCommand(r).execute(this.core.commandManager.isPublicApiCall,t)||this.updateItemsState({[r]:!0})}this.owner.Focus()}setItemSubItems(e,t){}setItemValue(e,t){}getContextKeys(){return[]}updateContextItem(e){}getItemValue(e){if((0,S.isDefined)(e.checked))return e.checked;const t=e.value;return t instanceof En?t.name:t}}!function(e){e[e.None=0]="None",e[e.FullReset=1]="FullReset",e[e.CheckSelectionChange=2]="CheckSelectionChange"}(qJ||(qJ={}));class uY extends hY{constructor(){super(...arguments),this.selection=null,this.isSpellingMenu=!1}forceUpdate(e){this.isUpdateLocked()?this.registerOccurredEvent(qJ.FullReset):this.updateItemsState(e)}getSuggestions(){let e;if(this.core.spellChecker.settings.isEnabled){const t=this.core.spellChecker.getSelectedMisspelledInterval(this.core.selection.intervals);t&&(e=t.errorInfo.suggestions)}return e}onUpdateUnlocked(e){this.applyEvent(e)}modelChanged(e){const t=this.getModelChangeEvent(e);this.isUpdateLocked()?this.registerOccurredEvent(t):this.applyEvent(t)}NotifySelectionChanged(e){this.selection=e,this.isUpdateLocked()?this.registerOccurredEvent(qJ.CheckSelectionChange):this.applyEvent(this.getSelectionChangeEvent())}applyEvent(e){if(!this.updateEnabled)return;const t=new pr.Flag(e);t.get(qJ.CheckSelectionChange)&&t.add(this.getSelectionChangeEvent()),t.get(qJ.FullReset)&&this.updateItemsState()}getSelectionChangeEvent(){return this.selection&&!this.selection.shouldResetInputPosition()?qJ.None:qJ.FullReset}getModelChangeEvent(e){switch(e.type){case pd.DifferentOddAndEvenPages:case pd.PageColor:case pd.DefaultTabWidth:case pd.HeaderFooterCreated:case pd.HeaderFooterIndexChanged:case pd.LoadFontInfo:case pd.SectionFormattingChanged:case pd.CreateStyleLink:case pd.DeleteStyleLink:case pd.AbstractNumberingListAdded:case pd.AbstractNumberingListDeleted:case pd.NumberingListAdded:case pd.NumberingListDeleted:case pd.ListLevelPropertyChanged:case pd.ListLevelParagraphPropertyChanged:case pd.ListLevelCharacterPropertyChanged:case pd.IOverrideListLevelChanged:case pd.BookmarkCreated:case pd.BookmarkDeleted:case pd.TabInserted:case pd.TabDeleted:case pd.LoadPicturesInfo:case pd.InlinePicturesUpdated:case pd.InlinePictureInserted:case pd.AnchoredPictureInserted:case pd.AnchoredPictureSizeChanged:case pd.InlineObjectRunPropertyChanged:case pd.FieldInserted:case pd.FieldDeleted:case pd.HyperlinkInfoChanged:case pd.FieldsShowCodeChanged:case pd.SimpleRunInserted:case pd.TextBufferChanged:case pd.ParagraphInserted:case pd.SectionInserted:case pd.AnchoredTextBoxInserted:case pd.AnchorObjectRemoved:case pd.IntervalRemoved:case pd.ParagraphMerged:case pd.SectionMerged:case pd.CharacterFormattingChanged:case pd.CharacterPropertiesChanged:case pd.ParagraphFormattingChanged:case pd.ParagraphPropertiesChanged:case pd.ParagraphAndCharacterMergedPropertiesReset:case pd.AnchoredTextBoxSizeChanged:case pd.AnchoredTextBoxPropertiesChanged:case pd.AnchorInfoPropertyChanged:case pd.ShapeChanged:case pd.ShapePropertyChanged:case pd.CharacterStyleApplied:case pd.ParagraphStyleApplied:case pd.TableStyleChanged:case pd.ParagraphNumberingListChanged:case pd.TableCreated:case pd.TableRemoved:case pd.TableStartPositionShifted:case pd.TableCellPropertyChanged:case pd.TablePropertyChanged:case pd.TableRowPropertyChanged:case pd.TableCellSplittedHorizontally:case pd.TableCellMergedHorizontally:case pd.TableRowInserted:case pd.TableRowRemoved:case pd.TableCellRemoved:case pd.TableCellInserted:}return qJ.None}}class pY{static correctIconName(e){return 0==e.indexOf("dx")?` ${e}`:e}static correctItemsIcons(e){e&&e.forEach((e=>{e.icon=e.icon?pY.correctIconName(e.icon):void 0,pY.correctItemsIcons(e.items)}))}}!function(e){e[e.CreateDocument=412]="CreateDocument",e[e.OpenDocument=410]="OpenDocument",e[e.ExportDocument=413]="ExportDocument",e[e.DownloadDocumentMenu=414]="DownloadDocumentMenu",e[e.DownloadDocx=418]="DownloadDocx",e[e.DownloadRtf=419]="DownloadRtf",e[e.DownloadTxt=420]="DownloadTxt",e[e.DownloadHtml=421]="DownloadHtml",e[e.PrintDocument=416]="PrintDocument"}($J||($J={})),function(e){e[e.ChangeCaseMenu=431]="ChangeCaseMenu",e[e.AlignParagraphMenu=432]="AlignParagraphMenu",e[e.LineSpacingMenu=433]="LineSpacingMenu",e[e.Undo=6]="Undo",e[e.Redo=7]="Redo",e[e.Cut=10]="Cut",e[e.Copy=9]="Copy",e[e.Paste=8]="Paste",e[e.ChangeFontName=11]="ChangeFontName",e[e.ChangeFontSize=13]="ChangeFontSize",e[e.IncreaseFontSize=14]="IncreaseFontSize",e[e.DecreaseFontSize=15]="DecreaseFontSize",e[e.ChangeFontForeColor=28]="ChangeFontForeColor",e[e.ShowFontDialog=52]="ShowFontDialog",e[e.ToggleFontBold=20]="ToggleFontBold",e[e.ToggleFontItalic=21]="ToggleFontItalic",e[e.ToggleFontUnderline=22]="ToggleFontUnderline",e[e.ToggleFontStrikeout=24]="ToggleFontStrikeout",e[e.ToggleFontSubscript=27]="ToggleFontSubscript",e[e.ToggleFontSuperscript=26]="ToggleFontSuperscript",e[e.CapitalizationSentenceCase=207]="CapitalizationSentenceCase",e[e.CapitalizationUpperCase=16]="CapitalizationUpperCase",e[e.CapitalizationLowerCase=17]="CapitalizationLowerCase",e[e.CapitalizeEachWordCase=18]="CapitalizeEachWordCase",e[e.CapitalizationToggleCase=19]="CapitalizationToggleCase",e[e.ClearFormatting=30]="ClearFormatting",e[e.ToggleBulletedList=31]="ToggleBulletedList",e[e.ToggleNumberedList=32]="ToggleNumberedList",e[e.ToggleMultilevelList=33]="ToggleMultilevelList",e[e.ToggleParagraphAlignmentLeft=37]="ToggleParagraphAlignmentLeft",e[e.ToggleParagraphAlignmentCenter=38]="ToggleParagraphAlignmentCenter",e[e.ToggleParagraphAlignmentRight=39]="ToggleParagraphAlignmentRight",e[e.ToggleParagraphAlignmentJustify=40]="ToggleParagraphAlignmentJustify",e[e.ToggleShowHiddenSymbols=36]="ToggleShowHiddenSymbols",e[e.SetSingleParagraphSpacing=41]="SetSingleParagraphSpacing",e[e.SetSesquialteralParagraphSpacing=42]="SetSesquialteralParagraphSpacing",e[e.SetDoubleParagraphSpacing=43]="SetDoubleParagraphSpacing",e[e.AddSpacingBeforeParagraph=45]="AddSpacingBeforeParagraph",e[e.AddSpacingAfterParagraph=46]="AddSpacingAfterParagraph",e[e.RemoveSpacingBeforeParagraph=47]="RemoveSpacingBeforeParagraph",e[e.RemoveSpacingAfterParagraph=48]="RemoveSpacingAfterParagraph",e[e.ChangeShading=49]="ChangeShading",e[e.ChangeStyle=12]="ChangeStyle",e[e.Find=50]="Find",e[e.Replace=51]="Replace",e[e.ChangeFontHighlightColor=29]="ChangeFontHighlightColor",e[e.ToggleFontDoubleUnderline=23]="ToggleFontDoubleUnderline"}(JJ||(JJ={})),function(e){e[e.ShowInsertTableDialog=55]="ShowInsertTableDialog",e[e.InsertPicture=411]="InsertPicture",e[e.ShowBookmarkDialog=58]="ShowBookmarkDialog",e[e.ShowHyperlinkDialog=59]="ShowHyperlinkDialog",e[e.InsertHeader=220]="InsertHeader",e[e.InsertFooter=221]="InsertFooter",e[e.InsertPageNumberField=235]="InsertPageNumberField",e[e.InsertPageCountField=236]="InsertPageCountField",e[e.InsertFloatingTextBox=368]="InsertFloatingTextBox"}(YJ||(YJ={})),function(e){e[e.MarginsMenu=434]="MarginsMenu",e[e.OrientationMenu=435]="OrientationMenu",e[e.SizeMenu=436]="SizeMenu",e[e.ColumnsMenu=437]="ColumnsMenu",e[e.BreaksMenu=438]="BreaksMenu",e[e.SetSectionNormalPageMargins=66]="SetSectionNormalPageMargins",e[e.SetSectionNarrowPageMargins=67]="SetSectionNarrowPageMargins",e[e.SetSectionModeratePageMargins=68]="SetSectionModeratePageMargins",e[e.SetSectionWidePageMargins=69]="SetSectionWidePageMargins",e[e.ShowMarginsPageSetupDialog=70]="ShowMarginsPageSetupDialog",e[e.SetPortraitPageOrientation=71]="SetPortraitPageOrientation",e[e.SetLandscapePageOrientation=72]="SetLandscapePageOrientation",e[e.SetSectionLetterPaperSize=162]="SetSectionLetterPaperSize",e[e.SetSectionLegalPaperSize=99]="SetSectionLegalPaperSize",e[e.SetSectionFolioPaperSize=100]="SetSectionFolioPaperSize",e[e.SetSectionA4PaperSize=101]="SetSectionA4PaperSize",e[e.SetSectionB5PaperSize=104]="SetSectionB5PaperSize",e[e.SetSectionExecutivePaperSize=105]="SetSectionExecutivePaperSize",e[e.SetSectionA5PaperSize=102]="SetSectionA5PaperSize",e[e.SetSectionA6PaperSize=103]="SetSectionA6PaperSize",e[e.ShowPageSetupDialog=73]="ShowPageSetupDialog",e[e.SetSectionOneColumn=74]="SetSectionOneColumn",e[e.SetSectionTwoColumns=75]="SetSectionTwoColumns",e[e.SetSectionThreeColumns=76]="SetSectionThreeColumns",e[e.InsertPageBreak=54]="InsertPageBreak",e[e.InsertColumnBreak=79]="InsertColumnBreak",e[e.InsertSectionBreakNextPage=80]="InsertSectionBreakNextPage",e[e.InsertSectionBreakEvenPage=81]="InsertSectionBreakEvenPage",e[e.InsertSectionBreakOddPage=82]="InsertSectionBreakOddPage",e[e.ChangePageColor=90]="ChangePageColor"}(QJ||(QJ={})),function(e){e[e.AddTextMenu=439]="AddTextMenu",e[e.InsertCaptionMenu=440]="InsertCaptionMenu",e[e.InsertTableOfFiguresMenu=441]="InsertTableOfFiguresMenu",e[e.InsertTableOfContents=377]="InsertTableOfContents",e[e.SetParagraphBodyTextLevel=385]="SetParagraphBodyTextLevel",e[e.SetParagraphHeading1Level=386]="SetParagraphHeading1Level",e[e.SetParagraphHeading2Level=387]="SetParagraphHeading2Level",e[e.SetParagraphHeading3Level=388]="SetParagraphHeading3Level",e[e.SetParagraphHeading4Level=389]="SetParagraphHeading4Level",e[e.SetParagraphHeading5Level=390]="SetParagraphHeading5Level",e[e.SetParagraphHeading6Level=391]="SetParagraphHeading6Level",e[e.SetParagraphHeading7Level=392]="SetParagraphHeading7Level",e[e.SetParagraphHeading8Level=393]="SetParagraphHeading8Level",e[e.SetParagraphHeading9Level=394]="SetParagraphHeading9Level",e[e.CreateFigureCaptionField=382]="CreateFigureCaptionField",e[e.CreateTableCaptionField=383]="CreateTableCaptionField",e[e.CreateEquationCaptionField=381]="CreateEquationCaptionField",e[e.CreateTableOfFiguresField=379]="CreateTableOfFiguresField",e[e.CreateTableOfTablesField=380]="CreateTableOfTablesField",e[e.CreateTableOfEquationsField=378]="CreateTableOfEquationsField",e[e.UpdateTableOfContents=384]="UpdateTableOfContents"}(ZJ||(ZJ={})),function(e){e[e.CreateFieldMenu=442]="CreateFieldMenu",e[e.CreateField=178]="CreateField",e[e.CreateDateField=203]="CreateDateField",e[e.CreateTimeField=204]="CreateTimeField",e[e.CreatePageField=205]="CreatePageField",e[e.CreateNumPagesField=236]="CreateNumPagesField",e[e.CreateEmptyMergeField=372]="CreateEmptyMergeField",e[e.CreateEmptyDocVariableField=373]="CreateEmptyDocVariableField",e[e.CreateEmptyIfField=459]="CreateEmptyIfField",e[e.ShowInsertMergeFieldDialog=214]="ShowInsertMergeFieldDialog",e[e.ToggleViewMergedData=213]="ToggleViewMergedData",e[e.ShowAllFieldCodes=186]="ShowAllFieldCodes",e[e.ShowAllFieldResults=187]="ShowAllFieldResults",e[e.UpdateAllFields=200]="UpdateAllFields",e[e.GoToFirstDataRecord=209]="GoToFirstDataRecord",e[e.GoToPreviousDataRecord=210]="GoToPreviousDataRecord",e[e.GoToNextDataRecord=211]="GoToNextDataRecord",e[e.GoToLastDataRecord=212]="GoToLastDataRecord",e[e.ShowMailMergeDialog=216]="ShowMailMergeDialog"}(eY||(eY={})),function(e){e[e.SwitchToSimpleView=405]="SwitchToSimpleView",e[e.SwitchToPrintLayout=406]="SwitchToPrintLayout",e[e.ToggleShowHorizontalRuler=94]="ToggleShowHorizontalRuler",e[e.ToggleFullScreen=98]="ToggleFullScreen"}(tY||(tY={})),function(e){e[e.GoToPageHeader=227]="GoToPageHeader",e[e.GoToPageFooter=228]="GoToPageFooter",e[e.GoToPreviousPageHeaderFooter=230]="GoToPreviousPageHeaderFooter",e[e.GoToNextPageHeaderFooter=229]="GoToNextPageHeaderFooter",e[e.LinkHeaderFooterToPrevious=222]="LinkHeaderFooterToPrevious",e[e.ToggleDifferentFirstPage=231]="ToggleDifferentFirstPage",e[e.ToggleDifferentOddAndEvenPages=232]="ToggleDifferentOddAndEvenPages",e[e.ChangeHeaderOffset=330]="ChangeHeaderOffset",e[e.ChangeFooterOffset=331]="ChangeFooterOffset",e[e.CloseHeaderFooter=233]="CloseHeaderFooter"}(rY||(rY={})),function(e){e[e.TableStyleOptionsMenu=443]="TableStyleOptionsMenu",e[e.BordersMenu=444]="BordersMenu",e[e.ToggleFirstRow=280]="ToggleFirstRow",e[e.ToggleLastRow=281]="ToggleLastRow",e[e.ToggleBandedRows=284]="ToggleBandedRows",e[e.ToggleFirstColumn=282]="ToggleFirstColumn",e[e.ToggleLastColumn=283]="ToggleLastColumn",e[e.ToggleBandedColumn=285]="ToggleBandedColumn",e[e.ChangeTableStyle=269]="ChangeTableStyle",e[e.ChangeTableRepositoryItemBorderStyle=292]="ChangeTableRepositoryItemBorderStyle",e[e.ChangeTableRepositoryItemBorderWidth=291]="ChangeTableRepositoryItemBorderWidth",e[e.ChangeTableRepositoryItemBorderColor=290]="ChangeTableRepositoryItemBorderColor",e[e.ToggleTableCellsBottomBorder=272]="ToggleTableCellsBottomBorder",e[e.ToggleTableCellsTopBorder=270]="ToggleTableCellsTopBorder",e[e.ToggleTableCellsLeftBorder=273]="ToggleTableCellsLeftBorder",e[e.ToggleTableCellsRightBorder=271]="ToggleTableCellsRightBorder",e[e.ToggleTableCellNoBorder=274]="ToggleTableCellNoBorder",e[e.ToggleTableCellAllBorders=275]="ToggleTableCellAllBorders",e[e.ToggleTableCellOutsideBorders=279]="ToggleTableCellOutsideBorders",e[e.ToggleTableCellInsideBorders=276]="ToggleTableCellInsideBorders",e[e.ToggleTableCellInsideHorizontalBorders=277]="ToggleTableCellInsideHorizontalBorders",e[e.ToggleTableCellInsideVerticalBorders=278]="ToggleTableCellInsideVerticalBorders",e[e.ToggleTableViewGridlines=295]="ToggleTableViewGridlines",e[e.ChangeTableCellShading=294]="ChangeTableCellShading"}(iY||(iY={})),function(e){e[e.SelectMenu=445]="SelectMenu",e[e.DeleteMenu=446]="DeleteMenu",e[e.InsertMenu=447]="InsertMenu",e[e.AutoFitMenu=448]="AutoFitMenu",e[e.AlignmentMenu=449]="AlignmentMenu",e[e.SelectTableCell=286]="SelectTableCell",e[e.SelectTableColumn=287]="SelectTableColumn",e[e.SelectTableRow=288]="SelectTableRow",e[e.SelectTable=289]="SelectTable",e[e.ToggleShowTableGridLines=295]="ToggleShowTableGridLines",e[e.ShowDeleteCellsDialog=253]="ShowDeleteCellsDialog",e[e.DeleteTableColumns=248]="DeleteTableColumns",e[e.DeleteTableRows=247]="DeleteTableRows",e[e.DeleteTable=251]="DeleteTable",e[e.InsertTableRowAbove=246]="InsertTableRowAbove",e[e.InsertTableRowBelow=245]="InsertTableRowBelow",e[e.InsertTableColumnToTheLeft=243]="InsertTableColumnToTheLeft",e[e.InsertTableColumnToTheRight=244]="InsertTableColumnToTheRight",e[e.MergeTableCells=254]="MergeTableCells",e[e.ShowSplitCellsDialog=255]="ShowSplitCellsDialog",e[e.SetAutoFitContents=399]="SetAutoFitContents",e[e.SetAutoFitWindow=400]="SetAutoFitWindow",e[e.SetFixedColumnWidth=401]="SetFixedColumnWidth",e[e.TableCellAlignTopLeft=260]="TableCellAlignTopLeft",e[e.TableCellAlignTopCenter=261]="TableCellAlignTopCenter",e[e.TableCellAlignTopRight=262]="TableCellAlignTopRight",e[e.TableCellAlignMiddleLeft=263]="TableCellAlignMiddleLeft",e[e.TableCellAlignMiddleCenter=264]="TableCellAlignMiddleCenter",e[e.TableCellAlignMiddleRight=265]="TableCellAlignMiddleRight",e[e.TableCellAlignBottomLeft=266]="TableCellAlignBottomLeft",e[e.TableCellAlignBottomCenter=267]="TableCellAlignBottomCenter",e[e.TableCellAlignBottomRight=268]="TableCellAlignBottomRight"}(nY||(nY={})),function(e){e[e.WrapTextMenu=450]="WrapTextMenu",e[e.PositionMenu=451]="PositionMenu",e[e.BringToFrontMenu=452]="BringToFrontMenu",e[e.SendToBackMenu=453]="SendToBackMenu",e[e.ChangeFloatingObjectFillColor=343]="ChangeFloatingObjectFillColor",e[e.ChangeFloatingObjectOutlineColor=344]="ChangeFloatingObjectOutlineColor",e[e.ChangeFloatingObjectOutlineWidth=345]="ChangeFloatingObjectOutlineWidth",e[e.SetFloatingObjectInlineTextWrapType=374]="SetFloatingObjectInlineTextWrapType",e[e.SetFloatingObjectSquareTextWrapType=346]="SetFloatingObjectSquareTextWrapType",e[e.SetFloatingObjectTightTextWrapType=347]="SetFloatingObjectTightTextWrapType",e[e.SetFloatingObjectThroughTextWrapType=348]="SetFloatingObjectThroughTextWrapType",e[e.SetFloatingObjectTopAndBottomTextWrapType=349]="SetFloatingObjectTopAndBottomTextWrapType",e[e.SetFloatingObjectBehindTextWrapType=350]="SetFloatingObjectBehindTextWrapType",e[e.SetFloatingObjectInFrontOfTextWrapType=351]="SetFloatingObjectInFrontOfTextWrapType",e[e.SetFloatingObjectTopLeftAlignment=352]="SetFloatingObjectTopLeftAlignment",e[e.SetFloatingObjectTopCenterAlignment=353]="SetFloatingObjectTopCenterAlignment",e[e.SetFloatingObjectTopRightAlignment=354]="SetFloatingObjectTopRightAlignment",e[e.SetFloatingObjectMiddleLeftAlignment=355]="SetFloatingObjectMiddleLeftAlignment",e[e.SetFloatingObjectMiddleCenterAlignment=356]="SetFloatingObjectMiddleCenterAlignment",e[e.SetFloatingObjectMiddleRightAlignment=357]="SetFloatingObjectMiddleRightAlignment",e[e.SetFloatingObjectBottomLeftAlignment=358]="SetFloatingObjectBottomLeftAlignment",e[e.SetFloatingObjectBottomCenterAlignment=359]="SetFloatingObjectBottomCenterAlignment",e[e.SetFloatingObjectBottomRightAlignment=360]="SetFloatingObjectBottomRightAlignment",e[e.FloatingObjectBringForward=361]="FloatingObjectBringForward",e[e.FloatingObjectBringToFront=362]="FloatingObjectBringToFront",e[e.FloatingObjectBringInFrontOfText=363]="FloatingObjectBringInFrontOfText",e[e.FloatingObjectSendBackward=364]="FloatingObjectSendBackward",e[e.FloatingObjectSendToBack=365]="FloatingObjectSendToBack",e[e.FloatingObjectSendBehindText=366]="FloatingObjectSendBehindText"}(oY||(oY={})),function(e){e[e.ApplySpellingSuggestion=318]="ApplySpellingSuggestion",e[e.NoSpellingSuggestions=457]="NoSpellingSuggestions",e[e.IgnoreSpellingError=314]="IgnoreSpellingError",e[e.IgnoreAllSpellingErrors=315]="IgnoreAllSpellingErrors",e[e.AddWordToDictionary=317]="AddWordToDictionary",e[e.OpenHyperlink=195]="OpenHyperlink",e[e.ShowEditHyperlinkDialog=194]="ShowEditHyperlinkDialog",e[e.RemoveHyperlink=196]="RemoveHyperlink",e[e.UpdateField=179]="UpdateField",e[e.ToggleFieldCodes=180]="ToggleFieldCodes",e[e.RestartNumberedList=170]="RestartNumberedList",e[e.ContinueNumberedList=189]="ContinueNumberedList",e[e.Cut=10]="Cut",e[e.Copy=9]="Copy",e[e.Paste=8]="Paste",e[e.TableMenu=239]="TableMenu",e[e.InsertTableColumnToTheLeft=243]="InsertTableColumnToTheLeft",e[e.InsertTableColumnToTheRight=244]="InsertTableColumnToTheRight",e[e.InsertTableRowAbove=246]="InsertTableRowAbove",e[e.InsertTableRowBelow=245]="InsertTableRowBelow",e[e.ShowInsertTableCellsDialog=252]="ShowInsertTableCellsDialog",e[e.ShowDeleteTableCellsDialog=253]="ShowDeleteTableCellsDialog",e[e.ShowSplitCellsDialog=255]="ShowSplitCellsDialog",e[e.MergeTableCells=254]="MergeTableCells",e[e.DecreaseParagraphIndent=34]="DecreaseParagraphIndent",e[e.IncreaseParagraphIndent=35]="IncreaseParagraphIndent",e[e.ShowFontDialog=52]="ShowFontDialog",e[e.ShowParagraphDialog=53]="ShowParagraphDialog",e[e.ShowBookmarkDialog=58]="ShowBookmarkDialog",e[e.ShowHyperlinkDialog=59]="ShowHyperlinkDialog",e[e.ChangeFloatingObjectTextWrapTypeMenu=454]="ChangeFloatingObjectTextWrapTypeMenu",e[e.SetFloatingObjectInlineTextWrapType=374]="SetFloatingObjectInlineTextWrapType",e[e.SetFloatingObjectSquareTextWrapType=346]="SetFloatingObjectSquareTextWrapType",e[e.SetFloatingObjectTightTextWrapType=347]="SetFloatingObjectTightTextWrapType",e[e.SetFloatingObjectThroughTextWrapType=348]="SetFloatingObjectThroughTextWrapType",e[e.SetFloatingObjectTopAndBottomTextWrapType=349]="SetFloatingObjectTopAndBottomTextWrapType",e[e.SetFloatingObjectBehindTextWrapType=350]="SetFloatingObjectBehindTextWrapType",e[e.SetFloatingObjectInFrontOfTextWrapType=351]="SetFloatingObjectInFrontOfTextWrapType",e[e.FloatingObjectBringForwardMenu=455]="FloatingObjectBringForwardMenu",e[e.FloatingObjectBringForward=361]="FloatingObjectBringForward",e[e.FloatingObjectBringToFront=362]="FloatingObjectBringToFront",e[e.FloatingObjectBringInFrontOfText=363]="FloatingObjectBringInFrontOfText",e[e.FloatingObjectSendBackwardMenu=456]="FloatingObjectSendBackwardMenu",e[e.FloatingObjectSendBackward=364]="FloatingObjectSendBackward",e[e.FloatingObjectSendToBack=365]="FloatingObjectSendToBack",e[e.FloatingObjectSendBehindText=366]="FloatingObjectSendBehindText",e[e.SelectAll=106]="SelectAll"}(aY||(aY={}));class gY{constructor(e,t){var r,i,n;this.id=e,this.localizationId=t.localizationId,this.text=t.text?t.text:this.localizationId?(0,OV.formatMessage)(this.localizationId):"",this.icon=t.icon,this.items=t.items,this.beginGroup=null!==(r=t.beginGroup)&&void 0!==r&&r,this.disabled=null!==(i=t.disabled)&&void 0!==i&&i,this.visible=null===(n=t.visible)||void 0===n||n}}function mY(e,t){return(0,S.isNumber)(t)||(0,S.isString)(t)?(0,yd.Fw)(e,(e=>e.id===t)):(0,yd.Fw)(e,(e=>e===t))}function fY(e,t){const r=mY(e,t);return null===r?null:r.parentList.splice(r.itemIndex,1)[0]}function bY(e,t){const r=(0,yd.Fw)(e,(e=>e.id===t));return null===r?null:r.item}function CY(e,t,r){const i=mY(e,r);i?i.parentList.splice(i.itemIndex,0,t):e.push(t)}function SY(e,t,r){const i=mY(e,r);i?i.parentList.splice(i.itemIndex+1,0,t):e.push(t)}class IY{get enabled(){return this._native.contextMenuSettings.enabled}set enabled(e){this._native.contextMenuSettings.enabled=e}get items(){return this._native.barHolder.contextMenu.initialItems}constructor(e){this._native=e}getItem(e){return bY(this.items,e)}removeItem(e){return fY(this.items,e)}insertItem(e,t=this.items.length){return this.items.splice(t,0,e),e}insertItemBefore(e,t){return CY(this.items,e,t),e}insertItemAfter(e,t){return SY(this.items,e,t),e}}class PY{get items(){return this._items?this._items:this._items=this._getItems()}set items(e){this._items=e}constructor(e=!0,t=()=>gQ.getInitialItems()){this.enabled=e,this._getItems=t}getItem(e){return bY(this.items,e)}removeItem(e){return fY(this.items,e)}insertItem(e,t=this.items.length){return this.items.splice(t,0,e),e}insertItemBefore(e,t){return CY(this.items,e,t),e}insertItemAfter(e,t){return SY(this.items,e,t),e}}class wY{constructor(){this._handlerInfoList=[]}addHandler(e,t){this.removeHandler(e,t);const r=new yY(e,t);this._handlerInfoList.push(r)}removeHandler(e,t){for(let r=this._handlerInfoList.length-1;r>=0;r--){const i=this._handlerInfoList[r];i.handler!=e||(i.executionContext||t)&&i.executionContext!=t||this._handlerInfoList.splice(r,1)}}clearHandlers(){this._handlerInfoList=[]}_fireEvent(e,t){for(let r,i=0;r=this._handlerInfoList[i];i++)r.handler.call(r.executionContext,e,t)}isEmpty(){return 0==this._handlerInfoList.length}}class yY{constructor(e,t){this.handler=e,this.executionContext=t}}class xY extends wY{}class TY extends xY{}class vY extends xY{}class MY extends xY{}class EY extends xY{}class DY extends xY{}class FY extends xY{}class RY extends xY{}class LY extends xY{}class BY extends xY{}class AY extends xY{}class NY extends xY{}class kY extends xY{}class OY extends xY{}class _Y extends xY{}class UY extends xY{}class HY extends xY{}class VY extends xY{}class WY extends xY{}class zY extends xY{}class jY extends xY{}class XY extends xY{}class GY extends xY{}class KY extends xY{}class qY extends xY{}class $Y extends xY{}class JY extends xY{}class YY extends xY{}class QY extends qU{constructor(e,t,r,i,n){super(),this.handled=t,this.htmlEvent=e,this.hyperlinkType=i,this.targetUri=r,this.hyperlink=n}}class ZY extends qU{constructor(e){super(),this.handled=!1,this.htmlEvent=e}}class eQ extends qU{constructor(e){super(),this.handled=!1,this.htmlEvent=e}}class tQ extends qU{constructor(e,t){super(),this.subDocumentId=e,this.interval=t}}class rQ extends tQ{constructor(e,t,r){super(e,t),this.removedText=r}}class iQ extends qU{constructor(e,t){super(),this.subDocumentId=e,this.paragraphIndex=t}}class nQ extends qU{constructor(e,t){super(),this.handled=!1,this.text=e,this.interval=t}}class oQ extends qU{constructor(e,t,r,i){super(),this.handled=!1,this.base64=e,this.fileName=t,this.format=r,this.reason=i}}class aQ extends qU{constructor(e,t){super(),this.success=e,this.reason=t}}class sQ extends qU{constructor(e){super(),this.horizontalRulerVisible=e}}class lQ extends qU{constructor(e,t){super(),this.commandName=e,this.parameter=t}}class dQ extends qU{constructor(e){super(),this.pageCount=e}}class cQ extends qU{constructor(e,t,r,i){super(),this.base64=e,this.blob=t,this.blobStream=r,this.handled=i}}class hQ extends qU{constructor(e){super(),this.success=e}}class uQ extends qU{constructor(e){super(),this.commands=e}}class pQ extends qU{constructor(e){super(),this.contextMenu=e}}!function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Bookmark=1]="Bookmark",e[e.EmailAddress=2]="EmailAddress",e[e.Document=3]="Document"}(sY||(sY={}));class gQ extends uY{constructor(e,t,r){super(e),this.ownerElement=t,this.createControl(r)}onCanvasMouseDown(){this.menu.hide()}dispose(){this.menu.dispose(),fn.DomUtils.hideNode(this.targetElement),clearTimeout(this.menuShowTimerId)}static getInitialItems(){const e=[new gY(aY.IgnoreSpellingError,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_IgnoreMistakenWord"),beginGroup:!0}),new gY(aY.IgnoreAllSpellingErrors,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_IgnoreAllMistakenWords"),beginGroup:!1}),new gY(aY.AddWordToDictionary,{text:(0,OV.formatMessage)("ASPxRichEditStringId.Spelling_AddToDictionary"),beginGroup:!1}),new gY(aY.OpenHyperlink,{text:(0,OV.formatMessage)("ASPxRichEditStringId.OpenHyperlink"),icon:"dxre-icon-Select",beginGroup:!0}),new gY(aY.ShowEditHyperlinkDialog,{text:(0,OV.formatMessage)("ASPxRichEditStringId.EditHyperlink"),icon:"dxre-icon-Hyperlink"}),new gY(aY.RemoveHyperlink,{text:(0,OV.formatMessage)("ASPxRichEditStringId.RemoveHyperlink"),icon:"dxre-icon-DeleteHyperlink"}),new gY(aY.UpdateField,{text:(0,OV.formatMessage)("ASPxRichEditStringId.UpdateField"),icon:"dxre-icon-UpdateField",beginGroup:!0}),new gY(aY.ToggleFieldCodes,{text:(0,OV.formatMessage)("ASPxRichEditStringId.ToggleFieldCodes"),icon:"dxre-icon-ToggleFieldCodes"}),new gY(aY.RestartNumberedList,{text:(0,OV.formatMessage)("ASPxRichEditStringId.RestartNumbering"),icon:"dxre-icon-RestartNumbering",beginGroup:!0}),new gY(aY.ContinueNumberedList,{text:(0,OV.formatMessage)("ASPxRichEditStringId.ContinueNumbering"),icon:"dxre-icon-ContinueNumbering",beginGroup:!0}),new gY(aY.Cut,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_CutSelection"),beginGroup:!0,icon:"dxre-icon-Cut"}),new gY(aY.Copy,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_CopySelection"),icon:"dxre-icon-Copy"}),new gY(aY.Paste,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_Paste"),icon:"dxre-icon-Paste"}),new gY(aY.TableMenu,{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertButton"),beginGroup:!0,icon:"dxre-icon-InsertTable",items:[new gY(aY.InsertTableColumnToTheLeft,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableColumnToTheLeft"),icon:"dxre-icon-InsertTableColumnsToTheLeft"}),new gY(aY.InsertTableColumnToTheRight,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableColumnToTheRight"),icon:"dxre-icon-InsertTableColumnsToTheRight"}),new gY(aY.InsertTableRowAbove,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableRowAbove"),icon:"dxre-icon-InsertTableRowsAbove"}),new gY(aY.InsertTableRowBelow,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableRowBelow"),icon:"dxre-icon-InsertTableRowsBelow"}),new gY(aY.ShowInsertTableCellsDialog,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableCells"),icon:"dxre-icon-InsertTableCells"})]}),new gY(aY.ShowDeleteTableCellsDialog,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_DeleteTableCells"),icon:"dxre-icon-DeleteTableCells"}),new gY(aY.ShowSplitCellsDialog,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SplitTableCellsMenuItem"),icon:"dxre-icon-SplitTableCells"}),new gY(aY.MergeTableCells,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_MergeTableCells"),icon:"dxre-icon-MergeTableCells"}),new gY(aY.DecreaseParagraphIndent,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_DecrementIndent"),icon:"dxre-icon-IndentDecrease",beginGroup:!0}),new gY(aY.IncreaseParagraphIndent,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_IncrementIndent"),icon:"dxre-icon-IndentIncrease"}),new gY(aY.ShowFontDialog,{text:(0,OV.formatMessage)("ASPxRichEditStringId.Numbering_Font"),icon:"dxre-icon-FontColor",beginGroup:!0}),new gY(aY.ShowParagraphDialog,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ShowParagraphForm"),icon:"dxre-icon-Paragraph"}),new gY(aY.ShowBookmarkDialog,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_Bookmark"),icon:"dxre-icon-Bookmark",beginGroup:!0}),new gY(aY.ShowHyperlinkDialog,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_Hyperlink"),icon:"dxre-icon-Hyperlink"}),new gY(aY.ChangeFloatingObjectTextWrapTypeMenu,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeFloatingObjectTextWrapType"),icon:"dxre-icon-TextWrapSquare",beginGroup:!0,items:[new gY(aY.SetFloatingObjectInlineTextWrapType,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectInlineWithTextWrapType"),icon:"dxre-icon-TextWrapInline"}),new gY(aY.SetFloatingObjectSquareTextWrapType,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectSquareTextWrapType"),icon:"dxre-icon-TextWrapSquare"}),new gY(aY.SetFloatingObjectTightTextWrapType,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectTightTextWrapType"),icon:"dxre-icon-TextWrapTight"}),new gY(aY.SetFloatingObjectThroughTextWrapType,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectThroughTextWrapType"),icon:"dxre-icon-TextWrapThrough"}),new gY(aY.SetFloatingObjectTopAndBottomTextWrapType,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectTopAndBottomTextWrapType"),icon:"dxre-icon-TextWrapTopAndBottom"}),new gY(aY.SetFloatingObjectBehindTextWrapType,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectBehindTextWrapType"),icon:"dxre-icon-TextWrapBehind"}),new gY(aY.SetFloatingObjectInFrontOfTextWrapType,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectInFrontOfTextWrapType"),icon:"dxre-icon-TextWrapInFrontOfText"})]}),new gY(aY.FloatingObjectBringForwardMenu,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectBringForwardPlaceholder"),icon:"dxre-icon-FloatingObjectBringForward",items:[new gY(aY.FloatingObjectBringForward,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectBringForward"),icon:"dxre-icon-FloatingObjectBringForward"}),new gY(aY.FloatingObjectBringToFront,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectBringToFront"),icon:"dxre-icon-FloatingObjectBringToFront"}),new gY(aY.FloatingObjectBringInFrontOfText,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectBringInFrontOfText"),icon:"dxre-icon-FloatingObjectBringInFrontOfText"})]}),new gY(aY.FloatingObjectSendBackwardMenu,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectSendBackwardPlaceholder"),icon:"dxre-icon-FloatingObjectSendBackward",items:[new gY(aY.FloatingObjectSendBackward,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectSendBackward"),icon:"dxre-icon-FloatingObjectSendBackward"}),new gY(aY.FloatingObjectSendToBack,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectSendToBack"),icon:"dxre-icon-FloatingObjectSendToBack"}),new gY(aY.FloatingObjectSendBehindText,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectSendBehindText"),icon:"dxre-icon-FloatingObjectSendBehindText"})]}),new gY(aY.SelectAll,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SelectAll"),icon:"dxre-icon-SelectAll",beginGroup:!0})];return pY.correctItemsIcons(e),e}createControl(e){this.initialItems=null!=e?e:gQ.getInitialItems();const t=this.ownerElement.appendChild(document.createElement("div"));this.targetElement=this.createTargetElement(),this.menu=new(cY())(t,{dataSource:this.initialItems,target:this.targetElement,onItemClick:e=>{const t=e.itemData,r=t&&t.id==aY.ApplySpellingSuggestion?t.text:null;this.raiseBarCommandExecuted(t.id,r)},onHidden:()=>this.owner.Focus()})}getCommandKeys(){return B.StringMapUtils.toListBy(this.getItemsCache(),((e,t)=>t))}setItemEnabled(e,t){const r=this.getItemsCache();for(let i,n=0;i=r[e][n];n++)i.disabled=!t}setItemVisible(e,t){const r=this.getItemsCache();for(let i,n=0;i=r[e][n];n++)i.visible=t}setItemValue(e,t){}hide(){this.menu.hide()}createTargetElement(){const e=document.createElement("div");return e.className="dxrePopupTarget",document.body.appendChild(e),e}getItemsCache(){return this.cache||(this.cache={},this.fillCache(this.initialItems)),this.cache}fillCache(e){for(const t of e){const e=t.id;if(e&&void 0!==FF[e]){let r=this.cache[e];r||(r=this.cache[e]=[]),r.push(t)}t.items&&this.fillCache(t.items)}}show(e){var t;const r=f.ListUtils.shallowCopy(this.initialItems);this.isSpellingMenu=this.addSuggestionItems(r),this.cache=void 0;const i=this.getCommandKeys();for(const e of i)this.updateBarItem(e);const n=this.owner,o=new PY(!0,(()=>f.ListUtils.map(r,(e=>function(e){return new gY(e.id,{text:e.text,localizationId:e.localizationId,beginGroup:e.beginGroup,icon:e.icon,items:e.items,disabled:e.disabled,visible:e.visible})}(e))))),a=new pQ(o);if(n.raiseContextMenuShowing(a),n.contextMenuSettings.enabled&&a.contextMenu.enabled){const i=e(this);this.menu.option("dataSource",null!==(t=o._items)&&void 0!==t?t:r),this.menuShowTimerId=setTimeout((()=>{this.menu.option("position.offset",{x:i.x,y:i.y}),this.menu.show()}),10)}}addSuggestionItems(e){const t=this.getSuggestions();return null!=t&&(t.length>0?f.ListUtils.reverseForEach(t,(t=>{e.unshift(new gY(aY.ApplySpellingSuggestion,{text:t,icon:void 0,beginGroup:!1}))})):e.unshift(new gY(aY.NoSpellingSuggestions,{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeMistakenWord"),icon:void 0,beginGroup:!1,disabled:!0})),!0)}}!function(e){e[e.None=0]="None",e[e.FullReset=1]="FullReset",e[e.CheckSelectionChange=2]="CheckSelectionChange",e[e.ActivateHeaderFooter=4]="ActivateHeaderFooter"}(lY||(lY={}));class mQ extends hY{constructor(){super(...arguments),this.selection=null}updateContextItem(e){const t=this.core.commandManager.getCommand(e);t&&this.setContextItemVisible(e,t.getState().visible)}forceUpdate(e){this.isUpdateLocked()?this.registerOccurredEvent(lY.FullReset):this.updateItemsState(e)}checkActivateHeaderFooter(e){return e.prevState.intervalsInfo.subDocument!=e.currState.intervalsInfo.subDocument&&e.currState.intervalsInfo.subDocument.isHeaderFooter()}activateHeaderFooter(){this.setContextItemVisible(FF.ContextItem_HeadersFooters,!0),this.activateContextItem(FF.ContextItem_HeadersFooters)}onUpdateUnlocked(e){this.applyEvent(e)}modelChanged(e){const t=this.getModelChangeEvent(e);this.isUpdateLocked()?this.registerOccurredEvent(t):this.applyEvent(t)}NotifySelectionChanged(e){this.selection=e,this.isUpdateLocked()?this.registerOccurredEvent(lY.CheckSelectionChange):this.applyEvent(this.getSelectionChangeEvent())}applyEvent(e){if(!this.updateEnabled)return;const t=new pr.Flag(e);t.get(lY.CheckSelectionChange)&&t.add(this.getSelectionChangeEvent()),t.get(lY.ActivateHeaderFooter)&&this.activateHeaderFooter(),t.get(lY.FullReset)&&this.updateItemsState()}getSelectionChangeEvent(){const e=new pr.Flag(lY.None);return this.selection&&!this.selection.shouldResetInputPosition()||e.set(lY.FullReset,!0),this.selection&&this.checkActivateHeaderFooter(this.selection)&&(e.set(lY.ActivateHeaderFooter,!0),e.set(lY.FullReset,!0)),e.getValue()}getModelChangeEvent(e){switch(e.type){case pd.DifferentOddAndEvenPages:case pd.PageColor:case pd.DefaultTabWidth:case pd.HeaderFooterCreated:case pd.HeaderFooterIndexChanged:return lY.None;case pd.LoadFontInfo:case pd.SectionFormattingChanged:return lY.FullReset;case pd.CreateStyleLink:case pd.DeleteStyleLink:case pd.AbstractNumberingListAdded:case pd.AbstractNumberingListDeleted:case pd.NumberingListAdded:case pd.NumberingListDeleted:case pd.ListLevelPropertyChanged:case pd.ListLevelParagraphPropertyChanged:case pd.ListLevelCharacterPropertyChanged:case pd.IOverrideListLevelChanged:case pd.BookmarkCreated:case pd.BookmarkDeleted:case pd.TabInserted:case pd.TabDeleted:return lY.None;case pd.LoadPicturesInfo:case pd.InlinePicturesUpdated:case pd.InlinePictureInserted:case pd.AnchoredPictureInserted:case pd.AnchoredPictureSizeChanged:case pd.InlineObjectRunPropertyChanged:return lY.FullReset;case pd.FieldInserted:case pd.FieldDeleted:case pd.HyperlinkInfoChanged:case pd.FieldsShowCodeChanged:return lY.None;case pd.SimpleRunInserted:case pd.TextBufferChanged:case pd.ParagraphInserted:case pd.SectionInserted:case pd.AnchoredTextBoxInserted:case pd.AnchorObjectRemoved:case pd.IntervalRemoved:case pd.ParagraphMerged:case pd.SectionMerged:case pd.CharacterFormattingChanged:case pd.CharacterPropertiesChanged:case pd.ParagraphFormattingChanged:case pd.ParagraphPropertiesChanged:case pd.ParagraphAndCharacterMergedPropertiesReset:case pd.AnchoredTextBoxSizeChanged:case pd.AnchoredTextBoxPropertiesChanged:case pd.AnchorInfoPropertyChanged:case pd.ShapeChanged:case pd.ShapePropertyChanged:case pd.CharacterStyleApplied:case pd.ParagraphStyleApplied:case pd.TableStyleChanged:case pd.ParagraphNumberingListChanged:case pd.TableCreated:case pd.TableRemoved:case pd.TableStartPositionShifted:case pd.TableCellPropertyChanged:case pd.TablePropertyChanged:case pd.TableRowPropertyChanged:case pd.TableCellSplittedHorizontally:case pd.TableCellMergedHorizontally:case pd.TableRowInserted:case pd.TableRowRemoved:case pd.TableCellRemoved:case pd.TableCellInserted:return lY.FullReset;default:return lY.None}}}var fQ=DevExpress.ui.dxTabPanel,bQ=__webpack_require__.n(fQ),CQ=DevExpress.ui.dxToolbar,SQ=__webpack_require__.n(CQ);class IQ{get toolbarItemTemplateCreator(){return this._toolbarItemTemplateCreator||(this._toolbarItemTemplateCreator=this.getBuildTemplateStrategy()),this._toolbarItemTemplateCreator}createToolbarItemTemplate(){return this.toolbarItemTemplateCreator.createTemplate()}}class PQ extends IQ{constructor(e,t){super(),this.options=e,this.onCommandExecuted=t,this.name=e.name}setEnabled(e){this.widget.option("disabled",!e)}setVisible(e){this.widget.option("visible",e)}getOnInitializedHandler(){return e=>this.applyWidget(e)}applyWidget(e){this.widget=e.component}}class wQ{createTemplate(){return{location:"before",locateInMenu:"auto"}}getCssClass(){return"dx-ribbon-item"}shouldCreateTextContentTemplate(e){return e&&e.text&&""!=e.text}createTextContentTemplate(e,t,r){return(i,n,o)=>{const a=document.createElement("div"),s=document.createElement("div");s.style.display="inline-block";const l=document.createElement("div");return l.style.display="inline-block",l.textContent=e.text,e.displayAfterEditor||a.appendChild(l),a.appendChild(s),e.displayAfterEditor&&a.appendChild(l),new r(s,t),a}}}class yQ extends wQ{getOnFocusOut(){return e=>e.component.close()}getOnKeyDown(){return e=>{9===e.event.keyCode&&e.event.preventDefault()}}}class xQ extends wQ{constructor(e){super(),this.options=e}createTemplate(){const e=super.createTemplate();return e.widget="dxButtonGroup",e.showText=this.options.itemOptions.items[0]&&this.options.itemOptions.items[0].icon&&!this.options.itemOptions.alwaysShowText?"inMenu":"always",e.options=this.getButtonGroupOptions(),e}getButtonGroupOptions(){return{focusStateEnabled:!1,onInitialized:this.options.onInitialized,items:this.options.itemOptions.items.map((e=>{const t=e;return t.icon=t.icon?pY.correctIconName(t.icon):t.icon,t}))}}}class TQ extends PQ{getBuildTemplateStrategy(){return new xQ({itemOptions:this.options,onInitialized:this.getOnInitializedHandler(),onClick:this.getOnClickHandler()})}setValue(e){}getOnClickHandler(){return this.onCommandExecuted?()=>{this.onCommandExecuted({item:this,parameter:null})}:void 0}}TQ.ToggleStateClassName="dx-r-toggle",TQ.ToggleButtonDataProperty="dx-ri-value";class vQ extends wQ{constructor(e){super(),this.options=e}createTemplate(){const e=super.createTemplate();return e.widget="dxButton",e.showText=!this.options.itemOptions.icon||this.options.itemOptions.alwaysShowText?"always":"inMenu",e.options=this.getButtonOptions(),e}getButtonOptions(){return{text:this.options.itemOptions.text,icon:this.options.itemOptions.icon?pY.correctIconName(this.options.itemOptions.icon):void 0,hint:this.options.itemOptions.text,stylingMode:"text",focusStateEnabled:!1,onInitialized:this.options.onInitialized,onClick:this.options.onClick}}}class MQ extends PQ{getBuildTemplateStrategy(){return new vQ({itemOptions:this.options,onInitialized:e=>{this.applyWidget(e),this.setValue(this.options.isToggleMode&&this.options.selected)},onClick:this.getOnClickHandler()})}setValue(e){if(!this.options.isToggleMode)return;const t=this.getElement();t[MQ.ToggleButtonDataProperty]=e,e?(t.classList.add(MQ.ToggleStateClassName),t.classList.add(MQ.ButtonGroupItemClassName),t.classList.add(MQ.ItemSelectedClassName)):(t.classList.remove(MQ.ToggleStateClassName),t.classList.remove(MQ.ButtonGroupItemClassName),t.classList.remove(MQ.ItemSelectedClassName))}getValue(){return this.options.isToggleMode?this.getElement()[MQ.ToggleButtonDataProperty]:null}getElement(){return this.widget.element().classList?this.widget.element():this.widget.element()[0]}getOnClickHandler(){return this.onCommandExecuted?()=>{this.setValue(!this.getValue()),this.onCommandExecuted({item:this,parameter:this.getValue()})}:void 0}}MQ.ToggleStateClassName="dx-r-toggle",MQ.ButtonGroupItemClassName="dx-buttongroup-item",MQ.ItemSelectedClassName="dx-state-selected",MQ.ToggleButtonDataProperty="dx-ri-value";var EQ=DevExpress.ui.dxColorBox,DQ=__webpack_require__.n(EQ);class FQ extends wQ{constructor(e){super(),this.options=e}createTemplate(){const e=super.createTemplate();e.widget="dxColorBox";const t=this.getWidgetOptions();return this.shouldCreateTextContentTemplate(this.options.itemOptions.textOptions)?e.template=this.createTextContentTemplate(this.options.itemOptions.textOptions,t,DQ()):e.options=t,e}getWidgetOptions(){return{placeholder:"",focusStateEnabled:!1,acceptCustomValue:!1,stylingMode:"filled",hint:this.options.itemOptions.text,value:this.options.itemOptions.value,width:75,onValueChanged:this.options.onValueChanged,onInitialized:this.options.onInitialized,onContentReady:e=>{const t=e.element.querySelector?e.element:e.element[0];t.querySelector(".dx-colorbox-color-result-preview").addEventListener("click",(()=>{this.options.onValueChanged({component:e.component,element:t,model:e.model,value:e.component.option("value")})}))},onOpened:this.options.onOpened,onClosed:this.options.onClosed,elementAttr:{class:this.getCssClass()}}}}class RQ extends PQ{constructor(e,t,r,i){super(e,t),this.onOpened=r,this.onClosed=i}getBuildTemplateStrategy(){return new FQ({itemOptions:this.options,onInitialized:this.getOnInitializedHandler(),onValueChanged:this.getOnValueChangedHandler(),onOpened:this.getOnOpenedHandler(),onClosed:this.getOnClosedHandler()})}setValue(e){this.widget.option("value",e)}getOnOpenedHandler(){return this.onOpened?()=>{this.onOpened({item:this})}:void 0}getOnClosedHandler(){return this.onClosed?()=>{this.onClosed({item:this})}:void 0}getOnValueChangedHandler(){return this.onCommandExecuted?e=>{this.onCommandExecuted({item:this,parameter:e.value})}:void 0}}class LQ extends wQ{constructor(e){super(),this.options=e}createTemplate(){const e=super.createTemplate();return e.widget="dxMenu",e.options=this.getMenuOptions(),e}getMenuOptions(){return pY.correctItemsIcons(this.options.itemOptions.items),{hideSubmenuOnMouseLeave:!0,focusStateEnabled:!1,selectByClick:!1,hint:this.options.itemOptions.text,dataSource:[{icon:this.options.itemOptions.icon?pY.correctIconName(this.options.itemOptions.icon):void 0,text:this.options.itemOptions.text,items:this.options.itemOptions.items.map((e=>({beginGroup:e.beginGroup,name:e.name,text:e.text,icon:e.icon,items:e.items})))}],onSubmenuShowing:e=>{setTimeout((()=>{var t,r;const i=e.component;if(i._visibleSubmenu){const n=null!==(r=null===(t=e.submenu._shownSubmenus)||void 0===t?void 0:t.length)&&void 0!==r?r:0,o=i._visibleSubmenu._overlay.$content(n),a=o.find(".dx-submenu").eq(n);a.css("position",""),BQ(a,null);const s=this.getContentBounds(a),l=Math.max(0,document.documentElement.clientHeight-s.y),d=Math.min(600,l);if(n>0&&o.find(".dx-submenu")[n-1].style.height&&a.css("position","fixed"),s.height>=d){const e=Math.min(s.height,d);BQ(a,e),a.dxScrollView({})}}}))},onInitialized:this.options.onInitialized,onItemRendered:this.options.onItemRendered,onItemClick:this.options.onItemClick,elementAttr:{class:this.getCssClass()},onContentReady:e=>{if(this.options.itemOptions.icon&&!this.options.itemOptions.alwaysShowText){(e.element.classList?e.element:e.element[0]).classList.add(LQ.ShowTextInMenuClassName)}}}}getContentBounds(e){if(!e)return null;const t=Array.from(e);if(!t.length)return null;let r=this.toRectangle(t[0].getBoundingClientRect());if(1===t.length)return r;for(let e=1;e<t.length;e++){const i=t[e].getBoundingClientRect();r=Va.Rectangle.union(r,this.toRectangle(i))}return r}toRectangle(e){return new Va.Rectangle(e.x,e.y,e.width,e.height)}}LQ.ShowTextInMenuClassName="dx-showTextInMenu";const BQ=function(e,t){var r;const i=e[0];if(!i)return;const n=(null===(r=i.ownerDocument)||void 0===r?void 0:r.defaultView)||window,o=n.getComputedStyle&&n.getComputedStyle(i);if(o)if((0,S.isDefined)(t)){if("content-box"===o.boxSizing){t-=(parseFloat(o.borderTopWidth)||0)+(parseFloat(o.borderBottomWidth)||0)+((parseFloat(o.paddingTop)||0)+(parseFloat(o.paddingBottom)||0))}i.style.height=t.toString()+"px"}else i.style.height=""};class AQ{constructor(e,t){this.name=e,this.menuItem=t}setValue(e){"boolean"==typeof e&&(this.element?this.setValueCore(this.element,e):this.selected=e)}setElement(e){this.element=e,void 0!==this.selected&&(this.setValue(this.selected),this.selected=void 0)}setEnabled(e){this.setDataOption("disabled",!e)}setVisible(e){this.setDataOption("visible",e)}setValueCore(e,t){t?e.classList.add(AQ.SelectedItemClassName):e.classList.remove(AQ.SelectedItemClassName)}setDataOption(e,t){const r=this.getDataOptionName();r&&setTimeout((()=>this.menuItem.getWidget().option(`${r}.${e}`,t)),0)}getDataOptionName(){return void 0===this.dataOptionName&&(this.dataOptionName=this.getDataOptionNameCore(this.menuItem.getOptions().items,"items[0]")),this.dataOptionName}getDataOptionNameCore(e,t){if(!e)return null;const r=e.filter((e=>e.name==this.name))[0];if(r)return`${t}.items[${e.indexOf(r)}]`;for(let r=0;r<e.length;r++){const i=this.getDataOptionNameCore(e[r].items,`${t}.items[${r}]`);if(i)return i}return null}}AQ.SelectedItemClassName="dx-menu-item-selected";class NQ extends PQ{constructor(e,t,r){super(e,t),this.onSubMenuItemCreated=r,this.items={},this.createSubMenuItems(e.items)}getWidget(){return this.widget}getOptions(){return this.options}createSubMenuItems(e){e&&e.forEach((e=>{const t=new AQ(e.name,this);this.onSubMenuItemCreated(t),e.name&&(this.items[e.name]=t),this.createSubMenuItems(e.items)}))}getBuildTemplateStrategy(){return new LQ({itemOptions:this.options,onInitialized:this.getOnInitializedHandler(),onItemRendered:this.getOnItemRenderedHandler(),onItemClick:this.getOnItemClickHandler()})}setValue(e){}getOnItemClickHandler(){return this.onCommandExecuted?e=>{this.closeSubMenuIfRequired(e.component,e.itemData,e.itemElement);const t=e.itemData.name?this.items[e.itemData.name]:void 0;t&&this.onCommandExecuted({item:t,parameter:null})}:void 0}closeSubMenuIfRequired(e,t,r){t.isRootElement&&e._visibleSubmenu&&window.setTimeout((()=>e.unselectItem(r[0]||r)),0)}getOnItemRenderedHandler(){return e=>{const t=e.itemData.name;if(!t)return;const r=this.items[t],i=e.itemElement[0]?e.itemElement[0]:e.itemElement;r.setElement(i)}}}class kQ extends wQ{constructor(e){super(),this.options=e}createTemplate(){const e=super.createTemplate();return e.widget="dxNumberBox",e.options=this.getWidgetOptions(),e}getWidgetOptions(){const e=this.options.itemOptions.format,t=null==e||null==e?`${this.options.itemOptions.text} #0.#`:e;return{placeholder:"",focusStateEnabled:!1,hint:this.options.itemOptions.text,stylingMode:"filled",format:t,value:this.options.itemOptions.value,width:this.options.itemOptions.width,showSpinButtons:!0,min:this.options.itemOptions.min,max:this.options.itemOptions.max,step:this.options.itemOptions.step,onValueChanged:this.options.onValueChanged,onInitialized:this.options.onInitialized,elementAttr:{class:this.getCssClass()}}}}class OQ extends PQ{getBuildTemplateStrategy(){return new kQ({itemOptions:this.options,onInitialized:this.getOnInitializedHandler(),onValueChanged:this.getOnValueChangedHandler()})}setValue(e){this.widget.option("value",e)}getOnValueChangedHandler(){return this.onCommandExecuted?e=>{e.event&&this.onCommandExecuted({item:this,parameter:e.value})}:void 0}}var _Q=DevExpress.ui.dxSelectBox,UQ=__webpack_require__.n(_Q);class HQ extends yQ{constructor(e){super(),this.options=e}createTemplate(){const e=super.createTemplate();e.widget="dxSelectBox";const t=this.getWidgetOptions();return this.shouldCreateTextContentTemplate(this.options.itemOptions.textOptions)?e.template=this.createTextContentTemplate(this.options.itemOptions.textOptions,t,UQ()):e.options=t,e}getOnCustomItemCreating(e){return e.acceptCustomValue&&e.onCustomItemCreating?e.onCustomItemCreating:function(e){e.customItem||(e.customItem=e.text)}}getWidgetOptions(){const e=this.options.itemOptions;return{placeholder:e.placeholder,stylingMode:"filled",searchEnabled:!0,acceptCustomValue:e.acceptCustomValue,dataSource:e.dataSource,width:e.width,displayExpr:e.displayExpr,valueExpr:e.valueExpr,value:e.value,showClearButton:e.showClearButton,onValueChanged:this.options.onValueChanged,onInitialized:this.options.onInitialized,onFocusOut:super.getOnFocusOut(),onKeyDown:super.getOnKeyDown(),onCustomItemCreating:this.getOnCustomItemCreating(e),elementAttr:{class:this.getCssClass()}}}}class VQ extends PQ{getBuildTemplateStrategy(){return new HQ({itemOptions:this.options,onInitialized:this.getOnInitializedHandler(),onValueChanged:this.getOnValueChangedHandler()})}setValue(e){this.widget.option("value",e)}getOnValueChangedHandler(){return this.onCommandExecuted?e=>{e.event&&this.onCommandExecuted({item:this,parameter:e.value})}:void 0}}class WQ extends wQ{createTemplate(){const e=super.createTemplate();return e.disabled=!0,e.dxIsSeparator=!0,e.template=()=>{const e=document.createElement("div");return e.classList.add(WQ.SeparatorClassName),e.classList.add(iJ.BorderColor),e},e}}WQ.SeparatorClassName="dx-r-separator";class zQ extends IQ{static prepareElement(e){const t=e.classList?e:e[0];if(!t)return;const r=t.querySelector(".dx-toolbar-item-content");r&&r.classList.add(zQ.SeparatorContainerClassName)}getBuildTemplateStrategy(){return new WQ}}zQ.SeparatorContainerClassName="dx-r-separator-container";class jQ{get element(){return this.options.element}constructor(e){this.options=e,this.toolbars=[],this.toolBarItemsByName={},this.contextItemIndexesByCategoryName={}}dispose(){this.tabPanel.dispose(),this.toolbars.forEach((e=>e.dispose())),jQ.hideNode(this.options.element)}static hideNode(e){if(e){const t=e.parentNode;t&&t.removeChild(e)}}shouldApplyLocalization(e,t){return!e&&!!t}applyLocalizationId(){this.options.items.forEach((e=>{this.applyLocalizationIdToRibbonItem(e)})),this.options.contextItemsCategories.forEach((e=>{e.items.forEach((e=>{this.applyLocalizationIdToRibbonItem(e)}))}))}applyLocalizationIdToRibbonItem(e){this.shouldApplyLocalization(e.title,e.localizationId)&&(e.title=(0,OV.formatMessage)(e.localizationId)),this.applyLocalizationIdToRibbonItems(e.items)}applyLocalizationIdToRibbonItems(e){e.forEach((e=>{switch(e.type){case"Button":const t=e;this.shouldApplyLocalization(t.text,t.localizationId)&&(t.text=(0,OV.formatMessage)(t.localizationId));break;case"Menu":const r=e;this.shouldApplyLocalization(r.text,r.localizationId)&&(r.text=(0,OV.formatMessage)(r.localizationId)),this.applyLocalizationIdToSubMenuItemOptions(r.items);break;case"ButtonGroup":default:break;case"NumberBox":const i=e;this.shouldApplyLocalization(i.text,i.localizationId)&&(i.text=(0,OV.formatMessage)(i.localizationId));break;case"ColorBox":const n=e;this.shouldApplyLocalization(n.text,n.localizationId)&&(n.text=(0,OV.formatMessage)(n.localizationId));break;case"SelectBox":const o=e;o._localizeDataSourceItems&&o.dataSource.forEach((e=>{if(e.localizationId){const t=(0,OV.formatMessage)(e.localizationId);e.text=e.text?e.text+t:t}}))}}))}applyLocalizationIdToSubMenuItemOptions(e){e.forEach((e=>{this.shouldApplyLocalization(e.text,e.localizationId)&&(e.text=(0,OV.formatMessage)(e.localizationId)),e.items&&this.applyLocalizationIdToSubMenuItemOptions(e.items)}))}render(){this.applyLocalizationId(),this.tabPanel=new(bQ())(this.options.element,{dataSource:this.getRibbonItems().map(((e,t)=>({title:e.title,visible:e.visible,template:()=>this.createToolbar(e.items,t)}))),deferRendering:!1,elementAttr:{class:`dx-ribbon ${(0,_V.currentTheme)()}`},focusStateEnabled:!1,selectedIndex:this.options.activeTabIndex,loop:!1,animationEnabled:!1,swipeEnabled:!1,showNavButtons:!0,onTitleClick:this.options.onTitleClickHandler,onSelectionChanged:this.options.onSelectionChangedHandler})}getActiveTabIndex(){return this.tabPanel.option("selectedIndex")}setActiveTabIndex(e){this.tabPanel.option("selectedIndex",e)}setItemVisible(e,t){return this.tabPanel.option(`items[${e}].visible`,t)}getItemVisible(e){return this.tabPanel.option(`items[${e}].visible`)}setContextItemsCategoryVisible(e,t){var r=this.getContextItemsIndexes(e);if(!r)return;let i=!1;const n=this.getActiveTabIndex();r.forEach((e=>{this.getItemVisible(e)!==t&&(n!=e||t||(i=!0),this.setItemVisible(e,t))})),i&&this.setActiveTabIndex(this.options.activeTabIndex)}getContextItemsCategoryVisible(e){var t=this.getContextItemsIndexes(e);return!(!t||!t.length)&&this.getItemVisible(t[0])}getContextItemsIndexes(e){return this.contextItemIndexesByCategoryName[e]}getTabPanel(){return this.tabPanel}getItems(e){return e&&this.toolBarItemsByName[e]?this.toolBarItemsByName[e]:null}adjustControl(){this.tabPanel._dimensionChanged(),this.toolbars.forEach((e=>e._dimensionChanged()))}getRibbonItems(){let e=[].concat(this.options.items);return this.options.contextItemsCategories&&this.options.contextItemsCategories.forEach((t=>{this.contextItemIndexesByCategoryName[t.name]||(this.contextItemIndexesByCategoryName[t.name]=[]),t.items.forEach(((r,i)=>{this.contextItemIndexesByCategoryName[t.name].push(i+e.length)})),e=e.concat(t.items.map((e=>({items:e.items,title:e.title,visible:!1}))))})),e}createToolbar(e,t){const r=document.createElement("div"),i={dataSource:this.getToolbarItemTemplates(e,t),onInitialized:e=>this.toolbars.push(e.component),onItemRendered:e=>{e.itemData.dxIsSeparator&&zQ.prepareElement(e.itemElement)}};return new(SQ())(r,i),r}getToolbarItemTemplates(e,t){let r=[];e.forEach((e=>{r=r.concat(this.getToolbarItems(e,t))}));const i=[];let n;return r.forEach((e=>{e instanceof zQ&&(!n||n instanceof zQ)||(i.push(e.createToolbarItemTemplate()),n=e)})),i}getToolbarItems(e,t){const r=[];return e.beginGroup&&r.push(new zQ),r.push(this.interactiveToolbarItemFactory(e,t)),r}interactiveToolbarItemFactory(e,t){let r;switch(e.type){case"Button":r=new MQ(e,this.options.onCommandExecuted);break;case"ButtonGroup":r=new TQ(e,this.options.onCommandExecuted);break;case"Menu":r=new NQ(e,this.options.onCommandExecuted,(r=>{this.addItemToCache(r.name,r),this.raiseOnOnToolbarItemCreated(e,r,t)}));break;case"NumberBox":r=new OQ(e,this.options.onCommandExecuted);break;case"ColorBox":r=new RQ(e,this.options.onCommandExecuted,this.options.onOpened,this.options.onClosed);break;default:r=new VQ(e,this.options.onCommandExecuted)}return this.addItemToCache(e.name,r),this.raiseOnOnToolbarItemCreated(e,r,t),r}addItemToCache(e,t){e&&(this.toolBarItemsByName[e]||(this.toolBarItemsByName[e]=[]),this.toolBarItemsByName[e].push(t))}raiseOnOnToolbarItemCreated(e,t,r){this.options.onOnToolbarItemCreated&&this.options.onOnToolbarItemCreated({options:e,item:t,tabIndex:r})}containsChild(e){return fn.DomUtils.isItParent(this.element,e)}}let XQ=!1;function GQ(){XQ||(XQ=!0,(0,OV.loadMessages)({en:{"OfficeStringId.Caption_EditHyperlinkForm":"Edit Hyperlink","OfficeStringId.Caption_EditHyperlinkFormDescription":" ","OfficeStringId.Caption_InsertHyperlinkForm":"Insert Hyperlink","OfficeStringId.Caption_InsertHyperlinkFormDescription":" ","OfficeStringId.Caption_UnitCentimeters":"Centimeters","OfficeStringId.Caption_UnitInches":"Inches","OfficeStringId.Caption_UnitMillimeters":"Millimeters","OfficeStringId.Caption_UnitPercent":"Percent","OfficeStringId.Caption_UnitPoints":"Points","OfficeStringId.FileFilterDescription_AllFiles":"All Files","OfficeStringId.FileFilterDescription_AllSupportedFiles":"All Supported Files","OfficeStringId.FileFilterDescription_BitmapFiles":"Windows Bitmap","OfficeStringId.FileFilterDescription_EmfFiles":"Microsoft Enhanced Metafile","OfficeStringId.FileFilterDescription_GifFiles":"Graphics Interchange Format","OfficeStringId.FileFilterDescription_JPEGFiles":"JPEG File Interchange Format","OfficeStringId.FileFilterDescription_PNGFiles":"Portable Network Graphics","OfficeStringId.FileFilterDescription_TiffFiles":"Tag Image File Format","OfficeStringId.FileFilterDescription_WmfFiles":"Windows Metafile","OfficeStringId.MenuCmd_AlignmentCenter":"Center","OfficeStringId.MenuCmd_AlignmentCenterDescription":"Center text.","OfficeStringId.MenuCmd_AlignmentJustify":"Justify","OfficeStringId.MenuCmd_AlignmentJustifyDescription":"Align text to both left and right margins, adding extra space between words as necessary.This creates a clean look along the left and right side of the page.","OfficeStringId.MenuCmd_AlignmentLeft":"Align Text Left","OfficeStringId.MenuCmd_AlignmentLeftDescription":"Align text to the left.","OfficeStringId.MenuCmd_AlignmentRight":"Align Text Right","OfficeStringId.MenuCmd_AlignmentRightDescription":"Align text to the right.","OfficeStringId.MenuCmd_ChangeFontColor":"Font Color","OfficeStringId.MenuCmd_ChangeFontColorDescription":"Change the text color.","OfficeStringId.MenuCmd_ChangeFontName":"Font","OfficeStringId.MenuCmd_ChangeFontNameDescription":"Change the font face.","OfficeStringId.MenuCmd_ChangeFontSize":"Font Size","OfficeStringId.MenuCmd_ChangeFontSizeDescription":"Change the font size.","OfficeStringId.MenuCmd_ClearUndo":"ClearUndo","OfficeStringId.MenuCmd_ClearUndoDescription":"Clear Undo Buffer","OfficeStringId.MenuCmd_CopySelection":"Copy","OfficeStringId.MenuCmd_CopySelectionDescription":"Copy the selection and put it on the Clipboard.","OfficeStringId.MenuCmd_CutSelection":"Cut","OfficeStringId.MenuCmd_CutSelectionDescription":"Cut the selection from the document and put it on the Clipboard.","OfficeStringId.MenuCmd_DecreaseFontSize":"Shrink Font","OfficeStringId.MenuCmd_DecreaseFontSizeDescription":"Decrease the font size.","OfficeStringId.MenuCmd_DeleteComment":"Delete","OfficeStringId.MenuCmd_DeleteCommentDescription":"Delete the selected comment.","OfficeStringId.MenuCmd_EditComment":"Edit Comment","OfficeStringId.MenuCmd_EditCommentDescription":"Add a note about this part of the document.","OfficeStringId.MenuCmd_EditHyperlink":"Edit Hyperlink...","OfficeStringId.MenuCmd_EditHyperlinkDescription":"Edit Hyperlink...","OfficeStringId.MenuCmd_Encrypt":"Encrypt with Password","OfficeStringId.MenuCmd_EncryptDescription":"Require a password to open this workbook.","OfficeStringId.MenuCmd_FloatingObjectBringForward":"Bring Forward","OfficeStringId.MenuCmd_FloatingObjectBringForwardCommandGroup":"Bring Forward","OfficeStringId.MenuCmd_FloatingObjectBringForwardCommandGroupDescription":"Bring the selected object forward one level, or bring it in front of all the other objects.","OfficeStringId.MenuCmd_FloatingObjectBringForwardDescription":"Bring the selected object forward so that it is hidden by fewer objects that are in front of it.","OfficeStringId.MenuCmd_FloatingObjectBringToFront":"Bring to Front","OfficeStringId.MenuCmd_FloatingObjectBringToFrontDescription":"Bring the selected object in front of all other objects so that no part of it is hidden behind other objects.","OfficeStringId.MenuCmd_FloatingObjectSendBackward":"Send Backward","OfficeStringId.MenuCmd_FloatingObjectSendBackwardCommandGroup":"Send Backward","OfficeStringId.MenuCmd_FloatingObjectSendBackwardCommandGroupDescription":"Send the selected object back one level, or send it behind all the other objects.","OfficeStringId.MenuCmd_FloatingObjectSendBackwardDescription":"Send the selected object backward so that it is hidden by the objects that are in front of it.","OfficeStringId.MenuCmd_FloatingObjectSendToBack":"Send to Back","OfficeStringId.MenuCmd_FloatingObjectSendToBackDescription":"Send the selected object behind all other objects.","OfficeStringId.MenuCmd_Hyperlink":"Hyperlink","OfficeStringId.MenuCmd_HyperlinkDescription":"Create a link to a Web page, a picture, an e-mail address, or a program.","OfficeStringId.MenuCmd_IncreaseFontSize":"Grow Font","OfficeStringId.MenuCmd_IncreaseFontSizeDescription":"Increase the font size.","OfficeStringId.MenuCmd_InsertComment":"New Comment","OfficeStringId.MenuCmd_InsertCommentDescription":"Add a note about this part of the document.","OfficeStringId.MenuCmd_InsertFloatingObjectPicture":"Picture","OfficeStringId.MenuCmd_InsertFloatingObjectPictureDescription":"Insert a picture from a file.","OfficeStringId.MenuCmd_InsertHyperlink":"Hyperlink...","OfficeStringId.MenuCmd_InsertHyperlinkDescription":"Add a new hyperlink.","OfficeStringId.MenuCmd_InsertSymbol":"Symbol","OfficeStringId.MenuCmd_InsertSymbolDescription":"Insert symbols that are not on your keyboard, such as copyright symbols, trademark symbols, paragraph marks and Unicode characters.","OfficeStringId.MenuCmd_LoadDocument":"Open","OfficeStringId.MenuCmd_LoadDocumentDescription":"Open a document.","OfficeStringId.MenuCmd_NewEmptyDocument":"New","OfficeStringId.MenuCmd_NewEmptyDocumentDescription":"Create a new document.","OfficeStringId.MenuCmd_OpenHyperlink":"Open Hyperlink","OfficeStringId.MenuCmd_OpenHyperlinkDescription":"Open Hyperlink","OfficeStringId.MenuCmd_PageMarginsModerate":"ModerateTop: {1,10} Bottom: {3,10}Left: {0,10} Right:  {2,10}","OfficeStringId.MenuCmd_PageMarginsModerateDescription":" ","OfficeStringId.MenuCmd_PageMarginsNarrow":"NarrowTop: {1,10} Bottom: {3,10}Left: {0,10} Right:  {2,10}","OfficeStringId.MenuCmd_PageMarginsNarrowDescription":" ","OfficeStringId.MenuCmd_PageMarginsNormal":"NormalTop: {1,10} Bottom: {3,10}Left: {0,10} Right:  {2,10}","OfficeStringId.MenuCmd_PageMarginsNormalDescription":" ","OfficeStringId.MenuCmd_PageMarginsWide":"WideTop: {1,10} Bottom: {3,10}Left: {0,10} Right:  {2,10}","OfficeStringId.MenuCmd_PageMarginsWideDescription":" ","OfficeStringId.MenuCmd_PageOrientationCommandGroup":"Orientation","OfficeStringId.MenuCmd_PageOrientationCommandGroupDescription":"Switch the pages between portrait and landscape layouts.","OfficeStringId.MenuCmd_PageOrientationLandscape":"Landscape","OfficeStringId.MenuCmd_PageOrientationLandscapeDescription":" ","OfficeStringId.MenuCmd_PageOrientationPortrait":"Portrait","OfficeStringId.MenuCmd_PageOrientationPortraitDescription":" ","OfficeStringId.MenuCmd_Paste":"Paste","OfficeStringId.MenuCmd_PasteDescription":"Paste the contents of the Clipboard.","OfficeStringId.MenuCmd_Print":"Print","OfficeStringId.MenuCmd_PrintDescription":"Select a printer, number of copies, and other printing options before printing.","OfficeStringId.MenuCmd_PrintPreview":"Print Preview","OfficeStringId.MenuCmd_PrintPreviewDescription":"Preview pages before printing.","OfficeStringId.MenuCmd_QuickPrint":"Quick Print","OfficeStringId.MenuCmd_QuickPrintDescription":"Send the document directly to the default printer without making changes.","OfficeStringId.MenuCmd_Redo":"Redo","OfficeStringId.MenuCmd_RedoDescription":"Redo","OfficeStringId.MenuCmd_RemoveHyperlink":"Remove Hyperlink","OfficeStringId.MenuCmd_RemoveHyperlinkDescription":"Remove Hyperlink","OfficeStringId.MenuCmd_RemoveHyperlinks":"Remove Hyperlinks","OfficeStringId.MenuCmd_RemoveHyperlinksDescription":"Remove Hyperlinks","OfficeStringId.MenuCmd_SaveDocument":"Save","OfficeStringId.MenuCmd_SaveDocumentAs":"Save As","OfficeStringId.MenuCmd_SaveDocumentAsDescription":"Open the Save As dialog box to select a file format and save the document to a new location.","OfficeStringId.MenuCmd_SaveDocumentDescription":"Save the document.","OfficeStringId.MenuCmd_ShowPasteSpecialForm":"Paste Special","OfficeStringId.MenuCmd_ShowPasteSpecialFormDescription":"Show the Paste Special dialog box.","OfficeStringId.MenuCmd_StatusBarPopupMenuHeader":"Customize Status Bar","OfficeStringId.MenuCmd_StatusBarPopupMenuZoom":"Zoom","OfficeStringId.MenuCmd_StatusBarPopupMenuZoomSlider":"Zoom Slider","OfficeStringId.MenuCmd_StatusBarZoomDescription":"Zoom level. Click to open the Zoom dialog box.","OfficeStringId.MenuCmd_StatusBarZoomSliderDescription":"Zoom","OfficeStringId.MenuCmd_ToggleFontBold":"Bold","OfficeStringId.MenuCmd_ToggleFontBoldDescription":"Make the selected text bold.","OfficeStringId.MenuCmd_ToggleFontDoubleUnderline":"Double Underline","OfficeStringId.MenuCmd_ToggleFontDoubleUnderlineDescription":"Double underline","OfficeStringId.MenuCmd_ToggleFontItalic":"Italic","OfficeStringId.MenuCmd_ToggleFontItalicDescription":"Italicize the selected text.","OfficeStringId.MenuCmd_ToggleFontStrikeout":"Strikethrough","OfficeStringId.MenuCmd_ToggleFontStrikeoutDescription":"Draw a line through the middle of the selected text.","OfficeStringId.MenuCmd_ToggleFontUnderline":"Underline","OfficeStringId.MenuCmd_ToggleFontUnderlineDescription":"Underline the selected text.","OfficeStringId.MenuCmd_Undo":"Undo","OfficeStringId.MenuCmd_UndoDescription":"Undo","OfficeStringId.MenuCmd_Zoom100Percent":"100%","OfficeStringId.MenuCmd_Zoom100PercentDescription":"Zoom the document to 100% of the normal size.","OfficeStringId.MenuCmd_ZoomIn":"Zoom In","OfficeStringId.MenuCmd_ZoomInDescription":"Zoom In","OfficeStringId.MenuCmd_ZoomOut":"Zoom Out","OfficeStringId.MenuCmd_ZoomOutDescription":"Zoom Out","OfficeStringId.Msg_InternalError":"An internal error occurred","OfficeStringId.Msg_InvalidBeginInit":"Error: call to BeginInit inside BeginUpdate","OfficeStringId.Msg_InvalidBeginUpdate":"Error: call to BeginUpdate inside BeginInit","OfficeStringId.Msg_InvalidCopyFromDocumentModel":"Error: source and destination document models are different","OfficeStringId.Msg_InvalidEndInit":"Error: call to EndInit or CancelInit without BeginInit or inside BeginUpdate","OfficeStringId.Msg_InvalidEndUpdate":"Error: call to EndUpdate or CancelUpate without BeginUpdate or inside BeginInit","OfficeStringId.Msg_InvalidFontSize":"The number must be between {0} and {1}.","OfficeStringId.Msg_InvalidNumber":"This is not a valid number.","OfficeStringId.Msg_InvalidNumberConverterValue":"Value must be between {0} and {1}.","OfficeStringId.Msg_InvalidRemoveDataSource":"A data source cannot be deleted during the mail-merge process.","OfficeStringId.Msg_IsNotValid":"'{0}' is not a valid value for '{1}'","OfficeStringId.Msg_Loading":"Loading...","OfficeStringId.Msg_MagicNumberNotFound":"The file you are trying to open is in different format than specified by the file extension.","OfficeStringId.Msg_UnsupportedFormatOrCorruptedFile":"Unsupported format or corrupted file.","OfficeStringId.UnitAbbreviation_Centimeter":" cm","OfficeStringId.UnitAbbreviation_Inch":'"',"OfficeStringId.UnitAbbreviation_Millimeter":" mm","OfficeStringId.UnitAbbreviation_Percent":"%","OfficeStringId.UnitAbbreviation_Pica":" pc","OfficeStringId.UnitAbbreviation_Point":" pt","XtraRichEditStringId.BorderLineStyleNone":"None","XtraRichEditStringId.Caption_AlignmentCenter":"Centered","XtraRichEditStringId.Caption_AlignmentDistribute":"Distributed","XtraRichEditStringId.Caption_AlignmentJustify":"Justified","XtraRichEditStringId.Caption_AlignmentJustifyHigh":"Justify High","XtraRichEditStringId.Caption_AlignmentJustifyLow":"Justify Low","XtraRichEditStringId.Caption_AlignmentJustifyMedium":"Justify Medium","XtraRichEditStringId.Caption_AlignmentLeft":"Left","XtraRichEditStringId.Caption_AlignmentRight":"Right","XtraRichEditStringId.Caption_AlignmentThaiDistribute":"Thai Distributed","XtraRichEditStringId.Caption_BulletsAndNumbering_Nothing":"Nothing","XtraRichEditStringId.Caption_BulletsAndNumbering_SpaceCharacter":"Space","XtraRichEditStringId.Caption_BulletsAndNumbering_TabCharacter":"Tab character","XtraRichEditStringId.Caption_Bytes":"bytes","XtraRichEditStringId.Caption_CaptionPrefixEquation":"Equation","XtraRichEditStringId.Caption_CaptionPrefixFigure":"Figure","XtraRichEditStringId.Caption_CaptionPrefixTable":"Table","XtraRichEditStringId.Caption_ClipboardSubItem":"Clipboard","XtraRichEditStringId.Caption_ColorAutomatic":"Automatic","XtraRichEditStringId.Caption_ColumnBreak":"Column Break","XtraRichEditStringId.Caption_Comments":"Comments","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_BottomLeftCell":"Bottom left cell","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_BottomRightCell":"Bottom right cell","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_EvenColumnBanding":"Even banded columns","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_EvenRowBanding":"Even banded rows","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_FirstColumn":"First column","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_FirstRow":"Header row","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_LastColumn":"Last column","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_LastRow":"Total row","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_OddColumnBanding":"Odd banded columns","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_OddRowBanding":"Odd banded rows","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_TopLeftCell":"Top left cell","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_TopRightCell":"Top right cell","XtraRichEditStringId.Caption_ConditionalTableStyleFormattingTypes_WholeTable":"Whole table","XtraRichEditStringId.Caption_CurrentDocumentHyperlinkTooltip":"Current Document","XtraRichEditStringId.Caption_CurrentParagraphText":"Sample Text ","XtraRichEditStringId.Caption_CustomPropertyCheckedBy":"Checked by","XtraRichEditStringId.Caption_CustomPropertyClient":"Client","XtraRichEditStringId.Caption_CustomPropertyDateCompleted":"Date completed","XtraRichEditStringId.Caption_CustomPropertyDepartment":"Department","XtraRichEditStringId.Caption_CustomPropertyDestination":"Destination","XtraRichEditStringId.Caption_CustomPropertyDisposition":"Disposition","XtraRichEditStringId.Caption_CustomPropertyDivision":"Division","XtraRichEditStringId.Caption_CustomPropertyDocumentNumber":"Document number","XtraRichEditStringId.Caption_CustomPropertyEditor":"Editor","XtraRichEditStringId.Caption_CustomPropertyForwardTo":"Forward to","XtraRichEditStringId.Caption_CustomPropertyGroup":"Group","XtraRichEditStringId.Caption_CustomPropertyLanguage":"Language","XtraRichEditStringId.Caption_CustomPropertyMailstop":"Mailstop","XtraRichEditStringId.Caption_CustomPropertyMatter":"Matter","XtraRichEditStringId.Caption_CustomPropertyNo":"No","XtraRichEditStringId.Caption_CustomPropertyOffice":"Office","XtraRichEditStringId.Caption_CustomPropertyOwner":"Owner","XtraRichEditStringId.Caption_CustomPropertyProject":"Project","XtraRichEditStringId.Caption_CustomPropertyPublisher":"Publisher","XtraRichEditStringId.Caption_CustomPropertyPurpose":"Purpose","XtraRichEditStringId.Caption_CustomPropertyReceivedFrom":"Received from","XtraRichEditStringId.Caption_CustomPropertyRecordedBy":"Recorded by","XtraRichEditStringId.Caption_CustomPropertyRecordedDate":"Recorded date","XtraRichEditStringId.Caption_CustomPropertyReference":"Reference","XtraRichEditStringId.Caption_CustomPropertySource":"Source","XtraRichEditStringId.Caption_CustomPropertyStatus":"Status","XtraRichEditStringId.Caption_CustomPropertyTelephoneNumber":"Telephone number","XtraRichEditStringId.Caption_CustomPropertyTypeBoolean":"Yes or no","XtraRichEditStringId.Caption_CustomPropertyTypeDateTime":"Date","XtraRichEditStringId.Caption_CustomPropertyTypeNumber":"Number","XtraRichEditStringId.Caption_CustomPropertyTypeText":"Text","XtraRichEditStringId.Caption_CustomPropertyTypist":"Typist","XtraRichEditStringId.Caption_CustomPropertyValue":"Value","XtraRichEditStringId.Caption_CustomPropertyYes":"Yes","XtraRichEditStringId.Caption_EmptyParentStyle":"(underlying properties)","XtraRichEditStringId.Caption_EvenPageFooter":"Even Page Footer","XtraRichEditStringId.Caption_EvenPageHeader":"Even Page Header","XtraRichEditStringId.Caption_FirstLineIndentHanging":"Hanging","XtraRichEditStringId.Caption_FirstLineIndentIndented":"First line","XtraRichEditStringId.Caption_FirstLineIndentNone":"(none)","XtraRichEditStringId.Caption_FirstPageFooter":"First Page Footer","XtraRichEditStringId.Caption_FirstPageHeader":"First Page Header","XtraRichEditStringId.Caption_FollowingParagraphText":"Following Paragraph ","XtraRichEditStringId.Caption_GroupTableAlignment":"Alignment","XtraRichEditStringId.Caption_GroupTableCellSize":"Cell Size","XtraRichEditStringId.Caption_GroupTableDrawBorders":"Borders  Shadings","XtraRichEditStringId.Caption_GroupTableMerge":"Merge","XtraRichEditStringId.Caption_GroupTableRowsAndColumns":"Rows  Columns","XtraRichEditStringId.Caption_GroupTableStyleOptions":"Table Style Options","XtraRichEditStringId.Caption_GroupTableStyles":"Table Styles","XtraRichEditStringId.Caption_GroupTableTable":"Table","XtraRichEditStringId.Caption_Heading":"Heading","XtraRichEditStringId.Caption_HeightTypeExact":"Exactly","XtraRichEditStringId.Caption_HeightTypeMinimum":"At least","XtraRichEditStringId.Caption_LineSpacingAtLeast":"At least","XtraRichEditStringId.Caption_LineSpacingDouble":"Double","XtraRichEditStringId.Caption_LineSpacingExactly":"Exactly","XtraRichEditStringId.Caption_LineSpacingMultiple":"Multiple","XtraRichEditStringId.Caption_LineSpacingSesquialteral":"1.5 lines","XtraRichEditStringId.Caption_LineSpacingSingle":"Single","XtraRichEditStringId.Caption_MainDocumentComments":"Main document comments","XtraRichEditStringId.Caption_NoColor":"No Color","XtraRichEditStringId.Caption_NumberingListBoxNone":"None","XtraRichEditStringId.Caption_OddPageFooter":"Odd Page Footer","XtraRichEditStringId.Caption_OddPageHeader":"Odd Page Header","XtraRichEditStringId.Caption_OutlineLevel1":"Level 1","XtraRichEditStringId.Caption_OutlineLevel2":"Level 2","XtraRichEditStringId.Caption_OutlineLevel3":"Level 3","XtraRichEditStringId.Caption_OutlineLevel4":"Level 4","XtraRichEditStringId.Caption_OutlineLevel5":"Level 5","XtraRichEditStringId.Caption_OutlineLevel6":"Level 6","XtraRichEditStringId.Caption_OutlineLevel7":"Level 7","XtraRichEditStringId.Caption_OutlineLevel8":"Level 8","XtraRichEditStringId.Caption_OutlineLevel9":"Level 9","XtraRichEditStringId.Caption_OutlineLevelBody":"Body Text","XtraRichEditStringId.Caption_PageBreak":"Page Break","XtraRichEditStringId.Caption_PageCategoryTableTools":"Table Tools","XtraRichEditStringId.Caption_PageFooter":"Footer","XtraRichEditStringId.Caption_PageHeader":"Header","XtraRichEditStringId.Caption_PageSetupSectionDirectionLeftToRight":"Left-to-right","XtraRichEditStringId.Caption_PageSetupSectionDirectionRightToLeft":"Right-to-left","XtraRichEditStringId.Caption_PageSetupSectionStartColumn":"New column","XtraRichEditStringId.Caption_PageSetupSectionStartContinuous":"Continuous","XtraRichEditStringId.Caption_PageSetupSectionStartEvenPage":"Even page","XtraRichEditStringId.Caption_PageSetupSectionStartNextPage":"New page","XtraRichEditStringId.Caption_PageSetupSectionStartOddPage":"Odd page","XtraRichEditStringId.Caption_PageTableDesign":"Design","XtraRichEditStringId.Caption_PageTableLayout":"Layout","XtraRichEditStringId.Caption_ParagraphAlignment_Center":"Center","XtraRichEditStringId.Caption_ParagraphAlignment_Distribute":"Distributed","XtraRichEditStringId.Caption_ParagraphAlignment_Justify":"Justify","XtraRichEditStringId.Caption_ParagraphAlignment_JustifyHigh":"Justify High","XtraRichEditStringId.Caption_ParagraphAlignment_JustifyLow":"Justify Low","XtraRichEditStringId.Caption_ParagraphAlignment_JustifyMedium":"Justify Medium","XtraRichEditStringId.Caption_ParagraphAlignment_Left":"Left","XtraRichEditStringId.Caption_ParagraphAlignment_Right":"Right","XtraRichEditStringId.Caption_ParagraphAlignment_ThaiDistribute":"Thai Distributed","XtraRichEditStringId.Caption_ParagraphFirstLineIndent_Hanging":"Hanging","XtraRichEditStringId.Caption_ParagraphFirstLineIndent_Indented":"Indented","XtraRichEditStringId.Caption_ParagraphFirstLineIndent_None":"None","XtraRichEditStringId.Caption_ParagraphLineSpacing_AtLeast":"At Least","XtraRichEditStringId.Caption_ParagraphLineSpacing_Double":"Double","XtraRichEditStringId.Caption_ParagraphLineSpacing_Exactly":"Exactly","XtraRichEditStringId.Caption_ParagraphLineSpacing_Multiple":"Multiple","XtraRichEditStringId.Caption_ParagraphLineSpacing_Sesquialteral":"Sesquialteral","XtraRichEditStringId.Caption_ParagraphLineSpacing_Single":"Single","XtraRichEditStringId.Caption_PreviousParagraphText":"Previous Paragraph ","XtraRichEditStringId.Caption_Readonly":"No changes (Read only)","XtraRichEditStringId.Caption_SameAsPrevious":"Same as Previous","XtraRichEditStringId.Caption_SectionBreak":"Section Break","XtraRichEditStringId.Caption_SectionBreakTypeColumn":"Column","XtraRichEditStringId.Caption_SectionBreakTypeContinuous":"Continuous","XtraRichEditStringId.Caption_SectionBreakTypeEvenPage":"Even Page","XtraRichEditStringId.Caption_SectionBreakTypeNextPage":"Next Page","XtraRichEditStringId.Caption_SectionBreakTypeOddPage":"Odd Page","XtraRichEditStringId.Caption_SectionPropertiesApplyThisPointForward":"This point forward","XtraRichEditStringId.Caption_SectionPropertiesApplyToCurrentSection":"Current section","XtraRichEditStringId.Caption_SectionPropertiesApplyToSelectedSections":"Selected sections","XtraRichEditStringId.Caption_SectionPropertiesApplyToWholeDocument":"Whole document","XtraRichEditStringId.ClearFormatting":"Clear Formatting","XtraRichEditStringId.ColorAuto":"Auto","XtraRichEditStringId.ColumnsSetupForm_InvalidColumnCount":"The number must be between {0} and {1}.","XtraRichEditStringId.Comment":"Comment [{0} {1}]","XtraRichEditStringId.CommentToolTipHeader":"by {0}","XtraRichEditStringId.CommentToolTipHeaderWithDate":"{0} from {1}","XtraRichEditStringId.DefaultDocumentName":"Document","XtraRichEditStringId.DefaultStyleName_annotationreference":"annotation reference","XtraRichEditStringId.DefaultStyleName_annotationsubject":"annotation subject","XtraRichEditStringId.DefaultStyleName_annotationtext":"annotation text","XtraRichEditStringId.DefaultStyleName_ArticleSection":"Article / Section","XtraRichEditStringId.DefaultStyleName_BalloonText":"Balloon Text","XtraRichEditStringId.DefaultStyleName_BlockText":"Block Text","XtraRichEditStringId.DefaultStyleName_BodyText":"Body Text","XtraRichEditStringId.DefaultStyleName_BodyText2":"Body Text 2","XtraRichEditStringId.DefaultStyleName_BodyText3":"Body Text 3","XtraRichEditStringId.DefaultStyleName_BodyTextFirstIndent":"Body Text First Indent","XtraRichEditStringId.DefaultStyleName_BodyTextFirstIndent2":"Body Text First Indent 2","XtraRichEditStringId.DefaultStyleName_BodyTextIndent":"Body Text Indent","XtraRichEditStringId.DefaultStyleName_BodyTextIndent2":"Body Text Indent 2","XtraRichEditStringId.DefaultStyleName_BodyTextIndent3":"Body Text Indent 3","XtraRichEditStringId.DefaultStyleName_caption":"Caption","XtraRichEditStringId.DefaultStyleName_Closing":"Closing","XtraRichEditStringId.DefaultStyleName_CommentReference":"Comment Reference","XtraRichEditStringId.DefaultStyleName_CommentSubject":"Comment Subject","XtraRichEditStringId.DefaultStyleName_CommentText":"Comment Text","XtraRichEditStringId.DefaultStyleName_Date":"Date","XtraRichEditStringId.DefaultStyleName_DefaultParagraphFont":"Default Paragraph Font","XtraRichEditStringId.DefaultStyleName_DocumentMap":"Document Map","XtraRichEditStringId.DefaultStyleName_EmailSignature":"E-mail Signature","XtraRichEditStringId.DefaultStyleName_Emphasis":"Emphasis","XtraRichEditStringId.DefaultStyleName_endnotereference":"Endnote Reference","XtraRichEditStringId.DefaultStyleName_endnotetext":"Endnote Text","XtraRichEditStringId.DefaultStyleName_envelopeaddress":"Envelope Address","XtraRichEditStringId.DefaultStyleName_envelopereturn":"Envelope Return","XtraRichEditStringId.DefaultStyleName_FollowedHyperlink":"FollowedHyperlink","XtraRichEditStringId.DefaultStyleName_footer":"Footer","XtraRichEditStringId.DefaultStyleName_footnotereference":"Footnote Reference","XtraRichEditStringId.DefaultStyleName_footnotetext":"Footnote Text","XtraRichEditStringId.DefaultStyleName_header":"Header","XtraRichEditStringId.DefaultStyleName_heading1":"Heading 1","XtraRichEditStringId.DefaultStyleName_heading2":"Heading 2","XtraRichEditStringId.DefaultStyleName_heading3":"Heading 3","XtraRichEditStringId.DefaultStyleName_heading4":"Heading 4","XtraRichEditStringId.DefaultStyleName_heading5":"Heading 5","XtraRichEditStringId.DefaultStyleName_heading6":"Heading 6","XtraRichEditStringId.DefaultStyleName_heading7":"Heading 7","XtraRichEditStringId.DefaultStyleName_heading8":"Heading 8","XtraRichEditStringId.DefaultStyleName_heading9":"Heading 9","XtraRichEditStringId.DefaultStyleName_HTMLAcronym":"HTML Acronym","XtraRichEditStringId.DefaultStyleName_HTMLAddress":"HTML Address","XtraRichEditStringId.DefaultStyleName_HTMLBottomofForm":"HTML Bottom of Form","XtraRichEditStringId.DefaultStyleName_HTMLCite":"HTML Cite","XtraRichEditStringId.DefaultStyleName_HTMLCode":"HTML Code","XtraRichEditStringId.DefaultStyleName_HTMLDefinition":"HTML Definition","XtraRichEditStringId.DefaultStyleName_HTMLKeyboard":"HTML Keyboard","XtraRichEditStringId.DefaultStyleName_HTMLPreformatted":"HTML Preformatted","XtraRichEditStringId.DefaultStyleName_HTMLSample":"HTML Sample","XtraRichEditStringId.DefaultStyleName_HTMLTopofForm":"HTML Top of Form","XtraRichEditStringId.DefaultStyleName_HTMLTypewriter":"HTML Typewriter","XtraRichEditStringId.DefaultStyleName_HTMLVariable":"HTML Variable","XtraRichEditStringId.DefaultStyleName_HyperlinkFollowed":"HyperlinkFollowed","XtraRichEditStringId.DefaultStyleName_HyperlinkStrongEmphasis":"HyperlinkStrongEmphasis","XtraRichEditStringId.DefaultStyleName_index1":"Index 1","XtraRichEditStringId.DefaultStyleName_index2":"Index 2","XtraRichEditStringId.DefaultStyleName_index3":"Index 3","XtraRichEditStringId.DefaultStyleName_index4":"Index 4","XtraRichEditStringId.DefaultStyleName_index5":"Index 5","XtraRichEditStringId.DefaultStyleName_index6":"Index 6","XtraRichEditStringId.DefaultStyleName_index7":"Index 7","XtraRichEditStringId.DefaultStyleName_index8":"Index 8","XtraRichEditStringId.DefaultStyleName_index9":"Index 9","XtraRichEditStringId.DefaultStyleName_indexheading":"Index Heading","XtraRichEditStringId.DefaultStyleName_linenumber":"Line Number","XtraRichEditStringId.DefaultStyleName_List":"List","XtraRichEditStringId.DefaultStyleName_List2":"List 2","XtraRichEditStringId.DefaultStyleName_List3":"List 3","XtraRichEditStringId.DefaultStyleName_List4":"List 4","XtraRichEditStringId.DefaultStyleName_List5":"List 5","XtraRichEditStringId.DefaultStyleName_ListBullet":"List Bullet","XtraRichEditStringId.DefaultStyleName_ListBullet2":"List Bullet 2","XtraRichEditStringId.DefaultStyleName_ListBullet3":"List Bullet 3","XtraRichEditStringId.DefaultStyleName_ListBullet4":"List Bullet 4","XtraRichEditStringId.DefaultStyleName_ListBullet5":"List Bullet 5","XtraRichEditStringId.DefaultStyleName_ListContinue":"List Continue","XtraRichEditStringId.DefaultStyleName_ListContinue2":"List Continue 2","XtraRichEditStringId.DefaultStyleName_ListContinue3":"List Continue 3","XtraRichEditStringId.DefaultStyleName_ListContinue4":"List Continue 4","XtraRichEditStringId.DefaultStyleName_ListContinue5":"List Continue 5","XtraRichEditStringId.DefaultStyleName_ListNumber":"List Number","XtraRichEditStringId.DefaultStyleName_ListNumber2":"List Number 2","XtraRichEditStringId.DefaultStyleName_ListNumber3":"List Number 3","XtraRichEditStringId.DefaultStyleName_ListNumber4":"List Number 4","XtraRichEditStringId.DefaultStyleName_ListNumber5":"List Number 5","XtraRichEditStringId.DefaultStyleName_MacroText":"Macro Text","XtraRichEditStringId.DefaultStyleName_macrotoaheading":"macro to a heading","XtraRichEditStringId.DefaultStyleName_MessageHeader":"Message Header","XtraRichEditStringId.DefaultStyleName_NoList":"No List","XtraRichEditStringId.DefaultStyleName_Normal":"Normal","XtraRichEditStringId.DefaultStyleName_NormalIndent":"Normal Indent","XtraRichEditStringId.DefaultStyleName_NormalTable":"Normal Table","XtraRichEditStringId.DefaultStyleName_NormalWeb":"Normal (Web)","XtraRichEditStringId.DefaultStyleName_NoteHeading":"Note Heading","XtraRichEditStringId.DefaultStyleName_OutlineList1":"Outline List 1","XtraRichEditStringId.DefaultStyleName_OutlineList2":"Outline List 2","XtraRichEditStringId.DefaultStyleName_OutlineList3":"Outline List 3","XtraRichEditStringId.DefaultStyleName_pagenumber":"Page Number","XtraRichEditStringId.DefaultStyleName_PlainText":"Plain Text","XtraRichEditStringId.DefaultStyleName_Salutation":"Salutation","XtraRichEditStringId.DefaultStyleName_Signature":"Signature","XtraRichEditStringId.DefaultStyleName_Strong":"Strong","XtraRichEditStringId.DefaultStyleName_Subtitle":"Subtitle","XtraRichEditStringId.DefaultStyleName_Table3Deffects1":"Table 3D effects 1","XtraRichEditStringId.DefaultStyleName_Table3Deffects2":"Table 3D effects 2","XtraRichEditStringId.DefaultStyleName_Table3Deffects3":"Table 3D effects 3","XtraRichEditStringId.DefaultStyleName_TableClassic1":"Table Classic 1","XtraRichEditStringId.DefaultStyleName_TableClassic2":"Table Classic 2","XtraRichEditStringId.DefaultStyleName_TableClassic3":"Table Classic 3","XtraRichEditStringId.DefaultStyleName_TableClassic4":"Table Classic 4","XtraRichEditStringId.DefaultStyleName_TableColorful1":"Table Colorful 1","XtraRichEditStringId.DefaultStyleName_TableColorful2":"Table Colorful 2","XtraRichEditStringId.DefaultStyleName_TableColorful3":"Table Colorful 3","XtraRichEditStringId.DefaultStyleName_TableColumns1":"Table Columns 1","XtraRichEditStringId.DefaultStyleName_TableColumns2":"Table Columns 2","XtraRichEditStringId.DefaultStyleName_TableColumns3":"Table Columns 3","XtraRichEditStringId.DefaultStyleName_TableColumns4":"Table Columns 4","XtraRichEditStringId.DefaultStyleName_TableColumns5":"Table Columns 5","XtraRichEditStringId.DefaultStyleName_TableContemporary":"Table Contemporary","XtraRichEditStringId.DefaultStyleName_TableElegant":"Table Elegant","XtraRichEditStringId.DefaultStyleName_TableGrid":"Table Grid","XtraRichEditStringId.DefaultStyleName_TableGrid1":"Table Grid 1","XtraRichEditStringId.DefaultStyleName_TableGrid2":"Table Grid 2","XtraRichEditStringId.DefaultStyleName_TableGrid3":"Table Grid 3","XtraRichEditStringId.DefaultStyleName_TableGrid4":"Table Grid 4","XtraRichEditStringId.DefaultStyleName_TableGrid5":"Table Grid 5","XtraRichEditStringId.DefaultStyleName_TableGrid6":"Table Grid 6","XtraRichEditStringId.DefaultStyleName_TableGrid7":"Table Grid 7","XtraRichEditStringId.DefaultStyleName_TableGrid8":"Table Grid 8","XtraRichEditStringId.DefaultStyleName_TableList1":"Table List 1","XtraRichEditStringId.DefaultStyleName_TableList2":"Table List 2","XtraRichEditStringId.DefaultStyleName_TableList3":"Table List 3","XtraRichEditStringId.DefaultStyleName_TableList4":"Table List 4","XtraRichEditStringId.DefaultStyleName_TableList5":"Table List 5","XtraRichEditStringId.DefaultStyleName_TableList6":"Table List 6","XtraRichEditStringId.DefaultStyleName_TableList7":"Table List 7","XtraRichEditStringId.DefaultStyleName_TableList8":"Table List 8","XtraRichEditStringId.DefaultStyleName_TableNormal":"Table Normal","XtraRichEditStringId.DefaultStyleName_tableofauthorities":"Table of Authorities","XtraRichEditStringId.DefaultStyleName_tableoffigures":"Table of Figures","XtraRichEditStringId.DefaultStyleName_TableProfessional":"Table Professional","XtraRichEditStringId.DefaultStyleName_TableSimple1":"Table Simple 1","XtraRichEditStringId.DefaultStyleName_TableSimple2":"Table Simple 2","XtraRichEditStringId.DefaultStyleName_TableSimple3":"Table Simple 3","XtraRichEditStringId.DefaultStyleName_TableSubtle1":"Table Subtle 1","XtraRichEditStringId.DefaultStyleName_TableSubtle2":"Table Subtle 2","XtraRichEditStringId.DefaultStyleName_TableTheme":"Table Theme","XtraRichEditStringId.DefaultStyleName_TableWeb1":"Table Web 1","XtraRichEditStringId.DefaultStyleName_TableWeb2":"Table Web 2","XtraRichEditStringId.DefaultStyleName_TableWeb3":"Table Web 3","XtraRichEditStringId.DefaultStyleName_Title":"Title","XtraRichEditStringId.DefaultStyleName_toaheading":"TOA Heading","XtraRichEditStringId.DefaultStyleName_toc1":"TOC 1","XtraRichEditStringId.DefaultStyleName_toc2":"TOC 2","XtraRichEditStringId.DefaultStyleName_toc3":"TOC 3","XtraRichEditStringId.DefaultStyleName_toc4":"TOC 4","XtraRichEditStringId.DefaultStyleName_toc5":"TOC 5","XtraRichEditStringId.DefaultStyleName_toc6":"TOC 6","XtraRichEditStringId.DefaultStyleName_toc7":"TOC 7","XtraRichEditStringId.DefaultStyleName_toc8":"TOC 8","XtraRichEditStringId.DefaultStyleName_toc9":"TOC 9","XtraRichEditStringId.DialogCaption_InsertSymbol":"Symbol","XtraRichEditStringId.FieldLastName":"Last Name","XtraRichEditStringId.FieldMapAddress1":"Address 1","XtraRichEditStringId.FieldMapAddress2":"Address 2","XtraRichEditStringId.FieldMapAddress3":"Address 3","XtraRichEditStringId.FieldMapBusinessFax":"Business Fax","XtraRichEditStringId.FieldMapBusinessPhone":"Business Phone","XtraRichEditStringId.FieldMapCity":"City","XtraRichEditStringId.FieldMapCompany":"Company","XtraRichEditStringId.FieldMapCountry":"Country or Region","XtraRichEditStringId.FieldMapDepartment":"Department","XtraRichEditStringId.FieldMapEMailAddress":"E-mail Address","XtraRichEditStringId.FieldMapFirstName":"First Name","XtraRichEditStringId.FieldMapHomeFax":"Home Fax","XtraRichEditStringId.FieldMapHomePhone":"Home Phone","XtraRichEditStringId.FieldMapJobTitle":"Job Title","XtraRichEditStringId.FieldMapMiddleName":"Middle Name","XtraRichEditStringId.FieldMapNickName":"Nickname","XtraRichEditStringId.FieldMapPartnerFirstName":"Spouse/Partner First Name","XtraRichEditStringId.FieldMapPartnerLastName":"Spouse/Partner Last Name","XtraRichEditStringId.FieldMapPartnerMiddleName":"Spouse/Partner Middle Name","XtraRichEditStringId.FieldMapPartnerNickName":"Spouse/Partner Nickname","XtraRichEditStringId.FieldMapPartnerTitle":"Spouse/Partner Courtesy Title","XtraRichEditStringId.FieldMapPhoneticGuideFirstName":"Phonetic Guide for First Name","XtraRichEditStringId.FieldMapPhoneticGuideLastName":"Phonetic Guide for Last Name","XtraRichEditStringId.FieldMapPostalCode":"Postal Code","XtraRichEditStringId.FieldMapState":"State","XtraRichEditStringId.FieldMapSuffix":"Suffix","XtraRichEditStringId.FieldMapTitle":"Courtesy Title","XtraRichEditStringId.FieldMapUniqueId":"Unique Identifier","XtraRichEditStringId.FieldMapWebPage":"Web Page","XtraRichEditStringId.FileFilterDescription_AllFiles":"All Files","XtraRichEditStringId.FileFilterDescription_AllSupportedFiles":"All Supported Files","XtraRichEditStringId.FileFilterDescription_BitmapFiles":"Bitmap","XtraRichEditStringId.FileFilterDescription_DocFiles":"Microsoft Word Document","XtraRichEditStringId.FileFilterDescription_EmfFiles":"Microsoft Enhanced Metafile","XtraRichEditStringId.FileFilterDescription_ePubFiles":"Electronic Publication","XtraRichEditStringId.FileFilterDescription_GifFiles":"Graphics Interchange Format","XtraRichEditStringId.FileFilterDescription_HtmlFiles":"HyperText Markup Language Format","XtraRichEditStringId.FileFilterDescription_JPEGFiles":"JPEG File Interchange Format","XtraRichEditStringId.FileFilterDescription_MhtFiles":"Web Archive, single file","XtraRichEditStringId.FileFilterDescription_OpenDocumentFiles":"OpenDocument Text Document","XtraRichEditStringId.FileFilterDescription_OpenXmlFiles":"Word 2007 Document","XtraRichEditStringId.FileFilterDescription_PDFFiles":"Portable Document Format","XtraRichEditStringId.FileFilterDescription_PNGFiles":"Portable Network Graphics","XtraRichEditStringId.FileFilterDescription_RtfFiles":"Rich Text Format","XtraRichEditStringId.FileFilterDescription_TextFiles":"Text Files","XtraRichEditStringId.FileFilterDescription_TiffFiles":"Tagged Image Format","XtraRichEditStringId.FileFilterDescription_WmfFiles":"Windows Metafile","XtraRichEditStringId.FileFilterDescription_WordMLFiles":"Word 2003 XML Document","XtraRichEditStringId.FileFilterDescription_XamlFiles":"Xaml Document","XtraRichEditStringId.FindAndReplaceForm_AnyOneCharacterInTheSet":"Any one character in the set","XtraRichEditStringId.FindAndReplaceForm_AnyOneCharacterNotInTheSet":"Any one character not in the set","XtraRichEditStringId.FindAndReplaceForm_AnySingleCharacter":"Any single character","XtraRichEditStringId.FindAndReplaceForm_BeginningOfLine":"Beginning of paragraph","XtraRichEditStringId.FindAndReplaceForm_BeginningOfWord":"Beginning of word","XtraRichEditStringId.FindAndReplaceForm_EndOfLine":"End of paragraph","XtraRichEditStringId.FindAndReplaceForm_EndOfWord":"End of word","XtraRichEditStringId.FindAndReplaceForm_EscapeSpecialCharacter":"Escape special character","XtraRichEditStringId.FindAndReplaceForm_Integer":"Integer","XtraRichEditStringId.FindAndReplaceForm_OneOrMore":"One or more","XtraRichEditStringId.FindAndReplaceForm_Or":"Or","XtraRichEditStringId.FindAndReplaceForm_SpaceOrTab":"Space or tab","XtraRichEditStringId.FindAndReplaceForm_TagExpression":"Tag expression","XtraRichEditStringId.FindAndReplaceForm_TaggedExpression":"Tagged expression {0}","XtraRichEditStringId.FindAndReplaceForm_WordCharacter":"Word character","XtraRichEditStringId.FindAndReplaceForm_ZeroOrMore":"Zero or more","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionAlignmentCenter":"Centered","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionAlignmentLeft":"Left","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionAlignmentRight":"Right","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypeCharacter":"Character","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypeColumn":"Column","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypeInsideMargin":"Inside Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypeLeftMargin":"Left Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypeMargin":"Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypeOutsideMargin":"Outside Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypePage":"Page","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypeRightMargin":"Right Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionAlignmentBottom":"Bottom","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionAlignmentCenter":"Center","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionAlignmentInside":"Inside","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionAlignmentOutside":"Outside","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionAlignmentTop":"Top","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionTypeBottomMargin":"Bottom Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionTypeInsideMargin":"Inside Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionTypeLine":"Line","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionTypeMargin":"Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionTypeOutsideMargin":"Outside Margin","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionTypePage":"Page","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionTypeParagraph":"Paragraph","XtraRichEditStringId.FloatingObjectLayoutOptionsForm_VerticalPositionTypeTopMargin":"Top Margin","XtraRichEditStringId.FontStyle_Bold":"Bold","XtraRichEditStringId.FontStyle_BoldItalic":"Bold Italic","XtraRichEditStringId.FontStyle_Italic":"Italic","XtraRichEditStringId.FontStyle_Regular":"Regular","XtraRichEditStringId.FontStyle_Strikeout":"Strikeout","XtraRichEditStringId.FontStyle_Underline":"Underline","XtraRichEditStringId.HyperlinkForm_EditHyperlinkTitle":"Edit Hyperlink","XtraRichEditStringId.HyperlinkForm_InsertHyperlinkTitle":"Insert Hyperlink","XtraRichEditStringId.HyperlinkForm_SelectedBookmarkNone":"&lt;None&gt;","XtraRichEditStringId.HyperlinkForm_SelectionInDocument":"Selection in document","XtraRichEditStringId.InsertTableForm_InvalidColumnCount":"The number must be between {0} and {1}.","XtraRichEditStringId.InsertTableForm_InvalidRowCount":"The number must be between {0} and {1}.","XtraRichEditStringId.KeyName_Alt":"Alt","XtraRichEditStringId.KeyName_Control":"Ctrl","XtraRichEditStringId.KeyName_Shift":"Shift","XtraRichEditStringId.LinkedCharacterStyleFormatString":"{0} Char","XtraRichEditStringId.LocalizedStyleName_Hyperlink":"Hyperlink","XtraRichEditStringId.LocalizedStyleName_Normal":"Normal","XtraRichEditStringId.MenuCmd_AddParagraphsToTableOfContents":"Add Text","XtraRichEditStringId.MenuCmd_AddParagraphsToTableOfContentsDescription":"Add the current paragraph as an entry in the Table of Contents.","XtraRichEditStringId.MenuCmd_AddSpacingAfterParagraph":"Add Space After Paragraph","XtraRichEditStringId.MenuCmd_AddSpacingAfterParagraphDescription":" ","XtraRichEditStringId.MenuCmd_AddSpacingBeforeParagraph":"Add Space Before Paragraph","XtraRichEditStringId.MenuCmd_AddSpacingBeforeParagraphDescription":" ","XtraRichEditStringId.MenuCmd_AddWordToDictionary":"Add to Dictionary","XtraRichEditStringId.MenuCmd_AddWordToDictionaryDescription":"Add to Dictionary","XtraRichEditStringId.MenuCmd_AllAuthors":"All Authors","XtraRichEditStringId.MenuCmd_BackSpaceKey":"BackSpaceKey","XtraRichEditStringId.MenuCmd_BackSpaceKeyDescription":"BackSpaceKey","XtraRichEditStringId.MenuCmd_Bookmark":"Bookmark...","XtraRichEditStringId.MenuCmd_BookmarkDescription":"Bookmark...","XtraRichEditStringId.MenuCmd_BrowserPrint":"Browser Print","XtraRichEditStringId.MenuCmd_BrowserPrintDescription":"Print document with browser print capabilities.","XtraRichEditStringId.MenuCmd_BrowserPrintPreview":"Browser Print Preview","XtraRichEditStringId.MenuCmd_BrowserPrintPreviewDescription":"Preview pages in browser before printing.","XtraRichEditStringId.MenuCmd_CapitalizeEachWordTextCase":"Capitalize Each Word","XtraRichEditStringId.MenuCmd_CapitalizeEachWordTextCaseDescription":"Capitalize each word.","XtraRichEditStringId.MenuCmd_ChangeCharacterStyle":"ChangeCharacterStyle","XtraRichEditStringId.MenuCmd_ChangeCharacterStyleDescription":"ChangeCharacterStyle","XtraRichEditStringId.MenuCmd_ChangeColumnCount":"Columns","XtraRichEditStringId.MenuCmd_ChangeColumnCountDescription":"Columns","XtraRichEditStringId.MenuCmd_ChangeColumnSize":"ChangeColumnSize","XtraRichEditStringId.MenuCmd_ChangeColumnSizeDescription":"ChangeColumnSizeDescription","XtraRichEditStringId.MenuCmd_ChangeCurrentBorderRepositoryItemColor":"Pen Color","XtraRichEditStringId.MenuCmd_ChangeCurrentBorderRepositoryItemColorDescription":"Change the pen color.","XtraRichEditStringId.MenuCmd_ChangeCurrentBorderRepositoryItemLineStyle":"Line Style","XtraRichEditStringId.MenuCmd_ChangeCurrentBorderRepositoryItemLineStyleDescription":"Change the style of the line used to draw borders.","XtraRichEditStringId.MenuCmd_ChangeCurrentBorderRepositoryItemLineThickness":"Line Weight","XtraRichEditStringId.MenuCmd_ChangeCurrentBorderRepositoryItemLineThicknessDescription":"Change the width of the line used to draw borders.","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectAlignment":"Position","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectAlignmentDescription":"Position the selected object on the page. Text is automatically set to wrap around the object.","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectFillColor":"Shape Fill","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectFillColorDescription":"Fill the selected shape with a solid color.","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectOutlineColor":"Shape Outline","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectOutlineColorDescription":"Specify color for the outline of the selected shape.","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectOutlineWidth":"Shape Outline Weight","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectOutlineWidthDescription":"Specify width for the outline of the selected shape.","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectTextWrapType":"Wrap Text","XtraRichEditStringId.MenuCmd_ChangeFontColor":"Font Color","XtraRichEditStringId.MenuCmd_ChangeFontColorDescription":"Change the font color.","XtraRichEditStringId.MenuCmd_ChangeFontName":"Font","XtraRichEditStringId.MenuCmd_ChangeFontNameDescription":"Change the font face.","XtraRichEditStringId.MenuCmd_ChangeFontSize":"Font Size","XtraRichEditStringId.MenuCmd_ChangeFontSizeDescription":"Change the font size.","XtraRichEditStringId.MenuCmd_ChangeHyphenationOptions":"Hyphenation","XtraRichEditStringId.MenuCmd_ChangeHyphenationOptionsDescription":"Turn on hyphenation to create more uniform spacing and save space in your document.","XtraRichEditStringId.MenuCmd_ChangeIndent":"ChangeIndent","XtraRichEditStringId.MenuCmd_ChangeIndentDescription":"ChangeIndentDescription","XtraRichEditStringId.MenuCmd_ChangeLanguage":"Language","XtraRichEditStringId.MenuCmd_ChangeLanguageDescription":"Set the language used to check the spelling and grammar of the selected text.","XtraRichEditStringId.MenuCmd_ChangeMistakenWord":"No spelling suggestions","XtraRichEditStringId.MenuCmd_ChangeMistakenWordDescription":"No spelling suggestions","XtraRichEditStringId.MenuCmd_ChangeNoProof":"NoProof","XtraRichEditStringId.MenuCmd_ChangeNoProofDescription":"Change NoProof","XtraRichEditStringId.MenuCmd_ChangePageColor":"Page Color","XtraRichEditStringId.MenuCmd_ChangePageColorDescription":"Choose a color for the background of the page.","XtraRichEditStringId.MenuCmd_ChangeParagraphBackColor":"Shading","XtraRichEditStringId.MenuCmd_ChangeParagraphBackColorDescription":"Change the background behind the selected paragraph.","XtraRichEditStringId.MenuCmd_ChangeParagraphFirstLineIndent":"IncrementParagraphFirstLineIndent","XtraRichEditStringId.MenuCmd_ChangeParagraphFirstLineIndentDescription":"IncrementParagraphFirstLineIndentDescription","XtraRichEditStringId.MenuCmd_ChangeParagraphLeftIndent":"ChangeParagraphLeftIndent","XtraRichEditStringId.MenuCmd_ChangeParagraphLeftIndentDescription":"ChangeParagraphLeftIndentDescription","XtraRichEditStringId.MenuCmd_ChangeParagraphLineSpacing":"Line Spacing","XtraRichEditStringId.MenuCmd_ChangeParagraphLineSpacingDescription":"Change the spacing between lines of text.You can also customize the amount of space added before and after paragraphs.","XtraRichEditStringId.MenuCmd_ChangeParagraphStyle":"ChangeParagraphStyle","XtraRichEditStringId.MenuCmd_ChangeParagraphStyleDescription":"ChangeParagraphStyle","XtraRichEditStringId.MenuCmd_ChangeSectionLineNumbering":"Line Numbers","XtraRichEditStringId.MenuCmd_ChangeSectionLineNumberingDescription":"Add line numbers in the margin alongside of each line of the document.","XtraRichEditStringId.MenuCmd_ChangeSectionPageMargins":"Margins","XtraRichEditStringId.MenuCmd_ChangeSectionPageMarginsDescription":"Select the margin sizes for the entire document or the current section.","XtraRichEditStringId.MenuCmd_ChangeSectionPageOrientation":"Orientation","XtraRichEditStringId.MenuCmd_ChangeSectionPageOrientationDescription":"Switch the pages between portrait and landscape layouts.","XtraRichEditStringId.MenuCmd_ChangeSectionPagePaperKind":"Size","XtraRichEditStringId.MenuCmd_ChangeSectionPagePaperKindDescription":"Choose a paper size for the current section.","XtraRichEditStringId.MenuCmd_ChangeStyle":"Quick Styles","XtraRichEditStringId.MenuCmd_ChangeStyleDescription":"Format titles, quotes, and other text using this gallery of styles.","XtraRichEditStringId.MenuCmd_ChangeTableBorders":"Borders","XtraRichEditStringId.MenuCmd_ChangeTableBordersDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ChangeTableCellAlignmentPlaceholder":"Alignment","XtraRichEditStringId.MenuCmd_ChangeTableCellAlignmentPlaceholderDescription":"Customize the alignment of the selected cells.","XtraRichEditStringId.MenuCmd_ChangeTableCellsContentAlignment":"Cell Alignment","XtraRichEditStringId.MenuCmd_ChangeTableCellsContentAlignmentDescription":"Cell Alignment","XtraRichEditStringId.MenuCmd_ChangeTableCellShading":"Shading","XtraRichEditStringId.MenuCmd_ChangeTableCellShadingDescription":"Color the background behind the selected cells.","XtraRichEditStringId.MenuCmd_ChangeTextCase":"Change Case","XtraRichEditStringId.MenuCmd_ChangeTextCaseDescription":"Change all the selected text to UPPERCASE, lowercase, or other common capitalizations.","XtraRichEditStringId.MenuCmd_CheckSpelling":"Spelling","XtraRichEditStringId.MenuCmd_CheckSpellingDescription":"Check the spelling of text in the document.","XtraRichEditStringId.MenuCmd_ClearFormatting":"Clear Formatting","XtraRichEditStringId.MenuCmd_ClearFormattingDescription":"Clear all the formatting from the selection, leaving only plain text.","XtraRichEditStringId.MenuCmd_ClearUndo":"ClearUndo","XtraRichEditStringId.MenuCmd_ClearUndoDescription":"Clear Undo Buffer","XtraRichEditStringId.MenuCmd_ClosePageHeaderFooter":"Close Header and Footer","XtraRichEditStringId.MenuCmd_ClosePageHeaderFooterDescription":"Close the Header and Footer Tools.You can also double click the document area to return to editing it.","XtraRichEditStringId.MenuCmd_CollapseOrExpandFormulaBar":"Collapse or expand Formula Bar","XtraRichEditStringId.MenuCmd_CollapseOrExpandFormulaBarDescription":"Collapse or expand Formula Bar (Ctrl+Shift+U)","XtraRichEditStringId.MenuCmd_Comment":"View Comments","XtraRichEditStringId.MenuCmd_CommentDescription":"Choose whether or not to highlight comments in the document.","XtraRichEditStringId.MenuCmd_CopySelection":"Copy","XtraRichEditStringId.MenuCmd_CopySelectionDescription":"Copy the selection and put it on the Clipboard.","XtraRichEditStringId.MenuCmd_CreateBookmark":"Create Bookmark","XtraRichEditStringId.MenuCmd_CreateBookmarkDescription":"Create Bookmark","XtraRichEditStringId.MenuCmd_CreateField":"Create Field","XtraRichEditStringId.MenuCmd_CreateFieldDescription":"Create Field","XtraRichEditStringId.MenuCmd_CreateHyperlink":"CreateHyperlink","XtraRichEditStringId.MenuCmd_CreateHyperlinkDescription":"CreateHyperlinkDescription","XtraRichEditStringId.MenuCmd_CutSelection":"Cut","XtraRichEditStringId.MenuCmd_CutSelectionDescription":"Cut the selection from the document and put it on the Clipboard.","XtraRichEditStringId.MenuCmd_DecreaseFontSize":"Shrink Font","XtraRichEditStringId.MenuCmd_DecreaseFontSizeDescription":"Decrease the font size.","XtraRichEditStringId.MenuCmd_DecrementFontSize":"DecrementFontSize","XtraRichEditStringId.MenuCmd_DecrementFontSizeDescription":"DecrementFontSize","XtraRichEditStringId.MenuCmd_DecrementIndent":"Decrease Indent","XtraRichEditStringId.MenuCmd_DecrementIndentDescription":"Decrease the indent level of the paragraph.","XtraRichEditStringId.MenuCmd_DecrementNumerationFromParagraph":"DecrementNumerationFromParagraph","XtraRichEditStringId.MenuCmd_DecrementNumerationFromParagraphDescription":"DecrementNumerationFromParagraph","XtraRichEditStringId.MenuCmd_DecrementParagraphLeftIndent":"DecrementParagraphLeftIndent","XtraRichEditStringId.MenuCmd_DecrementParagraphLeftIndentDescription":"DecrementParagraphLeftIndentDescription","XtraRichEditStringId.MenuCmd_DecrementParagraphOutlineLevel":"Decrement outline level","XtraRichEditStringId.MenuCmd_DecrementParagraphOutlineLevelDescription":"Decrement outline level","XtraRichEditStringId.MenuCmd_Delete":"Delete","XtraRichEditStringId.MenuCmd_DeleteAllComments":"Delete All Comments","XtraRichEditStringId.MenuCmd_DeleteAllCommentsDescription":"Delete All Comments.","XtraRichEditStringId.MenuCmd_DeleteAllCommentsShown":"Delete All Comments Shown","XtraRichEditStringId.MenuCmd_DeleteAllCommentsShownDescription":"Delete All Comments Shown.","XtraRichEditStringId.MenuCmd_DeleteBack":"DeleteBack","XtraRichEditStringId.MenuCmd_DeleteBackCore":"DeleteBackCore","XtraRichEditStringId.MenuCmd_DeleteBackCoreDescription":"DeleteBackCoreDescription","XtraRichEditStringId.MenuCmd_DeleteBackDescription":"DeleteBack","XtraRichEditStringId.MenuCmd_DeleteBookmark":"Delete Bookmark","XtraRichEditStringId.MenuCmd_DeleteBookmarkDescription":"Delete Bookmark","XtraRichEditStringId.MenuCmd_DeleteComment":"Delete","XtraRichEditStringId.MenuCmd_DeleteCommentDescription":"Delete the selected comment.","XtraRichEditStringId.MenuCmd_DeleteCore":"DeleteCore","XtraRichEditStringId.MenuCmd_DeleteCoreDescription":"DeleteCoreDescription","XtraRichEditStringId.MenuCmd_DeleteDescription":"Delete","XtraRichEditStringId.MenuCmd_DeleteNumerationFromParagraph":"DeleteNumerationFromParagraph","XtraRichEditStringId.MenuCmd_DeleteNumerationFromParagraphDescription":"DeleteNumerationFromParagraph","XtraRichEditStringId.MenuCmd_DeleteOneComment":"Delete Comment","XtraRichEditStringId.MenuCmd_DeleteOneCommentDescription":"Delete the selected comment.","XtraRichEditStringId.MenuCmd_DeleteRepeatedWord":"Delete Repeated Word","XtraRichEditStringId.MenuCmd_DeleteRepeatedWordDescription":"Delete Repeated Word","XtraRichEditStringId.MenuCmd_DeleteTable":"Delete Table","XtraRichEditStringId.MenuCmd_DeleteTableCells":"Delete Cells...","XtraRichEditStringId.MenuCmd_DeleteTableCellsDescription":"Delete rows, columns, or cells.","XtraRichEditStringId.MenuCmd_DeleteTableCellsMenuItem":"Delete Cells...","XtraRichEditStringId.MenuCmd_DeleteTableColumns":"Delete Columns","XtraRichEditStringId.MenuCmd_DeleteTableColumnsDescription":"Delete Columns","XtraRichEditStringId.MenuCmd_DeleteTableDescription":"Delete Entire Table.","XtraRichEditStringId.MenuCmd_DeleteTableElements":"Delete","XtraRichEditStringId.MenuCmd_DeleteTableElementsDescription":"Delete rows, columns, cells, or the entire Table.","XtraRichEditStringId.MenuCmd_DeleteTableRows":"Delete Rows","XtraRichEditStringId.MenuCmd_DeleteTableRowsDescription":"Delete Rows","XtraRichEditStringId.MenuCmd_DeleteTableStyle":"Delete Table Style...","XtraRichEditStringId.MenuCmd_DeleteWord":"DeleteWord","XtraRichEditStringId.MenuCmd_DeleteWordBack":"DeleteWordBack","XtraRichEditStringId.MenuCmd_DeleteWordBackCore":"DeleteWordBack","XtraRichEditStringId.MenuCmd_DeleteWordBackCoreDescription":"DeleteWordBack","XtraRichEditStringId.MenuCmd_DeleteWordBackDescription":"DeleteWordBack","XtraRichEditStringId.MenuCmd_DeleteWordCore":"DeleteWordCore","XtraRichEditStringId.MenuCmd_DeleteWordCoreDescription":"DeleteWordCoreDescription","XtraRichEditStringId.MenuCmd_DeleteWordDescription":"DeleteWord","XtraRichEditStringId.MenuCmd_DeselectAll":"Deselect All","XtraRichEditStringId.MenuCmd_DeselectAllDescription":"Reset document selection.","XtraRichEditStringId.MenuCmd_DraftView":"Draft View","XtraRichEditStringId.MenuCmd_DraftViewDescription":"Draft View","XtraRichEditStringId.MenuCmd_EditHyperlink":"Edit hyperlink...","XtraRichEditStringId.MenuCmd_EditHyperlinkDescription":"Edit hyperlink...","XtraRichEditStringId.MenuCmd_EditPageFooter":"Footer","XtraRichEditStringId.MenuCmd_EditPageFooterDescription":"Edit the footer of the document.The content in the footer will appear at the bottom of each printed page.","XtraRichEditStringId.MenuCmd_EditPageHeader":"Header","XtraRichEditStringId.MenuCmd_EditPageHeaderDescription":"Edit the header of the document.The content in the header will appear at the top of each printed page.","XtraRichEditStringId.MenuCmd_EditTOC":"Edit Table of Contents...","XtraRichEditStringId.MenuCmd_EncryptDocument":"Encrypt with Password","XtraRichEditStringId.MenuCmd_EncryptDocumentDescription":"Password-protect this document.","XtraRichEditStringId.MenuCmd_EnsureCaretVisibleHorizontally":"EnsureCaretVisibleHorizontally","XtraRichEditStringId.MenuCmd_EnsureCaretVisibleHorizontallyDescription":"EnsureCaretVisibleHorizontally","XtraRichEditStringId.MenuCmd_EnsureCaretVisibleVertically":"EnsureCaretVisibleVertically","XtraRichEditStringId.MenuCmd_EnsureCaretVisibleVerticallyDescription":"EnsureCaretVisibleVertically","XtraRichEditStringId.MenuCmd_EnterKey":"EnterKey","XtraRichEditStringId.MenuCmd_EnterKeyDescription":"EnterKeyDescription","XtraRichEditStringId.MenuCmd_Find":"Find","XtraRichEditStringId.MenuCmd_FindAndSelectBackward":"FindAndSelectBackward","XtraRichEditStringId.MenuCmd_FindAndSelectBackwardDescription":"FindAndSelectBackward","XtraRichEditStringId.MenuCmd_FindAndSelectForward":"FindAndSelectForward","XtraRichEditStringId.MenuCmd_FindAndSelectForwardDescription":"FindAndSelectForward","XtraRichEditStringId.MenuCmd_FindDescription":"Find text in the document.","XtraRichEditStringId.MenuCmd_FindNext":"Find Next","XtraRichEditStringId.MenuCmd_FindNextDescription":"Repeats the last search forward.","XtraRichEditStringId.MenuCmd_FindPrev":"Find Prev","XtraRichEditStringId.MenuCmd_FindPrevDescription":"Repeats the last search backward.","XtraRichEditStringId.MenuCmd_FirstDataRecord":"First Record","XtraRichEditStringId.MenuCmd_FirstDataRecordDescription":"First Record","XtraRichEditStringId.MenuCmd_FitHeight":"Fit Height","XtraRichEditStringId.MenuCmd_FitHeightDescription":"Adjusts the document zoom factor to fit the entire page height to the editing surface dimensions.","XtraRichEditStringId.MenuCmd_FitToPage":"Fit To Page","XtraRichEditStringId.MenuCmd_FitToPageDescription":"Adjusts the document zoom factor to fit the entire page to the editing surface dimensions.","XtraRichEditStringId.MenuCmd_FitWidth":"Fit Width","XtraRichEditStringId.MenuCmd_FitWidthDescription":"Adjusts the document zoom factor to fit the entire page width to the editing surface dimensions.","XtraRichEditStringId.MenuCmd_FloatingObjectBringForward":"Bring Forward","XtraRichEditStringId.MenuCmd_FloatingObjectBringForwardDescription":"Bring the selected object forward so that it is hidden by fewer object that are in front of it.","XtraRichEditStringId.MenuCmd_FloatingObjectBringForwardPlaceholder":"Bring to Front","XtraRichEditStringId.MenuCmd_FloatingObjectBringForwardPlaceholderDescription":"Bring the selected object forward so that it is hidden by fewer object that are in front of it.","XtraRichEditStringId.MenuCmd_FloatingObjectBringInFrontOfText":"Bring in Front of Text","XtraRichEditStringId.MenuCmd_FloatingObjectBringInFrontOfTextDescription":" ","XtraRichEditStringId.MenuCmd_FloatingObjectBringToFront":"Bring to Front","XtraRichEditStringId.MenuCmd_FloatingObjectBringToFrontDescription":"Bring the selected object in front of all other objects so that no part of it is hidden behind another object.","XtraRichEditStringId.MenuCmd_FloatingObjectSendBackward":"Send Backward","XtraRichEditStringId.MenuCmd_FloatingObjectSendBackwardDescription":"Send the selected object backward so that it is hidden by the object that are in front of it.","XtraRichEditStringId.MenuCmd_FloatingObjectSendBackwardPlaceholder":"Send to Back","XtraRichEditStringId.MenuCmd_FloatingObjectSendBackwardPlaceholderDescription":"Send the selected object backward so that it is hidden by the object that are in front of it.","XtraRichEditStringId.MenuCmd_FloatingObjectSendBehindText":"Send Behind Text","XtraRichEditStringId.MenuCmd_FloatingObjectSendBehindTextDescription":" ","XtraRichEditStringId.MenuCmd_FloatingObjectSendToBack":"Send to Back","XtraRichEditStringId.MenuCmd_FloatingObjectSendToBackDescription":"Send the selected object behind all other objects.","XtraRichEditStringId.MenuCmd_FontSubscript":"Subscript","XtraRichEditStringId.MenuCmd_FontSubscriptDescription":"Create small letters below the text baseline.","XtraRichEditStringId.MenuCmd_FontSuperscript":"Superscript","XtraRichEditStringId.MenuCmd_FontSuperscriptDescription":"Create small letters above the line of text.","XtraRichEditStringId.MenuCmd_GoToNextHeaderFooter":"Show Next","XtraRichEditStringId.MenuCmd_GoToNextHeaderFooterDescription":"Navigate to the next section's header or footer.","XtraRichEditStringId.MenuCmd_GoToPage":"Go To Page","XtraRichEditStringId.MenuCmd_GoToPageDescription":"Go To Page","XtraRichEditStringId.MenuCmd_GoToPageFooter":"Go to Footer","XtraRichEditStringId.MenuCmd_GoToPageFooterDescription":"Activate the footer on this page so that you can edit it.","XtraRichEditStringId.MenuCmd_GoToPageHeader":"Go to Header","XtraRichEditStringId.MenuCmd_GoToPageHeaderDescription":"Activate the header on this page so that you can edit it.","XtraRichEditStringId.MenuCmd_GoToPreviousHeaderFooter":"Show Previous","XtraRichEditStringId.MenuCmd_GoToPreviousHeaderFooterDescription":"Navigate to the previous section's header or footer.","XtraRichEditStringId.MenuCmd_HighlightText":"Text Highlight Color","XtraRichEditStringId.MenuCmd_HighlightTextDescription":"Make text look like it was marked with a highlighter pen.","XtraRichEditStringId.MenuCmd_Hyperlink":"Hyperlink...","XtraRichEditStringId.MenuCmd_HyperlinkDescription":"Hyperlink...","XtraRichEditStringId.MenuCmd_IgnoreAllMistakenWords":"Ignore All","XtraRichEditStringId.MenuCmd_IgnoreAllMistakenWordsDescription":"Ignore All","XtraRichEditStringId.MenuCmd_IgnoreMistakenWord":"Ignore","XtraRichEditStringId.MenuCmd_IgnoreMistakenWordDescription":"Ignore","XtraRichEditStringId.MenuCmd_IncreaseFontSize":"Grow Font","XtraRichEditStringId.MenuCmd_IncreaseFontSizeDescription":"Increase the font size.","XtraRichEditStringId.MenuCmd_IncrementFontSize":"IncrementFontSize","XtraRichEditStringId.MenuCmd_IncrementFontSizeDescription":"IncrementFontSize","XtraRichEditStringId.MenuCmd_IncrementIndent":"Increase Indent","XtraRichEditStringId.MenuCmd_IncrementIndentDescription":"Increase the indent level of the paragraph.","XtraRichEditStringId.MenuCmd_IncrementNumerationFromParagraph":"IncrementNumerationFromParagraph","XtraRichEditStringId.MenuCmd_IncrementNumerationFromParagraphDescription":"IncrementNumerationFromParagraph","XtraRichEditStringId.MenuCmd_IncrementParagraphLeftIndent":"IncrementParagraphLeftIndent","XtraRichEditStringId.MenuCmd_IncrementParagraphLeftIndentDescription":"IncrementParagraphLeftIndentDescription","XtraRichEditStringId.MenuCmd_IncrementParagraphOutlineLevel":"Increment outline level","XtraRichEditStringId.MenuCmd_IncrementParagraphOutlineLevelDescription":"Increment outline level","XtraRichEditStringId.MenuCmd_InsertBreak":"Breaks","XtraRichEditStringId.MenuCmd_InsertBreakDescription":"Add page, section, or column breaks to the document.","XtraRichEditStringId.MenuCmd_InsertBulletList":"Bullets","XtraRichEditStringId.MenuCmd_InsertBulletListDescription":"Start a bulleted list.","XtraRichEditStringId.MenuCmd_InsertCaptionPlaceholder":"Insert Caption","XtraRichEditStringId.MenuCmd_InsertCaptionPlaceholderDescription":"Add a caption to a picture or other image.A caption is a line of text that appears below an object to describe it.","XtraRichEditStringId.MenuCmd_InsertClosingDoubleQuotationMark":"InsertClosingDoubleQuotationMark","XtraRichEditStringId.MenuCmd_InsertClosingDoubleQuotationMarkDescription":"InsertClosingDoubleQuotationMark","XtraRichEditStringId.MenuCmd_InsertClosingSingleQuotationMark":"InsertClosingSingleQuotationMark","XtraRichEditStringId.MenuCmd_InsertClosingSingleQuotationMarkDescription":"InsertClosingSingleQuotationMark","XtraRichEditStringId.MenuCmd_InsertColumnBreak":"Column","XtraRichEditStringId.MenuCmd_InsertColumnBreakDescription":"Indicate that the text following the column break will begin in the next column.","XtraRichEditStringId.MenuCmd_InsertCopyrightSymbol":"InsertCopyrightSymbol","XtraRichEditStringId.MenuCmd_InsertCopyrightSymbolDescription":"InsertCopyrightSymbol","XtraRichEditStringId.MenuCmd_InsertEllipsis":"InsertEllipsis","XtraRichEditStringId.MenuCmd_InsertEllipsisDescription":"InsertEllipsis","XtraRichEditStringId.MenuCmd_InsertEmDash":"InsertEmDash","XtraRichEditStringId.MenuCmd_InsertEmDashDescription":"InsertEmDash","XtraRichEditStringId.MenuCmd_InsertEnDash":"InsertEnDash","XtraRichEditStringId.MenuCmd_InsertEnDashDescription":"InsertEnDash","XtraRichEditStringId.MenuCmd_InsertEquationsCaption":"Equations Caption","XtraRichEditStringId.MenuCmd_InsertEquationsCaptionDescription":"Add a equation caption.","XtraRichEditStringId.MenuCmd_InsertField":"InsertField","XtraRichEditStringId.MenuCmd_InsertFieldDescription":"InsertField","XtraRichEditStringId.MenuCmd_InsertFiguresCaption":"Figures Caption","XtraRichEditStringId.MenuCmd_InsertFiguresCaptionDescription":"Add a figure caption.","XtraRichEditStringId.MenuCmd_InsertFloatingObjectPicture":"Picture","XtraRichEditStringId.MenuCmd_InsertFloatingObjectPictureDescription":"Insert a picture from a file.","XtraRichEditStringId.MenuCmd_InsertHyperlink":"InsertHyperlink","XtraRichEditStringId.MenuCmd_InsertHyperlinkDescription":"InsertHyperlinkDescription","XtraRichEditStringId.MenuCmd_InsertHyphen":"InsertHyphen","XtraRichEditStringId.MenuCmd_InsertLineBreak":"InsertLineBreak","XtraRichEditStringId.MenuCmd_InsertLineBreakDescription":"InsertLineBreak","XtraRichEditStringId.MenuCmd_InsertMergeField":"Insert Merge Field","XtraRichEditStringId.MenuCmd_InsertMergeFieldDescription":"Insert Merge Field.","XtraRichEditStringId.MenuCmd_InsertMultilevelList":"Multilevel list","XtraRichEditStringId.MenuCmd_InsertMultilevelListDescription":"Start a multilevel list.","XtraRichEditStringId.MenuCmd_InsertNonBreakingSpace":"InsertNonBreakingSpace","XtraRichEditStringId.MenuCmd_InsertNonBreakingSpaceDescription":"InsertNonBreakingSpace","XtraRichEditStringId.MenuCmd_InsertOpeningDoubleQuotationMark":"InsertOpeningDoubleQuotationMark","XtraRichEditStringId.MenuCmd_InsertOpeningDoubleQuotationMarkDescription":"InsertOpeningDoubleQuotationMark","XtraRichEditStringId.MenuCmd_InsertOpeningSingleQuotationMark":"InsertOpeningSingleQuotationMark","XtraRichEditStringId.MenuCmd_InsertOpeningSingleQuotationMarkDescription":"InsertOpeningSingleQuotationMark","XtraRichEditStringId.MenuCmd_InsertPageBreak":"Page","XtraRichEditStringId.MenuCmd_InsertPageBreak2":"Page Break","XtraRichEditStringId.MenuCmd_InsertPageBreak2Description":"Start the next page at the current position.","XtraRichEditStringId.MenuCmd_InsertPageBreakDescription":"Start the next page at the current position.","XtraRichEditStringId.MenuCmd_InsertPageCountField":"Page Count","XtraRichEditStringId.MenuCmd_InsertPageCountFieldDescription":"Insert total page count into the document.","XtraRichEditStringId.MenuCmd_InsertPageNumberField":"Page Number","XtraRichEditStringId.MenuCmd_InsertPageNumberFieldDescription":"Insert page numbers into the document.","XtraRichEditStringId.MenuCmd_InsertParagraph":"InsertParagraph","XtraRichEditStringId.MenuCmd_InsertParagraphDescription":"InsertParagraph","XtraRichEditStringId.MenuCmd_InsertPicture":"Inline Picture","XtraRichEditStringId.MenuCmd_InsertPictureDescription":"Insert inline picture from a file.","XtraRichEditStringId.MenuCmd_InsertRegisteredTrademarkSymbol":"InsertRegisteredTrademark Symbol","XtraRichEditStringId.MenuCmd_InsertRegisteredTrademarkSymbolDescription":"InsertRegisteredTrademark Symbol","XtraRichEditStringId.MenuCmd_InsertSectionBreakContinuous":"Section (Continuous)","XtraRichEditStringId.MenuCmd_InsertSectionBreakContinuousDescription":"Insert a section break and start the new section on the same page.","XtraRichEditStringId.MenuCmd_InsertSectionBreakEvenPage":"Section (Even Page)","XtraRichEditStringId.MenuCmd_InsertSectionBreakEvenPageDescription":"Insert a section break and start the new section on the next even-numbered page.","XtraRichEditStringId.MenuCmd_InsertSectionBreakNextPage":"Section (Next Page)","XtraRichEditStringId.MenuCmd_InsertSectionBreakNextPageDescription":"Insert a section break and start the new section on the next page.","XtraRichEditStringId.MenuCmd_InsertSectionBreakOddPage":"Section (Odd Page)","XtraRichEditStringId.MenuCmd_InsertSectionBreakOddPageDescription":"Insert a section break and start the new section on the next odd-numbered page.","XtraRichEditStringId.MenuCmd_InsertSimpleList":"Numbering","XtraRichEditStringId.MenuCmd_InsertSimpleListDescription":"Start a numbered list.","XtraRichEditStringId.MenuCmd_InsertSymbol":"Symbol","XtraRichEditStringId.MenuCmd_InsertSymbolDescription":"Insert symbols that are not on your keyboard, such as copyright symbols, trademark symbols, paragraph marks and Unicode characters.","XtraRichEditStringId.MenuCmd_InsertTab":"InsertTab","XtraRichEditStringId.MenuCmd_InsertTabDescription":"InsertTab","XtraRichEditStringId.MenuCmd_InsertTable":"Table","XtraRichEditStringId.MenuCmd_InsertTableCells":"Insert Cells","XtraRichEditStringId.MenuCmd_InsertTableCellsDescription":"Insert Cells","XtraRichEditStringId.MenuCmd_InsertTableColumnToTheLeft":"Insert Left","XtraRichEditStringId.MenuCmd_InsertTableColumnToTheLeftDescription":"Add a new column directly to the left of the selected column.","XtraRichEditStringId.MenuCmd_InsertTableColumnToTheRight":"Insert Right","XtraRichEditStringId.MenuCmd_InsertTableColumnToTheRightDescription":"Add a new column directly to the right of the selected column.","XtraRichEditStringId.MenuCmd_InsertTableDescription":"Insert a table into the document.","XtraRichEditStringId.MenuCmd_InsertTableElement":"Insert","XtraRichEditStringId.MenuCmd_InsertTableOfContents":"Table of Contents","XtraRichEditStringId.MenuCmd_InsertTableOfContentsDescription":"Add the Table of Contents to the document.Once you have added a Table of Contents, click the Add Text button to add entries the the table.","XtraRichEditStringId.MenuCmd_InsertTableOfEquations":"Table of Equations","XtraRichEditStringId.MenuCmd_InsertTableOfEquationsDescription":"Insert a Table of Equations into the document.A Table of Equations includes a list of all the equations in the document.","XtraRichEditStringId.MenuCmd_InsertTableOfFigures":"Table of Figures","XtraRichEditStringId.MenuCmd_InsertTableOfFiguresDescription":"Insert a Table of Figures into the document.A Table of Figures includes a list of all the figures in the document.","XtraRichEditStringId.MenuCmd_InsertTableOfFiguresPlaceholder":"Insert Table of Figures","XtraRichEditStringId.MenuCmd_InsertTableOfFiguresPlaceholderDescription":"Insert a Table of Figures into the document.A Table of Figures includes a list of all of the figures, tables or equations in the document.","XtraRichEditStringId.MenuCmd_InsertTableOfTables":"Table of Tables","XtraRichEditStringId.MenuCmd_InsertTableOfTablesDescription":"Insert a Table of Tables into the document.A Table of Tables includes a list of all the tables in the document.","XtraRichEditStringId.MenuCmd_InsertTableRowAbove":"Insert Above","XtraRichEditStringId.MenuCmd_InsertTableRowAboveDescription":"Add a new row directly above the selected row.","XtraRichEditStringId.MenuCmd_InsertTableRowBelow":"Insert Below","XtraRichEditStringId.MenuCmd_InsertTableRowBelowDescription":"Add a new row directly below the selected row.","XtraRichEditStringId.MenuCmd_InsertTablesCaption":"Tables Caption","XtraRichEditStringId.MenuCmd_InsertTablesCaptionDescription":"Add a table caption.","XtraRichEditStringId.MenuCmd_InsertTabToParagraph":"InsertTabToParagraph","XtraRichEditStringId.MenuCmd_InsertTabToParagraphDescription":"InsertTabToParagraphDescription","XtraRichEditStringId.MenuCmd_InsertText":"InsertText","XtraRichEditStringId.MenuCmd_InsertTextBox":"Text Box","XtraRichEditStringId.MenuCmd_InsertTextBoxDescription":"Insert a text box into the document.","XtraRichEditStringId.MenuCmd_InsertTextDescription":"InsertText","XtraRichEditStringId.MenuCmd_InsertTrademarkSymbol":"InsertTrademarkSymbol","XtraRichEditStringId.MenuCmd_InsertTrademarkSymbolDescription":"InsertTrademarkSymbol","XtraRichEditStringId.MenuCmd_Language":"Language","XtraRichEditStringId.MenuCmd_LanguageDescription":"Set the language used to check the spelling and grammar of the selected text.","XtraRichEditStringId.MenuCmd_LastDataRecord":"Last Record","XtraRichEditStringId.MenuCmd_LastDataRecordDescription":"Last Record","XtraRichEditStringId.MenuCmd_LoadDocument":"Open","XtraRichEditStringId.MenuCmd_LoadDocumentDescription":"Open a document.","XtraRichEditStringId.MenuCmd_LockField":"Lock Field","XtraRichEditStringId.MenuCmd_LockFieldDescription":"Lock Field","XtraRichEditStringId.MenuCmd_MailMergeSaveDocumentAsCommand":"Mail Merge","XtraRichEditStringId.MenuCmd_MailMergeSaveDocumentAsCommandDescription":"Mail Merge","XtraRichEditStringId.MenuCmd_MakeTextLowerCase":"lowercase","XtraRichEditStringId.MenuCmd_MakeTextLowerCaseDescription":"Change all the selected text to lowercase.","XtraRichEditStringId.MenuCmd_MakeTextUpperCase":"UPPERCASE","XtraRichEditStringId.MenuCmd_MakeTextUpperCaseDescription":"Change all the selected text to UPPERCASE.","XtraRichEditStringId.MenuCmd_MergeTableCells":"Merge Cells","XtraRichEditStringId.MenuCmd_MergeTableCellsDescription":"Merge the selected cells into one cell.","XtraRichEditStringId.MenuCmd_ModifyHyperlink":"ModifyHyperlink","XtraRichEditStringId.MenuCmd_ModifyHyperlinkDescription":"ModifyHyperlinkDescription","XtraRichEditStringId.MenuCmd_ModifyTableStyle":"Modify Table Style...","XtraRichEditStringId.MenuCmd_MoveBackward":"MoveBackward","XtraRichEditStringId.MenuCmd_MoveBackwardDescription":"MoveBackward","XtraRichEditStringId.MenuCmd_MoveForward":"MoveForward","XtraRichEditStringId.MenuCmd_MoveForwardDescription":"MoveForward","XtraRichEditStringId.MenuCmd_MoveLineDown":"MoveLineDown","XtraRichEditStringId.MenuCmd_MoveLineDownDescription":"MoveLineDown","XtraRichEditStringId.MenuCmd_MoveLineUp":"MoveLineUp","XtraRichEditStringId.MenuCmd_MoveLineUpDescription":"MoveLineUp","XtraRichEditStringId.MenuCmd_MoveNextPage":"MoveNextPage","XtraRichEditStringId.MenuCmd_MoveNextPageDescription":"MoveNextPage","XtraRichEditStringId.MenuCmd_MoveNextParagraph":"MoveNextParagraph","XtraRichEditStringId.MenuCmd_MoveNextParagraphDescription":"MoveNextParagraph","XtraRichEditStringId.MenuCmd_MoveNextWord":"MoveNextWord","XtraRichEditStringId.MenuCmd_MoveNextWordDescription":"MoveNextWord","XtraRichEditStringId.MenuCmd_MovePreviousPage":"MovePreviousPage","XtraRichEditStringId.MenuCmd_MovePreviousPageDescription":"MovePreviousPage","XtraRichEditStringId.MenuCmd_MovePreviousParagraph":"MovePreviousParagraph","XtraRichEditStringId.MenuCmd_MovePreviousParagraphDescription":"MovePreviousParagraph","XtraRichEditStringId.MenuCmd_MovePreviousWord":"MovePreviousWord","XtraRichEditStringId.MenuCmd_MovePreviousWordDescription":"MovePreviousWord","XtraRichEditStringId.MenuCmd_MoveScreenDown":"MoveScreenDown","XtraRichEditStringId.MenuCmd_MoveScreenDownDescription":"MoveScreenDown","XtraRichEditStringId.MenuCmd_MoveScreenUp":"MoveScreenUp","XtraRichEditStringId.MenuCmd_MoveScreenUpDescription":"MoveScreenUp","XtraRichEditStringId.MenuCmd_MoveToBeginOfDocument":"MoveToBeginBeginOfDocument","XtraRichEditStringId.MenuCmd_MoveToBeginOfDocumentDescription":"MoveToBeginBeginOfDocument","XtraRichEditStringId.MenuCmd_MoveToEndOfDocument":"MoveToEndOfDocument","XtraRichEditStringId.MenuCmd_MoveToEndOfDocumentDescription":"MoveToEndOfDocument","XtraRichEditStringId.MenuCmd_MoveToEndOfLine":"MoveToEndOfLine","XtraRichEditStringId.MenuCmd_MoveToEndOfLineDescription":"MoveToEndOfLine","XtraRichEditStringId.MenuCmd_MoveToStartOfLine":"MoveToBeginOfLine","XtraRichEditStringId.MenuCmd_MoveToStartOfLineDescription":"MoveToBeginOfLine","XtraRichEditStringId.MenuCmd_NewComment":"New Comment","XtraRichEditStringId.MenuCmd_NewCommentDescription":"Add a comment about the selection.","XtraRichEditStringId.MenuCmd_NewEmptyDocument":"New","XtraRichEditStringId.MenuCmd_NewEmptyDocumentDescription":"Create a new document.","XtraRichEditStringId.MenuCmd_NewTableStyle":"New Table Style...","XtraRichEditStringId.MenuCmd_NextComment":"Next","XtraRichEditStringId.MenuCmd_NextCommentDescription":"Navigate to the next comment in the document.","XtraRichEditStringId.MenuCmd_NextDataRecord":"Next Record","XtraRichEditStringId.MenuCmd_NextDataRecordDescription":"Next Record","XtraRichEditStringId.MenuCmd_None":" ","XtraRichEditStringId.MenuCmd_OpenHyperlink":"Open hyperlink","XtraRichEditStringId.MenuCmd_OpenHyperlinkAtCaretPosition":"OpenHyperlinkAtCaretPosition","XtraRichEditStringId.MenuCmd_OpenHyperlinkAtCaretPositionDescription":"OpenHyperlinkAtCaretPositionDescription","XtraRichEditStringId.MenuCmd_OpenHyperlinkDescription":"Open hyperlink","XtraRichEditStringId.MenuCmd_OvertypeText":"OvertypeText","XtraRichEditStringId.MenuCmd_OvertypeTextDescription":"OvertypeText","XtraRichEditStringId.MenuCmd_ParagraphAlignmentCenter":"Center","XtraRichEditStringId.MenuCmd_ParagraphAlignmentCenterDescription":"Center your content on the page.","XtraRichEditStringId.MenuCmd_ParagraphAlignmentDistribute":"Distributed","XtraRichEditStringId.MenuCmd_ParagraphAlignmentDistributeDescription":"Align text to both left and right margins.Space will be added between characters and words. If the last line is short, extra spaces will be added between the characters to make it match the width of the paragraph.","XtraRichEditStringId.MenuCmd_ParagraphAlignmentJustify":"Justify","XtraRichEditStringId.MenuCmd_ParagraphAlignmentJustifyDescription":"Distribute your text evenly between left and right margins. Justified text gives you document clean edges so it looks more polished.","XtraRichEditStringId.MenuCmd_ParagraphAlignmentJustifyHigh":"Justify High","XtraRichEditStringId.MenuCmd_ParagraphAlignmentJustifyHighDescription":"Align text to both left and right margins.Specifies that a paragraph uses the kashida with the widest length for Arabic text. For other languages, paragraph text is justified with the widest inter-word spacing.","XtraRichEditStringId.MenuCmd_ParagraphAlignmentJustifyLow":"Justify Low","XtraRichEditStringId.MenuCmd_ParagraphAlignmentJustifyLowDescription":"Align text to both left and right margins.If the language is Arabic, the paragraph uses small length Kashida. In other languages, text is justified with short inter-word spacing.","XtraRichEditStringId.MenuCmd_ParagraphAlignmentJustifyMedium":"Justify Medium","XtraRichEditStringId.MenuCmd_ParagraphAlignmentJustifyMediumDescription":"Align text to both left and right margins.If the language is Arabic, the paragraph uses medium-length Kashida. In other languages, text is justified with wider inter-word spacing.","XtraRichEditStringId.MenuCmd_ParagraphAlignmentLeft":"Align Text Left","XtraRichEditStringId.MenuCmd_ParagraphAlignmentLeftDescription":"Align your content with the left margin.","XtraRichEditStringId.MenuCmd_ParagraphAlignmentRight":"Align Text Right","XtraRichEditStringId.MenuCmd_ParagraphAlignmentRightDescription":"Align your content with the right margin.","XtraRichEditStringId.MenuCmd_ParagraphAlignmentThaiDistribute":"Thai Distributed","XtraRichEditStringId.MenuCmd_ParagraphAlignmentThaiDistributeDescription":"Align text to both left and right margins by adding extra space between each two characters for languages with tone mark and vowel mark.","XtraRichEditStringId.MenuCmd_ParagraphLeftToRight":"Left-to-Right Text Direction","XtraRichEditStringId.MenuCmd_ParagraphLeftToRightDescription":"Set the text to read from right to left.","XtraRichEditStringId.MenuCmd_ParagraphRightToLeft":"Right-to-Left Text Direction","XtraRichEditStringId.MenuCmd_ParagraphRightToLeftDescription":"Set the text to read from left to right.","XtraRichEditStringId.MenuCmd_ParagraphSuppressHyphenation":"Suppress Hyphenation for Current Paragraph","XtraRichEditStringId.MenuCmd_ParagraphSuppressHyphenationDescription":"Suppress Hyphenation for Current Paragraph","XtraRichEditStringId.MenuCmd_ParagraphSuppressLineNumbers":"Suppress for Current Paragraph","XtraRichEditStringId.MenuCmd_ParagraphSuppressLineNumbersDescription":"Suppress for Current Paragraph","XtraRichEditStringId.MenuCmd_Paste":"Paste","XtraRichEditStringId.MenuCmd_PasteDescription":"Paste the contents of the Clipboard.","XtraRichEditStringId.MenuCmd_PasteFiles":"Files","XtraRichEditStringId.MenuCmd_PasteFilesDescription":"Inserts the contents of the Clipboard as an embedded file.","XtraRichEditStringId.MenuCmd_PasteHtmlText":"HTML Format","XtraRichEditStringId.MenuCmd_PasteHtmlTextDescription":"Inserts the contents of the Clipboard as HTML format.","XtraRichEditStringId.MenuCmd_PasteImage":"Picture","XtraRichEditStringId.MenuCmd_PasteImageDescription":"Inserts the contents of the Clipboard as picture.","XtraRichEditStringId.MenuCmd_PasteMetafileImage":"Metafile","XtraRichEditStringId.MenuCmd_PasteMetafileImageDescription":"Inserts the contents of the Clipboard as metafile.","XtraRichEditStringId.MenuCmd_PastePlainText":"Unformatted text","XtraRichEditStringId.MenuCmd_PastePlainTextDescription":"Inserts the contents of the Clipboard as text without any formatting.","XtraRichEditStringId.MenuCmd_PasteRtfText":"Formatted text (RTF)","XtraRichEditStringId.MenuCmd_PasteRtfTextDescription":"Inserts the contents of the Clipboard as text with font and table formatting.","XtraRichEditStringId.MenuCmd_PasteSilverlightXamlText":"Formatted text (XAML)","XtraRichEditStringId.MenuCmd_PasteSilverlightXamlTextDescription":"Inserts the contents of the Clipboard as text with font formatting.","XtraRichEditStringId.MenuCmd_PlaceCaretToPhysicalPoint":"PlaceCaretToPhysicalPoint","XtraRichEditStringId.MenuCmd_PlaceCaretToPhysicalPointDescription":"PlaceCaretToPhysicalPoint","XtraRichEditStringId.MenuCmd_PreviousComment":"Previous","XtraRichEditStringId.MenuCmd_PreviousCommentDescription":"Navigate to the previous comment in the document.","XtraRichEditStringId.MenuCmd_PreviousDataRecord":"Previous Record","XtraRichEditStringId.MenuCmd_PreviousDataRecordDescription":"Previous Record","XtraRichEditStringId.MenuCmd_Print":"Print","XtraRichEditStringId.MenuCmd_PrintDescription":"Select a printer, number of copies, and other printing options before printing.","XtraRichEditStringId.MenuCmd_PrintPreview":"Print Preview","XtraRichEditStringId.MenuCmd_PrintPreviewDescription":"Preview pages before printing.","XtraRichEditStringId.MenuCmd_PrintView":"Print View","XtraRichEditStringId.MenuCmd_PrintViewDescription":"Print View","XtraRichEditStringId.MenuCmd_ProtectDocument":"Protect Document","XtraRichEditStringId.MenuCmd_ProtectDocumentDescription":"Help restrict people from editing the document by specifying a password.","XtraRichEditStringId.MenuCmd_QuickPrint":"Quick Print","XtraRichEditStringId.MenuCmd_QuickPrintDescription":"Send the document directly to the default printer without making changes.","XtraRichEditStringId.MenuCmd_ReadingView":"Reading View","XtraRichEditStringId.MenuCmd_ReadingViewDescription":"Reading View","XtraRichEditStringId.MenuCmd_Redo":"Redo","XtraRichEditStringId.MenuCmd_RedoDescription":"Redo the last operation","XtraRichEditStringId.MenuCmd_RemoveHyperlink":"Remove hyperlink","XtraRichEditStringId.MenuCmd_RemoveHyperlinkDescription":"Remove hyperlink","XtraRichEditStringId.MenuCmd_RemoveSpacingAfterParagraph":"Remove Space After Paragraph","XtraRichEditStringId.MenuCmd_RemoveSpacingAfterParagraphDescription":" ","XtraRichEditStringId.MenuCmd_RemoveSpacingBeforeParagraph":"Remove Space Before Paragraph","XtraRichEditStringId.MenuCmd_RemoveSpacingBeforeParagraphDescription":" ","XtraRichEditStringId.MenuCmd_Replace":"Replace","XtraRichEditStringId.MenuCmd_ReplaceAllBackward":"ReplaceAllBackward","XtraRichEditStringId.MenuCmd_ReplaceAllBackwardDescription":"ReplaceAllBackwardDescription","XtraRichEditStringId.MenuCmd_ReplaceAllForward":"ReplaceAllForward","XtraRichEditStringId.MenuCmd_ReplaceAllForwardDescription":"ReplaceAllForwardDescription","XtraRichEditStringId.MenuCmd_ReplaceBackward":"ReplaceBackward","XtraRichEditStringId.MenuCmd_ReplaceBackwardDescription":"ReplaceBackward","XtraRichEditStringId.MenuCmd_ReplaceDescription":"Replace text in the document.","XtraRichEditStringId.MenuCmd_ReplaceForward":"ReplaceForward","XtraRichEditStringId.MenuCmd_ReplaceForwardDescription":"ReplaceForward","XtraRichEditStringId.MenuCmd_ReplaceText":"ReplaceText","XtraRichEditStringId.MenuCmd_ReplaceTextDescription":"ReplaceTextDescription","XtraRichEditStringId.MenuCmd_ResetCharacterFormatting":"Reset Character Formatting","XtraRichEditStringId.MenuCmd_ResetCharacterFormattingDescription":"Makes the selection the default character format of the applied style.","XtraRichEditStringId.MenuCmd_ResetTableCellsBorders":"No Border","XtraRichEditStringId.MenuCmd_ResetTableCellsBordersDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_Reviewers":"Reviewers","XtraRichEditStringId.MenuCmd_ReviewersDescription":"Select which reviewer comments to highlight in the document.","XtraRichEditStringId.MenuCmd_ReviewingPane":"Reviewing Pane","XtraRichEditStringId.MenuCmd_ReviewingPaneDescription":"Show or hide the document comments in a separate window.","XtraRichEditStringId.MenuCmd_SaveDocument":"Save","XtraRichEditStringId.MenuCmd_SaveDocumentAs":"Save As","XtraRichEditStringId.MenuCmd_SaveDocumentAsDescription":"Open the Save As dialog box to select a file format and save the document to a new location.","XtraRichEditStringId.MenuCmd_SaveDocumentDescription":"Save the document.","XtraRichEditStringId.MenuCmd_ScrollDown":"Scroll Down","XtraRichEditStringId.MenuCmd_ScrollDownDescription":"Scroll Down","XtraRichEditStringId.MenuCmd_ScrollToPage":"ScrollToPage","XtraRichEditStringId.MenuCmd_ScrollToPageDescription":"ScrollToPage","XtraRichEditStringId.MenuCmd_SelectAll":"Select All","XtraRichEditStringId.MenuCmd_SelectAllDescription":"Select entire document content.","XtraRichEditStringId.MenuCmd_SelectBookmark":"Select Bookmark","XtraRichEditStringId.MenuCmd_SelectBookmarkDescription":"Select Bookmark","XtraRichEditStringId.MenuCmd_SelectComment":"Select Comment","XtraRichEditStringId.MenuCmd_SelectCommentDescription":"Select Comment","XtraRichEditStringId.MenuCmd_SelectFieldNextToCaret":"SelectFieldNextToCaret","XtraRichEditStringId.MenuCmd_SelectFieldNextToCaretDescription":"SelectFieldNextToCaretDescription","XtraRichEditStringId.MenuCmd_SelectFieldPrevToCaret":"SelectFieldPrevToCaret","XtraRichEditStringId.MenuCmd_SelectFieldPrevToCaretDescription":"SelectFieldPrevToCaretDescription","XtraRichEditStringId.MenuCmd_SelectTable":"Select Table","XtraRichEditStringId.MenuCmd_SelectTableCell":"Select Cell","XtraRichEditStringId.MenuCmd_SelectTableCellDescription":"Select Cell","XtraRichEditStringId.MenuCmd_SelectTableColumns":"Select Column","XtraRichEditStringId.MenuCmd_SelectTableColumnsDescription":"Select Column","XtraRichEditStringId.MenuCmd_SelectTableDescription":"Select Table","XtraRichEditStringId.MenuCmd_SelectTableElements":"Select","XtraRichEditStringId.MenuCmd_SelectTableElementsDescription":"Select the current cell, row, column, or entire table.","XtraRichEditStringId.MenuCmd_SelectTableRow":"Select Row","XtraRichEditStringId.MenuCmd_SelectTableRowDescription":"Select Row","XtraRichEditStringId.MenuCmd_SetDoubleParagraphSpacing":"2.0","XtraRichEditStringId.MenuCmd_SetDoubleParagraphSpacingDescription":" ","XtraRichEditStringId.MenuCmd_SetFloatingObjectBehindTextWrapType":"Behind Text","XtraRichEditStringId.MenuCmd_SetFloatingObjectBehindTextWrapTypeDescription":" ","XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomCenterAlignment":"Bottom Center","XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomCenterAlignmentDescription":"Position in Bottom Center with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomLeftAlignment":"Bottom Left","XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomLeftAlignmentDescription":"Position in Bottom Left with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomRightAlignment":"Bottom Right","XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomRightAlignmentDescription":"Position in Bottom Right with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetFloatingObjectInFrontOfTextWrapType":"In Front of Text","XtraRichEditStringId.MenuCmd_SetFloatingObjectInFrontOfTextWrapTypeDescription":" ","XtraRichEditStringId.MenuCmd_SetFloatingObjectInlineWithTextWrapType":"In Line with Text","XtraRichEditStringId.MenuCmd_SetFloatingObjectInlineWithTextWrapTypeDescription":" ","XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleCenterAlignment":"Middle Center","XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleCenterAlignmentDescription":"Position in Middle Center with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleLeftAlignment":"Middle Left","XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleLeftAlignmentDescription":"Position in Middle Left with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleRightAlignment":"Middle Right","XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleRightAlignmentDescription":"Position in Middle Right with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetFloatingObjectSquareTextWrapType":"Square","XtraRichEditStringId.MenuCmd_SetFloatingObjectSquareTextWrapTypeDescription":" ","XtraRichEditStringId.MenuCmd_SetFloatingObjectThroughTextWrapType":"Through","XtraRichEditStringId.MenuCmd_SetFloatingObjectThroughTextWrapTypeDescription":" ","XtraRichEditStringId.MenuCmd_SetFloatingObjectTightTextWrapType":"Tight","XtraRichEditStringId.MenuCmd_SetFloatingObjectTightTextWrapTypeDescription":" ","XtraRichEditStringId.MenuCmd_SetFloatingObjectTopAndBottomTextWrapType":"Top and Bottom","XtraRichEditStringId.MenuCmd_SetFloatingObjectTopAndBottomTextWrapTypeDescription":" ","XtraRichEditStringId.MenuCmd_SetFloatingObjectTopCenterAlignment":"Top Center","XtraRichEditStringId.MenuCmd_SetFloatingObjectTopCenterAlignmentDescription":"Position in Top Center with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetFloatingObjectTopLeftAlignment":"Top Left","XtraRichEditStringId.MenuCmd_SetFloatingObjectTopLeftAlignmentDescription":"Position in Top Left with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetFloatingObjectTopRightAlignment":"Top Right","XtraRichEditStringId.MenuCmd_SetFloatingObjectTopRightAlignmentDescription":"Position in Top Right with Square Text Wrapping","XtraRichEditStringId.MenuCmd_SetHyphenateDocumentAutomatic":"Automatic","XtraRichEditStringId.MenuCmd_SetHyphenateDocumentAutomaticDescription":"Turns on Automatic Hyphenation","XtraRichEditStringId.MenuCmd_SetHyphenateDocumentNone":"None","XtraRichEditStringId.MenuCmd_SetHyphenateDocumentNoneDescription":"Turns off Automatic Hyphenation","XtraRichEditStringId.MenuCmd_SetLandscapePageOrientation":"Landscape","XtraRichEditStringId.MenuCmd_SetLandscapePageOrientationDescription":" ","XtraRichEditStringId.MenuCmd_SetModerateSectionPageMargins":"ModerateTop:\t{1,10}\tBottom:\t{3,10}Left:\t{0,10}\tRight:\t\t{2,10}","XtraRichEditStringId.MenuCmd_SetModerateSectionPageMarginsDescription":" ","XtraRichEditStringId.MenuCmd_SetNarrowSectionPageMargins":"NarrowTop:\t{1,10}\tBottom:\t{3,10}Left:\t{0,10}\tRight:\t\t{2,10}","XtraRichEditStringId.MenuCmd_SetNarrowSectionPageMarginsDescription":" ","XtraRichEditStringId.MenuCmd_SetNormalSectionPageMargins":"NormalTop:\t{1,10}\tBottom:\t{3,10}Left:\t{0,10}\tRight:\t\t{2,10}","XtraRichEditStringId.MenuCmd_SetNormalSectionPageMarginsDescription":" ","XtraRichEditStringId.MenuCmd_SetParagraphBodyTextLevel":"Do Not Show in Table of Contents","XtraRichEditStringId.MenuCmd_SetParagraphBodyTextLevelDescription":"Do Not Show in Table of Contents","XtraRichEditStringId.MenuCmd_SetParagraphHeading1Level":"Level 1","XtraRichEditStringId.MenuCmd_SetParagraphHeading1LevelDescription":"Level 1","XtraRichEditStringId.MenuCmd_SetParagraphHeading2Level":"Level 2","XtraRichEditStringId.MenuCmd_SetParagraphHeading2LevelDescription":"Level 2","XtraRichEditStringId.MenuCmd_SetParagraphHeading3Level":"Level 3","XtraRichEditStringId.MenuCmd_SetParagraphHeading3LevelDescription":"Level 3","XtraRichEditStringId.MenuCmd_SetParagraphHeading4Level":"Level 4","XtraRichEditStringId.MenuCmd_SetParagraphHeading4LevelDescription":"Level 4","XtraRichEditStringId.MenuCmd_SetParagraphHeading5Level":"Level 5","XtraRichEditStringId.MenuCmd_SetParagraphHeading5LevelDescription":"Level 5","XtraRichEditStringId.MenuCmd_SetParagraphHeading6Level":"Level 6","XtraRichEditStringId.MenuCmd_SetParagraphHeading6LevelDescription":"Level 6","XtraRichEditStringId.MenuCmd_SetParagraphHeading7Level":"Level 7","XtraRichEditStringId.MenuCmd_SetParagraphHeading7LevelDescription":"Level 7","XtraRichEditStringId.MenuCmd_SetParagraphHeading8Level":"Level 8","XtraRichEditStringId.MenuCmd_SetParagraphHeading8LevelDescription":"Level 8","XtraRichEditStringId.MenuCmd_SetParagraphHeading9Level":"Level 9","XtraRichEditStringId.MenuCmd_SetParagraphHeading9LevelDescription":"Level 9","XtraRichEditStringId.MenuCmd_SetParagraphHeadingLevel":"Level {0}","XtraRichEditStringId.MenuCmd_SetParagraphHeadingLevelDescription":"Level {0}","XtraRichEditStringId.MenuCmd_SetPortraitPageOrientation":"Portrait","XtraRichEditStringId.MenuCmd_SetPortraitPageOrientationDescription":" ","XtraRichEditStringId.MenuCmd_SetSectionColumns":"Columns","XtraRichEditStringId.MenuCmd_SetSectionColumnsDescription":"Split text into two or more columns.","XtraRichEditStringId.MenuCmd_SetSectionLineNumberingContinuous":"Continuous","XtraRichEditStringId.MenuCmd_SetSectionLineNumberingContinuousDescription":"Continuous","XtraRichEditStringId.MenuCmd_SetSectionLineNumberingNone":"None","XtraRichEditStringId.MenuCmd_SetSectionLineNumberingNoneDescription":"No line numbers.","XtraRichEditStringId.MenuCmd_SetSectionLineNumberingRestartNewPage":"Restart Each Page","XtraRichEditStringId.MenuCmd_SetSectionLineNumberingRestartNewPageDescription":"Restart Each Page","XtraRichEditStringId.MenuCmd_SetSectionLineNumberingRestartNewSection":"Restart Each Section","XtraRichEditStringId.MenuCmd_SetSectionLineNumberingRestartNewSectionDescription":"Restart Each Section","XtraRichEditStringId.MenuCmd_SetSectionOneColumn":"One","XtraRichEditStringId.MenuCmd_SetSectionOneColumnDescription":"One column.","XtraRichEditStringId.MenuCmd_SetSectionThreeColumns":"Three","XtraRichEditStringId.MenuCmd_SetSectionThreeColumnsDescription":"Three columns.","XtraRichEditStringId.MenuCmd_SetSectionTwoColumns":"Two","XtraRichEditStringId.MenuCmd_SetSectionTwoColumnsDescription":"Two columns.","XtraRichEditStringId.MenuCmd_SetSesquialteralParagraphSpacing":"1.5","XtraRichEditStringId.MenuCmd_SetSesquialteralParagraphSpacingDescription":" ","XtraRichEditStringId.MenuCmd_SetSingleParagraphSpacing":"1.0","XtraRichEditStringId.MenuCmd_SetSingleParagraphSpacingDescription":" ","XtraRichEditStringId.MenuCmd_SetWideSectionPageMargins":"WideTop:\t{1,10}\tBottom:\t{3,10}Left:\t{0,10}\tRight:\t\t{2,10}","XtraRichEditStringId.MenuCmd_SetWideSectionPageMarginsDescription":" ","XtraRichEditStringId.MenuCmd_ShiftTabKey":"ShiftTabKey","XtraRichEditStringId.MenuCmd_ShiftTabKeyDescription":"ShiftTabKey","XtraRichEditStringId.MenuCmd_ShowAllFieldCodes":"Show All Field Codes","XtraRichEditStringId.MenuCmd_ShowAllFieldCodesDescription":"View the document markup with dynamic elements displaying their rich-text codes.","XtraRichEditStringId.MenuCmd_ShowAllFieldResults":"Show All Field Results","XtraRichEditStringId.MenuCmd_ShowAllFieldResultsDescription":"View the document content with dynamic elements displaying real data.","XtraRichEditStringId.MenuCmd_ShowBookmarkForm":"Bookmark","XtraRichEditStringId.MenuCmd_ShowBookmarkFormDescription":"Create a bookmark to assign a name to a specific point in a documentYou can make hyperlinks that jump directly to a bookmarked location.","XtraRichEditStringId.MenuCmd_ShowBordersShadingForm":"Borders and Shading","XtraRichEditStringId.MenuCmd_ShowBordersShadingFormDescription":"Explore additional border options, such as line color and line width","XtraRichEditStringId.MenuCmd_ShowColumnsSetupForm":"More Columns...","XtraRichEditStringId.MenuCmd_ShowColumnsSetupFormDescription":"Show the Column dialog box to customize column widths.","XtraRichEditStringId.MenuCmd_ShowCommentForm":"Comment","XtraRichEditStringId.MenuCmd_ShowCommentFormDescription":"Show the Comment dialog box.","XtraRichEditStringId.MenuCmd_ShowDocumentProperties":"Document Properties","XtraRichEditStringId.MenuCmd_ShowDocumentPropertiesDescription":"Show the Properties dialog box.","XtraRichEditStringId.MenuCmd_ShowEditStyleForm":"Modify Style...","XtraRichEditStringId.MenuCmd_ShowEditStyleFormDescription":"Show the Edit Style dialog box.","XtraRichEditStringId.MenuCmd_ShowFloatingObjectLayoutOptionsForm":"More Layout Options...","XtraRichEditStringId.MenuCmd_ShowFloatingObjectLayoutOptionsFormDescription":"Show the Layout dialog box.","XtraRichEditStringId.MenuCmd_ShowFontForm":"Font...","XtraRichEditStringId.MenuCmd_ShowFontFormDescription":"Show the Font dialog box.","XtraRichEditStringId.MenuCmd_ShowHyperlinkForm":"Hyperlink","XtraRichEditStringId.MenuCmd_ShowHyperlinkFormDescription":"Create a link to a Web page, a picture, an e-mail address, or a program.","XtraRichEditStringId.MenuCmd_ShowHyphenationForm":"Hyphenation Options...","XtraRichEditStringId.MenuCmd_ShowHyphenationFormDescription":"Change the hyphenation behavior of the selected text.","XtraRichEditStringId.MenuCmd_ShowInsertMergeFieldForm":"Insert Merge Field","XtraRichEditStringId.MenuCmd_ShowInsertMergeFieldFormDescription":"Add a field from a list of recipients or from a data table to the document.","XtraRichEditStringId.MenuCmd_ShowLineNumberingForm":"Line Numbering Options...","XtraRichEditStringId.MenuCmd_ShowLineNumberingFormDescription":"Line Numbering Options...","XtraRichEditStringId.MenuCmd_ShowLineSpacingForm":"Line Spacing Options...","XtraRichEditStringId.MenuCmd_ShowLineSpacingFormDescription":" ","XtraRichEditStringId.MenuCmd_ShowNumberingList":"Bullets and Numbering...","XtraRichEditStringId.MenuCmd_ShowNumberingListDescription":"Show the Numbered List dialog box.","XtraRichEditStringId.MenuCmd_ShowPageMarginsSetupForm":"Custom Margins...","XtraRichEditStringId.MenuCmd_ShowPageMarginsSetupFormDescription":" ","XtraRichEditStringId.MenuCmd_ShowPagePaperSetupForm":"More Paper Sizes...","XtraRichEditStringId.MenuCmd_ShowPagePaperSetupFormDescription":" ","XtraRichEditStringId.MenuCmd_ShowPageSetupForm":"Page Setup","XtraRichEditStringId.MenuCmd_ShowPageSetupFormDescription":"Show the Page Setup dialog box.","XtraRichEditStringId.MenuCmd_ShowParagraphForm":"Paragraph...","XtraRichEditStringId.MenuCmd_ShowParagraphFormDescription":"Show the Paragraph dialog box.","XtraRichEditStringId.MenuCmd_ShowPasteSpecialForm":"Paste Special","XtraRichEditStringId.MenuCmd_ShowPasteSpecialFormDescription":"Paste Special","XtraRichEditStringId.MenuCmd_ShowRangeEditingPermissionsForm":"Range Editing Permissions","XtraRichEditStringId.MenuCmd_ShowRangeEditingPermissionsFormDescription":"Grant user permissions to edit the selected part of the document.","XtraRichEditStringId.MenuCmd_ShowSymbol":"Symbol","XtraRichEditStringId.MenuCmd_ShowSymbolDescription":"Show the Symbol dialog box.","XtraRichEditStringId.MenuCmd_ShowTableOptionsForm":"Cell Margins","XtraRichEditStringId.MenuCmd_ShowTableOptionsFormDescription":"Customize cell margins and the spacing between cells.","XtraRichEditStringId.MenuCmd_ShowTablePropertiesForm":"Properties","XtraRichEditStringId.MenuCmd_ShowTablePropertiesFormDescription":"Show the Table Properties dialog box to change advanced table properties, such as indentation and text wrapping options.","XtraRichEditStringId.MenuCmd_ShowTablePropertiesFormDescriptionMenuItem":"Show the Table Properties dialog box.","XtraRichEditStringId.MenuCmd_ShowTablePropertiesFormMenuItem":"Table Properties...","XtraRichEditStringId.MenuCmd_ShowTabsForm":"Tabs...","XtraRichEditStringId.MenuCmd_ShowTabsFormDescription":"Tabs","XtraRichEditStringId.MenuCmd_SimpleView":"Simple View","XtraRichEditStringId.MenuCmd_SimpleViewDescription":"Simple View","XtraRichEditStringId.MenuCmd_SplitTable":"Split Table","XtraRichEditStringId.MenuCmd_SplitTableCells":"Split Cells","XtraRichEditStringId.MenuCmd_SplitTableCellsDescription":"Split the selected cells into multiple new cells.","XtraRichEditStringId.MenuCmd_SplitTableCellsMenuItem":"Split Cells...","XtraRichEditStringId.MenuCmd_SplitTableDescription":"Split the table into two tables.The selected row will become the first row of the new table.","XtraRichEditStringId.MenuCmd_SwitchToDraftView":"Draft View","XtraRichEditStringId.MenuCmd_SwitchToDraftViewDescription":"View the document as a draft to quickly edit the text.Certain elements of the document such as headers and footers will not be visible in this view.","XtraRichEditStringId.MenuCmd_SwitchToPrintLayoutView":"Print Layout","XtraRichEditStringId.MenuCmd_SwitchToPrintLayoutViewDescription":"View the document as it will appear on the printed page.","XtraRichEditStringId.MenuCmd_SwitchToSimpleView":"Simple View","XtraRichEditStringId.MenuCmd_SwitchToSimpleViewDescription":"View the document as a simple memo.This view ignores the page layout to draw attention to text editing.","XtraRichEditStringId.MenuCmd_SymbolFormInsertButton":"Insert","XtraRichEditStringId.MenuCmd_TabKey":"TabKey","XtraRichEditStringId.MenuCmd_TabKeyDescription":"TabKey","XtraRichEditStringId.MenuCmd_ToggleAllFields":"Toggle All Fields","XtraRichEditStringId.MenuCmd_ToggleAllFieldsDescription":"Toggle between displaying field codes and their results in the document","XtraRichEditStringId.MenuCmd_ToggleAuthorVisibility":"Toggle Authors Visibility","XtraRichEditStringId.MenuCmd_ToggleAuthorVisibilityDescription":"Toggle Authors Visibility","XtraRichEditStringId.MenuCmd_ToggleBandedColumn":"Banded Columns","XtraRichEditStringId.MenuCmd_ToggleBandedColumnDescription":"Display banded columns, in which even columns are formatted differently from odd columns.This banding can make tables easier to read.","XtraRichEditStringId.MenuCmd_ToggleBandedRows":"Banded Rows","XtraRichEditStringId.MenuCmd_ToggleBandedRowsDescription":"Display banded rows, in which even rows are formatted differently from odd rows.This banding can make tables easier to read.","XtraRichEditStringId.MenuCmd_ToggleDifferentFirstPage":"Different First Page","XtraRichEditStringId.MenuCmd_ToggleDifferentFirstPageDescription":"Specify a unique header and footer for the first page of the document.","XtraRichEditStringId.MenuCmd_ToggleDifferentOddAndEvenPages":"Different Odd & Even Pages","XtraRichEditStringId.MenuCmd_ToggleDifferentOddAndEvenPagesDescription":"Specify that odd-numbered pages should have a different header and footer from even-numbered pages.","XtraRichEditStringId.MenuCmd_ToggleFieldCodes":"Toggle Field Codes","XtraRichEditStringId.MenuCmd_ToggleFieldCodesDescription":"Toggle Field Codes","XtraRichEditStringId.MenuCmd_ToggleFieldLocked":"Toggle Field Locked","XtraRichEditStringId.MenuCmd_ToggleFieldLockedDescription":"Toggle Field Locked","XtraRichEditStringId.MenuCmd_ToggleFirstColumn":"First Column","XtraRichEditStringId.MenuCmd_ToggleFirstColumnDescription":"Display special formatting for the first column of the table.","XtraRichEditStringId.MenuCmd_ToggleFirstRow":"Header Row","XtraRichEditStringId.MenuCmd_ToggleFirstRowDescription":"Display special formatting for the first row of the table.","XtraRichEditStringId.MenuCmd_ToggleFontBold":"Bold","XtraRichEditStringId.MenuCmd_ToggleFontBoldDescription":"Make the selected text bold.","XtraRichEditStringId.MenuCmd_ToggleFontDoubleStrikeout":"Double Strikethrough","XtraRichEditStringId.MenuCmd_ToggleFontDoubleStrikeoutDescription":"Double strikethrough","XtraRichEditStringId.MenuCmd_ToggleFontDoubleUnderline":"Double Underline","XtraRichEditStringId.MenuCmd_ToggleFontDoubleUnderlineDescription":"Double underline","XtraRichEditStringId.MenuCmd_ToggleFontItalic":"Italic","XtraRichEditStringId.MenuCmd_ToggleFontItalicDescription":"Italicize the selected text.","XtraRichEditStringId.MenuCmd_ToggleFontStrikeout":"Strikethrough","XtraRichEditStringId.MenuCmd_ToggleFontStrikeoutDescription":"Draw a line through the middle of the selected text.","XtraRichEditStringId.MenuCmd_ToggleFontUnderline":"Underline","XtraRichEditStringId.MenuCmd_ToggleFontUnderlineDescription":"Underline the selected text.","XtraRichEditStringId.MenuCmd_ToggleHeaderFooterLinkToPrevious":"Link to Previous","XtraRichEditStringId.MenuCmd_ToggleHeaderFooterLinkToPreviousDescription":"Link to the previous section so that the header and footer in the current section contain the same content as in the previous section.","XtraRichEditStringId.MenuCmd_ToggleHiddenText":"Hidden","XtraRichEditStringId.MenuCmd_ToggleHiddenTextDescription":"Hidden.","XtraRichEditStringId.MenuCmd_ToggleLastColumn":"Last Column","XtraRichEditStringId.MenuCmd_ToggleLastColumnDescription":"Display special formatting for the last column of the table.","XtraRichEditStringId.MenuCmd_ToggleLastRow":"Total Row","XtraRichEditStringId.MenuCmd_ToggleLastRowDescription":"Display special formatting for the last row of the table.","XtraRichEditStringId.MenuCmd_ToggleOvertype":"Overtype","XtraRichEditStringId.MenuCmd_ToggleOvertypeDescription":"Overtype","XtraRichEditStringId.MenuCmd_ToggleShowHorizontalRuler":"Horizontal Ruler","XtraRichEditStringId.MenuCmd_ToggleShowHorizontalRulerDescription":"View the horizontal ruler, used to measure and line up objects in the document.","XtraRichEditStringId.MenuCmd_ToggleShowTableGridLines":"View Gridlines","XtraRichEditStringId.MenuCmd_ToggleShowTableGridLinesDescription":"Show or hide the gridlines within the table.","XtraRichEditStringId.MenuCmd_ToggleShowVerticalRuler":"Vertical Ruler","XtraRichEditStringId.MenuCmd_ToggleShowVerticalRulerDescription":"View the vertical ruler, used to measure and line up objects in the document.","XtraRichEditStringId.MenuCmd_ToggleSpellCheckAsYouType":"Check Spelling As You Type","XtraRichEditStringId.MenuCmd_ToggleSpellCheckAsYouTypeDescription":"Check Spelling As You Type","XtraRichEditStringId.MenuCmd_ToggleTableAutoFitContents":"AutoFit Contents","XtraRichEditStringId.MenuCmd_ToggleTableAutoFitContentsDescription":"Auto-Fit Table to the contents.","XtraRichEditStringId.MenuCmd_ToggleTableAutoFitPlaceholder":"AutoFit","XtraRichEditStringId.MenuCmd_ToggleTableAutoFitPlaceholderDescription":"Automatically resize the column widths based on the text in them.You can set the table width based on the window size or convert it back to use fixed column widths.","XtraRichEditStringId.MenuCmd_ToggleTableAutoFitWindow":"AutoFit Window","XtraRichEditStringId.MenuCmd_ToggleTableAutoFitWindowDescription":"Auto-Fit Table to the window.","XtraRichEditStringId.MenuCmd_ToggleTableCellsAllBorders":"All Borders","XtraRichEditStringId.MenuCmd_ToggleTableCellsAllBordersDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomBorder":"Bottom Border","XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomBorderDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomCenterAlignment":"Align Bottom Center","XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomCenterAlignmentDescription":"Center text and align it to the bottom of the cell.","XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomLeftAlignment":"Align Bottom Left","XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomLeftAlignmentDescription":"Align text to the bottom left corner of the cell.","XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomRightAlignment":"Align Bottom Right","XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomRightAlignmentDescription":"Align text to the bottom right corner of the cell.","XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideBorder":"Inside Borders","XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideBorderDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideHorizontalBorder":"Inside Horizontal Border","XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideHorizontalBorderDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideVerticalBorder":"Inside Vertical Border","XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideVerticalBorderDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsLeftBorder":"Left Border","XtraRichEditStringId.MenuCmd_ToggleTableCellsLeftBorderDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleCenterAlignment":"Align Center","XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleCenterAlignmentDescription":"Center text horizontally and vertically within the cell.","XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleLeftAlignment":"Align Center Left","XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleLeftAlignmentDescription":"Center text vertically and align it to the left side of the cell.","XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleRightAlignment":"Align Center Right","XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleRightAlignmentDescription":"Center text vertically and align it to the right side of the cell.","XtraRichEditStringId.MenuCmd_ToggleTableCellsOutsideBorder":"Outside Borders","XtraRichEditStringId.MenuCmd_ToggleTableCellsOutsideBorderDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsRightBorder":"Right Border","XtraRichEditStringId.MenuCmd_ToggleTableCellsRightBorderDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsTopBorder":"Top Border","XtraRichEditStringId.MenuCmd_ToggleTableCellsTopBorderDescription":"Customize the borders of the selected cells.","XtraRichEditStringId.MenuCmd_ToggleTableCellsTopCenterAlignment":"Align Top Center","XtraRichEditStringId.MenuCmd_ToggleTableCellsTopCenterAlignmentDescription":"Center text and align it to the top of the cell.","XtraRichEditStringId.MenuCmd_ToggleTableCellsTopLeftAlignment":"Align Top Left","XtraRichEditStringId.MenuCmd_ToggleTableCellsTopLeftAlignmentDescription":"Align text to the top left corner of the cell.","XtraRichEditStringId.MenuCmd_ToggleTableCellsTopRightAlignment":"Align Top Right","XtraRichEditStringId.MenuCmd_ToggleTableCellsTopRightAlignmentDescription":"Align text to the top right corner of the cell.","XtraRichEditStringId.MenuCmd_ToggleTableFixedColumnWidth":"Fixed Column Width","XtraRichEditStringId.MenuCmd_ToggleTableFixedColumnWidthDescription":"Set table size to a fixed width.","XtraRichEditStringId.MenuCmd_ToggleTextCase":"tOGGLE cASE","XtraRichEditStringId.MenuCmd_ToggleTextCaseDescription":"tOGGLE cASE.","XtraRichEditStringId.MenuCmd_ToggleViewMergedData":"View Merged Data","XtraRichEditStringId.MenuCmd_ToggleViewMergedDataDescription":"Replaces the merge fields in your document with actual data from your recipient list so you can see what it looks like.","XtraRichEditStringId.MenuCmd_ToggleWhitespace":"Show/Hide ¶","XtraRichEditStringId.MenuCmd_ToggleWhitespaceDescription":"Show paragraph marks and other hidden formatting symbols.","XtraRichEditStringId.MenuCmd_Undo":"Undo","XtraRichEditStringId.MenuCmd_UndoDescription":"Undo the last operation.","XtraRichEditStringId.MenuCmd_UnlockField":"Unlock Field","XtraRichEditStringId.MenuCmd_UnlockFieldDescription":"Unlock Field","XtraRichEditStringId.MenuCmd_UnprotectDocument":"Unprotect Document","XtraRichEditStringId.MenuCmd_UnprotectDocumentDescription":"Enable users to edit the document.","XtraRichEditStringId.MenuCmd_UpdateField":"Update Field","XtraRichEditStringId.MenuCmd_UpdateFieldDescription":"Update Field","XtraRichEditStringId.MenuCmd_UpdateFields":"Update Fields","XtraRichEditStringId.MenuCmd_UpdateFieldsDescription":"Update Fields","XtraRichEditStringId.MenuCmd_UpdateTableOfContents":"Update Table","XtraRichEditStringId.MenuCmd_UpdateTableOfContentsDescription":"Update the Table of Contents so that all the entries refer to the correct page number.","XtraRichEditStringId.MenuCmd_UpdateTableOfFigures":"Update Table","XtraRichEditStringId.MenuCmd_UpdateTableOfFiguresDescription":"Update the Table of Figures to include all of the entries in the document.","XtraRichEditStringId.MenuCmd_Zoom":"Zoom","XtraRichEditStringId.MenuCmd_ZoomDescription":"Zoom","XtraRichEditStringId.MenuCmd_ZoomIn":"Zoom In","XtraRichEditStringId.MenuCmd_ZoomInDescription":"Zoom in to get a close-up view of the document.","XtraRichEditStringId.MenuCmd_ZoomOut":"Zoom Out","XtraRichEditStringId.MenuCmd_ZoomOutDescription":"Zoom out to see more of the page at a reduced size.","XtraRichEditStringId.Msg_BookmarkCreationFailing":"Bookmark with the same name already exists. Replace?","XtraRichEditStringId.Msg_CantDeleteDefaultStyle":"Cannot delete default style.","XtraRichEditStringId.Msg_CantPasteFormField":"You cannot paste form fields into comments, headers, footers, footnotes, endnotes, or text boxes.","XtraRichEditStringId.Msg_CantResetDefaultProperties":"Can not reset default style settings.","XtraRichEditStringId.Msg_ClickToComment":" commented:","XtraRichEditStringId.Msg_ClickToFollowHyperlink":"Click to follow link","XtraRichEditStringId.Msg_ContinueSearchFromBeginningQuestion":"Do you want to start the search from the beginning of the document?","XtraRichEditStringId.Msg_ContinueSearchFromEndQuestion":"Do you want to start the search from the end of the document?","XtraRichEditStringId.Msg_ContinueSearchInRemainderQuestion":"Do you want to search the remainder of the document?","XtraRichEditStringId.Msg_CreateHyperlinkError":"Cannot create a hyperlink. The hyperlink in the specified range already exists.","XtraRichEditStringId.Msg_DeleteTableStyleQuestion":"Do you want to delete style {0} from the document?","XtraRichEditStringId.Msg_DocumentPositionDoesntMatchDocument":"Error: specified document position or range belongs to other document or subdocument","XtraRichEditStringId.Msg_DocumentProtectionInvalidPassword":"The password is incorrect!","XtraRichEditStringId.Msg_DocumentProtectionInvalidPasswordConfirmation":"The password confirmation doesn't match.","XtraRichEditStringId.Msg_DuplicateBookmark":"Bookmark with that name already exists in the document","XtraRichEditStringId.Msg_EncryptedFile":"Encrypted files are not currently supported","XtraRichEditStringId.Msg_EncryptedFileIntegrityCheckFailed":"This file may have been tampered with or corrupted and the contents should not be trusted. Do you wish to continue opening this file?","XtraRichEditStringId.Msg_ErrorInvalidCustomPropertyValue":"The value entered does not match the specified type. The value will be stored as text.","XtraRichEditStringId.Msg_ErrorLinkDeletedStyle":"Error: cannot link deleted style","XtraRichEditStringId.Msg_IncorrectBookmarkName":"Bookmark name should start with a letter and contain only alphanumeric characters and underscore.","XtraRichEditStringId.Msg_IncorrectNumericFieldFormat":"Error: number cannot be represented in the specified format.","XtraRichEditStringId.Msg_IncorrectPassword":"The password you supplied is not correct. Verify that the CAPS LOCK key is off and be sure to use the correct capitalization.","XtraRichEditStringId.Msg_IncorrectPattern":"Incorrect pattern.","XtraRichEditStringId.Msg_IntegrityCheckFailedError":"Encrypted file integrity check failed!This file may have been tampered with or corrupted.","XtraRichEditStringId.Msg_InternalError":"An internal error occurred","XtraRichEditStringId.Msg_InvalidBeginInit":"Error: call to BeginInit inside BeginUpdate","XtraRichEditStringId.Msg_InvalidBeginUpdate":"Error: call to BeginUpdate inside BeginInit","XtraRichEditStringId.Msg_InvalidCopyFromDocumentModel":"Error: source and destination document models are different","XtraRichEditStringId.Msg_InvalidDivisor":"The number must be a divisor of {0}.","XtraRichEditStringId.Msg_InvalidDocumentModel":"Error: document models are different","XtraRichEditStringId.Msg_InvalidEndInit":"Error: call to EndInit or CancelInit without BeginInit or inside BeginUpdate","XtraRichEditStringId.Msg_InvalidEndUpdate":"Error: call to EndUpdate or CancelUpate without BeginUpdate or inside BeginInit","XtraRichEditStringId.Msg_InvalidFontSize":"The number must be between {0} and {1}.","XtraRichEditStringId.Msg_InvalidHeaderFooterOffset":"The measurement must be between {0} and {1}.","XtraRichEditStringId.Msg_InvalidHtmlImagePath":"The specified image path does not exist.","XtraRichEditStringId.Msg_InvalidImageFile":"The specified image is not valid.","XtraRichEditStringId.Msg_InvalidNavigateUri":"The address of this site is not valid. Check the address and try again.","XtraRichEditStringId.Msg_InvalidNumber":"This is not a valid number.","XtraRichEditStringId.Msg_InvalidNumberingListIndex":"NumberingListIndex refers to a list that does not exist.","XtraRichEditStringId.Msg_InvalidNumberingListStartAtValue":"'Start At' must be between {0} and {1} for this format","XtraRichEditStringId.Msg_InvalidParagraphContainNumbering":"Error: paragraph already contains numbering","XtraRichEditStringId.Msg_InvalidParentStyle":"Error: invalid parent style assignment caused circular reference","XtraRichEditStringId.Msg_InvalidSetCharacterProperties":"Error: cannot set properties without BeginInit or without adding object to document","XtraRichEditStringId.Msg_InvalidSetParagraphProperties":"Error: cannot set properties without BeginInit or without adding object to document","XtraRichEditStringId.Msg_InvalidStyleName":"Invalid style name","XtraRichEditStringId.Msg_InvalidTabStop":"This is not a valid tab stop.","XtraRichEditStringId.Msg_InvalidValueRange":"The value must be between {0} and {1}.","XtraRichEditStringId.Msg_IsNotValid":"'{0}' is not a valid value for '{1}'","XtraRichEditStringId.Msg_LeftRightSectionMarginsTooLarge":"The left/right margins are too large for the page height in some sections.","XtraRichEditStringId.Msg_Loading":"Loading...","XtraRichEditStringId.Msg_MagicNumberNotFound":"The file you are trying to open is in different format than specified by the file extension.","XtraRichEditStringId.Msg_MenuManagerPropertyIsNotSet":"The MenuManager property of RichEditControl is not set.","XtraRichEditStringId.Msg_MissingOperator":"!Missing operator.","XtraRichEditStringId.Msg_NoDefaultTabs":"Default tab stops cannot be set.","XtraRichEditStringId.Msg_NoTocEntriesFound":"No table of contents entries found.","XtraRichEditStringId.Msg_NumberingListNotInListCollection":"Cannot use a numbering List. The numbering list must be added to Document.NumberingLists collection","XtraRichEditStringId.Msg_OperationIsNotValidDueDocumentState":"Operation is not valid due to the current state of the document.","XtraRichEditStringId.Msg_ParagraphStyleNameAlreadyExists":"This style name already exists.","XtraRichEditStringId.Msg_PasswordNotConfirmed":"Confirmation password is not identical.","XtraRichEditStringId.Msg_PasswordRequiredError":"Password required to open this file!","XtraRichEditStringId.Msg_PasswordTooLong":"Password length must be less than {0} characters long.","XtraRichEditStringId.Msg_PrintingUnavailable":"Printing is not available. Check if the following assemblies are installed:{0}","XtraRichEditStringId.Msg_ReplacementsCount":"{0} replacements were made.","XtraRichEditStringId.Msg_Saving":"Saving...","XtraRichEditStringId.Msg_SearchComplete":"The search is complete.","XtraRichEditStringId.Msg_SearchInBackwardDirectionComplete":"The beginning of the document has been reached.","XtraRichEditStringId.Msg_SearchInForwardDirectionComplete":"The end of the document has been reached.","XtraRichEditStringId.Msg_SearchInSelectionComplete":"The search in the selection is finished.","XtraRichEditStringId.Msg_SearchItemNotFound":"The search item was not found.","XtraRichEditStringId.Msg_SelectBookmarkError":"Cannot select a bookmark of inactive SubDocument.","XtraRichEditStringId.Msg_SelectCommentError":"Cannot select a comment of inactive SubDocument.","XtraRichEditStringId.Msg_StyleAlreadyLinked":"Error: style already contains a linked style","XtraRichEditStringId.Msg_StyleNameIsEmpty":"The style name cannot be empty.","XtraRichEditStringId.Msg_SyntaxErrorInFieldPattern":"Syntax Error, {0}.","XtraRichEditStringId.Msg_TableExceedsMaximumNumberOfColumns":"This exceeds the maximum number of columns.","XtraRichEditStringId.Msg_TableIntegrityError":"Error: broken table integrity","XtraRichEditStringId.Msg_TopBottomSectionMarginsTooLarge":"The top/bottom margins are too large for the page height in some sections.","XtraRichEditStringId.Msg_UnexpectedEndOfFormula":"!Unexpected end of formula.","XtraRichEditStringId.Msg_UnknownSwitchArgument":"Error! Unknown switch argument.","XtraRichEditStringId.Msg_UnmatchedQuotesInFieldPattern":"Error: pattern string contains unmatched quotes.","XtraRichEditStringId.Msg_UnsupportedDocVersion":"Only MS Word 97 and later versions are supported","XtraRichEditStringId.Msg_UnsupportedFormatException":"Unsupported format or corrupted file","XtraRichEditStringId.Msg_UseDeletedBookmarkError":"Error: using deleted bookmark","XtraRichEditStringId.Msg_UseDeletedCommentError":"Error: using deleted comment","XtraRichEditStringId.Msg_UseDeletedCustomMarkError":"Error: using deleted customMark","XtraRichEditStringId.Msg_UseDeletedFieldError":"Error: using deleted field","XtraRichEditStringId.Msg_UseDeletedFormFieldError":"Error: using deleted form field","XtraRichEditStringId.Msg_UseDeletedHyperlinkError":"Error: using deleted hyperlink","XtraRichEditStringId.Msg_UseDeletedParagraphError":"Error: using deleted paragraph","XtraRichEditStringId.Msg_UseDeletedSectionError":"Error: using deleted section","XtraRichEditStringId.Msg_UseDeletedStyleError":"Error: using deleted style","XtraRichEditStringId.Msg_UseDeletedTableCellError":"Error: using deleted table cell","XtraRichEditStringId.Msg_UseDeletedTableError":"Error: using deleted table","XtraRichEditStringId.Msg_UseDeletedTableRowError":"Error: using deleted table row","XtraRichEditStringId.Msg_UsedWrongUnit":"The unit of measurement is incorrectly specified.","XtraRichEditStringId.Msg_UseInvalidCharacterProperties":"Error: character properties are no longer valid","XtraRichEditStringId.Msg_UseInvalidCompatibilitySettings":"Error: these compatibility settings are no longer valid","XtraRichEditStringId.Msg_UseInvalidCustomProperties":"Error: this custom properties is no longer valid","XtraRichEditStringId.Msg_UseInvalidDocument":"Error: this document is no longer valid","XtraRichEditStringId.Msg_UseInvalidDocumentEncryption":"Error: these document encryption settings are no longer valid","XtraRichEditStringId.Msg_UseInvalidDocumentProperties":"Error: this document properties is no longer valid","XtraRichEditStringId.Msg_UseInvalidDocumentTrackChangesOptions":"Error: these document track changes options are no longer valid","XtraRichEditStringId.Msg_UseInvalidParagraphProperties":"Error: paragraph properties are no longer valid","XtraRichEditStringId.Msg_VariableDeletedOrMissed":"Error: document variable is either missing or deleted (from Variables collection)","XtraRichEditStringId.Msg_WrongPasswordError":"Password check failed!","XtraRichEditStringId.Msg_ZeroDivide":"!Zero divide.","XtraRichEditStringId.MsgWinOnlyLimitation":"This action can be performed only on Windows operating system.","XtraRichEditStringId.No":"N","XtraRichEditStringId.Page":"Page {2}: [{3}] ","XtraRichEditStringId.RtlComment":"[{1} {0}] Comment","XtraRichEditStringId.SelectionCollection_AtLeastOneSelectionIsRequiredException":"Cannot remove a selection. At least one selection is required.","XtraRichEditStringId.SelectionCollection_CannotRemoveCaretException":"Cannot remove caret.","XtraRichEditStringId.SelectionCollection_CurrentSelectionAndSpecifiedSelectionIntersectException":"Current selection and the specified selection intersect.","XtraRichEditStringId.SelectionCollection_EmptyCollectionException":"Cannot add an empty collection.","XtraRichEditStringId.SelectionCollection_FirstCellContinuesVerticalMergeException":"The first cell in the selected range continues the vertical merge, which is not allowed in a selection collection.","XtraRichEditStringId.SelectionCollection_LastCellContinuesVerticalMergeException":"The last cell in the selected range continues the vertical merge, which is not allowed in a selection collection.","XtraRichEditStringId.SelectionCollection_OutOfRangeException":"Index was out of range. Must be non-negative and less than the size of the selection collection.","XtraRichEditStringId.SelectionCollection_PartiallySelectedCellsException":"Partially selected cells are not allowed.","XtraRichEditStringId.SelectionCollection_RangeCannotBeEmptyException":"Range cannot be empty.","XtraRichEditStringId.SelectionCollection_SelecitonShouldIncludeNotMoreThanOneRowException":"A selection range should include not more than one row","XtraRichEditStringId.SelectionCollection_SelectionCollectionEmptyException":"The selection collection is empty.","XtraRichEditStringId.SelectionCollection_SelectionExtendsOutsideTableException":"The selection extends outside the table, so the entire row must be selected.","XtraRichEditStringId.SelectionCollection_SelectionShouldContainAtLeastOneCharacterException":"The selection should contain at least one character.","XtraRichEditStringId.SelectionCollection_SpecifiedSelectionsIntersectException":"Specified selections intersect.","XtraRichEditStringId.TabForm_All":"All","XtraRichEditStringId.TargetFrameDescription_Blank":"New window","XtraRichEditStringId.TargetFrameDescription_Parent":"Parent frame","XtraRichEditStringId.TargetFrameDescription_Self":"Same frame","XtraRichEditStringId.TargetFrameDescription_Top":"Whole page","XtraRichEditStringId.UnderlineNone":"(none)","XtraRichEditStringId.UserGroup_Administrators":"Administrators","XtraRichEditStringId.UserGroup_Contributors":"Contributors","XtraRichEditStringId.UserGroup_CurrentUser":"Current User","XtraRichEditStringId.UserGroup_Editors":"Editors","XtraRichEditStringId.UserGroup_Everyone":"Everyone","XtraRichEditStringId.UserGroup_Owners":"Owners","XtraRichEditStringId.Yes":"Y","ASPxRichEditStringId.Font":"Font","ASPxRichEditStringId.FontStyle":"Font style","ASPxRichEditStringId.FontSize":"Font size","ASPxRichEditStringId.FontColor":"Font color","ASPxRichEditStringId.UnderlineStyle":"Underline style","ASPxRichEditStringId.UnderlineColor":"Underline color","ASPxRichEditStringId.Effects":"Effect","ASPxRichEditStringId.AllCaps":"All caps","ASPxRichEditStringId.SmallCaps":"Small caps","ASPxRichEditStringId.Hidden":"Hidden","ASPxRichEditStringId.Normal":"Normal","ASPxRichEditStringId.Bold":"Bold","ASPxRichEditStringId.Italic":"Italic","ASPxRichEditStringId.BoldItalic":"Bold Italic","ASPxRichEditStringId.UnderlineWordsOnly":"Underline words only","ASPxRichEditStringId.UnderlineType_None":"None","ASPxRichEditStringId.UnderlineType_Single":"Single","ASPxRichEditStringId.UnderlineType_Dotted":"Dotted","ASPxRichEditStringId.UnderlineType_Dashed":"Dashed","ASPxRichEditStringId.UnderlineType_DashDotted":"Dash Dotted","ASPxRichEditStringId.UnderlineType_DashDotDotted":"Dash Dot Dotted","ASPxRichEditStringId.UnderlineType_Double":"Double","ASPxRichEditStringId.UnderlineType_HeavyWave":"Heavy Wave","ASPxRichEditStringId.UnderlineType_LongDashed":"Long Dashed","ASPxRichEditStringId.UnderlineType_ThickSingle":"Thick Single","ASPxRichEditStringId.UnderlineType_ThickDotted":"Thick Dotted","ASPxRichEditStringId.UnderlineType_ThickDashed":"Thick Dashed","ASPxRichEditStringId.UnderlineType_ThickDashDotted":"Thick Dash Dotted","ASPxRichEditStringId.UnderlineType_ThickDashDotDotted":"Thick Dash Dot Dotted","ASPxRichEditStringId.UnderlineType_ThickLongDashed":"Thick Long Dashed","ASPxRichEditStringId.UnderlineType_DoubleWave":"Double Wave","ASPxRichEditStringId.UnderlineType_Wave":"Wave","ASPxRichEditStringId.UnderlineType_DashSmallGap":"Dash Small Gap","ASPxRichEditStringId.StrikeoutType_None":"None","ASPxRichEditStringId.StrikeoutType_Single":"Single","ASPxRichEditStringId.StrikeoutType_Double":"Double","ASPxRichEditStringId.CharacterFormattingScript_Normal":"Normal","ASPxRichEditStringId.CharacterFormattingScript_Subscript":"Subscript","ASPxRichEditStringId.CharacterFormattingScript_Superscript":"Superscript","ASPxRichEditStringId.ParagraphTab0":"Indents And Spacing","ASPxRichEditStringId.ParagraphTab1":"Line And Page Breaks","ASPxRichEditStringId.General":"General","ASPxRichEditStringId.Alignment":"Alignment","ASPxRichEditStringId.Left":"Left","ASPxRichEditStringId.Right":"Right","ASPxRichEditStringId.Centered":"Centered","ASPxRichEditStringId.Justified":"Justified","ASPxRichEditStringId.OutlineLevel":"Outline level","ASPxRichEditStringId.BodyText":"Body Text","ASPxRichEditStringId.Level":"Level","ASPxRichEditStringId.Indentation":"Indentation","ASPxRichEditStringId.Special":"Special","ASPxRichEditStringId.By":"By","ASPxRichEditStringId.none":"(none)","ASPxRichEditStringId.FirstLine":"First line","ASPxRichEditStringId.Hanging":"Hanging","ASPxRichEditStringId.Spacing":"Spacing","ASPxRichEditStringId.Before":"Before","ASPxRichEditStringId.LineSpacing":"Line spacing","ASPxRichEditStringId.At":"At","ASPxRichEditStringId.After":"After","ASPxRichEditStringId.Single":"Single","ASPxRichEditStringId.spacing_1_5_lines":"1.5 lines","ASPxRichEditStringId.Double":"Double","ASPxRichEditStringId.Multiple":"Multiple","ASPxRichEditStringId.Exactly":"Exactly","ASPxRichEditStringId.AtLeast":"At least","ASPxRichEditStringId.NoSpace":"Don't add space between paragraph of the same style","ASPxRichEditStringId.Pagination":"Pagination","ASPxRichEditStringId.KLT":"Keep lines together","ASPxRichEditStringId.PBB":"Page break before","ASPxRichEditStringId.Options":"Options","ASPxRichEditStringId.Preview":"Preview","ASPxRichEditStringId.Style":"Style","ASPxRichEditStringId.Color":"Color","ASPxRichEditStringId.SaveToServer":"Save file to the server","ASPxRichEditStringId.DownloadCopy":"Download a copy","ASPxRichEditStringId.FolderPath":"Folder path","ASPxRichEditStringId.FileType":"File type","ASPxRichEditStringId.FileName":"File name","ASPxRichEditStringId.ChooseType":"Choose download file type","ASPxRichEditStringId.SaveFileAs":"Save file as","ASPxRichEditStringId.Invalid_FileName":"Invalid file name","ASPxRichEditStringId.PathDoesNotExist":"Path does not exist.Check the path and try again.","ASPxRichEditStringId.Portrait":"Portrait","ASPxRichEditStringId.Landscape":"Landscape","ASPxRichEditStringId.Continuous":"Continuous","ASPxRichEditStringId.NewPage":"New page","ASPxRichEditStringId.EvenPage":"Even page","ASPxRichEditStringId.OddPage":"Odd page","ASPxRichEditStringId.WholeDocument":"Whole document","ASPxRichEditStringId.CurrentSection":"Current section","ASPxRichEditStringId.SelectedSections":"Selected sections","ASPxRichEditStringId.ThisPointForward":"This point forward","ASPxRichEditStringId.Margins":"Margins","ASPxRichEditStringId.Paper":"Paper","ASPxRichEditStringId.Layout":"Layout","ASPxRichEditStringId.Top":"Top","ASPxRichEditStringId.Bottom":"Bottom","ASPxRichEditStringId.Orientation":"Orientation","ASPxRichEditStringId.PaperSize":"Paper size","ASPxRichEditStringId.Width":"Width","ASPxRichEditStringId.Height":"Height","ASPxRichEditStringId.Section":"Section","ASPxRichEditStringId.SectionStart":"Section start","ASPxRichEditStringId.HeadersAndFooters":"Headers and footers","ASPxRichEditStringId.DifferentOddAndEven":"Different odd and even","ASPxRichEditStringId.DifferentFirstPage":"Different first page","ASPxRichEditStringId.ApplyTo":"Apply to","ASPxRichEditStringId.FromEdge":"From edge","ASPxRichEditStringId.Header":"Header","ASPxRichEditStringId.Footer":"Footer","ASPxRichEditStringId.CancelButton":"Cancel","ASPxRichEditStringId.OkButton":"OK","ASPxRichEditStringId.OpenButton":"Open","ASPxRichEditStringId.SaveAsButton":"Save","ASPxRichEditStringId.DownloadButton":"Download","ASPxRichEditStringId.SelectButton":"Select","ASPxRichEditStringId.InsertButton":"Insert","ASPxRichEditStringId.ChangeButton":"Change","ASPxRichEditStringId.CloseButton":"Close","ASPxRichEditStringId.InsertTable_TableSize":"Table Size","ASPxRichEditStringId.InsertTable_NumberOfColumns":"Number of columns","ASPxRichEditStringId.InsertTable_NumberOfRows":"Number of rows","ASPxRichEditStringId.SplitCells_MergeCells":"Merge cells before split","ASPxRichEditStringId.InsertCells_ShiftCellsRight":"Shift cells right","ASPxRichEditStringId.InsertCells_ShiftCellsDown":"Shift cells down","ASPxRichEditStringId.InsertCells_InsertEntireRow":"Insert entire row","ASPxRichEditStringId.InsertCells_InsertEntireColumn":"Insert entire column","ASPxRichEditStringId.DeleteCells_ShiftCellsLeft":"Shift cells left","ASPxRichEditStringId.DeleteCells_ShiftCellsUp":"Shift cells up","ASPxRichEditStringId.DeleteCells_DeleteEntireRow":"Delete entire row","ASPxRichEditStringId.DeleteCells_DeleteEntireColumn":"Delete entire column","ASPxRichEditStringId.InsertImage_FromWeb":"From the web (URL)","ASPxRichEditStringId.InsertImage_FromLocal":"From your computer","ASPxRichEditStringId.InsertImage_EnterUrl":"Enter image web address","ASPxRichEditStringId.InsertImage_UploadInstructions":"Browse your computer for the image file to upload","ASPxRichEditStringId.InsertImage_ImagePreview":"Image preview","ASPxRichEditStringId.TableProperties_Size":"Size","ASPxRichEditStringId.TableProperties_Alignment":"Alignment","ASPxRichEditStringId.TableProperties_VerticalAlignment":"Vertical alignment","ASPxRichEditStringId.TableProperties_MeasureIn":"Measure in","ASPxRichEditStringId.TableProperties_PreferredWidth":"Preferred width","ASPxRichEditStringId.TableProperties_IndentLeft":"Indent from left","ASPxRichEditStringId.TableProperties_SpecifyHeight":"Specify height","ASPxRichEditStringId.TableProperties_RowHeight":"Row height is","ASPxRichEditStringId.TableProperties_Table":"Table","ASPxRichEditStringId.TableProperties_Row":"Row","ASPxRichEditStringId.TableProperties_Column":"Column","ASPxRichEditStringId.TableProperties_Cell":"Cell","ASPxRichEditStringId.TableProperties_Options":"Options...","ASPxRichEditStringId.TableProperties_BordersAndShading":"Borders and Shading...","ASPxRichEditStringId.TableProperties_PreviousRow":"Previous row","ASPxRichEditStringId.TableProperties_NextRow":"Next row","ASPxRichEditStringId.TableProperties_PreviousColumn":"Previous column","ASPxRichEditStringId.TableProperties_NextColumn":"Next column","ASPxRichEditStringId.TableProperties_CantSplit":"Allow row to break across pages","ASPxRichEditStringId.TableOptions_DefaultCellMargins":"Default cell margins","ASPxRichEditStringId.TableOptions_DefaultCellSpacing":"Default cell spacing","ASPxRichEditStringId.TableOptions_AllowSpacing":"Allow spacing between cells","ASPxRichEditStringId.TableOptions_AutoResize":"Automatically resize to fit contents","ASPxRichEditStringId.BorderShading_Borders":"Borders","ASPxRichEditStringId.BorderShading_Shading":"Shading","ASPxRichEditStringId.BorderShading_Fill":"Fill","ASPxRichEditStringId.BorderShading_BordersDescription":"Click on diagram below or use buttons to apply borders","ASPxRichEditStringId.BorderShading_BordersNone":"None","ASPxRichEditStringId.BorderShading_BordersBox":"Box","ASPxRichEditStringId.BorderShading_BordersAll":"All","ASPxRichEditStringId.BorderShading_BordersGrid":"Grid","ASPxRichEditStringId.BorderShading_BordersCustom":"Custom","ASPxRichEditStringId.CellOptions_CellMargins":"Cell margins","ASPxRichEditStringId.CellOptions_SameAsTable":"Same as the whole table","ASPxRichEditStringId.CellOptions_WrapText":"Wrap text","ASPxRichEditStringId.Columns_Presets":"Presets","ASPxRichEditStringId.Columns_NumberOfColumns":"Number of columns","ASPxRichEditStringId.Columns_WidthAndSpacing":"Width and spacing","ASPxRichEditStringId.Columns_EqualWidth":"Equal column width","ASPxRichEditStringId.Columns_Col":"Col #:","ASPxRichEditStringId.Columns_Width":"Width","ASPxRichEditStringId.Columns_Spacing":"Spacing","ASPxRichEditStringId.PageFile":"File","ASPxRichEditStringId.PageHome":"Home","ASPxRichEditStringId.PageInsert":"Insert","ASPxRichEditStringId.PagePageLayout":"Page Layout","ASPxRichEditStringId.PageReferences":"References","ASPxRichEditStringId.PageMailings":"Mail Merge","ASPxRichEditStringId.PageReview":"Review","ASPxRichEditStringId.PageView":"View","ASPxRichEditStringId.PageHeaderAndFooter":"Header  Footer","ASPxRichEditStringId.PageTableDesign":"Design","ASPxRichEditStringId.PageTableLayout":"Layout","ASPxRichEditStringId.PageFloatingObjects":"Format","ASPxRichEditStringId.GroupUndo":"Undo","ASPxRichEditStringId.GroupFont":"Font","ASPxRichEditStringId.GroupParagraph":"Paragraph","ASPxRichEditStringId.GroupClipboard":"Clipboard","ASPxRichEditStringId.GroupEditing":"Editing","ASPxRichEditStringId.GroupCommon":"Common","ASPxRichEditStringId.GroupStyles":"Styles","ASPxRichEditStringId.GroupZoom":"Zoom","ASPxRichEditStringId.GroupShow":"Show","ASPxRichEditStringId.GroupIllustrations":"Illustrations","ASPxRichEditStringId.GroupText":"Text","ASPxRichEditStringId.GroupTables":"Tables","ASPxRichEditStringId.GroupSymbols":"Symbols","ASPxRichEditStringId.GroupLinks":"Links","ASPxRichEditStringId.GroupPages":"Pages","ASPxRichEditStringId.GroupHeaderFooter":"Header  Footer","ASPxRichEditStringId.GroupHeaderFooterToolsDesignClose":"Close","ASPxRichEditStringId.GroupHeaderFooterToolsDesignNavigation":"Navigation","ASPxRichEditStringId.GroupMailMerge":"Mail Merge","ASPxRichEditStringId.GroupInsertFields":"Insert Fields","ASPxRichEditStringId.GroupMailMergeView":"View","ASPxRichEditStringId.GroupCurrentRecord":"Current Record","ASPxRichEditStringId.GroupFinish":"Finish","ASPxRichEditStringId.GroupDocumentViews":"Document Views","ASPxRichEditStringId.GroupHeaderFooterToolsDesignOptions":"Options","ASPxRichEditStringId.GroupHeaderFooterToolsDesignPosition":"Position","ASPxRichEditStringId.GroupPageSetup":"Page Setup","ASPxRichEditStringId.GroupDocumentProtection":"Protect","ASPxRichEditStringId.GroupDocumentProofing":"Proofing","ASPxRichEditStringId.GroupDocumentComment":"Comment","ASPxRichEditStringId.GroupDocumentTracking":"Tracking","ASPxRichEditStringId.GroupTableOfContents":"Table of Contents","ASPxRichEditStringId.GroupFloatingPictureToolsArrange":"Arrange","ASPxRichEditStringId.GroupFloatingPictureToolsShapeStyles":"Shape Styles","ASPxRichEditStringId.GroupCaptions":"Captions","ASPxRichEditStringId.GroupPageBackground":"Background","ASPxRichEditStringId.GroupDocumentLanguage":"Language","ASPxRichEditStringId.GroupView":"View","ASPxRichEditStringId.GroupTableToolsDesignTableStyleOptions":"Table Style Options","ASPxRichEditStringId.GroupTableToolsDesignTableStyles":"Table Styles","ASPxRichEditStringId.GroupTableToolsDesignBordersAndShadings":"Borders  Shadings","ASPxRichEditStringId.GroupTableToolsLayoutTable":"Table","ASPxRichEditStringId.GroupTableToolsLayoutRowsAndColumns":"Rows  Columns","ASPxRichEditStringId.GroupTableToolsLayoutMerge":"Merge","ASPxRichEditStringId.GroupTableToolsLayoutCellSize":"Cell Size","ASPxRichEditStringId.GroupTableToolsLayoutAlignment":"Alignment","ASPxRichEditStringId.GroupFloatingObjectsShapeStyles":"Shape Styles","ASPxRichEditStringId.GroupFloatingObjectsArrange":"Arrange","ASPxRichEditStringId.RequiredFieldError":"This field is required","ASPxRichEditStringId.MenuCmd_ToggleFullScreen":"Full Screen","ASPxRichEditStringId.MenuCmd_ToggleFullScreenDescription":"Enable / disable the full screen mode.","ASPxRichEditStringId.SaveAsFileTitle":"Save As","ASPxRichEditStringId.OpenFileTitle":"Open","ASPxRichEditStringId.FontTitle":"Font","ASPxRichEditStringId.ParagraphTitle":"Paragraph","ASPxRichEditStringId.PageSetupTitle":"Page Setup","ASPxRichEditStringId.ColumnsTitle":"Columns","ASPxRichEditStringId.InsertTableTitle":"Insert Table","ASPxRichEditStringId.InsertTableCellsTitle":"Insert Cells","ASPxRichEditStringId.DeleteTableCellsTitle":"Delete Cells","ASPxRichEditStringId.SplitTableCellsTitle":"Split Cells","ASPxRichEditStringId.TablePropertiesTitle":"Table Properties","ASPxRichEditStringId.BorderShadingTitle":"Borders and Shading","ASPxRichEditStringId.InsertMergeFieldTitle":"Insert Merge Field","ASPxRichEditStringId.ExportRangeTitle":"Export Range","ASPxRichEditStringId.BookmarkTitle":"Bookmark","ASPxRichEditStringId.FindReplaceTitle":"Find and Replace","ASPxRichEditStringId.InsertImageTitle":"Insert Picture","ASPxRichEditStringId.ErrorTitle":"Error","ASPxRichEditStringId.SpellingTitle":"Spelling","ASPxRichEditStringId.InformationTitle":"Information","ASPxRichEditStringId.WarningTitle":"Warning","ASPxRichEditStringId.RulerMarginLeftTitle":"Margin Left","ASPxRichEditStringId.RulerMarginRightTitle":"Margin Right","ASPxRichEditStringId.RulerFirstLineIdentTitle":"First Line Ident","ASPxRichEditStringId.RulerHangingIdentTitle":"Hanging Ident","ASPxRichEditStringId.RulerRightIdentTitle":"Right Ident","ASPxRichEditStringId.RulerLeftIdentTitle":"Left Ident","ASPxRichEditStringId.RulerFirstLineIndentTitle":"First Line Indent","ASPxRichEditStringId.RulerHangingIndentTitle":"Hanging Indent","ASPxRichEditStringId.RulerRightIndentTitle":"Right Indent","ASPxRichEditStringId.RulerLeftIndentTitle":"Left Indent","ASPxRichEditStringId.RulerLeftTabTitle":"Left Tab","ASPxRichEditStringId.RulerRightTabTitle":"Right Tab","ASPxRichEditStringId.RulerCenterTabTitle":"Center Tab","ASPxRichEditStringId.RulerDecimalTabTitle":"Decimal Title","ASPxRichEditStringId.MarginsNarrow":"Narrow","ASPxRichEditStringId.MarginsNormal":"Normal","ASPxRichEditStringId.MarginsModerate":"Moderate","ASPxRichEditStringId.MarginsWide":"Wide","ASPxRichEditStringId.ModelIsChangedError":"The document has been modified outside the editor and needs to be reloaded. &lt;br /&gt;Your last-minute changes might not be preserved, if any.","ASPxRichEditStringId.SessionHasExpiredError":"Your session has expired. &lt;br /&gt;Please refresh the page to continue.","ASPxRichEditStringId.OpeningAndOverstoreImpossibleError":"The open and save document operations are not allowed&lt;br /&gt;since the working directory is not specified for the editor.","ASPxRichEditStringId.ClipboardAccessDeniedError":"Access to the clipboard is denied due to your browser's security policy. &lt;br /&gt;Instead, you can use the keyboard shortcuts:&lt;br /&gt;{0}+X (cut), {0}+C (copy) and {0}+V (paste).","ASPxRichEditStringId.ClipboardAccessDeniedErrorTouch":"Access to the clipboard is denied due to your browser's security policy. Instead, use the native menu that can be invoked by tapping and holding selected content.","ASPxRichEditStringId.InnerExceptionsError":"An unspecified error occurred and the editor needs to be reloaded. Your last changes can be lost.","ASPxRichEditStringId.AuthExceptionsError":"Access to the document is restricted and the editor needs to be reloaded. Your last changes can be lost.","ASPxRichEditStringId.CantSaveToEmptyPathError":"Cannot save a document opened not from a file. Handle the Saving event to process custom saving","ASPxRichEditStringId.ConfirmOnLosingChanges":"Are you sure you want to perform the action? All unsaved document data will be lost.","ASPxRichEditStringId.RestartNumbering":"Restart Numbering","ASPxRichEditStringId.ContinueNumbering":"Continue Numbering","ASPxRichEditStringId.UpdateField":"Update Field","ASPxRichEditStringId.ToggleFieldCodes":"Toggle Field Codes","ASPxRichEditStringId.OpenHyperlink":"Open hyperlink","ASPxRichEditStringId.EditHyperlink":"Edit hyperlink..","ASPxRichEditStringId.RemoveHyperlink":"Remove hyperlink","ASPxRichEditStringId.CantOpenDocumentError":"The document could not be opened because a server error occurred.","ASPxRichEditStringId.CantSaveDocumentError":"The document could not be saved because a server error occurred.","ASPxRichEditStringId.DocVariableExceptionError":"The DOCVARIABLE field could not be calculated because a server error occurred.","ASPxRichEditStringId.InvalidDocumentFormatError":"The file is corrupt and cannot be opened.","ASPxRichEditStringId.InsertContentFromServerExceptionError":"The InsertContentFromServerCommand could not be executed because a server error occurred.","ASPxRichEditStringId.LoadPictureError":"Could not load the image.","ASPxRichEditStringId.MenuCmd_CreateField":"Create Field","ASPxRichEditStringId.MenuCmd_CreateFieldDescription":"Create a dynamic element used as a placeholder for data that might change in a document.","ASPxRichEditStringId.MenuCmd_UpdateAllFields":"Update All Fields","ASPxRichEditStringId.MenuCmd_UpdateAllFieldsDescription":"Refresh all dynamic elements in the document by getting the latest source data.","ASPxRichEditStringId.ParagraphStyles":"Paragraph Styles","ASPxRichEditStringId.CharacterStyles":"Character Styles","ASPxRichEditStringId.BulletedAndNumberingTitle":"Bulleted and Numbering","ASPxRichEditStringId.CustomizeNumberedListTitle":"Customize Numbered List","ASPxRichEditStringId.CustomizeBulletedListTitle":"Customize Bulleted List","ASPxRichEditStringId.CustomizeOutlineNumberedTitle":"Customize Outline List","ASPxRichEditStringId.HyperlinkTitle":"Hyperlink","ASPxRichEditStringId.TabsTitle":"Tabs","ASPxRichEditStringId.SymbolsTitle":"Symbols","ASPxRichEditStringId.OtherLabels_None":"none","ASPxRichEditStringId.OtherLabels_All":"All","ASPxRichEditStringId.OtherLabels_ConfirmToRewriteExistingFile":"already exist. Do you want to replace it?","ASPxRichEditStringId.Numbering_Character":"Character...","ASPxRichEditStringId.Numbering_Font":"Font...","ASPxRichEditStringId.Numbering_BulletCharacter":"Bullet character","ASPxRichEditStringId.Numbering_BulletPosition":"Bullet position","ASPxRichEditStringId.Numbering_TextPosition":"Text position","ASPxRichEditStringId.Numbering_AlignedAt":"Aligned at","ASPxRichEditStringId.Numbering_IndentAt":"Indent at","ASPxRichEditStringId.Numbering_StartAt":"Start at","ASPxRichEditStringId.Numbering_NumberFormat":"Number format","ASPxRichEditStringId.Numbering_NumberStyle":"Number style","ASPxRichEditStringId.Numbering_NumberPosition":"Number position","ASPxRichEditStringId.Numbering_Left":"Left","ASPxRichEditStringId.Numbering_Center":"Center","ASPxRichEditStringId.Numbering_Right":"Right","ASPxRichEditStringId.Numbering_FollowNumberWith":"Follow Number With","ASPxRichEditStringId.Numbering_Level":"Level","ASPxRichEditStringId.Numbering_TabCharacter":"Tab character","ASPxRichEditStringId.Numbering_Space":"Space","ASPxRichEditStringId.Numbering_Nothing":"Nothing","ASPxRichEditStringId.Numbering_Customize":"Customize...","ASPxRichEditStringId.Numbering_Bulleted":"Bulleted","ASPxRichEditStringId.Numbering_Numbered":"Numbered","ASPxRichEditStringId.Numbering_OutlineNumbered":"Outline Numbered","ASPxRichEditStringId.Hyperlink_EmailAddress":"E-mail address","ASPxRichEditStringId.Hyperlink_Url":"URL","ASPxRichEditStringId.Hyperlink_Bookmark":"Bookmark","ASPxRichEditStringId.Hyperlink_WebPage":"Web page","ASPxRichEditStringId.Hyperlink_PlaceInThisDocument":"Place in this document","ASPxRichEditStringId.Hyperlink_EmailTo":"E-mail to","ASPxRichEditStringId.Hyperlink_Subject":"Subject","ASPxRichEditStringId.Hyperlink_DisplayProperties":"DisplayProperties","ASPxRichEditStringId.Hyperlink_Text":"Text","ASPxRichEditStringId.Hyperlink_ToolTip":"ToolTip","ASPxRichEditStringId.Hyperlink_InvalidEmail":"Invalid E-mail","ASPxRichEditStringId.Tabs_Set":"Set","ASPxRichEditStringId.Tabs_Clear":"Clear","ASPxRichEditStringId.Tabs_ClearAll":"Clear All","ASPxRichEditStringId.Tabs_TabStopPosition":"Tab stop position","ASPxRichEditStringId.Tabs_DefaultTabStops":"Default tab stops","ASPxRichEditStringId.Tabs_TabStopsToBeCleared":"Tab stops to be cleared","ASPxRichEditStringId.Tabs_Alignment":"Alignment","ASPxRichEditStringId.Tabs_Leader":"Leader","ASPxRichEditStringId.Tabs_Left":"Left","ASPxRichEditStringId.Tabs_Center":"Center","ASPxRichEditStringId.Tabs_Right":"Right","ASPxRichEditStringId.Tabs_Decimal":"Decimal","ASPxRichEditStringId.Tabs_None":"None","ASPxRichEditStringId.Tabs_Hyphens":"Hyphens","ASPxRichEditStringId.Tabs_EqualSign":"Equal signs","ASPxRichEditStringId.Tabs_Dots":"Dots","ASPxRichEditStringId.Tabs_Underline":"Underline","ASPxRichEditStringId.Tabs_MiddleDots":"Middle dots","ASPxRichEditStringId.Tabs_ThickLine":"Thick line","ASPxRichEditStringId.Tabs_NoTabs":"no tabs","ASPxRichEditStringId.FinishMerge_From":"From","ASPxRichEditStringId.FinishMerge_Count":"Count","ASPxRichEditStringId.FinishMerge_MergeMode":"Merge mode","ASPxRichEditStringId.FinishMerge_AllRecords":"All records","ASPxRichEditStringId.FinishMerge_CurrentRecord":"Current record","ASPxRichEditStringId.FinishMerge_Range":"Range","ASPxRichEditStringId.FinishMerge_NewParagraph":"New Paragraph","ASPxRichEditStringId.FinishMerge_NewSection":"New Section","ASPxRichEditStringId.FinishMerge_DocumentFormat":"Document Format","ASPxRichEditStringId.FinishMerge_JoinTables":"Join Tables","ASPxRichEditStringId.InsertMergeField_Fields":"Fields","ASPxRichEditStringId.InsertMergeField_NoFields":"no fields","ASPxRichEditStringId.Bookmarks_BookmarkName":"Bookmark name","ASPxRichEditStringId.Bookmarks_SortBy":"Sort by","ASPxRichEditStringId.Bookmarks_Name":"Name","ASPxRichEditStringId.Bookmarks_Location":"Location","ASPxRichEditStringId.Bookmarks_Add":"Add","ASPxRichEditStringId.Bookmarks_Delete":"Delete","ASPxRichEditStringId.Bookmarks_GoTo":"Go To","ASPxRichEditStringId.Bookmarks_NameErrorText":"Bookmark names must begin with a letter","ASPxRichEditStringId.Bookmarks_NoBookmarks":"No bookmarks","ASPxRichEditStringId.FindReplace_Find":"Find","ASPxRichEditStringId.FindReplace_AdvancedFind":"Advanced find","ASPxRichEditStringId.FindReplace_Replace":"Replace","ASPxRichEditStringId.FindReplace_ReplaceAll":"Replace All","ASPxRichEditStringId.FindReplace_ReplaceWith":"Replace with","ASPxRichEditStringId.FindReplace_Previous":"Previous","ASPxRichEditStringId.FindReplace_Next":"Next","ASPxRichEditStringId.FindReplace_MatchCase":"Match case","ASPxRichEditStringId.FindReplace_Results":"Results","ASPxRichEditStringId.FindReplace_NoResult":"We couldn't find what you were looking for.","ASPxRichEditStringId.FindReplace_TooLongResult":"The result is too long. Check out the pages to see your results in text.","ASPxRichEditStringId.FindReplace_ReplaceAllNotify":"{0} entries have been replaced","ASPxRichEditStringId.FindReplace_Items":"Items","ASPxRichEditStringId.FindReplace_NoMatches":"No matches","ASPxRichEditStringId.FindReplace_Of":"of","ASPxRichEditStringId.SpellingCheckCompletedInformation":"The spelling check is complete.","ASPxRichEditStringId.Spelling_IgnoreOnce":"Ignore Once","ASPxRichEditStringId.Spelling_IgnoreAll":"Ignore All","ASPxRichEditStringId.Spelling_AddToDictionary":"Add to Dictionary","ASPxRichEditStringId.Spelling_Delete":"Delete","ASPxRichEditStringId.Spelling_Change":"Change","ASPxRichEditStringId.Spelling_ChangeAll":"Change All","ASPxRichEditStringId.Spelling_NotInDictionary":"Not in Dictionary:","ASPxRichEditStringId.Spelling_RepeatedWord":"Repeated Word:","ASPxRichEditStringId.Spelling_Suggestions":"Suggestions:","ASPxRichEditStringId.Spelling_NoSpellingSuggestions":"(no spelling suggestions)","ASPxRichEditStringId.MenuCmd_MakeTextSentenceCase":"Sentence case.","ASPxRichEditStringId.MenuCmd_MakeTextSentenceCaseDescription":"Sentence case.","ASPxRichEditStringId.MenuCmd_ShowCellOptionsForm":"Cell Margins","ASPxRichEditStringId.MenuCmd_ShowCellOptionsFormDescription":"Customize cell margins","ASPxRichEditStringId.MenuCmd_HeaderOffset":"Header from Top:","ASPxRichEditStringId.MenuCmd_FooterOffset":"Footer from Bottom:","ASPxRichEditStringId.MenuCmd_HeaderOffsetDescription":"Specify the distance from the top of the page to the top of the header.","ASPxRichEditStringId.MenuCmd_FooterOffsetDescription":"Specify the distance from the bottom of the page to the bottom of the footer.","ASPxRichEditStringId.LayoutOptions_Inline":"In line with text","ASPxRichEditStringId.LayoutOptions_LockAnchor":"Lock Anchor","ASPxRichEditStringId.LayoutOptions_LockAspectRatio":"Lock aspect ratio","ASPxRichEditStringId.LayoutOptions_Reset":"Reset","ASPxRichEditStringId.LayoutOptions_BothSides":"Both sides","ASPxRichEditStringId.LayoutOptions_LeftOnly":"Left only","ASPxRichEditStringId.LayoutOptions_RightOnly":"Right only","ASPxRichEditStringId.LayoutOptions_LargestOnly":"Largest only","ASPxRichEditStringId.LayoutOptions_HorizontalPositionAlignmentInside":"Inside","ASPxRichEditStringId.LayoutOptions_HorizontalPositionAlignmentOutside":"Outside","ASPxRichEditStringId.LayoutOptions_Position":"Position","ASPxRichEditStringId.LayoutOptions_Horizontal":"Horizontal","ASPxRichEditStringId.LayoutOptions_Vertical":"Vertical","ASPxRichEditStringId.LayoutOptions_RelativeTo":"relative to","ASPxRichEditStringId.LayoutOptions_HorizontalBookLayoutOf":"of","ASPxRichEditStringId.LayoutOptions_AbsolutePosition":"Absolute position","ASPxRichEditStringId.LayoutOptions_RelativePosition":"Relative position","ASPxRichEditStringId.LayoutOptions_Alignment":"Alignment","ASPxRichEditStringId.LayoutOptions_BookLayout":"Book layout","ASPxRichEditStringId.LayoutOptions_ToTheRightOf":"to the right of","ASPxRichEditStringId.LayoutOptions_Below":"below","ASPxRichEditStringId.LayoutOptions_TextWrapping":"Text Wrapping","ASPxRichEditStringId.LayoutOptions_WrappingStyle":"Wrapping style","ASPxRichEditStringId.LayoutOptions_WrapText":"Wrap text","ASPxRichEditStringId.LayoutOptions_DistanceFromText":"Distance from text","ASPxRichEditStringId.LayoutOptions_Size":"Size","ASPxRichEditStringId.LayoutOptions_Absolute":"Absolute","ASPxRichEditStringId.LayoutOptions_Relative":"Relative","ASPxRichEditStringId.LayoutOptions_Rotate":"Rotate","ASPxRichEditStringId.LayoutOptions_Rotation":"Rotation","ASPxRichEditStringId.LayoutOptions_Scale":"Scale","ASPxRichEditStringId.LayoutOptions_OriginalSize":"Original size","ASPxRichEditStringId.FileManager_OpenedFileDeleteErrorText":"The file cannot be deleted. It is already opened by another user.","ASPxRichEditStringId.FileManager_OpenedFileMoveErrorText":"The file cannot be moved. It is already opened by another user.","ASPxRichEditStringId.FileManager_OpenedFileRenameErrorText":"The file cannot be renamed. It is already opened by another user.","ASPxRichEditStringId.CreateDateField":"DATE","ASPxRichEditStringId.CreateDateFieldDescription":"Inserts the current date and time.","ASPxRichEditStringId.CreateTimeField":"TIME","ASPxRichEditStringId.CreateTimeFieldDescription":"Inserts the current time.","ASPxRichEditStringId.CreatePageField":"PAGE","ASPxRichEditStringId.CreatePageFieldDescription":"Inserts the number of the page containing the field.","ASPxRichEditStringId.CreatePageCountField":"NUMPAGES","ASPxRichEditStringId.CreatePageCountFieldDescription":"Inserts the total number of pages.","ASPxRichEditStringId.CreateEmptyMergeField":"MERGEFIELD","ASPxRichEditStringId.CreateEmptyMergeFieldDescription":"Retrieves a value from the bound data source.","ASPxRichEditStringId.CreateEmptyDocVariableField":"DOCVARIABLE","ASPxRichEditStringId.CreateEmptyDocVariableFieldDescription":"Enables you to programmatically insert complex content when this field is updated.","ASPxRichEditStringId.CreateEmptyIfField":"IF","ASPxRichEditStringId.CreateEmptyIfFieldDescription":"Compares two values and inserts text related to the comparison result.","ASPxRichEditStringId.MenuCmd_Font_settings":"Font settings","ASPxRichEditStringId.MenuCmd_Align_Paragraph":"Align Paragraph","ASPxRichEditStringId.MenuCmd_Empty":"Empty","XtraRichEditStringId.Caption_AllMarkup":"All Markup","XtraRichEditStringId.Caption_CharacterPositionLowered":"Lowered","XtraRichEditStringId.Caption_CharacterPositionNormal":"Normal","XtraRichEditStringId.Caption_CharacterPositionRaised":"Raised","XtraRichEditStringId.Caption_CharacterSpacingCondensed":"Condensed","XtraRichEditStringId.Caption_CharacterSpacingExpanded":"Expanded","XtraRichEditStringId.Caption_CharacterSpacingNormal":"Normal","XtraRichEditStringId.Caption_FillInForms":"Filling in Forms","XtraRichEditStringId.Caption_GroupDocumentChanges":"Changes","XtraRichEditStringId.Caption_GroupNotes":"Footnotes","XtraRichEditStringId.Caption_NoMarkup":"No Markup","XtraRichEditStringId.Caption_NoteFootNoteColumnCountFourColumn":"4 column","XtraRichEditStringId.Caption_NoteFootNoteColumnCountMatchSectionLayout":"Match section layout","XtraRichEditStringId.Caption_NoteFootNoteColumnCountOneColumn":"1 column","XtraRichEditStringId.Caption_NoteFootNoteColumnCountThreeColumn":"3 column","XtraRichEditStringId.Caption_NoteFootNoteColumnCountTwoColumn":"2 column","XtraRichEditStringId.Caption_NoteNumberingRestartTypeContinuous":"Continuous","XtraRichEditStringId.Caption_NoteNumberingRestartTypeNewPage":"Restart each page","XtraRichEditStringId.Caption_NoteNumberingRestartTypeNewSection":"Restart each section","XtraRichEditStringId.Caption_NotePositionBelowText":"Below text","XtraRichEditStringId.Caption_NotePositionBottomOfPage":"Bottom of page","XtraRichEditStringId.Caption_NotePositionEndOfDocument":"End of document","XtraRichEditStringId.Caption_NotePositionEndOfSection":"End of section","XtraRichEditStringId.Caption_OriginalMarkup":"Original","XtraRichEditStringId.Caption_SimpleMarkup":"Simple Markup","XtraRichEditStringId.Caption_TrackedChanges":"Tracked Changes","XtraRichEditStringId.DefaultStyleName_BookTitle":"Book Title","XtraRichEditStringId.DefaultStyleName_IntenseEmphasis":"Intense Emphasis","XtraRichEditStringId.DefaultStyleName_IntenseQuote":"Intense Quote","XtraRichEditStringId.DefaultStyleName_ListParagraph":"List Paragraph","XtraRichEditStringId.DefaultStyleName_NoSpacing":"No Spacing","XtraRichEditStringId.DefaultStyleName_Quote":"Quote","XtraRichEditStringId.DefaultStyleName_SubtleEmphasis":"Subtle Emphasis","XtraRichEditStringId.FileFilterDescription_DocmFiles":"Word Macro-Enabled Document","XtraRichEditStringId.FileFilterDescription_DotFiles":"Word 97-2003 Template","XtraRichEditStringId.FileFilterDescription_DotmFiles":"Word Macro-Enabled Template","XtraRichEditStringId.FileFilterDescription_DotxFiles":"Word Template","XtraRichEditStringId.FileFilterDescription_FlatOpcFiles":"Word XML Document","XtraRichEditStringId.FileFilterDescription_FlatOpcMacroEnabledFiles":"Word Macro-Enabled XML Document","XtraRichEditStringId.FileFilterDescription_FlatOpcMacroEnabledTemplateFiles":"Word Macro-Enabled XML Template","XtraRichEditStringId.FileFilterDescription_FlatOpcTemplateFiles":"Word XML Template","XtraRichEditStringId.MenuCmd_Accept":"Accept","XtraRichEditStringId.MenuCmd_AcceptAllChanges":"Accept All Changes","XtraRichEditStringId.MenuCmd_AcceptAllChangesAndStopTracking":"Accept All Changes and Stop Tracking","XtraRichEditStringId.MenuCmd_AcceptAllChangesAndStopTrackingDescription":"Accept All Changes and Stop Tracking","XtraRichEditStringId.MenuCmd_AcceptAllChangesDescription":"Accept All Changes","XtraRichEditStringId.MenuCmd_AcceptAllChangesShown":"Accept All Changes Shown","XtraRichEditStringId.MenuCmd_AcceptAllChangesShownDescription":"Accept All Changes Shown","XtraRichEditStringId.MenuCmd_AcceptAndMoveToNextRevision":"Accept and Move to Next","XtraRichEditStringId.MenuCmd_AcceptAndMoveToNextRevisionDescription":"Keep this change and move one to the next one.","XtraRichEditStringId.MenuCmd_AcceptCurrentRevision":"Accept This Change","XtraRichEditStringId.MenuCmd_AcceptCurrentRevisionDescription":"Accept This Change","XtraRichEditStringId.MenuCmd_AcceptDescription":"Click for additional options, such as accepting all the changes at once.","XtraRichEditStringId.MenuCmd_ChangeDisplayForReviewMode":"Display for Review","XtraRichEditStringId.MenuCmd_ChangeDisplayForReviewModeDescription":"Choose how you'd like to see changes in this document.","XtraRichEditStringId.MenuCmd_ChangeFloatingObjectTextWrapTypeDescription":'Change the way text wraps around the selected object. To configure the object so that it moves along with text the text around it, select "In Line With Text".',"XtraRichEditStringId.MenuCmd_ConvertNotesDescription":"Convert Note","XtraRichEditStringId.MenuCmd_ConvertToEndnote":"Convert to Endnote","XtraRichEditStringId.MenuCmd_ConvertToFootnote":"Convert to Footnote","XtraRichEditStringId.MenuCmd_InsertEndnote":"Insert Endnote","XtraRichEditStringId.MenuCmd_InsertEndnoteDescription":"Add a endnote","XtraRichEditStringId.MenuCmd_InsertFootnote":"Insert Footnote","XtraRichEditStringId.MenuCmd_InsertFootnoteDescription":"Add a footnote","XtraRichEditStringId.MenuCmd_InsertNonBreakingHyphen":"InsertNonBreakingHyphen","XtraRichEditStringId.MenuCmd_InsertObject":"Object","XtraRichEditStringId.MenuCmd_InsertObjectDescription":"Insert an embedded object, such as another Word document or an Excel chart.","XtraRichEditStringId.MenuCmd_LockTracking":"Lock Tracking","XtraRichEditStringId.MenuCmd_LockTrackingDescription":"Use a password to keep others from turning off Track Changes","XtraRichEditStringId.MenuCmd_NextEndnote":"Next Endnote","XtraRichEditStringId.MenuCmd_NextEndnoteDescription":"Jump to next endnote","XtraRichEditStringId.MenuCmd_NextFootnote":"Next Footnote","XtraRichEditStringId.MenuCmd_NextFootnoteDescription":"Jump to next footnote","XtraRichEditStringId.MenuCmd_NextRevision":"Next","XtraRichEditStringId.MenuCmd_NextRevisionDescription":"Jump to the next tracked change.","XtraRichEditStringId.MenuCmd_NoteOptions":"Note Options...","XtraRichEditStringId.MenuCmd_PreviousEndnote":"Previous Endnote","XtraRichEditStringId.MenuCmd_PreviousEndnoteDescription":"Jump to previous endnote","XtraRichEditStringId.MenuCmd_PreviousFootnote":"Previous Footnote","XtraRichEditStringId.MenuCmd_PreviousFootnoteDescription":"Jump to previous footnote","XtraRichEditStringId.MenuCmd_PrevRevision":"Previous","XtraRichEditStringId.MenuCmd_PrevRevisionDescription":"Jump to the previous tracked change.","XtraRichEditStringId.MenuCmd_Reject":"Reject","XtraRichEditStringId.MenuCmd_RejectAllChanges":"Reject All Changes","XtraRichEditStringId.MenuCmd_RejectAllChangesAndStopTracking":"Reject All Changes and Stop Tracking","XtraRichEditStringId.MenuCmd_RejectAllChangesAndStopTrackingDescription":"Reject All Changes and Stop Tracking","XtraRichEditStringId.MenuCmd_RejectAllChangesDescription":"Reject All Changes","XtraRichEditStringId.MenuCmd_RejectAllChangesShown":"Reject All Changes Shown","XtraRichEditStringId.MenuCmd_RejectAllChangesShownDescription":"Reject All Changes Shown","XtraRichEditStringId.MenuCmd_RejectAndMoveToNextRevision":"Reject and Move to Next","XtraRichEditStringId.MenuCmd_RejectAndMoveToNextRevisionDescription":"Undo this change and move on to the next one.","XtraRichEditStringId.MenuCmd_RejectCurrentRevision":"Reject This Change","XtraRichEditStringId.MenuCmd_RejectCurrentRevisionDescription":"Reject This Change","XtraRichEditStringId.MenuCmd_RejectDescription":"Click for additional options, such as rejecting all the changes at once.","XtraRichEditStringId.MenuCmd_ShowEndnote":"Go to Endnote","XtraRichEditStringId.MenuCmd_ShowFootnote":"Go to Footnote","XtraRichEditStringId.MenuCmd_ShowMarkup":"Show Markup","XtraRichEditStringId.MenuCmd_ShowMarkupDescription":"Choose what types of markup to show in your document.","XtraRichEditStringId.MenuCmd_ShowNotes":"Show Notes","XtraRichEditStringId.MenuCmd_ShowNotesDescription":"Jump to the footnotes or endnotes","XtraRichEditStringId.MenuCmd_ShowNotesForm":"Footnotes","XtraRichEditStringId.MenuCmd_ShowNotesFormDescription":"Show the Notes dialog box.","XtraRichEditStringId.MenuCmd_TrackChanges":"Track Changes","XtraRichEditStringId.MenuCmd_TrackChangesDescription":"Keep track of changes made to this document.","XtraRichEditStringId.Msg_CannotGroupInlineShapes":"You cannot group inline shapes.","XtraRichEditStringId.Msg_CannotGroupShapesLocatedInDifferentSubdocuments":"Cannot group shapes that are located in different subdocuments.","XtraRichEditStringId.Msg_GroupCannotContainCanvas":"A group cannot contain a canvas.","XtraRichEditStringId.Msg_IncorrectOleObjectInsertType":"This OLE object is linked and cannot be saved. You can save only embedded OLE objects.","XtraRichEditStringId.Msg_InvalidCharacterScale":"The value must be between {0} and {1}","XtraRichEditStringId.Msg_InvalidDictionaryFormat":"The dictionary format is incorrect.","XtraRichEditStringId.Msg_NoTrackedChanges":"There aren't any tracked changes in your document.","XtraRichEditStringId.Msg_ShapesBelongToDifferentCanvases":"The specified shapes belong to different canvases and cannot be grouped.","XtraRichEditStringId.Msg_ShapesDoNotBelogToCanvas":"One or more shapes do not belong to the canvas and cannot be grouped.","XtraRichEditStringId.Msg_SpecifiedShapeIsNotGroup":"The specified shape is not a group.","XtraRichEditStringId.Msg_UseDeletedNoteError":"Error: using deleted note","XtraRichEditStringId.Msg_UseDeletedObjectError":"The object is already deleted.","XtraRichEditStringId.TablePositioningForm_HorizontalPositionAlignmentCenter":"Center","XtraRichEditStringId.TablePositioningForm_HorizontalPositionAlignmentInside":"Inside","XtraRichEditStringId.TablePositioningForm_HorizontalPositionAlignmentLeft":"Left","XtraRichEditStringId.TablePositioningForm_HorizontalPositionAlignmentOutside":"Outside","XtraRichEditStringId.TablePositioningForm_HorizontalPositionAlignmentRight":"Right","XtraRichEditStringId.TablePositioningForm_HorizontalPositionTypeColumn":"Column","XtraRichEditStringId.TablePositioningForm_HorizontalPositionTypeMargin":"Margin","XtraRichEditStringId.TablePositioningForm_HorizontalPositionTypePage":"Page","XtraRichEditStringId.TablePositioningForm_VerticalPositionAlignmentBottom":"Bottom","XtraRichEditStringId.TablePositioningForm_VerticalPositionAlignmentCenter":"Center","XtraRichEditStringId.TablePositioningForm_VerticalPositionAlignmentInside":"Inside","XtraRichEditStringId.TablePositioningForm_VerticalPositionAlignmentOutside":"Outside","XtraRichEditStringId.TablePositioningForm_VerticalPositionAlignmentTop":"Top","XtraRichEditStringId.TablePositioningForm_VerticalPositionTypeMargin":"Margin","XtraRichEditStringId.TablePositioningForm_VerticalPositionTypePage":"Page","XtraRichEditStringId.TablePositioningForm_VerticalPositionTypeParagraph":"Paragraph","RichEditExtensionsStringId.Caption_ColorAutomatic":"Automatic","RichEditExtensionsStringId.Caption_Formatting":"Formatting","RichEditExtensionsStringId.Caption_GroupCaptions":"Captions","RichEditExtensionsStringId.Caption_GroupClipboard":"Clipboard","RichEditExtensionsStringId.Caption_GroupCommon":"Common","RichEditExtensionsStringId.Caption_GroupDocumentComment":"Comment","RichEditExtensionsStringId.Caption_GroupDocumentLanguage":"Language","RichEditExtensionsStringId.Caption_GroupDocumentProofing":"Proofing","RichEditExtensionsStringId.Caption_GroupDocumentProtection":"Protect","RichEditExtensionsStringId.Caption_GroupDocumentTracking":"Tracking","RichEditExtensionsStringId.Caption_GroupDocumentViews":"Document Views","RichEditExtensionsStringId.Caption_GroupEditing":"Editing","RichEditExtensionsStringId.Caption_GroupFloatingPictureToolsArrange":"Arrange","RichEditExtensionsStringId.Caption_GroupFloatingPictureToolsShapeStyles":"Shape Styles","RichEditExtensionsStringId.Caption_GroupFont":"Font","RichEditExtensionsStringId.Caption_GroupHeaderFooter":"Header && Footer","RichEditExtensionsStringId.Caption_GroupHeaderFooterToolsDesignClose":"Close","RichEditExtensionsStringId.Caption_GroupHeaderFooterToolsDesignNavigation":"Navigation","RichEditExtensionsStringId.Caption_GroupHeaderFooterToolsDesignOptions":"Options","RichEditExtensionsStringId.Caption_GroupIllustrations":"Illustrations","RichEditExtensionsStringId.Caption_GroupInfo":"Info","RichEditExtensionsStringId.Caption_GroupLinks":"Links","RichEditExtensionsStringId.Caption_GroupMailMerge":"Mail Merge","RichEditExtensionsStringId.Caption_GroupNotes":"Footnotes","RichEditExtensionsStringId.Caption_GroupPageBackground":"Background","RichEditExtensionsStringId.Caption_GroupPages":"Pages","RichEditExtensionsStringId.Caption_GroupPageSetup":"Page Setup","RichEditExtensionsStringId.Caption_GroupParagraph":"Paragraph","RichEditExtensionsStringId.Caption_GroupShow":"Show","RichEditExtensionsStringId.Caption_GroupStyles":"Styles","RichEditExtensionsStringId.Caption_GroupSymbols":"Symbols","RichEditExtensionsStringId.Caption_GroupTableOfContents":"Table of Contents","RichEditExtensionsStringId.Caption_GroupTables":"Tables","RichEditExtensionsStringId.Caption_GroupText":"Text","RichEditExtensionsStringId.Caption_GroupZoom":"Zoom","RichEditExtensionsStringId.Caption_NoColor":"No Color","RichEditExtensionsStringId.Caption_NoFill":"No Fill","RichEditExtensionsStringId.Caption_NoOutline":"No Outline","RichEditExtensionsStringId.Caption_PageCategoryFloatingPictureTools":"Picture Tools","RichEditExtensionsStringId.Caption_PageCategoryHeaderFooterTools":"Header & Footer Tools","RichEditExtensionsStringId.Caption_PageFile":"File","RichEditExtensionsStringId.Caption_PageFloatingObjectPictureToolsFormat":"Format","RichEditExtensionsStringId.Caption_PageHeaderFooterToolsDesign":"Design","RichEditExtensionsStringId.Caption_PageHome":"Home","RichEditExtensionsStringId.Caption_PageInsert":"Insert","RichEditExtensionsStringId.Caption_PageLayout":"Layout","RichEditExtensionsStringId.Caption_PageMailings":"Mail Merge","RichEditExtensionsStringId.Caption_PagePageLayout":"Page Layout","RichEditExtensionsStringId.Caption_PageReferences":"References","RichEditExtensionsStringId.Caption_PageReview":"Review","RichEditExtensionsStringId.Caption_PageView":"View","ASPxRichEditStringId.Download_WordDocument":"Word Document (*.docx)","ASPxRichEditStringId.Download_RichTextFormat":"Rich Text Format (*.rtf)","ASPxRichEditStringId.Download_PlainText":"Plain Text (*.txt)","ASPxRichEditStringId.Download_Html":"Html Document (*.html, *.htm)"}}))}class KQ{static getDefaultItems(){GQ();const e=kJ.defaultFontsList.map((e=>{const t=e[x.Name];return{text:t,value:t}})),t=kJ.getFontSizesList().map((e=>({text:e.toString(),value:e})));function r(e){const t=(0,OV.formatMessage)(e),r=rn.StringUtils.trimEnd(t,["\\."]);return rn.StringUtils.trimStart(r,["\\&"])}const i=[{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_NewEmptyDocument"),icon:"dxre-icon-New",alwaysShowText:!0,name:FF.CreateNewDocumentLocally},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.OpenButton"),icon:"dxre-icon-Open",alwaysShowText:!0,name:FF.OpenDocumentLocally},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.SaveAsButton"),icon:"dxre-icon-Save",alwaysShowText:!0,name:FF.ExportDocument},{type:"Menu",name:FF.DownloadDocumentLocally,text:(0,OV.formatMessage)("ASPxRichEditStringId.DownloadButton"),icon:"dxre-icon-Download",alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Download_WordDocument"),name:FF.DownloadDocx},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Download_RichTextFormat"),name:FF.DownloadRtf},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Download_PlainText"),name:FF.DownloadTxt},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Download_Html"),name:FF.DownloadHtml}]},{type:"Button",text:r("OfficeStringId.MenuCmd_Print"),icon:"dxre-icon-Print",alwaysShowText:!0,name:FF.PrintDocumentOnClient}],n=[{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.GroupUndo"),icon:"dxre-icon-Undo",name:FF.Undo},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_Redo"),icon:"dxre-icon-Redo",name:FF.Redo},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_CutSelection"),icon:"dxre-icon-Cut",name:FF.CutSelection,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_CopySelection"),icon:"dxre-icon-Copy",name:FF.CopySelection},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_Paste"),icon:"dxre-icon-Paste",name:FF.PasteSelection},{type:"SelectBox",dataSource:e,width:150,name:FF.ChangeFontName,beginGroup:!0,displayExpr:"text",valueExpr:"value"},{type:"SelectBox",dataSource:t,width:70,name:FF.ChangeFontSize,beginGroup:!0,acceptCustomValue:!0,displayExpr:"text",valueExpr:"value",onCustomItemCreating:function(e){e.customItem={text:e.text,value:parseFloat(e.text)}}},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_IncreaseFontSize"),icon:"dxre-icon-FontSizeIncrease",name:FF.IncreaseFontSize,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_DecreaseFontSize"),icon:"dxre-icon-FontSizeDecrease",name:FF.DecreaseFontSize},{type:"ColorBox",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_ChangeFontColor"),value:"#ff0000",name:FF.ChangeFontForeColor,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_Font_settings"),icon:"dxre-icon-ChangeFontStyle",name:FF.ShowFontForm,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_ToggleFontBold"),icon:"dxre-icon-Bold",name:FF.ToggleFontBold,isToggleMode:!0,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_ToggleFontItalic"),icon:"dxre-icon-Italic",name:FF.ToggleFontItalic,isToggleMode:!0},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_ToggleFontUnderline"),icon:"dxre-icon-Underline",name:FF.ToggleFontUnderline,isToggleMode:!0},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_ToggleFontStrikeout"),icon:"dxre-icon-Strikeout",name:FF.ToggleFontStrikeout,isToggleMode:!0},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.CharacterFormattingScript_Subscript"),icon:"dxre-icon-Subscript",name:FF.ToggleFontSubscript,isToggleMode:!0},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.CharacterFormattingScript_Superscript"),icon:"dxre-icon-Superscript",name:FF.ToggleFontSuperscript,isToggleMode:!0},{type:"Menu",name:FF.ChangeCaseMenu,text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeTextCase"),icon:"dxre-icon-ChangeTextCase",items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_MakeTextSentenceCase"),name:FF.SentenceCase},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_MakeTextUpperCase"),name:FF.MakeTextUpperCase},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_MakeTextLowerCase"),name:FF.MakeTextLowerCase},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_CapitalizeEachWordTextCase"),name:FF.CapitalizeEachWordTextCase},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTextCase"),name:FF.ToggleTextCase}]},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.ClearFormatting"),icon:"dxre-icon-ClearFormatting",name:FF.ClearFormatting},{type:"Button",text:r("XtraRichEditStringId.MenuCmd_InsertBulletListDescription"),icon:"dxre-icon-ListBullets",name:FF.ToggleBulletedListItem,isToggleMode:!0,beginGroup:!0},{type:"Button",text:r("XtraRichEditStringId.MenuCmd_InsertSimpleListDescription"),icon:"dxre-icon-ListNumbers",name:FF.ToggleNumberingListItem,isToggleMode:!0},{type:"Button",text:r("XtraRichEditStringId.MenuCmd_InsertMultilevelListDescription"),icon:"dxre-icon-ListMultilevel",name:FF.ToggleMultilevelListItem,isToggleMode:!0},{type:"Menu",name:FF.AlignParagraphMenu,text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_Align_Paragraph"),icon:"dxre-icon-AlignLeft",beginGroup:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.Caption_ParagraphAlignment_Left"),name:FF.ToggleParagraphAlignmentLeft,icon:"dxre-icon-AlignLeft"},{text:(0,OV.formatMessage)("XtraRichEditStringId.Caption_ParagraphAlignment_Center"),name:FF.ToggleParagraphAlignmentCenter,icon:"dxre-icon-AlignCenter"},{text:(0,OV.formatMessage)("XtraRichEditStringId.Caption_ParagraphAlignment_Right"),name:FF.ToggleParagraphAlignmentRight,icon:"dxre-icon-AlignRight"},{text:(0,OV.formatMessage)("XtraRichEditStringId.Caption_ParagraphAlignment_Justify"),name:FF.ToggleParagraphAlignmentJustify,icon:"dxre-icon-AlignJustify"}]},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleWhitespace"),icon:"dxre-icon-ShowHidden",name:FF.ToggleShowWhitespace,isToggleMode:!0},{type:"Menu",name:FF.LineSpacingMenu,icon:"dxre-icon-LineSpacing",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeParagraphLineSpacing"),items:[{text:"1.0",name:FF.SetSingleParagraphSpacing},{text:"1.5",name:FF.SetSesquialteralParagraphSpacing},{text:"2.0",name:FF.SetDoubleParagraphSpacing},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_AddSpacingBeforeParagraph"),name:FF.AddSpacingBeforeParagraph},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_AddSpacingAfterParagraph"),name:FF.AddSpacingAfterParagraph},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_RemoveSpacingBeforeParagraph"),name:FF.RemoveSpacingBeforeParagraph},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_RemoveSpacingAfterParagraph"),name:FF.RemoveSpacingAfterParagraph}]},{type:"ColorBox",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeParagraphBackColorDescription"),value:"#fff",name:FF.ChangeParagraphBackColor,beginGroup:!0},{type:"SelectBox",width:130,name:FF.ChangeStyle,dataSource:kJ.getParagraphStylesList(),displayExpr:"text",valueExpr:"value",beginGroup:!0,acceptCustomValue:!0},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Find"),icon:"dxre-icon-Find",name:FF.Find,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Replace"),icon:"dxre-icon-Replace",name:FF.Replace}],o=[{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTable"),icon:"dxre-icon-InsertTable",alwaysShowText:!0,name:FF.ShowInsertTableForm},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_InsertFloatingObjectPicture"),icon:"dxre-icon-InsertImage",alwaysShowText:!0,name:FF.InsertPictureLocally},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ShowBookmarkForm"),icon:"dxre-icon-Bookmark",alwaysShowText:!0,name:FF.ShowBookmarkForm,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_Hyperlink"),icon:"dxre-icon-Hyperlink",alwaysShowText:!0,name:FF.ShowHyperlinkForm},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_EditPageHeader"),icon:"dxre-icon-Header",alwaysShowText:!0,name:FF.InsertHeader,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_EditPageFooter"),icon:"dxre-icon-Footer",alwaysShowText:!0,name:FF.InsertFooter},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertPageNumberField"),icon:"dxre-icon-InsertPageNumber",alwaysShowText:!0,name:FF.InsertPageNumberField},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertPageCountField"),icon:"dxre-icon-InsertPageCount",alwaysShowText:!0,name:FF.InsertPageCountField},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTextBox"),icon:"dxre-icon-InsertTextBox",alwaysShowText:!0,name:FF.InsertAnchoredTextBox,beginGroup:!0}],a=[{type:"Menu",name:FF.MarginsMenu,icon:"dxre-icon-PageMargins",text:(0,OV.formatMessage)("ASPxRichEditStringId.Margins"),alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Normal"),icon:"dxre-icon-PageMarginsNormal",name:FF.SetNormalSectionPageMargins},{text:(0,OV.formatMessage)("ASPxRichEditStringId.MarginsNarrow"),icon:"dxre-icon-PageMarginsNarrow",name:FF.SetNarrowSectionPageMargins},{text:(0,OV.formatMessage)("ASPxRichEditStringId.MarginsModerate"),icon:"dxre-icon-PageMarginsModerate",name:FF.SetModerateSectionPageMargins},{text:(0,OV.formatMessage)("ASPxRichEditStringId.MarginsWide"),icon:"dxre-icon-PageMarginsWide",name:FF.SetWideSectionPageMargins},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ShowPageMarginsSetupForm"),name:FF.ShowPageMarginsSetupForm,beginGroup:!0}]},{type:"Menu",name:FF.OrientationMenu,icon:"dxre-icon-PageOrientation",text:(0,OV.formatMessage)("ASPxRichEditStringId.Orientation"),alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Portrait"),icon:"dxre-icon-PageOrientationPortrait",name:FF.SetPortraitPageOrientation},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Landscape"),icon:"dxre-icon-PageOrientationLandscape",name:FF.SetLandscapePageOrientation}]},{type:"Menu",name:FF.SizeMenu,icon:"dxre-icon-PaperSize",alwaysShowText:!0,text:(0,OV.formatMessage)("ASPxRichEditStringId.TableProperties_Size"),items:[{text:"Letter",name:FF.SetSectionLetterPaperKind},{text:"Legal",name:FF.SetSectionLegalPaperKind},{text:"Folio",name:FF.SetSectionFolioPaperKind},{text:"A4",name:FF.SetSectionA4PaperKind},{text:"B5",name:FF.SetSectionB5PaperKind},{text:"Executive",name:FF.SetSectionExecutivePaperKind},{text:"A5",name:FF.SetSectionA5PaperKind},{text:"A6",name:FF.SetSectionA6PaperKind},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ShowPagePaperSetupForm"),name:FF.ShowPagePaperSetupForm,beginGroup:!0}]},{type:"Menu",name:FF.ColumnsMenu,icon:"dxre-icon-Columns",alwaysShowText:!0,text:(0,OV.formatMessage)("ASPxRichEditStringId.ColumnsTitle"),items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetSectionOneColumn"),icon:"dxre-icon-ColumnsOne",name:FF.SetSectionOneColumn},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetSectionTwoColumns"),icon:"dxre-icon-ColumnsTwo",name:FF.SetSectionTwoColumns},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetSectionThreeColumns"),icon:"dxre-icon-ColumnsThree",name:FF.SetSectionThreeColumns}]},{type:"Menu",name:FF.BreaksMenu,icon:"dxre-icon-InsertSectionBreakNextPage",alwaysShowText:!0,text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertBreak"),items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.FloatingObjectLayoutOptionsForm_HorizontalPositionTypePage"),icon:"dxre-icon-InsertPageBreak",name:FF.InsertPageBreak},{text:(0,OV.formatMessage)("ASPxRichEditStringId.TableProperties_Column"),icon:"dxre-icon-InsertColumnBreak",name:FF.InsertColumnBreak},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertSectionBreakNextPage"),icon:"dxre-icon-InsertSectionBreakNextPage",name:FF.InsertSectionBreakNextPage},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertSectionBreakEvenPage"),icon:"dxre-icon-InsertSectionBreakEvenPage",name:FF.InsertSectionBreakEvenPage},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertSectionBreakOddPage"),icon:"dxre-icon-InsertSectionBreakOddPage",name:FF.InsertSectionBreakOddPage}]},{type:"ColorBox",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangePageColor"),value:"#fff",name:FF.ChangePageColor,beginGroup:!0}],s=[{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.GroupTableOfContents"),icon:"dxre-icon-InsertTableOfContents",alwaysShowText:!0,name:FF.CreateTocField},{type:"Menu",name:FF.AddTextMenu,icon:"dxre-icon-AddParagraphToTableOfContents",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_AddParagraphsToTableOfContents"),alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetParagraphBodyTextLevel"),name:FF.SetParagraphBodyTextLevel},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 1",name:FF.SetParagraphHeading1Level},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 2",name:FF.SetParagraphHeading2Level},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 3",name:FF.SetParagraphHeading3Level},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 4",name:FF.SetParagraphHeading4Level},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 5",name:FF.SetParagraphHeading5Level},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 6",name:FF.SetParagraphHeading6Level},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 7",name:FF.SetParagraphHeading7Level},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 8",name:FF.SetParagraphHeading8Level},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 9",name:FF.SetParagraphHeading9Level}]},{type:"Menu",name:FF.InsertCaptionMenu,icon:"dxre-icon-InsertCaption",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertCaptionPlaceholder"),beginGroup:!0,alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertFiguresCaption"),icon:"dxre-icon-InsertFigureCaption",name:FF.CreateFigureCaptionField},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTablesCaption"),icon:"dxre-icon-InsertTableCaption",name:FF.CreateTableCaptionField},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertEquationsCaption"),icon:"dxre-icon-InsertTableOfEquations",name:FF.CreateEquationCaptionField}]},{type:"Menu",name:FF.InsertTableOfFiguresMenu,icon:"dxre-icon-InsertTableOfCaptions",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableOfFiguresPlaceholder"),alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.DefaultStyleName_tableoffigures"),icon:"dxre-icon-InsertFigureCaption",name:FF.CreateTableOfFiguresField},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableOfTables"),icon:"dxre-icon-InsertTableCaption",name:FF.CreateTableOfTablesField},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableOfEquations"),icon:"dxre-icon-InsertTableOfEquations",name:FF.CreateTableOfEquationsField}]},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_UpdateTableOfContents"),icon:"dxre-icon-UpdateTableOfContents",alwaysShowText:!0,name:FF.UpdateTableOfContents,beginGroup:!0}],l=[{type:"Menu",name:FF.CreateFieldMenu,icon:"dxre-icon-InsertDataField",text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_CreateField"),alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_Empty"),name:FF.CreateField},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CreateDateField"),name:FF.CreateDateField},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CreateTimeField"),name:FF.CreateTimeField},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CreatePageField"),name:FF.CreatePageField},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CreatePageCountField"),name:FF.InsertPageCountField},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CreateEmptyMergeField"),name:FF.CreateEmptyMergeField},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CreateEmptyDocVariableField"),name:FF.CreateEmptyDocVariableField},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CreateEmptyIfField"),name:FF.CreateEmptyIfField}]},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertMergeFieldTitle"),icon:"dxre-icon-InsertDataField",alwaysShowText:!0,name:FF.ShowInsertMergeFieldForm},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleViewMergedData"),icon:"dxre-icon-ViewMergedData",alwaysShowText:!0,name:FF.ToggleViewMergedData,beginGroup:!0,isToggleMode:!0},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ShowAllFieldCodes"),icon:"dxre-icon-ShowAllFieldCodes",alwaysShowText:!0,name:FF.ShowAllFieldCodes},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ShowAllFieldResults"),icon:"dxre-icon-ShowAllFieldResults",alwaysShowText:!0,name:FF.ShowAllFieldResults},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_UpdateAllFields"),icon:"dxre-icon-UpdateField",alwaysShowText:!0,name:FF.UpdateAllFields},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FirstDataRecord"),icon:"dxre-icon-First",name:FF.GoToFirstDataRecord,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_PreviousDataRecord"),icon:"dxre-icon-Prev",name:FF.GoToPreviousDataRecord},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_NextDataRecord"),icon:"dxre-icon-Next",name:FF.GoToNextDataRecord},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_LastDataRecord"),icon:"dxre-icon-Last",name:FF.GoToLastDataRecord},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_MailMergeSaveDocumentAsCommand"),icon:"dxre-icon-MailMerge",alwaysShowText:!0,name:FF.ShowFinishAndMergeForm,beginGroup:!0}],d=[{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SimpleView"),icon:"dxre-icon-SimpleView",alwaysShowText:!0,name:FF.SwitchToSimpleView,isToggleMode:!0},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SwitchToPrintLayoutView"),icon:"dxre-icon-PrintLayoutView",alwaysShowText:!0,name:FF.SwitchToPrintLayoutView,isToggleMode:!0},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleShowHorizontalRuler"),icon:"dxre-icon-RulerHorizontal",alwaysShowText:!0,name:FF.ToggleShowHorizontalRuler,isToggleMode:!0,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_ToggleFullScreen"),icon:"dxre-icon-FullScreen",alwaysShowText:!0,name:FF.FullScreen,isToggleMode:!0,beginGroup:!0}];return[{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageFile"),items:i,id:oJ.File},{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageHome"),items:n,id:oJ.Home},{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageInsert"),items:o,id:oJ.Insert},{title:(0,OV.formatMessage)("ASPxRichEditStringId.PagePageLayout"),items:a,id:oJ.PageLayout},{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageReferences"),items:s,id:oJ.References},{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageMailings"),items:l,id:oJ.MailMerge},{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageView"),items:d,id:oJ.View}]}static getDefaultContextItemsCategories(){GQ();const e=[{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_GoToPageHeader"),icon:"dxre-icon-GoToHeader",name:FF.GoToPageHeader},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_GoToPageFooter"),icon:"dxre-icon-GoToFooter",name:FF.GoToPageFooter},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_GoToPreviousHeaderFooter"),icon:"dxre-icon-ShowPrevious",name:FF.GoToPreviousPageHeaderFooter},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_GoToNextHeaderFooter"),icon:"dxre-icon-ShowNext",name:FF.GoToNextPageHeaderFooter},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleHeaderFooterLinkToPrevious"),icon:"dxre-icon-LinkToPrevious",name:FF.LinkHeaderFooterToPrevious},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleDifferentFirstPage"),icon:"dxre-icon-DifferentFirstPage",name:FF.ToggleDifferentFirstPage,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleDifferentOddAndEvenPages"),icon:"dxre-icon-DifferentOddAndEvenPages",name:FF.ToggleDifferentOddAndEvenPages},{type:"NumberBox",text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_HeaderOffset"),name:FF.ChangeHeaderOffset,min:0,max:20,step:.1,width:200,beginGroup:!0},{type:"NumberBox",text:(0,OV.formatMessage)("ASPxRichEditStringId.MenuCmd_FooterOffset"),name:FF.ChangeFooterOffset,min:0,max:20,step:.1,width:220,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ClosePageHeaderFooter"),icon:"dxre-icon-ClearHeaderAndFooter",name:FF.ClosePageHeaderFooter,beginGroup:!0}],t=[{type:"Menu",name:FF.TableStyleOptionsMenu,alwaysShowText:!0,text:(0,OV.formatMessage)("XtraRichEditStringId.Caption_GroupTableStyleOptions"),icon:"dxre-icon-SplitTableCells",items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleFirstRow"),name:FF.ToggleFirstRow},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleLastRow"),name:FF.ToggleLastRow},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleBandedRows"),name:FF.ToggleBandedRows},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleFirstColumn"),name:FF.ToggleFirstColumn,beginGroup:!0},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleLastColumn"),name:FF.ToggleLastColumn},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleBandedColumn"),name:FF.ToggleBandedColumn}]},{type:"SelectBox",width:180,name:FF.ApplyTableStyle,dataSource:kJ.getTableStylesList(),displayExpr:"text",valueExpr:"value",beginGroup:!0},{type:"SelectBox",width:100,displayExpr:"text",valueExpr:"value",name:FF.ChangeTableBorderStyleRepositoryItem,beginGroup:!0,dataSource:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_None"),value:de.None},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Single"),value:de.Single},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Dotted"),value:de.Dotted},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Dashed"),value:de.Dashed},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Double"),value:de.Double}]},{type:"SelectBox",width:110,displayExpr:"text",valueExpr:"value",name:FF.ChangeTableBorderWidthRepositoryItem,beginGroup:!0,dataSource:[{text:"0.25 pt",value:5},{text:"0.5 pt",value:10},{text:"0.75 pt",value:15},{text:"1 pt",value:20},{text:"1.5 pt",value:30},{text:"2 pt",value:40}]},{type:"ColorBox",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeCurrentBorderRepositoryItemColor"),value:"#000",name:FF.ChangeTableBorderColorRepositoryItem,beginGroup:!0},{type:"Menu",name:FF.BordersMenu,text:(0,OV.formatMessage)("ASPxRichEditStringId.BorderShading_Borders"),alwaysShowText:!0,icon:"dxre-icon-BordersAll",beginGroup:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomBorder"),icon:"dxre-icon-BorderBottom",name:FF.ToggleTableCellsBottomBorder},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsTopBorder"),icon:"dxre-icon-BorderTop",name:FF.ToggleTableCellsTopBorder},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsLeftBorder"),icon:"dxre-icon-BorderLeft",name:FF.ToggleTableCellsLeftBorder},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsRightBorder"),icon:"dxre-icon-BorderRight",name:FF.ToggleTableCellsRightBorder},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ResetTableCellsBorders"),icon:"dxre-icon-BorderNone",name:FF.ToggleTableCellNoBorder,beginGroup:!0},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsAllBorders"),icon:"dxre-icon-BordersAll",name:FF.ToggleTableCellAllBorders},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsOutsideBorder"),icon:"dxre-icon-BorderOutside",name:FF.ToggleTableCellOutsideBorders},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideBorder"),icon:"dxre-icon-BordersInside",name:FF.ToggleTableCellInsideBorders},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideHorizontalBorder"),icon:"dxre-icon-BorderInsideHorizontal",name:FF.ToggleTableCellInsideHorizontalBorders,beginGroup:!0},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsInsideVerticalBorder"),icon:"dxre-icon-BorderInsideVertical",name:FF.ToggleTableCellInsideVerticalBorders},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleShowTableGridLines"),icon:"dxre-icon-ViewTableGridlines",name:FF.ToggleShowTableGridLines,beginGroup:!0}]},{type:"ColorBox",text:(0,OV.formatMessage)("ASPxRichEditStringId.BorderShading_Shading"),value:"#fff",name:FF.ChangeTableCellShading,beginGroup:!0}],r=[{type:"Menu",name:FF.SelectMenu,text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SelectTableElements"),icon:"dxre-icon-Select",items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SelectTableCell"),icon:"dxre-icon-SelectTableCell",name:FF.SelectTableCell},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SelectTableColumns"),icon:"dxre-icon-SelectTableColumn",name:FF.SelectTableColumn},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SelectTableRow"),icon:"dxre-icon-SelectTableRow",name:FF.SelectTableRow},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SelectTable"),icon:"dxre-icon-SelectTable",name:FF.SelectTable}]},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleShowTableGridLines"),icon:"dxre-icon-ViewTableGridlines",alwaysShowText:!0,name:FF.ToggleShowTableGridLines,isToggleMode:!0},{type:"Menu",name:FF.DeleteMenu,text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_DeleteTableElements"),icon:"dxre-icon-DeleteTable",beginGroup:!0,alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_DeleteTableCells"),icon:"dxre-icon-DeleteTableCells",name:FF.ShowDeleteTableCellsForm},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_DeleteTableColumns"),icon:"dxre-icon-DeleteTableColumns",name:FF.DeleteTableColumns},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_DeleteTableRows"),icon:"dxre-icon-DeleteTableRows",name:FF.DeleteTableRows},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_DeleteTable"),icon:"dxre-icon-DeleteTable",name:FF.DeleteTable}]},{type:"Menu",name:FF.InsertMenu,text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertButton"),icon:"dxre-icon-InsertTableRowsBelow",alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableRowAbove"),icon:"dxre-icon-InsertTableRowsAbove",name:FF.InsertTableRowAbove},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableRowBelow"),icon:"dxre-icon-InsertTableRowsBelow",name:FF.InsertTableRowBelow},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableColumnToTheLeft"),icon:"dxre-icon-InsertTableColumnsToTheLeft",name:FF.InsertTableColumnToTheLeft},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_InsertTableColumnToTheRight"),icon:"dxre-icon-InsertTableColumnsToTheRight",name:FF.InsertTableColumnToTheRight}]},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_MergeTableCells"),icon:"dxre-icon-MergeTableCells",alwaysShowText:!0,name:FF.MergeTableCells,beginGroup:!0},{type:"Button",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SplitTableCellsMenuItem"),icon:"dxre-icon-SplitTable",alwaysShowText:!0,name:FF.ShowSplitTableCellsForm},{type:"Menu",name:FF.AutoFitMenu,text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableAutoFitPlaceholder"),icon:"dxre-icon-TableAutoFitContents",beginGroup:!0,alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableAutoFitContents"),icon:"dxre-icon-TableAutoFitContents",name:FF.SetAutoFitContents},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableAutoFitWindow"),icon:"dxre-icon-TableAutoFitWindow",name:FF.SetAutoFitWindow},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableFixedColumnWidth"),icon:"dxre-icon-TableFixedColumnWidth",name:FF.SetFixedColumnWidth}]},{type:"Menu",name:FF.AlignmentMenu,text:(0,OV.formatMessage)("ASPxRichEditStringId.Alignment"),icon:"dxre-icon-AlignTopLeft",alwaysShowText:!0,beginGroup:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsTopLeftAlignment"),icon:"dxre-icon-AlignTopLeft",name:FF.TableCellAlignTopLeft},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsTopCenterAlignment"),icon:"dxre-icon-AlignTopCenter",name:FF.TableCellAlignTopCenter},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsTopRightAlignment"),icon:"dxre-icon-AlignTopRight",name:FF.TableCellAlignTopRight},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleLeftAlignment"),icon:"dxre-icon-AlignMiddleLeft",name:FF.TableCellAlignMiddleLeft,beginGroup:!0},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleCenterAlignment"),icon:"dxre-icon-AlignMiddleCenter",name:FF.TableCellAlignMiddleCenter},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsMiddleRightAlignment"),icon:"dxre-icon-AlignMiddleRight",name:FF.TableCellAlignMiddleRight},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomLeftAlignment"),icon:"dxre-icon-AlignBottomLeft",name:FF.TableCellAlignBottomLeft,beginGroup:!0},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomCenterAlignment"),icon:"dxre-icon-AlignBottomCenter",name:FF.TableCellAlignBottomCenter},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ToggleTableCellsBottomRightAlignment"),icon:"dxre-icon-AlignBottomRight",name:FF.TableCellAlignBottomRight}]}],i=[{type:"ColorBox",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeFloatingObjectFillColor"),value:"#fff",name:FF.ChangeFloatingObjectFillColor,beginGroup:!0},{type:"ColorBox",text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeFloatingObjectOutlineColor"),value:"#000",name:FF.ChangeFloatingObjectOutlineColor,beginGroup:!0},{type:"SelectBox",width:110,displayExpr:"text",valueExpr:"value",name:FF.ChangeFloatingObjectOutlineWidth,beginGroup:!0,dataSource:[{text:"0 pt",value:0},{text:"0.25 pt",value:5},{text:"0.5 pt",value:10},{text:"0.75 pt",value:15},{text:"1 pt",value:20},{text:"1.5 pt",value:30},{text:"2.25 pt",value:45},{text:"3 pt",value:60},{text:"4.5 pt",value:90},{text:"6 pt",value:120}]},{type:"Menu",name:FF.WrapTextMenu,text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ChangeFloatingObjectTextWrapType"),icon:"dxre-icon-TextWrapSquare",alwaysShowText:!0,beginGroup:!0,items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.LayoutOptions_Inline"),icon:"dxre-icon-TextWrapInline",name:FF.SetFloatingObjectInlineTextWrapType},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectSquareTextWrapType"),icon:"dxre-icon-TextWrapSquare",name:FF.SetFloatingObjectSquareTextWrapType},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectTightTextWrapType"),icon:"dxre-icon-TextWrapTight",name:FF.SetFloatingObjectTightTextWrapType},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectThroughTextWrapType"),icon:"dxre-icon-TextWrapThrough",name:FF.SetFloatingObjectThroughTextWrapType},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectTopAndBottomTextWrapType"),icon:"dxre-icon-TextWrapTopAndBottom",name:FF.SetFloatingObjectTopAndBottomTextWrapType},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectBehindTextWrapType"),icon:"dxre-icon-TextWrapBehind",name:FF.SetFloatingObjectBehindTextWrapType},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectInFrontOfTextWrapType"),icon:"dxre-icon-TextWrapInFrontOfText",name:FF.SetFloatingObjectInFrontOfTextWrapType}]},{type:"Menu",name:FF.PositionMenu,text:(0,OV.formatMessage)("ASPxRichEditStringId.GroupHeaderFooterToolsDesignPosition"),icon:"dxre-icon-AlignFloatingObjectTopRight",alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectTopLeftAlignment"),icon:"dxre-icon-AlignFloatingObjectTopLeft",name:FF.SetFloatingObjectTopLeftAlignment},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectTopCenterAlignment"),icon:"dxre-icon-AlignFloatingObjectTopCenter",name:FF.SetFloatingObjectTopCenterAlignment},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectTopRightAlignment"),icon:"dxre-icon-AlignFloatingObjectTopRight",name:FF.SetFloatingObjectTopRightAlignment},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleLeftAlignment"),icon:"dxre-icon-AlignFloatingObjectMiddleLeft",name:FF.SetFloatingObjectMiddleLeftAlignment,beginGroup:!0},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleCenterAlignment"),icon:"dxre-icon-AlignFloatingObjectMiddleCenter",name:FF.SetFloatingObjectMiddleCenterAlignment},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectMiddleRightAlignment"),icon:"dxre-icon-AlignFloatingObjectMiddleRight",name:FF.SetFloatingObjectMiddleRightAlignment},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomLeftAlignment"),icon:"dxre-icon-AlignFloatingObjectBottomLeft",name:FF.SetFloatingObjectBottomLeftAlignment,beginGroup:!0},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomCenterAlignment"),icon:"dxre-icon-AlignFloatingObjectBottomCenter",name:FF.SetFloatingObjectBottomCenterAlignment},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_SetFloatingObjectBottomRightAlignment"),icon:"dxre-icon-AlignFloatingObjectBottomRight",name:FF.SetFloatingObjectBottomRightAlignment}]},{type:"Menu",name:FF.BringForwardMenu,text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_FloatingObjectBringForward"),icon:"dxre-icon-FloatingObjectBringForward",alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_FloatingObjectBringForward"),icon:"dxre-icon-FloatingObjectBringForward",name:FF.FloatingObjectBringForward},{text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_FloatingObjectBringToFront"),icon:"dxre-icon-FloatingObjectBringToFront",name:FF.FloatingObjectBringToFront},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectBringInFrontOfText"),icon:"dxre-icon-FloatingObjectBringInFrontOfText",name:FF.FloatingObjectBringInFrontOfText}]},{type:"Menu",name:FF.SendBackwardMenu,text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_FloatingObjectSendBackward"),icon:"dxre-icon-FloatingObjectSendBackward",alwaysShowText:!0,items:[{text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_FloatingObjectSendBackward"),icon:"dxre-icon-FloatingObjectSendBackward",name:FF.FloatingObjectSendBackward},{text:(0,OV.formatMessage)("OfficeStringId.MenuCmd_FloatingObjectSendToBack"),icon:"dxre-icon-FloatingObjectSendToBack",name:FF.FloatingObjectSendToBack},{text:(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_FloatingObjectSendBehindText"),icon:"dxre-icon-FloatingObjectSendBehindText",name:FF.FloatingObjectSendBehindText}]}];return[{name:FF.ContextItem_HeadersFooters,items:[{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageHeaderAndFooter"),items:e,id:oJ.HeadersFooters}]},{name:FF.ContextItem_Tables,items:[{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageTableDesign"),items:t,id:oJ.TableDesign},{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageTableLayout"),items:r,id:oJ.TableLayout}]},{name:FF.ContextItem_FloatingObjects,items:[{title:(0,OV.formatMessage)("ASPxRichEditStringId.PageFloatingObjects"),items:i,id:oJ.FloatingObjectsFormat}]}]}}class qQ extends OJ{constructor(e,t,r={}){super(e,r.beginGroup),this.type=nJ.Button,this.text=t,this.icon=r.icon,this.localizationId=r.localizationId,this.showText=void 0!==r.showText&&r.showText,this.toggleMode=void 0!==r.toggleMode&&r.toggleMode,this.selected=void 0!==r.selected&&r.selected}}class $Q extends OJ{constructor(e,t,r,i={}){var n;super(e,i.beginGroup),this.type=nJ.ColorBox,this.text=t,this.value=r,this.localizationId=i.localizationId,this.textOptions=null!==(n=i.textOptions)&&void 0!==n?n:{}}}class JQ extends OJ{constructor(e,t,r,i={}){super(e,i.beginGroup),this.type=nJ.Menu,this.showText=!1,this.text=t,this.items=r,this.icon=i.icon,this.localizationId=i.localizationId,this.showText=void 0!==i.showText&&i.showText}}class YQ extends OJ{constructor(e,t,r={}){super(e,r.beginGroup),this.type=nJ.NumberBox,this.text=t,this.min=r.min,this.max=r.max,this.step=void 0===r.step?1:r.step,this.width=r.width,this.localizationId=r.localizationId,this.format=r.format,this.value=r.value}}class QQ{constructor(e){this.path=e.replace(/\\/g,"/"),this.documentFormat=ZQ.getDocumentFormat(this.path),this.extension=null===this.documentFormat?"":ZQ.documentFormatToExtension(this.documentFormat);const t=this.path.lastIndexOf("/");t>=0?(this.directoryPath=this.path.substring(0,t),this.name=this.path.substring(t+1)):(this.directoryPath="",this.name=this.path),this.nameWithoutExtension=this.name.substring(0,this.name.length-this.extension.length)}}class ZQ{static download(e,t){GU.FileUtils.startDownloadFileLocal(e,t)}static parseFilePath(e){return new QQ(e)}static documentFormatToExtension(e){return QU.convertToString(e)}static getDocumentFormat(e){const t=e.lastIndexOf("."),r=t>=0?e.substr(t):e,i=QU.convertExtensionToDocumentFormat(r);return i===Fu.Undefined?null:i}static convertArrayBufferToBase64(e){return lo.Base64Utils.fromArrayBuffer(e)}static convertBlobToBase64(e,t){lo.Base64Utils.fromBlobAsDataUrl(e,t)}static convertToBlob(e,t){return(0,S.isString)(e)?new Blob([lo.Base64Utils.getUint8Array(e)],t):new Blob([e],t)}static convertToFile(e,t="",r){return(0,S.isString)(e)?lo.Base64Utils.getFileFromBase64(lo.Base64Utils.deleteDataUrlPrefix(e),t,r):GU.FileUtils.createFile([e],t,r)}static convertBase64ToArrayBuffer(e){return lo.Base64Utils.getUint8Array(e)}static convertBlobToArrayBuffer(e,t){const r=new FileReader;r.onloadend=()=>t(r.result),r.readAsArrayBuffer(e)}static getIntervalComplement(e,t){const r=f.ListUtils.map(t,(e=>vb(e))),i=nn.IntervalAlgorithms.reflectIntervalsTemplate(r,vb(e),new on.FixedInterval(0,0));return f.ListUtils.map(i,(e=>Tb(e)))}}class eZ{static create(e){const t=this.createCore(e);return t?e=>{var r;return null!==(r=t(e))&&void 0!==r?r:e}:null}static createCore(e){return"number"===e.toLowerCase()?e=>parseFloat(e):null}}class tZ extends OJ{constructor(e,t,r={}){var i;if(super(e,r.beginGroup),this.type=nJ.SelectBox,this.dataSource=t,this.width=r.width,this.displayExpr=r.displayExpr,this.valueExpr=r.valueExpr,this.value=r.value,this.valueType=r.valueType,this._localizeDataSourceItems=void 0!==r._localizeDataSourceItems&&r._localizeDataSourceItems,this.textOptions=null!==(i=r.textOptions)&&void 0!==i?i:{},this.showClearButton=void 0!==r.showClearButton&&r.showClearButton,this.placeholder=r.placeholder,this.acceptCustomValue=!!(0,S.isDefined)(r.acceptCustomValue)&&r.acceptCustomValue,this.onCustomItemCreating=r.onCustomItemCreating?(0,yd.tm)(r.onCustomItemCreating):void 0,!this.onCustomItemCreating&&this.valueType){const e=eZ.create(this.valueType);e&&(this.onCustomItemCreating=t=>t.customItem={text:t.text,value:e(t.text)})}}}class rZ extends OJ{constructor(e,t,r=[],i={}){super(e,i.beginGroup),this.type=nJ.SubMenu,this.text=t,this.items=r,this.icon=i.icon,this.localizationId=i.localizationId}convertToButton(){return new qQ(this.id,this.text,{showText:!0,toggleMode:!1,icon:this.icon,beginGroup:!1,localizationId:this.localizationId})}}class iZ{constructor(){this.visible=!0,this.activeTabIndex=1,this.tabs=[]}clearTabs(){this.tabs=[]}removeTab(e){const t=e instanceof _J?f.ListUtils.indexBy(this.tabs,(t=>t==e)):f.ListUtils.indexBy(this.tabs,(t=>t.id==e));return t>=0?this.tabs.splice(t,1)[0]:null}insertTab(e,t=this.tabs.length){return this.tabs.splice(t,0,e),e}insertTabBefore(e,t){return nZ(this.tabs,e,t,!0),e}insertTabAfter(e,t){return nZ(this.tabs,e,t,!1),e}getTab(e){return f.ListUtils.elementBy(this.tabs,(t=>t.id==e))}}function nZ(e,t,r,i){const n=function(e,t){return(0,S.isNumber)(t)||(0,S.isString)(t)?f.ListUtils.indexBy(e,(e=>e.id==t)):f.ListUtils.indexBy(e,(e=>e===t))}(e,r);e.splice(n<0?e.length:i?n:n+1,0,t)}function oZ(){const e=new iZ;return aZ(e),sZ(e),e}function aZ(e,t=KQ.getDefaultItems()){t.forEach((t=>e.insertTab(lZ(t))))}function sZ(e,t=KQ.getDefaultContextItemsCategories()){t.forEach((t=>t.items.forEach((r=>e.insertTab(lZ(r,t.name))))))}function lZ(e,t){const r=function(e){return f.ListUtils.map(e,(e=>{switch(e.type){case"Button":return new qQ(e.name,e.text,{showText:e.alwaysShowText,toggleMode:e.isToggleMode,icon:e.icon,beginGroup:e.beginGroup,localizationId:e.localizationId,selected:e.selected});case"ButtonGroup":throw new Error(R.D.NotImplemented);case"ColorBox":return new $Q(e.name,e.text,e.value,{beginGroup:e.beginGroup,localizationId:e.localizationId,textOptions:e.textOptions});case"Menu":return new JQ(e.name,e.text,t(e.items),{beginGroup:e.beginGroup,icon:e.icon,showText:e.alwaysShowText,localizationId:e.localizationId});case"NumberBox":return new YQ(e.name,e.text,{beginGroup:e.beginGroup,min:e.min,max:e.max,step:e.step,width:e.width,localizationId:e.localizationId,format:e.format,value:e.value});case"SelectBox":return new tZ(e.name,e.dataSource,{beginGroup:e.beginGroup,width:e.width,displayExpr:e.displayExpr,valueExpr:e.valueExpr,value:e.value,valueType:e.valueType,showClearButton:e.showClearButton,placeholder:e.placeholder,acceptCustomValue:e.acceptCustomValue,onCustomItemCreating:e.onCustomItemCreating,textOptions:e.textOptions,_localizeDataSourceItems:e._localizeDataSourceItems});default:throw new Error(R.D.InternalException)}}));function t(e){return e?f.ListUtils.map(e,(e=>new rZ(e.name,e.text,t(e.items),{icon:e.icon,beginGroup:e.beginGroup,localizationId:e.localizationId}))):[]}}(e.items);return void 0===t?new _J(e.title,e.id,r,e.localizationId):new UJ(e.title,e.id,t,r,e.localizationId)}function dZ(e){return{id:e.id,title:e.title,visible:!0,items:cZ(e.items),localizationId:e.localizationId}}function cZ(e){return f.ListUtils.map(e,(e=>{switch(e.type){case nJ.Button:return{type:"Button",name:e.id,beginGroup:e.beginGroup,text:e.text,icon:e.icon,alwaysShowText:e.showText,isToggleMode:e.toggleMode,selected:e.selected,localizationId:e.localizationId};case nJ.ColorBox:return{type:"ColorBox",text:e.text,value:e.value,textOptions:e.textOptions,name:e.id,beginGroup:e.beginGroup,localizationId:e.localizationId};case nJ.Menu:return{type:"Menu",items:t(e.items),name:e.id,beginGroup:e.beginGroup,text:e.text,icon:e.icon,alwaysShowText:e.showText,localizationId:e.localizationId};case nJ.NumberBox:return{type:"NumberBox",min:e.min,max:e.max,step:e.step,text:e.text,width:e.width,name:e.id,beginGroup:e.beginGroup,localizationId:e.localizationId,format:e.format,value:e.value};case nJ.SelectBox:return{type:"SelectBox",dataSource:e.dataSource,width:e.width,displayExpr:e.displayExpr,valueExpr:e.valueExpr,name:e.id,beginGroup:e.beginGroup,value:e.value,textOptions:e.textOptions,showClearButton:e.showClearButton,placeholder:e.placeholder,acceptCustomValue:e.acceptCustomValue,onCustomItemCreating:e.onCustomItemCreating,_localizeDataSourceItems:e._localizeDataSourceItems};default:throw new Error(e.type==nJ.SubMenu?"Sub menu item must be placed under menu item":R.D.NotImplemented)}}));function t(e){if(e)return f.ListUtils.map(e,(e=>({text:e.text,name:e.id,icon:e.icon,items:t(e.items),beginGroup:e.beginGroup,localizationId:e.localizationId})))}}class hZ extends mQ{constructor(e,t,r,i){var n;super(e),this.activeItem=null,this.ownerElement=t,this.init(r,i),this.createControl(null!==(n=r.activeTabIndex)&&void 0!==n?n:1)}updateContextItem(e){}onCanvasMouseDown(){}init(e,t){this.items=[],this.contextItemsCategories=[],e.tabs.forEach((e=>{if(hZ.changeFontNameItems(e,t),e.contextTab){const t=e;let r=f.ListUtils.elementBy(this.contextItemsCategories,(e=>e.name==t.category));r||this.contextItemsCategories.push(r={name:t.category,items:[]}),r.items.push(dZ(t))}else this.items.push(dZ(e))}))}dispose(){this.ribbon.dispose()}checkActivateHeaderFooter(e){return!1}createControl(e){const t=document.createElement("div");t.tabIndex=0;const r=this.ownerElement.firstChild;r?this.ownerElement.insertBefore(t,r):this.ownerElement.appendChild(t),this.createRibbon(t,e)}getCommandKeys(){return B.StringMapUtils.toListBy(this.getToolbarItemsCache(this.ribbon.getActiveTabIndex()),((e,t)=>t))}setItemValue(e,t){const r=this.getToolbarItemsCache(this.ribbon.getActiveTabIndex())[e];r&&r.forEach((e=>{e.setValue(t)}))}setItemEnabled(e,t){const r=this.getToolbarItemsCache(this.ribbon.getActiveTabIndex())[e];r&&r.forEach((e=>{e.setEnabled(t)}))}setItemVisible(e,t){const r=this.getToolbarItemsCache(this.ribbon.getActiveTabIndex())[e];r&&r.forEach((e=>{e.setVisible(t)}))}getContextKeys(){return this.contextItemsCategories?this.contextItemsCategories.map((e=>e.name)):[]}setContextItemVisible(e,t){this.ribbon.setContextItemsCategoryVisible(e,t)}getTabVisible(e){return this.ribbon.getItemVisible(e)}activateContextItem(e){const t=this.ribbon.getContextItemsIndexes(e);t&&t.length&&this.ribbon.setActiveTabIndex(t[0])}adjustControl(){this.ribbon.adjustControl()}getHeight(){const e=this.ribbon.getTabPanel().element();return e[0]?gK.getOffsetHeight(e[0]):gK.getOffsetHeight(e)}setActiveTabIndex(e){this.ribbon.getTabPanel().option("selectedIndex",e)}getActiveTabIndex(){return this.ribbon.getTabPanel().option("selectedIndex")}createRibbon(e,t){this.ribbon=new jQ({element:e,items:this.items,contextItemsCategories:this.contextItemsCategories,activeTabIndex:t,onTitleClickHandler:()=>{this.owner.Focus()},onSelectionChangedHandler:()=>{this.updateItemsState()},onCommandExecuted:this.getOnCommandExecutedHandler(),onOnToolbarItemCreated:this.getOnToolbarItemCreatedHandler(),onOpened:this.getOnOpenedToolbarItemHandler(),onClosed:this.getOnClosedToolbarItemHandler()}),this.ribbon.render()}getOnOpenedToolbarItemHandler(){return e=>{e.item.name&&(this.activeItem=e.item)}}getOnClosedToolbarItemHandler(){return e=>{e.item.name&&(this.activeItem=null)}}getOnCommandExecutedHandler(){return e=>{e.item.name&&this.raiseBarCommandExecuted(e.item.name,e.parameter)}}getOnToolbarItemCreatedHandler(){return e=>{this.addToolbarItemToCache(e.item,e.item instanceof AQ?e.item.name:e.options.name,e.tabIndex)}}addToolbarItemToCache(e,t,r){const i=this.getToolbarItemsCache(r);let n=i[t];void 0===n&&(n=i[t]=[]),n.push(e)}getToolbarItemsCache(e){return this._toolbarItemsCache||(this._toolbarItemsCache={}),this._toolbarItemsCache[e]||(this._toolbarItemsCache[e]={}),this._toolbarItemsCache[e]}static changeFontNameItems(e,t){t.fonts.length>0&&e.items.forEach((e=>{if(e.id==FF.ChangeFontName){e.dataSource=t.fonts.map((e=>({text:e.name,value:e.name})))}}))}closeActiveItem(){this.activeItem&&(this.activeItem.widget.close(),this.activeItem=null)}containsChild(e){return this.ribbon.containsChild(e)}}var uZ,pZ,gZ,mZ,fZ,bZ,CZ,SZ,IZ,PZ,wZ,yZ=DevExpress.events;class xZ extends EU{isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.bookmarks)}getState(){return new UU(this.isEnabled())}}class TZ extends xZ{executeCore(e,t){const r=t.param,i=t.subDocument;if(!Cd.isValidName(r.name,!0))return!1;this.history.beginTransaction();const n=du.findBookmark(this.control.modelManager.model.subDocuments,r.name);return n&&this.history.addAndRedo(new Bg(this.modelManipulator,n.subDocument,n.bookmark.constBookmark)),this.history.addAndRedo(new Lg(this.modelManipulator,i,r)),this.history.endTransaction(),!0}}class vZ extends xZ{executeCore(e,t){const r=t.param;this.history.beginTransaction();let i=!1;for(let e of r){const t=du.findBookmark(this.control.modelManager.model.subDocuments,e);t&&(this.history.addAndRedo(new Bg(this.modelManipulator,t.subDocument,t.bookmark.constBookmark)),i=!0)}return this.history.endTransaction(),i}}class MZ extends xZ{executeCore(e,t){const r=du.findBookmark(this.control.modelManager.model.subDocuments,t.param);if(!r)return!1;const i=this.selection,n=r.subDocument,o=r.bookmark;return this.changeSubDocument(n),i.setSelection((new GX).setInterval(o.interval).setEndOfLine(!1).setCorrectIntervalDueToFields(!0).setCorrectIntervalDueToTables(!0)),i.scrollManager.setScroll((new xD).byModelPosition(i).setModelPosition(o.start).setRelativePosition(eE.Top).setVerticalOffset((e=>-Math.ceil(e.getVisibleAreaHeight(!1)/4)))),!0}changeSubDocument(e){this.selection.activeSubDocument!=e&&(e.isMain()?this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(this.control.commandManager.isPublicApiCall):this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterBySubDocument).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,e)))}isEnabledInReadOnlyMode(){return!0}}class EZ extends EU{getState(e=this.convertToCommandOptions(void 0)){this._options=e;const t=new VU(this.isEnabled(),f.ListUtils.deepCopy(e.intervalsInfo.intervals),this.getValueForState(this.getCurrentValue()));return t.denyUpdateValue=this.isLockUpdateValue(),t}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.characterFormatting)}lockInputPositionUpdating(){return!0}getIntervalsForModifying(){return this.getApplyToIntervals(this._options)}getApplyToIntervals(e){if(e.intervalsInfo.isCollapsed){const t=e.intervalsInfo.position,r=e.subDocument.getParagraphByPosition(t);let i;i=t+1!=r.getEndPosition()||r.isInList()?e.subDocument.getWholeWordInterval(t):new on.FixedInterval(r.getEndPosition()-1,1);const n=[i];return e.subDocument.isEditable(n)?n:e.intervalsInfo.intervals}return f.ListUtils.map(e.intervalsInfo.intervals,(e=>(this._areParagraphContentInterval(e)&&e.length++,e)))}_areParagraphContentInterval(e){const t=this.selection.activeSubDocument.getParagraphByPosition(e.start).interval;return e.start==t.start&&e.end==t.end-1}executeCore(e,t){const r=this.getDescriptor(),i=t.param,n=this.getApplyToIntervals(t);if(this.getCurrentValue()!==i){const e=this.history;e.beginTransaction(),this.applyToInputPosition(r,i);for(let o of n)o.length>0&&e.addAndRedo(new(r.getHistoryItemConstructor())(this.modelManipulator,new gu(t.subDocument,o),i,!0));e.endTransaction()}return!0}applyToInputPosition(e,t){e.setProp(this.inputPosition.getMaskedCharacterProperties(),t),e.setProp(this.inputPosition.getMergedCharacterPropertiesFull(),t),e.setProp(this.inputPosition.getMergedCharacterPropertiesRaw(),t),this.inputPosition.getMaskedCharacterProperties().setUseValue(e.maskValue(),!0)}isLockUpdateValue(){return!1}getCurrentValue(){return this.getDescriptor().getProp(this.inputPosition.getMergedCharacterPropertiesRaw())}getValueForState(e){return e}convertBooleanParameterToEnumType(e,t,r){return"boolean"==typeof e?e?t:r:this.getCurrentValue()==t?r:t}}class DZ extends EZ{getDescriptor(){return ir.highlightColor}getValueForState(e){return e?e.toRgb(this.control.modelManager.model.colorProvider):void 0}isLockUpdateValue(){return!0}DEPRECATEDConvertOptionsParameter(e){return he.makeByColor(y.anyToColor(e,y.NO_COLOR))}}class FZ extends EZ{getDescriptor(){return ir.shadingInfo}getValueForState(e){return e?e.getActualColor(this.colorProvider):void 0}isLockUpdateValue(){return!0}DEPRECATEDConvertOptionsParameter(e){return fe.createByColor(he.makeByColor(y.anyToColor(e,y.NO_COLOR)))}}class RZ extends EZ{getDescriptor(){return ir.textColor}getValueForState(e){return e?e.toRgb(this.control.modelManager.model.colorProvider):void 0}DEPRECATEDConvertOptionsParameter(e){return he.makeByColor(y.anyToColor(e,y.AUTOMATIC_COLOR))}isLockUpdateValue(){return!0}}class LZ extends EZ{getDescriptor(){return ir.fontInfo}DEPRECATEDConvertOptionsParameter(e){if((0,S.isNumber)(e))return this.control.modelManager.model.cache.fontInfoCache.getItemByJsonKey(e);if("string"==typeof e){let t=this.control.modelManager.model.cache.fontInfoCache.getItemByName(e);if(!t){const r=this.inputPosition.getMergedCharacterPropertiesFull();if(r.fontInfo)return t=r.fontInfo.clone(),t.name=e,t.cssString=e.match(/^\w+\s/gi)?"'"+e+"'":e,this.modelManipulator.font.loadFontInfo(t,this.selection.activeSubDocument,this.selection.intervals,this.control.measurer),t}if(t)return t}return this.getCurrentValue()}}class BZ extends EZ{getDescriptor(){return ir.size}DEPRECATEDConvertOptionsParameter(e){const t="string"==typeof e?parseFloat(e):e;return this.isFontSizeValueCorrect(t)?t:this.getCurrentValue()}isFontSizeValueCorrect(e){if((0,S.isNumber)(e)&&!isNaN(e)&&e>=an.minFontSize&&e<=an.maxFontSize){const t=e%1;if(0===t||.5===t)return!0}return!1}}class AZ extends BZ{executeCore(e,t){const r=this.getDescriptor(),i=new jh(t.subDocument,!1),n=new lH.g(Qe.Comparers.number,new on.FixedInterval(0,0));for(let e of this.getApplyToIntervals(t)){const t=e.end;i.setPosition(e.start);do{const e=i.getAbsolutePosition();if(e>=t)break;n.add(e,i.run.getCharacterMergedProperties().fontSize)}while(i.moveToNextChar())}if(t.intervalsInfo.isCollapsed){let e=this.getCurrentValue();void 0===e&&(i.setPosition(t.intervalsInfo.interval.start),e=i.run.getCharacterMergedProperties().fontSize),this.applyToInputPosition(r,this.step(e))}else this.inputPosition.reset();const o=this.history;o.beginTransaction();const a=n.getIterator();for(;a.moveToNextInterval();)a.interval.length>0&&o.addAndRedo(new(r.getHistoryItemConstructor())(this.modelManipulator,new gu(t.subDocument,a.interval),this.step(a.object),!0));return o.endTransaction(),this.control.barHolder.forceUpdate({[FF.ChangeFontSize]:!0}),!0}}class NZ extends AZ{step(e){return an.getPreviousPredefinedFontSize(e)}}class kZ extends AZ{step(e){return an.getNextPredefinedFontSize(e)}}class OZ extends EZ{getDescriptor(){return ir.bold}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,!0,!1)}}class _Z extends EZ{getDescriptor(){return ir.italic}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,!0,!1)}}class UZ extends EZ{getDescriptor(){return ir.script}getValueForState(e){return e==ne.Subscript}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,ne.Subscript,ne.Normal)}}class HZ extends EZ{getDescriptor(){return ir.script}getValueForState(e){return e==ne.Superscript}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,ne.Superscript,ne.Normal)}}class VZ extends EZ{getDescriptor(){return ir.strikeoutType}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,se.Single,se.None)}}class WZ extends EZ{getDescriptor(){return ir.underlineType}}class zZ extends WZ{getActualValue(e,t){return t?le.None:le.Single}getValueForState(e){return e==le.Single}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,le.Single,le.None)}}class jZ extends WZ{getActualValue(e,t){return t?le.None:le.Double}getValueForState(e){return e==le.Double}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,le.Double,le.None)}}class XZ extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=this.createParameters(t),i=r.clone();return r.applyConverter(this.control.uiUnitConverter.twipsToUI),this.control.owner.showDialog(this.getDialogName(),r,(t=>{t&&(t.applyConverter(this.control.uiUnitConverter.UIToTwips),this.control.beginUpdate(),this.applyParameters(e,t,i),this.control.barHolder.forceUpdate(this.getRelatedCommands()),this.control.endUpdate()),!yH.Browser.TouchUI&&this.isModal()&&this.control.focusManager.captureFocus()}),(()=>{yH.Browser.TouchUI||this.control.focusManager.captureFocus(),this.afterClosing(t)}),this.isModal()),!0}applyParameters(e,t,r){return!1}afterClosing(e){}isModal(){return!0}}class GZ{copyFrom(e){}}!function(e){e[e.SaveAsFile=0]="SaveAsFile",e[e.OpenFile=1]="OpenFile",e[e.Font=2]="Font",e[e.Paragraph=3]="Paragraph",e[e.PageSetup=4]="PageSetup",e[e.Columns=5]="Columns",e[e.InsertImage=6]="InsertImage",e[e.Error=7]="Error"}(uZ||(uZ={}));class KZ extends XZ{createParameters(e){const t=new u0;return t.messageTextId=this.getMessageTextId(),t}isEnabledInReadOnlyMode(){return!0}}class qZ extends KZ{getDialogName(){return"ErrorMessage"}}class $Z extends KZ{getDialogName(){return"InformationMessage"}}class JZ extends KZ{getDialogName(){return"WarningMessage"}}class YZ extends qZ{getMessageTextId(){return pZ.ModelIsChanged}afterClosing(){this.control.commandManager.getCommand(FF.ReloadDocument).execute(this.control.commandManager.isPublicApiCall)}}class QZ extends qZ{getMessageTextId(){return pZ.SessionHasExpired}}class ZZ extends qZ{getMessageTextId(){return pZ.OpeningAndOverstoreImpossible}}class e0 extends qZ{getMessageTextId(){return pZ.CantSaveToEmptyPath}}class t0 extends JZ{getMessageTextId(){return yH.Browser.TouchUI?pZ.ClipboardAccessDeniedTouch:pZ.ClipboardAccessDenied}}class r0 extends qZ{getMessageTextId(){return pZ.InnerException}afterClosing(){this.control.commandManager.getCommand(FF.ReloadDocument).execute(!1)}}class i0 extends qZ{getMessageTextId(){return pZ.InvalidDocumentFormat}}class n0 extends qZ{getMessageTextId(){return pZ.AuthException}afterClosing(){this.control.commandManager.getCommand(FF.ReloadDocument).execute(this.control.commandManager.isPublicApiCall)}}class o0 extends qZ{getMessageTextId(){return pZ.CantOpenFile}isEnabledInClosedDocument(){return!0}}class a0 extends qZ{getMessageTextId(){return pZ.CantSaveFile}}class s0 extends qZ{getMessageTextId(){return pZ.PathTooLongException}}class l0 extends qZ{getMessageTextId(){return pZ.DocVariableException}}class d0 extends qZ{getMessageTextId(){return pZ.InsertContentFromServerException}}class c0 extends qZ{getMessageTextId(){return pZ.LoadPictureError}}class h0 extends $Z{getMessageTextId(){return pZ.SpellingCheckCompleted}}class u0 extends GZ{copyFrom(e){super.copyFrom(e),this.messageTextId=e.messageTextId}clone(){const e=new u0;return e.copyFrom(this),e}applyConverter(e){return this}}!function(e){e[e.ModelIsChanged=0]="ModelIsChanged",e[e.SessionHasExpired=1]="SessionHasExpired",e[e.OpeningAndOverstoreImpossible=2]="OpeningAndOverstoreImpossible",e[e.ClipboardAccessDenied=3]="ClipboardAccessDenied",e[e.InnerException=4]="InnerException",e[e.AuthException=5]="AuthException",e[e.CantOpenFile=6]="CantOpenFile",e[e.CantSaveFile=7]="CantSaveFile",e[e.DocVariableException=8]="DocVariableException",e[e.PathTooLongException=9]="PathTooLongException",e[e.InvalidDocumentFormat=10]="InvalidDocumentFormat",e[e.SpellingCheckCompleted=11]="SpellingCheckCompleted",e[e.ClipboardAccessDeniedTouch=12]="ClipboardAccessDeniedTouch",e[e.CantSaveToEmptyPath=13]="CantSaveToEmptyPath",e[e.InsertContentFromServerException=14]="InsertContentFromServerException",e[e.LoadPictureError=15]="LoadPictureError",e[e.DocumentImportError=16]="DocumentImportError"}(pZ||(pZ={}));class p0 extends XZ{getState(){const e=new UU(this.isEnabled());return e.visible=Bb.isVisible(this.control.modelManager.richOptions.control.bookmarks),e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.bookmarks)&&1===this.selection.intervals.length}createParameters(e){const t=new m0;t.bookmarks=f.ListUtils.map(this.control.modelManager.model.getAllBookmarks(!1),(e=>new g0(e.name,e.start))),t.allowedEditBookmarks=this.control.readOnly!=RF.Persistent;const r=this.control.selection.activeSubDocument.findBookmarkByInterval(this.control.selection.intervals,!1);return t.selectedBookmarkName=r.length?r[r.length-1].name:null,t}applyParameters(e,t){return t.newBookmarkName?this.control.commandManager.getCommand(FF.CreateBookmark).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,new Sd(this.selection.intervals[0],t.newBookmarkName))):t.deletedBookmarkNames.length>0&&this.control.commandManager.getCommand(FF.DeleteBookmarks).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,t.deletedBookmarkNames)),!0}getDialogName(){return"Bookmarks"}isEnabledInReadOnlyMode(){return!0}}class g0{constructor(e,t){this.name=e,this.start=t}}class m0 extends GZ{copyFrom(e){super.copyFrom(e),this.bookmarks=e.bookmarks,this.deletedBookmarkNames=e.deletedBookmarkNames,this.newBookmarkName=e.newBookmarkName,this.allowedEditBookmarks=e.allowedEditBookmarks}clone(){const e=new m0;return e.copyFrom(this),e}applyConverter(e){return this}}class f0 extends EU{constructor(){super(...arguments),this.affectNeighbours=!0,this.affectInner=!0,this.affectOuter=!0,this.affectOnStateFlags=gZ.All}get colorProvider(){return this.control.modelManager.model.colorProvider}DEPRECATEDConvertOptionsParameter(e){return e instanceof Me?e:this.control.modelManager.model.repositoryBorderItem}getRelatedCommands(){return{[FF.ToggleTableCellAllBorders]:!0,[FF.ToggleTableCellInsideBorders]:!0,[FF.ToggleTableCellInsideHorizontalBorders]:!0,[FF.ToggleTableCellInsideVerticalBorders]:!0,[FF.ToggleTableCellNoBorder]:!0,[FF.ToggleTableCellOutsideBorders]:!0,[FF.ToggleTableCellsBottomBorder]:!0,[FF.ToggleTableCellsLeftBorder]:!0,[FF.ToggleTableCellsRightBorder]:!0,[FF.ToggleTableCellsTopBorder]:!0}}getState(e=this.convertToCommandOptions(null)){const t=this.selection.tableInfo;let r=this.isEnabled()&&this.selection.tableInfo.extendedData.areCellsSelectedInSeries,i=new UU(r);return i.enabled&&(i.value=this.isChecked(t,e.param)),i}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}isChecked(e,t){let r=e.table;if(e.extendedData.isSelectedEntireTable)return this.checkBorderInEntireTable(t,r);let i=new Ez(this.control.modelManager.model,r,(e=>e)),n=this.createCellBorderGrid(r,e,i);return this.isCheckedInParticallyTableSelection(r,n,i,t)}executeCore(e,t){this.history.beginTransaction();let r=this.selection.tableInfo,i=r.table,n=t.param,o=this.selection.activeSubDocument;r.extendedData.isSelectedEntireTable&&this.applyBorderToTable(o,i,e.value?null:n);let a=new Ez(this.control.modelManager.model,i,(e=>e)),s=this.createCellBorderGrid(i,r,a);for(let t,r=0;t=s[r];r++){let a=-1,s=null;for(let l,d=0;l=t[d];d++)l.cell!=s&&a++,s=l.cell,l.cell&&l.cell.verticalMerging!==Xe.Continue&&this.applyBorderToCell(o,i,l,r,a,e.value?null:n.clone())}return this.history.endTransaction(),!0}isCheckedInParticallyTableSelection(e,t,r,i){let n=!1;for(let o,a=0;o=t[a];a++)for(let s,l=0;s=o[l];l++)if(s.cell&&s.cell.verticalMerging!==Xe.Continue&&s.info!==gZ.None&&s.info&this.affectOnStateFlags&&(n=!0,!this.checkBorderInParticallyTableSelection(i,e,t,s,a,l,r)))return!1;return n}createCellBorderGrid(e,t,r){let i=this.createCellBorderGridCore(e,t),n=i.length,o=i[0].length;for(let t,a=0;t=e.rows[a];a++){let e=t.gridBefore,s=a+1===n,l=r.cellSpacings[a]>0;for(let r,d=0;r=t.cells[d];d++){let t=e+r.columnSpan===o,d=i[a][e];if(r.verticalMerging===Xe.Continue){if(s&&i[a-1][e].info&gZ.BottomOuter){let t=a;do{t--,i[t][e].info|=gZ.BottomTableOuter}while(i[t][e].cell.verticalMerging!==Xe.Restart)}d.info=i[a-1][e].info}else d.selected?(this.affectInner&&(f0.checkVSiblingSelected(r.columnSpan,a-1,e,i)&&(d.info|=gZ.TopInner),!s&&this.checkBottomSibling(i,a,e,f0.checkVSiblingSelected)&&(d.info|=gZ.BottomInner),this.checkLeftRightSiblingSelected(r,a,e,e-1,gZ.LeftInner,i)&&(d.info|=gZ.LeftInner),!t&&this.checkLeftRightSiblingSelected(r,a,e,e+r.columnSpan,gZ.RightInner,i)&&(d.info|=gZ.RightInner)),this.affectOuter&&(f0.checkVSiblingUnselected(r.columnSpan,a-1,e,i)&&(d.info|=gZ.TopOuter),(s||this.checkBottomSibling(i,a,e,f0.checkVSiblingUnselected))&&(d.info|=gZ.BottomOuter),this.checkLeftRightSiblingSelected(r,a,e,e-1,gZ.LeftInner,i)||(d.info|=gZ.LeftOuter),!t&&this.checkLeftRightSiblingSelected(r,a,e,e+r.columnSpan,gZ.RightInner,i)||(d.info|=gZ.RightOuter),0===e&&(d.info|=gZ.LeftTableOuter),e+r.columnSpan===o&&(d.info|=gZ.RightTableOuter),0===a&&(d.info|=gZ.TopTableOuter),a===n-1&&(d.info|=gZ.BottomTableOuter))):!l&&this.affectNeighbours&&(!s&&this.checkBottomSibling(i,a,e,f0.checkVSiblingSelected)&&(d.info|=gZ.TopNeighbour),this.checkLeftRightSiblingSelected(r,a,e,e-1,gZ.RightNeighbour,i)&&(d.info|=gZ.RightNeighbour),f0.checkVSiblingSelected(r.columnSpan,a-1,e,i)&&(d.info|=gZ.BottomNeighbour),!t&&this.checkLeftRightSiblingSelected(r,a,e,e+r.columnSpan,gZ.LeftNeighbour,i)&&(d.info|=gZ.LeftNeighbour));e+=r.columnSpan}}return i}createCellBorderGridCore(e,t){let r=[],i=0,n=-1;for(let o,a=0;o=e.rows[a];a++){const e=t.extendedData.rows[i];e&&e.row===o?(i++,n=0):n=-1,r.push([]);for(let e=0;e<o.gridBefore;e++)r[a].push({cell:null,info:gZ.None,selected:!1});let s=o.gridBefore;for(let t,i=0;t=o.cells[i];i++){let i={cell:t,info:gZ.None,selected:!1};t.verticalMerging===Xe.Continue&&r[a-1][s].selected&&r[a-1][s].selected&&(i.selected=!0),n>-1&&e.cells[n]&&e.cells[n].cell===t&&(i.selected=!0,n++);for(let e=0;e<t.columnSpan;e++)r[a].push(i);s+=t.columnSpan}for(let e=0;e<o.gridAfter;e++)r[a].push({cell:null,info:gZ.None,selected:!1})}return r}checkBottomSibling(e,t,r,i){let n=e[t][r];if(n.cell.verticalMerging===Xe.Restart)for(;e[t]&&e[++t]&&e[t][r].cell.verticalMerging===Xe.Continue;);else t++;return i(n.cell.columnSpan,t,r,e)}static checkVSiblingSelected(e,t,r,i){if(t<0)return!1;if(!i[t])return!1;for(let n=0;n<e;n++)if(!i[t][r+n].selected)return!1;return!0}static checkVSiblingUnselected(e,t,r,i){if(t<0)return!0;if(!i[t])return!0;for(let n=0;n<e;n++)if(i[t][r+n].selected)return!1;return!0}checkLeftRightSiblingSelected(e,t,r,i,n,o){if(i<0)return!1;if(!o[t][i].selected)return!1;if(e.verticalMerging===Xe.Restart){for(;o[++t]&&o[t][r].cell&&o[t][r].cell.verticalMerging===Xe.Continue;)if(!o[t][i].selected)return!1}else if(e.verticalMerging===Xe.Continue)for(;t>0;)if(o[--t][r].cell.verticalMerging===Xe.Restart){if(!(o[t][r].info&n))return!1;break}return!0}getActualLeftBorder(e,t,r,i){const n=new Qa(t,r,i).init();return Dz.getLeftBorder(this.colorProvider,n,n.row.cells[n.cellIndex-1],e,(e=>e))}getActualRightBorder(e,t,r,i){const n=new Qa(t,r,i).init();return Dz.getRightBorder(this.colorProvider,n,n.row.cells[n.cellIndex+1],e,(e=>e))}getActualTopBorder(e,t,r,i,n,o){var a=r.cellSpacings[n];let s=n>0?e[n-1][o]:null;return a>0?Dz.mergeThreeBorders(this.colorProvider,t.cell,Kr,null,null,!s,r.horizontalBorder,i.style,(e=>e)):t.info&gZ.TopTableOuter?Dz.mergeThreeBorders(this.colorProvider,t.cell,Kr,null,null,!0,r.topBorder,i.style,(e=>e)):Dz.mergeThreeBorders(this.colorProvider,t.cell,Kr,s.cell,qr,!1,r.horizontalBorder,i.style,(e=>e))}getActualBottomBorder(e,t,r,i,n,o){var a=r.cellSpacings[n];let s=n+1<e.length?e[n+1][o]:null;return a>0?Dz.mergeThreeBorders(this.colorProvider,t.cell,qr,null,null,!s,r.horizontalBorder,i.style,(e=>e)):t.info&gZ.BottomTableOuter?Dz.mergeThreeBorders(this.colorProvider,t.cell,qr,null,null,!0,r.bottomBorder,i.style,(e=>e)):Dz.mergeThreeBorders(this.colorProvider,t.cell,qr,s.cell,Kr,!1,r.horizontalBorder,i.style,(e=>e))}}class b0 extends f0{getGeneralizedBorder(){let e=null,t=this.selection.tableInfo,r=t.table,i=new Ez(this.control.modelManager.model,r,(e=>e)),n=this.createCellBorderGrid(r,t,i);for(let t,o=0;t=n[o];o++)for(let a,s=0;a=t[s];s++)if(a.cell&&a.cell.verticalMerging!==Xe.Continue&&a.info!==gZ.None&&a.info&this.affectOnStateFlags)if(e){if(!e.equals(this.getActualCellBorder(r,n,a,o,s,i)))return null}else e=this.getActualCellBorder(r,n,a,o,s,i);return e}}class C0 extends b0{constructor(){super(...arguments),this.affectOnStateFlags=gZ.TopOuter,this.affectInner=!1}getActualCellBorder(e,t,r,i,n,o){return this.getActualTopBorder(t,r,o,e,i,n)}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return e.equals(this.getActualCellBorder(t,r,i,n,o,a))}checkBorderInEntireTable(e,t){return e.equals((new Tr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r?r=r.clone():(r=t.properties.borders.top.clone()).width=0,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[r,void 0,void 0,void 0,void 0,void 0],[!0,void 0,void 0,void 0,void 0,void 0]))}applyBorderToCell(e,t,r,i,n,o){r.info&gZ.TopOuter&&(o||((o=r.cell.properties.borders.top.clone()).width=0),this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[o,void 0,void 0,void 0,void 0,void 0],[!0,void 0,void 0,void 0,void 0,void 0]))),r.info&gZ.TopNeighbour&&(o||((o=r.cell.properties.borders.bottom.clone()).width=0),this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[void 0,void 0,o,void 0,void 0,void 0],[void 0,void 0,!0,void 0,void 0,void 0])))}}class S0 extends b0{constructor(){super(...arguments),this.affectInner=!1,this.affectOnStateFlags=gZ.RightOuter}getActualCellBorder(e,t,r,i,n,o){return this.getActualRightBorder(o,e,i,n)}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return e.equals(this.getActualCellBorder(t,r,i,n,o,a))}checkBorderInEntireTable(e,t){return e.equals((new xr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r?r=r.clone():(r=t.properties.borders.right.clone()).width=0,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[void 0,r,void 0,void 0,void 0,void 0],[void 0,!0,void 0,void 0,void 0,void 0]))}applyBorderToCell(e,t,r,i,n,o){r.info&gZ.RightOuter&&(o||((o=r.cell.properties.borders.right.clone()).width=0),this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[void 0,o,void 0,void 0,void 0,void 0],[void 0,!0,void 0,void 0,void 0,void 0]))),r.info&gZ.RightNeighbour&&(o||((o=r.cell.properties.borders.left.clone()).width=0),this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[void 0,void 0,void 0,o,void 0,void 0],[void 0,void 0,void 0,!0,void 0,void 0])))}}class I0 extends b0{constructor(){super(...arguments),this.affectInner=!1,this.affectOnStateFlags=gZ.BottomOuter}getActualCellBorder(e,t,r,i,n,o){return this.getActualBottomBorder(t,r,o,e,i,n)}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return e.equals(this.getActualCellBorder(t,r,i,n,o,a))}checkBorderInEntireTable(e,t){return e.equals((new vr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r?r=r.clone():(r=t.properties.borders.bottom.clone()).width=0,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[void 0,void 0,r,void 0,void 0,void 0],[void 0,void 0,!0,void 0,void 0,void 0]))}applyBorderToCell(e,t,r,i,n,o){r.info&gZ.BottomOuter&&(o||((o=r.cell.properties.borders.bottom.clone()).width=0),this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[void 0,void 0,o,void 0,void 0,void 0],[void 0,void 0,!0,void 0,void 0,void 0]))),r.info&gZ.BottomNeighbour&&(o||((o=r.cell.properties.borders.top.clone()).width=0),this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[o,void 0,void 0,void 0,void 0,void 0],[!0,void 0,void 0,void 0,void 0,void 0])))}}class P0 extends b0{constructor(){super(...arguments),this.affectInner=!1,this.affectOnStateFlags=gZ.LeftOuter}getActualCellBorder(e,t,r,i,n,o){return this.getActualLeftBorder(o,e,i,n)}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return e.equals(this.getActualCellBorder(t,r,i,n,o,a))}checkBorderInEntireTable(e,t){return e.equals((new yr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r?r=r.clone():(r=t.properties.borders.left.clone()).width=0,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[void 0,void 0,void 0,r,void 0,void 0],[void 0,void 0,void 0,!0,void 0,void 0]))}applyBorderToCell(e,t,r,i,n,o){r.info&gZ.LeftOuter&&(o||((o=r.cell.properties.borders.left.clone()).width=0),this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[void 0,void 0,void 0,o,void 0,void 0],[void 0,void 0,void 0,!0,void 0,void 0]))),r.info&gZ.LeftNeighbour&&(o||((o=r.cell.properties.borders.right.clone()).width=0),this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[void 0,o,void 0,void 0,void 0,void 0],[void 0,!0,void 0,void 0,void 0,void 0])))}}class w0 extends f0{constructor(){super(...arguments),this.affectOnStateFlags=gZ.BottomInner|gZ.BottomOuter|gZ.LeftInner|gZ.LeftOuter|gZ.RightInner|gZ.RightOuter|gZ.TopInner|gZ.TopOuter}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return e.equals(this.getActualTopBorder(r,i,a,t,n,o))&&e.equals(this.getActualBottomBorder(r,i,a,t,n,o))&&e.equals(this.getActualLeftBorder(a,t,n,o))&&e.equals(this.getActualRightBorder(a,t,n,o))}checkBorderInEntireTable(e,t){return e.equals((new Tr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new xr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new vr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new yr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new Er).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new Mr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r=r||new Me,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[r.clone(),r.clone(),r.clone(),r.clone(),r.clone(),r.clone()],[!0,!0,!0,!0,!0,!0]))}applyBorderToCell(e,t,r,i,n,o){let a,s,l,d;(r.info&gZ.TopOuter||r.info&gZ.TopInner||r.info&gZ.BottomNeighbour)&&(a=!0),(r.info&gZ.RightOuter||r.info&gZ.RightInner||r.info&gZ.LeftNeighbour)&&(s=!0),(r.info&gZ.BottomOuter||r.info&gZ.BottomInner||r.info&gZ.TopNeighbour)&&(l=!0),(r.info&gZ.LeftOuter||r.info&gZ.LeftInner||r.info&gZ.RightNeighbour)&&(d=!0),o=o||new Me,(a||s||l||d)&&this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[a?o.clone():void 0,s?o.clone():void 0,l?o.clone():void 0,d?o.clone():void 0,void 0,void 0],[a,s,l,d,void 0,void 0]))}}class y0 extends w0{isChecked(e){return!1}applyBorderToTable(e,t,r){super.applyBorderToTable(e,t,new Me)}applyBorderToCell(e,t,r,i,n,o){super.applyBorderToCell(e,t,r,i,n,new Me)}}class x0 extends f0{constructor(){super(...arguments),this.affectOuter=!1,this.affectNeighbours=!1,this.affectOnStateFlags=gZ.BottomInner|gZ.LeftInner|gZ.RightInner|gZ.TopInner}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return i.info&gZ.TopInner?e.equals(this.getActualTopBorder(r,i,a,t,n,o)):i.info&gZ.RightInner?e.equals(this.getActualRightBorder(a,t,n,o)):i.info&gZ.BottomInner?e.equals(this.getActualBottomBorder(r,i,a,t,n,o)):i.info&gZ.LeftInner?e.equals(this.getActualLeftBorder(a,t,n,o)):void 0}checkBorderInEntireTable(e,t){return e.equals((new Er).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new Mr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r=r||new Me,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[void 0,void 0,void 0,void 0,r.clone(),r.clone()],[void 0,void 0,void 0,void 0,!0,!0]))}applyBorderToCell(e,t,r,i,n,o){let a,s,l,d;r.info&gZ.TopInner&&(a=!0),r.info&gZ.RightInner&&(s=!0),r.info&gZ.BottomInner&&(l=!0),r.info&gZ.LeftInner&&(d=!0),o=o||new Me,(a||s||l||d)&&this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[a?o.clone():void 0,s?o.clone():void 0,l?o.clone():void 0,d?o.clone():void 0,void 0,void 0],[a,s,l,d,void 0,void 0]))}}class T0 extends b0{constructor(){super(...arguments),this.affectOuter=!1,this.affectNeighbours=!1,this.affectOnStateFlags=gZ.BottomInner|gZ.TopInner}getActualCellBorder(e,t,r,i,n,o){let a,s;return r.info&gZ.TopInner&&(a=this.getActualTopBorder(t,r,o,e,i,n)),r.info&gZ.BottomInner&&(s=this.getActualBottomBorder(t,r,o,e,i,n)),a&&s?a.equals(s)?a:null:a||s}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return e.equals(this.getActualCellBorder(t,r,i,n,o,a))}checkBorderInEntireTable(e,t){return e.equals((new Er).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r=r||new Me,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[void 0,void 0,void 0,void 0,r.clone(),void 0],[void 0,void 0,void 0,void 0,!0,void 0]))}applyBorderToCell(e,t,r,i,n,o){let a,s;r.info&gZ.TopInner&&(a=!0),r.info&gZ.BottomInner&&(s=!0),o=o||new Me,(a||s)&&this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[a?o.clone():void 0,void 0,s?o.clone():void 0,void 0,void 0,void 0],[a,void 0,s,void 0,void 0,void 0]))}}class v0 extends b0{constructor(){super(...arguments),this.affectOuter=!1,this.affectNeighbours=!1,this.affectOnStateFlags=gZ.LeftInner|gZ.RightInner}getActualCellBorder(e,t,r,i,n,o){let a,s;return r.info&gZ.LeftInner&&(a=this.getActualLeftBorder(o,e,i,n)),r.info&gZ.RightInner&&(s=this.getActualRightBorder(o,e,i,n)),a&&s?a.equals(s)?a:null:a||s}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return e.equals(this.getActualCellBorder(t,r,i,n,o,a))}checkBorderInEntireTable(e,t){return e.equals((new Mr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r=r||new Me,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[void 0,void 0,void 0,void 0,void 0,r.clone()],[void 0,void 0,void 0,void 0,void 0,!0]))}applyBorderToCell(e,t,r,i,n,o){let a,s;r.info&gZ.LeftInner&&(a=!0),r.info&gZ.RightInner&&(s=!0),o=o||new Me,(s||a)&&this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[void 0,s?o.clone():void 0,void 0,a?o.clone():void 0,void 0,void 0],[void 0,s,void 0,a,void 0,void 0]))}}class M0 extends f0{constructor(){super(...arguments),this.affectInner=!1,this.affectOnStateFlags=gZ.LeftOuter|gZ.RightOuter|gZ.TopOuter|gZ.BottomOuter}checkBorderInParticallyTableSelection(e,t,r,i,n,o,a){return!(i.info&gZ.TopOuter&&!e.equals(this.getActualTopBorder(r,i,a,t,n,o)))&&(!(i.info&gZ.RightOuter&&!e.equals(this.getActualRightBorder(a,t,n,o)))&&(!(i.info&gZ.BottomOuter&&!e.equals(this.getActualBottomBorder(r,i,a,t,n,o)))&&!(i.info&gZ.LeftOuter&&!e.equals(this.getActualLeftBorder(a,t,n,o)))))}checkBorderInEntireTable(e,t){return e.equals((new Tr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new xr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new vr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))&&e.equals((new yr).getProperty(t.properties,t.style,qe.WholeTable,this.control.modelManager.model.defaultTableProperties))}applyBorderToTable(e,t,r){r=r||new Me,this.history.addAndRedo(new Ym(this.modelManipulator,e,t.index,[r.clone(),r.clone(),r.clone(),r.clone(),void 0,void 0],[!0,!0,!0,!0,void 0,void 0]))}applyBorderToCell(e,t,r,i,n,o){let a,s,l,d;(r.info&gZ.TopOuter||r.info&gZ.BottomNeighbour)&&(a=!0),(r.info&gZ.RightOuter||r.info&gZ.LeftNeighbour)&&(s=!0),(r.info&gZ.BottomOuter||r.info&gZ.TopNeighbour)&&(l=!0),(r.info&gZ.LeftOuter||r.info&gZ.RightNeighbour)&&(d=!0),o=o||new Me,(a||s||l||d)&&this.history.addAndRedo(new ec(this.modelManipulator,e,t.index,i,n,[a?o.clone():void 0,s?o.clone():void 0,l?o.clone():void 0,d?o.clone():void 0,void 0,void 0],[a,s,l,d,void 0,void 0]))}}!function(e){e[e.None=0]="None",e[e.LeftOuter=1]="LeftOuter",e[e.RightOuter=2]="RightOuter",e[e.BottomOuter=4]="BottomOuter",e[e.TopOuter=8]="TopOuter",e[e.RightNeighbour=16]="RightNeighbour",e[e.TopNeighbour=32]="TopNeighbour",e[e.LeftNeighbour=64]="LeftNeighbour",e[e.BottomNeighbour=128]="BottomNeighbour",e[e.RightInner=256]="RightInner",e[e.TopInner=512]="TopInner",e[e.LeftInner=1024]="LeftInner",e[e.BottomInner=2048]="BottomInner",e[e.LeftTableOuter=4096]="LeftTableOuter",e[e.RightTableOuter=8192]="RightTableOuter",e[e.TopTableOuter=16384]="TopTableOuter",e[e.BottomTableOuter=32768]="BottomTableOuter",e[e.All=-1]="All"}(gZ||(gZ={}));class E0 extends XZ{getState(){const e=this.selection.tableInfo.extendedData.numRows>0;let t=new UU(this.isEnabled()&&e);return t.visible=e,t}makeParams(e,t){let r,i=new R0,n=this.selection,o=n.tableInfo,a=o.extendedData.firstCell.parentRow.parentTable;return i.applyToWholeTable=e,("boolean"!=typeof i.applyToWholeTable&&this.isNoFullSelectedCell(n)||!0===i.applyToWholeTable)&&(r=n.getFloatingState(),n.deprecatedSetSelection(a.getStartPosition(),a.getEndPosition(),n.endOfLine,-1,!0),o=n.tableInfo),this.topBorderCommand=new C0(this.control),this.rightBorderCommand=new S0(this.control),this.bottomBorderCommand=new I0(this.control),this.leftBorderCommand=new P0(this.control),this.insideHorizontalBordersCommand=new T0(this.control),this.insideVerticalBordersCommand=new v0(this.control),i.top=L0.create(this.topBorderCommand.getGeneralizedBorder(),t),i.right=L0.create(this.rightBorderCommand.getGeneralizedBorder(),t),i.bottom=L0.create(this.bottomBorderCommand.getGeneralizedBorder(),t),i.left=L0.create(this.leftBorderCommand.getGeneralizedBorder(),t),i.insideHorizontal=L0.create(this.insideHorizontalBordersCommand.getGeneralizedBorder(),t),i.insideVertical=L0.create(this.insideVerticalBordersCommand.getGeneralizedBorder(),t),i.init(this.colorProvider,o,this.modelManipulator.model),r&&this.selection.restoreFloatingState(r),i}applyParameters(e,t,r){let i,n=this.selection,o=n.tableInfo,a=o.extendedData.firstCell.parentRow.parentTable;("boolean"!=typeof t.applyToWholeTable&&this.isNoFullSelectedCell(n)||!0===t.applyToWholeTable)&&(i=n.getFloatingState(),n.deprecatedSetSelection(a.getStartPosition(),a.getEndPosition(),n.endOfLine,-1,!0),o=n.tableInfo);let s=this.history;s.beginTransaction();let l=!1;return t.backgroundColor!==r.backgroundColor&&(this.control.commandManager.getCommand(FF.ChangeTableCellShading).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,this.control.commandManager.getCommand(FF.ChangeTableCellShading).DEPRECATEDConvertOptionsParameter(t.backgroundColor))),l=!0),t.top&&!t.top.equals(r.top)&&(this.topBorderCommand.execute(this.control.commandManager.isPublicApiCall,t.top.getBorderInfo()),l=!0),t.bottom&&!t.bottom.equals(r.bottom)&&(this.bottomBorderCommand.execute(this.control.commandManager.isPublicApiCall,t.bottom.getBorderInfo()),l=!0),t.right&&!t.right.equals(r.right)&&(this.rightBorderCommand.execute(this.control.commandManager.isPublicApiCall,t.right.getBorderInfo()),l=!0),t.left&&!t.left.equals(r.left)&&(this.leftBorderCommand.execute(this.control.commandManager.isPublicApiCall,t.left.getBorderInfo()),l=!0),t.insideHorizontal&&!t.insideHorizontal.equals(r.insideHorizontal)&&(this.insideHorizontalBordersCommand.execute(this.control.commandManager.isPublicApiCall,t.insideHorizontal.getBorderInfo()),l=!0),t.insideVertical&&!t.insideVertical.equals(r.insideVertical)&&(this.insideVerticalBordersCommand.execute(this.control.commandManager.isPublicApiCall,t.insideVertical.getBorderInfo()),l=!0),s.endTransaction(),i&&this.selection.restoreFloatingState(i),l||!!i}isNoFullSelectedCell(e){let t=e.tableInfo;if(t.extendedData.numRows>1||t.extendedData.rows[0].cells.length>1)return!1;const r=t.extendedData.firstCell;return e.intervals[0].start!==r.startParagraphPosition.value||e.intervals[0].end!==r.endParagrapPosition.value}getDialogName(){return"BorderShading"}}class D0 extends E0{createParameters(e){return this.makeParams(e.param,this.control.modelManager.model.colorProvider)}}class F0 extends E0{createParameters(e){return this.makeParams(null,this.control.modelManager.model.colorProvider)}afterClosing(e){this.control.commandManager.getCommand(FF.ShowTablePropertiesForm).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,e.param))}}class R0 extends GZ{constructor(){super(...arguments),this.borderLineHorizontalInVisible=!1,this.borderLineVerticalInVisible=!1}init(e,t,r){let i=t.extendedData.firstCell,n=t.table,o=new Qr,a=o.getProperty(i.properties,n.style,i.conditionalFormatting,r.defaultTableCellProperties).getActualColor(e);this.backgroundColor=this.getColor(t.extendedData.allOfCells((t=>{const i=o.getProperty(t.cell.properties,n.style,t.cell.conditionalFormatting,r.defaultTableCellProperties);return a==(i?i.getActualColor(e):null)}))?a:null),this.borderLineHorizontalInVisible=t.extendedData.numRows>1,this.borderLineVerticalInVisible=f.ListUtils.unsafeAnyOf(t.extendedData.rows,(e=>e.cells.length>1)),this.setModeButton=this.getModeState()}getModeState(){return this.isModeStateNone()?mZ.None:this.isModeStateAll()?mZ.All:this.isModeStateBox()?mZ.Box:this.isModeStateGrid()?mZ.Grid:mZ.Custom}isModeStateNone(){let e=[this.top,this.right,this.bottom,this.left,this.insideVertical,this.insideHorizontal];for(let t=0;t<e.length;t++)if(null!=e[t]&&e[t].style!==de.None&&0!==e[t].width)return!1;return!0}isModeStateAll(){let e=[this.top,this.right,this.bottom,this.left];if(e.push(this.insideVertical),e.push(this.insideHorizontal),null==e[0]||e[0].style===de.None||0===e[0].width)return!1;if(!this.borderLineHorizontalInVisible&&!this.borderLineVerticalInVisible)return!1;for(let t=1;t<e.length;t++)if(null==e[t]||!e[0].equals(e[t]))return!1;return!0}isModeStateBox(){let e=[this.top,this.right,this.bottom,this.left],t=[this.insideVertical,this.insideHorizontal];if(null==e[0]||e[0].style===de.None||0===e[0].width)return!1;for(let t=1;t<e.length;t++)if(null==e[t]||!e[0].equals(e[t]))return!1;if(!this.borderLineHorizontalInVisible&&!this.borderLineVerticalInVisible)return!0;for(let e=0;e<t.length;e++)if(null==t[e]||t[e].style!==de.None&&0!==t[e].width)return!1;return!0}isModeStateGrid(){let e=[this.top,this.right,this.bottom,this.left],t=[this.insideVertical,this.insideHorizontal];if(null==e[0]||e[0].style===de.None||0===e[0].width)return!1;if(!this.borderLineHorizontalInVisible&&!this.borderLineVerticalInVisible)return!1;for(let t=1;t<e.length;t++)if(null==e[t]||!e[0].equals(e[t]))return!1;for(let r=0;r<t.length;r++)if(null==t[r]||t[r].style!==de.Single||t[r].color!==e[0].color||t[r].width!==R0.gridWidth)return!1;return!0}getColor(e){return e==y.AUTOMATIC_COLOR?"Auto":null!=e?w.i.colorToHash(e).toUpperCase():void 0}copyFrom(e){super.copyFrom(e),this.backgroundColor=e.backgroundColor,this.top=null!==e.top?e.top.clone():null,this.right=null!==e.right?e.right.clone():null,this.bottom=null!==e.bottom?e.bottom.clone():null,this.left=null!==e.left?e.left.clone():null,this.insideHorizontal=null!==e.insideHorizontal?e.insideHorizontal.clone():null,this.insideVertical=null!==e.insideVertical?e.insideVertical.clone():null,this.applyToWholeTable=e.applyToWholeTable}clone(){const e=new R0;return e.copyFrom(this),e}applyConverter(e){return this}}R0.gridWidth=g.u.twipsToPointsF(15);class L0{static create(e,t){if(!e)return null;var r=new L0;return r.color=w.i.colorToHash(e.color.toRgb(t)).toUpperCase(),r.width=g.u.twipsToPointsF(e.width),r.style=e.style,r}getBorderInfo(){const e=new Me;return e.color=null===this.color?he.noColor:he.makeByColor(w.i.fromHashString(this.color)),e.width=g.u.pointsToTwips(this.width),e.style=this.style,e}equals(e){return e&&this.style==e.style&&this.color==e.color&&this.width==e.width}copyFrom(e){this.style=e.style,this.color=e.color,this.width=e.width}clone(){var e=new L0;return e.copyFrom(this),e}}!function(e){e[e.None=0]="None",e[e.Box=1]="Box",e[e.All=2]="All",e[e.Grid=3]="Grid",e[e.Custom=4]="Custom"}(mZ||(mZ={}));class B0 extends EU{DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.intervals=B0.getIntervals(this.control,e.subDocument)}getState(e=this.convertToCommandOptions(null)){return this.getStateCore(this.isEnabled(e),e.intervalsInfo.intervals,this.getStateValue(e))}getStateCore(e,t,r){return new VU(e,t,r)}isEnabled(e){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.sections)&&(!this.control.modelManager.model.isDocumentProtectionEnabled||B0.rangePermissionIncludeFullSection(this.control,e.subDocument,e.intervalsInfo.intervals))}getAffectedSectionsIterator(e){const t=this.control.modelManager.model.sections;return nn.IntervalAlgorithms.getAffectedObjects(t,e,void 0,((e,t,r)=>0==t&&e.contains(r))).getObjectsIterator(t)}static rangePermissionIncludeFullSection(e,t,r){if(t.isMain()){const t=[],i=f.ListUtils.map(r,(e=>{const t=e.clone();return t.length||t.length++,t}));return f.ListUtils.forEach(i,(r=>{f.ListUtils.forEach(e.modelManager.model.sections,((e,i)=>{nn.IntervalAlgorithms.getIntersectionNonNullLength(e.interval,r)&&t.push(i)}))})),e.modelManager.model.mainSubDocument.isEditable(f.ListUtils.map(f.ListUtils.uniqueNumber(t),(t=>e.modelManager.model.sections[t].interval)))}if(t.isHeaderFooter()){const t=e.modelManager.model.mainSubDocument.getSectionByPosition(e.layoutFormatterManager.forceFormatPage(e.selection.pageIndex).getPosition());return e.modelManager.model.mainSubDocument.isEditable([t.interval])}if(t.isTextBox()){const t=e.selection;return B0.rangePermissionIncludeFullSection(e,t.specialRunInfo.getParentSubDocument(),[new on.FixedInterval(t.specialRunInfo.getPosition(),1)])}}static getIntervals(e,t){if(t.isMain()||t.isTextBox())return f.ListUtils.deepCopy(e.selection.intervalsInfo.intervals);if(t.isHeaderFooter()){let t=e.layoutFormatterManager.forceFormatPage(e.selection.pageIndex),r=Ch.getPageSectionIndex(t,e.modelManager.model.sections),i=e.modelManager.model.sections[r];return[new on.FixedInterval(i.startLogPosition.value,i.getLength())]}throw new Error("Unknown subDocument type")}}class A0 extends Ze{constructor(e,t){super(e),this.newDefaultTabWidth=t}redo(){this.oldDefaultTabWidth=this.modelManipulator.documentProperties.setDefaultTabWidth(this.modelManipulator.model,this.newDefaultTabWidth)}undo(){this.modelManipulator.documentProperties.setDefaultTabWidth(this.modelManipulator.model,this.oldDefaultTabWidth)}}class N0 extends Ze{constructor(e,t){super(e),this.newPageColor=t}redo(){this.oldPageColor=this.modelManipulator.documentProperties.changePageColor(this.modelManipulator.model,this.newPageColor)}undo(){this.modelManipulator.documentProperties.changePageColor(this.modelManipulator.model,this.oldPageColor)}}class k0 extends Ze{constructor(e,t){super(e),this.newValue=t}redo(){this.oldValue=this.modelManipulator.documentProperties.changeDifferentOddAndEvenPages(this.modelManipulator.model,this.newValue)}undo(){this.modelManipulator.documentProperties.changeDifferentOddAndEvenPages(this.modelManipulator.model,this.oldValue)}}class O0 extends XZ{getRelatedCommands(){return{[FF.SetLandscapePageOrientation]:!0,[FF.SetPortraitPageOrientation]:!0}}getState(e=this.convertToCommandOptions(void 0)){return new VU(this.isEnabled(),B0.getIntervals(this.control,e.subDocument))}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.sections)&&B0.rangePermissionIncludeFullSection(this.control,this.selection.activeSubDocument,this.selection.intervals)}createParameters(e){var t=new U0;return t.init(this.inputPosition.getMergedSectionPropertiesRaw(),this.getInitialTab(),this.control.modelManager.model.differentOddAndEvenPages),t}applyParameters(e,t,r){var i=this.getInterval(t.applyTo),n=this.getInitInterval().equals(i),o=this.modelManipulator,a=this.history;this.inputPosition.resetSectionMergedProperties(),a.beginTransaction();let s=!1;if(void 0===t.marginBottom||t.marginBottom===r.marginBottom&&n||(a.addAndRedo(new pI(o,i,t.marginBottom)),s=!0),void 0===t.marginLeft||t.marginLeft===r.marginLeft&&n||(a.addAndRedo(new cI(o,i,t.marginLeft)),s=!0),void 0===t.marginRight||t.marginRight===r.marginRight&&n||(a.addAndRedo(new uI(o,i,t.marginRight)),s=!0),void 0===t.marginTop||t.marginTop===r.marginTop&&n||(a.addAndRedo(new hI(o,i,t.marginTop)),s=!0),void 0!==t.pageWidth&&void 0!==t.pageHeight&&(t.pageWidth!==r.pageWidth||t.pageHeight!==r.pageHeight||!n)){for(var l,d=this.control.modelManager.model.getSectionsByInterval(i),c=0;l=d[c];c++){var h=new on.FixedInterval(l.startLogPosition.value,l.getLength()-1);l.sectionProperties.landscape!==t.pageWidth>t.pageHeight&&a.addAndRedo(new PI(o,h,t.pageWidth>t.pageHeight)),a.addAndRedo(new CI(o,h,t.pageWidth)),a.addAndRedo(new SI(o,h,t.pageHeight))}s=!0}return void 0!==t.paperKind&&t.paperKind!==r.paperKind&&(a.addAndRedo(new TI(o,i,t.paperKind)),s=!0),void 0!==t.startType&&t.startType!==r.startType&&(a.addAndRedo(new II(o,i,t.startType)),s=!0),void 0===t.headerDifferentFirstPage||t.headerDifferentFirstPage===r.headerDifferentFirstPage&&n||(a.addAndRedo(new wI(o,i,t.headerDifferentFirstPage)),s=!0),void 0===t.headerDifferentOddAndEven||t.headerDifferentOddAndEven===r.headerDifferentOddAndEven&&n||(a.addAndRedo(new k0(o,t.headerDifferentOddAndEven)),s=!0),void 0===t.headerOffset||t.headerOffset===r.headerOffset&&n||(a.addAndRedo(new yI(o,i,t.headerOffset)),s=!0),void 0===t.footerOffset||t.footerOffset===r.footerOffset&&n||(a.addAndRedo(new xI(o,i,t.footerOffset)),s=!0),a.endTransaction(),s}getInterval(e){if(e==fZ.WholeDocument)return new on.FixedInterval(0,this.control.modelManager.model.mainSubDocument.getDocumentEndPosition()-1);if(this.selection.activeSubDocument.isMain()){let i=this.control.modelManager.model.getSectionIndicesByIntervals(this.selection.intervals);var t=this.control.modelManager.model.sections[i[0]];if(e==fZ.SelectedSections){var r=this.control.modelManager.model.sections[i[i.length-1]];return on.FixedInterval.fromPositions(t.startLogPosition.value,r.startLogPosition.value+r.getLength()-1)}return e==fZ.ThisPointForward?on.FixedInterval.fromPositions(t.startLogPosition.value,this.control.modelManager.model.mainSubDocument.getDocumentEndPosition()-1):new on.FixedInterval(t.startLogPosition.value,t.getLength()-1)}if(this.selection.activeSubDocument.isHeaderFooter()){var i=this.control.layout.pages[this.selection.pageIndex];if(i){var n=i.getPosition(),o=this.control.modelManager.model.getSectionByPosition(n);if(e===fZ.CurrentSection||e==fZ.SelectedSections)return new on.FixedInterval(o.startLogPosition.value,o.getLength());if(e===fZ.ThisPointForward)return on.FixedInterval.fromPositions(o.startLogPosition.value,this.control.modelManager.model.mainSubDocument.getDocumentEndPosition()-1)}}}getInitInterval(){if(this.selection.activeSubDocument.isMain()){let e=this.control.modelManager.model.getSectionIndicesByIntervals(this.selection.intervals),t=this.control.modelManager.model.sections[e[0]],r=this.control.modelManager.model.sections[e[e.length-1]];return on.FixedInterval.fromPositions(t.startLogPosition.value,r.startLogPosition.value+r.getLength()-1)}var e=this.control.layout.pages[this.selection.pageIndex],t=this.control.modelManager.model.getSectionByPosition(e.getPosition());return new on.FixedInterval(t.startLogPosition.value,t.getLength())}getInitialTab(){return bZ.Margins}getDialogName(){return"PageSetup"}}class _0 extends O0{getInitialTab(){return bZ.Paper}}class U0 extends GZ{init(e,t,r){this.applyTo=fZ.WholeDocument,this.marginBottom=e.marginBottom,this.marginLeft=e.marginLeft,this.marginRight=e.marginRight,this.marginTop=e.marginTop,this.landscape=e.landscape,this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.startType=e.startType,this.headerDifferentOddAndEven=r,this.headerDifferentFirstPage=e.differentFirstPage,this.headerOffset=e.headerOffset,this.footerOffset=e.footerOffset,this.paperKind=e.paperKind,this.initialTab=t}copyFrom(e){super.copyFrom(e),this.marginBottom=e.marginBottom,this.marginLeft=e.marginLeft,this.marginRight=e.marginRight,this.marginTop=e.marginTop,this.landscape=e.landscape,this.applyTo=e.applyTo,this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.startType=e.startType,this.headerDifferentFirstPage=e.headerDifferentFirstPage,this.headerDifferentOddAndEven=e.headerDifferentOddAndEven,this.headerOffset=e.headerOffset,this.footerOffset=e.footerOffset,this.paperKind=e.paperKind,this.initialTab=e.initialTab}clone(){const e=new U0;return e.copyFrom(this),e}applyConverter(e){return this.marginBottom&&(this.marginBottom=e(this.marginBottom)),this.marginLeft&&(this.marginLeft=e(this.marginLeft)),this.marginRight&&(this.marginRight=e(this.marginRight)),this.marginTop&&(this.marginTop=e(this.marginTop)),this.pageWidth&&(this.pageWidth=e(this.pageWidth)),this.pageHeight&&(this.pageHeight=e(this.pageHeight)),this.headerOffset&&(this.headerOffset=e(this.headerOffset)),this.footerOffset&&(this.footerOffset=e(this.footerOffset)),this}}!function(e){e[e.WholeDocument=0]="WholeDocument",e[e.CurrentSection=1]="CurrentSection",e[e.SelectedSections=2]="SelectedSections",e[e.ThisPointForward=4]="ThisPointForward"}(fZ||(fZ={})),function(e){e[e.Margins=0]="Margins",e[e.Paper=1]="Paper",e[e.Layout=2]="Layout"}(bZ||(bZ={}));class H0 extends XZ{isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.sections)&&this.selection.activeSubDocument.isMain()&&B0.rangePermissionIncludeFullSection(this.control,this.selection.activeSubDocument,this.selection.intervals)}createParameters(e){var t=new W0,r=this.inputPosition.getMergedSectionPropertiesRaw();t.equalColumnWidth=r.equalWidthColumns,null!=r.pageWidth&&null!=r.marginLeft&&null!=r.marginRight?t.pageWidth=r.pageWidth-r.marginLeft-r.marginRight:t.pageWidth=W0.minColumnWidth;var i=null==r.columnCount?0:r.columnCount;t.changeColumnCount(i);for(var n,o=0;n=r.columnsInfo[o];o++)t.columns[o].width=n.width,t.columns[o].spacing=n.space;return(new V0).init(t,this.control.uiUnitConverter)}applyParameters(e,t){var r=this.getInterval(t.columnsInfo.applyType),i=this.modelManipulator,n=t.columnsInfo;this.history.beginTransaction();for(var o,a=[],s=0;o=n.columns[s];s++){var l=new Sh(o.width,o.spacing);a.push(l)}return this.history.addAndRedo(new bI(i,r,a)),this.history.addAndRedo(new gI(i,r,n.columnCount)),this.history.addAndRedo(new fI(i,r,n.equalColumnWidth)),this.history.endTransaction(),!0}getInterval(e){if(e==fZ.WholeDocument)return new on.FixedInterval(0,this.control.modelManager.model.mainSubDocument.getDocumentEndPosition()-1);var t=this.control.modelManager.model.getSectionsByInterval(this.selection.lastSelectedInterval);if(e==fZ.SelectedSections){var r=t[t.length-1];return on.FixedInterval.fromPositions(t[0].startLogPosition.value,r.startLogPosition.value+r.getLength()-1)}return e==fZ.ThisPointForward?on.FixedInterval.fromPositions(t[0].startLogPosition.value,this.control.modelManager.model.mainSubDocument.getDocumentEndPosition()):new on.FixedInterval(t[0].startLogPosition.value,t[0].getLength()-1)}getDialogName(){return"Columns"}}class V0 extends GZ{init(e,t){return this.columnsInfo=e,this.unitConverter=t,this}copyFrom(e){super.copyFrom(e);var t=new W0;t.copyFrom(e.columnsInfo),this.columnsInfo=t,this.unitConverter=e.unitConverter}clone(){const e=new V0;return e.copyFrom(this),e}applyConverter(e){return this}}class W0{constructor(){this.columns=[],this.equalColumnWidth=!1,this.applyType=fZ.WholeDocument}getMaxColumnCount(){return Math.ceil(this.pageWidth/(W0.minColumnWidth+W0.minSpacingWidth))}hasColumnsNull(){if(this.columnCount>this.columns.length)return!0;for(var e=0;e<this.columnCount;e++){if(!this.columns[e].width)return!0;if(!this.columns[e].spacing&&0!=this.columns[e].spacing)return!0}return!1}hasColumnsInfoUINull(){return!this.columnCount||this.hasColumnsNull()}changeColumnCount(e){if(!(e<0)){e=Math.min(e,this.getMaxColumnCount());for(var t=this.columns.length,r=this.hasColumnsInfoUINull(),i=this.columns.length;i<e;i++)this.columns[i]=new z0(i+1);this.columns.splice(e),this.columnCount=e,r?this.calculateEqualColumnsOnChangeCount():!this.equalColumnWidth&&t>0?this.calculateNotEqualColumnsOnChangeCount(t):this.calculateEqualColumnsOnChangeCount()}}calculateEqualColumnsOnChangeCount(){var e;this.columns.length<=0||(e=this.columns[0].spacing&&0!=this.columns[0].spacing?this.columns[0].spacing:W0.minColumnWidth,this.calculateUniformColumnsByColumnSpacing(e))}calculateNotEqualColumnsOnChangeCount(e){if(!(this.columns.length<=0)){1==this.columns.length&&(this.columns[0].width=this.pageWidth);for(var t=Math.min(e,this.columns.length),r=0;r<t;r++)this.columns[r].width=Math.max(W0.minColumnWidth,this.columns[r].width*e/this.columns.length);for(r=0;r<t-1;r++)this.columns[r].spacing=Math.max(W0.minSpacingWidth,this.columns[r].spacing*(e-1)/(this.columns.length-1));if(t>0)for(r=t;r<this.columns.length;r++)this.columns[r].width=this.columns[t-1].width;if(t>1)for(r=t-1;r<this.columns.length-1;r++)this.columns[r].spacing=this.columns[t-2].spacing;this.disableTheLastSpacing(),this.correctColumns()}}correctColumns(){if(this.columnCount&&!(this.columnCount<=0)){var e=-this.calculateAvailableSpace(),t=new X0(this.columns),r=new G0(this.columns),i=t.calculateTotal(0,this.columns.length-1),n=i/(i+r.calculateTotal(0,this.columns.length-1)),o=Math.ceil(e*n),a=e-o;t.distributeSpace(0,this.columns.length-1,o),r.distributeSpace(0,this.columns.length-2,a)}}disableTheLastSpacing(){this.columns[this.columns.length-1].spacing=0}recalculateColumnsByWidthAfterIndex(e){this.hasColumnsInfoUINull()||(this.equalColumnWidth?this.calculateColumnWidthForUniformColumns():this.changeColumnsNotEqualByWidthAfterIndex(e))}recalculateColumnsBySpacingAfterIndex(e){this.hasColumnsInfoUINull()||(this.equalColumnWidth?this.calculateColumnSpacingForUniformColumns():this.changeColumnsNotEqualBySpacingAfterIndex(e))}calculateUniformColumnsCore(e,t,r,i){var n=new X0(this.columns),o=new G0(this.columns);n.setAllValues(e,r),o.setAllValues(t,i),this.disableTheLastSpacing()}calculateColumnWidthForUniformColumns(){var e=this.columns[0].width?this.columns[0].width:W0.minColumnWidth;this.calculateUniformColumnsByColumnWidth(e)}calculateUniformColumnsByColumnWidth(e){if(this.columnCount&&!(this.columnCount<=0)){this.columnCount<=1&&(e=this.pageWidth),e*this.columnCount>this.pageWidth&&(e=this.pageWidth/this.columnCount),e=Math.max(e,W0.minColumnWidth);var t=this.pageWidth-e*this.columnCount,r=Math.max(1,this.columnCount-1),i=t%r,n=t/r;this.calculateUniformColumnsCore(e,n,0,i)}}calculateColumnSpacingForUniformColumns(){if(!this.hasColumnsInfoUINull()){var e=this.columns[0].spacing?this.columns[0].spacing:W0.minSpacingWidth;this.calculateUniformColumnsByColumnSpacing(e)}}calculateUniformColumnsByColumnSpacing(e){if(this.columnCount&&!(this.columnCount<=0)){(e=Math.max(e,W0.minSpacingWidth))*(this.columnCount-1)>this.pageWidth-W0.minColumnWidth*this.columnCount&&(e=Math.ceil((this.pageWidth-W0.minColumnWidth*this.columnCount)/(this.columnCount-1))),1==this.columnCount&&(e=0);var t=Math.ceil(this.pageWidth-e*(this.columnCount-1)),r=Math.ceil(t%this.columnCount),i=Math.ceil(t/this.columnCount);this.calculateUniformColumnsCore(i,e,r,0)}}calculateAvailableSpace(){for(var e=0,t=0;t<this.columnCount;t++)e+=(this.columns[t].width?this.columns[t].width:0)+(this.columns[t].spacing?this.columns[t].spacing:0);return this.pageWidth-e}changeColumnsNotEqualByWidthAfterIndex(e){if(!(!this.columnCount||this.columnCount<=0||e>=this.columnCount)){var t=new X0(this.columns),r=new G0(this.columns);t.correctValue(e);var i=-this.calculateAvailableSpace();i=t.distributeSpace(e+1,this.columnCount-1,i),i=t.distributeSpace(0,e-1,i),i=r.distributeSpace(0,this.columnCount-2,i),this.columns[e].width-=i,this.disableTheLastSpacing()}}changeColumnsNotEqualBySpacingAfterIndex(e){if(!(!this.columnCount||this.columnCount<=0||e>=this.columnCount)){var t=new X0(this.columns),r=new G0(this.columns);r.correctValue(e);var i=-this.calculateAvailableSpace();i=t.distributeSpace(e+1,this.columnCount-1,i),i=t.distributeSpace(0,e,i),i=r.distributeSpace(0,e-1,i),i=r.distributeSpace(e+1,this.columnCount-2,i),this.columns[e].spacing-=i,this.disableTheLastSpacing()}}clone(){var e=new W0;return e.copyFrom(this),e}copyFrom(e){this.applyType=e.applyType,this.equalColumnWidth=e.equalColumnWidth,this.pageWidth=e.pageWidth,this.changeColumnCount(e.columns.length);for(var t=0;t<this.columns.length;t++)this.columns[t].width=e.columns[t].width,this.columns[t].spacing=e.columns[t].spacing}}W0.minColumnWidth=720,W0.minSpacingWidth=0;class z0{constructor(e){this.num=e}}class j0{constructor(e){this.columns=[],this.columns=e}calculateTotal(e,t){for(var r=0,i=e;i<=t;i++)r+=this.getValue(this.columns[i]);return r}hasEnoughSpaceForDistribution(e,t,r){return r<this.calculateTotal(e,t)-this.getMinValue()*(t-e+1)}setMinValues(e,t,r){for(var i=e;i<=t;i++)r-=this.getValue(this.columns[i])-this.getMinValue(),this.setValue(this.columns[i],this.getMinValue());return r}correctValue(e){e>=this.columns.length||this.getValue(this.columns[e])<this.getMinValue()&&this.setValue(this.columns[e],this.getMinValue())}distributeRemainder(e,t,r){for(var i=r>0?1:-1;0!=r;)for(var n=e;n<=t&&0!=r;n++){var o=this.getValue(this.columns[n])-i;o>this.getMinValue()&&(this.setValue(this.columns[n],o),r-=i)}return 0}distributeSpaceCore(e,t,r){for(var i=Math.round(r%(t-e+1)),n=Math.round(r/(t-e+1)),o=e;o<=t;o++){var a=this.getValue(this.columns[o])-n;a>=this.getMinValue()?this.setValue(this.columns[o],a):(this.setValue(this.columns[o],this.getMinValue()),i+=this.getMinValue()-a)}return this.distributeRemainder(e,t,i),0}distributeSpace(e,t,r){return e>t?r:this.hasEnoughSpaceForDistribution(e,t,r)?this.distributeSpaceCore(e,t,r):this.setMinValues(e,t,r)}setAllValues(e,t){for(var r=this.columns.length,i=0;i<r;i++)this.setValue(this.columns[i],e);this.distributeSpace(0,r-1,-t)}getMinValue(){return null}getValue(e){return null}setValue(e,t){}}class X0 extends j0{getMinValue(){return 720}getValue(e){return e.width?e.width:0}setValue(e,t){e.width=t}}class G0 extends j0{getMinValue(){return 0}getValue(e){return e.spacing?e.spacing:0}setValue(e,t){e.spacing=t}}class K0 extends XZ{createParameters(e){return this.listType=e.param.listType,e.param}applyToCustomListLevels(e,t,r){const i=this.modelManipulator,n=this.history;for(let o=0,a=t.length;o<a;o++){const a=t[o],s=e[o];a.displayFormatString!=s.displayFormatString&&n.addAndRedo(new eD(i,!0,r,o,a.displayFormatString)),a.format!=s.format&&n.addAndRedo(new tD(i,!0,r,o,a.format)),a.start!=s.start&&n.addAndRedo(new QE(i,!0,r,o,a.start)),a.alignment!=s.alignment&&n.addAndRedo(new ZE(i,!0,r,o,a.alignment)),a.separator!=s.separator&&n.addAndRedo(new iD(i,!0,r,o,a.separator)),a.leftIndent!=s.leftIndent&&n.addAndRedo(new JE(i,!0,r,o,a.leftIndent,!0)),a.firstLineIndent!=s.firstLineIndent&&n.addAndRedo(new qE(i,!0,r,o,a.firstLineIndent,!0)),a.firstLineIndentType!=s.firstLineIndentType&&n.addAndRedo(new $E(i,!0,r,o,a.firstLineIndentType,!0));const l=this.control.modelManager.model.cache.fontInfoCache.getItemByName(a.fontName);l!=this.control.modelManager.model.cache.fontInfoCache.getItemByName(s.fontName)&&n.addAndRedo(new XE(i,!0,r,o,l,!0)),w.i.fromHashString(a.fontColor)!=w.i.fromHashString(s.fontColor)&&n.addAndRedo(new zE(i,!0,r,o,he.makeByColor(w.i.fromHashString(a.fontColor)),!0)),a.fontSize!=s.fontSize&&n.addAndRedo(new GE(i,!0,r,o,a.fontSize,!0));const d=!!(1&a.fontStyle);d!=!!(1&s.fontStyle)&&n.addAndRedo(new WE(i,!0,r,o,d,!0));const c=!!(2&a.fontStyle);c!=!!(2&s.fontStyle)&&n.addAndRedo(new jE(i,!0,r,o,c,!0))}}applyToListLevels(e,t,r){const i=this.modelManipulator.numberingList,n=this.selection.activeSubDocument.documentModel;for(let o=0,a=t.length;o<a;o++){const a=t[o],s=e[o],l=i.listLevelProperties;l.displayFormatString.setValue(n,!0,r,o,s.displayFormatString),l.format.setValue(n,!0,r,o,s.format),l.start.setValue(n,!0,r,o,s.start),l.alignment.setValue(n,!0,r,o,s.alignment),l.separator.setValue(n,!0,r,o,s.separator);const d=i.listLevelParagraphProperties;d.leftIndent.setValue(n,!0,r,o,s.leftIndent,!0),d.firstLineIndent.setValue(n,!0,r,o,s.firstLineIndent,!0),d.firstLineIndentType.setValue(n,!0,r,o,s.firstLineIndentType,!0);const c=i.listLevelCharacterProperties,h=a.getCharacterProperties().fontInfo.clone();h.name=s.fontName,c.fontName.setValue(n,!0,r,o,h,!0),c.fontSize.setValue(n,!0,r,o,s.fontSize,!0),c.fontBold.setValue(n,!0,r,o,1==s.fontStyle,!0),c.fontItalic.setValue(n,!0,r,o,2==s.fontStyle,!0)}}applyCustomNumberingListParameters(e,t){const r=this.selection.activeSubDocument.getParagraphByPosition(this.selection.intervals[0].start),i=this.listType==tn.MultiLevel;if(e.equals(t)||i){if(this.control.commandManager.getCommand(FF.InsertNumerationToParagraphs).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,t.initAbstractNumberingList)),i){const e=r.getAbstractNumberingListIndex();this.applyToListLevels(t.levels,t.initAbstractNumberingList.levels,e)}return}let n=null,o=-1;this.selection.isCollapsed()&&r.isInList()?(n=t.initAbstractNumberingList,o=r.getNumberingList().abstractNumberingListIndex,t.applyToParagraph=!1):(n=new dn(this.control.modelManager.model),n.copyFrom(t.initAbstractNumberingList),this.history.addAndRedo(new Pw(this.modelManipulator,n)),o=this.control.modelManager.model.abstractNumberingLists.length-1),this.applyToCustomListLevels(e.levels,t.levels,o),t.applyToParagraph&&this.control.commandManager.getCommand(FF.InsertNumerationToParagraphs).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,n))}applyParameters(e,t){const r=this.history,i=new q0;return i.init(this.colorProvider,t.initAbstractNumberingList),r.beginTransaction(),this.applyCustomNumberingListParameters(i,t),r.endTransaction(),!0}getDialogName(){switch(this.listType){case tn.Bullet:return"BulletedList";case tn.Simple:return"SimpleNumberingList";case tn.MultiLevel:return"MultiLevelNumberingList"}return null}}class q0 extends GZ{constructor(){super(...arguments),this.currentLevel=0,this.levels=[],this.coreInitialFontColors=[],this.applyToParagraph=!0}init(e,t,r){if(null!=r&&(this.currentLevel=r),null!=t){this.listType=t.getListType(),this.initAbstractNumberingList=t;for(var i=0;i<t.levels.length;i++){var n=this.initLevel(e,t.levels[i]);this.levels.push(n)}}}initLevel(e,t){const r=new $0,i=t.getListLevelProperties();r.displayFormatString=i.displayFormatString,r.format=i.format,r.start=i.start,r.alignment=i.alignment,r.separator=i.separator;const n=t.getParagraphProperties();r.leftIndent=n.leftIndent,r.firstLineIndent=n.firstLineIndent,r.firstLineIndentType=n.firstLineIndentType;const o=t.getCharacterProperties();r.fontName=o.fontInfo.name;const a=o.textColor.toRgb(e);return r.fontColor=w.i.colorToHash(a),this.coreInitialFontColors.push(a),r.fontSize=o.fontSize,r.fontStyle=(o.fontBold?1:0)|(o.fontItalic?2:0),r}copyFrom(e){super.copyFrom(e),this.currentLevel=e.currentLevel,this.listType=e.listType,this.applyToParagraph=e.applyToParagraph,this.copyLevelsFrom(e.levels)}clone(){const e=new q0;return e.copyFrom(this),e}applyConverter(e){return this}copyLevelsFrom(e){this.levels=[];for(var t=0,r=e.length;t<r;t++){var i=new $0;i.copyFrom(e[t]),this.levels.push(i)}}equals(e){for(var t,r=0;t=e.levels[r];r++)if(!t.equals(this.levels[r]))return!1;return!0}}class $0{copyFrom(e){this.displayFormatString=e.displayFormatString,this.format=e.format,this.start=e.start,this.alignment=e.alignment,this.separator=e.separator,this.leftIndent=e.leftIndent,this.firstLineIndent=e.firstLineIndent,this.firstLineIndentType=e.firstLineIndentType,this.fontName=e.fontName,this.fontColor=e.fontColor,this.fontSize=e.fontSize,this.fontStyle=e.fontStyle}equals(e){return this.displayFormatString==e.displayFormatString&&this.format==e.format&&this.start==e.start&&this.alignment==e.alignment&&this.separator==e.separator&&this.leftIndent==e.leftIndent&&this.firstLineIndent==e.firstLineIndent&&this.firstLineIndentType==e.firstLineIndentType&&this.fontName==e.fontName&&this.fontColor==e.fontColor&&this.fontSize==e.fontSize&&this.fontStyle==e.fontStyle}}class J0 extends XZ{getState(){return new UU(this.isEnabled())}createParameters(e){var t=new Y0;return t.controller=this.control.searchManager,t}applyParameters(e,t){return!0}getDialogName(){return"FindReplace"}isEnabledInReadOnlyMode(){return!0}isModal(){return!1}static getTextForResult(e,t,r){let i=t.getParagraphByPosition(r.start).interval,n=J0.getTextForward(e,t,r.start,r.end,r.length),o=J0.getTextBackward(e,t,r.start,i.start,20),a=J0.getTextForward(e,t,r.end,i.end,20);return`${Q0(o)}<b>${Q0(n)}</b>${Q0(a)}`}static getTextForward(e,t,r,i,n){let o="";const a=new sm(e.modelManager,e.layoutFormatterManager,e.selection.pageIndex,t,r,i);for(;a.nextChar()&&o.length<n;)o+=a.char;return a.iterator.intervalEnd>a.getCurrLogPosition()&&o.length===n&&a.nextChar()?o+"...":o}static getTextBackward(e,t,r,i,n){let o="";const a=new lm(e.modelManager,e.layoutFormatterManager,e.selection.pageIndex,t,i,r);for(;a.prevChar()&&o.length<n;)o=a.char+o;return a.iterator.intervalStart<a.getCurrLogPosition()&&o.length===n&&a.prevChar()?"..."+o:o}}class Y0 extends GZ{copyFrom(e){super.copyFrom(e),this.controller=e.controller}clone(){const e=new Y0;return e.copyFrom(this),e}applyConverter(e){return this}}function Q0(e){const t=[[/&amp;/g,"&ampx;"],[/&/g,"&amp;"],[/&quot;/g,"&quotx;"],[/"/g,"&quot;"],[/&lt;/g,"&ltx;"],[/</g,"&lt;"],[/&gt;/g,"&gtx;"],[/>/g,"&gt;"]];for(var r=0;r<t.length;r++){var i=t[r];e=e.replace(i[0],i[1])}return e}class Z0 extends XZ{getState(){return new UU(this.isEnabled())}isEnabledInReadOnlyMode(){return!0}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)&&this.control.modelManager.richOptions.mailMerge.isEnabled&&this.control.modelManager.model.mainSubDocument.getDocumentEndPosition()>1}canModify(){return!0}createParameters(e){var t=new e1;return t.range=SZ.AllRecords,t.exportFrom=1,t.exportRecordsCount=this.control.modelManager.richOptions.mailMerge.recordCount,t.mergeMode=CZ.NewParagraph,t.documentFormat=Fu.OpenXml,t}getDialogName(){return"FinishAndMerge"}}class e1 extends GZ{copyFrom(e){super.copyFrom(e),this.range=e.range,this.exportFrom=e.exportFrom,this.exportRecordsCount=e.exportRecordsCount,this.mergeMode=e.mergeMode,this.documentFormat=e.documentFormat}clone(){const e=new e1;return e.copyFrom(this),e}applyConverter(e){return this}}!function(e){e[e.NewParagraph=0]="NewParagraph",e[e.NewSection=1]="NewSection",e[e.JoinTables=2]="JoinTables"}(CZ||(CZ={})),function(e){e[e.AllRecords=0]="AllRecords",e[e.CurrentRecord=1]="CurrentRecord",e[e.Range=2]="Range"}(SZ||(SZ={}));class t1 extends XZ{getDialogName(){return"EditFont"}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.characterFormatting)}}class r1 extends t1{getState(){let e=new VU(this.isEnabled(),this.getActualIntervals());return e.visible=Bb.isVisible(this.control.modelManager.richOptions.control.characterFormatting),e}isEnabled(){return super.isEnabled()&&(!this.selection.specialRunInfo.isPictureSelected()||!this.selection.specialRunInfo.isSelectedAnchorObject)}getActualIntervals(){return this.selection.isCollapsed()?[this.selection.activeSubDocument.getWholeWordInterval(this.selection.intervals[0].start)]:f.ListUtils.deepCopy(this.selection.intervalsInfo.intervals)}createParameters(e){var t=new n1;return t.init(this.colorProvider,this.inputPosition.getMergedCharacterPropertiesRaw()),t}applyParameters(e,t,r){const i=new Ie;i.allCaps=t.allCaps!==r.allCaps?t.allCaps:void 0,i.smallCaps=t.smallCaps!==r.smallCaps?t.smallCaps:void 0,i.fontInfo=null!==t.fontName&&t.fontName!==r.fontName&&this.control.modelManager.model.cache.fontInfoCache.getItemByName(t.fontName)||void 0,i.fontSize=null!==t.fontSize&&t.fontSize!==r.fontSize?t.fontSize:void 0,i.fontStrikeoutType=null!==t.fontStrikeoutType&&t.fontStrikeoutType!==r.fontStrikeoutType?t.fontStrikeoutType:void 0,i.fontBold=null!==t.fontStyle&&t.fontStyle!==r.fontStyle&&(1&t.fontStyle)!=(1&r.fontStyle)?!!(1&t.fontStyle):void 0,i.fontItalic=null!==t.fontStyle&&t.fontStyle!==r.fontStyle&&(2&t.fontStyle)!=(2&r.fontStyle)?!!(2&t.fontStyle):void 0,i.fontUnderlineType=null!==t.fontUnderlineType&&t.fontUnderlineType!==r.fontUnderlineType?t.fontUnderlineType:void 0,i.hidden=t.hidden!==r.hidden?t.hidden:void 0,i.script=null!==t.script&&t.script!==r.script?t.script:void 0,i.underlineWordsOnly=t.underlineWordsOnly!==r.underlineWordsOnly?t.underlineWordsOnly:void 0,i.textColor=null!==t.fontColor&&t.fontColor!==r.fontColor?he.makeByColor("Auto"==t.fontColor?y.AUTOMATIC_COLOR:w.i.fromString(t.fontColor)):void 0,i.underlineColor=null!==t.fontUnderlineColor&&t.fontUnderlineColor!==r.fontUnderlineColor?he.makeByColor("Auto"==t.fontUnderlineColor?y.AUTOMATIC_COLOR:w.i.fromString(t.fontUnderlineColor)):void 0;const n=t.backColor!==r.backColor;return i.shadingInfo=n?fe.createByColor(he.makeByColor(null===t.backColor?y.NO_COLOR:w.i.fromString(t.backColor))):void 0,i.highlightColor=n?he.noColor:void 0,i.strikeoutWordsOnly=void 0,i.noProof=void 0,i.strikeoutColor=void 0,i.langInfo=void 0,i.compositeFontInfo=void 0,new fm(this.control.modelManager,this.inputPosition,i,this.control.selection.activeSubDocument,this.control.selection.intervals).apply()}}class i1 extends t1{createParameters(e){this.dialogCustomNumberingListParameters=e.param;var t=this.dialogCustomNumberingListParameters.levels[this.dialogCustomNumberingListParameters.currentLevel],r=new n1;return r.initServicePart(t),r}applyParameters(e,t){var r=this.dialogCustomNumberingListParameters.levels[this.dialogCustomNumberingListParameters.currentLevel];return r.fontColor=t.fontColor,r.fontName=t.fontName,r.fontSize=t.fontSize,r.fontStyle=t.fontStyle,!1}afterClosing(){var e=FF.ShowCustomNumberingListForm;this.control.commandManager.getCommand(e).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,this.dialogCustomNumberingListParameters))}}class n1 extends GZ{constructor(){super(...arguments),this.fontName=null,this.fontStyle=null,this.fontSize=null,this.fontColor=null,this.backColor=null,this.fontUnderlineType=null,this.fontUnderlineColor=null,this.fontStrikeoutType=null,this.underlineWordsOnly=null,this.script=null,this.allCaps=null,this.smallCaps=null,this.hidden=null}init(e,t){this.allCaps=t.allCaps,this.smallCaps=t.smallCaps,this.fontColor=t.textColor?n1.getColor(t.textColor.toRgb(e)):void 0,this.backColor=t.shadingInfo&&t.highlightColor?n1.getColor(Ie.getActualBackgroundColor(t,e)):void 0,this.fontName=t.fontInfo?t.fontInfo.name:null,this.fontSize=t.fontSize,this.fontStrikeoutType=t.fontStrikeoutType,this.fontStyle=(t.fontBold?1:0)|(t.fontItalic?2:0),this.fontUnderlineColor=t.underlineColor?n1.getColor(t.underlineColor.toRgb(e)):void 0,this.fontUnderlineType=t.fontUnderlineType,this.hidden=t.hidden,this.script=t.script,this.underlineWordsOnly=t.underlineWordsOnly}static getColor(e){return e===y.AUTOMATIC_COLOR?"Auto":e===y.NO_COLOR?null:void 0!==e?w.i.colorToHash(e).toUpperCase():void 0}initServicePart(e){this.fontColor=e.fontColor,this.fontName=e.fontName,this.fontSize=e.fontSize,this.fontStyle=e.fontStyle}copyFrom(e){super.copyFrom(e),this.allCaps=e.allCaps,this.smallCaps=e.smallCaps,this.fontColor=e.fontColor,this.fontName=e.fontName,this.fontSize=e.fontSize,this.fontStrikeoutType=e.fontStrikeoutType,this.fontStyle=e.fontStyle,this.fontUnderlineColor=e.fontUnderlineColor,this.fontUnderlineType=e.fontUnderlineType,this.hidden=e.hidden,this.script=e.script,this.underlineWordsOnly=e.underlineWordsOnly,this.backColor=e.backColor}clone(){const e=new n1;return e.copyFrom(this),e}applyConverter(e){return this}}class o1 extends EU{getState(){return new HU(this.isEnabled(),this.selection.lastSelectedInterval)}static isTableProtectionOk(e){const t=e.subDocument,r=o1.getIntervalWithoutLastParagraphMark(e.interval,t);if(0==r.length)return!0;const i=e.subDocument.tables;for(let e,n=Math.max(0,C.SearchUtils.normedInterpolationIndexOf(i,(e=>e.getStartPosition()),r.start));(e=i[n])&&!(e.getStartPosition()>=r.end);n++)if(nn.IntervalAlgorithms.getIntersectionNonNullLength(e.interval,r)){const e=Ja.getTableCellByPosition(i,r.start),n=Ja.getTableCellByPosition(i,r.end);return e&&n&&e===n&&r.end<t.getParagraphByPosition(n.endParagrapPosition.value).getEndPosition()}return!0}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)&&o1.isTableProtectionOk(this.selection.subDocumentInterval)}static getIntervalWithoutLastParagraphMark(e,t){e=e.clone();var r=t.getDocumentEndPosition();return e.end==r&&(e.length--,e.length<0&&(e=new on.FixedInterval(r-1,0))),e}}class a1 extends o1{DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.intervals=[o1.getIntervalWithoutLastParagraphMark(this.selection.lastSelectedInterval,e.subDocument)]}executeCore(e,t){const r=t.subDocument,i=t.intervalsInfo.interval;return this.history.addTransaction((()=>{this.history.addAndRedo(new pp(this.modelManipulator,r,i.start,i.length,0,!0,this.inputPosition.charPropsBundle)),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(i.start+1)))})),!0}}class s1 extends o1{DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.interval=o1.getIntervalWithoutLastParagraphMark(this.selection.lastSelectedInterval,e.subDocument)}executeCore(e,t){const r=t.subDocument,i=t.intervalsInfo.interval;var n=this.history;n.beginTransaction();var o=i.start;n.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(o))),i.length>0&&n.addAndRedo(new Hm(this.modelManipulator,new gu(r,i),!1));var a=r.getRunByPosition(o),s=this.getPrefix();if(s.length>0&&(n.addAndRedo(new nm(this.modelManipulator,new op(new pu(r,o),a.getCharPropsBundle(this.modelManipulator.model),cs.TextRun,s+" "))),o+=s.length+1),this.needNewParagraph()){const e=r.getParagraphByPosition(o);o>e.startLogPosition.value&&(this.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(r,o),this.inputPosition)),o++),this.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(r,o),this.inputPosition))}n.addAndRedo(new pp(this.modelManipulator,r,o,0,0,!this.needUpdate(),this.inputPosition.charPropsBundle));var l=this.getInsertedText(t.param);n.addAndRedo(new nm(this.modelManipulator,new op(new pu(r,o+1),a.getCharPropsBundle(this.modelManipulator.model),cs.TextRun,l)));const d=this.needUpdate()?new on.FixedInterval(o,l.length+3):new on.FixedInterval(o+l.length,0);return this.needUpdate()?tq.updateFields(this,[new mu(r,[d])],(()=>{const e=r.fields[Md.normedBinaryIndexOf(r.fields,o+1)].getFieldEndPosition();n.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(e))),n.endTransaction()}),new $g):(this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(d))),n.endTransaction()),!0}needUpdate(){return!0}needNewParagraph(){return!1}getPrefix(){return""}}class l1 extends s1{getInsertedText(e){return e}}class d1 extends s1{getInsertedText(e){return"PAGE"}}class c1 extends s1{getInsertedText(e){return"NUMPAGES"}}class h1 extends s1{getInsertedText(e){return`DATE \\@ "${this.control.modelManager.richOptions.fields.defaultDateFormat}"`}}class u1 extends s1{getInsertedText(e){return`TIME \\@ "${this.control.modelManager.richOptions.fields.defaultTimeFormat}"`}}class p1 extends s1{getInsertedText(e){return-1!==e.indexOf(" ")?`MERGEFIELD "${e}"`:`MERGEFIELD ${e}`}}class g1 extends s1{getInsertedText(e){return'MERGEFIELD ""'}needUpdate(){return!1}}class m1 extends s1{getInsertedText(e){return'DOCVARIABLE ""'}needUpdate(){return!1}}class f1 extends s1{getInsertedText(e){return"IF"}needUpdate(){return!1}}class b1 extends s1{isEnabled(){const e=eq.findTocFieldBySelection(this.selection.activeSubDocument,this.selection);return super.isEnabled()&&null==e}getInsertedText(e){return'TOC \\h \\c "Table"'}needNewParagraph(){return!0}}class C1 extends b1{getInsertedText(e){return"TOC \\h \\u"}}class S1 extends b1{getInsertedText(e){return'TOC \\h \\c "Equation"'}}class I1 extends b1{getInsertedText(e){return'TOC \\h \\c "Figure"'}}class P1 extends b1{getInsertedText(e){return'TOC \\h \\c "Table"'}}class w1 extends s1{getInsertedText(e){return"SEQ Equation \\* ARABIC"}getPrefix(){return this.control.stringResources.seqCaptionPrefixes.equationPrefix}}class y1 extends s1{getInsertedText(e){return"SEQ Figure \\* ARABIC"}getPrefix(){return this.control.stringResources.seqCaptionPrefixes.figurePrefix}}class x1 extends s1{getInsertedText(e){return"SEQ Table \\* ARABIC"}getPrefix(){return this.control.stringResources.seqCaptionPrefixes.tablePrefix}}class T1 extends XZ{getState(e){var t=new UU(this.isEnabled(e));return t.value=this.getStateValue(),t.visible=this.isVisible(),t}getStateValue(){return this.getSelectedField()}isEnabled(e){const t=e?e.intervalsInfo.subDocInterval:this.selection.subDocumentInterval;return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.hyperlinks)&&!(e?e.intervalsInfo.multiselection:this.selection.multiselection)&&o1.isTableProtectionOk(t)}isVisible(){return Bb.isVisible(this.control.modelManager.richOptions.control.hyperlinks)}createParameters(e){var t=new D1;t.canChangeDisplayText=yb.canChangeHyperlinkDisplayText(e.intervalsInfo.subDocInterval);var r=this.getState().value;if(r){var i=r.getHyperlinkInfo();i.isUri()?(t.url=i.getUriWithAnchor(),t.anchor=""):(t.url="",t.anchor=i.anchor),t.tooltip=i.tip,t.text=yb.getHyperlinkResultText(e.subDocument,r)}else t.text=t.canChangeDisplayText?e.subDocument.getText(e.intervalsInfo.interval):"";return t.bookmarkNames=f.ListUtils.map(this.control.modelManager.model.getAllBookmarks(!1),(e=>e.name)),t}applyParameters(e,t,r){if(t.tooltip==r.tooltip&&t.url==r.url&&t.anchor==r.anchor&&t.text==r.text)return!1;var i=new xd(t.url,t.anchor,t.tooltip,!1);if(!i.isValid())return!1;var n=this.modelManipulator,o=this.selection,a=this.selection.activeSubDocument,s=this.history,l=o.lastSelectedInterval;if(l.end==a.getDocumentEndPosition()&&(l.length--,l.length<0))return!1;s.beginTransaction(),this.control.beginUpdate();var d=this.getField(e.value);return s.addAndRedo(new hp(n,a,d.index,i)),t.tooltip==r.tooltip&&t.url==r.url&&t.anchor==r.anchor||(o.deprecatedSetSelection(d.getCodeStartPosition(),d.getSeparatorPosition(),!1,o.keepX,!1,!1),this.control.commandManager.getCommand(FF.InsertText).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,xd.getNewCodeText(i)))),(r.canChangeDisplayText&&t.text!=r.text||0==d.getResultInterval().length)&&(o.deprecatedSetSelection(d.getResultStartPosition(),d.getResultEndPosition(),!1,o.keepX,!1,!1),this.control.commandManager.getCommand(FF.InsertText).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,t.text&&""!=t.text?t.text:i.getUriWithAnchor()))),s.addAndRedo(new Up(n,new gu(this.selection.activeSubDocument,d.getResultInterval()))),o.deprecatedSetSelection(d.getFieldEndPosition(),d.getFieldEndPosition(),!1,o.keepX,!1,!1),this.control.endUpdate(),s.endTransaction(),!0}getField(e){var t;if(e)(t=e).showCode=!1;else{var r=this.selection,i=this.selection.activeSubDocument,n=r.lastSelectedInterval;this.history.addAndRedo(new pp(this.modelManipulator,i,n.start,0,n.length,!1,this.inputPosition.charPropsBundle));var o=Md.normedBinaryIndexOf(i.fields,n.start+1);t=i.fields[o]}return t}showCreateHyperlinkItem(){return yb.showCreateHyperlinkItem(this.selection.activeSubDocument.fields,this.selection.lastSelectedInterval)}getSelectedField(){return yb.getHyperlinkField(this.selection.activeSubDocument.fields,this.selection.lastSelectedInterval)}hasOneSelectedHyperlink(){return!!this.getSelectedField()}getDialogName(){return"Hyperlink"}}class v1 extends T1{isEnabled(){return super.isEnabled()&&(this.showCreateHyperlinkItem()||this.hasOneSelectedHyperlink())}}class M1 extends T1{isVisible(){return super.isVisible()&&this.showCreateHyperlinkItem()}}class E1 extends T1{isVisible(){return super.isVisible()&&this.hasOneSelectedHyperlink()}}class D1 extends GZ{constructor(){super(...arguments),this.url="",this.text="",this.tooltip="",this.anchor="",this.bookmarkNames=[],this.canChangeDisplayText=!0}copyFrom(e){super.copyFrom(e),this.anchor=e.anchor,this.url=e.url,this.text=e.text,this.tooltip=e.tooltip,this.canChangeDisplayText=e.canChangeDisplayText,this.bookmarkNames=e.bookmarkNames}clone(){const e=new D1;return e.copyFrom(this),e}applyConverter(e){return this}}class F1 extends XZ{constructor(e){super(e)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.inlinePictures)&&1===this.selection.intervals.length}createParameters(e){return new R1}applyParameters(e,t){const r=this.selection.intervalsInfo.interval.clone(),i=this.control.modelManager.model.cache.imageCache.createLoadedInfo(t.base64EncodedImage,t.originalSize,t.id);return this.history.addTransaction((()=>{this.modelManipulator.range.removeInterval(new gu(this.selection.activeSubDocument,r),!0,!1),this.modelManipulator.picture.insertInlinePictureViaHistory(new pu(this.selection.activeSubDocument,r.start),this.inputPosition.charPropsBundle,nh.defaultInfo(i),new Mb(!0))})),!0}getDialogName(){return"InsertImage"}}class R1 extends GZ{constructor(){super(...arguments),this.id=0,this.base64EncodedImage=null,this.originalSize=new so.Size(100,100)}copyFrom(e){super.copyFrom(e),this.id=e.id,this.originalSize=e.originalSize.clone(),this.base64EncodedImage=e.base64EncodedImage}clone(){const e=new R1;return e.copyFrom(this),e}applyConverter(e){return this}}class L1 extends XZ{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)&&this.control.modelManager.richOptions.mailMerge.allowInsertFields}createParameters(e){return new B1}applyParameters(e,t){return null!=t.fieldName&&(this.control.commandManager.getCommand(FF.CreateMergeField).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,t.fieldName)),!0)}getDialogName(){return"InsertMergeField"}isModal(){return!1}}class B1 extends GZ{copyFrom(e){super.copyFrom(e),this.fieldName=e.fieldName}clone(){const e=new B1;return e.copyFrom(this),e}applyConverter(e){return this}}class A1 extends XZ{getState(){const e=this.selection.tableInfo.extendedData.numRows>0;let t=new UU(this.isEnabled()&&e);return t.visible=e,t}createParameters(e){var t=new k1;return t.tableCellOperation=IZ.ShiftToTheVertically,t}applyParameters(e,t){var r=FF.None;switch(t.tableCellOperation){case IZ.ShiftToTheHorizontally:r=FF.InsertTableCellWithShiftToTheLeft;break;case IZ.ShiftToTheVertically:r=FF.InsertTableCellsWithShiftToTheVertically;break;case IZ.RowOperation:r=FF.InsertTableRowAbove;break;case IZ.ColumnOperation:r=FF.InsertTableColumnToTheLeft}return this.control.commandManager.getCommand(r).execute(this.control.commandManager.isPublicApiCall)}getDialogName(){return"InsertTableCells"}}class N1 extends XZ{getState(){let e=new UU(this.isEnabled());return e.visible=this.selection.tableInfo.extendedData.numRows>0&&!this.selection.specialRunInfo.isSelected(),e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&(this.selection.tableInfo.extendedData.isSquare||1==this.selection.tableInfo.extendedData.numRows)}createParameters(e){var t=new k1;return t.tableCellOperation=IZ.ShiftToTheHorizontally,t}applyParameters(e,t){var r=FF.None;switch(t.tableCellOperation){case IZ.ShiftToTheHorizontally:r=FF.DeleteTableCellsWithShiftToTheHorizontally;break;case IZ.ShiftToTheVertically:r=FF.DeleteTableCellsWithShiftToTheVertically;break;case IZ.RowOperation:r=FF.DeleteTableRows;break;case IZ.ColumnOperation:r=FF.DeleteTableColumns}return this.control.commandManager.getCommand(r).execute(this.control.commandManager.isPublicApiCall)}getDialogName(){return"DeleteTableCells"}}class k1 extends GZ{copyFrom(e){super.copyFrom(e),this.tableCellOperation=e.tableCellOperation}clone(){const e=new k1;return e.copyFrom(this),e}applyConverter(e){return this}}!function(e){e[e.ShiftToTheHorizontally=0]="ShiftToTheHorizontally",e[e.ShiftToTheVertically=1]="ShiftToTheVertically",e[e.RowOperation=2]="RowOperation",e[e.ColumnOperation=3]="ColumnOperation"}(IZ||(IZ={}));class O1 extends XZ{createParameters(e){var t=new _1;return t.rowCount=2,t.columnCount=5,t}applyParameters(e,t){return t.rowCount>0&&t.columnCount>0&&(this.control.commandManager.getCommand(FF.InsertTableCore).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,{rowCount:t.rowCount,cellCount:t.columnCount})),!0)}getDialogName(){return"InsertTable"}}class _1 extends GZ{copyFrom(e){super.copyFrom(e),this.rowCount=e.rowCount,this.columnCount=e.columnCount}clone(){const e=new _1;return e.copyFrom(this),e}applyConverter(e){return this}}class U1 extends tt{constructor(e,t,r){super(e,t),this.size=r}redo(){this.oldState=this.modelManipulator.floatingObject.textBoxSize.setValue(this.boundSubDocument,this.interval,this.size)}undo(){this.modelManipulator.floatingObject.textBoxSize.restoreValue(this.boundSubDocument,this.oldState)}}class H1 extends tt{constructor(e,t,r){super(e,t),this.textBoxProperties=r}redo(){this.oldState=this.modelManipulator.floatingObject.textBoxProperties.setValue(this.boundSubDocument,this.interval,this.textBoxProperties)}undo(){this.modelManipulator.floatingObject.textBoxProperties.restoreValue(this.boundSubDocument,this.oldState)}}class V1 extends XZ{getState(){let e=this.isEnabled(),t=new UU(e);return t.visible=e,t}isEnabled(){const e=this.selection.specialRunInfo;return super.isEnabled()&&e.isSelected()&&this.getFloatingObjectParentSubDocument().isEditable([new on.FixedInterval(e.getPosition(),1)])}createParameters(e){let t=new W1;const r=this.selection.specialRunInfo;let i=r.getParentSubDocument().getRunByPosition(r.getPosition());if(i.getType()===cs.InlinePictureRun)t.init(null,i.size,null,this.control);else if(i.getType()===cs.AnchoredPictureRun){let e=i;t.init(e.anchorInfo,e.size,null,this.control)}else{let e=i;t.init(e.anchorInfo,e.size,e.textBoxProperties,this.control)}return t}applyParameters(e,t,r){let i=this.selection.specialRunInfo,n=i.getPosition(),o=new on.FixedInterval(n,1),a=i.getParentSubDocument(),s=a.getRunByPosition(n),l=this.modelManipulator,d=l.floatingObject.anchorInfo;const c=this.control.viewManager.canvasManager.getScrollTopInfo();let h=this.history;h.beginTransaction();let u=!1,p=!1;if(null!==r.wrapType&&null===t.wrapType&&s.getType()===cs.AnchoredPictureRun){const e=s;this.history.beginTransaction();const t=this.inputPosition.charPropsBundle;this.modelManipulator.range.removeInterval(new gu(this.selection.activeSubDocument,o),!0,!1);const r=this.modelManipulator.picture.insertInlinePictureViaHistory(new pu(this.selection.activeSubDocument,o.start),t,new nh(e.size,e.shape,-1,e.info.containerProperties,e.info.nonVisualDrawingProperties));this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(r.insertedInterval))),this.selection.scrollManager.setScroll((new xD).byModelPosition(this.selection).setModelPosition(r.insertedInterval.end).useStdRelativePosition().useStdOffset()),this.history.endTransaction(),s=a.getRunByPosition(o.start),u=!0}if(null===r.wrapType&&null!==t.wrapType&&s.getType()===cs.InlinePictureRun){const e=s,t=new Jc;t.zOrder=this.modelManipulator.floatingObject.zOrder.getNewZOrder(this.selection.activeSubDocument),this.history.beginTransaction();const r=this.inputPosition.charPropsBundle;this.modelManipulator.range.removeInterval(new gu(this.selection.activeSubDocument,o),!0,!1);const i=this.modelManipulator.picture.insertAnchoredPictureViaHistory(new pu(this.selection.activeSubDocument,o.start),r,new oh(e.size,new th,t,e.info.containerProperties,e.info.nonVisualDrawingProperties),new Mb(!0));this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(i.insertedInterval))),this.selection.scrollManager.setScroll((new xD).byModelPosition(this.selection).setModelPosition(i.insertedInterval.end).useStdRelativePosition().useStdOffset()),this.history.endTransaction(),s=a.getRunByPosition(o.start),u=!0}s.getType()!=cs.InlinePictureRun&&void 0!==t.horizontalPositionAlignment&&t.horizontalPositionAlignment!=r.horizontalPositionAlignment&&(h.addAndRedo(new gC(l,new gu(a,o),t.horizontalPositionAlignment,d.horizontalPositionAlignment)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.horizontalPositionType&&t.horizontalPositionType!=r.horizontalPositionType&&(h.addAndRedo(new gC(l,new gu(a,o),t.horizontalPositionType,d.horizontalPositionType)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.offsetX&&t.offsetX!=r.offsetX&&(h.addAndRedo(new gC(l,new gu(a,o),t.offsetX,d.offsetX)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.percentOffsetX&&t.percentOffsetX!=r.percentOffsetX&&(h.addAndRedo(new gC(l,new gu(a,o),t.percentOffsetX,d.percentOffsetX)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.verticalPositionAlignment&&t.verticalPositionAlignment!=r.verticalPositionAlignment&&(h.addAndRedo(new gC(l,new gu(a,o),t.verticalPositionAlignment,d.verticalPositionAlignment)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.verticalPositionType&&t.verticalPositionType!=r.verticalPositionType&&(h.addAndRedo(new gC(l,new gu(a,o),t.verticalPositionType,d.verticalPositionType)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.offsetY&&t.offsetY!=r.offsetY&&(h.addAndRedo(new gC(l,new gu(a,o),t.offsetY,d.offsetY)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.percentOffsetY&&t.percentOffsetY!=r.percentOffsetY&&(h.addAndRedo(new gC(l,new gu(a,o),t.percentOffsetY,d.percentOffsetY)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.locked&&t.locked!=r.locked&&(h.addAndRedo(new gC(l,new gu(a,o),t.locked,d.locked)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.wrapType&&null!==t.wrapType&&t.wrapType!=r.wrapType&&(h.addAndRedo(new gC(l,new gu(a,o),t.wrapType,d.wrapType)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.wrapSide&&t.wrapSide!=r.wrapSide&&(h.addAndRedo(new gC(l,new gu(a,o),t.wrapSide,d.wrapSide)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.topDistance&&t.topDistance!=r.topDistance&&(h.addAndRedo(new gC(l,new gu(a,o),t.topDistance,d.topDistance)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.bottomDistance&&t.bottomDistance!=r.bottomDistance&&(h.addAndRedo(new gC(l,new gu(a,o),t.bottomDistance,d.bottomDistance)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.leftDistance&&t.leftDistance!=r.leftDistance&&(h.addAndRedo(new gC(l,new gu(a,o),t.leftDistance,d.leftDistance)),u=!0),s.getType()!=cs.InlinePictureRun&&void 0!==t.rightDistance&&t.rightDistance!=r.rightDistance&&(h.addAndRedo(new gC(l,new gu(a,o),t.rightDistance,d.rightDistance)),u=!0);let m=s.size.clone();if(void 0!==t.absoluteHeight&&t.absoluteHeight!=r.absoluteHeight||void 0!==t.absoluteWidth&&t.absoluteWidth!=r.absoluteWidth){if(m instanceof Qc){let e=s,r=t.absoluteWidth/e.size.originalSize.width*100,i=t.absoluteHeight/e.size.originalSize.height*100,n=new so.Size(r,i);m.scale=n}else m.absoluteSize.width=t.absoluteWidth,m.absoluteSize.height=t.absoluteHeight;p=!0}return void 0!==r.useAbsoluteHeight&&t.useAbsoluteHeight!==r.useAbsoluteHeight&&m instanceof eh&&(t.useAbsoluteHeight&&(m.absoluteSize.height=t.absoluteHeight,t.textBoxProperties.resizeShapeToFitText=!1),m.setUseAbsoluteHeight(t.useAbsoluteHeight),p=!0),void 0!==r.useAbsoluteWidth&&t.useAbsoluteWidth!==r.useAbsoluteWidth&&m instanceof eh&&(t.useAbsoluteWidth&&(m.absoluteSize.width=t.absoluteWidth),m.setUseAbsoluteWidth(t.useAbsoluteWidth),p=!0),void 0!==r.relativeHeight&&t.relativeHeight!==r.relativeHeight&&m instanceof eh&&(m.relativeSize.height=t.relativeHeight,p=!0),void 0!==r.relativeWidth&&t.relativeWidth!==r.relativeWidth&&m instanceof eh&&(m.relativeSize.width=t.relativeWidth,p=!0),void 0!==r.relativeHeightType&&t.relativeHeightType!==r.relativeHeightType&&m instanceof eh&&(m.relativeHeightType=t.relativeHeightType,p=!0),void 0!==r.relativeWidthType&&t.relativeWidthType!==r.relativeWidthType&&m instanceof eh&&(m.relativeWidthType=t.relativeWidthType,p=!0),void 0!==t.rotation&&t.rotation!=r.rotation&&(m.rotation=g.u.degreesToTwips(t.rotation),p=!0),void 0!==t.lockAspectRatio&&t.lockAspectRatio!=r.lockAspectRatio&&(m.lockAspectRatio=t.lockAspectRatio,p=!0),void 0!==t.isBehindDoc&&t.isBehindDoc!=r.isBehindDoc&&(h.addAndRedo(new gC(l,new gu(a,o),t.isBehindDoc,d.isBehindDoc)),u=!0),p&&(m instanceof Qc?s.getType()===cs.InlinePictureRun?(h.addAndRedo(new W_(l,new gu(a,o),m.scale)),t.lockAspectRatio!=r.lockAspectRatio&&h.addAndRedo(new z_(l,new gu(a,o),m.lockAspectRatio))):h.addAndRedo(new IS(l,new gu(a,o),m)):h.addAndRedo(new U1(l,new gu(a,o),m)),u=!0),void 0===r.textBoxProperties||t.textBoxProperties.equals(r.textBoxProperties)||(h.addAndRedo(new H1(l,new gu(a,o),t.textBoxProperties)),u=!0),h.endTransaction(),c&&this.selection.scrollManager.setScroll((new xD).byScrollInfo.setPageInfo(c)),u}getDialogName(){return"LayoutOptions"}}class W1 extends GZ{init(e,t,r,i){let n=null!==e;if(this.horizontalPositionType=n?e.horizontalPositionType:gc.Column,this.horizontalPositionAlignment=n?e.horizontalPositionAlignment:mc.Center,this.verticalPositionType=n?e.verticalPositionType:fc.Paragraph,this.verticalPositionAlignment=n?e.verticalPositionAlignment:bc.Top,this.offsetX=n?e.offset.x:null,this.offsetY=n?e.offset.y:null,this.percentOffsetX=n?e.percentOffset.x:null,this.percentOffsetY=n?e.percentOffset.y:null,this.locked=n?e.locked:null,this.wrapType=n?e.wrapType:null,this.wrapSide=n?e.wrapSide:null,this.isBehindDoc=n?e.isBehindDoc:null,this.leftDistance=n?e.leftDistance:null,this.rightDistance=n?e.rightDistance:null,this.topDistance=n?e.topDistance:null,this.bottomDistance=n?e.bottomDistance:null,this.rotation=g.u.twipsToDegrees(t.rotation),this.lockAspectRatio=t.lockAspectRatio,t instanceof Qc){let e=t;this.originalWidth=e.originalSize.width,this.originalHeight=e.originalSize.height,this.absoluteWidth=e.originalSize.width*e.scale.width/100,this.absoluteHeight=e.originalSize.height*e.scale.height/100}else{let e=i.modelManager.model.getSectionByPosition(i.selection.intervals[0].start),r=new vS;r.init(e);let n=t;this.useAbsoluteHeight=n.useAbsoluteHeight(),this.useAbsoluteWidth=n.useAbsoluteWidth(),this.absoluteWidth=this.useAbsoluteWidth?n.absoluteSize.width:g.u.pixelsToTwips(n.getActualRelativeWidth(r)),this.absoluteHeight=this.useAbsoluteHeight?n.absoluteSize.height:g.u.pixelsToTwips(n.getActualRelativeHeight(r)),this.relativeWidth=n.relativeSize.width,this.relativeHeight=n.relativeSize.height,this.relativeWidthType=n.relativeWidthType,this.relativeHeightType=n.relativeHeightType,this.originalWidth=this.absoluteWidth,this.originalHeight=this.absoluteHeight}n?(e.isUsedHorizontalAlignment()?this.horizontalAligmentType=PZ.Alignment:e.isUsedHorizontalBookLayout()?this.horizontalAligmentType=PZ.BookLayout:this.horizontalAligmentType=e.isUsedHorizontalRelativePosition()?PZ.Relative:PZ.Absolute,e.isUsedVerticalAlignment()?this.verticalAligmentType=PZ.Alignment:this.verticalAligmentType=e.isUsedVerticalRelativePosition()?PZ.Relative:PZ.Absolute):(this.horizontalAligmentType=PZ.Absolute,this.verticalAligmentType=PZ.Absolute),r&&(this.textBoxProperties=new ph(r.getContentMargins()))}copyFrom(e){this.horizontalPositionType=e.horizontalPositionType,this.horizontalPositionAlignment=e.horizontalPositionAlignment,this.verticalPositionType=e.verticalPositionType,this.verticalPositionAlignment=e.verticalPositionAlignment,this.offsetX=e.offsetX,this.offsetY=e.offsetY,this.percentOffsetX=e.percentOffsetX,this.percentOffsetY=e.percentOffsetY,this.locked=e.locked,this.wrapType=e.wrapType,this.wrapSide=e.wrapSide,this.isBehindDoc=e.isBehindDoc,this.leftDistance=e.leftDistance,this.rightDistance=e.rightDistance,this.topDistance=e.topDistance,this.bottomDistance=e.bottomDistance,this.originalWidth=e.originalWidth,this.originalHeight=e.originalHeight,this.absoluteHeight=e.absoluteHeight,this.absoluteWidth=e.absoluteWidth,this.useAbsoluteHeight=e.useAbsoluteHeight,this.useAbsoluteWidth=e.useAbsoluteWidth,this.relativeHeight=e.relativeHeight,this.relativeWidth=e.relativeWidth,this.relativeHeightType=e.relativeHeightType,this.relativeWidthType=e.relativeWidthType,this.rotation=e.rotation,this.lockAspectRatio=e.lockAspectRatio,this.horizontalAligmentType=e.horizontalAligmentType,this.verticalAligmentType=e.verticalAligmentType,this.textBoxProperties=e.textBoxProperties?e.textBoxProperties.clone():e.textBoxProperties}clone(){const e=new W1;return e.copyFrom(this),e}applyConverter(e){return this.offsetX&&(this.offsetX=e(this.offsetX)),this.offsetY&&(this.offsetY=e(this.offsetY)),this.leftDistance&&(this.leftDistance=e(this.leftDistance)),this.rightDistance&&(this.rightDistance=e(this.rightDistance)),this.topDistance&&(this.topDistance=e(this.topDistance)),this.bottomDistance&&(this.bottomDistance=e(this.bottomDistance)),this.absoluteHeight&&(this.absoluteHeight=e(this.absoluteHeight)),this.absoluteWidth&&(this.absoluteWidth=e(this.absoluteWidth)),this.originalWidth&&(this.originalWidth=e(this.originalWidth)),this.originalHeight&&(this.originalHeight=e(this.originalHeight)),this.textBoxProperties&&this.textBoxProperties.setMarginsToAnotherMeasuringSystem(e),this}}!function(e){e[e.Alignment=0]="Alignment",e[e.BookLayout=1]="BookLayout",e[e.Absolute=2]="Absolute",e[e.Relative=3]="Relative"}(PZ||(PZ={}));class z1 extends XZ{getState(){let e=new UU(this.isEnabled());return e.visible=(Bb.isVisible(this.control.modelManager.richOptions.control.numberingBulleted)||Bb.isVisible(this.control.modelManager.richOptions.control.numberingMultiLevel)||Bb.isVisible(this.control.modelManager.richOptions.control.numberingSimple))&&!this.selection.specialRunInfo.isPictureSelected(),e}isEnabled(){return super.isEnabled()&&(Bb.isEnabled(this.control.modelManager.richOptions.control.numberingBulleted)||Bb.isEnabled(this.control.modelManager.richOptions.control.numberingMultiLevel)||Bb.isEnabled(this.control.modelManager.richOptions.control.numberingSimple))}createParameters(e){var t=new j1;e.param instanceof dn?t.selectedAbstractNumberingList=e.param:this.areThereParagraphsInDifferentLists()||(t.selectedAbstractNumberingList=this.getSelectedAbstractNumberingList());const r=this.selection.activeSubDocument.getParagraphIndicesByIntervals(this.selection.intervals);let i=-1;for(let e=0;e<r.length;e++){const t=this.selection.activeSubDocument.paragraphs[r[e]];if(!t.isInList()){i=0;break}i=i<0?t.getListLevelIndex():Math.min(i,t.getListLevelIndex())}return t.currentLevel=i,t}areThereParagraphsInDifferentLists(){var e=-1,t=this.selection.activeSubDocument.getParagraphIndicesByIntervals(this.selection.intervals),r=t.length;for(let o=0;o<r;o++){var i=t[o],n=this.selection.activeSubDocument.paragraphs[i];if(n.isInList())if(-1!=e){if(e!=n.numberingListIndex)return!0}else e=n.numberingListIndex}return!1}getSelectedAbstractNumberingList(){var e=this.getFirstNumberingListIndex();return-1==e?null:this.control.modelManager.model.numberingLists[e].getAbstractNumberingList()}getFirstNumberingListIndex(){var e=this.selection.activeSubDocument.getParagraphIndicesByIntervals(this.selection.intervals);let t=e.length;for(let i=0;i<t;i++){let t=e[i];var r=this.selection.activeSubDocument.paragraphs[t];if(r.isInList())return r.numberingListIndex}return-1}applyParameters(e,t){let r=this.selection.activeSubDocument.getParagraphByPosition(this.selection.intervals[0].start);const i=r.getAbstractNumberingList();if(t.selectedAbstractNumberingList){if(this.selection.isCollapsed()&&r.isInList()){const n=r.getListLevelIndex(),o=new q0,a=t.selectedAbstractNumberingList.getListType()==tn.MultiLevel?t.selectedAbstractNumberingList:i;o.init(this.colorProvider,a),o.levels[n].copyFrom(o.initLevel(this.colorProvider,t.selectedAbstractNumberingList.levels[n]));new K0(this.control).applyParameters(e,o)}else this.control.commandManager.getCommand(FF.InsertNumerationToParagraphs).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,t.selectedAbstractNumberingList));return!0}return null===t.selectedAbstractNumberingList&&(this.control.commandManager.getCommand(FF.DeleteNumerationFromParagraphs).execute(this.control.commandManager.isPublicApiCall),!0)}getDialogName(){return"NumberingList"}}class j1 extends GZ{constructor(){super(...arguments),this.currentLevel=0}copyFrom(e){super.copyFrom(e),this.selectedAbstractNumberingList=e.selectedAbstractNumberingList}clone(){const e=new j1;return e.copyFrom(this),e}applyConverter(e){return this}}class X1 extends XZ{getState(){const e=new VU(this.isEnabled(),f.ListUtils.deepCopy(this.selection.intervalsInfo.intervals));return e.visible=Bb.isVisible(this.control.modelManager.richOptions.control.paragraphFormatting),e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphFormatting)}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}createParameters(e){var t=new G1;return t.init(this.colorProvider,this.inputPosition.getMergedParagraphPropertiesRaw(),this.inputPosition.getMergedSectionPropertiesRaw()),t}applyParameters(e,t,r){const i=new Rt;return i.leftIndent=this.getLeftIndent(t,r),i.alignment=null!=t.alignment&&t.alignment!==r.alignment?t.alignment:void 0,i.contextualSpacing=null!=t.contextualSpacing&&t.contextualSpacing!==r.contextualSpacing?t.contextualSpacing:void 0,i.firstLineIndent=null!=t.firstLineIndent&&t.firstLineIndent!==r.firstLineIndent?t.firstLineIndent:void 0,i.firstLineIndentType=null!=t.firstLineIndentType&&t.firstLineIndentType!==r.firstLineIndentType?t.firstLineIndentType:void 0,i.keepLinesTogether=t.keepLinesTogether!==r.keepLinesTogether?t.keepLinesTogether:void 0,i.spacingAfter=null!=t.spacingAfter&&t.spacingAfter!==r.spacingAfter?t.spacingAfter:void 0,i.spacingBefore=null!=t.spacingBefore&&t.spacingBefore!==r.spacingBefore?t.spacingBefore:void 0,i.pageBreakBefore=t.pageBreakBefore!==r.pageBreakBefore?t.pageBreakBefore:void 0,i.rightIndent=null!=t.rightIndent&&t.rightIndent!==r.rightIndent?t.rightIndent:void 0,i.outlineLevel=t.outlineLevel!==r.outlineLevel?t.outlineLevel:void 0,i.lineSpacingType=null!=t.lineSpacingType&&t.lineSpacingType!==r.lineSpacingType?t.lineSpacingType:void 0,i.widowOrphanControl=t.widowOrphanControl!==r.widowOrphanControl?t.widowOrphanControl:void 0,i.shadingInfo=t.backColor!==r.backColor?fe.createByColor(he.makeByColor(null==t.backColor?y.AUTOMATIC_COLOR:w.i.fromString(t.backColor))):void 0,t.lineSpacingType!==Ne.AtLeast&&t.lineSpacingType!==Ne.Exactly||null==t.lineSpacing||void 0===i.lineSpacingType&&t.lineSpacing===r.lineSpacing?t.lineSpacingType!==Ne.Multiple||null==t.lineSpacingMultiple||void 0===i.lineSpacingType&&t.lineSpacingMultiple===r.lineSpacingMultiple?i.lineSpacing=void 0:i.lineSpacing=t.lineSpacingMultiple:i.lineSpacing=t.lineSpacing,new Eb(this.control.modelManager,this.inputPosition,i,this.control.selection.activeSubDocument,this.control.selection.intervals).apply()}getDialogName(){return"EditParagraph"}getLeftIndent(e,t){if(null==e.leftIndent)return;const r=this.getLeftIndentCore(e);return r!==t.leftIndent||e.firstLineIndentType!==t.firstLineIndentType?r:void 0}getLeftIndentCore(e){return e.firstLineIndentType===ke.Hanging&&(0,S.isDefined)(e.leftIndent)&&(0,S.isDefined)(e.firstLineIndent)?e.leftIndent+e.firstLineIndent:e.leftIndent}}class G1 extends GZ{init(e,t,r){switch(this.alignment=t.alignment,this.outlineLevel=t.outlineLevel,this.rightIndent=t.rightIndent,this.spacingAfter=t.spacingAfter,this.spacingBefore=t.spacingBefore,this.lineSpacingType=t.lineSpacingType,this.firstLineIndentType=t.firstLineIndentType,this.firstLineIndent=t.firstLineIndent,this.contextualSpacing=t.contextualSpacing,this.keepLinesTogether=t.keepLinesTogether,this.pageBreakBefore=t.pageBreakBefore,this.pageWidth=r.pageWidth-r.marginLeft-r.marginRight,this.leftIndent=this.getLeftIndent(t),this.backColor=(0,S.isDefined)(t.shadingInfo)?this.getColor(t.shadingInfo.getActualColor(e)):void 0,this.widowOrphanControl=t.widowOrphanControl,t.lineSpacingType){case Ne.AtLeast:case Ne.Exactly:this.lineSpacing=t.lineSpacing,this.lineSpacingMultiple=3;break;case Ne.Multiple:this.lineSpacing=240,this.lineSpacingMultiple=t.lineSpacing;break;default:this.lineSpacing=240,this.lineSpacingMultiple=3}}copyFrom(e){super.copyFrom(e),this.alignment=e.alignment,this.outlineLevel=e.outlineLevel,this.rightIndent=e.rightIndent,this.spacingBefore=e.spacingBefore,this.spacingAfter=e.spacingAfter,this.lineSpacingType=e.lineSpacingType,this.firstLineIndentType=e.firstLineIndentType,this.firstLineIndent=e.firstLineIndent,this.contextualSpacing=e.contextualSpacing,this.keepLinesTogether=e.keepLinesTogether,this.pageBreakBefore=e.pageBreakBefore,this.pageWidth=e.pageWidth,this.leftIndent=e.leftIndent,this.lineSpacing=e.lineSpacing,this.lineSpacingMultiple=e.lineSpacingMultiple,this.backColor=e.backColor,this.widowOrphanControl=e.widowOrphanControl}clone(){const e=new G1;return e.copyFrom(this),e}applyConverter(e){return this.pageWidth&&(this.pageWidth=e(this.pageWidth)),this.firstLineIndent&&(this.firstLineIndent=e(this.firstLineIndent)),this.leftIndent&&(this.leftIndent=e(this.leftIndent)),this.lineSpacing&&(this.lineSpacing=e(this.lineSpacing)),this.rightIndent&&(this.rightIndent=e(this.rightIndent)),this.spacingAfter&&(this.spacingAfter=e(this.spacingAfter)),this.spacingBefore&&(this.spacingBefore=e(this.spacingBefore)),this}getColor(e){return e===y.AUTOMATIC_COLOR?null:null!=e?w.i.colorToHash(e).toUpperCase():void 0}getLeftIndent(e){return e.firstLineIndentType===ke.Hanging&&(0,S.isDefined)(e.leftIndent)&&(0,S.isDefined)(e.firstLineIndent)?e.leftIndent-e.firstLineIndent:e.leftIndent}}class K1 extends XZ{getState(){let e=this.control.spellChecker.getSelectedMisspelledInterval(this.selection.intervals),t=new UU(this.isEnabled(),e);return t.visible=null!==e,t}isEnabled(){return super.isEnabled()&&this.control.spellChecker.settings.isEnabled}createParameters(e){var t=new q1;return t.controller=new $1(this.control,this.control.spellChecker),t}applyParameters(e,t){return!0}getDialogName(){return"Spelling"}}class q1 extends GZ{copyFrom(e){super.copyFrom(e),this.controller=e.controller}clone(){const e=new q1;return e.copyFrom(this),e}applyConverter(e){return this}}class $1{get isRepeatingError(){return this.misspelledInterval.errorInfo.errorType==Wc.Repeating}get canAddToDictionary(){return this.control.commandManager.getCommand(FF.AddWordToDictionary).getState().enabled}get suggestions(){return this.misspelledInterval.errorInfo.suggestions}constructor(e,t){this.control=e,this.spellChecker=t}tryFindNextError(){return this.misspelledInterval=this.spellChecker.findNextMisspelledInterval(this.control.selection.intervals[0].start),this.misspelledInterval?(this.control.selection.deprecatedSetSelection(this.misspelledInterval.start,this.misspelledInterval.end,!1,-1,!0),!0):(this.control.commandManager.getCommand(FF.ShowSpellingCheckCompletedMessage).execute(this.control.commandManager.isPublicApiCall),!1)}getContext(){return this.misspelledInterval.errorInfo.word}ignoreOnce(){this.control.commandManager.getCommand(FF.IgnoreSpellingError).execute(this.control.commandManager.isPublicApiCall)}ignoreAll(){this.control.commandManager.getCommand(FF.IgnoreAllSpellingErrors).execute(this.control.commandManager.isPublicApiCall)}addToDictionary(){this.control.commandManager.getCommand(FF.AddWordToDictionary).execute(this.control.commandManager.isPublicApiCall)}delete(){this.control.commandManager.getCommand(FF.DeleteRepeatedWord).execute(this.control.commandManager.isPublicApiCall)}change(e){this.control.commandManager.getCommand(FF.ChangeSpellingError).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,e))}changeAll(e){this.control.commandManager.getCommand(FF.ChangeAllSpellingErrors).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,e))}}class J1 extends XZ{getState(){const e=this.selection.tableInfo.rawData.isSquare&&!this.selection.specialRunInfo.isPictureSelected();let t=new UU(this.isEnabled()&&e);return t.visible=e,t}createParameters(e){const t=this.selection.tableInfo,r=new Y1;return r.rowCount=t.rawData.numRows,r.columnCount=t.rawData.rows[0].columnCountInSeries,r.isMergeBeforeSplit=t.rawData.numRows>1||t.rawData.rows[0].cells.length>1,r.disableRowsSelector=!t.extendedData.isSquare,r.availableRowNumber=r.disableRowsSelector?1:t.rawData.numRows,r}applyParameters(e,t){return this.control.commandManager.getCommand(FF.SplitTableCellsCommand).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,t))}getDialogName(){return"SplitTableCells"}}class Y1 extends GZ{copyFrom(e){super.copyFrom(e),this.rowCount=e.rowCount,this.columnCount=e.columnCount,this.isMergeBeforeSplit=e.isMergeBeforeSplit}clone(){const e=new Y1;return e.copyFrom(this),e}applyConverter(e){return this}}class Q1 extends XZ{getDialogName(){return"Symbols"}}class Z1 extends Q1{getState(){return new VU(this.isEnabled(),f.ListUtils.deepCopy(this.selection.intervalsInfo.intervals))}createParameters(e){var t=this.inputPosition.getMergedCharacterPropertiesRaw(),r=new t2;return r.fontName=t.fontInfo?t.fontInfo.name:this.control.modelManager.model.defaultCharacterProperties.fontInfo.name,r}applyParameters(e,t){this.history.beginTransaction();var r=this.modelManipulator,i=this.inputPosition.getMaskedCharacterProperties(),n=this.control.modelManager.model.cache.fontInfoCache.getItemByName(t.fontName)||null;i.fontInfo=n,i.setUseValue(ie.UseFontName,!0);for(let t,i=0;t=e.intervals[i];i++)t.length>0&&this.history.addAndRedo(new Xt(r,new gu(this.selection.activeSubDocument,t),n,!0));return this.control.commandManager.getCommand(FF.InsertText).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,t.symbol)),this.history.endTransaction(),!0}}class e2 extends Q1{createParameters(e){this.dialogCustomNumberingListParameters=e.param;var t=new t2;return t.fontName=e.param.levels[e.param.currentLevel].fontName,t}applyParameters(e,t){var r=this.dialogCustomNumberingListParameters.levels[this.dialogCustomNumberingListParameters.currentLevel];return r.fontName=t.fontName,r.displayFormatString=t.symbol,!1}afterClosing(){var e=FF.ShowCustomNumberingListForm;this.control.commandManager.getCommand(e).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,this.dialogCustomNumberingListParameters))}}class t2 extends GZ{copyFrom(e){super.copyFrom(e),this.symbol=e.symbol,this.fontName=e.fontName}clone(){const e=new t2;return e.copyFrom(this),e}applyConverter(e){return this}}class r2{static getColumnsRangeBySelectedRow(e,t){const r=e.tableCellInfos[t.rowIndex],i=f.ListUtils.last(t.cells);return new Cn.e(r[t.cells[0].cellIndex].getGridCellIndex(),r[i.cellIndex].getGridCellIndex()+i.cell.columnSpan)}static getColumnsRangeBySelectedCells(e){return f.ListUtils.accumulate(e.rows,null,((t,r)=>{const i=r2.getColumnsRangeBySelectedRow(e.info.gridInfoManager,r);return t?new Cn.e(Math.max(i.start,t.start),Math.min(i.end,t.end)):i}))}}class i2 extends XZ{getState(){let e=new UU(this.isEnabled());return e.visible=this.selection.tableInfo.extendedData.numRows>0&&!this.selection.specialRunInfo.isPictureSelected(),e}createParameters(e){let t=new o2;const r=this.selection.tableInfo.table,i=e.subDocument,n=r.parentCell?r.parentCell.endParagrapPosition.value:this.selection.intervals[0].start;let o=i.isMain()?new ug(this.control.layout,i,n,Hu.Row).create((new cg).setDefault(!1),(new cg).setDefault(!1)):new pg(this.control.layout,i,n,this.selection.pageIndex,Hu.Row).create((new cg).setDefault(!1),(new cg).setDefault(!1)),a=g.u.pixelsToTwipsF(r.parentCell?o.row.width:SD.findSectionColumnWithMinimumWidth(o.pageArea.columns));return t.init(this.selection.tableInfo,this.control.modelManager.model,a,this.getInitialTab()),t}applyParameters(e,t,r){const i=this.modelManipulator,n=this.selection.activeSubDocument,o=this.selection.tableInfo,a=o.table,s=this.history;if(!n.isEditable([on.FixedInterval.fromPositions(a.getStartPosition(),a.getEndPosition())]))return!1;let l=!1;if(s.beginTransaction(),t.tablePreferredWidth=this.getActualPreferredWidth(t.useDefaultTableWidth,t.tablePreferredWidth),t.tablePreferredWidth&&!t.tablePreferredWidth.equals(r.tablePreferredWidth)&&(s.addAndRedo(new Jm(i,n,a.index,t.tablePreferredWidth)),l=!0),void 0!==t.tableRowAlignment&&null!==t.tableRowAlignment&&t.tableRowAlignment!==r.tableRowAlignment){s.addAndRedo(new tf(i,n,a.index,t.tableRowAlignment,!0));for(let e=0;e<a.rows.length;e++)s.addAndRedo(new Kd(i,n,a.index,e,t.tableRowAlignment,!0));l=!0}if(t.tableRowAlignment&&t.tableRowAlignment===je.Left||(t.tableIndent=0),t.tableIndent!==r.tableIndent){let e=lr.create(t.tableIndent,Je.ModelUnits);s.addAndRedo(new $m(i,n,a.index,e,!0)),l=!0}if(t.allowCellSpacing||(t.cellSpacing=0),void 0!==t.cellSpacing&&t.cellSpacing!==r.cellSpacing){let e;e=t.allowCellSpacing?lr.create(t.cellSpacing/2,Je.ModelUnits):n.documentModel.defaultTableProperties.cellSpacing.clone(),s.addAndRedo(new qm(i,n,a.index,e,!0));for(let t=0;t<a.rows.length;t++)s.addAndRedo(new Xd(i,n,a.index,t,e,!0));l=!0}let d=t.resizeToFitContent?Oe.Autofit:Oe.Fixed;if(d!==a.properties.layoutType&&(s.addAndRedo(new Qm(i,n,a.index,d,!0)),l=!0),t.defaultCellMarginTop!==r.defaultCellMarginTop||t.defaultCellMarginRight!==r.defaultCellMarginRight||t.defaultCellMarginBottom!==r.defaultCellMarginBottom||t.defaultCellMarginLeft!==r.defaultCellMarginLeft){let e=[lr.create(t.defaultCellMarginTop,Je.ModelUnits),lr.create(t.defaultCellMarginRight,Je.ModelUnits),lr.create(t.defaultCellMarginBottom,Je.ModelUnits),lr.create(t.defaultCellMarginLeft,Je.ModelUnits)];s.addAndRedo(new Km(i,n,a.index,e,[!0,!0,!0,!0])),l=!0}if(t.rowHeight=this.getActualRowHeight(t.useDefaultRowHeight,t.rowHeight),f.ListUtils.forEach(o.extendedData.rows,(e=>{const o=a.rows[e.rowIndex];t.rowHeight&&!o.height.equals(t.rowHeight)&&(s.addAndRedo(new jd(i,n,a.index,e.rowIndex,t.rowHeight)),l=!0),void 0!==t.cantSplit&&t.cantSplit!=r.cantSplit&&(s.addAndRedo(new Gd(i,n,a.index,e.rowIndex,t.cantSplit,!0)),l=!0)})),t.columnPreferredWidth=this.getActualPreferredWidth(t.useDefaultColumnWidth,t.columnPreferredWidth),t.columnPreferredWidth){const e=r2.getColumnsRangeBySelectedCells(o.extendedData);e.isNormalized()&&f.ListUtils.forEach(a.rows,((r,o)=>{f.ListUtils.forEach(oc.getCellIndicesByColumnsRange(r,e),(e=>{r.cells[e].preferredWidth.equals(t.columnPreferredWidth)||(s.addAndRedo(new tc(i,n,a.index,o,e,t.columnPreferredWidth)),l=!0)}))}))}return t.cellPreferredWidth=this.getActualPreferredWidth(t.useDefaultCellWidth,t.cellPreferredWidth),o.extendedData.foreach((()=>{}),((e,o)=>{const d=e.cell;if(!t.cellPreferredWidth||d.preferredWidth.equals(t.cellPreferredWidth)||t.cellPreferredWidth.equals(r.cellPreferredWidth)||(s.addAndRedo(new tc(i,n,a.index,o.rowIndex,e.cellIndex,t.cellPreferredWidth)),l=!0),d.verticalMerging===Xe.Restart){let r=o.rowIndex+1;for(;a.rows[r];){let o=oc.getCellIndexByColumnIndex(a.rows[r],e.cellIndex),d=a.rows[r].cells[o];if(d.verticalMerging!==Xe.Continue)break;t.cellPreferredWidth&&!d.preferredWidth.equals(t.cellPreferredWidth)&&(s.addAndRedo(new tc(i,n,a.index,r,o,t.cellPreferredWidth)),l=!0),r++}}if(void 0!==t.cellVerticalAlignment&&null!==t.cellVerticalAlignment&&t.cellVerticalAlignment!==r.cellVerticalAlignment&&(s.addAndRedo(new ic(i,n,a.index,o.rowIndex,e.cellIndex,t.cellVerticalAlignment,!0)),l=!0),void 0!==t.cellNoWrap&&t.cellNoWrap!=r.cellNoWrap&&(s.addAndRedo(new rc(i,n,a.index,o.rowIndex,e.cellIndex,t.cellNoWrap,!0)),l=!0),t.cellMarginsSameAsTable){let t=n.documentModel.defaultTableCellProperties.cellMargins;if(!t.equals(d.properties.cellMargins)){let r=[t.top.clone(),t.right.clone(),t.bottom.clone(),t.left.clone()];s.addAndRedo(new Zd(i,n,a.index,o.rowIndex,e.cellIndex,r,[!1,!1,!1,!1])),l=!0}}else if(t.cellMarginTop!==r.cellMarginTop||t.cellMarginRight!==r.cellMarginRight||t.cellMarginBottom!==r.cellMarginBottom||t.cellMarginLeft!==r.cellMarginLeft){let r=[lr.create(t.cellMarginTop,Je.ModelUnits),lr.create(t.cellMarginRight,Je.ModelUnits),lr.create(t.cellMarginBottom,Je.ModelUnits),lr.create(t.cellMarginLeft,Je.ModelUnits)];s.addAndRedo(new Zd(i,n,a.index,o.rowIndex,e.cellIndex,r,[!0,!0,!0,!0])),l=!0}})),s.endTransaction(),l}getActualPreferredWidth(e,t){return null===e?null:!0===e?lr.create(0,Je.Auto):t}getActualRowHeight(e,t){return null===e?null:!0===e?dr.createDefault():t}getInitialTab(){return wZ.Table}getDialogName(){return"TableProperties"}}class n2 extends i2{getInitialTab(){return wZ.Cell}}class o2 extends GZ{init(e,t,r,i){const n=e.table;this.tableInit(n,t),this.rowInit(e,t),this.columnInit(e),this.cellInit(e,t),this.maxTableWidth=r,this.initialTab=i,this.isNestedTable=n.nestedLevel>0}tableInit(e,t){this.useDefaultTableWidth=e.preferredWidth.type===Je.Auto||e.preferredWidth.type===Je.Nil,this.tablePreferredWidth=e.preferredWidth.clone(),this.tableRowAlignment=$a.getTableAlignment(e);const r=e.getActualTableIndent(t.defaultTableProperties);this.tableIndent=r.type===Je.ModelUnits?r.value:0,this.cellSpacing=this.getCellSpacing(e,t),this.allowCellSpacing=0!==this.cellSpacing;const i=e.getActualTableLayout(t.defaultTableProperties);this.resizeToFitContent=i===Oe.Autofit,this.defaultCellMarginLeft=e.getActualLeftMargin(t.defaultTableProperties).value,this.defaultCellMarginRight=e.getActualRightMargin(t.defaultTableProperties).value,this.defaultCellMarginTop=e.getActualTopMargin(t.defaultTableProperties).value,this.defaultCellMarginBottom=e.getActualBottomMargin(t.defaultTableProperties).value}getCellSpacing(e,t){let r=e.rows[0],i=new Xa(t,e,r.tablePropertiesException).getProperty(r.properties,e.style,qe.FirstRow,t.defaultTableRowProperties);for(let r,n=0;r=e.rows[n];n++){let n=new Xa(t,e,r.tablePropertiesException).getProperty(r.properties,e.style,r.conditionalFormatting,t.defaultTableRowProperties);if(!i.equals(n))return null}return i.type===Je.ModelUnits?2*i.value:0}rowInit(e,t){const r=e.table;let i=!0,n=!0,o=new Ga,a=r.rows[e.extendedData.startRowIndex],s=o.getProperty(a.properties,r.style,a.conditionalFormatting,t.defaultTableRowProperties),l=a.height.clone();f.ListUtils.reverseForEach(e.extendedData.rows,(e=>{let a=r.rows[e.rowIndex],d=o.getProperty(a.properties,r.style,a.conditionalFormatting,t.defaultTableRowProperties);i=a.height.equals(l),n=n&&s===d}),e.extendedData.rows.length-1,1),this.useDefaultRowHeight=i?0===l.value:null,this.cantSplit=n?s:null,this.rowHeight=dr.create(i?l.value:0,l.type===$e.Exact?$e.Exact:$e.Minimum)}columnInit(e){const t=e.table;let r=!0;const i=r2.getColumnsRangeBySelectedCells(e.extendedData);let n=null;for(let e,o=0;e=t.rows[o];o++){let a=oc.getCellIndicesByColumnsRange(e,i);for(let e=0;e<a.length;e++){let i=a[e];null===n?n=t.rows[o].cells[i].preferredWidth:r=r&&t.rows[o].cells[i].preferredWidth.equals(n)}}this.useDefaultColumnWidth=r?n.type===Je.Auto:null,this.columnPreferredWidth=n.clone()}cellInit(e,t){const r=e.table;this.cellMarginsSameAsTable=!0;let i=!0,n=!0,o=!0,a=!0,s=!0,l=!0,d=!0,c=new Yr,h=new Zr,u=e.extendedData.firstCell,p=u.preferredWidth.clone(),g=h.getProperty(u.properties,r.style,u.conditionalFormatting,t.defaultTableCellProperties),m=c.getProperty(u.properties,r.style,u.conditionalFormatting,t.defaultTableCellProperties),b=this.getActualCellMargins(r,u,t);f.ListUtils.forEach(e.extendedData.rows,(e=>{f.ListUtils.forEach(e.cells,(e=>{const u=e.cell;i=i&&p.equals(u.preferredWidth);let f=h.getProperty(u.properties,r.style,u.conditionalFormatting,t.defaultTableCellProperties);n=n&&g===f;let C=c.getProperty(u.properties,r.style,u.conditionalFormatting,t.defaultTableCellProperties);o=o&&m===C;let S=this.getActualCellMargins(r,u,t);l=l&&b.top.equals(S.top),s=s&&b.right.equals(S.right),d=d&&b.bottom.equals(S.bottom),a=a&&b.left.equals(S.left),(u.properties.getUseValue(Ye.UseTopMargin)||u.properties.getUseValue(Ye.UseRightMargin)||u.properties.getUseValue(Ye.UseBottomMargin)||u.properties.getUseValue(Ye.UseLeftMargin))&&(this.cellMarginsSameAsTable=!1)}))})),this.useDefaultCellWidth=i?p.type===Je.Auto:null,this.cellPreferredWidth=p,this.cellVerticalAlignment=n?g:null,this.cellNoWrap=o?m:null,this.cellMarginTop=l?b.top.value:null,this.cellMarginRight=s?b.right.value:null,this.cellMarginBottom=d?b.bottom.value:null,this.cellMarginLeft=a?b.left.value:null}getActualCellMargins(e,t,r){const i=t.getActualLeftCellMargin(r).clone(),n=t.getActualRightCellMargin(r).clone(),o=t.getActualTopCellMargin(r).clone(),a=t.getActualBottomCellMargin(r).clone();return ar.create(o,n,a,i)}copyFrom(e){super.copyFrom(e),this.useDefaultTableWidth=e.useDefaultTableWidth,this.tablePreferredWidth=e.tablePreferredWidth.clone(),this.tableRowAlignment=e.tableRowAlignment,this.tableIndent=e.tableIndent,this.cellSpacing=e.cellSpacing,this.allowCellSpacing=e.allowCellSpacing,this.resizeToFitContent=e.resizeToFitContent,this.defaultCellMarginLeft=e.defaultCellMarginLeft,this.defaultCellMarginRight=e.defaultCellMarginRight,this.defaultCellMarginTop=e.defaultCellMarginTop,this.defaultCellMarginBottom=e.defaultCellMarginTop,this.useDefaultRowHeight=e.useDefaultRowHeight,this.rowHeight=e.rowHeight.clone(),this.cantSplit=e.cantSplit,this.useDefaultColumnWidth=e.useDefaultColumnWidth,this.columnPreferredWidth=e.columnPreferredWidth.clone(),this.useDefaultCellWidth=e.useDefaultCellWidth,this.cellPreferredWidth=e.cellPreferredWidth.clone(),this.cellVerticalAlignment=e.cellVerticalAlignment,this.cellNoWrap=e.cellNoWrap,this.cellMarginLeft=e.cellMarginLeft,this.cellMarginRight=e.cellMarginRight,this.cellMarginTop=e.cellMarginTop,this.cellMarginBottom=e.cellMarginBottom,this.cellMarginsSameAsTable=e.cellMarginsSameAsTable,this.maxTableWidth=e.maxTableWidth,this.initialTab=e.initialTab,this.isNestedTable=e.isNestedTable}clone(){const e=new o2;return e.copyFrom(this),e}applyConverter(e){return this.tablePreferredWidth&&this.tablePreferredWidth.type===Je.ModelUnits&&(this.tablePreferredWidth.value=e(this.tablePreferredWidth.value)),this.tableIndent&&(this.tableIndent=e(this.tableIndent)),this.cellSpacing&&(this.cellSpacing=e(this.cellSpacing)),this.defaultCellMarginLeft&&(this.defaultCellMarginLeft=e(this.defaultCellMarginLeft)),this.defaultCellMarginRight&&(this.defaultCellMarginRight=e(this.defaultCellMarginRight)),this.defaultCellMarginTop&&(this.defaultCellMarginTop=e(this.defaultCellMarginTop)),this.defaultCellMarginBottom&&(this.defaultCellMarginBottom=e(this.defaultCellMarginBottom)),this.rowHeight&&(this.rowHeight.value=e(this.rowHeight.value)),this.columnPreferredWidth&&this.columnPreferredWidth.type===Je.ModelUnits&&(this.columnPreferredWidth.value=e(this.columnPreferredWidth.value)),this.cellPreferredWidth&&this.cellPreferredWidth.type===Je.ModelUnits&&(this.cellPreferredWidth.value=e(this.cellPreferredWidth.value)),this.cellMarginTop&&(this.cellMarginTop=e(this.cellMarginTop)),this.cellMarginRight&&(this.cellMarginRight=e(this.cellMarginRight)),this.cellMarginBottom&&(this.cellMarginBottom=e(this.cellMarginBottom)),this.cellMarginLeft&&(this.cellMarginLeft=e(this.cellMarginLeft)),this.maxTableWidth&&(this.maxTableWidth=e(this.maxTableWidth)),this}}class a2{}a2.MinTableIndentByDefault=-21600,a2.MaxTableIndentByDefault=21600,a2.MinTableWidthByDefault=0,a2.MaxTableWidthInModelUnitsByDefault=31680,a2.MaxTableWidthInPercentByDefault=600,a2.MinRowHeightByDefault=0,a2.MaxRowHeightByDefault=31680,a2.MinColumnWidthByDefault=0,a2.MaxColumnWidthInModelUnitsByDefault=31680,a2.MaxColumnWidthInPercentByDefault=100,a2.MinCellWidthByDefault=0,a2.MaxCellWidthInModelUnitsByDefault=31680,a2.MaxCellWidthInPercentByDefault=100,function(e){e[e.Table=0]="Table",e[e.Row=1]="Row",e[e.Column=2]="Column",e[e.Cell=3]="Cell"}(wZ||(wZ={}));class s2 extends XZ{createParameters(e){var t=new l2;t.defaultTabStop=this.control.modelManager.model.defaultTabWidth;var r=this.selection.activeSubDocument.getParagraphIndicesByIntervals(this.selection.intervals);return this.paragraphsHasEqualTabProperties(r)?t.tabProperties=this.selection.activeSubDocument.paragraphs[r[0]].tabs.clone():t.tabProperties=new ts,t}applyParameters(e,t,r){var i=this.modelManipulator;this.history.beginTransaction(),t.defaultTabStop&&t.defaultTabStop!==r.defaultTabStop&&this.history.addAndRedo(new A0(i,t.defaultTabStop)),this.deleteAllTabs();var n=this.selection.activeSubDocument.getParagraphIndicesByIntervals(this.selection.intervals);for(let e,r=0;e=t.tabProperties.tabsInfo[r];r++)for(let t=n.length-1;t>=0;t--){let r=n[t],o=this.selection.activeSubDocument.paragraphs[r];this.history.addAndRedo(new nt(i,new gu(this.selection.activeSubDocument,o.interval),e))}return this.history.endTransaction(),!0}deleteAllTabs(){var e=this.modelManipulator,t=this.selection.activeSubDocument.getParagraphIndicesByIntervals(this.selection.intervals);for(let n=t.length-1;n>=0;n--){var r=this.selection.activeSubDocument.paragraphs[t[n]],i=r.interval;let o,a=r.getTabs();for(;o=a.positions.pop();)this.history.addAndRedo(new ot(e,new gu(this.selection.activeSubDocument,i),o))}}paragraphsHasEqualTabProperties(e){var t=this.selection.activeSubDocument.paragraphs[e[0]];for(let r=e.length-1;r>0;r--){let i=this.selection.activeSubDocument.paragraphs[e[r]];if(!t.tabs.equals(i.tabs))return!1}return!0}getDialogName(){return"Tabs"}}class l2 extends GZ{copyFrom(e){super.copyFrom(e),this.defaultTabStop=e.defaultTabStop,this.tabProperties=e.tabProperties.clone()}clone(){const e=new l2;return e.copyFrom(this),e}applyConverter(e){return this.defaultTabStop&&(this.defaultTabStop=e(this.defaultTabStop)),this}}class d2 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e){return this.control.owner.showQuickSearchPanel(),!0}isEnabledInReadOnlyMode(){return!0}}class c2 extends EU{getState(){var e=new UU(this.isEnabled());return e.value=this.control.modelManager.model.pageBackColor,e.denyUpdateValue=!0,e}executeCore(e,t){var r=t.param;return r!=this.control.modelManager.model.pageBackColor&&(this.history.addAndRedo(new N0(this.modelManipulator,r)),!0)}isEnabled(){return super.isEnabled()&&!this.control.modelManager.model.isDocumentProtectionEnabled}DEPRECATEDConvertOptionsParameter(e){return y.anyToColor(e,y.NO_COLOR)}}class h2 extends EU{isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.printing)&&this.control.modelManager.model.isLoaded()}isEnabledInReadOnlyMode(){return!0}constructor(e,t){super(e),this._nonce=t}getState(){return new UU(this.isEnabled())}getMode(e){return null!=e?e:this.control.modelManager.richOptions.printing.mode}getclosePrintDialogWithHtmlPreview(e){return null!=e?e:this.control.modelManager.richOptions.printing.closePrintDialogWithHtmlPreview}executeCore(e,t){if(this.control.commandManager.isPrintingProcessing)return!1;let r,i;this.control.commandManager.isPrintingProcessing=!0,"object"==typeof t.param&&null!=t.param?(r=this.getMode(t.param.mode),i=this.getclosePrintDialogWithHtmlPreview(t.param.closePrintDialogWithHtmlPreview)):(r=this.getMode(t.param),i=this.control.modelManager.richOptions.printing.closePrintDialogWithHtmlPreview);const n=r==rJ.ClientHtml;let o;n&&(o=window.open("","print",`height=${window.innerHeight},width=${window.innerWidth},tabbar=no`));let a=!1;this.control.innerClientProperties.viewsSettings.viewType==kV.Simple&&(a=!0,this.control.commandManager.getCommand(FF.SwitchToPrintLayoutView).execute(this.control.commandManager.isPublicApiCall));let s=!1;return this.control.innerClientProperties.showHiddenSymbols&&(s=!0,this.control.commandManager.getCommand(FF.ToggleShowWhitespace).execute(this.control.commandManager.isPublicApiCall)),this.control.commandManager.printTimerId=setTimeout((()=>{for(;!this.control.layout.isFullyFormatted;)this.control.layoutFormatterManager.forceFormatPage(this.control.layout.validPageCount+1);const e=b.j.toListBy(this.modelManipulator.model.subDocuments,(e=>new mu(e,[e.interval])));this.control.modelManager.richOptions.fields.updateFieldsBeforePrint?tq.updateFields(this,e,(()=>{this.printCore(n,o,i,a,s)}),new $g(!1,!1)):this.printCore(n,o,i,a,s)}),100),!0}printCore(e,t,r,i,n){e?this.generatePrintDocument(t,r):fH(this.control,((e,t)=>{window.navigator.msSaveOrOpenBlob&&!yH.Browser.Edge?window.navigator.msSaveOrOpenBlob(e,this.control.documentInfo.getFileNameForDownload()+".pdf"):this.control.pdfHelperFrame.showPrintDialog(URL.createObjectURL(e))}),(()=>{})),i&&this.control.commandManager.getCommand(FF.SwitchToSimpleView).execute(this.control.commandManager.isPublicApiCall),n&&this.control.commandManager.getCommand(FF.ToggleShowWhitespace).execute(this.control.commandManager.isPublicApiCall),this.control.commandManager.isPrintingProcessing=!1}generatePrintDocument(e,t){const r=this.control.layout.pages[0].height,i=this.control.layout.pages[0].width;let n=`<!DOCTYPE html>\n                <html moznomarginboxes mozdisallowselectionprint>\n                <head>\n                    <style ${this._nonce?`nonce="${this._nonce}"`:""}>\n                        html, body {\n                            margin: 0;\n                            width: ${i}px;\n                            height: ${r}px;\n                        }\n                        .dxrePageArea, .dxreColumn, .dxreRow, .dxreBox, .dxreBoxBg, .dxreParFrame, .dxreBoxSpace, .dxreAncPic,\n                        .dxreTable, .dxreTableCellBg, .dxreTableBrd, .dxreTextBoxBg {\n                            position:absolute;\n                        }\n                        .dxreTableRowCursor, .dxreTableColumnCursor { display: none; }\n                        ${this.createZIndexStyles()}\n                        br { display: none; }\n                        @page { margin: 0; size:${i}px ${i>r?r+4:r}px; }\n                        @media print { body { margin: 0; } }\n                    </style>\n                </head>\n                <body>\n                </body>\n                </html>`;e.document.write(n),e.document.close(),this.generatePrintContent().forEach((t=>{e.document.body.appendChild(t)})),e.focus();const o=setInterval((()=>{"complete"==e.document.readyState&&(e.print(),t&&!yH.Browser.AndroidMobilePlatform&&e.close(),clearInterval(o))}),100)}generatePrintContent(){const e=this.control.layout,t=new BE;for(let r,i=0;r=e.pages[i];i++){const e=g2.getPrintPageSize(r),n=e.width,o=e.height,a=this.control.viewManager.printLayoutRenderer.getPageRender(i,r),s=a.getElementsByClassName(Gj.MAIN_PAGE_AREA_CONTAINER)[0].cloneNode(!0),l=a.getElementsByClassName(Gj.FLOATING_OBJECTS_CONTAINER)[0].cloneNode(!0),d=a.getElementsByClassName(Gj.OTHER_PAGE_AREA_CONTAINER)[0].cloneNode(!0),c=a.getElementsByClassName(Gj.SHAPE_BG_CONTAINER)[0].cloneNode(!0);yH.Browser.IE?t.startChild("div").configure((e=>{e.style.cssText=`position: relative; margin:0px; display:block; width:${n}px; height:${o}px;`})).addElement(s).addElement(l).addElement(d).addElement(c).endChild("div").startChild("br").endChild("br"):t.startChild("svg","http://www.w3.org/2000/svg").configure((e=>{e.setAttribute("width",n.toString()),e.setAttribute("height",o.toString())})).startChild("foreignObject","http://www.w3.org/2000/svg").configure((e=>{e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width",n.toString()),e.setAttribute("height",o.toString())})).startChild("div").configure((e=>{e.setAttribute("xmlns","http://www.w3.org/1999/xhtml")})).addElement(s).addElement(l).addElement(d).addElement(c).endChild("div").endChild("foreignObject").endChild("svg")}return t.childElements}createZIndexStyles(){let e="",t=0;const r=["TextBoxBg","TblRowBg","TblCellBg","ParBg","BoxBg","BoxSpace","Box","TableBorder","AnchoredPicture","TextBox"];for(let i=0;i<=8;i++)for(let n,o=0;n=r[o];o++)e+=`.dxre${n}ZL${i} { z-index: ${t}; }\r\n`,t++;return e}}class u2{constructor(e,t,r=t,i=5,n=g.u.millimetersToPixel){this.paperKind=e,this.vertical=t,this.horizontal=r,this.accuracy=i,this.converterToPixels=n,t.applyConverter(n),r.applyConverter(n)}getDifference(e,t){const r=e?this.horizontal:this.vertical;return new so.Size(Math.abs(r.width-t.width),Math.abs(r.height-t.height))}isAccuracyAchieved(e){return e.width<this.accuracy&&e.height<this.accuracy}}class p2{constructor(e,t){this.pageSizeInfo=e,this.diff=t,this.maxDiff=Math.max(t.width,t.height)}}class g2{static getPrintPageSize(e){const t=e.width>e.height,r=f.ListUtils.reducedMap(g2.sizesList,(r=>{const i=r.getDifference(t,e);return r.isAccuracyAchieved(i)?new p2(r,i):null}));if(!r.length)return new so.Size(e.width,e.height);const i=f.ListUtils.minByCmp(r,((e,t)=>e.maxDiff-t.maxDiff)).pageSizeInfo;return t?i.horizontal:i.vertical}}g2.sizesList=[new u2(Vc.A4,new so.Size(210,296),new so.Size(297,209)),new u2(Vc.Letter,new so.Size(g.u.millimetersToPixel(216),g.u.millimetersToPixel(278)-1),new so.Size(g.u.millimetersToPixel(280),215),7,(e=>e))];class m2 extends EU{getState(e){return new UU(this.isEnabled()&&e.fieldIndex>=0)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)}executeCore(e,t){const r=t.subDocument.fields[t.fieldIndex];return this.modelManipulator.field.changeHyperlinkInfo(t.subDocument,r,t.hyperlinkInfo,t.text)}}class f2 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)&&this.control.modelManager.richOptions.mailMerge.isEnabled&&this.control.modelManager.richOptions.mailMerge.viewMergedData&&this.canNavigate()&&null==this.selection.activeSubDocument.fieldsWaitingForUpdate}canModify(){return!0}DEPRECATEDConvertOptionsParameter(e){return"number"==typeof e?e:this.control.modelManager.richOptions.mailMerge.activeRecordIndex}executeCore(e,t){var r=this.calculateNextRecordIndex(t.param);return this.control.modelManager.richOptions.mailMerge.activeRecordIndex=r,this.control.commandManager.getCommand(FF.UpdateAllFields).execute(this.control.commandManager.isPublicApiCall),!0}canNavigate(){return!0}calculateNextRecordIndex(e){return Math.min(e,this.control.modelManager.richOptions.mailMerge.recordCount-1)}}class b2 extends f2{canNavigate(){return this.control.modelManager.richOptions.mailMerge.activeRecordIndex>0}calculateNextRecordIndex(e){return 0}}class C2 extends f2{canNavigate(){return this.control.modelManager.richOptions.mailMerge.activeRecordIndex>0}calculateNextRecordIndex(e){return e-1}}class S2 extends f2{canNavigate(){return this.control.modelManager.richOptions.mailMerge.activeRecordIndex<this.control.modelManager.richOptions.mailMerge.recordCount-1}calculateNextRecordIndex(e){return e+1}}class I2 extends f2{canNavigate(){return this.control.modelManager.richOptions.mailMerge.activeRecordIndex<this.control.modelManager.richOptions.mailMerge.recordCount-1}calculateNextRecordIndex(e){return this.control.modelManager.richOptions.mailMerge.recordCount-1}}var P2,w2,y2=__webpack_require__(6795);class x2 extends EU{getState(){var e=this.selection.activeSubDocument,t=new UU(this.isEnabled());return t.value=yb.showHyperlinkItems(e.fields,this.selection.lastSelectedInterval),t.visible=null!==t.value,t}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.hyperlinks)}}class T2 extends x2{executeCore(e,t){let r;if(t.param)r=t.param;else{if(!e.visible)return!1;r=e.value}var i=r.getHyperlinkInfo();const n=this.selection.activeSubDocument.isEditable([r.getAllFieldInterval()]);if(!i.visited&&this.control.readOnly!=RF.Persistent&&n){var o=i.clone();o.visited=!0,this.history.beginTransaction(),this.history.addAndRedo(new hp(this.modelManipulator,this.selection.activeSubDocument,r.index,o)),this.history.endTransaction(),this.aspxForceSendingRequest()}if(i.isUri()){const e=(0,yd.EW)(this.control.modelManager);let t=i.getUriWithAnchor();yd.jE.isValid(t,e)||(t=yd.jE.EmptyPage),y2.R.navigate(t,"_blank")}else this.control.commandManager.getCommand(FF.GoToBookmark).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,i.anchor));return!0}isEnabledInReadOnlyMode(){return!0}aspxForceSendingRequest(){}}class v2 extends x2{executeCore(e,t){const r=e.value;return this.modelManipulator.field.removeHyperlink(this.selection.activeSubDocument,r),!0}}class M2 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.hyperlinks)}executeCore(e,t){var r=t.subDocument,i=r.fields;if(i.length<1)return!1;var n=this.history,o=t.intervalsInfo.interval,a=Math.max(0,Md.normedBinaryIndexOf(i,o.start)),s=i[a].getAbsolutelyTopLevelField(),l=new md(r.positionManager,o);return n.addTransaction((()=>{for(a=s.index;(s=i[a])&&s.getFieldStartPosition()<l.end;)s.getHyperlinkInfo()&&nn.IntervalAlgorithms.getIntersection(on.FixedInterval.fromPositions(s.getCodeStartPosition(),s.getResultEndPosition()),o)?n.addAndRedo(new Cb(this.modelManipulator,r,s)):a++})),this.selection.correctAfterTextBufferChanged(),l.destructor(r.positionManager),!0}DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.interval=this.selection.lastSelectedInterval}}class E2 extends EU{getState(){return new HU(this.isEnabled(),this.selection.lastSelectedInterval)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)}executeCore(e,t){return this.modelManipulator.field.setAllFieldsShowCode(this.baseValue(),b.j.toList(this.modelManipulator.model.subDocuments)),!0}baseValue(){return!0}isEnabledInReadOnlyMode(){return!0}}class D2 extends E2{baseValue(){return!1}}class F2 extends EU{getState(){return new HU(this.isEnabled(),this.selection.lastSelectedInterval)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)}executeCore(e,t){for(var r,i=[t.subDocument],n=!1,o=0;r=i[o];o++){var a=r.fields;a.length>0&&(n=!0);for(var s,l=0;s=a[l];l++)if(s.showCode)return this.control.commandManager.getCommand(FF.ShowAllFieldResults).execute(this.control.commandManager.isPublicApiCall,t),!0}return!!n&&(this.control.commandManager.getCommand(FF.ShowAllFieldCodes).execute(this.control.commandManager.isPublicApiCall,t),!0)}isEnabledInReadOnlyMode(){return!0}}class R2 extends EU{getState(){var e=new UU(this.isEnabled());return e.visible=yb.showUpdateAndToogleCodeItems(this.selection.activeSubDocument.fields,this.selection.intervals),e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)}executeCore(e,t){const r=t.param;var i=this.selection,n=t.subDocument,o=n.fields,a=t.intervalsInfo.intervals;let s="boolean"!=typeof t.param;for(var l,d=!1,c=0;l=a[c];c++)if(0==l.length){for(var h,u=Ed.getRelativeVisabilityInfo(l.start,o),p=u.length-1;h=u[p];p--){var g=h.field,m=-1;if(h.showResult&&(!0===r||s)?(g.showCode=!0,m=g.getCodeStartPosition()):h.showCode&&(!1===r||s)&&(g.showCode=!1,m=g.getFieldStartPosition()),m>=0){this.control.layoutFormatterManager.invalidator.onIntervalChanged(n.id,g.getAllFieldInterval()),n==this.selection.activeSubDocument&&i.deprecatedSetSelection(m,m,i.endOfLine,-1,!0),d=!0;break}}if(0==u.length)if((f=Md.normedBinaryIndexOf(o,l.start+1))>=0)(g=o[f]).parent||g.getFieldStartPosition()!=l.start||!s&&g.showCode===r||(g.showCode=!g.showCode,this.control.layoutFormatterManager.invalidator.onIntervalChanged(n.id,g.getAllFieldInterval()),n==this.selection.activeSubDocument&&i.deprecatedSetSelection(g.getFieldStartPosition(),g.getFieldStartPosition(),i.endOfLine,-1,!0),d=!0)}else{var f,b=l.end;for(g=o[f=Math.max(0,Md.normedBinaryIndexOf(o,l.start+1))];g.parent&&(l.start<g.getFieldStartPosition()||g.getFieldEndPosition()<=l.start);)g=g.parent;f=g.index;var C=s?!g.showCode:r;if(g.showCode!==C&&(g.showCode=C,this.control.layoutFormatterManager.invalidator.onIntervalChanged(n.id,g.getAllFieldInterval()),d=!0,g.getFieldStartPosition()!=l.start&&g.getAllFieldInterval().containsWithIntervalEnd(l.start))){var S=C?g.getCodeStartPosition():g.getFieldStartPosition();n==this.selection.activeSubDocument&&i.deprecatedSetSelection(S,S,i.endOfLine,-1,!0)}for(f++;(g=o[f])&&!(g.getFieldStartPosition()>=b);f++)g.getFieldEndPosition()<=l.start||g.showCode!==C&&(g.showCode=C,this.control.layoutFormatterManager.invalidator.onIntervalChanged(n.id,g.getAllFieldInterval()),d=!0)}return d}isEnabledInReadOnlyMode(){return!0}}class L2 extends EU{getState(){var e=new UU(this.isEnabled());return e.value=this.control.modelManager.richOptions.mailMerge.viewMergedData,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)&&this.control.modelManager.richOptions.mailMerge.isEnabled}canModify(){return!0}DEPRECATEDConvertOptionsParameter(e){const t=this.control.modelManager.richOptions.mailMerge;return"boolean"==typeof e?e:!t.viewMergedData}executeCore(e,t){var r=this.control.modelManager.richOptions.mailMerge;let i=t.param;return r.viewMergedData!==i&&(r.viewMergedData=i,this.control.commandManager.getCommand(FF.UpdateAllFields).execute(this.control.commandManager.isPublicApiCall),!0)}}class B2 extends tq{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)}executeCore(e,t){const r=b.j.toListBy(this.modelManipulator.model.subDocuments,(e=>new mu(e,[e.interval]))),i=this.selection.getFloatingState();return tq.updateFields(this,r,(()=>{const e=i.finalize();this.selection.setState(e),t.param&&t.param()}),new $g)}}class A2 extends EU{getState(){return new HU(this.isEnabled(),this.selection.lastSelectedInterval)}isEnabled(){const e=eq.findTocFieldBySelection(this.selection.activeSubDocument,this.selection);return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)&&null!=e}executeCore(e,t){const r=this.selection.activeSubDocument,i=eq.findTocFieldBySelection(r,this.selection);if(!i)return!1;this.history.beginTransaction();const n=new rq(r,[i.getAllFieldInterval()],(()=>{this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(i.getFieldStartPosition()).setEndOfLine(!1)))}));n.options.updateFillIn=!1;const o=this.control.commandManager.getCommand(FF.UpdateField).execute(this.control.commandManager.isPublicApiCall,n);return this.history.endTransaction(),o}}class N2 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){return this.selection.searchIntervals.length&&this.selection.resetSearchSelection(),!0}isEnabledInReadOnlyMode(){return!0}}class k2 extends EU{getState(){let e;return this.isEnabled()&&(e=this.getValue()),new UU(this.isEnabled(),e)}canModify(){return!0}isEnabled(){const e=this.selection.specialRunInfo;return super.isEnabled()&&e.isSelected()&&e.isSelectedAnchorObject&&this.getFloatingObjectParentSubDocument().isEditable([new on.FixedInterval(e.getPosition(),1)])}executeCore(e,t){let r=this.modelManipulator,i=this.selection.specialRunInfo;return this.history.addAndRedo(new wS(r,new gu(i.getParentSubDocument(),new on.FixedInterval(i.getPosition(),1)),t.param)),!0}getValue(){let e=this.selection.specialRunInfo;return e.getParentSubDocument().getRunByPosition(e.getPosition()).shape.clone()}}class O2 extends EU{getState(){let e;if(this.isEnabled()){let r=this.selection.specialRunInfo;var t=r.getParentSubDocument().getRunByPosition(r.getPosition());e=this.getValue(t.shape)}return new UU(this.isEnabled(),e)}isEnabled(){const e=this.selection.specialRunInfo;return super.isEnabled()&&e.isSelected()&&e.isSelectedAnchorObject}}class _2 extends O2{getState(){const e=super.getState();return e.denyUpdateValue=!0,e}DEPRECATEDConvertOptionsParameter(e){return y.anyToColor(e,y.NO_COLOR)}executeCore(e,t){const r=this.selection.specialRunInfo;return this.modelManipulator.picture.changeShapeFillColor(r.getParentSubDocument(),r.getPosition(),t.param),!0}getValue(e){return e.fillColor}}class U2 extends O2{getState(){const e=super.getState();return e.denyUpdateValue=!0,e}DEPRECATEDConvertOptionsParameter(e){return y.anyToColor(e,y.NO_COLOR)}executeCore(e,t){const r=this.selection.specialRunInfo;return this.modelManipulator.picture.changeShapeOutlineColor(r.getParentSubDocument(),r.getPosition(),t.param),!0}getValue(e){return e.outlineColor}}class H2 extends O2{executeCore(e,t){const r=this.selection.specialRunInfo;return this.modelManipulator.picture.changeShapeOutlineWidth(r.getParentSubDocument(),r.getPosition(),t.param),!0}getValue(e){return e.outlineWidth}}class V2 extends EU{getState(){let e;return this.isEnabled()&&(e=this.getValue()),new UU(this.isEnabled(),e)}canModify(){return!0}isEnabled(){const e=this.selection.specialRunInfo;return super.isEnabled()&&e.isTextBoxSelected()&&this.getFloatingObjectParentSubDocument().isEditable([new on.FixedInterval(e.getPosition(),1)])}executeCore(e,t){let r=this.modelManipulator,i=this.selection.specialRunInfo.getParentSubDocument();return this.history.addAndRedo(new H1(r,new gu(i,new on.FixedInterval(this.selection.specialRunInfo.getTextBoxPosition(),1)),t.param)),!0}getValue(){let e=this.selection.specialRunInfo;return e.getParentSubDocument().getRunByPosition(e.getTextBoxPosition()).textBoxProperties.clone()}}class W2 extends EU{getState(){const e=this.selection.specialRunInfo,t=new UU(!this.selection.activeSubDocument.isTextBox(),!1);return t.visible=e.isSelected()&&t.enabled&&this.getFloatingObjectParentSubDocument().isEditable([new on.FixedInterval(e.getPosition(),1)]),t}canModify(){return!0}executeCore(e,t){return!1}}class z2 extends W2{}class j2 extends W2{}class X2 extends W2{}class G2 extends EU{isBehindDoc(){throw new Error(R.D.NotImplemented)}getState(){return new UU(this.isEnabled())}canModify(){return!0}isEnabled(){const e=this.selection.specialRunInfo;return super.isEnabled()&&e.isSelected()&&e.isSelectedAnchorObject&&this.getFloatingObjectParentSubDocument().isEditable([new on.FixedInterval(e.getPosition(),1)])}executeCore(e,t){const r=this.modelManipulator,i=this.selection.specialRunInfo.getParentSubDocument(),n=this.selection.specialRunInfo.getPosition(),o=i.getRunByPosition(n);return o&&o.anchorInfo.isBehindDoc!=this.isBehindDoc()&&this.history.addAndRedo(new gC(r,new gu(i,new on.FixedInterval(n,1)),this.isBehindDoc(),r.floatingObject.anchorInfo.isBehindDoc)),!0}}class K2 extends G2{executeCore(e,t){return this.modelManipulator.floatingObject.zOrder.bringForward(this.control.modelManager,this.selection.specialRunInfo.getParentSubDocument(),this.selection.specialRunInfo.getPosition())}}class q2 extends G2{executeCore(e,t){return this.modelManipulator.floatingObject.zOrder.bringToFront(this.control.modelManager,this.selection.specialRunInfo.getParentSubDocument(),this.selection.specialRunInfo.getPosition())}}class $2 extends G2{executeCore(e,t){return this.modelManipulator.floatingObject.zOrder.sendBackward(this.control.modelManager,this.selection.specialRunInfo.getParentSubDocument(),this.selection.specialRunInfo.getPosition())}}class J2 extends G2{executeCore(e,t){return this.modelManipulator.floatingObject.zOrder.sendToBack(this.control.modelManager,this.selection.specialRunInfo.getParentSubDocument(),this.selection.specialRunInfo.getPosition())}}class Y2 extends G2{isBehindDoc(){return!1}}class Q2 extends G2{isBehindDoc(){return!0}}class Z2 extends EU{getState(){return new UU(this.isEnabled())}canModify(){return!this.control.modelManager.model.isDocumentProtectionEnabled}isEnabled(){const e=this.selection.activeSubDocument;return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.floatingObjects)&&(e.isMain()||e.isHeaderFooter())&&!this.selection.specialRunInfo.isTextBoxSelected()}executeCore(e,t){const r=this.history,i=g.u.inchesToTwips(.05),n=g.u.inchesToTwips(.1),o=new so.Size(g.u.inchesToTwips(2),g.u.inchesToTwips(.3)),a=new so.Size(.4*eh.RELATIVE_COEFF,.2*eh.RELATIVE_COEFF);let s=new eh(!1,0,o,a,cc.Margin,hc.Margin,!1,!1),l=new jc.m(n,n,i,i),d=new ph(l);const c=new Jc;return c.zOrder=this.modelManipulator.floatingObject.zOrder.getNewZOrder(t.subDocument),c.layoutTableCell=!0,r.addTransaction((()=>{this.modelManipulator.textBox.insertAnchoredTextBoxViaHistory(new pu(this.selection.activeSubDocument,this.selection.lastSelectedInterval.start),this.inputPosition.charPropsBundle,new hb(null,s,new th(w.i.fromString(w.i.colorNames.white),y.BLACK_COLOR,g.u.pointsToTwips(3/4)),c,d,new rh)),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(new on.FixedInterval(this.selection.lastSelectedInterval.start,1)))),this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToTextBox).execute(this.control.commandManager.isPublicApiCall,t)})),!0}}class e5 extends EU{constructor(){super(...arguments),this.anchorObjectHorizontalPositionType=gc.Margin,this.anchorObjectVerticalPositionType=fc.Margin}getRelatedCommands(){return{[FF.SetFloatingObjectTopLeftAlignment]:!0,[FF.SetFloatingObjectTopCenterAlignment]:!0,[FF.SetFloatingObjectTopRightAlignment]:!0,[FF.SetFloatingObjectMiddleLeftAlignment]:!0,[FF.SetFloatingObjectMiddleCenterAlignment]:!0,[FF.SetFloatingObjectMiddleRightAlignment]:!0,[FF.SetFloatingObjectBottomLeftAlignment]:!0,[FF.SetFloatingObjectBottomCenterAlignment]:!0,[FF.SetFloatingObjectBottomRightAlignment]:!0}}getState(){return new UU(this.isEnabled(),this.getStateValue())}getStateValue(){let e=!1;if(this.isEnabled()){let t=this.selection.specialRunInfo,r=t.getParentSubDocument().getRunByPosition(t.getPosition());r.anchorInfo.horizontalPositionAlignment===this.anchorObjectHorizontalAlignment&&r.anchorInfo.verticalPositionAlignment===this.anchorObjectVerticalAlignment&&r.anchorInfo.horizontalPositionType===this.anchorObjectHorizontalPositionType&&r.anchorInfo.verticalPositionType===this.anchorObjectVerticalPositionType&&(e=!0)}return e}canModify(){return!0}isEnabled(){const e=this.selection.specialRunInfo;return super.isEnabled()&&e.isSelected()&&e.isSelectedAnchorObject&&this.getFloatingObjectParentSubDocument().isEditable([new on.FixedInterval(e.getPosition(),1)])}executeCore(e,t){let r=this.modelManipulator,i=this.selection.specialRunInfo,n=i.getParentSubDocument(),o=n.getRunByPosition(i.getPosition()),a=(o.getType(),cs.AnchoredPictureRun,o);return a.anchorInfo.horizontalPositionAlignment===this.anchorObjectHorizontalAlignment&&a.anchorInfo.verticalPositionAlignment===this.anchorObjectVerticalAlignment||(this.history.beginTransaction(),this.history.addAndRedo(new gC(r,new gu(n,new on.FixedInterval(i.getPosition(),1)),this.anchorObjectHorizontalAlignment,r.floatingObject.anchorInfo.horizontalPositionAlignment)),this.history.addAndRedo(new gC(r,new gu(n,new on.FixedInterval(i.getPosition(),1)),this.anchorObjectVerticalAlignment,r.floatingObject.anchorInfo.verticalPositionAlignment)),this.history.addAndRedo(new gC(r,new gu(n,new on.FixedInterval(i.getPosition(),1)),this.anchorObjectHorizontalPositionType,r.floatingObject.anchorInfo.horizontalPositionType)),this.history.addAndRedo(new gC(r,new gu(n,new on.FixedInterval(i.getPosition(),1)),this.anchorObjectVerticalPositionType,r.floatingObject.anchorInfo.verticalPositionType)),this.history.endTransaction()),!0}}class t5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Left,this.anchorObjectVerticalAlignment=bc.Top}}class r5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Center,this.anchorObjectVerticalAlignment=bc.Top}}class i5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Right,this.anchorObjectVerticalAlignment=bc.Top}}class n5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Left,this.anchorObjectVerticalAlignment=bc.Center}}class o5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Center,this.anchorObjectVerticalAlignment=bc.Center}}class a5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Right,this.anchorObjectVerticalAlignment=bc.Center}}class s5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Left,this.anchorObjectVerticalAlignment=bc.Bottom}}class l5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Center,this.anchorObjectVerticalAlignment=bc.Bottom}}class d5 extends e5{constructor(){super(...arguments),this.anchorObjectHorizontalAlignment=mc.Right,this.anchorObjectVerticalAlignment=bc.Bottom}}class c5 extends EU{constructor(){super(...arguments),this.isBehindDoc=!1}getRelatedCommands(){return{[FF.SetFloatingObjectSquareTextWrapType]:!0,[FF.SetFloatingObjectTightTextWrapType]:!0,[FF.SetFloatingObjectThroughTextWrapType]:!0,[FF.SetFloatingObjectTopAndBottomTextWrapType]:!0,[FF.SetFloatingObjectBehindTextWrapType]:!0,[FF.SetFloatingObjectInFrontOfTextWrapType]:!0,[FF.SetFloatingObjectInlineTextWrapType]:!0}}getState(){return new UU(this.isEnabled(),this.getStateValue())}getStateValue(){let e=!1;if(this.isEnabled()){const t=this.selection.specialRunInfo;let r=t.getParentSubDocument().getRunByPosition(t.getPosition());r&&r.anchorInfo&&r.anchorInfo.wrapType===this.anchorObjectTextWrapType&&r.anchorInfo.isBehindDoc===this.isBehindDoc&&(e=!0)}return e}canModify(){return!0}isEnabled(){return super.isEnabled()&&this.isEnabledCore()&&this.getFloatingObjectParentSubDocument().isEditable([new on.FixedInterval(this.selection.specialRunInfo.getPosition(),1)])}isEnabledCore(){return this.selection.specialRunInfo.isSelected()}executeCore(e,t){const r=this.selection.specialRunInfo,i=r.getParentSubDocument(),n=r.getPosition();return this.modelManipulator.picture.setFloatingObjectTextWrapType(i,n,this.inputPosition.charPropsBundle,this.isBehindDoc,this.anchorObjectTextWrapType),!0}}class h5 extends c5{constructor(){super(...arguments),this.anchorObjectTextWrapType=uc.Square}}class u5 extends c5{constructor(){super(...arguments),this.anchorObjectTextWrapType=uc.Tight}}class p5 extends c5{constructor(){super(...arguments),this.anchorObjectTextWrapType=uc.Through}}class g5 extends c5{constructor(){super(...arguments),this.anchorObjectTextWrapType=uc.TopAndBottom}}class m5 extends c5{constructor(){super(...arguments),this.anchorObjectTextWrapType=uc.None}}class f5 extends c5{constructor(){super(...arguments),this.anchorObjectTextWrapType=uc.None,this.isBehindDoc=!0}}class b5 extends c5{getStateValue(){let e=!1;if(this.isEnabled()){this.selection.activeSubDocument.getRunByPosition(this.selection.specialRunInfo.getPicturePosition()).getType()===cs.InlinePictureRun&&(e=!0)}return e}isEnabledCore(){return this.selection.specialRunInfo.isPictureSelected()}executeCore(e,t){return this.modelManipulator.picture.setFloatingObjectInlineTextWrapType(this.selection.activeSubDocument,this.selection.specialRunInfo.getPicturePosition(),this.inputPosition.charPropsBundle),!0}}class C5 extends TX{executeCore(e,t){return this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(this.control.commandManager.isPublicApiCall)}isEnabledInReadOnlyMode(){return!0}}class S5 extends EU{getState(){var e=new UU(this.control.innerClientProperties.viewsSettings.isPrintLayoutView,!1);return e.visible=this.selection.activeSubDocument.isHeaderFooter(),e}}class I5 extends TX{DEPRECATEDConvertOptionsParameter(e){return"boolean"==typeof e?e:!this.getValue()}executeCore(e,t){const r=this.selection.pageIndex,i=this.getSectionIndex(r),n=this.control.modelManager.model.sections[i],o=this.selection.activeSubDocument.isHeader(),a=TX.getSectionHeadersFooters(o,n);let s=t.param;if(s===e.value)return!1;this.history.beginTransaction();const l=this.control.layoutFormatterManager.forceFormatPage(r),d=l.flags.get(Wu.IsFirstPageOfSection);this.changeSectionProperty(n,s);const c=mh.getActualObjectType(n,d,(0,S.isEven)(l.layoutPageIndex));let h=a.getObject(c);if(!h){const e=this.control.modelManager.modelManipulator.header.getHeaderFooterManipulator(o);e.changeObjectIndex(i,c,e.createObject(c)),h=a.getObject(c)}return this.control.layout.isFullyFormatted||this.control.layoutFormatterManager.formatSyncAllDocument(),this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(this.control.commandManager.isPublicApiCall,new MX(this.control,r,o))||this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(this.control.commandManager.isPublicApiCall,new MX(this.control,this.control.layout.pages.length-1,o)),this.history.endTransaction(),!0}}class P5 extends I5{getValue(){return this.control.modelManager.model.sections[this.getSectionIndex(this.selection.pageIndex)].sectionProperties.differentFirstPage}changeSectionProperty(e,t){this.history.addAndRedo(new wI(this.modelManipulator,new on.FixedInterval(e.startLogPosition.value,e.getLength()),t))}}class w5 extends I5{getValue(){return this.control.modelManager.model.differentOddAndEvenPages}changeSectionProperty(e,t){this.history.addAndRedo(new k0(this.modelManipulator,t))}}class y5 extends TX{executeCore(e,t){return this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(this.control.commandManager.isPublicApiCall,new MX(this.control,this.selection.pageIndex,this.selection.activeSubDocument.isFooter()))}isEnabledInReadOnlyMode(){return!0}}class x5 extends y5{isEnabled(){return super.isEnabled()&&this.selection.activeSubDocument.isFooter()}}class T5 extends y5{isEnabled(){return super.isEnabled()&&this.selection.activeSubDocument.isHeader()}}class v5 extends TX{executeCore(e,t){const r=this.selection;let i=this.moveFunction(r.pageIndex);const n=this.selection.activeSubDocument,o=n.isHeader();for(let e;e=this.control.layoutFormatterManager.forceFormatPage(i);i=this.moveFunction(i)){const t=o?e.getLayoutOtherPageAreasInfo().headerPageArea:e.getLayoutOtherPageAreasInfo().footerPageArea;if(t&&t.subDocument!=n)return this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(this.control.commandManager.isPublicApiCall,new MX(this.control,i,o))}return!1}}class M5 extends v5{moveFunction(e){return++e}}class E5 extends v5{moveFunction(e){return--e}}class D5 extends EU{getState(){return new UU(this.isEnabled())}isEnabledInReadOnlyMode(){return!0}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.sections)&&Bb.isEnabled(this.control.modelManager.richOptions.control.headersFooters)&&this.control.innerClientProperties.viewsSettings.isPrintLayoutView&&this.selection.activeSubDocument.isMain()}DEPRECATEDConvertOptionsParameter(e){if((0,S.isNumber)(e))return e;const t=this.selection.activeSubDocument;return ug.ensureLayoutPosition(this.control.layoutFormatterManager,t,this.selection.lastSelectedInterval.start,Hu.Page,(new cg).setDefault(this.selection.endOfLine),(new cg).setDefault(!1)).pageIndex}executeCore(e,t){return this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(this.control.commandManager.isPublicApiCall,new MX(this.control,t.param,this.isHeader()))}}class F5 extends D5{isHeader(){return!0}}class R5 extends D5{isHeader(){return!1}}class L5 extends TX{isEnabled(){if(!super.isEnabled())return!1;const e=this.control.layoutFormatterManager.forceFormatPage(this.selection.pageIndex);return e&&Ch.getPageSectionIndex(e,this.control.modelManager.model.sections)>0}getValue(){if(!this.isEnabled())return null;this.isHeader=this.selection.activeSubDocument.isHeader();const e=this.selection.pageIndex,t=this.control.layoutFormatterManager.forceFormatPage(e),r=this.control.modelManager.model.sections,i=Ch.getPageSectionIndex(t,r),n=mh.getActualObjectType(r[i],t.flags.get(Wu.IsFirstPageOfSection),(0,S.isEven)(t.layoutPageIndex));return TX.getSectionHeadersFooters(this.isHeader,r[i]).isLinkedToPrevious(n)}executeCore(e,t){const r=this.control.layoutFormatterManager.forceFormatPage(this.selection.pageIndex),i=Ch.getPageSectionIndex(r,this.control.modelManager.model.sections),n=this.selection.activeSubDocument.info.headerFooterType;return this.history.beginTransaction(),e.value?this.unlinkFromPrevious(i,n):this.linkToPrevious(i,n),this.history.endTransaction(),!0}linkToPrevious(e,t){let r=this.control.modelManager.model.sections[e];this.performLinkSectionToPrevious(e,t,(i=>{let n=r.documentModel.sections[i],o=TX.getSectionHeadersFooters(this.isHeader,n).getObjectIndex(t);-1===o&&(o=this.control.modelManager.modelManipulator.header.getHeaderFooterManipulator(this.isHeader).createObject(t),this.history.addAndRedo(this.createChangeObjectIndexHistoryItem(i,t,o))),this.history.addAndRedo(this.createChangeObjectIndexHistoryItem(e,t,o)),this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(this.control.commandManager.isPublicApiCall,new MX(this.control,this.selection.pageIndex,this.isHeader))||this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterBySubDocument).execute(this.control.commandManager.isPublicApiCall,TX.getObjectsCache(this.isHeader,this.control)[o].getSubDocument(this.control.modelManager.model))}))}unlinkFromPrevious(e,t){let r=this.control.modelManager.model.sections[e];this.performLinkSectionToPrevious(e,t,(i=>{let n=r.documentModel.sections[i],o=TX.getSectionHeadersFooters(this.isHeader,n).getObject(t),a=o.getEndPosition(r.documentModel),s=a>1?fb.create(new mu(o.getSubDocument(r.documentModel),[new on.FixedInterval(0,a-1)])):null,l=this.control.modelManager.modelManipulator.header.getHeaderFooterManipulator(this.isHeader).createObject(t),d=TX.getObjectsCache(this.isHeader,this.control)[l],c=d.getSubDocument(this.control.modelManager.model);this.history.addAndRedo(this.createChangeObjectIndexHistoryItem(e,t,l)),s&&(this.history.beginTransaction(),this.modelManipulator.range.removeInterval(new gu(c,on.FixedInterval.fromPositions(0,c.getDocumentEndPosition())),!0,!0),s.insertTo(this.modelManipulator,new pu(c,0)),this.history.endTransaction()),this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex).execute(this.control.commandManager.isPublicApiCall,new MX(this.control,this.selection.pageIndex,this.isHeader))||this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToHeaderFooterBySubDocument).execute(this.control.commandManager.isPublicApiCall,d.getSubDocument(this.control.modelManager.model))}))}performLinkSectionToPrevious(e,t,r){let i=this.control.modelManager.model.sections[e+1],n=this.control.modelManager.model.sections[e],o=i&&this.areSectionsLinked(n,i,t);r(e-1),o&&this.linkToPrevious(e+1,t)}areSectionsLinked(e,t,r){return TX.getSectionHeadersFooters(this.isHeader,t).getObject(r)===TX.getSectionHeadersFooters(this.isHeader,e).getObject(r)}createChangeObjectIndexHistoryItem(e,t,r){return new(this.isHeader?TC:vC)(this.modelManipulator,e,t,r,(e=>{this.control.selection.activeSubDocument.isHeaderFooter()&&-1==e&&this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(this.control.commandManager.isPublicApiCall)}))}}class B5 extends EU{getState(){var e=this.selection.lastSelectedInterval.clone();if(0===e.length&&(n=this.inputPosition.getCharacterStyle()),!n||n.isDefault)for(var t,r=this.selection.activeSubDocument.getRunsByInterval(e),i=r[0].paragraph.paragraphStyle,n=r[0].characterStyle,o=1;(t=r[o])&&(n&&t.characterStyle!==n&&(n=null),i&&t.paragraph.paragraphStyle!==i&&(i=null),i||n);o++);var a="";a=n&&n.linkedStyle?Wh.paragraphPrefix+this.getStyleName(n.linkedStyle):n&&!n.isDefault?Wh.characterPrefix+this.getStyleName(n):i&&!i.isDefault?Wh.paragraphPrefix+this.getStyleName(i):Wh.paragraphPrefix+this.getStyleName(this.control.modelManager.model.getDefaultParagraphStyle());var s=new WU(this.isEnabled(),this.selection.activeSubDocument.isEditable(this.getIntervalsForModifying()),this.selection.activeSubDocument.isEditable(super.getIntervalsForModifying()),e,a);return s.items=this.control.modelManager.model.stylesManager.characterAndParagraphStyleGalleryItems,s}getStyleName(e){return e.styleName}executeCore(e,t){const r=t.param;if(rn.StringUtils.isNullOrEmpty(r))return!1;let i=e.interval.clone(),n=!0,o=!1;if(this.history.beginTransaction(),Wh.isParagraphStyle(r)&&e.paragraphStyleChangeEnabled){const e=Wh.getStyleNameWithoutPrefix(r);let n=this.control.modelManager.model.getParagraphStyleByName(e);if(!n){if(!Wh.getPresetParagraphStyleByName(e))return!1;n=Wh.getPresetParagraphStyleByName(e).clone(),o=!0}this.applyParagraphStyle(i,n,o,t.subDocument)}else if(!Wh.isParagraphStyle(r)&&e.characterStyleChangeEnabled){const e=Wh.getStyleNameWithoutPrefix(r);0==i.length&&(i=t.subDocument.getWholeWordInterval(i.start));let a=this.control.modelManager.model.getCharacterStyleByName(e);if(!a){const t=Wh.getPresetCharacterStyleByName(e);if(!t)return!1;a=t.clone(),o=!0}if(0==i.length){if(o){let e=a.maskedCharacterProperties.fontInfo;e&&void 0===e.measurer&&(a.maskedCharacterProperties.fontInfo=this.control.modelManager.model.cache.fontInfoCache.getItemByName(e.name))}this.inputPosition.setCharacterStyle(a),n=!1}else this.applyCharacterStyle(i,a,o,t.subDocument)}return this.history.endTransaction(),n}applyCharacterStyle(e,t,r,i){Bb.isEnabled(this.control.modelManager.richOptions.control.characterStyle)&&this.modelManipulator.style.applyCharacterStyle(new gu(i,e),r?this.control.modelManager.model.stylesManager.addCharacterStyle(t):t,!1)}applyParagraphStyle(e,t,r,i){var n=this.calculateAffectedParagraphCount(e,i);if(n>0&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphStyle))for(var o=C.SearchUtils.normedInterpolationIndexOf(i.paragraphs,(e=>e.startLogPosition.value),e.start),a=0;a<n;a++){var s=i.paragraphs[o+a],l=new on.FixedInterval(s.startLogPosition.value,s.length),d=this.modelManipulator;this.history.addAndRedo(new Op(d,new gu(i,l),r?d.model.stylesManager.addParagraphStyle(t):t)),this.history.addAndRedo(new rt(d,new gu(i,l),0)),this.history.addAndRedo(new At(d,new gu(i,l),0)),this.history.addAndRedo(new yw(this.modelManipulator,i,o,cn.NumberingListNotSettedIndex,-1))}else this.applyParagraphLinkedStyle(e,t,r,i)}applyParagraphLinkedStyle(e,t,r,i){Bb.isEnabled(this.control.modelManager.richOptions.control.characterStyle)&&(t.linkedStyle||this.createCharacterStyle(t),this.applyCharacterStyle(e,t.linkedStyle,r,i))}createCharacterStyle(e){var t=new zl(e.styleName+" Char",e.localizedName+" Char",!1,!1,!1,!1,e.maskedCharacterProperties);this.history.addAndRedo(new AI(this.modelManipulator,t,e))}calculateAffectedParagraphCount(e,t){var r=t.getParagraphsByInterval(e);if(r.length>1)return r.length;var i=r[0],n=e.length>=i.length-1;return e.start===i.startLogPosition.value&&n||0===e.length?1:0}isEnabled(){return super.isEnabled()&&(Bb.isEnabled(this.control.modelManager.richOptions.control.characterStyle)||Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphStyle))}canModify(){return this.selection.activeSubDocument.isEditable(this.getIntervalsForModifying())||this.selection.activeSubDocument.isEditable(super.getIntervalsForModifying())}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}}class A5 extends EU{getActualIntervals(){return this.selection.isCollapsed()?[this.selection.activeSubDocument.getWholeWordInterval(this.selection.intervals[0].start)]:f.ListUtils.deepCopy(this.selection.intervalsInfo.intervals)}getState(){return new VU(this.isEnabled(),this.getActualIntervals())}DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.intervals=this.getActualIntervals()}executeCore(e,t){const r=this.modelManipulator,i=r.model,n=t.subDocument;this.history.beginTransaction();const o=i.defaultCharacterProperties;if(t.intervalsInfo.intervals.length>0)for(let e,a=0;e=t.intervalsInfo.intervals[a];a++)e.length>0&&(this.history.addAndRedo(new kp(r,new gu(n,e),i.getDefaultCharacterStyle(),!0)),this.history.addAndRedo(new Ot(r,new gu(n,e),o.fontBold,!1)),this.history.addAndRedo(new _t(r,new gu(n,e),o.allCaps,!1)),this.history.addAndRedo(new Ut(r,new gu(n,e),o.smallCaps,!1)),this.history.addAndRedo(new Ht(r,new gu(n,e),o.fontUnderlineType,!1)),this.history.addAndRedo(new Vt(r,new gu(n,e),o.textColor,!1)),this.history.addAndRedo(new Wt(r,new gu(n,e),o.shadingInfo,!1)),this.history.addAndRedo(new Qt(r,new gu(n,e),o.highlightColor,!1)),this.history.addAndRedo(new zt(r,new gu(n,e),o.hidden,!1)),this.history.addAndRedo(new jt(r,new gu(n,e),o.fontItalic,!1)),this.history.addAndRedo(new Xt(r,new gu(n,e),o.fontInfo,!1)),this.history.addAndRedo(new Gt(r,new gu(n,e),o.script,!1)),this.history.addAndRedo(new Kt(r,new gu(n,e),o.fontSize,!1)),this.history.addAndRedo(new qt(r,new gu(n,e),o.fontStrikeoutType,!1)),this.history.addAndRedo(new Yt(r,new gu(n,e),o.underlineColor,!1)),this.history.addAndRedo(new Zt(r,new gu(n,e),o.underlineWordsOnly,!1)),this.history.addAndRedo(new $t(r,new gu(n,e),o.strikeoutWordsOnly,!1)),this.history.addAndRedo(new Jt(r,new gu(n,e),o.strikeoutColor,!1)),this.history.addAndRedo(new er(r,new gu(n,e),o.noProof,!1)));const a=this.control.selection.activeSubDocument.getParagraphIndicesByIntervals(t.intervalsInfo.intervals);for(let e=a.length-1;e>=0;e--){if(!this.control.selection.activeSubDocument.isEditable([this.control.selection.activeSubDocument.paragraphs[e].interval]))continue;let t=n.paragraphs[a[e]],o=t.interval;t.onParagraphPropertiesChanged(),this.history.addAndRedo(new Op(r,new gu(n,o),i.getDefaultParagraphStyle()));const s=i.defaultParagraphProperties;this.history.addAndRedo(new st(r,new gu(n,o),s.alignment,!1)),this.history.addAndRedo(new lt(r,new gu(n,o),s.contextualSpacing,!1)),this.history.addAndRedo(new ct(r,new gu(n,o),s.afterAutoSpacing,!1)),this.history.addAndRedo(new ht(r,new gu(n,o),s.shadingInfo,!1)),this.history.addAndRedo(new ut(r,new gu(n,o),s.beforeAutoSpacing,!1)),this.history.addAndRedo(new pt(r,new gu(n,o),s.firstLineIndent,!1)),this.history.addAndRedo(new gt(r,new gu(n,o),s.firstLineIndentType,!1)),this.history.addAndRedo(new mt(r,new gu(n,o),s.keepLinesTogether,!1)),this.history.addAndRedo(new ft(r,new gu(n,o),s.leftIndent,!1)),this.history.addAndRedo(new bt(r,new gu(n,o),s.lineSpacing,!1)),this.history.addAndRedo(new Ct(r,new gu(n,o),s.lineSpacingType,!1)),this.history.addAndRedo(new St(r,new gu(n,o),s.outlineLevel,!1)),this.history.addAndRedo(new It(r,new gu(n,o),s.pageBreakBefore,!1)),this.history.addAndRedo(new Pt(r,new gu(n,o),s.rightIndent,!1)),this.history.addAndRedo(new wt(r,new gu(n,o),s.spacingAfter,!1)),this.history.addAndRedo(new yt(r,new gu(n,o),s.spacingBefore,!1)),this.history.addAndRedo(new xt(r,new gu(n,o),s.suppressHyphenation,!1)),this.history.addAndRedo(new Tt(r,new gu(n,o),s.suppressLineNumbers,!1)),this.history.addAndRedo(new vt(r,new gu(n,o),s.widowOrphanControl,!1)),this.history.addAndRedo(new Mt(r,new gu(n,o),s.divId,!1))}return this.control.commandManager.getCommand(FF.DeleteNumerationFromParagraphs).execute(this.control.commandManager.isPublicApiCall),this.history.endTransaction(),!0}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.characterFormatting)}}class N5 extends EU{getRelatedCommands(){return{[FF.SwitchToSimpleView]:!0,[FF.SwitchToPrintLayoutView]:!0,[FF.ChangeViewType]:!0,[FF.ToggleShowHorizontalRuler]:!0}}isEnabledInReadOnlyMode(){return!0}executeCore(e,t){return this.control.innerClientProperties.viewsSettings.viewType!=t.param&&(this.selection.activeSubDocument.isHeaderFooter()&&this.control.commandManager.getCommand(FF.ChangeActiveSubDocumentToMain).execute(this.control.commandManager.isPublicApiCall,new vU(this.control)),this.control.innerClientProperties.viewsSettings.viewType=t.param,this.control.onViewTypeChanged(),this.selection.scrollManager.setScroll((new xD).byModelPosition(this.selection).setModelPosition(this.selection.lastSelectedInterval.start).useStdRelativePosition().useStdOffset()),this.control.barHolder.forceUpdate({}),!0)}getState(){return new UU(this.isEnabled(),this.control.innerClientProperties.viewsSettings.viewType)}updateControlState(){this.control.viewManager.adjust(!0),super.updateControlState()}}class k5 extends N5{DEPRECATEDConvertOptionsParameter(e){return kV.PrintLayout}getState(){return new UU(this.isEnabled(),this.control.innerClientProperties.viewsSettings.isPrintLayoutView)}}class O5 extends N5{DEPRECATEDConvertOptionsParameter(e){return kV.Simple}getState(){return new UU(this.isEnabled(),this.control.innerClientProperties.viewsSettings.isSimpleView)}}class _5 extends EU{getState(){var e=new UU(this.isEnabled());return e.value=this.control.owner.isInFullScreenMode,e}executeCore(e,t){return t.param!=this.control.owner.isInFullScreenMode&&(this.control.owner.toggleFullScreenMode(),!0)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fullScreen)}isEnabledInReadOnlyMode(){return!0}}class U5 extends EU{getState(){return new UU(this.isEnabled(),this.control.innerClientProperties.showHiddenSymbols)}DEPRECATEDConvertOptionsParameter(e){return"boolean"==typeof e?e:!this.control.innerClientProperties.showHiddenSymbols}executeCore(e,t){let r=t.param;if(r!==this.control.innerClientProperties.showHiddenSymbols){this.control.innerClientProperties.showHiddenSymbols=r;const e=this.control.viewManager.canvasManager.getScrollTopInfo();return this.control.layoutFormatterManager.invalidator.onChangedAllLayout(),this.selection.scrollManager.setScroll((new xD).byScrollInfo.setPageInfo(e)),!0}return!1}isEnabledInReadOnlyMode(){return!0}}class H5 extends EU{getState(){return new UU(this.isEnabled(),this.control.innerClientProperties.showTableGridLines)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}DEPRECATEDConvertOptionsParameter(e){return"boolean"==typeof e?e:!this.control.innerClientProperties.showTableGridLines}executeCore(e,t){return t.param!==this.control.innerClientProperties.showTableGridLines&&(this.control.innerClientProperties.showTableGridLines=t.param,this.control.layoutFormatterManager.invalidator.onChangedAllLayout(),!0)}isEnabledInReadOnlyMode(){return!0}}class V5 extends EU{getState(e=this.convertToCommandOptions(void 0)){return new UU(this.isEnabled(e))}isEnabled(e){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphFormatting)}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}getTabs(e,t){let r=e[e.length-1],i=e[0],n=t.paragraphs[i],o=n.getTabs(),a=[];for(var s,l=0;s=o.positions[l];l++)a.push(s.position);return a.push(o.defaultTabStop),0===e[0]&&1===e.length?a=a.concat(this.getParagraphTabs(n)):(e[0]>0&&(a=a.concat(this.getParagraphTabs(t.paragraphs[i-1]))),r<t.paragraphs.length-1&&(a=a.concat(this.getParagraphTabs(t.paragraphs[r+1])))),a.sort(Qe.Comparers.number),a}getNearRightDefaultTab(e){var t=this.control.modelManager.model.defaultTabWidth;return Math.floor(e/t+1)*t}getNearLeftDefaultTab(e){var t=this.control.modelManager.model.defaultTabWidth,r=Math.floor(e/t);return r>0?e%t!=0?r*t:(r-1)*t:r}getNearRightTab(e,t){for(var r=0;r<t.length;r++)if(e<t[r])return t[r];return e}getNearLeftTab(e,t){for(var r=t.length-1;r>=0;r--)if(e>t[r])return t[r];return e}getParagraphTabs(e){var t=[],r=e.getParagraphMergedProperties();return t.push(r.leftIndent),r.firstLineIndentType===ke.Hanging?t.push(r.leftIndent-r.firstLineIndent):r.firstLineIndentType===ke.Indented&&t.push(r.leftIndent+r.firstLineIndent),t}}class W5 extends V5{getState(e=this.convertToCommandOptions(void 0)){return new UU(this.isEnabled(e))}isEnabled(e){return super.isEnabled(e)&&e.subDocument.getParagraphByPosition(e.intervalsInfo.position).isInList()}executeCore(e,t){var r=t.subDocument.getParagraphIndicesByIntervals(this.selection.intervals),i=t.subDocument.paragraphs[r[0]];return!!i.isInList()&&(this.history.beginTransaction(),this.hasPreviousParagraphsInList(r[0],t.subDocument)||i.getListLevelIndex()>0?this.changeListLevelIndices(r,t.subDocument):this.changeListLevelIndents(r,t.subDocument),this.history.endTransaction(),!0)}changeListLevelIndices(e,t){var r=e.length;for(let a=0;a<r;a++){var i=e[a],n=t.paragraphs[i],o=this.getNewListLevelIndex(n);o!==n.getListLevelIndex()&&this.history.addAndRedo(new yw(this.modelManipulator,t,i,n.numberingListIndex,o))}}changeListLevelIndents(e,t){const r=t.paragraphs[e[0]],i=this.getTabs(e,t),n=r.getAbstractNumberingListIndex(),o=r.getAbstractNumberingList().levels[0].getParagraphMergedProperties(),a=this.getLeftIndentPosition(o.leftIndent,o.firstLineIndent,o.firstLineIndentType),s=this.getNextListLevelIndent(a,i);this.assignNewIndent(n,s)}assignNewIndent(e,t){for(var r=this.control.modelManager.model.abstractNumberingLists[e],i=r.levels,n=r.levels[0].getParagraphMergedProperties(),o=this.calculateLeftIndentDelta(t,n.leftIndent,n.firstLineIndent,n.firstLineIndentType),a=i.length,s=0;s<a;s++){var l=i[s].getParagraphMergedProperties(),d=l.leftIndent+o;if(d>=0){if(l.firstLineIndentType==ke.Hanging){var c=d-l.firstLineIndent;c<0&&(d-=c)}if(0==s&&l.leftIndent==d)break;this.history.addAndRedo(new JE(this.modelManipulator,!0,e,s,d,!0))}else if(0==s)break}}calculateLeftIndentDelta(e,t,r,i){return e-this.getLeftIndentPosition(t,r,i)}hasPreviousParagraphsInList(e,t){for(var r,i=t.paragraphs[e].getAbstractNumberingListIndex(),n=e-1;r=t.paragraphs[n];n--)if(r.getAbstractNumberingListIndex()===i)return!0;return!1}getLeftIndentPosition(e,t,r){return r===ke.Hanging?e-t:e}}class z5 extends W5{getNextListLevelIndent(e,t){var r=this.getNearRightDefaultTab(e),i=this.getNearRightTab(e,t);return r<i||i==e?r:i}getNewListLevelIndex(e){return Math.min(7,e.getListLevelIndex()+1)}}class j5 extends W5{getNextListLevelIndent(e,t){var r=this.getNearLeftDefaultTab(e),i=this.getNearLeftTab(e,t);return r>i||i==e?r:i}getNewListLevelIndex(e){return Math.max(0,e.getListLevelIndex()-1)}}class X5{constructor(e,t,r){this.subDocument=e,this.targetType=t,this.startIndex=r}getTargetListInfo(e){if(1===this.startIndex)return null;var t=e[0];const r=this.subDocument.paragraphs[t];var i=this.getTargetParagraph(t);return!i&&this.hasSameParagraphType(t+1)&&(i=this.subDocument.paragraphs[t+1]),i?r.isInList()&&r.getListLevelIndex()!=i.getListLevelIndex()?null:{listIndex:i.getNumberingListIndex(),listlevelIndex:Math.max(0,i.getListLevelIndex())}:null}getTargetParagraph(e){let t=!1,r=!1;for(let n=e-1;n>=0;n--){var i=this.subDocument.paragraphs[n];if(t||(t=!i.isEmpty&&!i.isInList()),this.hasSameParagraphType(n))return r=n<=0||!this.hasSameParagraphType(n-1),this.startIndex>1?this.isStartIndexMatch(i)?i:null:t&&!r?null:i}return null}isStartIndexMatch(e){var t=this.subDocument.documentModel.getRangeListCounters(e);if(1!==t.length)return!1;const r=t[0];return!(this.startIndex<r)&&!(this.startIndex-r>2)}hasSameParagraphType(e){var t=this.subDocument.paragraphs[e];return t&&t.isInList()&&t.getNumberingList().getListType()===this.targetType}}class G5 extends EU{getState(e=this.convertToCommandOptions(void 0)){const t=f.ListUtils.deepCopy(e.intervalsInfo.intervals);return new VU(this.isEnabled(),t,this.getValue(t,e.subDocument))}getValue(e,t){return this.areAllParagraphsHasValidNumberingListType(e,t)}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}DEPRECATEDConvertOptionsParameter(e){return(0,S.isNumber)(e)?e:-1}deleteNumberingList(e,t){Tw.deleteNumberingList(this.control.modelManager,t,e)}insertNumberingList(e,t,r){var i=new X5(r,this.getNumberingListType(),void 0===t?-1:t).getTargetListInfo(e),n=i?i.listIndex:this.createNewList(this.getAbstractNumberingList()),o=i?i.listlevelIndex:-1,a=this.getParagraphsLayoutPositions(e,r),s=this.getParagraphsLevelIndices(e,a,!!i,n,o,r);this.insertNumberingListCore(e,n,s,a,r)}changeNumberingList(e,t){let r=t.paragraphs[e[0]].getNumberingListIndex(),i=this.createNewList(this.getAbstractNumberingList());this.assignLevelsIndents(e[0],i,t);for(let e,n=0;e=t.paragraphs[n];n++)e.getNumberingListIndex()===r&&this.history.addAndRedo(new yw(this.modelManipulator,t,n,i,e.getListLevelIndex()))}modifyLevels(e,t){let r=t.paragraphs[e[0]].getNumberingListIndex();const i=this.createNewList(this.getAbstractNumberingList()),n=this.control.modelManager.model.numberingLists[i],o=this.control.modelManager.model.numberingLists[r].abstractNumberingListIndex;f.ListUtils.forEach(e,(e=>{const i=t.paragraphs[e];if(i.getNumberingListIndex()===r){const e=i.getListLevelIndex(),t=n.levels[e];this.history.addAndRedo(new eD(this.modelManipulator,!0,o,e,t.getListLevelProperties().displayFormatString)),this.history.addAndRedo(new tD(this.modelManipulator,!0,o,e,t.getListLevelProperties().format)),this.history.addAndRedo(new XE(this.modelManipulator,!0,o,e,t.getCharacterMergedProperties().fontInfo,!0)),this.history.addAndRedo(new GE(this.modelManipulator,!0,o,e,t.getCharacterMergedProperties().fontSize,!0))}}))}getAbstractNumberingList(){return this.control.modelManager.model.abstractNumberingListTemplates[this.getNumberingListTemplateIndex(this.getNumberingListType())]}insertNumberingListCore(e,t,r,i,n){var o=e.length;for(let l=0;l<o;l++){let o=e[l];var a=n.paragraphs[o];this.processOldNumberingList(a,n);var s=r[l];a.isInList()||this.deleteLeadingWhiteSpaces(a,i[l].row.boxes,s<0,n),s>=0&&(this.history.addAndRedo(new yw(this.modelManipulator,n,o,t,s)),this.history.addAndRedo(new ft(this.modelManipulator,new gu(n,new on.FixedInterval(a.startLogPosition.value,1)),a.maskedParagraphProperties.leftIndent,!1)),this.history.addAndRedo(new pt(this.modelManipulator,new gu(n,new on.FixedInterval(a.startLogPosition.value,1)),a.maskedParagraphProperties.firstLineIndent,!1)))}}processOldNumberingList(e,t){if(e.isInList()&&e.numberingListIndex==cn.NumberingListNotSettedIndex){var r=e.getParagraphMergedProperties().leftIndent;this.history.addAndRedo(new ft(this.modelManipulator,new gu(t,new on.FixedInterval(e.startLogPosition.value,1)),r,!0))}}deleteLeadingWhiteSpaces(e,t,r,i){for(var n,o=0,a=0,s=this.modelManipulator,l=0;(n=t[l])&&(n.isWhitespace()&&this.notInsideField(e.startLogPosition.value+o+n.getLength(),i));l++)o+=n.getLength(),a+=n.width;if(o>0&&(this.correctSelectionIntervals(new on.FixedInterval(e.startLogPosition.value,o)),this.history.addAndRedo(new Hm(s,new gu(i,new on.FixedInterval(e.startLogPosition.value,o)),!1))),r&&a>0){a=g.u.pixelsToTwips(a);var d=e.getParagraphMergedProperties(),c=e.interval;d.firstLineIndentType===ke.Hanging?a<d.firstLineIndent?this.history.addAndRedo(new pt(s,new gu(i,c),d.firstLineIndent-a,!0)):d.firstLineIndent===a?(this.history.addAndRedo(new pt(s,new gu(i,c),0,!0)),this.history.addAndRedo(new gt(s,new gu(i,c),ke.None,!0))):(this.history.addAndRedo(new pt(s,new gu(i,c),a-d.firstLineIndent,!0)),this.history.addAndRedo(new gt(s,new gu(i,c),ke.Indented,!0))):(this.history.addAndRedo(new pt(s,new gu(i,c),d.firstLineIndent+a,!0)),d.firstLineIndentType===ke.None&&this.history.addAndRedo(new gt(s,new gu(i,c),ke.Indented,!0)))}}notInsideField(e,t){return Md.binaryIndexOf(t.fields,e)<0}correctSelectionIntervals(e){var t=f.ListUtils.deepCopy(this.selection.intervalsInfo.intervals);for(let n,o=0;n=t[o];o++)if(n.start>e.start){var r=Math.max(e.start,n.end-e.length),i=Math.max(e.start,n.start-e.length);t[o]=on.FixedInterval.fromPositions(i,r)}this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setIntervals(t)))}getParagraphsLayoutPositions(e,t){var r=[],i=e.length;for(let l=0;l<i;l++){var n=e[l],o=t.paragraphs[n].startLogPosition.value,a=(new cg).setDefault(!1),s=(new cg).setDefault(!1);r.push(t.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,t,o,Hu.Box,a,s):new pg(this.control.layout,t,o,this.selection.pageIndex,Hu.Box).create(a,s))}return r}getParagraphsLevelIndices(e,t,r,i,n,o){const a=[],s=this.control.modelManager.model.numberingLists[i],l=e.length;for(let r=0;r<l;r++){var d=e[r];if(n<0){const e=o.paragraphs[d],i=t[r];let n=i.row.x;const c=i.row.tableCellInfo;c&&(n-=c.x);const h=i.row.numberingListBox?i.row.numberingListBox:this.getStartBox(i.row.boxes);n+=h instanceof jW?h.textBox.x:h.x,h instanceof FW&&l>1&&(e.length<=1||0!==r)?a.push(-1):a.push(this.calculateParagraphListLevel(n,e,s))}else a.push(n)}return this.assignLevelsIndents(e[0],i,o),a}calculateParagraphListLevel(e,t,r){for(var i,n=g.u.pixelsToTwips(e),o=0;i=r.levels[o];o++){var a=i.getParagraphMergedProperties();if(n<=(a.firstLineIndentType==ke.Hanging?a.leftIndent-a.firstLineIndent:a.leftIndent))return o}return r.levels.length-1}getStartBox(e){for(var t,r=0;t=e[r];r++)if(!t.isWhitespace())return t;return e[0]}createNewList(e){var t=new dn(this.control.modelManager.model);t.copyFrom(e),t.resetId(),this.history.addAndRedo(new Pw(this.modelManipulator,t));var r=this.control.modelManager.model.abstractNumberingLists.length-1,i=new cn(this.control.modelManager.model,r);return this.history.addAndRedo(new ww(this.modelManipulator,i)),this.control.modelManager.model.numberingLists.length-1}processParagraphByIndex(e){return!0}getNumberingListTemplateIndex(e){return Tw.getNumberingListTemplateIndex(this.control.modelManager.model,e)}areAllParagraphsHasValidNumberingListType(e,t){var r=this.getNumberingListType(),i=t.getParagraphIndicesByIntervals(e);for(let e=i.length-1;e>=0;e--){let o=i[e];var n=t.paragraphs[o];if(!n.isInList()||n.getNumberingList().getLevelType(n.getListLevelIndex())!==r)return!1}return!0}getNumberingListType(){throw new Error(R.D.NotImplemented)}assignLevelsIndents(e,t,r){var i=this.control.modelManager.model.numberingLists[t];this.assignLevelsIndentsCore(e,t,i.levels,r)}assignLevelsIndentsCore(e,t,r,i){var n=i.paragraphs[e];if(!n.isInList())return;let o=n.getNumberingList();for(var a,s=0;a=r[s];s++){let e=o.levels[0].getListLevelProperties(),r=a.getListLevelProperties();e.originalLeftIndent!==r.originalLeftIndent&&this.history.addAndRedo(new rD(this.modelManipulator,!1,t,s,e.originalLeftIndent))}}}class K5 extends G5{executeCore(e,t){this.history.beginTransaction();const r=t.subDocument;var i=r.getParagraphIndicesByIntervals(e.intervals);let n=t.param;if(e.value)this.deleteNumberingList(i,r);else if(this.selection.isCollapsed()&&t.subDocument.paragraphs[i[0]].isInList()&&n<0){const e=this.getNumberingListType()==tn.MultiLevel,t=f.ListUtils.unsafeAnyOf(i,(e=>0==this.selection.activeSubDocument.paragraphs[e].getListLevelIndex()));e||t?this.changeNumberingList(i,r):this.modifyLevels(i,r)}else this.insertNumberingList(i,n,r);return this.history.endTransaction(),this.selection.changeState((e=>e.setEndOfLine(!1))),!0}}class q5 extends K5{getState(e=this.convertToCommandOptions(void 0)){const t=e.subDocument;var r=new VU(this.isEnabled(),f.ListUtils.deepCopy(this.selection.intervalsInfo.intervals));if(r.visible=!1,r.enabled){var i=C.SearchUtils.normedInterpolationIndexOf(t.paragraphs,(e=>e.startLogPosition.value),r.intervals[0].start),n=t.paragraphs[i];n.isInList()&&this.getTargetNumberingListIndex(i,n.getAbstractNumberingListIndex(),t)>=0&&(r.visible=!0),r.enabled=r.visible}return r}executeCore(e,t){const r=t.subDocument;var i=C.SearchUtils.normedInterpolationIndexOf(t.subDocument.paragraphs,(e=>e.startLogPosition.value),e.intervals[0].start),n=r.paragraphs[i].getAbstractNumberingListIndex(),o=this.getTargetNumberingListIndex(i,n,r);this.history.beginTransaction();for(var a,s=i;a=r.paragraphs[s];s++)a.getAbstractNumberingListIndex()===n&&this.history.addAndRedo(new yw(this.modelManipulator,r,s,o,a.getListLevelIndex()));return this.history.endTransaction(),!0}getTargetNumberingListIndex(e,t,r){for(var i,n=e-1;i=r.paragraphs[n];n--){var o=i.getAbstractNumberingListIndex();if(o===t)return-1;if(o>=0)return i.getNumberingListIndex()}return-1}}class $5 extends G5{getState(e=this.convertToCommandOptions(void 0)){return new VU(this.isEnabled(),f.ListUtils.deepCopy(e.intervalsInfo.intervals))}executeCore(e,t){this.abstractNumberingList=t.param;const r=t.subDocument.getParagraphIndicesByIntervals(t.intervalsInfo.intervals);return this.history.beginTransaction(),this.insertNumeration(t.param,t.subDocument,r),this.history.endTransaction(),!0}insertNumeration(e,t,r){const i=this.getParagraphsLayoutPositions(r,t);let n;if(e instanceof dn){if(e.getListType()==tn.MultiLevel)return void this.changeNumberingList(r,t);n=this.createNewList(e)}else n=this.control.modelManager.model.numberingLists.indexOf(e);let o=this.getParagraphsLevelIndices(r,i,!1,n,-1,t);this.insertNumberingListCore(r,n,o,i,t)}getNumberingListType(){return this.abstractNumberingList.getListType()}}class J5 extends K5{getState(e=this.convertToCommandOptions(void 0)){return new VU(this.isEnabled(),f.ListUtils.deepCopy(e.intervalsInfo.intervals))}executeCore(e,t){var r=t.subDocument.getParagraphIndicesByIntervals(t.intervalsInfo.intervals);return this.history.beginTransaction(),this.deleteNumberingList(r,t.subDocument),this.history.endTransaction(),!0}getNumberingListType(){return null}}class Y5 extends K5{getState(e=this.convertToCommandOptions(void 0)){const t=e.subDocument;var r=new VU(this.isEnabled(),f.ListUtils.deepCopy(e.intervalsInfo.intervals));if(r.visible=!1,r.enabled){var i=C.SearchUtils.normedInterpolationIndexOf(t.paragraphs,(e=>e.startLogPosition.value),e.intervalsInfo.position),n=t.paragraphs[i];if(n.isInList())for(var o,a=n.getAbstractNumberingListIndex(),s=i-1;o=t.paragraphs[s];s--)if(o.getAbstractNumberingListIndex()===a&&o.listLevelIndex===n.listLevelIndex){r.visible=!0;break}r.enabled=r.visible}return r}executeCore(e,t){const r=t.subDocument;var i=C.SearchUtils.normedInterpolationIndexOf(r.paragraphs,(e=>e.startLogPosition.value),t.intervalsInfo.position);this.history.beginTransaction();for(var n,o=r.paragraphs[i],a=o.getNumberingList().getListType(),s=this.getNumberingListTemplateIndex(a),l=this.createNewList(this.control.modelManager.model.abstractNumberingListTemplates[s]),d=o.getAbstractNumberingListIndex(),c=i;n=r.paragraphs[c];c++)n.getAbstractNumberingListIndex()===d&&this.history.addAndRedo(new yw(this.modelManipulator,r,c,l,n.getListLevelIndex()));return this.history.endTransaction(),!0}}class Q5 extends K5{getNumberingListType(){return tn.Simple}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.numberingSimple)}getParagraphsLevelIndices(e,t,r,i,n,o){if(n>=0||!this.equalLeftIndent(e,t,i))return super.getParagraphsLevelIndices(e,t,r,i,n,o);for(var a=[],s=0;s<e.length;s++){const t=o.paragraphs[e[s]];a.push(t.isInList()?t.getListLevelIndex():0)}return r||this.assignLevelsIndents(e[0],i,o),a}equalLeftIndent(e,t,r){if(1===e.length)return!0;var i=Number.MAX_VALUE,n=-Number.MAX_VALUE;let o=e.length;for(let e=0;e<o;e++){var a=t[e],s=a.row.numberingListBox?a.row.numberingListBox.textBox.x:this.getStartBox(a.row.boxes).x,l=a.row.x+s;i=Math.min(l,i),n=Math.max(l,n)}var d=this.control.modelManager.model.numberingLists[r];return n-i<d.levels[1].getParagraphMergedProperties().leftIndent-d.levels[0].getParagraphMergedProperties().leftIndent}assignLevelsIndentsCore(e,t,r,i){super.assignLevelsIndentsCore(e,t,r,i);if(null==f.ListUtils.unsafeAnyOf(i.paragraphs,(e=>e.numberingListIndex==t))){var n=i.paragraphs[e];if(n.isInList())return;for(var o,a=0;o=r[a];a++){var s=o.getParagraphMergedProperties();this.history.addAndRedo(new rD(this.modelManipulator,!1,t,a,s.leftIndent)),this.history.addAndRedo(new JE(this.modelManipulator,!1,t,a,s.leftIndent+n.getParagraphMergedProperties().leftIndent,!0))}}}}class Z5 extends Q5{getNumberingListType(){return tn.Bullet}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.numberingBulleted)}}class e3 extends K5{getNumberingListType(){return tn.MultiLevel}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.numberingMultiLevel)}}class t3 extends EU{getState(e=this.convertToCommandOptions(void 0)){const t=new VU(this.isEnabled(),f.ListUtils.deepCopy(e.intervalsInfo.intervals),this.getValueForState(this.getCurrentValue()));return t.denyUpdateValue=this.isLockUpdateValue(),t}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphFormatting)}executeCore(e,t){const r=this.getDescriptor(),i=this.convertValue(t.param);if(this.getActualValue()!==i){const e=this.history;e.beginTransaction(),r.setProp(this.inputPosition.getMergedParagraphPropertiesFull(),i),r.setProp(this.inputPosition.getMergedParagraphPropertiesRaw(),i);for(let n of t.intervalsInfo.intervals)e.addAndRedo(new(r.getHistoryItemConstructor())(this.modelManipulator,new gu(t.subDocument,n),i,!0));e.endTransaction()}return!0}isLockUpdateValue(){return!1}getCurrentValue(){return this.getDescriptor().getProp(this.inputPosition.getMergedParagraphPropertiesRaw())}getValueForState(e){return e}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}convertValue(e){return e}getActualValue(){return this.getCurrentValue()}convertBooleanParameterToEnumType(e,t,r){return"boolean"==typeof e?e?t:r:this.getCurrentValue()==t?r:t}}class r3 extends t3{getRelatedCommands(){return{[FF.AddSpacingAfterParagraph]:!0,[FF.AddSpacingBeforeParagraph]:!0,[FF.SetSingleParagraphSpacing]:!0,[FF.SetSesquialteralParagraphSpacing]:!0,[FF.SetDoubleParagraphSpacing]:!0,[FF.RemoveSpacingAfterParagraph]:!0,[FF.RemoveSpacingBeforeParagraph]:!0}}}class i3 extends r3{getDescriptor(){return Ft.spacingAfter}isEnabled(){return super.isEnabled()&&0===this.getCurrentValue()}DEPRECATEDConvertOptionsParameter(e){return null==e?g.u.pointsToTwips(12):e}}class n3 extends r3{getDescriptor(){return Ft.spacingBefore}isEnabled(){return super.isEnabled()&&0===this.getCurrentValue()}DEPRECATEDConvertOptionsParameter(e){return null==e?g.u.pointsToTwips(12):e}}class o3 extends t3{getDescriptor(){return Ft.outlineLevel}isLockUpdateValue(){return!0}}class a3 extends EU{getState(){let e=new UU(this.isEnabled());return e.visible=Bb.isVisible(this.control.modelManager.richOptions.control.paragraphFormatting)&&!this.selection.specialRunInfo.isPictureSelected(),e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphFormatting)}executeCore(e,t){var r=t.subDocument.getParagraphIndicesByIntervals(t.intervalsInfo.intervals);const i=this.shouldProcessAsNumberingParagraphs(r,t.subDocument)?this.processNumberingIndentsCommandId():this.processParagraphIndentsCommandId();return this.control.commandManager.getCommand(i).execute(this.control.commandManager.isPublicApiCall,t)}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}shouldProcessAsNumberingParagraphs(e,t){var r=t.paragraphs[e[0]].getAbstractNumberingListIndex();if(r<0)return!1;let i=e.length;for(let n=1;n<i;n++){let i=e[n];if(t.paragraphs[i].getAbstractNumberingListIndex()!==r)return!1}return!0}}class s3 extends a3{processParagraphIndentsCommandId(){return FF.DecrementParagraphLeftIndent}processNumberingIndentsCommandId(){return FF.DecrementNumberingIndent}}class l3 extends a3{processParagraphIndentsCommandId(){return FF.IncrementParagraphLeftIndent}processNumberingIndentsCommandId(){return FF.IncrementNumberingIndent}}class d3 extends t3{executeCore(e,t){const r=t.subDocument,i=this.selection.intervals;if(this.control.commandManager.isPublicApiCall||this.selection.isCollapsed()||f.ListUtils.unsafeAnyOf(i,(e=>{const t=r.getParagraphsByInterval(e);return t.length>1||e.contains(t[0].getEndPosition()-1)})))return super.executeCore(e,t);return new FZ(this.control).execute(this.control.commandManager.isPublicApiCall,t)}getDescriptor(){return Ft.shadingInfo}getValueForState(e){return e?e.getActualColor(this.colorProvider):void 0}isLockUpdateValue(){return!0}DEPRECATEDConvertOptionsParameter(e){return fe.createByColor(he.makeByColor(y.anyToColor(e,y.NO_COLOR)))}}class c3 extends V5{executeCore(e,t){const r=t.subDocument;var i=r.getParagraphIndicesByIntervals(t.intervalsInfo.intervals),n=r.paragraphs[i[0]];if(this.needUpdateFirstLineIndent(n)){this.history.beginTransaction();var o=this.getMaxFirstLineIndent(n,r),a=this.getTabs(i,r),s=this.getFirstLineIndent(n,a);return this.assignParagraphFirstLineIndent(n,s,o,r),this.history.endTransaction(),!0}return this.getParagraphLeftIndentCommand().execute(this.control.commandManager.isPublicApiCall)}assignParagraphFirstLineIndent(e,t,r,i){if(t>0){this.history.addAndRedo(new gt(this.modelManipulator,new gu(i,e.interval),ke.Indented,!0));var n=r-(e.getParagraphMergedProperties().leftIndent+t);n<0&&(t+=n),this.history.addAndRedo(new pt(this.modelManipulator,new gu(i,e.interval),t,!0))}else t<0?(this.history.addAndRedo(new gt(this.modelManipulator,new gu(i,e.interval),ke.Hanging,!0)),this.history.addAndRedo(new pt(this.modelManipulator,new gu(i,e.interval),Math.abs(t),!0))):(this.history.addAndRedo(new gt(this.modelManipulator,new gu(i,e.interval),ke.None,!0)),this.history.addAndRedo(new pt(this.modelManipulator,new gu(i,e.interval),0,!0)))}getFirstLineIndentAbsPosition(e){switch(e.firstLineIndentType){case ke.Indented:return e.leftIndent+e.firstLineIndent;case ke.Hanging:return e.leftIndent-e.firstLineIndent;default:return e.leftIndent}}}class h3 extends c3{getParagraphLeftIndentCommand(){return this.control.commandManager.getCommand(FF.IncrementParagraphLeftIndent)}getMaxFirstLineIndent(e,t){var r=e.startLogPosition.value,i=(t.isMain()?new ug(this.control.layout,t,r,Hu.Column):new pg(this.control.layout,t,r,this.selection.pageIndex,Hu.Column)).create((new cg).setDefault(!1),(new cg).setDefault(!0));if(i)return g.u.pixelsToTwips(i.column.width);var n=this.control.modelManager.model.getSectionByPosition(e.startLogPosition.value);return g.u.pixelsToTwips(TS.findMinimalColumnSize(n.sectionProperties).width)}getFirstLineIndent(e,t){var r=e.getParagraphMergedProperties(),i=this.getFirstLineIndentAbsPosition(r),n=this.getNearRightTab(i,t),o=this.getNearRightDefaultTab(i);return n>i?Math.min(n,o)-r.leftIndent:o-r.leftIndent}needUpdateFirstLineIndent(e){var t=e.getParagraphMergedProperties(),r=t.leftIndent,i=this.getNearRightDefaultTab(t.leftIndent+t.firstLineIndentType);switch(t.firstLineIndentType){case ke.Indented:r+=t.firstLineIndent;break;case ke.Hanging:r-=t.firstLineIndent}return r<i}}class u3 extends c3{getMaxFirstLineIndent(e,t){return Number.MAX_VALUE}getFirstLineIndent(e,t){var r=e.getParagraphMergedProperties(),i=this.getFirstLineIndentAbsPosition(r),n=this.getNearLeftTab(i,t),o=this.getNearLeftDefaultTab(i);return Math.max(0,Math.max(n,o)-r.leftIndent)}needUpdateFirstLineIndent(e){return e.getParagraphMergedProperties().firstLineIndentType===ke.Indented}getParagraphLeftIndentCommand(){return this.control.commandManager.getCommand(FF.DecrementParagraphLeftIndent)}}class p3 extends V5{executeCore(e,t){const r=t.subDocument;var i=r.getParagraphIndicesByIntervals(this.selection.intervals),n=!1;this.history.beginTransaction();var o=this.getTabs(i,r);let a=i.length;for(let e=0;e<a;e++){let t=i[e];n=this.applyLeftIndentToParagraph(r.paragraphs[t],o)||n}return this.history.endTransaction(),n}applyLeftIndentToParagraph(e,t){var r=this.getNewLeftIndent(e,t),i=this.getMaxLeftIndent(e),n=e.interval;if(r===e.getParagraphMergedProperties().leftIndent)return!1;if(r>=0&&e.getParagraphMergedProperties().firstLineIndentType===ke.Hanging){var o=r-e.getParagraphMergedProperties().firstLineIndent;o<0&&(r-=o)}var a=this.modelManipulator;if(this.history.addAndRedo(new ft(a,new gu(this.selection.activeSubDocument,n),r,!0)),e.getParagraphMergedProperties().firstLineIndentType==ke.Indented){var s=i-(e.getParagraphMergedProperties().leftIndent+e.getParagraphMergedProperties().firstLineIndent);s<0&&this.history.addAndRedo(new pt(a,new gu(this.selection.activeSubDocument,n),e.getParagraphMergedProperties().firstLineIndent+s,!0))}return!0}}class g3 extends p3{getNewLeftIndent(e,t){var r=e.getParagraphMergedProperties(),i=this.getNearRightDefaultTab(r.leftIndent),n=this.getNearRightTab(r.leftIndent,t),o=i<n||n===r.leftIndent?i:n,a=this.getPosition(e);if(!a){var s=this.control.modelManager.model.getSectionByPosition(e.startLogPosition.value),l=TS.findMinimalColumnSize(s.sectionProperties);return Math.min(o,g.u.pixelsToTwips(l.width))}return Math.min(o,g.u.pixelsToTwips(a.column.width))}getMaxLeftIndent(e){var t=this.getPosition(e);if(t)return g.u.pixelsToTwips(t.column.width);var r=this.control.modelManager.model.getSectionByPosition(e.startLogPosition.value);return g.u.pixelsToTwips(TS.findMinimalColumnSize(r.sectionProperties).width)}getPosition(e){var t=this.selection.activeSubDocument;return(t.isMain()?new ug(this.control.layout,t,e.startLogPosition.value,Hu.Column):new pg(this.control.layout,t,e.startLogPosition.value,this.selection.pageIndex,Hu.Column)).create((new cg).setDefault(!1),(new cg).setDefault(!0))}}class m3 extends p3{getNewLeftIndent(e,t){var r=e.getParagraphMergedProperties(),i=this.getNearLeftDefaultTab(r.leftIndent),n=this.getNearLeftTab(r.leftIndent,t);return i>n||n==r.leftIndent?i:n}getMaxLeftIndent(e){return Number.MAX_VALUE}}class f3 extends r3{getDescriptor(){return Ft.spacingAfter}DEPRECATEDConvertOptionsParameter(e){return null!=e?e:0}isEnabled(){return super.isEnabled()&&this.inputPosition.getMergedParagraphPropertiesFull().spacingAfter>0}}class b3 extends r3{getDescriptor(){return Ft.spacingBefore}DEPRECATEDConvertOptionsParameter(e){return null!=e?e:0}isEnabled(){return super.isEnabled()&&this.inputPosition.getMergedParagraphPropertiesFull().spacingBefore>0}}class C3 extends r3{getDescriptor(){return Ft.lineSpacingType}getValueForState(e){return e==this.getSpacingType()}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,this.getSpacingType(),this.getSpacingType())}}class S3 extends C3{getSpacingType(){return Ne.Single}}class I3 extends C3{getSpacingType(){return Ne.Sesquialteral}}class P3 extends C3{getSpacingType(){return Ne.Double}}class w3 extends t3{getDescriptor(){return Ft.alignment}getValueForState(e){return e==this.getParagraphAlignment()}DEPRECATEDConvertOptionsParameter(e){return this.convertBooleanParameterToEnumType(e,this.getParagraphAlignment(),this.getOppositeAlignment())}getRelatedCommands(){return{[FF.ToggleParagraphAlignmentCenter]:!0,[FF.ToggleParagraphAlignmentJustify]:!0,[FF.ToggleParagraphAlignmentLeft]:!0,[FF.ToggleParagraphAlignmentRight]:!0}}getOppositeAlignment(){return Ae.Left}}class y3 extends w3{getParagraphAlignment(){return Ae.Left}getOppositeAlignment(){return Ae.Justify}}class x3 extends w3{getParagraphAlignment(){return Ae.Center}}class T3 extends w3{getParagraphAlignment(){return Ae.Right}}class v3 extends w3{getParagraphAlignment(){return Ae.Justify}}class M3 extends EU{getState(){return new UU(this.isEnabled()&&this.history.canRedo())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.undo)}executeCore(e,t){return!!e.enabled&&(this.history.redo(),!0)}canModify(){return!0}}!function(e){e[e.None=0]="None",e[e.Insert=1]="Insert",e[e.Delete=2]="Delete"}(P2||(P2={}));class E3 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphTabs)}executeCore(e,t){const r=an.getSelectedParagraphs(t.intervalsInfo.intervals,t.subDocument);return this.history.beginTransaction(),this.executeHistoryItems(this.modelManipulator,t.subDocument,r.intervals[0],r.paragraphs[0],t.param),this.history.endTransaction(),!0}findTabByPosition(e,t){var r=C.SearchUtils.binaryIndexOf(e.tabs.tabsInfo,(e=>e.position-t));return r>-1?e.tabs.tabsInfo[r]:null}getIntervalsForModifying(){return an.getIntervalsOfSelectedParagraphs(this.selection.intervals,this.selection.activeSubDocument)}}class D3 extends E3{executeHistoryItems(e,t,r,i,n){var o=new rs(g.u.pixelsToTwips(n.position),n.align,Sg.None,!1,!1);this.history.addAndRedo(new nt(e,new gu(t,r),o))}}class F3 extends E3{executeHistoryItems(e,t,r,i,n){var o=this.findTabByPosition(i,g.u.pixelsToTwips(n));this.history.addAndRedo(new ot(e,new gu(t,r),o))}}class R3 extends E3{executeHistoryItems(e,t,r,i,n){var o=this.findTabByPosition(i,g.u.pixelsToTwips(n.start)),a=o.clone();a.position=g.u.pixelsToTwips(n.end),this.history.addAndRedo(new ot(e,new gu(t,r),o)),this.history.addAndRedo(new nt(e,new gu(t,r),a))}}class L3 extends EU{DEPRECATEDCorrectlMainCommandOptions(e){const t=this.selection.lastSelectedInterval;e.intervalsInfo.intervals=[new on.FixedInterval(this.selection.forwardDirection?t.end:t.start,0)]}getState(e=this.convertToCommandOptions(void 0)){for(var t,r=e.intervalsInfo.interval,i=r.start,n=C.SearchUtils.normedInterpolationIndexOf(this.control.modelManager.model.sections,(e=>e.startLogPosition.value),i),o=this.control.modelManager.model.sections[n],a=TS.generateSectionColumns(o.sectionProperties),s=[],l=0;t=a[l];l++)if(s.push(new Sh(t.width,0)),l>0){var d=a[l-1];s[l-1].space=t.x-(d.x+d.width)}var c=e.subDocument.isMain()?new ug(this.control.layout,e.subDocument,i,Hu.Column).create((new cg).setDefault(!1),(new cg).setDefault(!0)):null;return new zU(this.isEnabled(),r,s,o.sectionProperties.equalWidthColumns,c?c.columnIndex:0)}executeCore(e,t){var r=e,i=!1,n=this.modelManipulator;if(r.equalWidth){var o=r.value[0];t.param[0].space!==o.space&&(this.history.addAndRedo(new mI(n,r.interval,g.u.pixelsToTwips(t.param[0].space))),i=!0)}else{var a=[],s=r.value;f.ListUtils.forEach(t.param,((e,t)=>{i=i||e.width!==s[t].width||e.space!==s[t].space,a.push(new Sh(g.u.pixelsToTwips(e.width),g.u.pixelsToTwips(e.space||0)))})),i&&this.history.addAndRedo(new bI(n,r.interval,a))}return i}}class B3 extends EU{DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.interval=this.selection.lastSelectedInterval}getLayoutTextBox(){const e=this.selection.specialRunInfo.getParentSubDocument().id,t=this.selection.specialRunInfo.getPosition(),r=this.control.layout.pages[this.selection.pageIndex];return r?r.anchoredObjectHolder.getObjectByModelPosition(this.control.layout,t,e):null}isEnabled(e){return super.isEnabled()&&!this.selection.activeSubDocument.isTextBox()&&(!this.control.modelManager.model.isDocumentProtectionEnabled||B0.rangePermissionIncludeFullSection(this.control,this.selection.activeSubDocument,this.selection.intervals))}}class A3 extends B3{getState(e=this.convertToCommandOptions(void 0)){let t=0;if(e.subDocument.isTextBox()){const e=this.getLayoutTextBox();e&&(t=e.x+e.textBoxProperties.leftMargin)}else t=g.u.twipsToPixelsF(this.inputPosition.getMergedSectionPropertiesRaw().marginLeft);return new HU(this.isEnabled(e),e.intervalsInfo.interval,t)}executeCore(e,t){var r=t.intervalsInfo.interval,i=g.u.pixelsToTwips(t.param);return this.history.addAndRedo(new cI(this.modelManipulator,r,i)),!0}}class N3 extends B3{getState(e=this.convertToCommandOptions(void 0)){let t=0;if(e.subDocument.isTextBox()){const e=this.getLayoutTextBox();if(e){t=g.u.twipsToPixelsF(this.inputPosition.getMergedSectionPropertiesRaw().pageWidth)-e.x-e.width+e.textBoxProperties.rightMargin}}else t=g.u.twipsToPixelsF(this.inputPosition.getMergedSectionPropertiesRaw().marginRight);return new HU(this.isEnabled(e),e.intervalsInfo.interval,t)}executeCore(e,t){var r=e.interval,i=g.u.pixelsToTwips(t.param);return this.history.addAndRedo(new uI(this.modelManipulator,r,i)),!0}}class k3 extends EU{getState(){return new UU(this.isEnabled(),this.control.horizontalRulerControl.getVisible())}executeCore(e,t){const r=this.control.horizontalRulerControl.getVisible();if(t.param==r)return!1;const i=!r;return this.control.horizontalRulerControl.setVisible(i),this.control.owner.adjustControl(),this.control.owner.raiseHorizontalRulerVisibleChanged(i),!0}isEnabled(e){return!this.control.innerClientProperties.viewsSettings.isSimpleView&&super.isEnabled(e)}isEnabledInReadOnlyMode(){return!0}}class O3 extends B0{getStateValue(e){return this.getCurrentValue()}executeCore(e,t){const r=t.param;if(this.getCurrentValue()!=r){this.getDescriptor().setProp(this.inputPosition.getMergedSectionPropertiesRaw(),r);const e=this.getAffectedSectionsIterator(t.intervalsInfo.intervals);for(;e.moveNext();)this.history.addAndRedo(new(this.getDescriptor().getHistoryItemConstructor())(this.modelManipulator,e.obj.interval,r));return!0}return!1}getCurrentValue(){return this.getDescriptor().getProp(this.inputPosition.getMergedSectionPropertiesRaw())}}class _3 extends O3{getDescriptor(){return vI.footerOffset}}class U3 extends _3{DEPRECATEDConvertOptionsParameter(e){return this.control.uiUnitConverter.UIToTwips(e)}getStateValue(e=this.convertToCommandOptions(null)){return this.control.uiUnitConverter.twipsToUI(super.getStateValue(e))}isEnabled(e){return super.isEnabled(e)&&this.control.innerClientProperties.viewsSettings.isPrintLayoutView&&this.selection.activeSubDocument.isHeaderFooter()}}class H3 extends O3{getDescriptor(){return vI.headerOffset}}class V3 extends H3{DEPRECATEDConvertOptionsParameter(e){return this.control.uiUnitConverter.UIToTwips(e)}getStateValue(e=this.convertToCommandOptions(null)){return this.control.uiUnitConverter.twipsToUI(super.getStateValue(e))}isEnabled(e){return super.isEnabled(e)&&this.control.innerClientProperties.viewsSettings.isPrintLayoutView&&this.selection.activeSubDocument.isHeaderFooter()}}class W3 extends O3{getDescriptor(){return vI.landscape}DEPRECATEDConvertOptionsParameter(e){return this.isLandscape()}getStateValue(){return this.getCurrentValue()==this.isLandscape()}getRelatedCommands(){return{[FF.SetLandscapePageOrientation]:!0,[FF.SetPortraitPageOrientation]:!0}}executeCore(e,t){const r=this.history;r.beginTransaction();const i=super.executeCore(e,t);if(i){const e=this.inputPosition.getMergedSectionPropertiesFull().pageSize,i=this.getAffectedSectionsIterator(t.intervalsInfo.intervals);for(;i.moveNext();)r.addAndRedo(new(vI.pageWidth.getHistoryItemConstructor())(this.modelManipulator,i.obj.interval,e.height)),r.addAndRedo(new(vI.pageHeight.getHistoryItemConstructor())(this.modelManipulator,i.obj.interval,e.width))}return r.endTransaction(),i}isLandscape(){return!0}}class z3 extends W3{isLandscape(){return!1}}class j3 extends B0{getCurrentValue(){return this.inputPosition.getMergedSectionPropertiesRaw().margins.clone()}executeCore(e,t){const r=t.param;if(!this.getCurrentValue().equals(r)){vI.marginLeft.setProp(this.inputPosition.getMergedSectionPropertiesRaw(),r.left),vI.marginTop.setProp(this.inputPosition.getMergedSectionPropertiesRaw(),r.top),vI.marginRight.setProp(this.inputPosition.getMergedSectionPropertiesRaw(),r.right),vI.marginBottom.setProp(this.inputPosition.getMergedSectionPropertiesRaw(),r.bottom);const e=this.getAffectedSectionsIterator(t.intervalsInfo.intervals);for(this.history.beginTransaction();e.moveNext();){const t=e.obj.interval;this.setMargin(t,vI.marginLeft,r.left),this.setMargin(t,vI.marginTop,r.top),this.setMargin(t,vI.marginRight,r.right),this.setMargin(t,vI.marginBottom,r.bottom)}return this.history.endTransaction(),!0}return!1}setMargin(e,t,r){this.history.addAndRedo(new(t.getHistoryItemConstructor())(this.modelManipulator,e,r))}getRelatedCommands(){return{[FF.SetSectionPageMargins]:!0,[FF.SetNarrowSectionPageMargins]:!0,[FF.SetNormalSectionPageMargins]:!0,[FF.SetModerateSectionPageMargins]:!0,[FF.SetWideSectionPageMargins]:!0}}}class X3 extends j3{getStateValue(){return this.getCurrentValue()}}class G3 extends j3{getStateValue(){return this.getPredefinedMargins().equals(this.getCurrentValue())}DEPRECATEDConvertOptionsParameter(e){return this.getPredefinedMargins()}}class K3 extends G3{getPredefinedMargins(){return new jc.m(1700,850,1133,1133)}}class q3 extends G3{getPredefinedMargins(){return new jc.m(720,720,720,720)}}class $3 extends G3{getPredefinedMargins(){return new jc.m(1080,1080,1440,1440)}}class J3 extends G3{getPredefinedMargins(){return new jc.m(2880,2880,1440,1440)}}class Y3 extends O3{getDescriptor(){return vI.columnCount}isEnabled(e){return super.isEnabled(e)&&this.selection.activeSubDocument.isMain()}getCurrentValue(){return this.inputPosition.getMergedSectionPropertiesRaw().equalWidthColumns?super.getCurrentValue():void 0}getRelatedCommands(){return{[FF.SetSectionOneColumn]:!0,[FF.SetSectionTwoColumns]:!0,[FF.SetSectionThreeColumns]:!0}}executeCore(e,t){const r=this.history;r.beginTransaction();const i=super.executeCore(e,t);if(i){const e=this.getAffectedSectionsIterator(t.intervalsInfo.intervals);for(;e.moveNext();)r.addAndRedo(new(vI.equalWidthColumns.getHistoryItemConstructor())(this.modelManipulator,e.obj.interval,!0))}return r.endTransaction(),i}}class Q3 extends Y3{}class Z3 extends Y3{getStateValue(e){return e.param===this.getCurrentValue()}}class e4 extends Z3{DEPRECATEDConvertOptionsParameter(e){return 1}}class t4 extends Z3{DEPRECATEDConvertOptionsParameter(e){return 2}}class r4 extends Z3{DEPRECATEDConvertOptionsParameter(e){return 3}}class i4 extends B0{executeCore(e,t){const r=t.param;var i=this.modelManipulator;const n=this.history,o=this.getAffectedSectionsIterator(t.intervalsInfo.intervals),a=r.size.width>r.size.height;let s=!1;for(n.beginTransaction();o.moveNext();){const e=o.obj.interval,t=o.obj.sectionProperties;var l=t.landscape;r.updateOrientation&&l!==a&&(n.addAndRedo(new PI(i,e,a)),s=!0);var d=r.updateOrientation||!l?r.size.width:r.size.height;t.pageWidth!==d&&(n.addAndRedo(new CI(i,e,d)),s=!0);var c=r.updateOrientation||!l?r.size.height:r.size.width;t.pageHeight!==c&&(n.addAndRedo(new SI(i,e,c)),s=!0);const h=r.paperKind;t.paperKind!==h&&(n.addAndRedo(new TI(i,e,h)),s=!0)}return n.endTransaction(),s}getStateValue(e){return this.inputPosition.getMergedSectionPropertiesRaw().pageSize}static compareSizeByTwoDimensions(e,t){return e.equals(t)||e.width==t.height&&e.height==t.width}}class n4 extends i4{DEPRECATEDConvertOptionsParameter(e){const t=this.getPaperKind(),r=Ih.calculatePaperSize(t),i=this.inputPosition.getMergedSectionPropertiesRaw().pageSize;return i4.compareSizeByTwoDimensions(i,r)?{size:i,updateOrientation:!1,paperKind:t}:{size:r,updateOrientation:!1,paperKind:t}}getStateValue(e){const t=Ih.calculatePaperSize(this.getPaperKind()),r=this.inputPosition.getMergedSectionPropertiesRaw().pageSize;return i4.compareSizeByTwoDimensions(t,r)?r:null}getStateCore(e,t,r){const i=super.getStateCore(e,t,r);return i.checked=null!==r,i}getRelatedCommands(){return{[FF.SetSectionLetterPaperKind]:!0,[FF.SetSectionLegalPaperKind]:!0,[FF.SetSectionFolioPaperKind]:!0,[FF.SetSectionA4PaperKind]:!0,[FF.SetSectionA5PaperKind]:!0,[FF.SetSectionA6PaperKind]:!0,[FF.SetSectionB5PaperKind]:!0,[FF.SetSectionExecutivePaperKind]:!0}}}class o4 extends n4{getPaperKind(){return Vc.Letter}}class a4 extends n4{getPaperKind(){return Vc.Legal}}class s4 extends n4{getPaperKind(){return Vc.Folio}}class l4 extends n4{getPaperKind(){return Vc.A4}}class d4 extends n4{getPaperKind(){return Vc.A5}}class c4 extends n4{getPaperKind(){return Vc.A6}}class h4 extends n4{getPaperKind(){return Vc.B5}}class u4 extends n4{getPaperKind(){return Vc.Executive}}class p4 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){this.control.layoutFormatterManager.formatSyncAllDocument();const r=this.selection.activeSubDocument,i=this.control.layout,n=r.isMain()?i.getLastValidPage():i.pages[this.selection.pageIndex];if(this.extendSelection())this.setSelection(r.isMain()?n.getEndPosition():n.otherPageAreas[r.id].getEndPosition());else{var o=n.mainSubDocumentPageAreas,a=o[o.length-1],s=a.columns[a.columns.length-1],l=s.rows[s.rows.length-1],d=l.getLastVisibleBoxIndex();if(d>=0){var c=l.boxes[d];this.setSelection((r.isMain()?n.getPosition():0)+a.pageOffset+s.pageAreaOffset+l.columnOffset+c.getEndPosition())}else{c=l.boxes[0];this.setSelection((r.isMain()?n.getPosition():0)+a.pageOffset+s.pageAreaOffset+l.columnOffset+c.rowOffset)}}return!0}isEnabledInReadOnlyMode(){return!0}}class g4 extends p4{setSelection(e){this.selection.deprecatedSetSelection(e,e,!1,-1,!0)}extendSelection(){return!1}}class m4 extends p4{setSelection(e){this.selection.changeState((t=>t.extendLastInterval(e).resetKeepX().setEndOfLine(!1)))}extendSelection(){return!0}}class f4 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){return this.control.layout.validPageCount<1&&this.control.layoutFormatterManager.forceFormatPage(0),this.setSelection(this.control.layout.pages[0].getPosition()),!0}isEnabledInReadOnlyMode(){return!0}}class b4 extends f4{setSelection(e){this.selection.deprecatedSetSelection(e,e,!1,-1,!0)}}class C4 extends f4{setSelection(e){this.selection.changeState((t=>t.extendLastInterval(e).resetKeepX().setEndOfLine(!1)))}}class S4 extends EU{getState(){return new UU(this.isEnabled())}isEnabledInReadOnlyMode(){return!0}}class I4 extends S4{extendTableCellsSelection(){const e=this.getInitialLayoutPosition();if(!e)return!1;const t=new U$(e,this.control.layout,this.control.measurer),r=this.getSelectedCells(),i=this.selection.tableInfo.extendedData.areCellsSelectedInSeries;if(this.extendSelection()&&(r.length>1||this.canGoToNextTableRow(t))&&i){let e=this.selection.isCollapsed()?this.isForwardDirection():this.selection.forwardDirection,t=r[0][0].parentRow.parentTable,i=this.getCurrentTableRow(r),n=C.SearchUtils.binaryIndexOf(t.rows,(e=>e.getStartPosition()-i.getStartPosition()));if(this.checkTableRowIndex(n,t.rows.length)){let i=this.getNextTableRow(t,n),o=r[0][0],a=r[r.length-1][r[r.length-1].length-1];return this.performTableCellsSelection(e,i,o,a)}this.performSelectionOnTheLastTableRow(e,r)}return!1}getSelectedCells(){let e=f.ListUtils.map(this.selection.tableInfo.rawData.rows,(e=>f.ListUtils.map(e.cells,(e=>e.cell)))),t=ug.createLightLayoutPosition(this.control.layout,this.selection.activeSubDocument,this.getInitialSelectionEndPosition(),this.selection.pageIndex,Hu.Character,!0,!1);if(!e.length&&t.row.tableCellInfo){let r=t.row.tableCellInfo.parentRow.parentTable.logicInfo.grid.table,i=t.row.tableCellInfo.parentRow.rowIndex;e=[];for(let t=0;t<=i;t++)e.push(r.rows[t].cells)}return e}getLogPositionByX(e,t){var r=e.clone(),i=Math.max(0,t-(r.page.x+r.pageArea.x+r.column.x+r.row.x)),n=C.SearchUtils.normedInterpolationIndexOf(r.row.boxes,(e=>e.x),i);n<0&&(n=0),r.box=r.row.boxes[n];var o=!1;if(!r.box.isVisible()){var a=r.row.getLastVisibleBoxIndex();a<0&&(a=0,o=!0),r.boxIndex=a,r.box=r.row.boxes[a]}var s=o?0:i-r.box.x;return r.getLogPosition(Hu.Box)+r.box.calculateCharOffsetByPointX(this.control.measurer,s)}isEndOfLine(e,t){return t===e.getLogPosition(Hu.Row)+e.row.getLastBoxEndPositionInRow()}selectTableCellsRange(e){return this.control.commandManager.getCommand(FF.SelectTableCellsRange).execute(this.control.commandManager.isPublicApiCall,e)}executeCore(e,t){if(this.extendTableCellsSelection())return!0;var r=this.selection,i=this.control.layout,n=this.selection.activeSubDocument;let o=this.getInitialLayoutPosition();if(!o)return!1;var a,s=r.keepX;s<0&&(s=o.page.x+o.pageArea.x+o.column.x+o.row.x+o.box.x+o.box.getCharOffsetXInPixels(this.control.measurer,o.charOffset));var l=new U$(o,i,this.control.measurer);if(this.canAdvanceToNextRow(l))a=l.getModifyPosition();else{var d=o.getLogPosition(Hu.Character);if((a=this.getNewLayoutPositionRowLevel(o))&&this.extendSelection())(0==d||d==n.getDocumentEndPosition())&&d!=this.getLogPositionByX(o,s)&&(a=o.clone());else if(!a){var c=this.getPositionForEdgeLine(o);if(this.extendSelection()&&d!=c)return this.selection.changeState((e=>e.extendLastInterval(c).setKeepX(s).setEndOfLine(this.isEndOfLine(o,c)))),!0;if(!this.extendSelection()){var h=r.lastSelectedInterval;h&&h.length>0&&r.deprecatedSetSelection(c,c,this.isEndOfLine(o,c),s,!0)}return!1}}var u=this.getLogPositionByX(a,s);if(u==o.getLogPosition())return!1;var p=this.isEndOfLine(a,u);return this.extendSelection()?(this.selection.changeState((e=>e.extendLastInterval(u).setKeepX(s).setEndOfLine(p))),this.selection.scrollManager.setScroll((new xD).byModelPosition(this.selection).setModelPosition(u).useStdRelativePosition().useStdOffset())):r.deprecatedSetSelection(u,u,p,s,!0),!0}getInitialLayoutPosition(){const e=this.selection,t=e.activeSubDocument,r=this.getInitialSelectionEndPosition(),i=e.endOfLine;return(t.isMain()?new ug(this.control.layout,t,r,Hu.Character):new pg(this.control.layout,t,r,e.pageIndex,Hu.Character)).create((new cg).setDefault(i),(new cg).setDefault(!1))}canGoToNextTableRow(e){return!1}checkTableRowIndex(e,t){throw new Error(R.D.NotImplemented)}getCurrentTableRow(e){throw new Error(R.D.NotImplemented)}getNextTableRow(e,t){throw new Error(R.D.NotImplemented)}performTableCellsSelection(e,t,r,i){let n=e?i:r,o=oc.getCellIndexByColumnIndex(t,oc.getStartColumnIndex(n));const a=e?r:i,s=t.cells[o];if(a===s){const t=a.startParagraphPosition.value,r=a.endParagrapPosition.value-1;return this.selection.changeState((i=>i.setInterval(on.FixedInterval.fromPositions(t,r)).setForwardDirection(e))),!0}return this.selectTableCellsRange({firstCell:a,lastCell:s})}performSelectionOnTheLastTableRow(e,t){throw new Error(R.D.NotImplemented)}isForwardDirection(){throw new Error(R.D.NotImplemented)}}class P4 extends I4{extendSelection(){return!1}getPositionForEdgeLine(e){return this.selection.lastSelectedInterval.start}canAdvanceToNextRow(e){return e.tryAdvanceToAboveRow()}getNewLayoutPositionRowLevel(e){var t=e.clone();return t.advanceToPrevRow(this.control.layout)?t:null}getInitialSelectionEndPosition(){return this.extendSelection()&&this.selection.forwardDirection?this.selection.lastSelectedInterval.end:this.selection.lastSelectedInterval.start}isForwardDirection(){return!1}}class w4 extends P4{extendSelection(){return!0}getPositionForEdgeLine(e){return e.getLogPosition(Hu.Row)}canAdvanceToNextRow(e){return!1}canGoToNextTableRow(e){return e.canAdvanceToAboveRow()}getCurrentTableRow(e){return this.selection.forwardDirection?e[e.length-1][e[e.length-1].length-1].parentRow:e[0][0].parentRow}checkTableRowIndex(e,t=0){return e>-1&&0!=e}getNextTableRow(e,t){return e.rows[t-1]}performSelectionOnTheLastTableRow(e,t){if(!e){let e=t[0][0].parentRow.parentTable,r=t[t.length-1][t[t.length-1].length-1];const i=C.SearchUtils.binaryIndexOf(e.rows,(e=>e.getStartPosition()-r.parentRow.getStartPosition())),n=0;this.selectTableCellsRange({firstCell:e.rows[i].cells[e.rows[i].cells.length-1],lastCell:e.rows[n].cells[0]})}}}class y4 extends I4{extendSelection(){return!1}getPositionForEdgeLine(e){var t=this.selection.lastSelectedInterval.end;return this.selection.activeSubDocument.getDocumentEndPosition()==t&&t--,t}canAdvanceToNextRow(e){return e.tryAdvanceToBelowRow()}getNewLayoutPositionRowLevel(e){var t=e.clone();return t.advanceToNextRow(this.control.layout)?t:null}getInitialSelectionEndPosition(){return this.extendSelection()&&!this.selection.forwardDirection?this.selection.lastSelectedInterval.start:this.selection.lastSelectedInterval.end}isForwardDirection(){return!0}}class x4 extends y4{extendSelection(){return!0}getPositionForEdgeLine(e){return e.getLogPosition(Hu.Row)+e.row.getLastBoxEndPositionInRow()}canAdvanceToNextRow(e){return!1}canGoToNextTableRow(e){return e.canAdvanceToBelowRow()}getCurrentTableRow(e){return this.selection.forwardDirection?e[e.length-1][0].parentRow:e[0][0].parentRow}checkTableRowIndex(e,t=0){return e>-1&&e<t-1}getNextTableRow(e,t){return e.rows[t+1]}performSelectionOnTheLastTableRow(e,t){if(e){let e=t[0][0].parentRow.parentTable;const r=C.SearchUtils.binaryIndexOf(e.rows,(e=>e.getStartPosition()-t[0][0].parentRow.getStartPosition())),i=e.rows.length-1;this.selectTableCellsRange({firstCell:e.rows[r].cells[0],lastCell:e.rows[i].cells[e.rows[i].cells.length-1]})}}}class T4 extends S4{executeCore(e,t){var r=this.getEndPosition();return!(r<0)&&(this.setSelection(r,-1),!0)}getEndPosition(){var e=this.selection;this.endOfLine=!0;var t=e.forwardDirection?e.lastSelectedInterval.end:e.lastSelectedInterval.start,r=this.selection.activeSubDocument,i=(r.isMain()?new ug(this.control.layout,r,t,Hu.Character):new pg(this.control.layout,r,t,e.pageIndex,Hu.Character)).create((new cg).setDefault(e.endOfLine),(new cg).setDefault(!1));return i?this.getEndPositionCore(i):-1}}class v4 extends T4{setSelection(e,t){this.selection.deprecatedSetSelection(e,e,this.endOfLine,t,!0)}getEndPositionCore(e){var t=e.row.getLastVisibleBox();return t||(this.endOfLine=!1),e.getLogPosition(Hu.Row)+(t?t.getEndPosition():0)}}class M4 extends T4{setSelection(e,t){this.selection.changeState((r=>r.extendLastInterval(e).setKeepX(t).setEndOfLine(this.endOfLine)))}getEndPositionCore(e){return e.getLogPosition(Hu.Row)+e.row.getLastBoxEndPositionInRow()}}class E4 extends S4{getStartPosition(){var e=this.selection,t=e.forwardDirection?e.lastSelectedInterval.end:e.lastSelectedInterval.start,r=this.selection.activeSubDocument,i=(r.isMain()?new ug(this.control.layout,r,t,Hu.Character):new pg(this.control.layout,r,t,e.pageIndex,Hu.Character)).create((new cg).setDefault(e.endOfLine),(new cg).setDefault(!0));return i?i.getLogPosition(Hu.Row):-1}}class D4 extends E4{executeCore(e,t){var r=this.getStartPosition();return!(r<0)&&(this.selection.deprecatedSetSelection(r,r,!1,-1,!0),!0)}}class F4 extends E4{executeCore(e,t){const r=this.getStartPosition();return!(r<0)&&(this.selection.changeState((e=>e.extendLastInterval(r).resetKeepX().setEndOfLine(!1))),!0)}}class R4 extends S4{executeCore(e,t){var r=this.getPosition();return-1!=r&&(this.setSelection(r),!0)}getPosition(){var e,t=this.selection,r=this.selection.activeSubDocument,i=t.forwardDirection?t.lastSelectedInterval.end:t.lastSelectedInterval.start,n=r.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,r,i,Hu.Character,(new cg).setDefault(t.endOfLine),(new cg).setCustom(!0,!0,!1,!1)):new pg(this.control.layout,r,i,t.pageIndex,Hu.Character).create((new cg).setDefault(t.endOfLine),(new cg).setCustom(!0,!0,!1,!1));if(this.extendSelection())(e=n).getLogPosition()==i?(e=this.getNextCharacterPosition(e)).isPositionBeforeFirstBoxInRow()&&(e=this.getNextCharacterPosition(e)):(e.isPositionBeforeFirstBoxInRow()||e.getLogPosition()<i)&&(e=this.getNextCharacterPosition(e));else{if(!t.isCollapsed()){var o;if(t.forwardDirection)o=n.getLogPosition();else{var a=t.lastSelectedInterval.end;o=(r.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,r,a,Hu.Character,(new cg).setDefault(t.endOfLine),(new cg).setDefault(!0)):new pg(this.control.layout,r,a,t.pageIndex,Hu.Character).create((new cg).setDefault(t.endOfLine),(new cg).setDefault(!0))).getLogPosition()}return o<r.getDocumentEndPosition()?o:o-1}var s=(e=n).getLogPosition()==i;if(s||(s=Md.binaryIndexOf(r.fields,i+1)>=0),s){e.box.getLength()==e.charOffset&&(e=this.getNextCharacterPosition(e));do{var l=e;if(l===(e=this.getNextCharacterPosition(l))){e=n;break}}while(!e.box.isVisible()&&!e.isPositionBeforeFirstBoxInRow())}}const d=Math.max(i,e.getLogPosition());return d==i?-1:d}getNextCharacterPosition(e){const t=e.clone();return t.charOffset+1<=t.box.getLength()?(t.charOffset++,t):(t.charOffset=0,t.boxIndex+1<t.row.boxes.length?(t.boxIndex++,t.box=t.row.boxes[t.boxIndex],t):(t.boxIndex=0,t.advanceToNextRow(this.control.layout)?(t.box=t.row.boxes[0],t):e))}}class L4 extends R4{setSelection(e){this.selection.deprecatedSetSelection(e,e,!1,-1,!0)}extendSelection(){return!1}}class B4 extends R4{setSelection(e){this.selection.changeState((t=>t.extendLastInterval(e).resetKeepX().setEndOfLine(!1)))||B4.jumpThroughFieldToRight(this.selection)}extendSelection(){return!0}executeCore(e,t){const r=this.selection,i=r.tableInfo,n=i.rawData;if(!(i.isSelected&&n.areCellsSelectedInSeries&&n.atLeastOneCellFullySelected(r.intervals)))return super.executeCore(e,t);const o=r.forwardDirection||1==n.firstRowInfo.cells.length,a=o?n.lastRowInfo:n.firstRowInfo,s=a.row[(o?f.ListUtils.last(a.cells):a.cells[0]).cellIndex+1];return s?this.control.commandManager.getCommand(FF.SelectTableCellsRange).execute(this.control.commandManager.isPublicApiCall,o?{firstCell:n.firstCell,lastCell:s}:{firstCell:n.lastCell,lastCell:s}):this.control.commandManager.getCommand(FF.ExtendLineDown).execute(this.control.commandManager.isPublicApiCall)}static jumpThroughFieldToRight(e){const t=e.activeSubDocument.fields;if(0!=t.length&&!e.forwardDirection){var r=e.lastSelectedInterval.start,i=t[Math.max(0,Md.normedBinaryIndexOf(t,r+1))];i.getFieldStartPosition()==r&&e.changeState((e=>e.extendLastInterval(i.getFieldEndPosition()).setEndOfLine(!1).resetKeepX()))}}}class A4 extends S4{getPosition(){var e=this.selection,t=e.forwardDirection?e.lastSelectedInterval.end:e.lastSelectedInterval.start,r=new ug(this.control.layout,this.selection.activeSubDocument,t,Hu.Character).create((new cg).setDefault(e.endOfLine),(new cg).setDefault(!1));if(!r)return-1;var i=t-r.getLogPosition(Hu.Box),n=r.pageArea.x+r.column.x+r.row.x+r.box.x+r.box.getCharOffsetXInPixels(this.control.measurer,i),o=r.pageArea.y+r.column.y+r.row.y+r.box.y,a=r.pageIndex+1;if(this.control.layoutFormatterManager.forceFormatPage(a)){var s=new zp(a,n,o),l=this.control.hitTestManager.calculate(s,Hu.Character,this.selection.activeSubDocument);return this.extendSelection()||l.correctAsVisibleBox(),l.getPosition()}return this.selection.activeSubDocument.getDocumentEndPosition()-1}isEnabled(){return super.isEnabled()&&this.selection.activeSubDocument.isMain()}}class N4 extends A4{executeCore(e,t){var r=this.selection,i=this.getPosition();return!(i<0)&&(r.deprecatedSetSelection(i,i,r.endOfLine,r.keepX,!0),!0)}extendSelection(){return!1}}class k4 extends A4{executeCore(e,t){const r=this.getPosition();return!(r<0)&&(this.selection.changeState((e=>e.extendLastInterval(r))),!0)}extendSelection(){return!0}}class O4 extends EU{getState(){return new UU(this.isEnabled())}getStartPosition(){var e=this.selection;return e.forwardDirection?e.lastSelectedInterval.end:e.lastSelectedInterval.start}isEnabledInReadOnlyMode(){return!0}}class _4 extends O4{executeCore(e,t){const r=this.selection,i=this.selection.activeSubDocument;let n=hX.getLayoutWordEndBound(this.control.layout,i,r,this.getStartPosition(),!0);return n==i.getDocumentEndPosition()&&n--,r.deprecatedSetSelection(n,n,!1,r.keepX,!0),!0}}class U4 extends O4{executeCore(e,t){const r=hX.getLayoutWordEndBound(this.control.layout,this.selection.activeSubDocument,this.selection,this.getStartPosition(),!0);return this.selection.changeState((e=>e.extendLastInterval(r).resetKeepX().setEndOfLine(!1)))||B4.jumpThroughFieldToRight(this.selection),!0}}class H4 extends S4{executeCore(e,t){var r=this.selection,i=this.getPositionEndParagraph();return!(i<0)&&(this.extendSelection()?this.selection.changeState((e=>e.extendLastInterval(i).setEndOfLine(!1))):r.deprecatedSetSelection(i,i,!1,r.keepX,!0),!0)}getPositionEndParagraph(){var e=this.selection;const t=this.selection.activeSubDocument;var r=this.control.layout;const i=t.isMain()?r.getLastValidPage().getEndPosition():r.pages[e.pageIndex].otherPageAreas[t.id].getEndPosition();var n=e.forwardDirection?e.lastSelectedInterval.end:e.lastSelectedInterval.start;const o=t.isMain()?new rm(t,r,n,i):new im(t,r,n,i,this.selection.pageIndex);if(!o.isInitialized())return-1;for(;o.moveNext((new cg).setDefault(!1),(new cg).setDefault(!0));)if(o.position.box.getType()==lc.ParagraphMark||o.position.box.getType()==lc.SectionMark)return o.moveNext((new cg).setDefault(!1),(new cg).setDefault(!0)),o.position.getLogPosition()==i?o.position.getLogPosition(Hu.Box):o.position.getLogPosition();return o.position.box.getType()==lc.ParagraphMark||o.position.box.getType()==lc.SectionMark?o.position.getLogPosition(Hu.Box):o.position.getLogPosition()}}class V4 extends H4{extendSelection(){return!1}}class W4 extends H4{extendSelection(){return!0}}class z4 extends S4{executeCore(e,t){var r=this.getPositionStartParagraph();if(r<0)return!1;var i=this.selection;return this.extendSelection()?this.selection.changeState((e=>e.extendLastInterval(r).setEndOfLine(!1))):i.deprecatedSetSelection(r,r,!1,i.keepX,!0),!0}getPositionStartParagraph(){const e=this.selection,t=this.control.layout,r=this.selection.activeSubDocument;var i=t.pages[0].getPosition(),n=e.forwardDirection?e.lastSelectedInterval.end:e.lastSelectedInterval.start;let o=r.isMain()?new rm(r,t,i,n):new im(r,t,i,n,this.selection.pageIndex);if(!o.isInitialized())return-1;if(o.movePrev((new cg).setDefault(!1),(new cg).setDefault(!0)),o.position.getLogPosition()==(this.selection.activeSubDocument.isMain()?t.getLastValidPage().getEndPosition():t.pages[e.pageIndex].otherPageAreas[r.id].getEndPosition()))return o.position.box.getType()==lc.ParagraphMark||o.position.box.getType()==lc.SectionMark?o.position.getLogPosition(Hu.Box):o.position.getLogPosition();for(0==o.position.charOffset&&o.movePrev((new cg).setDefault(!1),(new cg).setDefault(!0));o.movePrev((new cg).setDefault(!1),(new cg).setDefault(!0));)if(o.position.box.getType()==lc.ParagraphMark||o.position.box.getType()==lc.SectionMark)return o.moveNext((new cg).setDefault(!1),(new cg).setDefault(!0)),o.position.getLogPosition();return i}}class j4 extends z4{extendSelection(){return!1}}class X4 extends z4{extendSelection(){return!0}}class G4 extends S4{executeCore(e,t){var r=this.getPosition();return-1!=r&&(this.setSelection(r),!0)}getPosition(){var e,t=this.selection,r=this.selection.activeSubDocument,i=t.forwardDirection?t.lastSelectedInterval.end:t.lastSelectedInterval.start,n=r.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,r,i,Hu.Character,(new cg).setDefault(t.endOfLine),(new cg).setDefault(!1)):new pg(this.control.layout,r,i,t.pageIndex,Hu.Character).create((new cg).setDefault(t.endOfLine),(new cg).setDefault(!1));if(this.extendSelection())e=this.getPrevCharacterPosition(n);else{if(!t.isCollapsed()){if(t.forwardDirection){var o=t.lastSelectedInterval.start;return(r.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,r,o,Hu.Character,(new cg).setDefault(t.endOfLine),(new cg).setDefault(!0)):new pg(this.control.layout,r,o,t.pageIndex,Hu.Character).create((new cg).setDefault(t.endOfLine),(new cg).setDefault(!0))).getLogPosition()}return n.getLogPosition()}if(!(e=this.getPrevCharacterPosition(n)).box.isVisible()&&!e.isPositionBeforeFirstBoxInRow()){do{var a=e;e=this.getPrevCharacterPosition(e)}while(!e.box.isVisible()&&a!==e);e=a}}const s=Math.min(i,e.getLogPosition());return s==i?-1:s}getPrevCharacterPosition(e){var t=e.clone();return t.charOffset>0?(t.charOffset--,t):t.boxIndex-1>=0?(t.boxIndex--,t.box=t.row.boxes[t.boxIndex],t.charOffset=t.box.getLength()-1,t):t.advanceToPrevRow(this.control.layout)?(t.boxIndex=t.row.boxes.length-1,t.box=t.row.boxes[t.boxIndex],t.charOffset=t.box.getLength()-1,t):e}}class K4 extends G4{setSelection(e){this.selection.deprecatedSetSelection(e,e,!1,-1,!0)}extendSelection(){return!1}}class q4 extends G4{setSelection(e){this.selection.changeState((t=>t.extendLastInterval(e).resetKeepX().setEndOfLine(!1)))||q4.jumpThroughFieldToLeft(this.selection)}extendSelection(){return!0}executeCore(e,t){const r=this.selection,i=r.tableInfo,n=i.rawData;if(!(i.isSelected&&n.areCellsSelectedInSeries&&n.atLeastOneCellFullySelected(r.intervals)))return super.executeCore(e,t);const o=r.forwardDirection||1==n.firstRowInfo.cells.length,a=o?n.lastRowInfo:n.firstRowInfo,s=a.row[(o?f.ListUtils.last(a.cells):a.cells[0]).cellIndex-1];return s?this.control.commandManager.getCommand(FF.SelectTableCellsRange).execute(this.control.commandManager.isPublicApiCall,o?{firstCell:n.firstCell,lastCell:s}:{firstCell:n.lastCell,lastCell:s}):this.control.commandManager.getCommand(FF.ExtendLineUp).execute(this.control.commandManager.isPublicApiCall)}static jumpThroughFieldToLeft(e){const t=e.activeSubDocument.fields;if(0!=t.length&&e.forwardDirection){var r=e.lastSelectedInterval.end,i=t[Math.max(0,Md.normedBinaryIndexOf(t,r))];i.getFieldEndPosition()==r&&e.changeState((e=>e.extendLastInterval(i.getFieldStartPosition()).resetKeepX().setEndOfLine(!1)))}}}class $4 extends S4{getPosition(){var e=this.selection,t=e.forwardDirection?e.lastSelectedInterval.end:e.lastSelectedInterval.start,r=new ug(this.control.layout,this.selection.activeSubDocument,t,Hu.Box).create((new cg).setDefault(!1),(new cg).setDefault(!0));if(!r)return-1;var i=t-r.getLogPosition(Hu.Box),n=r.pageArea.x+r.column.x+r.row.x+r.box.x+r.box.getCharOffsetXInPixels(this.control.measurer,i),o=r.pageArea.y+r.column.y+r.row.y+r.box.y,a=r.pageIndex-1,s=t;if(this.control.layout.pages[a]){var l=new zp(a,n,o),d=this.control.hitTestManager.calculate(l,Hu.Character,this.selection.activeSubDocument);this.extendSelection()||d.correctAsVisibleBox(),s=d.getPosition()}else s=0;return s}isEnabled(){return super.isEnabled()&&this.selection.activeSubDocument.isMain()}}class J4 extends $4{executeCore(e,t){var r=this.selection,i=this.getPosition();return!(i<0)&&(r.deprecatedSetSelection(i,i,r.endOfLine,r.keepX,!0),!0)}extendSelection(){return!1}}class Y4 extends $4{executeCore(e,t){const r=this.getPosition();return!(r<0)&&(this.selection.changeState((e=>e.extendLastInterval(r))),!0)}extendSelection(){return!0}}class Q4 extends EU{getState(){return new UU(this.isEnabled())}getStartPosition(){var e=this.selection;return e.forwardDirection?e.lastSelectedInterval.end:e.lastSelectedInterval.start}isEnabledInReadOnlyMode(){return!0}executeCore(e,t){const r=this.selection,i=this.getStartPosition(),n=this.selection.activeSubDocument,o=this.control.layout;let a=hX.getLayoutWordStartBound(o,n,r,i);if(a==i)a=hX.getLayoutWordStartBound(o,n,r,a-1);else{const e=(n.isMain()?new ug(o,n,i,Hu.Character):new pg(o,n,i,r.pageIndex,Hu.Column)).create((new cg).setDefault(!0),(new cg).setDefault(!0)).getLogPosition();a==e&&(a=hX.getLayoutWordStartBound(o,n,r,e-1))}return this.setSelection(a),!0}}class Z4 extends Q4{setSelection(e){const t=this.selection;t.deprecatedSetSelection(e,e,t.endOfLine,t.keepX,!0)}}class e6 extends Q4{setSelection(e){this.selection.changeState((t=>t.extendLastInterval(e).resetKeepX().setEndOfLine(!1)))||q4.jumpThroughFieldToLeft(this.selection)}}class t6 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=this.selection,i=this.selection.activeSubDocument,n=this.control.layout,o=r.lastSelectedInterval.start,a=i.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,i,o,Hu.Page,(new cg).setDefault(r.endOfLine),(new cg).setDefault(!0)).pageIndex:r.pageIndex,s=this.getNewPageIndex(a),l=this.control.layoutFormatterManager.forceFormatPage(s),d=(l||f.ListUtils.last(n.pages)).getPosition();return(!r.isCollapsed()||o!=d)&&(this.setNewSelection(d),r.scrollManager.setScroll((new xD).byModelPosition(r).setModelPosition(d).useStdRelativePosition().useStdOffset()),!0)}}class r6 extends t6{getNewPageIndex(e){return e+1}setNewSelection(e){this.selection.deprecatedSetSelection(e,e,!1,-1,!0,!0,!0,wD.DontChangeScrollPosition)}}class i6 extends t6{getNewPageIndex(e){return Math.max(0,e-1)}setNewSelection(e){this.selection.deprecatedSetSelection(e,e,!1,-1,!0,!0,!0,wD.DontChangeScrollPosition)}}class n6 extends r6{setNewSelection(e){this.selection.changeState((t=>t.extendLastInterval(e).resetKeepX().setEndOfLine(!1)))}}class o6 extends i6{setNewSelection(e){this.selection.changeState((t=>t.extendLastInterval(e).resetKeepX().setEndOfLine(!1)))}}class a6 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){return this.control.layout.isFullyFormatted||this.control.layoutFormatterManager.formatSyncAllDocument(),this.selection.deprecatedSetSelection(0,this.selection.activeSubDocument.getDocumentEndPosition(),!0,-1,!0,!0,!0,wD.DontChangeScrollPosition),this.control.focusManager.captureFocus(),!0}isEnabledInReadOnlyMode(){return!0}}class s6 extends S4{executeCore(e,t){var r=this.selection,i=this.selection.activeSubDocument,n=(i.isMain()?new ug(this.control.layout,i,t.param,Hu.Character):new pg(this.control.layout,i,t.param,r.pageIndex,Hu.Character)).create((new cg).setDefault(!1),(new cg).setDefault(!0));if(!n)return!1;var o=n.row.boxes[n.row.boxes.length-1],a=n.getRelatedSubDocumentPagePosition()+n.pageArea.pageOffset+n.column.pageAreaOffset+n.row.columnOffset,s=a+o.rowOffset+o.getLength();return this.setSelection(a,s),!0}setSelection(e,t){this.selection.deprecatedSetSelection(e,t,!1,-1,!0)}}class l6 extends s6{setSelection(e,t){this.selection.changeState((r=>r.addInterval(on.FixedInterval.fromPositions(e,t)).resetKeepX().setEndOfLine(!1)))}}class d6 extends S4{executeCore(e,t){const r=t.param;var i=this.selection,n=i.lastSelectedInterval,o=n.end;o==this.selection.activeSubDocument.getDocumentEndPosition()&&o--;var a=this.selection.activeSubDocument,s=(a.isMain()?new ug(this.control.layout,a,n.start,Hu.Character):new pg(this.control.layout,a,n.start,i.pageIndex,Hu.Character)).create((new cg).setDefault(!1),(new cg).setDefault(!1));if(!s)return!1;var l=s.row.boxes[s.row.boxes.length-1],d=(a.isMain()?new ug(this.control.layout,a,o,Hu.Character):new pg(this.control.layout,a,o,i.pageIndex,Hu.Character)).create((new cg).setDefault(!0),(new cg).setDefault(!1));if(!d)return!1;var c=d.row.boxes[d.row.boxes.length-1],h=(a.isMain()?new ug(this.control.layout,a,r,Hu.Character):new pg(this.control.layout,a,r,i.pageIndex,Hu.Character)).create((new cg).setDefault(!1),(new cg).setDefault(!1));if(!h)return!1;var u=h.row.boxes[h.row.boxes.length-1],p=s.getRelatedSubDocumentPagePosition()+s.pageArea.pageOffset+s.column.pageAreaOffset+s.row.columnOffset,g=p+l.rowOffset+l.getLength(),m=d.getRelatedSubDocumentPagePosition()+d.pageArea.pageOffset+d.column.pageAreaOffset+d.row.columnOffset,f=m+c.rowOffset+c.getLength(),b=h.getRelatedSubDocumentPagePosition()+h.pageArea.pageOffset+h.column.pageAreaOffset+h.row.columnOffset,C=b+u.rowOffset+u.getLength();if(n.start==p&&n.end==f)i.forwardDirection?b<p?i.deprecatedSetSelection(g,b,!1,-1,!0):i.deprecatedSetSelection(p,C,!1,-1,!0):b>=m?i.deprecatedSetSelection(m,C,!1,-1,!0):i.deprecatedSetSelection(f,b,!1,-1,!0);else if(i.forwardDirection){var S=b<=n.start?Math.min(b,p):b;i.deprecatedSetSelection(n.start,S,!1,-1,!0)}else i.deprecatedSetSelection(o,b,!1,-1,!0);return!0}}class c6 extends s6{}class h6 extends d6{}class u6 extends S4{executeCore(e,t){var r=this.selection.activeSubDocument.paragraphs,i=r[C.SearchUtils.normedInterpolationIndexOf(r,(e=>e.startLogPosition.value),t.param)];return this.selection.deprecatedSetSelection(i.startLogPosition.value,i.startLogPosition.value+i.length,!0,-1,!0),!0}}class p6 extends EU{getState(){let e=this.control.spellChecker.getSelectedMisspelledInterval(this.selection.intervals),t=new UU(this.isEnabled());return t.value=e,t.visible=this.isVisible(e),t}isEnabled(){return super.isEnabled()&&this.control.spellChecker.settings.isEnabled}isVisible(e){return null!=e}}class g6 extends p6{isEnabled(){return super.isEnabled()&&this.control.spellChecker.settings.canAddWord}isVisible(e){return super.isVisible(e)&&e.errorInfo.errorType==Wc.Misspelling}executeCore(e,t){let r=e.value;return this.control.spellChecker.addWord(r),!0}}class m6 extends p6{changeSpellingError(e,t,r){const i=new on.FixedInterval(t,r);Md.correctIntervalDueToFieldsWithoutUiChecks(e.intervalsInfo.subDocInterval.subDocument,i),e.intervalsInfo.interval=i,this.history.beginTransaction(),this.modelManipulator.range.removeInterval(e.intervalsInfo.subDocInterval,!0,!1);const n=this.modelManipulator.text.insertTextViaHistory(new op(e.intervalsInfo.subDocPosition,this.inputPosition.charPropsBundle,cs.TextRun,e.param));this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(n.insertedInterval.end).setEndOfLine(!0))),this.history.endTransaction()}}class f6 extends m6{isEnabled(){let e=this.control.spellChecker.getSelectedMisspelledInterval(this.selection.intervals),t=e?e.errorInfo.suggestions:null;return super.isEnabled()&&t&&t.length>0}isVisible(e){return super.isVisible(e)&&e.errorInfo.errorType==Wc.Misspelling}executeCore(e,t){const r=e.value,i=this.control.spellChecker.getIntervalsWithErrorByWord(r.errorInfo.word);this.history.beginTransaction();for(var n,o=0;n=i[o];o++)this.changeSpellingError(t,n.start,n.length);return this.history.endTransaction(),!0}}class b6 extends m6{isEnabled(){let e=this.control.spellChecker.getSelectedMisspelledInterval(this.selection.intervals),t=e?e.errorInfo.suggestions:null;return super.isEnabled()&&t&&t.length>0}isVisible(e){return super.isVisible(e)&&e.errorInfo.errorType==Wc.Misspelling}executeCore(e,t){const r=e.value;return this.changeSpellingError(t,r.start,r.length),!0}}class C6 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){return!0}}class S6 extends p6{isVisible(e){return super.isVisible(e)&&e.errorInfo.errorType==Wc.Repeating}executeCore(e,t){let r=e.value,i=on.FixedInterval.fromPositions(r.start-1,r.end);return this.history.beginTransaction(),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(i.start))),this.modelManipulator.range.removeInterval(new gu(this.selection.activeSubDocument,i),!1,!1),this.history.endTransaction(),!0}}class I6 extends p6{isVisible(e){return super.isVisible(e)&&e.errorInfo.errorType==Wc.Misspelling}executeCore(e,t){let r=e.value;return this.control.spellChecker.ignoreAll(r),!0}}class P6 extends p6{executeCore(e,t){let r=e.value;return this.control.spellChecker.ignore(r),!0}}class w6 extends EU{isEnabled(){const e=this.control.selection.tableInfo.table;return super.isEnabled()&&null!=e&&this.control.selection.activeSubDocument.isEditable([on.FixedInterval.fromPositions(e.getStartPosition(),e.getEndPosition())])}}class y6 extends w6{getState(){let e=new UU(!0,!1),t=this.selection.tableInfo;e.enabled=this.isEnabled()&&t.extendedData.numRows>0;let r=[];for(let e,t=0;e=this.control.modelManager.model.tableStyles[t];t++)e.hidden||e.semihidden||e.deleted||r.push({value:e.styleName,text:e.localizedName,data:e.base64EncodedImage});for(let e,t=0;e=Wh.presetTableStyles[t];t++)e.hidden||e.semihidden||e.deleted||this.control.modelManager.model.getTableStyleByName(e.styleName)||r.push({value:e.styleName,text:e.localizedName,data:e.base64EncodedImage});if(e.items=r,e.enabled){const r=t.table;e.value=r.style?r.style.styleName:null}return e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&Bb.isEnabled(this.control.modelManager.richOptions.control.tableStyle)}executeCore(e,t){this.history.beginTransaction();let r=this.control.modelManager.model.getTableStyleByName(t.param)||this.control.modelManager.model.stylesManager.addTableStyle(Wh.getPresetTableStyleByName(t.param).clone());const i=this.selection.tableInfo.table;return this.history.addAndRedo(new _p(this.modelManipulator,this.selection.activeSubDocument,i.index,r)),this.history.endTransaction(),!0}}class x6 extends w6{getState(){if(this.isEnabled()){const e=this.selection.tableInfo.table;if(e)return new UU(!0,e)}return new UU(!1)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}}class T6 extends x6{executeCore(e,t){const r=e.value,i=this.history,n=t.subDocument;return i.beginTransaction(),i.addAndRedo(new Qm(this.modelManipulator,n,r.index,Oe.Autofit,!0)),i.addAndRedo(new Jm(this.modelManipulator,n,r.index,lr.create(0,Je.Auto))),this.modelManipulator.table.forEachCell(r,((e,t)=>{i.addAndRedo(new tc(this.modelManipulator,n,r.index,e.rowIndex,e.cellIndex,lr.create(0,Je.Auto)))})),i.endTransaction(),!0}}class v6 extends x6{executeCore(e,t){const r=e.value,i=this.history,n=t.subDocument;i.beginTransaction(),i.addAndRedo(new Qm(this.modelManipulator,n,r.index,Oe.Autofit,!0)),i.addAndRedo(new Jm(this.modelManipulator,n,r.index,lr.create(lr.MAX_PERCENT_WIDTH,Je.FiftiethsOfPercent)));const o=this.modelManipulator.table.distributeWidthsToAllColumns(r,lr.MAX_PERCENT_WIDTH);return this.modelManipulator.table.forEachCell(r,((e,t)=>{i.addAndRedo(new tc(this.modelManipulator,n,r.index,e.rowIndex,e.cellIndex,lr.create(this.modelManipulator.table.fullCellWidth(o,t,e.cell.columnSpan),Je.FiftiethsOfPercent)))})),i.endTransaction(),!0}}class M6 extends x6{executeCore(e,t){const r=e.value,i=this.history,n=t.subDocument,o=Kp.ensure(this.control.layoutFormatterManager,n,r.getStartPosition()),a=this.getGrid(r,o);i.beginTransaction(),i.addAndRedo(new Qm(this.modelManipulator,n,r.index,Oe.Fixed,!0)),i.addAndRedo(new Jm(this.modelManipulator,n,r.index,lr.create(0,Je.Auto)));const s=a?f.ListUtils.reducedMap(a.columns.width,(e=>{const t=g.u.pixelsToTwipsF(e);return 0===t?null:t})):this.modelManipulator.table.distributeWidthsToAllColumns(r,g.u.pixelsToTwipsF(this.getAvaliableWidth_px(r,o)));return this.modelManipulator.table.forEachCell(r,((e,t)=>{i.addAndRedo(new tc(this.modelManipulator,n,r.index,e.rowIndex,e.cellIndex,lr.create(this.modelManipulator.table.fullCellWidth(s,t,e.cell.columnSpan),Je.ModelUnits)))})),i.endTransaction(),!0}getGrid(e,t){const r=t.column.tablesInfo?f.ListUtils.elementBy(t.column.tablesInfo,(t=>t.logicInfo.grid.table.index==e.index)):null;return r?r.logicInfo.grid:null}getAvaliableWidth_px(e,t){if(0==e.nestedLevel)return SD.findSectionColumnWithMinimumWidth(t.pageArea.columns);let r=t.row.tableCellInfo;for(;r.parentRow.parentTable.logicInfo.grid.table.nestedLevel!=e.nestedLevel-1;)r=r.parentRow.parentTable.parentCell;return r.avaliableContentWidth}}class E6 extends EU{getState(){let e=new UU(!0,!1),t=this.selection.tableInfo;return e.enabled=this.isEnabled()&&t.extendedData.numRows>0,e.denyUpdateValue=!0,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}executeCore(e,t){return this.control.modelManager.model.repositoryBorderItem.color=this.control.modelManager.model.colorProvider.getModelColorFromRgba(t.param),!0}DEPRECATEDConvertOptionsParameter(e){return(0,S.isNumber)(e)?e:e&&e!=y.AUTOMATIC_COLOR.toString()?w.i.fromString(e):y.AUTOMATIC_COLOR}}class D6 extends EU{getState(){let e=new UU(!0,!1);return e.enabled=this.isEnabled()&&this.selection.tableInfo.extendedData.numRows>0,e.value=this.control.modelManager.model.repositoryBorderItem.width,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}executeCore(e,t){return this.control.modelManager.model.repositoryBorderItem.width=t.param,!0}}class F6 extends EU{getState(){let e=new UU(!0,!1);return e.enabled=this.isEnabled()&&this.selection.tableInfo.extendedData.numRows>0,e.value=this.control.modelManager.model.repositoryBorderItem.style,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}executeCore(e,t){return this.control.modelManager.model.repositoryBorderItem.style=t.param,!0}}class R6 extends EU{getRelatedCommands(){return{[FF.TableCellAlignBottomCenter]:!0,[FF.TableCellAlignBottomLeft]:!0,[FF.TableCellAlignBottomRight]:!0,[FF.TableCellAlignMiddleCenter]:!0,[FF.TableCellAlignMiddleLeft]:!0,[FF.TableCellAlignMiddleRight]:!0,[FF.TableCellAlignTopCenter]:!0,[FF.TableCellAlignTopLeft]:!0,[FF.TableCellAlignTopRight]:!0}}getState(){let e=new UU(!0,!1);return e.enabled=this.isEnabled()&&this.selection.tableInfo.extendedData.numRows>0,e.value=this.isChecked(this.selection.activeSubDocument),e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}isChecked(e){const t=this.selection.tableInfo;return t.extendedData.allOfCells((r=>(new Zr).getProperty(r.cell.properties,t.table.style,r.cell.conditionalFormatting,this.control.modelManager.model.defaultTableCellProperties)===this.verticalAlignment&&e.getParagraphByPosition(r.cell.startParagraphPosition.value).getParagraphMergedProperties().alignment===this.horizontalAlignment))}executeCore(e,t){this.history.beginTransaction();let r=this.selection.tableInfo,i=t.subDocument,n=r.table;return r.extendedData.foreach((()=>{}),((e,t)=>{const r=e.cell;r.properties.verticalAlignment===this.verticalAlignment&&r.properties.getUseValue(Ye.UseVerticalAlignment)||this.history.addAndRedo(new ic(this.modelManipulator,i,n.index,t.rowIndex,e.cellIndex,this.verticalAlignment,!0));const o=i.getParagraphsIndices(r.interval);f.ListUtils.forEach(i.paragraphs,(e=>{e.getParagraphMergedProperties().alignment!==this.horizontalAlignment&&this.history.addAndRedo(new st(this.modelManipulator,new gu(i,e.interval),this.horizontalAlignment,!0))}),o.start,o.end)})),this.history.endTransaction(),!0}}class L6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Left,this.verticalAlignment=Ke.Top}}class B6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Center,this.verticalAlignment=Ke.Top}}class A6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Right,this.verticalAlignment=Ke.Top}}class N6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Left,this.verticalAlignment=Ke.Center}}class k6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Center,this.verticalAlignment=Ke.Center}}class O6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Right,this.verticalAlignment=Ke.Center}}class _6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Left,this.verticalAlignment=Ke.Bottom}}class U6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Center,this.verticalAlignment=Ke.Bottom}}class H6 extends R6{constructor(){super(...arguments),this.horizontalAlignment=Ae.Right,this.verticalAlignment=Ke.Bottom}}class V6 extends EU{getState(){let e=new UU(this.isEnabled());if(e.enabled){const t=this.selection.tableInfo;let r;if(f.ListUtils.allOf(t.extendedData.rows,(e=>f.ListUtils.allOf(e.cells,(e=>{if(e.cell.properties.getUseValue(Ye.UseShadingInfoIndex)){const t=e.cell.properties.shadingInfo.getActualColor(this.colorProvider);return void 0===r?(r=t,!0):t==r}return!0})))))switch(r){case void 0:e.value=void 0;break;case y.NO_COLOR:e.value=null;break;default:w.i.colorToHash(r)}else e.value=void 0}return e.denyUpdateValue=!0,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.extendedData.numRows>0}DEPRECATEDConvertOptionsParameter(e){return y.anyToColor(e,y.NO_COLOR)}executeCore(e,t){this.history.beginTransaction();let r=t.param,i=this.selection.tableInfo,n=i.table;return i.extendedData.foreach((()=>{}),((e,i)=>{e.cell.properties.shadingInfo.getActualColor(this.colorProvider)===r&&e.cell.properties.getUseValue(Ye.UseShadingInfoIndex)||this.history.addAndRedo(new nc(this.modelManipulator,t.subDocument,n.index,i.rowIndex,e.cellIndex,fe.createByColor(he.makeByColor(r)),!0))})),this.history.endTransaction(),!0}}class W6 extends EU{getState(){let e=new UU(!0);const t=this.selection.tableInfo;if(e.enabled=this.isEnabled()&&t.extendedData.numRows>0,e.enabled){const r=t.table?t.extendedData.firstCell.preferredWidth:null;t.extendedData.allOfCells((e=>e.cell.preferredWidth.equals(r)))&&(e.value=r)}return e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}executeCore(e,t){const r=this.selection.tableInfo;let i=!1;return r.extendedData.foreach((()=>{}),((e,n)=>{e.cell.preferredWidth.equals(t.param)||(this.history.addAndRedo(new tc(this.modelManipulator,t.subDocument,r.table.index,n.rowIndex,e.cellIndex,t.param.clone())),i=!0)})),i}}class z6 extends EU{getState(){let e=new UU(!0);const t=this.selection.tableInfo;let r;if(e.enabled=this.isEnabled()&&t.extendedData.numRows>0,e.enabled){const e=t.table;let i=r2.getColumnsRangeBySelectedCells(t.extendedData);for(let t,n=0;t=e.rows[n];n++){let o=oc.getCellIndicesByColumnsRange(t,i);for(let t=o.length-1;t>=0;t--){let i=e.rows[n].cells[o[t]];if(void 0===r)r=i.preferredWidth.clone();else{if(r&&r.equals(i.preferredWidth))continue;r=null}}}}return e.value=r,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}executeCore(e,t){const r=this.selection.tableInfo,i=r.table;let n=!1;const o=r2.getColumnsRangeBySelectedCells(r.extendedData),a=t.subDocument;for(let e,r=0;e=i.rows[r];r++){let s=oc.getCellIndicesByColumnsRange(e,o);for(let e=s.length-1;e>=0;e--){i.rows[r].cells[s[e]].preferredWidth.equals(t.param)||(this.history.addAndRedo(new tc(this.modelManipulator,a,i.index,r,s[e],t.param.clone())),n=!0)}}return n}}class j6 extends EU{getState(){const e=this.selection.tableInfo,t=new UU(this.isEnabled()&&e.extendedData.numRows>0,!1);return t.enabled&&(t.value=this.getValue(e.table)),t}getValue(e){const t=!!(e.lookTypes&this.option);return this.isInvertedTableLookType()?!t:t}isInvertedTableLookType(){return!1}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}executeCore(e,t){let r=this.selection.tableInfo.table;return void 0!==t.param&&null!==t.param||(t.param=!this.getValue(r)),this.history.beginTransaction(),this.history.addAndRedo(new Zm(this.modelManipulator,t.subDocument,r.index,this.getNewValue(r,t.param))),ac.updateTable(this.control.modelManager,r,t.subDocument),this.history.endTransaction(),!0}getNewValue(e,t){t=this.isInvertedTableLookType()?!t:t;let r=e.lookTypes;return t?r|=this.option:r&=~this.option,r}getRelatedCommands(){return{[FF.ToggleFirstRow]:!0,[FF.ToggleLastRow]:!0,[FF.ToggleFirstColumn]:!0,[FF.ToggleLastColumn]:!0,[FF.ToggleBandedRows]:!0,[FF.ToggleBandedColumn]:!0,[FF.ChangeTableLook]:!0}}}class X6 extends j6{getValue(e){return e.lookTypes}getNewValue(e,t){return t}}class G6 extends j6{constructor(){super(...arguments),this.option=_e.ApplyFirstRow}}class K6 extends j6{constructor(){super(...arguments),this.option=_e.ApplyLastRow}}class q6 extends j6{constructor(){super(...arguments),this.option=_e.ApplyFirstColumn}}class $6 extends j6{constructor(){super(...arguments),this.option=_e.ApplyLastColumn}}class J6 extends j6{constructor(){super(...arguments),this.option=_e.DoNotApplyRowBanding}isInvertedTableLookType(){return!0}}class Y6 extends j6{constructor(){super(...arguments),this.option=_e.DoNotApplyColumnBanding}isInvertedTableLookType(){return!0}}class Q6 extends EU{getState(){const e=this.selection.tableInfo,t=new UU(!0);if(t.enabled=this.isEnabled()&&e.extendedData.numRows>0,t.enabled){const r=e.table?e.extendedData.rows[0].row.height:void 0;f.ListUtils.allOf(e.extendedData.rows,(e=>e.row.height.equals(r)),1)&&(t.value=r)}return t}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}executeCore(e,t){const r=this.selection.tableInfo,i=r.table;let n=!1;return this.history.beginTransaction(),f.ListUtils.forEach(r.extendedData.rows,(e=>{i.rows[e.rowIndex].height.equals(t.param)||(this.history.addAndRedo(new jd(this.modelManipulator,t.subDocument,i.index,e.rowIndex,t.param.clone())),n=!0)})),this.history.endTransaction(),n}}class Z6 extends EU{getState(){let e=new UU(!0,!1);return e.visible=this.selection.tableInfo.extendedData.numRows>0&&(this.selection.activeSubDocument.isTextBox()||!this.selection.specialRunInfo.isSelected()),e}executeCore(e,t){return!1}}class e8 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&(this.selection.tableInfo.extendedData.isSquare||1==this.selection.tableInfo.extendedData.numRows)}executeCore(e,t){const r=this.selection.tableInfo;return this.selection.tableInfo.extendedData.isSelectedEntireTable?this.control.commandManager.getCommand(FF.DeleteTable).execute(this.control.commandManager.isPublicApiCall):r.extendedData.numRows==r.table.rows.length&&this.selection.tableInfo.extendedData.isSquare?this.control.commandManager.getCommand(FF.DeleteTableColumns).execute(this.control.commandManager.isPublicApiCall):this.control.commandManager.getCommand(FF.ShowDeleteTableCellsForm).execute(this.control.commandManager.isPublicApiCall)}}class t8 extends w6{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.extendedData.isSquare}executeCore(e,t){this.history.beginTransaction();const r=this.selection.tableInfo,i=t.subDocument,n=r.table;if(r.extendedData.isSelectedEntireTable)this.modelManipulator.table.removeTableWithContent(i,n),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(n.getStartPosition()).setEndOfLine(!1)));else{let e=r.extendedData.firstCell.startParagraphPosition.value;f.ListUtils.reverseForEach(r.extendedData.rows,(e=>{n.rows[e.rowIndex].cells.length===e.cells.length?this.deleteEntireRow(i,n,e.rowIndex):f.ListUtils.reverseForEach(e.cells,(t=>{t.cell.verticalMerging!=Xe.Continue&&this.deleteTableCell(i,n,e.rowIndex,t.cellIndex)}))})),this.modelManipulator.table.normalizeVerticalSpans(i,n),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(e).setEndOfLine(!1))),ac.updateTable(this.control.modelManager,n,t.subDocument)}return this.history.endTransaction(),!0}deleteEntireRow(e,t,r){this.modelManipulator.table.removeTableRowWithContent(e,t,r),this.modelManipulator.table.normalizeCellColumnSpans(e,t,!0)}deleteTableCell(e,t,r,i){this.modelManipulator.table.removeTableCellWithContent(e,t,r,i),this.modelManipulator.table.normalizeTableGrid(e,t),this.modelManipulator.table.normalizeCellColumnSpans(e,t,!1)}}class r8 extends w6{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.rawData.isSquare}executeCore(e,t){this.history.beginTransaction();const r=t.subDocument,i=this.selection.tableInfo,n=i.table;if(i.extendedData.isSelectedEntireTable)this.modelManipulator.table.removeTableWithContent(r,n),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(n.getStartPosition()).setEndOfLine(!1)));else{const e=i.rawData.firstCell.startParagraphPosition.value;f.ListUtils.reverseForEach(i.rawData.rows,(e=>{for(let t of e.cells)this.removeTableCell(r,n,e.rowIndex,t.cellIndex)})),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(e).setEndOfLine(!1))),ac.updateTable(this.control.modelManager,n,t.subDocument)}return this.history.endTransaction(),!0}removeTableCell(e,t,r,i){const n=oc.getStartColumnIndex(t.rows[r].cells[i]),o=t.rows.length;for(let i=r;i<o;i++){let o=oc.getCellIndexByColumnIndex(t.rows[r],n);t.rows[i].cells[o]&&new bf(this.control.modelManager,e).execute(Qa.createAndInit(t,i,o),!1,this.inputPosition)}}}class i8 extends w6{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.rawData.isSquare}executeCore(e,t){this.history.beginTransaction();const r=this.selection.tableInfo,i=r.table,n=t.subDocument;if(r.rawData.firstRowInfo.cells.length==i.rows[r.rawData.firstRowInfo.rowIndex].cells.length)this.modelManipulator.table.removeTableWithContent(n,i),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(i.getStartPosition()).setEndOfLine(!1)));else{const e=r.rawData.firstCell.startParagraphPosition.value,o=r2.getColumnsRangeBySelectedCells(r.rawData);for(let e,t=0;e=i.rows[t];t++){let r=oc.getCellIndicesByColumnsRange(e,o);if(r.length===e.cells.length)this.modelManipulator.table.removeTableRowWithContent(n,i,t),t--;else for(let e=r.length-1;e>=0;e--)this.modelManipulator.table.removeTableCellWithContent(n,i,t,r[e]);this.modelManipulator.table.normalizeTableGrid(n,i)}this.normalizeCellVerticalMerging(n,i),this.modelManipulator.table.normalizeCellColumnSpans(n,i,!0),ac.updateTable(this.control.modelManager,i,t.subDocument),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(e).setEndOfLine(!1)))}return this.history.endTransaction(),!0}normalizeCellVerticalMerging(e,t){for(let r,i=t.rows.length-1;r=t.rows[i];i--)for(let n,o=0;n=r.cells[o];o++){if(n.verticalMerging===Xe.None)continue;let r=oc.getStartColumnIndex(n),a=t.rows[i+1];if(n.verticalMerging===Xe.Restart){if(i===t.rows.length-1){this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,o,Xe.None));continue}let n=a.cells[oc.getCellIndexByColumnIndex(a,r)];n&&n.verticalMerging===Xe.Continue||this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,o,Xe.None))}else{let n=t.rows[i-1],a=n?n.cells[oc.getCellIndexByColumnIndex(n,r)]:null,s=t.rows[i+1],l=s?s.cells[oc.getCellIndexByColumnIndex(s,r)]:null;a&&a.verticalMerging!==Xe.None||(l&&l.verticalMerging===Xe.Continue?l&&l.verticalMerging===Xe.Continue&&this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,o,Xe.Restart)):this.history.addAndRedo(new Jd(this.modelManipulator,e,t.index,i,o,Xe.None)))}}}}class n8 extends w6{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.extendedData.isSquare}executeCore(e,t){this.history.beginTransaction();const r=this.selection.tableInfo;return this.modelManipulator.table.removeTableWithContent(t.subDocument,r.table),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(r.table.getStartPosition()).setEndOfLine(!1))),this.history.endTransaction(),!0}}class o8 extends EU{canModify(){const e=this.control.selection.tableInfo,t=e.table;return null!=t&&(this.control.isClientMode()?f.ListUtils.allOf(e.rawData.rows,(t=>{const r=e.table.rows[t.rowIndex];return this.control.selection.activeSubDocument.isEditable([on.FixedInterval.fromPositions(r.getStartPosition(),r.getEndPosition())])})):this.control.selection.activeSubDocument.isEditable([on.FixedInterval.fromPositions(t.getStartPosition(),t.getEndPosition())]))}}class a8 extends o8{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.rawData.isSquare}executeCore(e,t){this.history.beginTransaction();const r=this.selection.tableInfo,i=t.subDocument,n=r.table;if(r.rawData.numRows===n.rows.length)this.modelManipulator.table.removeTableWithContent(i,n),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(n.getStartPosition()).setEndOfLine(!1)));else{const e=r.rawData.firstCell.startParagraphPosition.value;f.ListUtils.reverseForEach(r.rawData.rows,(e=>this.modelManipulator.table.removeTableRowWithContent(i,n,e.rowIndex))),this.modelManipulator.table.normalizeCellColumnSpans(i,n,!0),ac.updateTable(this.control.modelManager,n,t.subDocument),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(e).setEndOfLine(!1)))}return this.history.endTransaction(),!0}}class s8 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.extendedData.numRows>0}executeCore(e,t){this.history.beginTransaction();const r=this.selection.tableInfo,i=r.table,n=t.subDocument,o=[];r.extendedData.foreach((()=>{}),((e,t)=>{e.cell.verticalMerging!==Xe.Continue&&o.push(this.insertTableCell(n,i,t.rowIndex,e.cellIndex))})),this.modelManipulator.table.normalizeVerticalSpans(n,i);const a=[];for(let e,t=0;e=o[t];t++)a.push(e.interval);return ac.updateTable(this.control.modelManager,i,n),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setIntervals(a).setEndOfLine(!1))),this.history.endTransaction(),!0}}class l8 extends s8{insertTableCell(e,t,r,i){return this.modelManipulator.table.insertCellToTheLeft(e,t,r,i,this.inputPosition),t.rows[r].cells[i]}}class d8 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.extendedData.areCellsSelectedInSeries}executeCore(e,t){this.history.beginTransaction();let r=this.selection.tableInfo,i=r.table,n=[];r.extendedData.foreach((e=>f.ListUtils.addListOnTail(n,this.insertTableCellWithShiftToTheVertically(this.selection.activeSubDocument,i,e))),(()=>{}));let o=[];for(let e,t=0;e=n[t];t++)o.push(e.interval);return ac.updateTable(this.control.modelManager,i,t.subDocument),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setIntervals(o))),this.history.endTransaction(),!0}insertTableCellWithShiftToTheVertically(e,t,r){if(f.ListUtils.allOf(r.cells,(e=>e.cell.verticalMerging==Xe.Continue)))return[];let i=r.cells[0].cellIndex,n=i+r.cells.length-1,o=this.calculateInsertedRowsCount(t,r.rowIndex,i,n),a=[];for(let s=0;s<o;s++){this.modelManipulator.table.insertRowBelow(e,t,t.rows.length-1);for(let o=n;o>=i;o--)a=a.concat(this.insertCellWithShiftToTheDown(e,t,r.rowIndex+s,o))}return this.deleteTextInCell(e,t,r.rowIndex,o),a}calculateInsertedRowsCount(e,t,r,i){let n=e.rows[t],o=Number.MAX_VALUE;for(let a=r;a<=i;a++){let r=n.cells[a],i=oc.getStartColumnIndex(r);o=Math.min(o,oc.getVerticalSpanCellPositions(Qa.createAndInit(e,t,a),i).length)}return o}insertCellWithShiftToTheDown(e,t,r,i){let n=[];for(let o=t.rows.length-1;o>r;o--){let r=t.rows[o],a=r.cells.length,s=t.rows[o-1];if(!(i>=s.cells.length)){if(i>=a){let n=s.cells[s.cells.length-1];this.insertTableCells(e,t,o,r.cells.length-1,i-a+1,n.preferredWidth)}new ff(this.control.modelManager,e).execute(Qa.createAndInit(t,o,i),!1,this.inputPosition),n.push(t.rows[o].cells[i])}}return this.deleteContentInCell(e,t,r,i),this.modelManipulator.table.normalizeTableGrid(e,t),this.modelManipulator.table.normalizeCellColumnSpans(e,t,!0),n}insertTableCells(e,t,r,i,n,o){for(let a=0;a<n;a++){let n=i+a;this.modelManipulator.table.insertCellToTheRight(e,t,r,n,this.inputPosition,!1,!0,!1),this.history.addAndRedo(new tc(this.modelManipulator,e,t.index,r,n+1,o.clone()))}}deleteTextInCell(e,t,r,i){let n=r+1,o=n+i;for(let r=n;r<o;r++){let i=t.rows[r];for(let n,o=0;n=i.cells[o];o++)n.verticalMerging===Xe.Continue&&this.deleteContentInCell(e,t,r,o)}}deleteContentInCell(e,t,r,i){let n=t.rows[r].cells[i];n.endParagrapPosition.value-n.startParagraphPosition.value>1&&this.modelManipulator.range.removeInterval(new gu(e,on.FixedInterval.fromPositions(n.startParagraphPosition.value,n.endParagrapPosition.value-1)),!0,!1)}}class c8 extends w6{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.extendedData.isSquare}executeCore(e,t){this.history.beginTransaction();let r=this.getPatternCell(),i=this.getColumnIndex(r),n=r.parentRow.parentTable,o=this.getColumnCellIndices(n,i),a=this.getInsertedColumnCount(),s=[],l=t.subDocument;for(let e=0;e<a;e++)for(let e=o.length-1;e>=0;e--)s.push(this.splitTableCellCore(l,n,e,o[e],r));this.modelManipulator.table.normalizeTableGrid(l,n),this.modelManipulator.table.normalizeCellColumnSpans(l,n,!1),this.modelManipulator.table.normalizeTableCellWidth(l,n);let d=[];for(let e,t=0;e=s[t];t++)d.push(e.interval);return ac.updateTable(this.control.modelManager,n,l),this.history.endTransaction(),!0}getInsertedColumnCount(){return f.ListUtils.accumulate(this.selection.tableInfo.extendedData.rows,Bo.Constants.MAX_SAFE_INTEGER,((e,t)=>Math.min(e,t.columnCountInSeries)))}getColumnCellIndices(e,t){return f.ListUtils.map(e.rows,(e=>this.getCurrentCellIndex(t,e)))}insertParagraphToTheLeft(e,t){let r=e.getRunByPosition(t.startParagraphPosition.value),i=e.getParagraphByPosition(t.startParagraphPosition.value);this.history.addAndRedo(new lf(this.modelManipulator,new Ag(new pu(e,t.startParagraphPosition.value),r.getCharPropsBundle(this.modelManipulator.model),i.getParagraphBundleFull(this.modelManipulator.model))))}insertParagraphToTheRight(e,t){let r=e.getRunByPosition(t.endParagrapPosition.value-1),i=e.getParagraphByPosition(t.endParagrapPosition.value-1);this.history.addAndRedo(new lf(this.modelManipulator,new Ag(new pu(e,t.endParagrapPosition.value-1),r.getCharPropsBundle(this.modelManipulator.model),i.getParagraphBundleFull(this.modelManipulator.model))))}}class h8 extends c8{splitTableCellCore(e,t,r,i,n){return i<0&&(i=t.rows[r].cells.length-1),this.insertParagraphToTheLeft(e,t.rows[r].cells[i]),this.history.addAndRedo(new rf(this.modelManipulator,e,t.index,r,i,!0)),this.history.addAndRedo(new tc(this.modelManipulator,e,t.index,r,i,n.preferredWidth.clone())),t.rows[r].cells[i]}getPatternCell(){return this.selection.tableInfo.extendedData.firstCell}getColumnIndex(e){return oc.getStartColumnIndex(e)}getCurrentCellIndex(e,t){return oc.getCellIndexByColumnIndex(t,e)}}class u8 extends c8{splitTableCellCore(e,t,r,i,n){return i<0?(this.insertParagraphToTheLeft(e,t.rows[r].cells[0]),this.history.addAndRedo(new rf(this.modelManipulator,e,t.index,r,0,!0))):(this.insertParagraphToTheRight(e,t.rows[r].cells[i]),this.history.addAndRedo(new nf(this.modelManipulator,e,t.index,r,i,!0))),this.history.addAndRedo(new tc(this.modelManipulator,e,t.index,r,Math.max(0,i),n.preferredWidth.clone())),t.rows[r].cells[i+1]}getPatternCell(){return f.ListUtils.last(f.ListUtils.last(this.selection.tableInfo.extendedData.rows).cells).cell}getColumnIndex(e){return oc.getStartColumnIndex(e)+e.columnSpan-1}getCurrentCellIndex(e,t){return oc.getCellIndexByEndColumnIndex(t,e)}}class p8 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)}executeCore(e,t){const r=t.param,i=this.selection.activeSubDocument,n=this.selection.intervals[0].start,o=Kp.ensure(this.control.layoutFormatterManager,i,n);let a=Ja.getTableByPosition(i.tables,n,!0)?o.row.tableCellInfo.avaliableContentWidth:SD.findSectionColumnWithMinimumWidth(o.pageArea.columns);this.history.beginTransaction();const s=this.modelManipulator.table.insertTable(i,r.rowCount,r.cellCount,n,g.u.pixelsToTwipsF(a),this.inputPosition,!0);return this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(s.getStartPosition()).setEndOfLine(!1))),ac.updateTable(this.control.modelManager,s,i),this.history.endTransaction(),!0}}class g8 extends o8{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.isSelected&&this.selection.tableInfo.rawData.withoutGapByRows}executeCore(e,t){this.history.beginTransaction();const r=t.subDocument,i=this.selection.tableInfo,n=i.table,o=i.rawData.numRows,a=this.getPatternRowIndex(i),s=f.ListUtils.initByCallback(o,(e=>this.insertTableRowCore(r,n,a+e)));return this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(on.FixedInterval.fromPositions(s[0].getStartPosition(),f.ListUtils.last(s).getEndPosition())).setEndOfLine(!1))),ac.updateTable(this.control.modelManager,n,r),this.history.endTransaction(),!0}}class m8 extends g8{insertTableRowCore(e,t,r){return this.modelManipulator.table.insertRowAbove(e,t,r),t.rows[r]}getPatternRowIndex(e){return e.rawData.rows[0].rowIndex}}class f8 extends g8{insertTableRowCore(e,t,r){return this.modelManipulator.table.insertRowBelow(e,t,r),t.rows[r+1]}getPatternRowIndex(e){return e.rawData.lastRowInfo.rowIndex}}class b8 extends EU{getState(){let e=new UU(this.isEnabled());return e.visible=this.selection.tableInfo.extendedData.numRows>0&&!this.selection.specialRunInfo.isPictureSelected(),e}isEnabled(){const e=this.selection.tableInfo.extendedData;return Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&e.isSquare&&(e.numRows>1||e.rows[0].cells.length>1)&&super.isEnabled()}executeCore(e,t){this.history.beginTransaction();const r=this.selection.tableInfo,i=t.subDocument;return this.mergeCellsHorizontally(i,r),this.mergeCellsVertically(i,r),this.modelManipulator.table.normalizeRows(i,r.table),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(r.extendedData.firstCell.interval).setEndOfLine(!1))),ac.updateTable(this.control.modelManager,r.table,t.subDocument),this.history.endTransaction(),!0}getIntervalsForModifying(){if(this.control.isClientMode())return super.getIntervalsForModifying();{const e=this.selection.tableInfo.table;return[on.FixedInterval.fromPositions(e.getStartPosition(),e.getEndPosition())]}}mergeCellsHorizontally(e,t){this.modelManipulator.table.mergeSelectedTableCellsHorizontally(e,t,this.inputPosition)}mergeCellsVertically(e,t){this.modelManipulator.table.mergeSelectedTableCellsVertically(e,t,this.inputPosition)}}class C8 extends w6{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.tables)&&this.selection.tableInfo.extendedData.areCellsSelectedInSeries}executeCore(e,t){const r=t.param;this.history.beginTransaction();const i=this.selection.tableInfo;let n=f.ListUtils.map(i.rawData.rows,(e=>f.ListUtils.map(e.cells,(e=>e.cell)))),o=i.extendedData.firstCell;return r.isMergeBeforeSplit&&(this.control.commandManager.getCommand(FF.MergeTableCells).execute(this.control.commandManager.isPublicApiCall),n=this.filterRemovedCells(n)),this.splitTableCellsHorizontally(this.selection.activeSubDocument,n,r),this.splitTableCellsVertically(this.selection.activeSubDocument,n,r),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(n[0][0].startParagraphPosition.value).setEndOfLine(!1))),ac.updateTable(this.control.modelManager,o.parentRow.parentTable,this.selection.activeSubDocument),this.history.endTransaction(),!0}splitTableCellsHorizontally(e,t,r){let i=t[0][0],n=i.parentRow.parentTable;if(r.isMergeBeforeSplit){let t=C.SearchUtils.normedInterpolationIndexOf(n.rows,(e=>e.getStartPosition()),i.startParagraphPosition.value),o=C.SearchUtils.normedInterpolationIndexOf(n.rows[t].cells,(e=>e.startParagraphPosition.value),i.startParagraphPosition.value);return void this.splitTableCellsHorizontallyCore(e,Qa.createAndInit(n,t,o),r.columnCount)}let o=C.SearchUtils.normedInterpolationIndexOf(n.rows,(e=>e.getStartPosition()),i.startParagraphPosition.value);for(var a=t.length-1;a>=0;a--){let i=a+o,s=n.rows[i],l=C.SearchUtils.normedInterpolationIndexOf(s.cells,(e=>e.startParagraphPosition.value),t[a][0].startParagraphPosition.value);for(let o=t[a].length-1;o>=0;o--){let t=l+o;s.cells[t].verticalMerging!==Xe.Continue&&this.splitTableCellsHorizontallyCore(e,Qa.createAndInit(n,i,t),r.columnCount)}}}splitTableCellsVertically(e,t,r){if(1===r.rowCount)return;let i=this.getColumnsCountForSplitVertically(t[0],r),n=t[0][0],o=C.SearchUtils.normedInterpolationIndexOf(n.parentRow.parentTable.rows,(e=>e.getStartPosition()),n.startParagraphPosition.value),a=C.SearchUtils.normedInterpolationIndexOf(n.parentRow.cells,(e=>e.startParagraphPosition.value),n.startParagraphPosition.value);this.splitTableCellsVerticallyCore(e,Qa.createAndInit(n.parentRow.parentTable,o,a),r.rowCount,i)}splitTableCellsVerticallyCore(e,t,r,i){oc.splitTableCellsVerticallyCore(this.control,e,t,r,i,this.inputPosition)}splitTableCellsHorizontallyCore(e,t,r){oc.splitTableCellsHorizontallyCore(this.control,e,t,r,this.inputPosition)}getColumnsCountForSplitVertically(e,t){return t.isMergeBeforeSplit?t.columnCount:e.length*t.columnCount}filterRemovedCells(e){let t=[],r=e[0][0].parentRow.parentTable;for(let i,n=0;i=e[n];n++){let e=i[0].parentRow;r.rows.indexOf(e)<0||t.push([i[0]])}return t}}class S8 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=this.selection;let i=r.lastSelectedInterval.clone();const n=this.selection.tableInfo.rawData;if(n.areCellsSelectedInSeries&&n.atLeastOneCellFullySelected(r.intervals)){const e=this.control.commandManager.getCommand(FF.DeleteTableCellsByBackspace);if(e.getState().enabled)return e.execute(this.control.commandManager.isPublicApiCall)}const o=0==i.length,a=this.selection.activeSubDocument;if(o){if(this.tryChangeParagraphAlignOrIndent(i))return!0;const e=a.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,a,i.start,Hu.Character,(new cg).setDefault(!0),(new cg).setDefault(!0)):new pg(this.control.layout,a,i.start,r.pageIndex,Hu.Character).create((new cg).setDefault(!0),(new cg).setDefault(!0));i.start=e.getLogPosition()-1;const t=a.isMain()?this.control.layout.pages[0].getPosition():e.pageArea.pageOffset;if(i.start<t)return!1;if(i.start===t&&I.Y.isAnyOf(a.getRunByPosition(i.start).getType(),cs.AnchoredPictureRun,cs.AnchoredTextBoxRun))return!1;i.length=1}return(i.end!=this.selection.activeSubDocument.getDocumentEndPosition()||1!==i.length)&&(!(!o||!S8.getIntervalAccordingFields(this.selection.activeSubDocument,this.selection,i,!0))||!!this.selection.activeSubDocument.isEditable([i])&&(this.history.beginTransaction(),this.addSelectionBefore(),this.modelManipulator.range.removeInterval(new gu(this.selection.activeSubDocument,i),!1,!0,!this.control.commandManager.isPublicApiCall),this.addSelectionAfter(i.start),this.history.endTransaction(),!0))}beforeExecute(){var e;null===(e=this.control.barHolder.ribbon)||void 0===e||e.beginUpdate(),this.control.inputPosition.reset(),this._inputPositionCharProps=this.control.inputPosition.getAllCharacterProperties(),this._inputPositionParagraphProps=this.control.inputPosition.getAllParagraphProperties()}afterExecute(){var e;this.control.inputPosition.applyAllCharacterProperties(this._inputPositionCharProps,!0),this.control.inputPosition.applyAllParagraphProperties(this._inputPositionParagraphProps),null===(e=this.control.barHolder.ribbon)||void 0===e||e.endUpdate()}tryChangeParagraphAlignOrIndent(e){const t=this.selection.activeSubDocument.paragraphs,r=C.SearchUtils.normedInterpolationIndexOf(t,(e=>e.startLogPosition.value),e.start),i=t[r];return e.start===i.startLogPosition.value&&this.selection.activeSubDocument.isEditable([i.interval])&&(this.tryChangeParagraphAlign(i)||this.tryDeleteList(i,r)||this.tryChangeParagraphIndent(i))}tryChangeParagraphAlign(e){const t=e.getParagraphMergedProperties(),r=t.alignment==Ae.Right;return!(!r&&t.alignment!=Ae.Center)&&(this.history.addAndRedo(new st(this.modelManipulator,new gu(this.selection.activeSubDocument,e.interval),r?Ae.Center:Ae.Left,!0)),!0)}tryDeleteList(e,t){if(!e.isInList())return!1;const r=e.getParagraphMergedProperties().leftIndent;return this.history.beginTransaction(),this.history.addAndRedo(new xw(this.modelManipulator,this.selection.activeSubDocument,t)),r!=e.getParagraphMergedProperties().leftIndent&&this.history.addAndRedo(new ft(this.modelManipulator,new gu(this.selection.activeSubDocument,e.interval),r,!0)),this.history.endTransaction(),!0}tryChangeParagraphIndent(e){const t=this.history,r=e.interval,i=e.getParagraphMergedProperties(),n=this.selection.activeSubDocument;let o=!1;return t.beginTransaction(),i.leftIndent>0&&(t.addAndRedo(new ft(this.modelManipulator,new gu(n,r),0,!0)),o=!0),i.firstLineIndent>0&&(t.addAndRedo(new pt(this.modelManipulator,new gu(n,r),0,!0)),o=!0),i.firstLineIndentType!==ke.None&&(t.addAndRedo(new gt(this.modelManipulator,new gu(n,r),ke.None,!0)),o=!0),t.endTransaction(),o}static getIntervalAccordingFields(e,t,r,i){const n=r.clone();return Md.correctIntervalDueToFields(e,n),r.equals(n)?null:(i&&t.deprecatedSetSelection(n.start,n.end,t.endOfLine,t.keepX,!0),n)}}class I8 extends EU{getState(){let e;if(this.isEnabled()){let t=this.selection.activeSubDocument.getRunByPosition(this.selection.specialRunInfo.getPicturePosition());e=[t.size.scale.width,t.size.scale.height]}return new UU(this.isEnabled(),e)}isEnabled(){return super.isEnabled()&&this.selection.specialRunInfo.isPictureSelected()&&!this.selection.specialRunInfo.isSelectedAnchorObject}executeCore(e,t){return this.history.addAndRedo(new W_(this.modelManipulator,new gu(t.subDocument,new on.FixedInterval(this.selection.specialRunInfo.getPicturePosition(),1)),new so.Size(t.param[0],t.param[1]))),!0}}class P8 extends tt{constructor(e,t,r,i){super(e,t),this.layoutFormatterManager=i,this.selection=r}undo(){this.modelManipulator.textCase.applyBufferState(this.boundSubDocument,this.oldState)}}class w8 extends P8{redo(){this.oldState=this.modelManipulator.textCase.applyUpperCase(this.layoutFormatterManager,this.selection,this.boundSubDocument,this.interval)}}class y8 extends P8{redo(){this.oldState=this.modelManipulator.textCase.applyLowerCase(this.layoutFormatterManager,this.selection,this.boundSubDocument,this.interval)}}class x8 extends P8{redo(){this.oldState=this.modelManipulator.textCase.applyCapitalizeEachWordCase(this.layoutFormatterManager,this.selection,this.boundSubDocument,this.interval)}}class T8 extends P8{redo(){this.oldState=this.modelManipulator.textCase.applyToggleCase(this.layoutFormatterManager,this.selection,this.boundSubDocument,this.interval)}}class v8 extends P8{redo(){this.oldState=this.modelManipulator.textCase.applySentenceCase(this.layoutFormatterManager,this.selection,this.boundSubDocument,this.interval)}}class M8 extends EU{getActualIntervals(){return this.selection.isCollapsed()?[this.selection.activeSubDocument.getWholeWordInterval(this.selection.intervals[0].start,!1,!0)]:f.ListUtils.deepCopy(this.selection.intervalsInfo.intervals)}getState(){return new VU(this.isEnabled(),this.getActualIntervals())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.characterFormatting)}}class E8 extends M8{getActualInterval(){return this.selection.isCollapsed()?this.selection.activeSubDocument.getWholeWordInterval(this.selection.intervals[0].start,!1,!0):this.selection.lastSelectedInterval.clone()}getState(){return new VU(this.isEnabled(),this.getActualIntervals())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.characterFormatting)}executeCore(e,t){if(0===e.intervals.length||0===e.intervals[0].length)return!1;var r=this.modelManipulator,i=this.selection.activeSubDocument;return this.history.addTransaction((()=>{for(let t,n=0;t=e.intervals[n];n++)this.history.addAndRedo(new(this.getHistoryItemName())(r,new gu(i,t),this.selection,this.control.layoutFormatterManager)),this.history.addAndRedo(new _t(r,new gu(i,t),!1,!0))})),!0}}class D8 extends E8{getHistoryItemName(){return x8}}class F8 extends E8{getHistoryItemName(){return y8}}class R8 extends E8{getHistoryItemName(){return w8}}class L8 extends E8{getHistoryItemName(){return T8}}class B8 extends E8{getHistoryItemName(){return v8}}class A8 extends M8{executeCore(e,t){var r=!1;this.history.beginTransaction();for(let i,n=0;i=e.intervals[n];n++){let n=this.getCommand(i);r=this.control.commandManager.getCommand(n).executeCore(e,t)}return this.history.endTransaction(),r}getCommand(e){var t=XI.getBuilder(this.control.layoutFormatterManager,this.selection,this.selection.activeSubDocument,e,!0).sentences,r=!1,i=!1,n=!1,o=!1,a=!0,s=!0,l=!0;e:for(var d,c=0;d=t[c];c++){d.words[0].parts[0].position>=e.start&&d.getLastWord().getLastWordPart().getEndPosition()<=e.end&&(i=!0);for(var h,u=0;h=d.words[u];u++)for(var p,g=0;p=h.parts[g];g++)if(!(p.position<e.start)){if(p.position>=e.end)break e;if(p.type==lc.Text){var m=p.text[0],f=p.text.substr(1);0==u&&0==g?(n=n||rn.StringUtils.stringInLowerCase(m)&&!rn.StringUtils.stringInUpperCase(m),r=r||rn.StringUtils.atLeastOneSymbolInUpperCase(f)):r=r||rn.StringUtils.atLeastOneSymbolInUpperCase(p.text),0==g&&(o=o||rn.StringUtils.stringInLowerCase(m)&&!rn.StringUtils.stringInUpperCase(m),l=l&&rn.StringUtils.stringInUpperCase(m)),a=a&&rn.StringUtils.stringInLowerCase(f),s=s&&rn.StringUtils.stringInUpperCase(p.text)}}}return s?FF.MakeTextLowerCase:l&&a?FF.MakeTextUpperCase:i&&(n||r)?FF.SentenceCase:o&&a?FF.CapitalizeEachWordTextCase:FF.MakeTextUpperCase}}function N8(e,t){let r=t;"string"==typeof t&&(r=EE.convertHtml(t)),e.setEditableDocumentContent(r);const i=e.getEditableDocument();return(i.body||i).childNodes}class k8 extends EU{constructor(e,t){super(e),this.queryCommandId=t,this.isTouchMode()&&(k8.builtInClipboard=new H8(this.control)),this.clipboardHelper=new V8(this.control,this.isTouchMode())}getState(){var e=new UU(this.isEnabled());return e.visible=this.isVisible(),e}isTouchMode(){return this.control.isTouchMode()}isCommandSupported(){const e=this.control.inputController.getEditableDocument();return!!e.queryCommandSupported&&e.queryCommandSupported(this.queryCommandId)}execute(e,t=this.control.shortcutManager.lastCommandExecutedByShortcut){const r=this.control.commandManager.isPublicApiCall;if(this.control.commandManager.isPublicApiCall=e,this.isTouchMode()||t||this.isCommandSupported()){const e=this.convertToCommandOptions(t);return this.beforeExecute(),this.executeCore(this.getState(),e),this.control.commandManager.isPublicApiCall=r,!0}return this.control.commandManager.isPublicApiCall=r,this.clipboardHelper.canReadFromClipboard()?(this.clipboardHelper.readFromClipboard().catch((e=>{console.warn(e),this.executeShowErrorMessageCommand()})),!0):this.executeShowErrorMessageCommand()}executeCore(e,t){return!(!e.enabled||null!=this.control.commandManager.clipboardTimerId)&&(this.isTouchMode()?this.executeBuiltInClipboardAction(this.getBuiltInClipboardActionType()):(t.param||this.control.inputController.getEditableDocument().execCommand(this.queryCommandId,!1,null),this.control.commandManager.clipboardTimerId=setTimeout((()=>{this.executeFinalAction()}),this.getTimeout())),!0)}getTimeout(){return k8.timeout}executeFinalAction(){this.control.isClosed()||null===this.control.commandManager.clipboardTimerId||(this.control.beginUpdate(),this.changeModel(),this.clipboardHelper.clearAfterImport(),this.control.endUpdate(),this.control.commandManager.clipboardTimerId=null)}executeShowErrorMessageCommand(){return this.control.commandManager.getCommand(FF.ShowErrorClipboardAccessDeniedMessageCommand).execute(this.control.commandManager.isPublicApiCall)}executeBuiltInClipboardAction(e){switch(this.control.beginUpdate(),e){case w2.Copy:k8.builtInClipboard.copy(),this.tryWriteToClipboard();break;case w2.Cut:k8.builtInClipboard.cut(),this.tryWriteToClipboard();break;case w2.Paste:this.clipboardHelper.canReadFromClipboard()?this.clipboardHelper.readFromClipboard().catch((e=>{k8.builtInClipboard.paste(),console.warn(e)})):k8.builtInClipboard.paste()}this.control.endUpdate()}tryWriteToClipboard(){this.clipboardHelper.tryWriteToClipboard(k8.builtInClipboard.clipboardData).catch((e=>console.log(e)))}isVisible(){return!0}getBuiltInClipboardActionType(){throw new Error(R.D.NotImplemented)}changeModel(){}beforeExecute(){yH.Browser.TouchUI||this.control.focusManager.captureFocus()}}k8.additionalWaitingTimeForMac=10,k8.timeout=yH.Browser.Firefox||yH.Browser.MacOSPlatform&&(yH.Browser.WebKitFamily||yH.Browser.Opera)?10:0;class O8 extends k8{constructor(e){super(e,"copy")}copyEventRaised(){yH.Browser.MacOSPlatform&&null!==this.control.commandManager.clipboardTimerId&&setTimeout((()=>{clearTimeout(this.control.commandManager.clipboardTimerId),this.executeFinalAction()}),k8.additionalWaitingTimeForMac)}getTimeout(){return yH.Browser.MacOSPlatform?300:super.getTimeout()}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.copy)&&!this.selection.isCollapsed()}isVisible(){return Bb.isVisible(this.control.modelManager.richOptions.control.copy)}getBuiltInClipboardActionType(){return w2.Copy}beforeExecute(){Bb.isEnabled(this.control.modelManager.richOptions.control.copy)&&(super.beforeExecute(),this.isTouchMode()||this.control.inputController.renderSelectionToEditableDocument())}isEnabledInReadOnlyMode(){return!0}}class _8 extends k8{constructor(e){super(e,"cut")}changeModel(){this.history.addTransaction((()=>{const e=f.ListUtils.deepCopy(this.selection.intervalsInfo.intervals);f.ListUtils.reverseForEach(e,(e=>this.modelManipulator.range.removeInterval(new gu(this.selection.activeSubDocument,e),!0,!0))),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(e[0].start)))}))}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.cut)&&!this.selection.isCollapsed()}isVisible(){return Bb.isVisible(this.control.modelManager.richOptions.control.cut)}getBuiltInClipboardActionType(){return w2.Cut}beforeExecute(){Bb.isEnabled(this.control.modelManager.richOptions.control.cut)&&(super.beforeExecute(),this.isTouchMode()||this.control.inputController.renderSelectionToEditableDocument())}}class U8 extends k8{constructor(e){super(e,"paste")}getTimeout(){return yH.Browser.MacOSPlatform?300:super.getTimeout()}pasteEventRaised(){yH.Browser.MacOSPlatform&&null!==this.control.commandManager.clipboardTimerId&&setTimeout((()=>{clearTimeout(this.control.commandManager.clipboardTimerId),this.executeFinalAction()}),k8.additionalWaitingTimeForMac)}changeModel(){const e=N8(this.control.inputController,this.control.inputController.getEditableDocumentContent());this.control.isLoadingPictureFromClipboard||this.control.importHtml(e)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paste)}isVisible(){return Bb.isVisible(this.control.modelManager.richOptions.control.paste)||this.isTouchMode()}getBuiltInClipboardActionType(){return w2.Paste}beforeExecute(){if(Bb.isEnabled(this.control.modelManager.richOptions.control.paste)&&(super.beforeExecute(),!this.isTouchMode())){var e=yH.Browser.TouchUI?window.getSelection():this.control.inputController.getEditableDocument().getSelection();e.removeAllRanges();var t=this.control.inputController.getEditableDocument();e.selectAllChildren(t.body||t)}}isCommandSupported(){return yH.Browser.IE}}class H8{constructor(e){this.control=e}get clipboardData(){return this._clipboardData}copy(){this._clipboardData=fb.create(this.control.selection.subDocumentIntervals)}paste(){this._clipboardData&&(this.control.modelManager.modelManipulator.range.removeInterval(this.control.selection.subDocumentInterval,!0,!1),this._clipboardData.insertTo(this.control.modelManager.modelManipulator,this.control.selection.intervalsInfo.subDocPosition))}cut(){this.control.modelManager.history.addTransaction((()=>{this.copy(),f.ListUtils.reverseForEach(this.control.selection.intervalsInfo.intervals,(e=>this.control.modelManager.modelManipulator.range.removeInterval(new gu(this.control.selection.activeSubDocument,e),!0,!0))),this.control.modelManager.history.addAndRedo(new TU(this.control.modelManager.modelManipulator,this.control.selection,this.control.selection.getState(),this.control.selection.getState().setPosition(this.control.selection.intervalsInfo.intervals[0].start)))}))}}class V8{constructor(e,t=!1){this.control=e,this.useWithBuildInClipboard=t}get clipboard(){return navigator.clipboard}canReadFromClipboard(){return!(!this.clipboard||!this.clipboard.read&&!this.clipboard.readText)}readFromClipboard(){return this.clipboard.read?this.clipboard.read().then((e=>this.insertClipboardItems(e))):this.clipboard.readText?this.clipboard.readText().then((e=>this.insertPlainText(e))):Promise.reject(V8.browserDoesNotSupportReadingFromClipboard)}clearAfterImport(){const e=this.control.inputController.getEditableDocument();if(yH.Browser.TouchUI)getSelection().removeAllRanges(),fn.DomUtils.clearInnerHtml(yH.Browser.MSTouchUI?e.body:e);else{const t=e.getSelection?e.getSelection():e.selection;t.removeAllRanges?t.removeAllRanges():t.empty&&t.empty(),fn.DomUtils.clearInnerHtml(e.body)}!yH.Browser.TouchUI||yH.Browser.IE&&yH.Browser.MSTouchUI?this.control.inputController.selectEditableDocumentContent():getSelection().selectAllChildren(e)}insertClipboardItems(e){for(let t of e){if(f.ListUtils.anyOf(t.types,(e=>e===Ru.HtmlMimeType)))return this.insertClipboardItem(t,Ru.HtmlMimeType,(e=>this.insertHtml(e)));if(f.ListUtils.anyOf(t.types,(e=>e===Ru.PlainTextMimeType)))return this.insertClipboardItem(t,Ru.PlainTextMimeType,(e=>this.insertPlainText(e)))}return Promise.reject(V8.noDataInClipboardMessage)}insertClipboardItem(e,t,r){return e.getType(t).then((e=>this.readAsText(e))).then((e=>r(e)))}insertPlainText(e){return new Promise(((t,r)=>{V8.lastWritenTextHash===this.calculateHash(e)&&r(),V8.lastWritenTextHash=-1;new z8(this.control).execute(!1,new MU(this.control,e))?t():r(V8.clipboardItemCannotBeInsertedMessage)}))}insertHtml(e){return new Promise(((t,r)=>{try{this.control.beginUpdate(),this.control.importHtml(N8(this.control.inputController,e)),this.clearAfterImport(),this.control.endUpdate(),t()}catch(e){r(V8.clipboardItemCannotBeInsertedMessage)}}))}canWriteToClipboard(){var e;return!!(null===(e=this.clipboard)||void 0===e?void 0:e.writeText)}writeToClipboard(e){return V8.lastWritenTextHash=-1,new Promise(((t,r)=>{const i=this.createModelManager(e.model);new CV(i.modelManipulator,new BP).exportToBlob((e=>YD(this,void 0,void 0,(function*(){const i=yield this.readAsText(e);if(this.useWithBuildInClipboard&&(V8.lastWritenTextHash=this.calculateHash(i)),!this.canWriteToClipboard())return Promise.reject(V8.browserDoesNotSupportWritingToClipboard);this.clipboard.writeText(i).then((()=>t())).catch((e=>r(e)))}))))}))}tryWriteToClipboard(e){return this.canWriteToClipboard()?this.writeToClipboard(e):Promise.resolve()}calculateHash(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}readAsText(e){return e.text()}createModelManager(e){return new cP(e,this.control.modelManager.richOptions,new Lb.m1)}}V8.browserDoesNotSupportReadingFromClipboard="The browser does not support reading from the clipboard.",V8.browserDoesNotSupportWritingToClipboard="The browser does not support writing to the clipboard.",V8.noDataInClipboardMessage="There is no any supported data in the clipboard.",V8.clipboardItemCannotBeInsertedMessage="The clipboard item cannot be inserted.",V8.lastWritenTextHash=-1;class W8 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=N8(this.control.inputController,t.param);return this.history.addTransaction((()=>{const e=this.inputPosition.charPropsBundle;this.modelManipulator.range.removeInterval(this.selection.subDocumentInterval,!0,!1),new EE(this.control.modelManager,this.control.measurer,this.selection.intervalsInfo.subDocPosition,r,e).import()})),this.control.inputController.setEditableDocumentContent(""),!0}}class z8 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=t.param;let i=!1;const n=this.selection.activeSubDocument,o=this.selection.anchorPosition,a=new pu(n,o),s=this.control.inputPosition.charPropsBundle,l=this.control.inputPosition.parPropsBundle;return this.history.addTransaction((()=>{this.modelManipulator.range.removeInterval(this.selection.subDocumentInterval,!0,!1),(new H_).importFromString(r,n.documentModel.modelOptions,((e,t)=>{new fb(e,!1).insertTo(this.control.modelManager.modelManipulator,a),i=!0}),(e=>{i=!1}),s,l)})),i}}!function(e){e[e.Copy=0]="Copy",e[e.Paste=1]="Paste",e[e.Cut=2]="Cut"}(w2||(w2={}));class j8 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=t.subDocument,i=f.ListUtils.map(t.intervalsInfo.intervals,(e=>new md(r.positionManager,e)));return this.history.addTransaction((()=>{for(let n of i){var e=n.getFixedInterval(),t=0==n.length;if(t){const t=r.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,r,n.start,Hu.Character,(new cg).setDefault(this.selection.endOfLine),(new cg).setDefault(!1)):new pg(this.control.layout,r,n.start,this.selection.pageIndex,Hu.Character).create((new cg).setDefault(this.selection.endOfLine),(new cg).setDefault(!1));t.switchToStartNextBoxInRow(),e.start=t.getLogPosition(),e.length=1}if(n.end!==r.getDocumentEndPosition()||1!==e.length){if(t&&S8.getIntervalAccordingFields(r,this.selection,e,!0))break;r.isEditable([e])&&(this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setPosition(e.start))),this.modelManipulator.range.removeInterval(new gu(r,e),!1,!0,!this.control.commandManager.isPublicApiCall))}}})),f.ListUtils.forEach(i,(e=>e.destructor(r.positionManager))),!0}}class X8 extends EU{executeCore(e,t){if(!t.intervalsInfo.intervals.length)return!1;let r=t.param;const i=t.subDocument;if(!i.isEditable([new on.FixedInterval(r,0)]))return!1;if(this.tryCopyIntervalInsideTable(t.intervalsInfo,r))return!0;const n=f.ListUtils.map(t.intervalsInfo.intervals,(e=>new md(i.positionManager,e)));let o=[];return this.history.addTransaction((()=>{for(let e of n){const t=e.getFixedInterval();this.modelManipulator.range.copyIntervalTo(i,t,r),o.push(new on.FixedInterval(r,t.length)),r+=t.length}this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setIntervals(o)))})),f.ListUtils.forEach(n,(e=>e.destructor(i.positionManager))),!0}canModify(){return!0}getState(){var e=new UU(this.isEnabled());return e.visible=this.control.modelManager.richOptions.control.drag!==Db.Hidden&&this.control.modelManager.richOptions.control.drop!==Db.Hidden,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.drag)&&Bb.isEnabled(this.control.modelManager.richOptions.control.drop)&&!this.selection.isCollapsed()}tryCopyIntervalInsideTable(e,t){return!!e.tableInfo.extendedData.numRows&&(this.history.addTransaction((()=>{const r=fb.create(e.subDocIntervals).insertTo(this.modelManipulator,new pu(e.subDocument,t));this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(r)))})),!0)}}class G8 extends EU{executeCore(e,t){if(!t.intervalsInfo.intervals.length)return!1;let r=t.param;if(!this.selection.activeSubDocument.isEditable([new on.FixedInterval(r,0)]))return!1;if(1==this.selection.intervals.length&&this.selection.activeSubDocument.getDocumentEndPosition()-1==this.selection.intervals[0].start||!this.selection.activeSubDocument.isEditable(this.selection.intervals))return this.control.commandManager.getCommand(FF.DragCopyContent).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,r));let i=this.selection.activeSubDocument;const n=this.selection.tableInfo;if(n.isSelected&&n.extendedData.atLeastOneCellFullySelected(this.selection.intervals)&&f.ListUtils.unsafeAnyOf(n.extendedData.rows,(e=>f.ListUtils.unsafeAnyOf(e.cells,(e=>e.cell.interval.containsWithIntervalEnd(r))))))return!1;if(this.tryMoveIntervalInsideTable(t.intervalsInfo,r))return!0;const o=f.ListUtils.map(t.intervalsInfo.intervals,(e=>new md(i.positionManager,e)));let a;return this.history.addTransaction((()=>{const e=[];a=f.ListUtils.indexBy(o,(e=>e.start<=r&&e.end>=r)),a>=0&&(r=o[a].start);const t=o[a],n=t?t.length:0;for(let t,s=0;t=o[s];s++){if(s===a){o.length>1&&e.push(new md(i.positionManager,new on.FixedInterval(r,n))),r+=n;continue}const l=t.getFixedInterval();this.modelManipulator.range.moveIntervalTo(new gu(i,l),r);const d=l.start<r?r-l.length:r,c=d+l.length;e.push(new md(i.positionManager,new Cn.e(d,c))),r<=l.start&&(r+=l.length)}e.length&&(this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setIntervals(f.ListUtils.map(e,(e=>e.getFixedInterval()))))),f.ListUtils.forEach(e,(e=>e.destructor(i.positionManager))))})),f.ListUtils.forEach(o,(e=>e.destructor(i.positionManager))),o.length>1||-1===a}getState(){var e=new UU(this.isEnabled());return e.visible=this.control.modelManager.richOptions.control.drag!==Db.Hidden&&this.control.modelManager.richOptions.control.drop!==Db.Hidden,e}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.drag)&&Bb.isEnabled(this.control.modelManager.richOptions.control.drop)&&!this.selection.isCollapsed()}tryMoveIntervalInsideTable(e,t){if(!e.tableInfo.extendedData.numRows)return!1;const r=e.subDocument,i=f.ListUtils.map(e.intervals,(t=>new md(e.subDocument.positionManager,t)));return this.history.addTransaction((()=>{const n=new md(r.positionManager,fb.create(e.subDocIntervals).insertTo(this.modelManipulator,new pu(r,t)));f.ListUtils.forEach(i,(e=>{this.modelManipulator.range.removeInterval(new gu(r,e.getFixedInterval()),!0,!1),e.destructor(r.positionManager)})),this.history.addAndRedo(new TU(this.modelManipulator,this.selection,this.selection.getState(),this.selection.getState().setInterval(n.getFixedInterval()).setEndOfLine(!0))),n.destructor(r.positionManager)})),!0}canModify(){return!0}}class K8 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.sections)&&0==this.selection.tableInfo.extendedData.numRows&&this.selection.activeSubDocument.isMain()}executeCore(e,t){return this.insertTextWithSelection(t.intervalsInfo.subDocInterval,an.specialCharacters.ColumnBreak),!0}}class q8 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){return this.insertTextWithSelection(t.intervalsInfo.subDocInterval,an.specialCharacters.LineBreak),!0}}class $8 extends EU{getState(e=this.convertToCommandOptions(void 0)){return new UU(this.isEnabled(e))}executeCore(e,t){return this.history.addTransaction((()=>{this.addSelectionBefore();let e=t.intervalsInfo.position;this.control.modelManager.richOptions.control.pageBreakInsertMode===Fb.NewLine&&(e=EU.replaceTextByParagraph(this.control.modelManager,this.inputPosition,t.intervalsInfo.subDocInterval).end),e=this.modelManipulator.text.insertTextViaHistory(new op(new pu(t.subDocument,e),this.inputPosition.charPropsBundle,cs.TextRun,an.specialCharacters.PageBreak)).insertedInterval.end,e=this.modelManipulator.paragraph.insertParagraphViaHistory(Ag.makeParamsByPosition(new pu(t.subDocument,e),this.inputPosition)).end,this.addSelectionAfter(e)})),!0}isEnabled(e){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphs)&&0==this.selection.tableInfo.extendedData.numRows&&e.subDocument.isMain()}}class J8 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphs)}executeCore(e,t){const r=t.subDocument,i=t.intervalsInfo.interval;if(this.lock=0==i.length,this.tryInsertParagraphBeforeTable(i,r))return!0;const n=C.SearchUtils.normedInterpolationIndexOf(r.paragraphs,(e=>e.startLogPosition.value),i.start),o=r.paragraphs[n];if((0===i.length||1===i.start)&&o.startLogPosition.value===i.start&&o.isInList()&&1===o.length&&r.isEditable([o.interval]))return this.lock=!1,this.history.addAndRedo(new xw(this.modelManipulator,r,n)),!0;let a=this.lock&&i.start==o.getEndPosition()-1?this.inputPosition.getAllCharacterProperties():null;return this.history.addTransaction((()=>{this.addSelectionBefore();const e=EU.replaceTextByParagraph(this.control.modelManager,this.inputPosition,t.intervalsInfo.subDocInterval);this.addSelectionAfter(e.end,(e=>e.setEndOfLine(!1)))})),a&&(this.inputPosition.applyAllCharacterProperties(a),this.control.selectionModelChangesListener.resetOccurredEvents()),this.lock&&this.control.inputPositionModelChangesListener.resetOccurredEvents(),!0}lockBarHolderUpdate(e){return this.lock&&e===this.control.getModifiedState()}lockInputPositionUpdating(){return this.lock}tryInsertParagraphBeforeTable(e,t){if(e.start>0||e.length>0)return!1;let r=t.tables[0];return r&&0===r.getStartPosition()?(this.history.addTransaction((()=>{this.modelManipulator.table.insertParagraphToTheCellStartAndShiftContent(t,r.rows[0].cells[0],this.inputPosition),this.history.addAndRedo(new Nd(this.modelManipulator,t,r.index))})),!0):void 0}}class Y8 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.sections)&&0==this.selection.tableInfo.extendedData.numRows&&this.selection.activeSubDocument.isMain()&&B0.rangePermissionIncludeFullSection(this.control,this.selection.activeSubDocument,this.selection.intervals)}executeCore(e,t){const r=this.inputPosition.charPropsBundle;return this.insertSomeWithSelection(gu.fromPosition(this.selection.activeSubDocument,t.intervalsInfo.position),(e=>(this.modelManipulator.section.insertSectionAndSetStartType(e.position,this.getStartType(),r),e.position+1))),!0}}class Q8 extends Y8{getStartType(){return Vs.NextPage}}class Z8 extends Y8{getStartType(){return Vs.EvenPage}}class e7 extends Y8{getStartType(){return Vs.OddPage}}class t7 extends EU{getState(){return new UU(this.isEnabled())}DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo=this.selection.intervalsInfo.clone()}executeCore(e,t){return this.control.commandManager.getCommand(FF.InsertText).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,an.specialCharacters.Space).setIntervalsInfo(t.intervalsInfo))}}class r7 extends EU{getState(){return new UU(this.isEnabled())}DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo=this.selection.intervalsInfo.clone()}executeCore(e,t){return this.control.commandManager.getCommand(FF.InsertText).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,an.specialCharacters.NonBreakingSpace).setIntervalsInfo(t.intervalsInfo))}}class i7 extends EU{getState(){return new UU(this.isEnabled())}setNextObj(e){do{if(I.Y.isAnyOf(e.run.getType(),cs.InlinePictureRun,cs.AnchoredPictureRun,cs.AnchoredTextBoxRun))return!0}while(e.moveToNextRun());return!1}executeCore(e,t){const r=this.selection.specialRunInfo;if(r.isSelected()&&(!r.isTextBoxSelected()||this.selection.activeSubDocument.id==r.getParentSubDocument().id)){const e=new jh(this.selection.activeSubDocument,!0);return e.setPosition(r.getPosition()+1),this.setNextObj(e)||(e.setPosition(0),this.setNextObj(e)),this.selection.setSelection((new GX).setInterval(new on.FixedInterval(e.getAbsolutePosition(),1))),!0}var i=this.selection.lastSelectedInterval.clone(),n=this.selection.activeSubDocument.getParagraphByPosition(i.start),o=this.selection.activeSubDocument.getDocumentEndPosition();if(i.start>=o)throw new Error("InsertTabCommandBase interval.start >= documentEndPosition");if(i.length>0&&i.end>o)throw new Error("InsertTabCommandBase interval.end > documentEndPosition");var a=this.selection.activeSubDocument,s=a.isMain()?ug.ensureLayoutPosition(this.control.layoutFormatterManager,a,i.start,Hu.Character,(new cg).setDefault(!1),(new cg).setDefault(!1)):new pg(this.control.layout,a,i.start,this.selection.pageIndex,Hu.Character).create((new cg).setDefault(!1),(new cg).setDefault(!1));if(this.addTableRowIfRequired(s))return!0;if(this.performCellIteratorActionIfRequired(s,i.start))return!0;if(!this.control.commandManager.assertLastExecutedCommandsChain(!0,i7)&&0===n.getTabs().positions.length){if(this.needProcessFirstParagraphRow(i,n,s))return n.isInList()?this.createIndentNumberingParagraphCommand().execute(this.control.commandManager.isPublicApiCall):this.createChangeParagraphIndentFromFirstRowCommand().execute(this.control.commandManager.isPublicApiCall);if(this.needProcessParagraphLeftIndent(i,s))return this.createChangeIndentCommand().execute(this.control.commandManager.isPublicApiCall)}return Bb.isEnabled(this.control.modelManager.richOptions.control.tabSymbol)&&this.insertTextWithSelection(t.intervalsInfo.subDocInterval,this.control.modelManager.richOptions.control.tabMarker),!0}addTableRowIfRequired(e){const t=e.row.tableCellInfo;if(!t)return!1;const r=t.parentRow,i=r.parentTable.logicInfo.grid,n=i.tableCellGridInfos[r.rowIndex][t.cellGridIndex],o=n.getEndRowIndex(),a=n.getCellIndex(n.getNumRowsInCell()-1),s=f.ListUtils.last(i.table.rows);return o==i.table.rows.length&&a==s.cells.length-1&&(this.control.commandManager.getCommand(FF.InsertTableRowBelow).execute(this.control.commandManager.isPublicApiCall),this.selection.setSelection((new GX).setPosition(this.selection.intervals[0].start).setEndOfLine(!1)),!0)}needProcessFirstParagraphRow(e,t,r){return!(!this.control.commandManager.assertLastExecutedCommandsChain(!1,i7,c3)||!this.isIntervalStartInParagraphStart(e,t))||this.isIntervalStartInParagraphStart(e,t)&&(0===e.length||this.isIntervalEndOnRowEnd(e,r))}needProcessParagraphLeftIndent(e,t){if(this.control.commandManager.assertLastExecutedCommandsChain(!1,i7,a3))return!0;var r=this.selection.activeSubDocument,i=(r.isMain()?new ug(this.control.layout,r,e.end,Hu.Character):new pg(this.control.layout,r,e.end,this.selection.pageIndex,Hu.Character)).create((new cg).setDefault(!0),(new cg).setDefault(!1));return t&&t.isPositionBeforeFirstBoxInRow()&&this.isIntervalIncludesWholeRow(t,i)}performCellIteratorActionIfRequired(e,t){const r=e.row.tableCellInfo;if(!r)return!1;let i;const n=this.getTablePos(r);for(;i=this.getBoxIterator(t,r.parentRow.parentTable.getTopLevelColumn().logicInfo.grid.table.getEndPosition()+1),!i||!i.isInitialized();)this.control.layoutFormatterManager.forceFormatPage(this.control.layout.validPageCount);for(;this.performCellIteratorAction(i);){const e=this.getTablePos(i.position.row.tableCellInfo);if(!n.equals(e)){if(e&&(n.table.index==e.table.index||e.table.nestedLevel>n.table.nestedLevel)){const t=i.position.row.tableCellInfo.parentRow.parentTable.logicInfo.grid.table.rows[e.rowIndex].cells[e.cellIndex].startParagraphPosition.value;this.selection.setSelection((new GX).setInterval(new on.FixedInterval(t,0)).setEndOfLine(!1))}break}}return!0}getTablePos(e){if(!e)return null;const t=e.parentRow,r=t.parentTable.logicInfo.grid,i=r.tableCellGridInfos[t.rowIndex][e.cellGridIndex];return new Qa(r.table,i.getStartRowIndex(),i.getCellIndex(0))}isIntervalStartInParagraphStart(e,t){return e.start===t.startLogPosition.value}isIntervalEndOnRowEnd(e,t){return!!t&&t.getRelatedSubDocumentPagePosition()+t.pageArea.pageOffset+t.column.pageAreaOffset+t.row.getEndPosition()===e.end}isIntervalIncludesWholeRow(e,t){return!t||t.row!==e.row||t.isPositionAfterLastBoxInRow()}}class n7 extends i7{createIndentNumberingParagraphCommand(){return this.control.commandManager.getCommand(FF.IncrementNumberingIndent)}createChangeParagraphIndentFromFirstRowCommand(){return this.control.commandManager.getCommand(FF.IncrementParagraphIndentFromFirstRow)}createChangeIndentCommand(){return this.control.commandManager.getCommand(FF.IncreaseIndent)}performCellIteratorAction(e){return e.moveNext((new cg).setDefault(!1),(new cg).setDefault(!0))}getBoxIterator(e,t){const r=this.selection.activeSubDocument,i=this.control.layout;return r.isMain()?new rm(r,i,e,t):new im(r,i,e,t,this.selection.pageIndex)}}class o7 extends i7{createIndentNumberingParagraphCommand(){return this.control.commandManager.getCommand(FF.DecrementNumberingIndent)}createChangeParagraphIndentFromFirstRowCommand(){return this.control.commandManager.getCommand(FF.DecrementParagraphIndentFromFirstRow)}createChangeIndentCommand(){return this.control.commandManager.getCommand(FF.DecreaseIndent)}performCellIteratorAction(e){return e.movePrev((new cg).setDefault(!0),(new cg).setDefault(!0))}getBoxIterator(e,t){const r=this.selection.activeSubDocument,i=this.control.layout;return r.isMain()?new rm(r,i,0,e):new im(r,i,0,e,this.selection.pageIndex)}}class a7 extends EU{getState(){return new UU(this.isEnabled())}DEPRECATEDCorrectlMainCommandOptions(e){e.intervalsInfo.intervals=[this.selection.lastSelectedInterval.clone()]}executeCore(e,t){if(0===t.param.length)return!1;const r=t.intervalsInfo.interval;r.length>0&&t.intervalsInfo.subDocInterval.subDocument.getParagraphByPosition(r.end-1).getEndPosition()==r.end&&(t.intervalsInfo.interval.length-=1),this.removedInterval=!!r.length;return this.control.commandManager.assertLastExecutedCommandsChain(!0,a7)&&t.intervalsInfo.isCollapsed&&this.correctPrevHistoryRun(new op(t.intervalsInfo.subDocPosition,this.control.inputPosition.charPropsBundle,cs.TextRun,t.param))||this.insertTextWithSelection(t.intervalsInfo.subDocInterval,t.param),this.control.commandManager.lastTextInsertDate=new Date,r.length||this.control.inputPositionModelChangesListener.resetOccurredEvents(),!0}correctPrevHistoryRun(e){if((new Date).getTime()-this.control.commandManager.lastTextInsertDate.getTime()<2700){const t=this.modelManipulator.text.getLastModifiableHistoryItemNode((e=>e instanceof nm)),r=this.modelManipulator.text.getLastModifiableHistoryItemNode((e=>e instanceof TU));if(t&&r){const i=t.item.params;if(i.subDocPos.subDocument.id==e.subDocPos.subDocument.id&&i.subDocPos.position+i.text.length==e.subDocPos.position&&i.charPropsBundle.style.equalsByName(e.charPropsBundle.style)&&i.charPropsBundle.props.equals(e.charPropsBundle.props)&&!r.item.newState.intervalsInfo.multiselection&&0==r.item.newState.intervalsInfo.intervals[0].length&&r.item.newState.intervalsInfo.interval.start==e.subDocPos.position){this.modelManipulator.text.insertTextInner(e),r.item.newState.intervalsInfo.interval.start+=e.text.length,i.text+=e.text,t.root.item.uniqueId=-1;const n=r.item.newState.intervalsInfo.interval.start;return this.selection.changeState((e=>e.setPosition(n))),this.selection.scrollManager.setScroll((new xD).byModelPosition(this.selection).setModelPosition(n).useStdRelativePosition().useStdOffset()),!0}}}return!1}lockBarHolderUpdate(e){return!this.removedInterval&&e===this.control.getModifiedState()}lockInputPositionUpdating(e){return!this.removedInterval&&e===this.control.getModifiedState()}}class s7 extends EU{getState(){return new UU(this.isEnabled())}executeCore(e,t){const r=this.selection,i=r.lastSelectedInterval.start,n=this.selection.activeSubDocument,o=C.SearchUtils.normedInterpolationIndexOf(n.paragraphs,(e=>e.startLogPosition.value),i),a=this.getDeleteInterval(n,i,o);if(!a||0==a.length||!n.isEditable([a]))return!1;const s=S8.getIntervalAccordingFields(n,r,a,!1);return s&&a.copyFrom(s),this.history.addTransaction((()=>{this.addSelectionBefore(),this.modelManipulator.range.removeInterval(new gu(n,a),!0,!1),this.addSelectionAfter(a.start)})),!0}}class l7 extends s7{getDeleteInterval(e,t,r){return l7.getPrevWordInterval(this.control,e,t,r)}static getPrevWordInterval(e,t,r,i){let n=t.paragraphs[i];if(n.startLogPosition.value==r){if(0==i)return null;n=t.paragraphs[i-1]}const o=on.FixedInterval.fromPositions(n.startLogPosition.value,r),a=XI.getBuilder(e.layoutFormatterManager,e.selection,t,o,!0),s=f.ListUtils.unsafeReverseAnyOf(a.sentences,(e=>f.ListUtils.unsafeReverseAnyOf(e.words,(e=>e.parts[0].position<r?e.parts[0]:null))));return s?on.FixedInterval.fromPositions(s.position,r):null}}class d7 extends s7{getDeleteInterval(e,t,r){return d7.getNextWordInterval(this.control,e,t,r)}static getNextWordInterval(e,t,r,i){i=Math.min(t.paragraphs.length-1,i+1);const n=t.paragraphs[i],o=on.FixedInterval.fromPositions(r,n.getEndPosition()),a=XI.getBuilder(e.layoutFormatterManager,e.selection,t,o,!0),s=f.ListUtils.unsafeAnyOf(a.sentences,(e=>f.ListUtils.unsafeAnyOf(e.words,(e=>e.parts[0].position>r?e.parts[0]:f.ListUtils.unsafeAnyOf(e.parts,(e=>e.position>r&&(e.type==lc.ParagraphMark||e.type==lc.SectionMark)?e:null),1)))));return on.FixedInterval.fromPositions(r,s?s.position:n.getEndPosition())}}class c7 extends EU{isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.paragraphFormatting)}getState(){const e=new UU(this.isEnabled());return e.value=this.control.commandManager.getCommand(FF.ChangeHeadingLevel).getState().value==this.getLevel(null),e}executeCore(e,t){const r=this.getLevel(t.param),i=r>0?`${es.headingStyleName} ${r}`:es.normalStyleName;let n=this.control.modelManager.model.getParagraphStyleByName(i);return n||(n=Wh.getPresetParagraphStyleByName(i)),n?this.control.commandManager.getCommand(FF.ChangeStyle).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,Wh.paragraphPrefix+i)):this.control.commandManager.getCommand(FF.ChangeHeadingLevel).execute(this.control.commandManager.isPublicApiCall,new MU(this.control,r)),!0}getRelatedCommands(){return{[FF.SetParagraphBodyTextLevel]:!0,[FF.SetParagraphHeading1Level]:!0,[FF.SetParagraphHeading2Level]:!0,[FF.SetParagraphHeading3Level]:!0,[FF.SetParagraphHeading4Level]:!0,[FF.SetParagraphHeading5Level]:!0,[FF.SetParagraphHeading6Level]:!0,[FF.SetParagraphHeading7Level]:!0,[FF.SetParagraphHeading8Level]:!0,[FF.SetParagraphHeading9Level]:!0}}}class h7 extends c7{getState(){let e=new UU(this.isEnabled());return e.value=this.control.commandManager.getCommand(FF.ChangeHeadingLevel).getState().value,e}getLevel(e){return e}}class u7 extends c7{getLevel(e){return 0}}class p7 extends c7{getLevel(e){return 1}}class g7 extends c7{getLevel(e){return 2}}class m7 extends c7{getLevel(e){return 3}}class f7 extends c7{getLevel(e){return 4}}class b7 extends c7{getLevel(e){return 5}}class C7 extends c7{getLevel(e){return 6}}class S7 extends c7{getLevel(e){return 7}}class I7 extends c7{getLevel(e){return 8}}class P7 extends c7{getLevel(e){return 9}}class w7 extends EU{getState(){return new UU(this.isEnabled()&&this.history.canUndo())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.undo)}executeCore(e,t){return!!e.enabled&&(this.history.undo(),!0)}canModify(){return!0}}class y7{constructor(e,t){this.publicEnabledState={},this.lastCommandsChain=[],this.executingCommandsChain=[],this.executingCommandCounter=0,this.isPublicApiCall=!1,this.isPrintingProcessing=!1,this.formatImagesImporters=[],this.clipboardTimerId=null,this.lastTextInsertDate=new Date(0),this.commands={},this.createCommand(e,FF.AddSpacingAfterParagraph,i3),this.createCommand(e,FF.AddSpacingBeforeParagraph,n3),this.createCommand(e,FF.CapitalizeEachWordTextCase,D8),this.createCommand(e,FF.ChangeFontBackColor,DZ),this.createCommand(e,FF.ChangeFontForeColor,RZ),this.createCommand(e,FF.ChangeFontName,LZ),this.createCommand(e,FF.ChangeFontSize,BZ),this.createCommand(e,FF.ChangeInlinePictureScale,I8),this.createCommand(e,FF.ChangePageColor,c2),this.createCommand(e,FF.ChangeParagraphBackColor,d3),this.createCommand(e,FF.ChangeStyle,B5),this.createCommand(e,FF.ClearFormatting,A5),this.createCommand(e,FF.ContinueNumberingList,q5),this.createCommand(e,FF.CopySelection,O8),this.createCommand(e,FF.CreateField,a1),this.createCommand(e,FF.CutSelection,_8),this.createCommand(e,FF.DecreaseFontSize,NZ),this.createCommand(e,FF.DecreaseIndent,s3),this.createCommand(e,FF.DecrementNumberingIndent,j5),this.createCommand(e,FF.DecrementParagraphIndentFromFirstRow,u3),this.createCommand(e,FF.DecrementParagraphLeftIndent,m3),this.createCommand(e,FF.DeleteNumerationFromParagraphs,J5),this.createCommand(e,FF.DeleteTabRuler,F3),this.createCommand(e,FF.DocumentEnd,g4),this.createCommand(e,FF.DocumentStart,b4),this.createCommand(e,FF.DragCopyContent,X8),this.createCommand(e,FF.DragMoveContent,G8),this.createCommand(e,FF.ExtendDocumentEnd,m4),this.createCommand(e,FF.ExtendDocumentStart,C4),this.createCommand(e,FF.ExtendGoToEndParagraph,W4),this.createCommand(e,FF.ExtendGoToNextWord,U4),this.createCommand(e,FF.ExtendGoToPrevWord,e6),this.createCommand(e,FF.ExtendGoToStartParagraph,X4),this.createCommand(e,FF.ExtendLineDown,x4),this.createCommand(e,FF.ExtendLineEnd,M4),this.createCommand(e,FF.ExtendLineStart,F4),this.createCommand(e,FF.ExtendLineUp,w4),this.createCommand(e,FF.ExtendNextCharacter,B4),this.createCommand(e,FF.ExtendNextPage,k4),this.createCommand(e,FF.ExtendPreviousCharacter,q4),this.createCommand(e,FF.ExtendPreviousPage,Y4),this.createCommand(e,FF.ExtendSelectLine,d6),this.createCommand(e,FF.ExtendSelectLineNoUpdateControlState,h6),this.createCommand(e,FF.FullScreen,_5),this.createCommand(e,FF.GoToEndParagraph,V4),this.createCommand(e,FF.GoToNextWord,_4),this.createCommand(e,FF.GoToPrevWord,Z4),this.createCommand(e,FF.GoToFirstDataRecord,b2),this.createCommand(e,FF.GoToPreviousDataRecord,C2),this.createCommand(e,FF.GoToNextDataRecord,S2),this.createCommand(e,FF.GoToLastDataRecord,I2),this.createCommand(e,FF.GoToStartParagraph,j4),this.createCommand(e,FF.IncreaseFontSize,kZ),this.createCommand(e,FF.IncreaseIndent,l3),this.createCommand(e,FF.IncrementNumberingIndent,z5),this.createCommand(e,FF.IncrementParagraphIndentFromFirstRow,h3),this.createCommand(e,FF.IncrementParagraphLeftIndent,g3),this.createCommand(e,FF.InsertColumnBreak,K8),this.createCommand(e,FF.InsertLineBreak,q8),this.createCommand(e,FF.InsertNumerationToParagraphs,$5),this.createCommand(e,FF.InsertPageBreak,$8),this.createCommand(e,FF.InsertParagraph,J8),this.createCommand(e,FF.InsertPicture,F1),this.createCommand(e,FF.InsertSectionBreakEvenPage,Z8),this.createCommand(e,FF.InsertSectionBreakNextPage,Q8),this.createCommand(e,FF.InsertSectionBreakOddPage,e7),this.createCommand(e,FF.InsertShiftTabMark,o7),this.createCommand(e,FF.InsertSpace,t7),this.createCommand(e,FF.InsertTabMark,n7),this.createCommand(e,FF.InsertTabRuler,D3),this.createCommand(e,FF.InsertText,a7),this.createCommand(e,FF.LineDown,y4),this.createCommand(e,FF.LineEnd,v4),this.createCommand(e,FF.LineStart,D4),this.createCommand(e,FF.LineUp,P4),this.createCommand(e,FF.MakeTextLowerCase,F8),this.createCommand(e,FF.MakeTextUpperCase,R8),this.createCommand(e,FF.MoveTabRuler,R3),this.createCommand(e,FF.NextCharacter,L4),this.createCommand(e,FF.NextPage,N4),this.createCommand(e,FF.OpenHyperlink,T2),this.createCommand(e,FF.PasteSelection,U8),this.createCommand(e,FF.PreviousCharacter,K4),this.createCommand(e,FF.PreviousPage,J4),this.createCommand(e,FF.Redo,M3),this.createCommand(e,FF.RemoveHyperlink,v2),this.createCommand(e,FF.RemoveSpacingAfterParagraph,f3),this.createCommand(e,FF.RemoveSpacingBeforeParagraph,b3),this.createCommand(e,FF.RestartNumberingList,Y5),this.createCommand(e,FF.RulerParagraphLeftIndents,u$),this.createCommand(e,FF.RulerParagraphRightIndent,p$),this.createCommand(e,FF.RulerSectionColumnsSettings,L3),this.createCommand(e,FF.RulerSectionMarginLeft,A3),this.createCommand(e,FF.RulerSectionMarginRight,N3),this.createCommand(e,FF.RulerChangeTableColumnWidth,aG),this.createCommand(e,FF.RulerChangeTableRowHeight,oG),this.createCommand(e,FF.RulerTableColumnSeparators,W$),this.createCommand(e,FF.SelectAll,a6),this.createCommand(e,FF.SelectLine,s6),this.createCommand(e,FF.SelectLineNoUpdateControlState,c6),this.createCommand(e,FF.AddSelectedLineCommandNoUpdateControlState,l6),this.createCommand(e,FF.SelectParagraph,u6),this.createCommand(e,FF.SetDoubleParagraphSpacing,P3),this.createCommand(e,FF.SetLandscapePageOrientation,W3),this.createCommand(e,FF.SetModerateSectionPageMargins,$3),this.createCommand(e,FF.SetNarrowSectionPageMargins,q3),this.createCommand(e,FF.SetNormalSectionPageMargins,K3),this.createCommand(e,FF.SetPortraitPageOrientation,z3),this.createCommand(e,FF.SetSectionA4PaperKind,l4),this.createCommand(e,FF.SetSectionA5PaperKind,d4),this.createCommand(e,FF.SetSectionA6PaperKind,c4),this.createCommand(e,FF.SetSectionB5PaperKind,h4),this.createCommand(e,FF.SetSectionExecutivePaperKind,u4),this.createCommand(e,FF.SetSectionFolioPaperKind,s4),this.createCommand(e,FF.SetSectionLegalPaperKind,a4),this.createCommand(e,FF.SetSectionLetterPaperKind,o4),this.createCommand(e,FF.SetSectionOneColumn,e4),this.createCommand(e,FF.SetSectionThreeColumns,r4),this.createCommand(e,FF.SetSectionTwoColumns,t4),this.createCommand(e,FF.SetSesquialteralParagraphSpacing,I3),this.createCommand(e,FF.SetSingleParagraphSpacing,S3),this.createCommand(e,FF.SetWideSectionPageMargins,J3),this.createCommand(e,FF.ShowAllFieldCodes,E2),this.createCommand(e,FF.ShowAllFieldResults,D2),this.createCommand(e,FF.ShowBookmarkForm,p0),this.createCommand(e,FF.ShowColumnsSetupForm,H0),this.createCommand(e,FF.ShowCustomNumberingListForm,K0),this.createCommand(e,FF.ShowEditHyperlinkForm,E1),this.createCommand(e,FF.ShowErrorAuthExceptionMessageCommand,n0),this.createCommand(e,FF.ShowErrorClipboardAccessDeniedMessageCommand,t0),this.createCommand(e,FF.ShowErrorDocVariableErrorCommand,l0),this.createCommand(e,FF.ShowInsertContentFromServerErrorDialogCommand,d0),this.createCommand(e,FF.ShowErrorInnerExceptionMessageCommand,r0),this.createCommand(e,FF.ShowErrorModelIsChangedMessageCommand,YZ),this.createCommand(e,FF.ShowErrorOpeningAndOverstoreImpossibleMessageCommand,ZZ),this.createCommand(e,FF.ShowErrorCantSaveToEmptyPathMessageCommand,e0),this.createCommand(e,FF.ShowErrorOpeningMessageCommand,o0),this.createCommand(e,FF.ShowErrorSavingMessageCommand,a0),this.createCommand(e,FF.ShowErrorPathTooLongCommand,s0),this.createCommand(e,FF.ShowErrorSessionHasExpiredMessageCommand,QZ),this.createCommand(e,FF.ShowErrorInvalidDocumentFormat,i0),this.createCommand(e,FF.ShowFinishAndMergeForm,Z0),this.createCommand(e,FF.ShowFontForm,r1),this.createCommand(e,FF.ShowHyperlinkForm,v1),this.createCommand(e,FF.ShowInsertMergeFieldForm,L1),this.createCommand(e,FF.ShowInsertTableForm,O1),this.createCommand(e,FF.ShowNumberingListForm,z1),this.createCommand(e,FF.ShowPageMarginsSetupForm,O0),this.createCommand(e,FF.ShowPagePaperSetupForm,_0),this.createCommand(e,FF.ShowPageSetupForm,O0),this.createCommand(e,FF.ShowParagraphForm,X1),this.createCommand(e,FF.Find,d2),this.createCommand(e,FF.Replace,J0),this.createCommand(e,FF.ShowServiceFontForm,i1),this.createCommand(e,FF.ShowServiceSymbolsForm,e2),this.createCommand(e,FF.ShowSymbolForm,Z1),this.createCommand(e,FF.ShowTablePropertiesForm,i2),this.createCommand(e,FF.ShowCellOptionsForm,n2),this.createCommand(e,FF.ShowBorderShadingForm,D0),this.createCommand(e,FF.ShowServiceBorderShadingForm,F0),this.createCommand(e,FF.ShowTabsForm,s2),this.createCommand(e,FF.ToggleAllFields,F2),this.createCommand(e,FF.ToggleBackspaceKey,S8),this.createCommand(e,FF.ToggleBulletedListItem,Z5),this.createCommand(e,FF.ToggleDeleteKey,j8),this.createCommand(e,FF.ToggleFieldCodes,R2),this.createCommand(e,FF.ToggleFontDoubleUnderline,jZ),this.createCommand(e,FF.ToggleFontItalic,_Z),this.createCommand(e,FF.ToggleFontStrikeout,VZ),this.createCommand(e,FF.ToggleFontSubscript,UZ),this.createCommand(e,FF.ToggleFontSuperscript,HZ),this.createCommand(e,FF.ToggleFontUnderline,zZ),this.createCommand(e,FF.ToggleMultilevelListItem,e3),this.createCommand(e,FF.ToggleNumberingListItem,Q5),this.createCommand(e,FF.ToggleParagraphAlignmentCenter,x3),this.createCommand(e,FF.ToggleParagraphAlignmentJustify,v3),this.createCommand(e,FF.ToggleParagraphAlignmentLeft,y3),this.createCommand(e,FF.ToggleParagraphAlignmentRight,T3),this.createCommand(e,FF.ToggleShowHorizontalRuler,k3),this.createCommand(e,FF.ToggleShowWhitespace,U5),this.createCommand(e,FF.ToggleTextCase,L8),this.createCommand(e,FF.ToggleViewMergedData,L2),this.createCommand(e,FF.Undo,w7),this.createCommand(e,FF.UpdateAllFields,B2),this.createCommand(e,FF.UpdateField,iq),this.createCommand(e,FF.ToggleFontBold,OZ),this.createCommand(e,FF.InsertNonBreakingSpace,r7),this.createCommand(e,FF.RemoveHyperlinks,M2),this.createCommand(e,FF.CreateDateField,h1),this.createCommand(e,FF.CreatePageField,d1),this.createCommand(e,FF.CreateTimeField,u1),this.createCommand(e,FF.CreateMergeField,p1),this.createCommand(e,FF.ShowCreateHyperlinkForm,M1),this.createCommand(e,FF.SentenceCase,B8),this.createCommand(e,FF.SwitchTextCase,A8),this.createCommand(e,FF.InsertHeader,F5),this.createCommand(e,FF.InsertFooter,R5),this.createCommand(e,FF.LinkHeaderFooterToPrevious,L5),this.createCommand(e,FF.CreateBookmark,TZ),this.createCommand(e,FF.DeleteBookmarks,vZ),this.createCommand(e,FF.GoToBookmark,MZ),this.createCommand(e,FF.ContextItem_HeadersFooters,S5),this.createCommand(e,FF.ClosePageHeaderFooter,C5),this.createCommand(e,FF.GoToPageHeader,x5),this.createCommand(e,FF.GoToPageFooter,T5),this.createCommand(e,FF.GoToNextPageHeaderFooter,M5),this.createCommand(e,FF.GoToPreviousPageHeaderFooter,E5),this.createCommand(e,FF.ToggleDifferentFirstPage,P5),this.createCommand(e,FF.ToggleDifferentOddAndEvenPages,w5),this.createCommand(e,FF.ChangeHeaderOffset,V3),this.createCommand(e,FF.ChangeFooterOffset,U3),this.createCommand(e,FF.InsertPageNumberField,d1),this.createCommand(e,FF.InsertPageCountField,c1),this.createCommand(e,FF.InsertTableCore,p8),this.createCommand(e,FF.ContextItem_Tables,Z6),this.createCommand(e,FF.InsertTableColumnToTheLeft,h8),this.createCommand(e,FF.InsertTableColumnToTheRight,u8),this.createCommand(e,FF.InsertTableRowAbove,m8),this.createCommand(e,FF.InsertTableRowBelow,f8),this.createCommand(e,FF.DeleteTableRows,a8),this.createCommand(e,FF.DeleteTableColumns,i8),this.createCommand(e,FF.InsertTableCellWithShiftToTheLeft,l8),this.createCommand(e,FF.DeleteTableCellsWithShiftToTheHorizontally,t8),this.createCommand(e,FF.DeleteTable,n8),this.createCommand(e,FF.DeleteTableCellsByBackspace,e8),this.createCommand(e,FF.ShowInsertTableCellsForm,A1),this.createCommand(e,FF.ShowDeleteTableCellsForm,N1),this.createCommand(e,FF.MergeTableCells,b8),this.createCommand(e,FF.ShowSplitTableCellsForm,J1),this.createCommand(e,FF.SplitTableCellsCommand,C8),this.createCommand(e,FF.InsertTableCellsWithShiftToTheVertically,d8),this.createCommand(e,FF.DeleteTableCellsWithShiftToTheVertically,r8),this.createCommand(e,FF.TableCellAlignBottomCenter,U6),this.createCommand(e,FF.TableCellAlignBottomLeft,_6),this.createCommand(e,FF.TableCellAlignBottomRight,H6),this.createCommand(e,FF.TableCellAlignMiddleCenter,k6),this.createCommand(e,FF.TableCellAlignMiddleLeft,N6),this.createCommand(e,FF.TableCellAlignMiddleRight,O6),this.createCommand(e,FF.TableCellAlignTopCenter,B6),this.createCommand(e,FF.TableCellAlignTopLeft,L6),this.createCommand(e,FF.TableCellAlignTopRight,A6),this.createCommand(e,FF.ApplyTableStyle,y6),this.createCommand(e,FF.ToggleTableCellAllBorders,w0),this.createCommand(e,FF.ToggleTableCellInsideBorders,x0),this.createCommand(e,FF.ToggleTableCellInsideHorizontalBorders,T0),this.createCommand(e,FF.ToggleTableCellInsideVerticalBorders,v0),this.createCommand(e,FF.ToggleTableCellNoBorder,y0),this.createCommand(e,FF.ToggleTableCellOutsideBorders,M0),this.createCommand(e,FF.ToggleTableCellsBottomBorder,I0),this.createCommand(e,FF.ToggleTableCellsLeftBorder,P0),this.createCommand(e,FF.ToggleTableCellsRightBorder,S0),this.createCommand(e,FF.ToggleTableCellsTopBorder,C0),this.createCommand(e,FF.ToggleFirstRow,G6),this.createCommand(e,FF.ToggleLastRow,K6),this.createCommand(e,FF.ToggleFirstColumn,q6),this.createCommand(e,FF.ToggleLastColumn,$6),this.createCommand(e,FF.ToggleBandedRows,J6),this.createCommand(e,FF.ToggleBandedColumn,Y6),this.createCommand(e,FF.SelectTableCell,mX),this.createCommand(e,FF.SelectTableColumn,bX),this.createCommand(e,FF.SelectTableRow,IX),this.createCommand(e,FF.SelectTable,wX),this.createCommand(e,FF.ChangeTableBorderColorRepositoryItem,E6),this.createCommand(e,FF.ChangeTableBorderStyleRepositoryItem,F6),this.createCommand(e,FF.ChangeTableBorderWidthRepositoryItem,D6),this.createCommand(e,FF.ChangeTableCellShading,V6),this.createCommand(e,FF.ToggleShowTableGridLines,H5),this.createCommand(e,FF.ExtendSelectTableCell,fX),this.createCommand(e,FF.ExtendSelectTableColumn,CX),this.createCommand(e,FF.ExtendSelectTableRow,PX),this.createCommand(e,FF.ExtendSelectTable,yX),this.createCommand(e,FF.SelectTableCellsRange,xX),this.createCommand(e,FF.ChangeActiveSubDocumentToMain,DX),this.createCommand(e,FF.ChangeActiveSubDocumentToHeaderFooterByPageIndex,FX),this.createCommand(e,FF.ChangeActiveSubDocumentToHeaderFooterBySubDocument,LX),this.createCommand(e,FF.ChangeActiveSubDocumentToTextBox,BX),this.createCommand(e,FF.SetSectionPageSize,i4),this.createCommand(e,FF.SetSectionColumnCount,Q3),this.createCommand(e,FF.ChangeTableRowHeight,Q6),this.createCommand(e,FF.ChangeTableCellWidth,W6),this.createCommand(e,FF.ChangeTableColumnWidth,z6),this.createCommand(e,FF.ChangeTableLook,X6),this.createCommand(e,FF.ShowSpellCheckerForm,K1),this.createCommand(e,FF.IgnoreSpellingError,P6),this.createCommand(e,FF.IgnoreAllSpellingErrors,I6),this.createCommand(e,FF.DeleteRepeatedWord,S6),this.createCommand(e,FF.AddWordToDictionary,g6),this.createCommand(e,FF.ChangeSpellingError,b6),this.createCommand(e,FF.NoSpellingSuggestions,C6),this.createCommand(e,FF.ChangeAllSpellingErrors,f6),this.createCommand(e,FF.ShowSpellingCheckCompletedMessage,h0),this.createCommand(e,FF.GoToDataRecord,f2),this.createCommand(e,FF.FindAll,cJ),this.createCommand(e,FF.ReplaceNext,gJ),this.createCommand(e,FF.ReplaceAll,uJ),this.createCommand(e,FF.HideFindResults,N2),this.createCommand(e,FF.RemoveNextWord,d7),this.createCommand(e,FF.RemovePrevWord,l7),this.createCommand(e,FF.GoToStartNextPage,r6),this.createCommand(e,FF.GoToStartPrevPage,i6),this.createCommand(e,FF.ExtendGoToStartNextPage,n6),this.createCommand(e,FF.ExtendGoToStartPrevPage,o6),this.createCommand(e,FF.AssignShortcut,XU),this.createCommand(e,FF.SetSectionPageMargins,X3),this.createCommand(e,FF.ShowLayoutOptionsForm,V1),this.createCommand(e,FF.SetFloatingObjectSquareTextWrapType,h5),this.createCommand(e,FF.SetFloatingObjectTightTextWrapType,u5),this.createCommand(e,FF.SetFloatingObjectThroughTextWrapType,p5),this.createCommand(e,FF.SetFloatingObjectTopAndBottomTextWrapType,g5),this.createCommand(e,FF.SetFloatingObjectBehindTextWrapType,f5),this.createCommand(e,FF.SetFloatingObjectInFrontOfTextWrapType,m5),this.createCommand(e,FF.SetFloatingObjectInlineTextWrapType,b5),this.createCommand(e,FF.SetFloatingObjectTopLeftAlignment,t5),this.createCommand(e,FF.SetFloatingObjectTopCenterAlignment,r5),this.createCommand(e,FF.SetFloatingObjectTopRightAlignment,i5),this.createCommand(e,FF.SetFloatingObjectMiddleLeftAlignment,n5),this.createCommand(e,FF.SetFloatingObjectMiddleCenterAlignment,o5),this.createCommand(e,FF.SetFloatingObjectMiddleRightAlignment,a5),this.createCommand(e,FF.SetFloatingObjectBottomLeftAlignment,s5),this.createCommand(e,FF.SetFloatingObjectBottomCenterAlignment,l5),this.createCommand(e,FF.SetFloatingObjectBottomRightAlignment,d5),this.createCommand(e,FF.ContextItem_FloatingObjects,W2),this.createCommand(e,FF.ChangeFloatingObjectTextWrapTypeMenu,z2),this.createCommand(e,FF.FloatingObjectBringForwardMenu,j2),this.createCommand(e,FF.FloatingObjectSendBackwardMenu,X2),this.createCommand(e,FF.InsertAnchoredTextBox,Z2),this.createCommand(e,FF.FloatingObjectBringForward,K2),this.createCommand(e,FF.FloatingObjectBringToFront,q2),this.createCommand(e,FF.FloatingObjectBringInFrontOfText,Y2),this.createCommand(e,FF.FloatingObjectSendBackward,$2),this.createCommand(e,FF.FloatingObjectSendToBack,J2),this.createCommand(e,FF.FloatingObjectSendBehindText,Q2),this.createCommand(e,FF.ChangeFloatingObjectFillColor,_2),this.createCommand(e,FF.ChangeFloatingObjectOutlineColor,U2),this.createCommand(e,FF.ChangeFloatingObjectOutlineWidth,H2),this.createCommand(e,FF.ChangeFloatingObjectShape,k2),this.createCommand(e,FF.ChangeTextBoxProperties,V2),this.createCommand(e,FF.CreateEmptyMergeField,g1),this.createCommand(e,FF.CreateEmptyDocVariableField,m1),this.createCommand(e,FF.CreateEmptyIfField,f1),this.createCommand(e,FF.FloatingObjectDragDropChangePosition,vG),this.createCommand(e,FF.InsertHtml,W8),this.createCommand(e,FF.CreateTocField,C1),this.createCommand(e,FF.CreateTableOfEquationsField,S1),this.createCommand(e,FF.CreateTableOfFiguresField,I1),this.createCommand(e,FF.CreateTableOfTablesField,P1),this.createCommand(e,FF.CreateEquationCaptionField,w1),this.createCommand(e,FF.CreateFigureCaptionField,y1),this.createCommand(e,FF.CreateTableCaptionField,x1),this.createCommand(e,FF.UpdateTableOfContents,A2),this.createCommand(e,FF.SetParagraphBodyTextLevel,u7),this.createCommand(e,FF.SetParagraphHeading1Level,p7),this.createCommand(e,FF.SetParagraphHeading2Level,g7),this.createCommand(e,FF.SetParagraphHeading3Level,m7),this.createCommand(e,FF.SetParagraphHeading4Level,f7),this.createCommand(e,FF.SetParagraphHeading5Level,b7),this.createCommand(e,FF.SetParagraphHeading6Level,C7),this.createCommand(e,FF.SetParagraphHeading7Level,S7),this.createCommand(e,FF.SetParagraphHeading8Level,I7),this.createCommand(e,FF.SetParagraphHeading9Level,P7),this.createCommand(e,FF.ChangeHeadingLevel,o3),this.createCommand(e,FF.SetParagraphLevel,h7),this.createCommand(e,FF.CreateFieldWithCode,l1),this.createCommand(e,FF.ChangeHyperlink,m2),this.createCommand(e,FF.SetAutoFitContents,T6),this.createCommand(e,FF.SetAutoFitWindow,v6),this.createCommand(e,FF.SetFixedColumnWidth,M6),this.createCommand(e,FF.ChangeViewType,N5),this.createCommand(e,FF.SwitchToSimpleView,O5),this.createCommand(e,FF.SwitchToPrintLayoutView,k5),this.createCommand(e,FF.ShowErrorLoadPictureMessage,c0),this.assingCommand(FF.PrintDocumentOnClient,new h2(e,t))}commandIsEnabled(e){const t=this.publicEnabledState[e];return void 0===t||t}setCommandEnabled(e,t){this.publicEnabledState[e]=t}dispose(){this.formatImagesImporters.forEach((e=>e.dispose())),clearTimeout(this.clipboardTimerId),clearTimeout(this.printTimerId)}abortClipboardCommandExecution(){clearTimeout(this.clipboardTimerId),this.clipboardTimerId=null}getCommand(e){return this.commands[e]}beforeExecuting(e){this.executingCommandsChain.push(e),this.executingCommandCounter++}afterExecuting(){this.executingCommandCounter--,0===this.executingCommandCounter&&(this.lastCommandsChain=this.executingCommandsChain,this.executingCommandsChain=[])}assertLastExecutedCommandsChain(e,...t){if(e&&this.lastCommandsChain.length!==t.length)return!1;for(var r,i=0;r=t[i];i++)if(!(this.lastCommandsChain[i]&&this.lastCommandsChain[i]instanceof r))return!1;return!0}NotifySelectionChanged(e){this.lastCommandsChain=[]}NotifyScrollPositionChanged(){}createCommand(e,t,r){const i=new r(e);i.commandId=t,this.commands[t]=i}assingCommand(e,t){t.commandId=e,this.commands[e]=t}}class x7 extends EU{getState(){var e=new UU(this.isEnabled());return e.visible=this.control.modelManager.richOptions.control.save!==Db.Hidden,e}isEnabledInReadOnlyMode(){return!0}executeCore(e,t){const r=t.param&&void 0!==t.param.documentFormat&&null!==t.param.documentFormat?t.param.documentFormat:Fu.OpenXml;return this.download(this.getFileName(t),r),!0}download(e,t){const r=this.control;if(r.fileDownloaded)return;""===e&&(e=bJ.defaultDocumentName);const{documentExtension:i,documentFormat:n}=this.control.documentInfo,o=e+(!rn.StringUtils.isNullOrEmpty(i)&&n===t?i:QU.convertToString(t));IV(this.control.getExportModelOptions({documentFormat:t}),(e=>GU.FileUtils.startDownloadFileLocal(e,o))),r.fileDownloaded=!0,setTimeout((()=>{r.fileDownloaded=!1}),1)}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.save)}canModify(){return!0}getFileName(e){return this.control.documentInfo.getFileNameForDownload(e.param?e.param.fileName:null)}}class T7 extends x7{executeCore(e,t){return this.download(this.getFileName(t),Fu.OpenXml),!0}}class v7 extends x7{executeCore(e,t){return this.download(this.getFileName(t),Fu.Rtf),!0}}class M7 extends x7{executeCore(e,t){return this.download(this.getFileName(t),Fu.PlainText),!0}}class E7 extends x7{executeCore(e,t){return this.download(this.getFileName(t),Fu.Html),!0}}class D7{constructor(e,t=""){this.documentFormat=e,this.fileName=t}}class F7{constructor(e,t,r){this.documentFormat=e,this.reason=t,this.documentName=r}}class R7 extends EU{getState(){var e=new UU(this.isEnabled());return e.visible=this.control.modelManager.richOptions.control.save!==Db.Hidden,e}DEPRECATEDConvertOptionsParameter(e){return e instanceof F7?e:new F7}executeCore(e,t){const r=this.control.owner,i=t.param,n=this.getExportDocumentFormat(r.core,i),o=(0,S.isDefined)(i.documentName)?i.documentName:this.control.documentInfo.getFileNameForDownload(),a=i.reason?i.reason:"";return SV(this.control.getExportModelOptions({documentFormat:n}),(e=>this.exportCore(r,e,o,n,a))),!0}getExportDocumentFormat(e,t){return void 0!==t.documentFormat&&null!==t.documentFormat?t.documentFormat:this.control.commandManager.isPublicApiCall||void 0===e.saveDocumentFormat||null===e.saveDocumentFormat?e.getExportDocumentFormat():e.saveDocumentFormat}exportCore(e,t,r,i,n){this.base64=t;const o=i;if(e.savingEventIsEmpty()&&!e.exportUrl)console.warn("The Save button does nothing. To learn more, follow https://docs.devexpress.com/AspNetCore/400972/office-inspired-controls/controls/rich-edit/document-management#save-a-document");else{e.raiseSaving(t,r,o,n)||e.sendExportRequest(t,r,o,n)}}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.save)&&!this.control.owner.documentSaved}canModify(){return!0}}class L7 extends EU{getState(){return new UU(this.isEnabled())}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.inlinePictures)&&1===this.control.selection.intervals.length}executeCore(){const e=document.createElement("input");return e.type="file",e.accept=yH.Browser.AndroidMobilePlatform?"image/jpeg,image/png,image/bmp,image/x-ms-bmp":".jpg,.jpeg,.png,.bmp",e.addEventListener("change",(e=>this.onFileChange(e)),!1),e.click(),!0}onFileChange(e){const t=e.target.files[0];if(t){const e=this.control.modelManager.model.cache.imageCache.createUnloadedInfoByFile(t);this.modelManipulator.picture.insertInlinePictureViaHistory(this.selection.intervalsInfo.subDocPosition,this.inputPosition.charPropsBundle,nh.defaultInfo(e),new Mb(!0))}}}class B7 extends EU{getState(){var e=new UU(this.isEnabled());return e.visible=this.control.modelManager.richOptions.control.fields!==Db.Hidden,e}isEnabledInReadOnlyMode(){return!0}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.fields)&&this.control.modelManager.model.mainSubDocument.getDocumentEndPosition()>1&&!!this.getDataSource()}canModify(){return!0}executeCore(e,t){return new bV(this.control.modelManager.modelManipulator,new SH).exportToBlob((e=>{new __(new U_).importFromFile(e,this.control.modelManager.richOptions,((e,r)=>{const i=this.control.getExportModelOptions({documentFormat:t.param.documentFormat,modelManager:this.createModelManager(e)});this.control.commandManager.formatImagesImporters.push(r),r.whenAllPicturesLoaded((e=>{const n=this.control.commandManager.formatImagesImporters.indexOf(r);if(n>=0&&this.control.commandManager.formatImagesImporters.splice(n,1),!e)throw new Error(R.D.InternalException);const o=t.param;this.prepareMergedDocument(i.modelManager,o),IV(i,(e=>o.callback(e)))}),3e3),r.import(i.modelManager.modelManipulator)}),(()=>{}))})),!0}prepareMergedDocument(e,t){const r=e.model.mainSubDocument,i=new mu(r,[new on.FixedInterval(0,r.getDocumentEndPosition()-1)]),n=fb.create(i),o=this.getDataSource(),a=Math.min(t.exportFrom+t.exportRecordsCount,o.totalCount())-1;t.exportFrom>a&&e.modelManipulator.range.removeIntervalWithoutHistory(r,i.intervals[0],!1);let s=0;const l=[];for(let i=t.exportFrom;i<=a;i++){i>t.exportFrom&&n.insertTo(e.modelManipulator,new pu(r,r.getDocumentEndPosition()-1));const d=o.items()[i];this.replaceFieldsInModel(e,d,s,l),i<a&&this.insertSeparator(e,t.mergeMode),s=r.getDocumentEndPosition()-1}}getDataSource(){return this.control.owner.dataSource}replaceFieldsInModel(e,t,r,i){b.j.forEach(e.model.subDocuments,(n=>{f.ListUtils.anyOf(i,(e=>e===n.id))||(this.replaceMergeFieldsInSubDocument(e,t,r,n),this.replaceIfFieldsInSubDocument(e,r,n),n.isMain()||i.push(n.id))}))}processFieldsInSubDocument(e,t,r,i){for(let n=r.fields.length-1;n>=0;n--){const o=r.fields[n];if(r.isMain()&&o.getFieldStartPosition()<t)return;const a=Jg.getParser(e,null,null,r,o);if(a)try{const t=i(a);null!==t&&this.replaceFieldWithText(e,r,o,t)}finally{a.destructor()}}}replaceMergeFieldsInSubDocument(e,t,r,i){this.processFieldsInSubDocument(e,r,i,(e=>{if(e instanceof Vp){const r=e.getMergeFieldName();return an.replaceParagraphEndCharsWithLineBreak(this.getResultByFieldName(t,r))}return null}))}replaceIfFieldsInSubDocument(e,t,r){this.processFieldsInSubDocument(e,t,r,(e=>e instanceof Hg?(e.parseSwitchesAndArgs(),e.getResult()):null))}replaceFieldWithText(e,t,r,i){if(!rn.StringUtils.isNullOrEmpty(i)){const n=r.getFieldStartPosition(),o=t.getRunByPosition(n).getCharPropsBundle(e.model),a=new op(new pu(t,n),o,cs.TextRun,i);e.modelManipulator.text.insertTextInner(a)}e.modelManipulator.range.removeIntervalWithoutHistory(t,r.getAllFieldInterval(),!1)}getResultByFieldName(e,t){const r=Object.keys(e);for(let i,n=0;i=r[n];n++)if(i.toLowerCase()==t.toLowerCase())return e[i]+"";return""}insertSeparator(e,t){const r=e.model.mainSubDocument,i=r.getDocumentEndPosition()-1,n=r.getRunByPosition(0),o=n.characterStyle,a=n.maskedCharacterProperties.clone(),s=new pn(a,o);switch(t){case CZ.NewParagraph:e.modelManipulator.paragraph.insertParagraphViaHistory(new Ag(new pu(r,i),s));break;case CZ.NewSection:e.modelManipulator.section.insertSectionAndSetStartType(i,Vs.NextPage,s)}}createModelManager(e){return new cP(e,this.control.modelManager.richOptions,new Lb.m1)}}class A7{constructor(e,t,r,i,n){this.callback=e,this.mergeMode=t,this.documentFormat=r,this.exportFrom=i||0,this.exportRecordsCount=n||1/0}}class N7{constructor(e,t){this.fontFamilyToFontInfo={},this.fonts=t,this.controlFontsCache=e;const r=this.fonts.map((e=>{const t=e.getFontFamilies()[0];return this.fontFamilyToFontInfo[t]=e,`${t.replace(" ","+")}:regular,bold,italic,bolditalic`})).join("|");this.uri=`https://fonts.googleapis.com/css?family=${r}`}loadControlFonts(e){const t=()=>e([]),r=new XMLHttpRequest;r.onload=i=>{const n=r.response;r.status>=400||!n?t():e(this.parseResponce(n))},r.onerror=()=>t(),r.open("GET",this.uri,!0),r.responseType="text",r.send()}parseResponce(e){const t=[];let r;const i=/@font-face\s*\{([\s\S]*?)\}/gm;for(;r=i.exec(e);){const e=r[1],i=e.match(/font-family:\s*'(\w+\s*\w*)';/);if(i&&i[1]){const r=N7.parseSrc(e.match(/src:\s*(.+);/)),n=e.match(/font-style:\s*(\w+);/),o=e.match(/font-weight:\s*(.+);/),a=e.match(/unicode-range:\s*(.+);/),s=new Sn;n&&n[1]&&(s.style=n[1]),o&&o[1]&&(s.weight=o[1]),a&&a[1]&&(s.unicodeRange=a[1]);const l=this.controlFontsCache.addFont(new Mn(i[1],s));if(r&&f.ListUtils.allOf(l.sourceUrls,(e=>e!=r))){l.sourceUrls.unshift(r);const e=this.fontFamilyToFontInfo[l.fontFamily],i=new pr.Flag;i.set(wn.Bold,l.descriptors.msWordBold()),i.set(wn.Italic,l.descriptors.msWordItalic()),e.controlFontMap[i.getValue()]=l.cacheKey,t.push(l)}}}return t}static parseSrc(e){if(e&&e[1])for(let t of e[1].split(",")){const e=t.match(/url\((.+)\)\s*format\('(\w+)'\)/);if(e)return e[1]}return null}}class k7{constructor(e,t){this.model=e,this.fontsSettings=t}fillCache(){this.makeFontMap(),this.replaceCharProperties(this.model,"defaultCharacterProperties"),this.model.characterStyles.forEach((e=>this.replaceCharProperties(e,"maskedCharacterProperties"))),this.model.paragraphStyles.forEach((e=>this.replaceCharProperties(e,"maskedCharacterProperties"))),this.model.tableStyles.forEach((e=>{this.replaceCharProperties(e.baseConditionalStyle,"maskedCharacterProperties"),b.j.forEach(e.conditionalStyles,(e=>this.replaceCharProperties(e,"maskedCharacterProperties")))})),b.j.forEach(this.model.subDocuments,(e=>this.replaceInModelSubDocument(e)))}makeFontMap(){const e=this.model.cache.fontInfoCache,t=this.fontsSettings;this.fontMap=Object.create(null),e.getAllFonts().forEach((r=>this.fontMap[r.name]=t.getPermittedFont(e,r)))}replaceCharProperties(e,t){const r=e[t];r.fontInfo=r.fontInfo?this.fontMap[r.fontInfo.name]:this.model.defaultCharacterProperties.fontInfo,e[t]=r instanceof Pe?this.model.cache.maskedCharacterPropertiesCache.getItem(r):this.model.cache.mergedCharacterPropertiesCache.getItem(r)}replaceInModelSubDocument(e){e.paragraphs.forEach((e=>e.resetParagraphMergedProperties())),e.chunks.forEach((e=>{e.textRuns.forEach((e=>{this.replaceCharProperties(e,"maskedCharacterProperties"),e.resetCharacterMergedProperties()}))}))}}class O7{get fontInfoCache(){return this.model.cache.fontInfoCache}get controlFontsCache(){return this.model.cache.controlFontsCache}constructor(e,t,r){this.modelManipulator=e,this.model=t,this.fonts=r}correct(){this.addAndLoad(),new k7(this.model,this.fonts).fillCache(),this.removeRedundant(),this.modelManipulator.raiseFontListChanged(this.fontInfoCache)}addAndLoad(){this.fonts.fonts.forEach((e=>{let t=this.fontInfoCache.getItemByName(e.name);t?t.cssString=_n.correctCssString(e.fontFamily):t=this.fontInfoCache.addFont(e.name,e.fontFamily);const r=(r,i)=>{const n=this.controlFontsCache.addFont(new Mn(e.fontFamily,i));n.sourceUrls.unshift(r);const o=new pr.Flag;o.set(wn.Bold,n.descriptors.msWordBold()),o.set(wn.Italic,n.descriptors.msWordItalic()),t.controlFontMap[o.getValue()]=n.cacheKey};e.regularFontUri&&r(e.regularFontUri,Sn.create({})),e.boldFontUri&&r(e.boldFontUri,Sn.create({weight:"bold"})),e.italicFontUri&&r(e.italicFontUri,Sn.create({style:"italic"})),e.boldItalicFontUri&&r(e.boldItalicFontUri,Sn.create({weight:"bold",style:"italic"})),e.googleFontsResponse?new N7(this.controlFontsCache,[t]).parseResponce(e.googleFontsResponse):e.useGoogleFonts&&new N7(this.controlFontsCache,[t]).loadControlFonts((e=>{}))}))}removeRedundant(){if(this.fonts.limitedFonts){const e={};this.fonts.fonts.forEach((t=>e[t.name]=t)),this.fontInfoCache.removeItems((t=>!e[t.name]))}}}class _7 extends EU{getState(){var e=new UU(this.isEnabled());return e.visible=this.control.modelManager.richOptions.control.createNew!==Db.Hidden,e}executeCore(e,t){return!(this.control.getModifiedState()&&!this.control.owner.confirmOnLosingChanges())&&(_7.newDocumentInner.call(this),this.control.owner.raiseDocumentLoaded(),!0)}static newDocumentInner(){var e;this.control.closeDocument(),this.control.loadingPanelManager.loadingPanel.setVisible(!0);const t=new bJ(null===(e=this.control.documentInfo)||void 0===e?void 0:e.fileName,!1);this.control.initialize("",t,1,null);const r=new Mw;new vw(r).setModel(this.control.modelManager.model).fillModel(),new O7(this.control.modelManager.modelManipulator,this.control.modelManager.model,this.control.modelManager.richOptions.fonts).correct(),this.control.selection.beginUpdate();const i=this.control.selection.changeState((e=>e.setPosition(0).resetKeepX().setEndOfLine(!1).setPageIndex(-1).setSubDocument(this.control.modelManager.model.mainSubDocument)));this.control.modelManager.modelManipulator.documentProtectionProperties.filterRangePermissions(),this.control.layoutFormatterManager.openDocument(),this.control.layout.pageColor=this.control.modelManager.model.getActualPageBackgroundColor(),this.control.layoutFormatterManager.forceFormatPage(0),this.control.inputPosition.reset(),this.control.horizontalRulerControl.setEnable(!0),this.control.selection.endUpdate(),i||this.control.selection.raiseSelectionChanged(),this.control.layoutFormatterManager.runFormattingAsync(),this.control.loadingPanelManager.loadingPanel.setVisible(!1),this.control.barHolder.forceUpdate()}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.createNew)}isEnabledInClosedDocument(){return!0}isEnabledInReadOnlyMode(){return!0}}class U7 extends EU{constructor(){super(...arguments),this.suppressUpdateFields=!1}getState(){var e=new UU(this.isEnabled());return e.visible=this.control.modelManager.richOptions.control.open!==Db.Hidden,e}executeCore(e,t){if(this.control.getModifiedState()&&!this.control.owner.confirmOnLosingChanges()||this.control.activeDocumentImporter)return!1;const r=t.param;if(r){const{file:e,documentFormat:t}=U7.getFileAndDocumentFormat(r),i=U7.getDocumentExtensionByFileName(e.name),n=U7.getFileNameWithoutExtension(r.fileName);return this.executeOpening(e,n,t,i,r.callback)}{const e=document.createElement("input");e.type="file",e.accept=yH.Browser.AndroidMobilePlatform?"text/plain,text/rtf,application/rtf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-word.document.macroEnabled.12":".txt,.docx,.rtf,.docm,.html,.htm",e.addEventListener("change",(e=>{const t=e.target.files[0];if(t){const e=U7.getDocumentFormatByFileName(t.name),r=U7.getDocumentExtensionByFileName(t.name),i=U7.getFileNameWithoutExtension(t.name);this.executeOpening(t,i,e,r,null)}}),!1),e.click()}return!0}executeOpening(e,t,r,i,n){const o=this.control;return o.activeDocumentImporter=V_(r,(e=>{throw new Error(R.D.InternalException+" "+e)})),!!o.activeDocumentImporter&&(this.beforeOpen(),o.activeDocumentImporter.importFromFile(e,this.control.modelManager.richOptions,((e,a)=>{o.activeDocumentImporter=null,this.openCore(t,r,e,a,i),this.suppressUpdateFields||this.updateSomeFields(),n&&n(!0,null)}),(e=>{o.activeDocumentImporter=null,this.control.loadingPanelManager.loadingPanel.setVisible(!1),_7.newDocumentInner.call(this),n?n(!1,`Document importer error(${e.toString()})`):this.showErrorDialog()})),!0)}showErrorDialog(){const e=new u0;e.messageTextId=pZ.DocumentImportError,this.control.owner.showDialog("ErrorMessage",e,(()=>{}),(()=>{}),!0)}updateSomeFields(){this.control.beginUpdate(),b.j.forEach(this.control.modelManager.model.subDocuments,(e=>{for(let t of e.fields){const r=Jg.getParser(this.control.modelManager,this.control.layoutFormatterManager,this.control.createFieldRequestManager(),e,t);((r instanceof Wp||r instanceof gg)&&e.isHeaderFooter()||r instanceof Hp&&!t.getHyperlinkInfo())&&r.parseCodeCurrentFieldInternal(null)}})),this.control.endUpdate(),this.control.modelManager.history.clear(),this.control.setModifiedFalse()}beforeOpen(){this.control.closeDocument(),this.control.loadingPanelManager.loadingPanel.setVisible(!0)}openCore(e,t,r,i,n){(new tP).correctChunkSizeAtChunkIndex(r.mainSubDocument,0),new O7(this.control.modelManager.modelManipulator,r,this.control.modelManager.richOptions.fonts).correct();const o=new bJ(e,!0,t,n);this.control.initialize("",o,b.j.mapLength(r.subDocuments),r),function(e,t,r){for(let i of e.model.mainSubDocument.fields){const n=Jg.getParser(e,t,r,e.model.mainSubDocument,i);n&&n.updateInfo()}}(this.control.modelManager,this.control.layoutFormatterManager,this.control.createFieldRequestManager()),i.import(this.control.modelManager.modelManipulator),this.control.modelManager.modelManipulator.documentProtectionProperties.filterRangePermissions(),this.control.selection.beginUpdate();const a=this.control.selection.changeState((e=>e.setPosition(0).resetKeepX().setEndOfLine(!1).setPageIndex(-1).setSubDocument(this.control.modelManager.model.mainSubDocument)));this.control.layoutFormatterManager.openDocument(),this.control.inputPosition.reset(),this.control.layout.pageColor=r.getActualPageBackgroundColor(),this.control.layoutFormatterManager.restartManager.restartFromPage(0,0,!0),this.control.layoutFormatterManager.forceFormatPage(0),this.control.barHolder.setEnabled(!0),this.control.horizontalRulerControl.setEnable(!0),this.control.selection.endUpdate(),a||this.control.selection.raiseSelectionChanged(),this.control.loadingPanelManager.loadingPanel.setVisible(!1),this.control.spellChecker.check(),this.control.layoutFormatterManager.runFormattingAsync(),this.control.barHolder.forceUpdate(),this.control.owner.raiseDocumentLoaded()}isEnabled(){return super.isEnabled()&&Bb.isEnabled(this.control.modelManager.richOptions.control.open)}isEnabledInClosedDocument(){return!0}isEnabledInReadOnlyMode(){return!0}static getFileAndDocumentFormat(e){if((0,S.isString)(e.fileContent)){let t;const r=Lu[lo.Base64Utils.getKnownMimeType(e.fileContent)];t=void 0!==r?r:(0,S.isDefined)(e.documentFormat)?e.documentFormat:U7.getDocumentFormatByFileName(e.fileName);return{file:lo.Base64Utils.getFileFromBase64(lo.Base64Utils.deleteDataUrlPrefix(e.fileContent),"",{type:Bu[t]}),documentFormat:t}}if(GU.FileUtils.isFile(e.fileContent)){let t;if((0,S.isDefined)(e.documentFormat))t=e.documentFormat;else{const r=Lu[e.fileContent.type];void 0!==r?t=r:(t=QU.convertToDocumentFormat(e.fileContent.name),t===Fu.Undefined&&(t=U7.getDocumentFormatByFileName(e.fileName)))}return{file:e.fileContent,documentFormat:t}}if(e.fileContent instanceof Blob){const t=(0,S.isDefined)(e.documentFormat)?e.documentFormat:U7.getDocumentFormatByFileName(e.fileName);return{file:GU.FileUtils.createFile([e.fileContent],e.fileName,{type:Bu[t]}),documentFormat:t}}{const t=(0,S.isDefined)(e.documentFormat)?e.documentFormat:U7.getDocumentFormatByFileName(e.fileName);return{file:GU.FileUtils.createFile([e.fileContent],e.fileName,{type:Bu[t]}),documentFormat:t}}}static getDocumentFormatByFileName(e){const t=QU.convertToDocumentFormat(e);return t===Fu.Undefined?Fu.OpenXml:t}static getDocumentExtensionByFileName(e){return QU.convertToDocumentExtension(e)}static getFileNameWithoutExtension(e){const t=U7.getDocumentExtensionByFileName(e);return t&&rn.StringUtils.endsAt(e,t)?e.slice(0,-t.length):e}}class H7{constructor(e,t,r,i){this.callback=e,this.fileContent=t,this.fileName=r||"",this.documentFormat=i}}class V7 extends y7{constructor(e,t){super(e,t),this.createCommand(e,FF.OpenDocumentLocally,U7),this.createCommand(e,FF.InsertPictureLocally,L7),this.createCommand(e,FF.CreateNewDocumentLocally,_7),this.createCommand(e,FF.ExportDocument,R7),this.createCommand(e,FF.DownloadDocumentLocally,x7),this.createCommand(e,FF.DownloadDocx,T7),this.createCommand(e,FF.DownloadRtf,v7),this.createCommand(e,FF.DownloadTxt,M7),this.createCommand(e,FF.DownloadHtml,E7),this.createCommand(e,FF.MailMergeOnClient,B7)}}class W7{constructor(e,t){this.knownNonCommandShortcuts={},this.control=t,this.init(e)}init(e){this.knownNonCommandShortcuts={},this.knownNonCommandShortcuts[KU.VD.Esc]=!0,this.shortcuts={},this.createShortcut(e,FF.ClearFormatting,[KU.tx.Ctrl|KU.VD.Space],[KU.tx.Ctrl|KU.VD.Space]),this.createShortcut(e,FF.CopySelection,[KU.tx.Ctrl|KU.VD.Key_c],[KU.tx.Meta|KU.VD.Key_c,KU.VD.F3]),this.createShortcut(e,FF.CreateField,[KU.tx.Ctrl|KU.VD.F9],[KU.tx.Meta|KU.VD.F9]),this.createShortcut(e,FF.CutSelection,[KU.tx.Ctrl|KU.VD.Key_x],[KU.tx.Meta|KU.VD.Key_x,KU.VD.F2]),this.createShortcut(e,FF.DecreaseIndent,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Key_m],[KU.tx.Meta|KU.tx.Shift|KU.VD.Key_m]),this.createShortcut(e,FF.DocumentEnd,[KU.tx.Ctrl|KU.VD.End],[KU.tx.Meta|KU.VD.End]),this.createShortcut(e,FF.DocumentStart,[KU.tx.Ctrl|KU.VD.Home],[KU.tx.Meta|KU.VD.Home]),this.createShortcut(e,FF.ExtendDocumentEnd,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.End],[KU.tx.Meta|KU.tx.Shift|KU.VD.End]),this.createShortcut(e,FF.ExtendDocumentStart,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Home],[KU.tx.Meta|KU.tx.Shift|KU.VD.Home]),this.createShortcut(e,FF.ExtendGoToEndParagraph,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Down],[KU.tx.Meta|KU.tx.Shift|KU.VD.Down]),this.createShortcut(e,FF.ExtendGoToNextWord,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Right],[KU.tx.Alt|KU.tx.Shift|KU.VD.Right]),this.createShortcut(e,FF.ExtendGoToPrevWord,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Left],[KU.tx.Alt|KU.tx.Shift|KU.VD.Left]),this.createShortcut(e,FF.ExtendGoToStartParagraph,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Up],[KU.tx.Meta|KU.tx.Shift|KU.VD.Up]),this.createShortcut(e,FF.ExtendLineDown,[KU.tx.Shift|KU.VD.Down],[KU.tx.Shift|KU.VD.Down]),this.createShortcut(e,FF.ExtendLineEnd,[KU.tx.Shift|KU.VD.End],[KU.tx.Shift|KU.VD.End]),this.createShortcut(e,FF.ExtendLineStart,[KU.tx.Shift|KU.VD.Home],[KU.tx.Shift|KU.VD.Home]),this.createShortcut(e,FF.ExtendLineUp,[KU.tx.Shift|KU.VD.Up],[KU.tx.Shift|KU.VD.Up]),this.createShortcut(e,FF.ExtendNextCharacter,[KU.tx.Shift|KU.VD.Right],[KU.tx.Shift|KU.VD.Right]),this.createShortcut(e,FF.ExtendNextPage,[KU.tx.Shift|KU.VD.PageDown],[KU.tx.Shift|KU.VD.PageDown]),this.createShortcut(e,FF.ExtendPreviousCharacter,[KU.tx.Shift|KU.VD.Left],[KU.tx.Shift|KU.VD.Left]),this.createShortcut(e,FF.ExtendPreviousPage,[KU.tx.Shift|KU.VD.PageUp],[KU.tx.Shift|KU.VD.PageUp]),this.createShortcut(e,FF.FullScreen,[KU.VD.F11,KU.tx.Ctrl|KU.VD.F10],[KU.VD.F11]),this.createShortcut(e,FF.GoToEndParagraph,[KU.tx.Ctrl|KU.VD.Down],[KU.tx.Meta|KU.VD.Down]),this.createShortcut(e,FF.GoToNextWord,[KU.tx.Ctrl|KU.VD.Right],[KU.tx.Meta|KU.VD.Right]),this.createShortcut(e,FF.GoToPrevWord,[KU.tx.Ctrl|KU.VD.Left],[KU.tx.Meta|KU.VD.Left]),this.createShortcut(e,FF.GoToStartParagraph,[KU.tx.Ctrl|KU.VD.Up],[KU.tx.Meta|KU.VD.Up]),this.createShortcut(e,FF.IncreaseIndent,[KU.tx.Ctrl|KU.VD.Key_m],[KU.tx.Meta|KU.VD.Key_m]),this.createShortcut(e,FF.InsertColumnBreak,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Enter],[KU.tx.Meta|KU.tx.Shift|KU.VD.Enter]),this.createShortcut(e,FF.InsertLineBreak,[KU.tx.Shift|KU.VD.Enter],[KU.tx.Shift|KU.VD.Enter]),this.createShortcut(e,FF.InsertPageBreak,[KU.tx.Ctrl|KU.VD.Enter],[KU.tx.Meta|KU.VD.Enter]),this.createShortcut(e,FF.InsertParagraph,[KU.VD.Enter],[KU.VD.Enter]),this.createShortcut(e,FF.InsertShiftTabMark,[KU.tx.Shift|KU.VD.Tab],[KU.tx.Shift|KU.VD.Tab]),this.createShortcut(e,FF.InsertSpace,[KU.VD.Space],[KU.VD.Space,KU.tx.Shift|KU.VD.Space]),this.createShortcut(e,FF.InsertTabMark,[KU.VD.Tab],[KU.VD.Tab]),this.createShortcut(e,FF.LineDown,[KU.VD.Down],[KU.VD.Down]),this.createShortcut(e,FF.LineEnd,[KU.VD.End],[KU.VD.End]),this.createShortcut(e,FF.LineStart,[KU.VD.Home],[KU.VD.Home]),this.createShortcut(e,FF.LineUp,[KU.VD.Up],[KU.VD.Up]),this.createShortcut(e,FF.NextCharacter,[KU.VD.Right],[KU.VD.Right]),this.createShortcut(e,FF.NextPage,[KU.VD.PageDown],[KU.VD.PageDown]),this.createShortcut(e,FF.PasteSelection,[KU.tx.Ctrl|KU.VD.Key_v,KU.tx.Shift|KU.VD.Insert],[KU.tx.Meta|KU.VD.Key_v,KU.VD.F4]),this.createShortcut(e,FF.PreviousCharacter,[KU.VD.Left],[KU.VD.Left]),this.createShortcut(e,FF.PreviousPage,[KU.VD.PageUp],[KU.VD.PageUp]),this.createShortcut(e,FF.Redo,[KU.tx.Ctrl|KU.VD.Key_y],[KU.tx.Meta|KU.VD.Key_y]),this.createShortcut(e,FF.SelectAll,[KU.tx.Ctrl|KU.VD.Key_a],[KU.tx.Meta|KU.VD.Key_a]),this.createShortcut(e,FF.SetDoubleParagraphSpacing,[KU.tx.Ctrl|KU.VD.Key_2],[KU.tx.Meta|KU.VD.Key_2]),this.createShortcut(e,FF.SetSesquialteralParagraphSpacing,[KU.tx.Ctrl|KU.VD.Key_5],[KU.tx.Meta|KU.VD.Key_5]),this.createShortcut(e,FF.SetSingleParagraphSpacing,[KU.tx.Ctrl|KU.VD.Key_1],[KU.tx.Meta|KU.VD.Key_1]),this.createShortcut(e,FF.ShowFontForm,[KU.tx.Ctrl|KU.VD.Key_d],[KU.tx.Meta|KU.VD.Key_d]),this.createShortcut(e,FF.ShowHyperlinkForm,[KU.tx.Ctrl|KU.VD.Key_k],[KU.tx.Meta|KU.VD.Key_k]),this.createShortcut(e,FF.Find,[KU.tx.Ctrl|KU.VD.Key_f],[KU.tx.Meta|KU.VD.Key_f]),this.createShortcut(e,FF.Replace,[KU.tx.Ctrl|KU.VD.Key_h],[KU.tx.Meta|KU.VD.Key_h]),this.createShortcut(e,FF.ToggleAllFields,[KU.tx.Alt|KU.VD.F9],[KU.tx.Alt|KU.VD.F9]),this.createShortcut(e,FF.ToggleBackspaceKey,[KU.VD.Backspace],[KU.VD.Backspace]),this.createShortcut(e,FF.ToggleDeleteKey,[KU.VD.Delete],[KU.VD.Delete]),this.createShortcut(e,FF.ToggleFieldCodes,[KU.tx.Shift|KU.VD.F9],[KU.tx.Shift|KU.VD.F9]),this.createShortcut(e,FF.ToggleFontItalic,[KU.tx.Ctrl|KU.VD.Key_i],[KU.tx.Meta|KU.VD.Key_i]),this.createShortcut(e,FF.ToggleFontSubscript,[KU.tx.Ctrl|KU.VD.Equals],[KU.tx.Meta|KU.VD.Equals]),this.createShortcut(e,FF.ToggleFontSuperscript,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Equals],[KU.tx.Meta|KU.tx.Shift|KU.VD.Equals]),this.createShortcut(e,FF.ToggleFontUnderline,[KU.tx.Ctrl|KU.VD.Key_u],[KU.tx.Meta|KU.VD.Key_u]),this.createShortcut(e,FF.ToggleParagraphAlignmentCenter,[KU.tx.Ctrl|KU.VD.Key_e],[KU.tx.Meta|KU.VD.Key_e]),this.createShortcut(e,FF.ToggleParagraphAlignmentJustify,[KU.tx.Ctrl|KU.VD.Key_j],[KU.tx.Meta|KU.VD.Key_j]),this.createShortcut(e,FF.ToggleParagraphAlignmentLeft,[KU.tx.Ctrl|KU.VD.Key_l],[KU.tx.Meta|KU.VD.Key_l]),this.createShortcut(e,FF.ToggleParagraphAlignmentRight,[KU.tx.Ctrl|KU.VD.Key_r],[KU.tx.Meta|KU.VD.Key_r]),this.createShortcut(e,FF.ToggleShowWhitespace,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Key_8],[KU.tx.Meta|KU.VD.Key_8]),this.createShortcut(e,FF.Undo,[KU.tx.Ctrl|KU.VD.Key_z],[KU.tx.Meta|KU.VD.Key_z,KU.VD.F1]),this.createShortcut(e,FF.UpdateField,[KU.VD.F9],[KU.VD.F9]),this.createShortcut(e,FF.ToggleFontBold,[KU.tx.Ctrl|KU.VD.Key_b],[KU.tx.Meta|KU.VD.Key_b]),this.createShortcut(e,FF.InsertNonBreakingSpace,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Space],[KU.tx.Alt|KU.tx.Shift|KU.VD.Space]),this.createShortcut(e,FF.RemoveHyperlinks,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.F9],[KU.tx.Meta|KU.tx.Shift|KU.VD.F9]),this.createShortcut(e,FF.CreateDateField,[KU.tx.Alt|KU.tx.Shift|KU.VD.Key_d],[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Key_d]),this.createShortcut(e,FF.CreatePageField,[KU.tx.Alt|KU.tx.Shift|KU.VD.Key_p],[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Key_p]),this.createShortcut(e,FF.CreateTimeField,[KU.tx.Alt|KU.tx.Shift|KU.VD.Key_t],[KU.tx.Ctrl|KU.tx.Shift|KU.VD.Key_t]),this.createShortcut(e,FF.SwitchTextCase,[KU.tx.Shift|KU.VD.F3],[KU.tx.Shift|KU.VD.F3]),this.createShortcut(e,FF.ShowSpellCheckerForm,[KU.VD.F7],[KU.VD.F7]),this.createShortcut(e,FF.RemoveNextWord,[KU.tx.Ctrl|KU.VD.Delete],[KU.tx.Ctrl|KU.VD.Delete]),this.createShortcut(e,FF.RemovePrevWord,[KU.tx.Ctrl|KU.VD.Backspace],[KU.tx.Ctrl|KU.VD.Backspace]),this.createShortcut(e,FF.GoToStartNextPage,[KU.tx.Ctrl|KU.VD.PageDown],[KU.tx.Ctrl|KU.VD.PageDown]),this.createShortcut(e,FF.GoToStartPrevPage,[KU.tx.Ctrl|KU.VD.PageUp],[KU.tx.Ctrl|KU.VD.PageUp]),this.createShortcut(e,FF.ExtendGoToStartNextPage,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.PageDown],[KU.tx.Ctrl|KU.tx.Shift|KU.VD.PageDown]),this.createShortcut(e,FF.ExtendGoToStartPrevPage,[KU.tx.Ctrl|KU.tx.Shift|KU.VD.PageUp],[KU.tx.Ctrl|KU.tx.Shift|KU.VD.PageUp])}createShortcut(e,t,r,i){f.ListUtils.forEach(yH.Browser.MacOSPlatform?i||[]:r||[],(r=>this.shortcuts[r]=new j7(e.getCommand(t))))}processShortcut(e){const t=this.shortcuts[e];return!(!t||this.denyThisTabKeyCode(e))&&(t.executeCommand(this),!0)}isKnownShortcut(e){return(!!this.shortcuts[e]||this.knownNonCommandShortcuts[e])&&!this.denyThisTabKeyCode(e)}isClipboardCommandShortcut(e){const t=this.shortcuts[e];return!!t&&t.isClipboardCommand()}assignShortcut(e,t){this.shortcuts[e]=new X7(t)}denyThisTabKeyCode(e){return!this.control.modelManager.richOptions.control.acceptsTab&&W7.pressTabKeyCode(e)}static pressTabKeyCode(e){return e===KU.VD.Tab||e===(KU.tx.Shift|KU.VD.Tab)}}class z7{executeCommand(e){e.lastCommandExecutedByShortcut=!0,this.callExecuteCommand(),e.lastCommandExecutedByShortcut=!1}callExecuteCommand(){throw new Error(R.D.NotImplemented)}isClipboardCommand(){throw new Error(R.D.NotImplemented)}}class j7 extends z7{constructor(e){super(),this.command=e}callExecuteCommand(){this.command.execute(!1)}isClipboardCommand(){return this.command instanceof k8}}class X7 extends z7{constructor(e){super(),this.userCommandCallback=e}callExecuteCommand(){this.userCommandCallback()}isClipboardCommand(){return!1}}class G7 extends W7{constructor(e,t){super(e,t),this.createShortcut(e,FF.CreateNewDocumentLocally,[KU.tx.Ctrl|KU.VD.Key_n],[KU.tx.Meta|KU.VD.Key_n]),this.createShortcut(e,FF.OpenDocumentLocally,[KU.tx.Ctrl|KU.VD.Key_o,KU.tx.Ctrl|KU.VD.F12],[KU.tx.Meta|KU.VD.Key_o]),this.createShortcut(e,FF.ExportDocument,[KU.tx.Ctrl|KU.VD.Key_s],[KU.tx.Meta|KU.VD.Key_s]),this.createShortcut(e,FF.PrintDocumentOnClient,[KU.tx.Ctrl|KU.VD.Key_p],[KU.tx.Meta|KU.VD.Key_p])}}class K7{dispose(){this.loadingPanel.dispose(),this.statusBarLoadingPanel.dispose()}}var q7=__webpack_require__(6218);class $7 extends q7.R{constructor(e,t){super(e),this.hidePanelAction=t}hidePanel(){this.stop(),this.hidePanelAction()}}class J7{constructor(){this.enabled=!0}showPanelDelayed(e){const t=new $7((()=>this.setVisible(!0)),(()=>this.setVisible(!1)));return t.start(e),t}dispose(){this.customPanel&&this.customPanel.dispose&&this.customPanel.dispose(),this.loadingPanel.dispose()}setVisible(e){this.customPanel?this.setPanelVisible(this.customPanel,e):this.setPanelVisible(this.loadingPanel,e)}setPanelVisible(e,t){const r=e.visible;t?!this.enabled||!1!==r&&void 0!==r||e.show():!0!==r&&void 0!==r||e.hide()}}class Y7{constructor(e){this.visible=!1,this.canvas=e}dispose(){this.canvas=null,fn.DomUtils.hideNode(this.panelElem),this.panelElem=null}show(){this.getLoadingPanel().style.display="block",this.visible=!0}hide(){this.getLoadingPanel().style.display="none",this.visible=!1}getLoadingPanel(){if(!this.panelElem){this.panelElem=document.createElement("div"),this.panelElem.className="dxreLoadingPanel";const e=document.createElement("div");e.className="lp",this.panelElem.appendChild(e),this.canvas.appendChild(this.panelElem)}return this.panelElem}}class Q7 extends J7{constructor(e){super(),this.loadingPanel=new Y7(e)}}class Z7{constructor(){this.visible=!1}dispose(){}show(){}hide(){}}class e9 extends J7{constructor(){super(...arguments),this.loadingPanel=new Z7}}class t9 extends K7{constructor(e){super(),this.loadingPanel=new Q7(e),this.statusBarLoadingPanel=new e9}}class r9{constructor(e,t,r,i){this.dataSource=e,this.useAsyncVersion=t,this.raiseCalculateDocumentVariable=r,this.raiseCalculateDocumentVariableAnync=i}}class i9 extends Fp{constructor(e){super(),this.lastActiveRecord=-1,this.options=e}forceSendDelayedRequests(){}sendRequest(e,t,r){this.activeRecord=t,this.options.useAsyncVersion()?this.asyncUpdate(e):this.syncUpdate(e)}asyncUpdate(e){const t=new Eu,r=[];let i=0;b.j.forEach(this.getSubDocumentData(e),((n,o)=>{switch(n.serverUpdateFieldType){case Uu.DocVariable:{const a=n,s=new JU(((n,s)=>{void 0===t.getByKey(o)&&(i++,t.add(o,this.getDocumentVariableUpdateResult(e.documentModel,a.fieldName,n,s)),i==r.length&&e.fieldsWaitingForUpdate.update(t.get()))}),Tb(a.fieldInterval),a.fieldName,a.parameters.map((e=>e.text)));r.push(s);break}case Uu.MergeField:{const e=n,r=this.getRecordValue(e.fieldName);t.add(o,{[Qs.SimpleText]:String(r)});break}}})),r.length?setTimeout((()=>{const e=new YU(r);this.options.raiseCalculateDocumentVariableAnync(e)}),0):e.fieldsWaitingForUpdate.update(t.get())}syncUpdate(e){const t=new Eu;b.j.forEach(this.getSubDocumentData(e),((r,i)=>{switch(r.serverUpdateFieldType){case Uu.DocVariable:{const n=r,o=new $U(Tb(n.fieldInterval),n.fieldName,n.parameters.map((e=>e.text)));this.options.raiseCalculateDocumentVariable(o),t.add(i,this.getDocumentVariableUpdateResult(e.documentModel,o.variableName,o.value,o.keepLastParagraph));break}case Uu.MergeField:{const e=r,n=this.getRecordValue(e.fieldName);t.add(i,{[Qs.SimpleText]:String(n)});break}}})),e.fieldsWaitingForUpdate.update(t.get())}getDocumentVariableUpdateResult(e,t,r,i){const n=e.docVariables;if(!(0,S.isDefined)(r)&&n.contains(t)&&(r=n.getValue(t)),r instanceof CH){const e=r._processor,t=new fb(e.modelManager.model,!i,null,null,e.modelManager.modelManipulator.picture.loader.sizeUpdater);return{[Qs.DocumentModel]:t}}return{[Qs.SimpleText]:r}}getRecordValue(e){const t=this.getRecord(),r=Object.keys(t);for(let i,n=0;i=r[n];n++)if(i.toLowerCase()==e.toLowerCase())return"object"==typeof t[i]?t[i]instanceof Date?t[i]:JSON.stringify(t[i],((e,t)=>e&&"object"==typeof t?t.toString():t),1).replace(/^ +/gm," ").replace(/\n/g,"").replace(/{ /g,"{").replace(/ }/g,"}").replace(/\[ /g,"[").replace(/ \]/g,"]"):String(t[i]);return""}getRecord(){return this.lastActiveRecord!=this.activeRecord&&(this.currentRecord=this.options.dataSource.items()[this.activeRecord],this.lastActiveRecord=this.activeRecord),this.currentRecord?this.currentRecord:{}}}class n9{constructor(e){this.controlOwner=e}NotifyFontAdded(e){this.changeRibbonFontList((t=>(t.push({text:e.name,value:e.name}),t.sort(((e,t)=>Qe.Comparers.string(e.text,t.text))),t)))}NotifyFontRemoved(e){this.changeRibbonFontList((t=>t.filter((t=>t.text!=e.name)).sort()))}NotifyFontListChanged(e){const t=e.getFontNames(!0).map((e=>({text:e,value:e})));this.changeRibbonFontList((e=>t))}changeRibbonFontList(e){const t=this.controlOwner.barHolder.ribbon;if(t){const r=t.ribbon.getItems(FF.ChangeFontName);if(r){const t=r[0].widget,i=e(t.option("dataSource"));t.option("dataSource",i)}}}}class o9{constructor(e,t){this.position=e,this.text=t}}class a9{constructor(){this.words=[]}}class s9{constructor(e){this.sentences=[],this.charIndex=0,this.currSentence=null,this.currWord=null,this.text=e}build(){for(;this.charIndex<this.text.length;this.charIndex++){switch(this.currChar=this.text[this.charIndex],this.currChar){case"?":case".":case";":case"!":case an.specialCharacters.SectionMark:case an.specialCharacters.ParagraphMark:this.currSentence?this.finishSentence():"!"==this.prevChar&&"?"==this.currChar||'"'==this.prevChar||"`"==this.prevChar||"?"==this.prevChar&&"?"==this.currChar||("!"==this.prevChar||"?"==this.prevChar||"."==this.prevChar||";"==this.prevChar)&&(this.currChar==an.specialCharacters.ParagraphMark||this.currChar==an.specialCharacters.SectionMark)||(this.addSentence(),this.finishSentence());break;case an.specialCharacters.LeftDoubleQuote:case an.specialCharacters.RightDoubleQuote:case an.specialCharacters.EmSpace:case an.specialCharacters.Space:case an.specialCharacters.TabMark:case an.specialCharacters.EmDash:case an.specialCharacters.EnDash:case an.specialCharacters.LineBreak:case an.specialCharacters.PageBreak:case an.specialCharacters.ColumnBreak:case an.specialCharacters.NonBreakingSpace:case an.specialCharacters.ObjectMark:case an.specialCharacters.Dot:case an.specialCharacters.TrademarkSymbol:case an.specialCharacters.CopyrightSymbol:case an.specialCharacters.RegisteredTrademarkSymbol:case an.specialCharacters.Ellipsis:case String.fromCharCode(160):case",":case"#":case"$":case"%":case"^":case"&":case"*":case"(":case")":case"=":case"+":case"[":case"]":case"{":case"}":case"\\":case"|":case":":case'"':case"<":case">":case"/":case"~":this.finishWord();break;default:this.addNewWordPart()}this.prevChar=this.currChar}return this.postprocessing(),this.sentences}finishSentence(){this.finishWord(),this.currSentence=null}finishWord(){this.currWord=null}addSentence(){this.currSentence=new a9,this.sentences.push(this.currSentence),this.currWord=null}addWord(){this.currSentence||this.addSentence(),this.currWord=new o9(this.charIndex,""),this.currSentence.words.push(this.currWord)}addNewWordPart(){this.currWord||this.addWord(),this.currWord.text+=this.currChar}postprocessing(){const e=[an.specialCharacters.LeftSingleQuote,an.specialCharacters.RightSingleQuote,"'"];for(let t,r=0;t=this.sentences[r];){for(let r,i=0;r=t.words[i];){const n=rn.StringUtils.trimStart(r.text,e);r.position-=r.text.length-n.length;const o=rn.StringUtils.trimEnd(n,e);o.length?(r.text=o,i++):t.words.splice(i,1)}t.words.length?r++:this.sentences.splice(r,1)}}}class l9 extends Yh{sendCheckSpellingRequest(e){if(this.settings.checkWordSpelling){const t=[];for(let r of e)this.checkIntervalByWord(r,t);setTimeout((()=>{for(let e of t)e()}),0)}}checkIntervalByWord(e,t){const r=on.FixedInterval.makeByConstInterval(e),i=new s9(e.info.textToCheck).build();let n=0;const o=[],a=()=>{if(0==n){const e=[{[Q.StartPosition]:r.start,[Q.EndPosition]:r.end,[Q.SpellingErrors]:o}];this.processResponse(e)}};for(let e of i)for(let r of e.words)r=this.preprocessWord(r),/\d/.test(r.text)||(n++,t.push((()=>{this.settings.checkWordSpelling(r.text,((e,t)=>{e||(t||(t=[]),o.push({[Q.ErrorStart]:r.position,[Q.ErrorLength]:r.text.length,[Q.ErrorWord]:r.text,[Q.ErrorType]:Wc.Misspelling,[Q.Suggestions]:t.slice(0,this.settings.suggestionCount)})),n--,a()}))})));0==n&&t.push((()=>a()))}preprocessWord(e){return e.text[0]==an.specialCharacters.LeftSingleQuote&&e.text[e.text.length-1]==an.specialCharacters.RightSingleQuote?new o9(e.position+1,e.text.substr(1,e.text.length-2)):e}sendAddWordRequest(e){this.settings.addWordToDictionary&&this.settings.addWordToDictionary(e)}}class d9 extends fJ{beforeInitialization(e){this._nonce=e.nonce}registerActiveContextTabManager(){this.selection.onChanged.add(this.owner.activeContextTabManager)}createCommandManager(){return new V7(this,this._nonce)}createShortcutManager(){return new G7(this.commandManager,this)}createFieldRequestManager(){const e=this.owner,t=new r9(e.dataSource,e.useAsyncVersionOfCalculateDocvariable.bind(e),(t=>e.raiseCalculateDocumentVariable(t)),(t=>e.raiseCalculateDocumentVariableAsync(t)));return new i9(t)}createLoadingPanelManager(){return new t9(this.viewManager.canvas)}registerFontChangesListeners(){this.modelManager.modelManipulator.onFontsChanged.add(new n9(this.owner))}isClientMode(){return!0}createModelManager(e){return new cP(null,e,this)}dispose(){super.dispose()}createViewElement(e,t){const r=super.createViewElement(e,t);return(0,yZ.on)(r,"dxmousewheel",(e=>e.stopPropagation())),r}createSpellChecker(){this.spellChecker=new l9(this.selection,this.modelManager.richOptions.spellChecker)}}var c9=DevExpress.data.DataSource,h9=__webpack_require__.n(c9);class u9{static getDxDataSource(e){return e instanceof h9()?e:new(h9())(e)}}class p9{static getLocalizatedString(e,t=""){return Tg.EncodeUtils.decodeHtml((0,OV.formatMessage)(e,t)).replace(/<br [/]>/g,"\n")}static getAlertText(e){return this.alertTexts||(this.alertTexts={},this.alertTexts[pZ.ModelIsChanged]=this.getLocalizatedString("ASPxRichEditStringId.ModelIsChangedError"),this.alertTexts[pZ.SessionHasExpired]=this.getLocalizatedString("ASPxRichEditStringId.SessionHasExpiredError"),this.alertTexts[pZ.OpeningAndOverstoreImpossible]=this.getLocalizatedString("ASPxRichEditStringId.OpeningAndOverstoreImpossibleError"),this.alertTexts[pZ.ClipboardAccessDenied]=this.getLocalizatedString("ASPxRichEditStringId.ClipboardAccessDeniedError",yH.Browser.MacOSPlatform?"Command":"Ctrl"),this.alertTexts[pZ.InnerException]=this.getLocalizatedString("ASPxRichEditStringId.InnerExceptionsError"),this.alertTexts[pZ.AuthException]=this.getLocalizatedString("ASPxRichEditStringId.AuthExceptionsError"),this.alertTexts[pZ.CantOpenFile]=this.getLocalizatedString("ASPxRichEditStringId.CantOpenDocumentError"),this.alertTexts[pZ.CantSaveFile]=this.getLocalizatedString("ASPxRichEditStringId.CantSaveDocumentError"),this.alertTexts[pZ.DocVariableException]=this.getLocalizatedString("ASPxRichEditStringId.DocVariableExceptionError"),this.alertTexts[pZ.PathTooLongException]="",this.alertTexts[pZ.InvalidDocumentFormat]=this.getLocalizatedString("ASPxRichEditStringId.InvalidDocumentFormatError"),this.alertTexts[pZ.SpellingCheckCompleted]=this.getLocalizatedString("ASPxRichEditStringId.SpellingCheckCompletedInformation"),this.alertTexts[pZ.ClipboardAccessDeniedTouch]=this.getLocalizatedString("ASPxRichEditStringId.ClipboardAccessDeniedErrorTouch"),this.alertTexts[pZ.CantSaveToEmptyPath]=this.getLocalizatedString("ASPxRichEditStringId.CantSaveToEmptyPathError"),this.alertTexts[pZ.InsertContentFromServerException]=this.getLocalizatedString("ASPxRichEditStringId.InsertContentFromServerExceptionError"),this.alertTexts[pZ.DocumentImportError]=this.getLocalizatedString("ASPxRichEditStringId.InvalidDocumentFormatError")),this.alertTexts[e]}}var g9=DevExpress.ui.dxForm,m9=__webpack_require__.n(g9),f9=DevExpress.ui.dxPopup,b9=__webpack_require__.n(f9);class C9{get showCloseButton(){}constructor(e,t){this.element=e,this.richedit=t}dispose(){}show(e,t,r,i){this.parameters=e,this.callback=t,this.afterClosing=r,this.element.className="",this.element.innerHTML="";const n={title:this.getTitle(),shading:!0,maxHeight:"100%",maxWidth:this.getMaxWidth(),contentTemplate:()=>{const e=document.createElement("div");return this.form=new(m9())(e,Object.assign(Object.assign({},this.getFormOptionsCore()),this.getFormOptions())),e},toolbarItems:this.getToolbarItems(),height:"auto",shadingColor:"rgba(0,0,0,0)",showCloseButton:this.showCloseButton,onHidden:()=>{this.richedit.focusManager.captureFocus()}};this.popupDialog=new(b9())(this.element,n),this.popupDialog.show(),this.afterShowing()}getToolbarItems(){return[this.getOkToolbarItem(),this.getCancelToolbarItem()]}getOkToolbarItem(){return{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.OkButton"),onClick:()=>{this.applyParameters(),this.popupDialog.hide(),this.afterClosing()}}}}getCancelToolbarItem(){return{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.CancelButton"),onClick:()=>{this.popupDialog.hide(),this.afterClosing()}}}}applyParameters(){const e=this.form.option("formData");this.updateParameters(this.parameters,e),this.callback(this.parameters)}afterShowing(){}getMaxWidth(){return 500}getFormOptionsCore(){return{scrollingEnabled:!0}}}class S9 extends C9{getMaxWidth(){return 500}getFormOptions(){return{labelLocation:"top",colCount:1,items:[{dataField:"text",editorType:"dxTextArea",label:{visible:!1},editorOptions:{value:p9.getAlertText(this.parameters.messageTextId),height:80,readOnly:!0}}]}}getToolbarItems(){return[this.getOkToolbarItem()]}updateParameters(e,t){}}class I9 extends S9{getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.ErrorTitle")}}class P9 extends S9{getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.InformationTitle")}}class w9 extends S9{getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.WarningTitle")}}var y9=DevExpress.ui.dxButton,x9=__webpack_require__.n(y9),T9=DevExpress.ui.dxList,v9=__webpack_require__.n(T9),M9=DevExpress.ui.dxRadioGroup,E9=__webpack_require__.n(M9),D9=DevExpress.ui.dxTextBox,F9=__webpack_require__.n(D9);class R9 extends C9{constructor(){super(...arguments),this.bookmarks=[]}getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.BookmarkTitle")}getMaxWidth(){return 400}getFormOptions(){return this.parameters.newBookmarkName="",this.parameters.bookmarks.forEach((e=>{this.bookmarks.push(new L9(e))})),{labelLocation:"top",colCount:3,items:[{colSpan:3,label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Bookmarks_BookmarkName"),location:"top"},template:()=>{const e=document.createElement("div"),t={onValueChanged:()=>{this.onBookmarkNameTextBoxValueChanged()},onInput:()=>{this.onBookmarkNameTextBoxValueChanged()}};return this.bookmarkTextBox=new(F9())(e,t),e}},{colSpan:3,template:()=>{const e=document.createElement("div");return this.bookmarksList=new(v9())(e,{height:200,noDataText:(0,OV.formatMessage)("ASPxRichEditStringId.Bookmarks_NoBookmarks"),selectionMode:"single",onSelectionChanged:()=>{this.onListValueChanged()}}),e}},{colSpan:3,label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Bookmarks_SortBy"),location:"top"},template:()=>{const e=document.createElement("div");return this.sortGroup=new(E9())(e,{items:[(0,OV.formatMessage)("ASPxRichEditStringId.Bookmarks_Name"),(0,OV.formatMessage)("ASPxRichEditStringId.Bookmarks_Location")],value:"Name",layout:"horizontal",onValueChanged:()=>{this.updateDataSource()}}),e}},{template:()=>{const e=document.createElement("div");return this.addBtn=new(x9())(e,{text:(0,OV.formatMessage)("ASPxRichEditStringId.Bookmarks_Add"),width:"100%",onClick:()=>{this.parameters.newBookmarkName=this.bookmarkTextBox.option("text"),this.applyParameters(),this.popupDialog.hide(),this.afterClosing()}}),e}},{template:()=>{const e=document.createElement("div");return this.deleteBtn=new(x9())(e,{text:(0,OV.formatMessage)("ASPxRichEditStringId.Bookmarks_Delete"),width:"100%",onClick:()=>{this.onBtnDeleteClick()}}),e}},{template:()=>{const e=document.createElement("div");return this.goToBtn=new(x9())(e,{text:(0,OV.formatMessage)("ASPxRichEditStringId.Bookmarks_GoTo"),width:"100%",onClick:()=>{this.onBtnGoToClick()}}),e}}]}}afterShowing(){this.updateDataSource()}updateDataSource(){const e=this.getDataSource();if(this.bookmarksList.option("dataSource",e),e.length>0){const t=this.parameters.selectedBookmarkName;this.bookmarksList.selectItem(t?e.indexOf(t):e.length-1)}const t=this.getIsValidBookmarkName(this.bookmarkTextBox.option("text"));this.updateEnableState(t)}getIsValidBookmarkName(e){return bd.isValidName(e,!1)}getDataSource(){return"Name"==this.sortGroup.option("value")?this.bookmarks=this.bookmarks.sort(((e,t)=>e.name>t.name?1:e.name<t.name?-1:0)):this.bookmarks=this.bookmarks.sort(((e,t)=>e.start-t.start)),this.bookmarks.filter((e=>!e.deleted)).map((e=>e.name))}updateEnableState(e){this.addBtn.option("disabled",!e||!this.parameters.allowedEditBookmarks);const t=this.bookmarkTextBox.option("text"),r=this.bookmarksList.option("items").some((e=>e==t));this.deleteBtn.option("disabled",!r||!this.parameters.allowedEditBookmarks),this.goToBtn.option("disabled",!r)}onBookmarkNameTextBoxValueChanged(){const e=this.getIsValidBookmarkName(this.bookmarkTextBox.option("text"));this.updateEnableState(e)}onBtnDeleteClick(){const e=this.bookmarkTextBox.option("text");this.bookmarks.forEach(((t,r)=>{t.name==e&&(t.deleted=!0,this.bookmarksList.deleteItem(r))})),this.updateDataSource()}onBtnGoToClick(){const e=this.bookmarkTextBox.option("text"),t=this.richedit.commandManager;t.getCommand(FF.GoToBookmark).execute(t.isPublicApiCall,e)}onListValueChanged(){const e=this.bookmarksList.option("selectedItems")[0];e&&e.length>0&&this.bookmarkTextBox.option("value",e)}getToolbarItems(){return[{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.CloseButton"),onClick:()=>{this.applyParameters(),this.popupDialog.hide(),this.afterClosing()}}}]}updateParameters(e,t){e.deletedBookmarkNames=this.bookmarks.filter((e=>e.deleted)).map((e=>e.name))}}class L9{constructor(e){this.name=e.name,this.start=e.start,this.deleted=!1}}class B9 extends C9{getMaxWidth(){return 300}getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.DeleteTableCellsTitle")}getFormOptions(){return{labelLocation:"top",colCount:1,items:[{dataField:"tableCellOperation",editorType:"dxRadioGroup",label:{visible:!1},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.DeleteCells_ShiftCellsLeft"),value:IZ.ShiftToTheHorizontally},{text:(0,OV.formatMessage)("ASPxRichEditStringId.DeleteCells_ShiftCellsUp"),value:IZ.ShiftToTheVertically},{text:(0,OV.formatMessage)("ASPxRichEditStringId.DeleteCells_DeleteEntireRow"),value:IZ.RowOperation},{text:(0,OV.formatMessage)("ASPxRichEditStringId.DeleteCells_DeleteEntireColumn"),value:IZ.ColumnOperation}],valueExpr:"value",value:this.parameters.tableCellOperation}}]}}updateParameters(e,t){e.tableCellOperation=t.tableCellOperation}}class A9 extends C9{dispose(){super.dispose(),clearTimeout(this.searchTimerId)}getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.FindReplaceTitle")}get showCloseButton(){return!0}getFormOptions(){return this.controller=this.parameters.controller,{colCount:2,items:[{colSpan:2,label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Find"),location:"left"},editorType:"dxTextBox",editorOptions:{onInitialized:e=>{this.findTextBox=e.component},onInput:e=>{clearTimeout(this.searchTimerId),e.component.option("text")?this.searchTimerId=setTimeout((()=>{this.findAll()}),700):(this.controller.resetSearch(),this.clearResults())}}},{colSpan:2,label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_ReplaceWith"),location:"left"},editorType:"dxTextBox",editorOptions:{onInitialized:e=>{this.replaceTextBox=e.component}}},{colSpan:2,label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Results"),location:"top"},template:()=>{const e=document.createElement("div");return this.resultList=new(v9())(e,{height:200,noDataText:"",selectionMode:"single",keyExpr:"index",onSelectionChanged:()=>{this.goTo()}}),e}},{label:{visible:!1},editorType:"dxCheckBox",editorOptions:{onValueChanged:()=>{this.findAll()},onInitialized:e=>{this.matchCaseCheckBox=e.component},text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_MatchCase")}},{label:{visible:!1},template:()=>(this.resultLabel=document.createElement("div"),this.resultLabel.style.textAlign="right",this.resultLabel)}]}}afterShowing(){this.controller.onChanged.add(this),this.richedit.owner.hideQuickSearchPanel(),this.controller.whatFind&&(this.findTextBox.option("value",this.controller.whatFind),this.controller.foundIntervals.length?this.fillResults(this.controller.foundIntervals):this.findAll())}NotifySearchReset(){this.clearResults()}getToolbarItems(){return[{widget:"dxButton",location:"before",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_ReplaceAll"),onClick:()=>{this.replaceAll()},onInitialized:e=>{this.replaceAllBtn=e.component},disabled:!0}},{widget:"dxButton",location:"before",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Replace"),onClick:()=>{this.replace()},onInitialized:e=>{this.replaceBtn=e.component},disabled:!0}},{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Previous"),onClick:()=>{this.findPrev()},onInitialized:e=>{this.prevBtn=e.component},disabled:!0}},{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Next"),onClick:()=>{this.findNext()},onInitialized:e=>{this.nextBtn=e.component},disabled:!0}}]}findNext(){const e=this.controller.findNextIntervalIndex();null!==e&&(this.controller.selectIntervalByIndex(e),this.selectResult(e))}findPrev(){const e=this.controller.findPrevIntervalIndex();null!==e&&(this.controller.selectIntervalByIndex(e),this.selectResult(e))}findAll(){const e=this.findTextBox.option("text");if(e){this.controller.findAll(e,this.matchCaseCheckBox.option("value")),this.fillResults(this.controller.foundIntervals);var t=this.controller.findNextIntervalIndex();null!==t&&this.controller.scrollToIntervalByIndex(t)}}replace(){const e=this.replaceTextBox.option("text")||"";this.controller.replace(this.findTextBox.option("text"),e,this.matchCaseCheckBox.option("value"))&&this.findAll(),this.findNext()}replaceAll(){const e=this.replaceTextBox.option("text")||"";this.controller.replaceAll(this.findTextBox.option("text"),e,this.matchCaseCheckBox.option("value")),this.findAll()}goTo(){const e=this.resultList.option("selectedItemKeys");if(e.length){const t=e[0];this.controller.selectIntervalByIndex(t),this.updateResultLabel(t)}}setEnabledForButton(e){const t=this.richedit.readOnly===RF.Persistent;this.replaceAllBtn.option("disabled",!e||t),this.replaceBtn.option("disabled",!e||t),this.nextBtn.option("disabled",!e),this.prevBtn.option("disabled",!e)}fillResults(e){if(this.clearResults(),e.length){if(e.length<300){const t=e.map(((e,t)=>this.createListItem(J0.getTextForResult(this.richedit,this.richedit.selection.activeSubDocument,e),t)));this.resultList.option("items",t),this.resultList.option("disabled",!1)}else this.resultList.option("items",[this.createListItem((0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_TooLongResult"),0)]),this.resultList.option("disabled",!0);this.setEnabledForButton(!0)}else this.findTextBox.option("text")&&this.resultList.option("items",[this.createListItem((0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_NoResult"),0)]),this.resultList.option("disabled",!0);this.updateResultLabel(-1)}createListItem(e,t){return{html:e,index:t}}clearResults(){this.resultList.option("items"),this.setEnabledForButton(!1),this.updateResultLabel(-1)}selectResult(e){this.resultList.option("disabled")||this.resultList.option("selectedItemKeys",[e]),this.updateResultLabel(e)}updateResultLabel(e){if(this.controller.foundIntervals.length){var t=e>=0?`${e+1} of ${this.controller.foundIntervals.length}`:(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Items")+": "+this.controller.foundIntervals.length;this.resultLabel.innerHTML=t}else this.resultLabel.innerHTML=""}updateParameters(e,t){}}class N9 extends C9{getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.ExportRangeTitle")}getMaxWidth(){return 400}getFormOptions(){return{labelLocation:"left",items:[{dataField:"range",editorType:"dxRadioGroup",label:{visible:!1},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_AllRecords"),value:SZ.AllRecords},{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_CurrentRecord"),value:SZ.CurrentRecord},{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_Range"),value:SZ.Range}],valueExpr:"value",value:this.parameters.range,onValueChanged:e=>{this.updateRangeEditorsEnabled(e.component.option("value")==SZ.Range),this.updateMergeModeEditorEnabled(e.component.option("value")!=SZ.CurrentRecord)}}},{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_Range"),items:[{dataField:"exportFrom",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_From"),location:"left"},editorOptions:{value:this.parameters.exportFrom,showSpinButtons:!0,min:1,onInitialized:e=>{this.fromNumberBox=e.component}}},{dataField:"exportRecordsCount",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_Count"),location:"left"},editorOptions:{value:this.parameters.exportRecordsCount,showSpinButtons:!0,min:1,onInitialized:e=>{this.countNumberBox=e.component}}}]},{dataField:"mergeMode",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_MergeMode"),location:"left"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_NewParagraph"),value:CZ.NewParagraph},{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_NewSection"),value:CZ.NewSection}],valueExpr:"value",displayExpr:"text",value:this.parameters.mergeMode,onInitialized:e=>{this.mergeModeSelectBox=e.component}}},{dataField:"documentFormat",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FinishMerge_DocumentFormat"),location:"left"},editorOptions:{items:[{text:"Word Document (*.docx)",value:Fu.OpenXml},{text:"Rich Text Format (*.rtf)",value:Fu.Rtf},{text:"Plain Text (*.txt)",value:Fu.PlainText},{text:"Html Document (*.html, *.htm)",value:Fu.Html}],valueExpr:"value",displayExpr:"text",value:this.parameters.documentFormat}}]}}afterShowing(){this.updateRangeEditorsEnabled(!1)}updateRangeEditorsEnabled(e){this.fromNumberBox.option("disabled",!e),this.countNumberBox.option("disabled",!e)}updateMergeModeEditorEnabled(e){this.mergeModeSelectBox.option("disabled",!e)}updateParameters(e,t){e.range=t.range,e.exportFrom=t.exportFrom,e.exportRecordsCount=t.exportRecordsCount,e.mergeMode=t.mergeMode,e.documentFormat=t.documentFormat}applyParameters(){super.applyParameters();const e=this.parameters.range==SZ.AllRecords?0:this.parameters.range==SZ.Range?this.parameters.exportFrom-1:this.richedit.modelManager.richOptions.mailMerge.activeRecordIndex,t=this.parameters.range==SZ.AllRecords?1/0:this.parameters.range==SZ.Range?this.parameters.exportRecordsCount:1,r=new A7((e=>{GU.FileUtils.startDownloadFileLocal(e,"MergedDocument"+QU.convertToString(this.parameters.documentFormat))}),this.parameters.mergeMode,this.parameters.documentFormat,e,t);this.richedit.commandManager.getCommand(FF.MailMergeOnClient).execute(this.richedit.commandManager.isPublicApiCall,r)}}class k9 extends C9{getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.FontTitle")}getMaxWidth(){return 650}getFormOptions(){const e=this.richedit.modelManager.model.cache.fontInfoCache.getFontNames(!0),t=kJ.getFontSizesList();return{colCount:3,items:[{dataField:"fontName",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Font"),location:"top"},editorType:"dxSelectBox",editorOptions:{items:e,value:this.parameters.fontName}},{dataField:"fontStyle",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FontStyle"),location:"top"},editorType:"dxSelectBox",editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Normal"),value:0},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Bold"),value:1},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Italic"),value:2},{text:(0,OV.formatMessage)("ASPxRichEditStringId.BoldItalic"),value:3}],valueExpr:"value",displayExpr:"text",value:this.parameters.fontStyle}},{dataField:"fontSize",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FontSize"),location:"top"},editorType:"dxSelectBox",editorOptions:{items:t,value:this.parameters.fontSize}},{dataField:"fontColor",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FontColor"),location:"top"},editorType:"dxColorBox",editorOptions:{value:"Auto"!=this.parameters.fontColor?this.parameters.fontColor:""}},{dataField:"fontUnderlineType",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineStyle"),location:"top"},editorType:"dxSelectBox",editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_None"),value:le.None},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Single"),value:le.Single},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Dotted"),value:le.Dotted},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Dashed"),value:le.Dashed},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_DashDotted"),value:le.DashDotted},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_DashDotDotted"),value:le.DashDotDotted},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Double"),value:le.Double},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_HeavyWave"),value:le.HeavyWave},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_LongDashed"),value:le.LongDashed},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_ThickSingle"),value:le.ThickSingle},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_ThickDotted"),value:le.ThickDotted},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_ThickDashed"),value:le.ThickDashed},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_ThickDashDotted"),value:le.ThickDashDotted},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_ThickDashDotDotted"),value:le.ThickDashDotDotted},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_ThickLongDashed"),value:le.ThickLongDashed},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_DoubleWave"),value:le.DoubleWave},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_Wave"),value:le.Wave},{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineType_DashSmallGap"),value:le.DashSmallGap}],valueExpr:"value",displayExpr:"text",value:this.parameters.fontUnderlineType}},{dataField:"fontUnderlineColor",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineColor"),location:"top"},editorType:"dxColorBox",editorOptions:{value:"Auto"!=this.parameters.fontUnderlineColor?this.parameters.fontUnderlineColor:""}},{dataField:"fontStrikeoutType",editorType:"dxRadioGroup",label:{visible:!1},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.StrikeoutType_None"),value:se.None},{text:(0,OV.formatMessage)("ASPxRichEditStringId.StrikeoutType_Single"),value:se.Single},{text:(0,OV.formatMessage)("ASPxRichEditStringId.StrikeoutType_Double"),value:se.Double}],valueExpr:"value",value:this.parameters.fontStrikeoutType}},{dataField:"script",editorType:"dxRadioGroup",label:{visible:!1},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.CharacterFormattingScript_Normal"),value:ne.Normal},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CharacterFormattingScript_Subscript"),value:ne.Subscript},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CharacterFormattingScript_Superscript"),value:ne.Superscript}],valueExpr:"value",value:this.parameters.script}},{itemType:"group",items:[{dataField:"smallCaps",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{value:this.parameters.smallCaps,text:(0,OV.formatMessage)("ASPxRichEditStringId.SmallCaps"),onInitialized:e=>{this.smallCapsItem=e.component},onValueChanged:e=>{this.updateAllCaps(e.component.option("value"))}}},{dataField:"allCaps",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{value:this.parameters.allCaps,text:(0,OV.formatMessage)("ASPxRichEditStringId.AllCaps"),onInitialized:e=>{this.allCapsItem=e.component},onValueChanged:e=>{this.updateSmallCaps(e.component.option("value"))}}},{dataField:"hidden",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{value:this.parameters.hidden,text:(0,OV.formatMessage)("ASPxRichEditStringId.Hidden")}},{dataField:"underlineWordsOnly",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{value:this.parameters.underlineWordsOnly,text:(0,OV.formatMessage)("ASPxRichEditStringId.UnderlineWordsOnly")}}]}]}}updateAllCaps(e){e&&this.allCapsItem.option("value",!1)}updateSmallCaps(e){e&&this.smallCapsItem.option("value",!1)}updateParameters(e,t){e.fontName=void 0===t.fontName?null:t.fontName,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,""!==t.fontColor&&(e.fontColor=t.fontColor),e.fontUnderlineType=t.fontUnderlineType,""!==t.fontUnderlineColor&&(e.fontUnderlineColor=t.fontUnderlineColor),e.fontStrikeoutType=t.fontStrikeoutType,e.script=t.script,e.allCaps=t.allCaps,e.smallCaps=t.smallCaps,e.hidden=t.hidden,e.underlineWordsOnly=t.underlineWordsOnly}}class O9 extends C9{constructor(){super(...arguments),this.mailtoPrefix="mailto:",this.subjectPrefix="?subject="}getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.HyperlinkTitle")}getMaxWidth(){return 500}getFormOptions(){return{labelLocation:"top",colCount:1,items:[{itemType:"tabbed",tabPanelOptions:{deferRendering:!1,selectedIndex:this.parameters.anchor?1:this.isLinkMailTo(this.parameters.url)?2:0,onInitialized:e=>{this.tabPanel=e.component}},tabs:[{title:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_WebPage"),items:[{dataField:"url",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_Url"),location:"left"},editorOptions:{value:this.isLinkMailTo(this.parameters.url)?"":this.parameters.url?this.parameters.url:"https://"}},{dataField:"text",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_Text"),location:"left"},editorOptions:{value:this.parameters.text,disabled:!this.parameters.canChangeDisplayText}},{dataField:"tooltip",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_ToolTip"),location:"left"},editorOptions:{value:this.parameters.tooltip}}]},{title:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_PlaceInThisDocument"),items:[{dataField:"anchor",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_Bookmark"),location:"left"},editorOptions:{items:this.parameters.bookmarkNames,value:this.parameters.anchor}},{dataField:"text",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_Text"),location:"left"},editorOptions:{value:this.parameters.text,disabled:!this.parameters.canChangeDisplayText}},{dataField:"tooltip",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_ToolTip"),location:"left"},editorOptions:{value:this.parameters.tooltip}}]},{title:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_EmailAddress"),items:[{dataField:"email",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_EmailTo"),location:"left"},editorOptions:{value:this.getEmail(this.parameters.url)}},{dataField:"subject",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_Subject"),location:"left"},editorOptions:{value:this.getSubject(this.parameters.url)}},{dataField:"text",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_Text"),location:"left"},editorOptions:{value:this.parameters.text,disabled:!this.parameters.canChangeDisplayText}},{dataField:"tooltip",editorType:"dxTextBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hyperlink_ToolTip"),location:"left"},editorOptions:{value:this.parameters.tooltip}}]}]}]}}isLinkMailTo(e){return e.toLowerCase().indexOf(this.mailtoPrefix)>-1}getSubject(e){const t=e.toLowerCase().indexOf(this.subjectPrefix);return-1==t?"":decodeURI(e.substring(t+this.subjectPrefix.length))}getEmail(e){if(!this.isLinkMailTo(e))return"";const t=e.toLowerCase().indexOf(this.mailtoPrefix),r=e.toLowerCase().indexOf(this.subjectPrefix),i=r>-1?r:e.length;return e.substring(t+this.mailtoPrefix.length,i)}updateParameters(e,t){e.text=t.text,e.tooltip=t.tooltip;const r=this.tabPanel.option("selectedIndex");if(0==r)[e.url,e.anchor]=yd.jE.splitUrlByAnchor(t.url);else if(1==r)e.url="",e.anchor=t.anchor;else{const r=t.subject?this.subjectPrefix+t.subject:"";e.url=this.mailtoPrefix+t.email+r,e.anchor=""}}}class _9 extends C9{constructor(){super(...arguments),this.lastSearchText="",this.fieldNames=[]}getTitle(){return(0,OV.formatMessage)("XtraRichEditStringId.MenuCmd_ShowInsertMergeFieldForm")}getMaxWidth(){return 400}getFormOptions(){return{items:[{label:{visible:!1},editorType:"dxTextBox",editorOptions:{onInput:e=>{this.filter(e.component.option("text"))}}},{label:{visible:!1},template:()=>{const e=document.createElement("div");let t=Number.NaN,r=null;return this.fieldsList=new(v9())(e,{height:250,noDataText:(0,OV.formatMessage)("ASPxRichEditStringId.InsertMergeField_NoFields"),selectionMode:"single",onSelectionChanged:()=>{this.setButtonsEnabled()},onItemClick:e=>{r&&clearTimeout(r),e.itemIndex==t&&(this.applyParameters(),this.popupDialog.hide()),t="number"==typeof e.itemIndex?e.itemIndex:e.itemIndex?e.itemIndex.item:Number.NaN,r=setTimeout((()=>{t=Number.NaN}),300)}}),e}}]}}afterShowing(){const e=this.richedit.owner;this.fieldNames=Object.keys(e.dataSource.items()[0]),this.fieldsList.option("items",this.fieldNames),this.setButtonsEnabled()}filter(e){(e=e.toLowerCase())!=this.lastSearchText&&(this.lastSearchText=e,this.fieldsList.option("items",e.length>0?this.fieldNames.filter((t=>t.toLowerCase().indexOf(e)>-1)):this.fieldNames),this.setButtonsEnabled())}setButtonsEnabled(){this.insertBtn.option("disabled",!this.fieldsList.option("selectedItems")[0])}getToolbarItems(){return[{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertButton"),onInitialized:e=>{this.insertBtn=e.component},onClick:()=>{this.applyParameters(),this.popupDialog.hide()}}},{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.CloseButton"),onClick:()=>{this.popupDialog.hide(),this.afterClosing()}}}]}updateParameters(e,t){e.fieldName=this.fieldsList.option("selectedItems")[0]}}class U9 extends C9{getMaxWidth(){return 300}getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.InsertTableCellsTitle")}getFormOptions(){return{labelLocation:"top",colCount:1,items:[{dataField:"tableCellOperation",editorType:"dxRadioGroup",label:{visible:!1},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertCells_ShiftCellsRight"),value:IZ.ShiftToTheHorizontally},{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertCells_ShiftCellsDown"),value:IZ.ShiftToTheVertically},{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertCells_InsertEntireRow"),value:IZ.RowOperation},{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertCells_InsertEntireColumn"),value:IZ.ColumnOperation}],valueExpr:"value",value:this.parameters.tableCellOperation}}]}}updateParameters(e,t){e.tableCellOperation=t.tableCellOperation}}class H9 extends C9{getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.InsertTableTitle")}getMaxWidth(){return 300}getFormOptions(){return{labelLocation:"top",colCount:1,items:[{dataField:"columnCount",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertTable_NumberOfColumns"),location:"left"},editorOptions:{value:this.parameters.columnCount,showSpinButtons:!0,min:1}},{dataField:"rowCount",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertTable_NumberOfRows"),location:"left"},editorOptions:{value:this.parameters.rowCount,showSpinButtons:!0,min:1}}]}}updateParameters(e,t){e.columnCount=t.columnCount,e.rowCount=t.rowCount}}class V9 extends C9{constructor(){super(...arguments),this.lockOrientation=!1,this.lockKind=!1,this.lockSize=!1}getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.PageSetupTitle")}getMaxWidth(){return 500}getFormOptions(){return{labelLocation:"top",colCount:1,items:[{itemType:"tabbed",tabPanelOptions:{deferRendering:!1,selectedIndex:this.parameters.initialTab},tabs:[{title:(0,OV.formatMessage)("ASPxRichEditStringId.Margins"),items:[{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.Margins"),colCount:2,items:[{dataField:"marginTop",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Top"),location:"left"},editorOptions:{value:this.parameters.marginTop,showSpinButtons:!0,step:.1,format:"#0.##"}},{dataField:"marginLeft",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Left"),location:"left"},editorOptions:{value:this.parameters.marginLeft,showSpinButtons:!0,step:.1,format:"#0.##"}},{dataField:"marginBottom",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Bottom"),location:"left"},editorOptions:{value:this.parameters.marginBottom,showSpinButtons:!0,step:.1,format:"#0.##"}},{dataField:"marginRight",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Right"),location:"left"},editorOptions:{value:this.parameters.marginRight,showSpinButtons:!0,step:.1,format:"#0.##"}}]},{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.Orientation"),items:[{dataField:"landscape",editorType:"dxRadioGroup",label:{visible:!1},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Portrait"),value:!1},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Landscape"),value:!0}],valueExpr:"value",value:this.parameters.landscape,onValueChanged:()=>{this.onOrientationChanged()},onInitialized:e=>{this.orientationRadioGroup=e.component}}}]}]},{title:(0,OV.formatMessage)("ASPxRichEditStringId.Paper"),items:[{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.PaperSize"),colCount:2,items:[{editorType:"dxSelectBox",label:{visible:!1},colSpan:2,editorOptions:{items:this.getPaperKinds(),valueExpr:"value",displayExpr:"text",onValueChanged:e=>{this.onPaperKindChanged(e.component.option("value"))},onInitialized:e=>{this.pageKindSelectBox=e.component}}},{dataField:"pageWidth",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Width"),location:"left"},editorOptions:{value:this.parameters.pageWidth,showSpinButtons:!0,step:.1,format:"#0.##",onValueChanged:()=>{this.onPaperSizeChanged()},onInitialized:e=>{this.pageWidthNumberBox=e.component}}},{dataField:"pageHeight",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Height"),location:"left"},editorOptions:{value:this.parameters.pageHeight,showSpinButtons:!0,step:.1,format:"#0.##",onValueChanged:()=>{this.onPaperSizeChanged()},onInitialized:e=>{this.pageHeightNumberBox=e.component}}}]}]},{title:(0,OV.formatMessage)("ASPxRichEditStringId.Layout"),items:[{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.Section"),items:[{dataField:"startType",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.SectionStart"),location:"left"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Continuous"),value:Vs.Continuous},{text:(0,OV.formatMessage)("ASPxRichEditStringId.NewPage"),value:Vs.NextPage},{text:(0,OV.formatMessage)("ASPxRichEditStringId.EvenPage"),value:Vs.EvenPage},{text:(0,OV.formatMessage)("ASPxRichEditStringId.OddPage"),value:Vs.OddPage}],valueExpr:"value",displayExpr:"text",value:this.parameters.startType}}]},{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.HeadersAndFooters"),items:[{dataField:"headerDifferentOddAndEven",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{value:!!this.parameters.headerDifferentOddAndEven,text:(0,OV.formatMessage)("ASPxRichEditStringId.DifferentOddAndEven")}},{dataField:"headerDifferentFirstPage",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{value:!!this.parameters.headerDifferentFirstPage,text:(0,OV.formatMessage)("ASPxRichEditStringId.DifferentFirstPage")}},{dataField:"headerOffset",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FromEdge")+" "+(0,OV.formatMessage)("ASPxRichEditStringId.Header"),location:"left"},editorOptions:{value:this.parameters.headerOffset,showSpinButtons:!0,step:.1,format:"#0.##"}},{dataField:"footerOffset",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.FromEdge")+" "+(0,OV.formatMessage)("ASPxRichEditStringId.Footer"),location:"left"},editorOptions:{value:this.parameters.footerOffset,showSpinButtons:!0,step:.1,format:"#0.##"}}]}]}]},{dataField:"applyTo",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.ApplyTo"),location:"left"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.WholeDocument"),value:fZ.WholeDocument},{text:(0,OV.formatMessage)("ASPxRichEditStringId.CurrentSection"),value:fZ.CurrentSection},{text:(0,OV.formatMessage)("ASPxRichEditStringId.SelectedSections"),value:fZ.SelectedSections},{text:(0,OV.formatMessage)("ASPxRichEditStringId.ThisPointForward"),value:fZ.ThisPointForward}],valueExpr:"value",displayExpr:"text",value:this.parameters.applyTo}}]}}afterShowing(){this.parameters.pageWidth&&this.parameters.pageHeight&&this.onPaperSizeChanged()}getPaperKinds(){const e=Object.keys(Vc).map((e=>Vc[e])).filter((e=>"string"==typeof e)),t=Object.keys(Vc).map((e=>Vc[e])).filter((e=>"number"==typeof e));return t.map(((t,r)=>({text:e[r],value:t})))}onPaperKindChanged(e){this.lockKind=!0;const t=Ih.calculatePaperSize(e);this.lockSize||(this.pageWidthNumberBox.option("value",this.richedit.uiUnitConverter.twipsToUI(t.width)),this.pageHeightNumberBox.option("value",this.richedit.uiUnitConverter.twipsToUI(t.height))),this.updateOrientation(t.width>t.height),this.lockKind=!1}onPaperSizeChanged(){this.lockSize=!0;const e=this.pageWidthNumberBox.option("value"),t=this.pageHeightNumberBox.option("value");this.updatePaperKind(e,t),this.updateOrientation(e>t),this.lockSize=!1}onOrientationChanged(){this.lockOrientation=!0;const e=this.orientationRadioGroup.option("value"),t=this.pageWidthNumberBox.option("value"),r=this.pageHeightNumberBox.option("value");e?(this.pageWidthNumberBox.option("value",Math.max(t,r)),this.pageHeightNumberBox.option("value",Math.min(t,r)),this.updatePaperKind(Math.max(t,r),Math.min(t,r))):(this.pageWidthNumberBox.option("value",Math.min(t,r)),this.pageHeightNumberBox.option("value",Math.max(t,r)),this.updatePaperKind(Math.min(t,r),Math.max(t,r))),this.lockOrientation=!1}updatePaperKind(e,t){if(this.lockKind)return;const r=new so.Size(this.richedit.uiUnitConverter.UIToTwips(e),this.richedit.uiUnitConverter.UIToTwips(t));let i=Ih.calculatePaperKind(r,0,this.richedit.uiUnitConverter.UIToTwips(.01));i==Vc.Custom&&(i=Ih.calculatePaperKind(new so.Size(r.height,r.width),0,this.richedit.uiUnitConverter.UIToTwips(.01))),this.pageKindSelectBox.option("value",i>=0?i:null)}updateOrientation(e){this.lockOrientation||this.orientationRadioGroup.option("value",e)}updateParameters(e,t){e.marginTop=t.marginTop,e.marginLeft=t.marginLeft,e.marginBottom=t.marginBottom,e.marginRight=t.marginRight,e.landscape=t.landscape,e.pageWidth=t.pageWidth,e.pageHeight=t.pageHeight,e.startType=t.startType,e.headerDifferentOddAndEven=t.headerDifferentOddAndEven,e.headerDifferentFirstPage=t.headerDifferentFirstPage,e.headerOffset=t.headerOffset,e.footerOffset=t.footerOffset,e.applyTo=t.applyTo}}class W9 extends C9{getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.ParagraphTitle")}getMaxWidth(){return 650}getFormOptions(){return{items:[{itemType:"tabbed",tabPanelOptions:{deferRendering:!1},tabs:[{title:(0,OV.formatMessage)("ASPxRichEditStringId.ParagraphTab0"),items:[{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.General"),colCount:2,items:[{dataField:"alignment",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Alignment"),location:"top"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Left"),value:Ae.Left},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Right"),value:Ae.Right},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Centered"),value:Ae.Center},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Justified"),value:Ae.Justify}],valueExpr:"value",displayExpr:"text",value:this.parameters.alignment}},{dataField:"outlineLevel",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.OutlineLevel"),location:"top"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.BodyText"),value:0},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 1",value:1},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 2",value:2},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 3",value:3},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 4",value:4},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 5",value:5},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 6",value:6},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 7",value:7},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 8",value:8},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Level")+" 9",value:9}],valueExpr:"value",displayExpr:"text",value:this.parameters.outlineLevel}}]},{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.Indentation"),colCount:4,items:[{dataField:"leftIndent",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Left"),location:"top"},editorOptions:{value:this.parameters.leftIndent,showSpinButtons:!0,step:.1,format:"#0.##"}},{dataField:"rightIndent",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Right"),location:"top"},editorOptions:{value:this.parameters.rightIndent,showSpinButtons:!0,step:.1,format:"#0.##"}},{dataField:"firstLineIndentType",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Special"),location:"top"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.none"),value:ke.None},{text:(0,OV.formatMessage)("ASPxRichEditStringId.FirstLine"),value:ke.Indented},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Hanging"),value:ke.Hanging}],valueExpr:"value",displayExpr:"text",value:this.parameters.firstLineIndentType}},{dataField:"firstLineIndent",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.By"),location:"top"},editorOptions:{value:this.parameters.firstLineIndent,showSpinButtons:!0,step:.1,format:"#0.##"}}]},{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.Spacing"),colCount:4,items:[{dataField:"spacingBefore",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Before"),location:"top"},editorOptions:{value:this.parameters.spacingBefore,showSpinButtons:!0,step:.1,format:"#0.##"}},{dataField:"spacingAfter",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.After"),location:"top"},editorOptions:{value:this.parameters.spacingAfter,showSpinButtons:!0,step:.1,format:"#0.##"}},{dataField:"lineSpacingType",editorType:"dxSelectBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.LineSpacing"),location:"top"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Single"),value:Ne.Single},{text:(0,OV.formatMessage)("ASPxRichEditStringId.spacing_1_5_lines"),value:Ne.Sesquialteral},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Double"),value:Ne.Double},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Multiple"),value:Ne.Multiple},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Exactly"),value:Ne.Exactly},{text:(0,OV.formatMessage)("ASPxRichEditStringId.AtLeast"),value:Ne.AtLeast}],valueExpr:"value",displayExpr:"text",value:this.parameters.lineSpacingType,onValueChanged:e=>{this.updateAtNumberBox(e.component.option("value"))}}},{dataField:"lineSpacing",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.At"),location:"top"},editorOptions:{showSpinButtons:!0,format:"#0.##",onInitialized:e=>{this.atNumberBox=e.component}}}]},{dataField:"contextualSpacing",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{value:this.parameters.contextualSpacing,text:(0,OV.formatMessage)("ASPxRichEditStringId.NoSpace")}}]},{title:(0,OV.formatMessage)("ASPxRichEditStringId.ParagraphTab1"),items:[{itemType:"group",caption:(0,OV.formatMessage)("ASPxRichEditStringId.Pagination"),items:[{dataField:"pageBreakBefore",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{value:this.parameters.pageBreakBefore,text:(0,OV.formatMessage)("ASPxRichEditStringId.PBB")}}]}]}]}]}}afterShowing(){const e=this.form.option("formData").lineSpacingType;this.updateAtNumberBox(e)}updateAtNumberBox(e){switch(e){case Ne.Single:case Ne.Sesquialteral:case Ne.Double:this.atNumberBox.option("value",void 0),this.atNumberBox.option("disabled",!0);break;case Ne.Multiple:this.atNumberBox.option("step",.5),this.atNumberBox.option("disabled",!1),this.atNumberBox.option("value",this.parameters.lineSpacingMultiple),this.atNumberBox.option("min",1);break;default:this.atNumberBox.option("step",.1),this.atNumberBox.option("disabled",!1),this.atNumberBox.option("value",this.parameters.lineSpacing),this.atNumberBox.option("min",void 0)}}getToolbarItems(){return[this.getTabsToolbarItem(),this.getOkToolbarItem(),this.getCancelToolbarItem()]}getTabsToolbarItem(){return{widget:"dxButton",location:"before",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.TabsTitle")+"...",onClick:()=>{this.popupDialog.hide();const e=this.richedit.commandManager;e.getCommand(FF.ShowTabsForm).execute(e.isPublicApiCall)}}}}updateParameters(e,t){e.alignment=t.alignment,e.outlineLevel=t.outlineLevel,e.leftIndent=t.leftIndent,e.rightIndent=t.rightIndent,e.firstLineIndentType=t.firstLineIndentType,e.firstLineIndent=t.firstLineIndent,e.spacingBefore=t.spacingBefore,e.spacingAfter=t.spacingAfter;const r=t.lineSpacingType;e.lineSpacingType=r,r==Ne.Multiple&&(e.lineSpacingMultiple=t.lineSpacing),r!=Ne.Exactly&&r!=Ne.AtLeast||(e.lineSpacing=t.lineSpacing),e.contextualSpacing=t.contextualSpacing,e.keepLinesTogether=t.keepLinesTogether,e.pageBreakBefore=t.pageBreakBefore}}class z9 extends C9{getMaxWidth(){return 400}getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.SplitTableCellsTitle")}getFormOptions(){return{labelLocation:"top",colCount:1,items:[{dataField:"columnCount",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertTable_NumberOfColumns"),location:"left"},editorOptions:{value:this.parameters.columnCount,min:1,showSpinButtons:!0}},{dataField:"rowCount",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.InsertTable_NumberOfRows"),location:"left"},editorOptions:{value:this.parameters.rowCount,disabled:this.parameters.disableRowsSelector,min:1,max:this.parameters.availableRowNumber>1?this.parameters.availableRowNumber:100,showSpinButtons:!0}},{dataField:"isMergeBeforeSplit",editorType:"dxCheckBox",label:{visible:!1},editorOptions:{text:(0,OV.formatMessage)("ASPxRichEditStringId.SplitCells_MergeCells"),disabled:!this.parameters.isMergeBeforeSplit,value:this.parameters.isMergeBeforeSplit}}]}}updateParameters(e,t){e.columnCount=t.columnCount,e.rowCount=t.rowCount,e.isMergeBeforeSplit=t.isMergeBeforeSplit}}class j9 extends C9{constructor(){super(...arguments),this.deletedTabs=[],this.isClearAllHappend=!1}getTitle(){return(0,OV.formatMessage)("ASPxRichEditStringId.TabsTitle")}getMaxWidth(){return 500}getFormOptions(){return this.tabProperties=this.parameters.tabProperties,{colCount:6,items:[{colSpan:3,label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_TabStopPosition"),location:"top"},editorType:"dxTextBox",editorOptions:{onInitialized:e=>{this.tabTextBox=e.component},onInput:()=>{this.setButtonsEnabled()}}},{colSpan:3,dataField:"defaultTabStop",editorType:"dxNumberBox",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_DefaultTabStops"),location:"top"},editorOptions:{value:this.parameters.defaultTabStop,showSpinButtons:!0,step:.1,format:"#0.##"}},{colSpan:3,label:{visible:!1},template:()=>{const e=document.createElement("div");return this.tabsList=new(v9())(e,{height:200,noDataText:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_NoTabs"),selectionMode:"single",keyExpr:"index",onSelectionChanged:e=>{this.onSelectedTabIndexChanged(e.component.option("selectedItemKeys")[0])}}),e}},{colSpan:3,template:()=>{const e=document.createElement("div");return this.toBeClearedList=e,e}},{colSpan:6,editorType:"dxRadioGroup",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Alignment"),location:"top"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Left"),value:Ha.Left},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Right"),value:Ha.Right},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Center"),value:Ha.Center},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Decimal"),value:Ha.Decimal}],valueExpr:"value",layout:"horizontal",onInitialized:e=>{this.alignmentRadioGroup=e.component},onValueChanged:e=>{this.setAlignmentValue(e.component.option("value"))}}},{colSpan:6,editorType:"dxRadioGroup",label:{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Leader"),location:"top"},editorOptions:{items:[{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_None"),value:Sg.None},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Dots"),value:Sg.Dots},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_ThickLine"),value:Sg.ThickLine},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Hyphens"),value:Sg.Hyphens},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Underline"),value:Sg.Underline},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_EqualSign"),value:Sg.EqualSign},{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_MiddleDots"),value:Sg.MiddleDots}],valueExpr:"value",layout:"horizontal",onInitialized:e=>{this.leaderRadioGroup=e.component},onValueChanged:e=>{this.setLeaderValue(e.component.option("value"))}}},{colSpan:2,template:()=>{const e=document.createElement("div");return this.setBtn=new(x9())(e,{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Set"),width:"100%",onClick:()=>{this.setTab()}}),e}},{colSpan:2,template:()=>{const e=document.createElement("div");return this.clearBtn=new(x9())(e,{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_Clear"),width:"100%",onClick:()=>{this.clearTab()}}),e}},{colSpan:2,template:()=>{const e=document.createElement("div");return new(x9())(e,{text:(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_ClearAll"),width:"100%",onClick:()=>{this.clearAllTab()}}),e}}]}}afterShowing(){this.updateForm()}setButtonsEnabled(){const e=0==this.tabTextBox.option("text").length;this.setBtn.option("disabled",e),this.clearBtn.option("disabled",e)}onSelectedTabIndexChanged(e){const t=this.tabProperties.tabsInfo[e];t?(this.setTabPositionValue(t.position),this.alignmentRadioGroup.option("value",t.alignment),this.leaderRadioGroup.option("value",t.leader)):(this.tabTextBox.option("value",""),this.alignmentRadioGroup.option("value",Ha.Left),this.leaderRadioGroup.option("value",Sg.None)),this.setButtonsEnabled()}setTab(){if(this.getCurrentTabsInfoIndex()>-1)return;const e=this.getTabPositionText(),t=Number(e);if(isNaN(t))return;const r=this.richedit.uiUnitConverter.UIToTwips(t),i=this.alignmentRadioGroup.option("value"),n=this.leaderRadioGroup.option("value"),o=new rs(r,i,n,!1,!1);this.tabProperties.tabsInfo.push(o),this.sortTabsInfo(),this.updateForm()}clearTab(){const e=this.getCurrentTabsInfoIndex();if(e<0)return;const t=this.getRoundedPositionByTwips(this.tabProperties.tabsInfo[e].position);f.ListUtils.remove(this.deletedTabs,t),this.deletedTabs.push(t),this.deletedTabs.sort(Qe.Comparers.number),this.tabProperties.tabsInfo.splice(e,1),this.updateForm()}sortTabsInfo(){this.tabProperties.tabsInfo.sort(((e,t)=>e.position>t.position?1:e.position<t.position?-1:0))}updateForm(){const e=this.tabProperties.tabsInfo.map(((e,t)=>{const r=this.getRoundedPositionByTwips(e.position);return this.createListItem(r+"",t++)}));this.tabsList.option("items",e),this.onSelectedTabIndexChanged(0),this.updateClearedTabsLabel()}setAlignmentValue(e){const t=this.getCurrentTabsInfoIndex();t>-1&&(this.tabProperties.tabsInfo[t].alignment=e)}setLeaderValue(e){const t=this.getCurrentTabsInfoIndex();t>-1&&(this.tabProperties.tabsInfo[t].leader=e)}updateClearedTabsLabel(){let e=(0,OV.formatMessage)("ASPxRichEditStringId.Tabs_TabStopsToBeCleared")+": ";if(this.isClearAllHappend)e+="All";else for(var t=0;t<this.deletedTabs.length;t++)e+=this.deletedTabs[t]+"; ";this.toBeClearedList.innerHTML=e}createListItem(e,t){return{html:e,index:t}}clearAllTab(){this.tabProperties.tabsInfo=[],this.isClearAllHappend=!0,this.updateForm()}getCurrentTabsInfoIndex(){const e=this.getTabPositionText(),t=Number(e);if(!isNaN(t))for(var r=this.getRoundedPosition(e),i=0;i<this.tabProperties.tabsInfo.length;i++)if(this.getRoundedPositionByTwips(this.tabProperties.tabsInfo[i].position)==r)return i;return-1}getTabPositionText(){return this.tabTextBox.option("text")}setTabPositionValue(e){this.tabTextBox.option("value",this.getRoundedPositionByTwips(e).toString())}getRoundedPosition(e){return Math.round(100*e)/100}getRoundedPositionByTwips(e){return this.getRoundedPosition(this.richedit.uiUnitConverter.twipsToUI(e))}getOkToolbarItem(){return{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:(0,OV.formatMessage)("ASPxRichEditStringId.OkButton"),onClick:()=>{this.setTab(),this.applyParameters(),this.popupDialog.hide(),this.afterClosing()}}}}updateParameters(e,t){e.defaultTabStop=t.defaultTabStop,e.tabProperties=this.tabProperties}}class X9{constructor(e,t){this.dialogElement=e.appendChild(document.createElement("div")),this.richedit=t,this.dialogsMap={},this.dialogsMap.EditFont=k9,this.dialogsMap.EditParagraph=W9,this.dialogsMap.InsertTable=H9,this.dialogsMap.ErrorMessage=I9,this.dialogsMap.InformationMessage=P9,this.dialogsMap.WarningMessage=w9,this.dialogsMap.Hyperlink=O9,this.dialogsMap.Bookmarks=R9,this.dialogsMap.InsertTableCells=U9,this.dialogsMap.DeleteTableCells=B9,this.dialogsMap.SplitTableCells=z9,this.dialogsMap.FindReplace=A9,this.dialogsMap.PageSetup=V9,this.dialogsMap.Tabs=j9,this.dialogsMap.InsertMergeField=_9,this.dialogsMap.FinishAndMerge=N9}dispose(){b.j.forEach(this.dialogsMap,(e=>{e.dispose&&e.dispose()})),fn.DomUtils.hideNode(this.dialogElement)}getDialog(e){const t=this.dialogsMap[e];return t?this.getDialogByType(t):null}getDialogByType(e){return new e(this.dialogElement,this.richedit)}}const G9={"[object Array]":"array","[object Date]":"date","[object Object]":"object","[object String]":"string"},K9=function(e){if(null===e)return"null";const t=Object.prototype.toString.call(e);return"object"==typeof e?G9[t]||"object":typeof e},q9=function(e){return null!=e},$9=function(e){return"function"==typeof e},J9=function(e){return"string"==typeof e},Y9=function(e){if(!e||"object"!==K9(e))return!1;const t=Object.getPrototypeOf(e);if(!t)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&Object.toString.call(r)===Object.toString.call(Object)},Q9=function(e){return null!=e&&e===e.window},Z9=function(e){return!!e&&$9(e.then)},eee=function(e){return!!e&&$9(e.done)&&$9(e.fail)};const tee=function(e){let t=1,r=!1;for("boolean"==typeof(e=e||{})&&(r=e,e=arguments[1]||{},t++);t<arguments.length;t++){const i=arguments[t];if(null!=i)for(const t in i){const n=e[t],o=i[t];let a,s=!1;"__proto__"!==t&&"constructor"!==t&&e!==o&&(r&&o&&(Y9(o)||(s=Array.isArray(o)))?(a=s?n&&Array.isArray(n)?n:[]:n&&Y9(n)?n:{},e[t]=tee(r,a,o)):void 0!==o&&(e[t]=o))}}return e};!function(){const e=[new RegExp("&","g"),new RegExp('"',"g"),new RegExp("'","g"),new RegExp("<","g"),new RegExp(">","g")]}();function ree(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return $9(e)?e(...r):(r.forEach(((t,r)=>{J9(t)&&(t=t.replace(/\$/g,"$$$$"));const i=new RegExp(`\\{${r}\\}`,"gm");e=e.replace(i,t)})),e)}!function(){const e=/\s/g}();const iee=function(){},nee=function(e){return"undefined"!=typeof console&&$9(console[e])?console[e].bind(console):iee},oee={log:nee("log"),info:nee("info"),warn:nee("warn"),error:nee("error")},aee=function(){function e(e,t){if(!e)throw new Error(t)}return{assert:e,assertParam:function(t,r){e(null!=t,r)}}}();var see={logger:oee,debug:aee};const lee=`https://js.devexpress.com/error/${"24.2.5".split(".").slice(0,2).join("_")}/`;function dee(e,t){const r={ERROR_MESSAGES:tee(t,e),Error:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){const t=e[0],r=i(t,e=e.slice(1)),a=o(t),s=n(t,r);return tee(new Error(s),{__id:t,__details:r,url:a})}(t)},log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const o=t[0];let a="log";/^E\d+$/.test(o)?a="error":/^W\d+$/.test(o)&&(a="warn"),see.logger[a]("log"===a?o:function(e){const t=e[0];return n(t,i(t,e=e.slice(1)))}(t))}};function i(e,t){return t=[r.ERROR_MESSAGES[e]].concat(t),ree.apply(this,t).replace(/\.*\s*?$/,"")}function n(e,t){const r=null!=e&&e.startsWith("W")?"warning":"error";return ree.apply(this,["{0} - {1}.\n\nFor additional information on this {2} message, see: {3}",e,t,r,o(e)])}function o(e){return lee+e}return r}var cee=dee({E0001:"Method is not implemented",E0002:"Member name collision: {0}",E0003:"A class must be instantiated using the 'new' keyword",E0004:"The NAME property of the component is not specified",E0005:"Unknown device",E0006:"Unknown endpoint key is requested",E0007:"'Invalidate' method is called outside the update transaction",E0008:"Type of the option name is not appropriate to create an action",E0009:"Component '{0}' has not been initialized for an element",E0010:"Animation configuration with the '{0}' type requires '{1}' configuration as {2}",E0011:"Unknown animation type '{0}'",E0012:"jQuery version is too old. Please upgrade jQuery to 1.10.0 or later",E0013:"KnockoutJS version is too old. Please upgrade KnockoutJS to 2.3.0 or later",E0014:"The 'release' method shouldn't be called for an unlocked Lock object",E0015:"Queued task returned an unexpected result",E0017:"Event namespace is not defined",E0018:"DevExpress.ui.DevExpressPopup widget is required",E0020:"Template engine '{0}' is not supported",E0021:"Unknown theme is set: {0}",E0022:"LINK[rel=DevExpress-theme] tags must go before DevExpress included scripts",E0023:"Template name is not specified",E0024:"DevExtreme bundle already included",E0025:"Unexpected argument type",E0100:"Unknown validation type is detected",E0101:"Misconfigured range validation rule is detected",E0102:"Misconfigured comparison validation rule is detected",E0103:"validationCallback of an asynchronous rule should return a jQuery or a native promise",E0110:"Unknown validation group is detected",E0120:"Adapter for a DevExpressValidator component cannot be configured",E0121:"The 'customItem' parameter of the 'onCustomItemCreating' function is empty or contains invalid data. Assign a custom object or a Promise that is resolved after the item is created.",W0000:"'{0}' is deprecated in {1}. {2}",W0001:"{0} - '{1}' option is deprecated in {2}. {3}",W0002:"{0} - '{1}' method is deprecated in {2}. {3}",W0003:"{0} - '{1}' property is deprecated in {2}. {3}",W0004:"Timeout for theme loading is over: {0}",W0005:"'{0}' event is deprecated in {1}. {2}",W0006:"Invalid recurrence rule: '{0}'",W0007:"'{0}' Globalize culture is not defined",W0008:"Invalid view name: '{0}'",W0009:"Invalid time zone name: '{0}'",W0010:"{0} is deprecated in {1}. {2}",W0011:"Number parsing is invoked while the parser is not defined",W0012:"Date parsing is invoked while the parser is not defined",W0013:"'{0}' file is deprecated in {1}. {2}",W0014:"{0} - '{1}' type is deprecated in {2}. {3}",W0015:"Instead of returning a value from the '{0}' function, write it into the '{1}' field of the function's parameter.",W0016:'The "{0}" option does not accept the "{1}" value since v{2}. {3}.',W0017:'Setting the "{0}" property with a function is deprecated since v21.2',W0018:'Setting the "position" property with a function is deprecated since v21.2',W0019:"DevExtreme: Unable to Locate a Valid License Key.\n\nDetailed license/registration related information and instructions: https://js.devexpress.com/Documentation/Licensing/.\n\nIf you are using a 30-day trial version of DevExtreme, you must uninstall all copies of DevExtreme once your 30-day trial period expires. For terms and conditions that govern use of DevExtreme UI components/libraries, please refer to the DevExtreme End User License Agreement: https://js.devexpress.com/EULAs/DevExtremeComplete.\n\nTo use DevExtreme in a commercial project, you must purchase a license. For pricing/licensing options, please visit: https://js.devexpress.com/Buy.\n\nIf you have licensing-related questions or need help with a purchase, please email clientservices@devexpress.com.\n\n",W0020:"DevExtreme: License Key Has Expired.\n\nDetailed license/registration related information and instructions: https://js.devexpress.com/Documentation/Licensing/.\n\nA mismatch exists between the license key used and the DevExtreme version referenced in this project.\n\nTo proceed, you can:\n• use a version of DevExtreme linked to your license key: https://www.devexpress.com/ClientCenter/DownloadManager\n• renew your DevExpress Subscription: https://www.devexpress.com/buy/renew (once you renew your subscription, you will be entitled to product updates and support service as defined in the DevExtreme End User License Agreement)\n\nIf you have licensing-related questions or need help with a renewal, please email clientservices@devexpress.com.\n\n",W0021:"DevExtreme: License Key Verification Has Failed.\n\nDetailed license/registration related information and instructions: https://js.devexpress.com/Documentation/Licensing/.\n\nTo verify your DevExtreme license, make certain to specify a correct key in the GlobalConfig. If you continue to encounter this error, please visit https://www.devexpress.com/ClientCenter/DownloadManager to obtain a valid license key.\n\nIf you have a valid license and this problem persists, please submit a support ticket via the DevExpress Support Center. We will be happy to follow-up: https://supportcenter.devexpress.com/ticket/create.\n\n",W0022:"DevExtreme: Pre-release software. Not suitable for commercial use.\n\nDetailed license/registration related information and instructions: https://js.devexpress.com/Documentation/Licensing/.\n\nPre-release software may contain deficiencies and as such, should not be considered for use or integrated in any mission critical application.\n\n",W0023:"DevExtreme: the following 'devextreme' package version does not match versions of other DevExpress products used in this application:\n\n{0}\n\nInteroperability between different versions of the products listed herein cannot be guaranteed.\n\n"});const hee=function(e,t,r){return function(){const i=this.callBase;this.callBase=e[t];try{return r.apply(this,arguments)}finally{this.callBase=i}}},uee=function(e){const t=this;let r,i,n;if(!e)return t;for(i in e)n=e[i],r="function"==typeof t.prototype[i]&&"function"==typeof n,t.prototype[i]=r?hee(t.parent.prototype,i,n):n;return t},pee=function(){const e=this;let t,r,i;const n=Object.prototype.hasOwnProperty.bind(e);!n("_includedCtors")&&!n("_includedPostCtors")&&(e._includedCtors=e._includedCtors.slice(0),e._includedPostCtors=e._includedPostCtors.slice(0));for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];for(i=0;i<a.length;i++)for(r in t=a[i],t.ctor&&e._includedCtors.push(t.ctor),t.postCtor&&e._includedPostCtors.push(t.postCtor),t)"ctor"!==r&&"postCtor"!==r&&"default"!==r&&(e.prototype[r]=t[r]);return e},gee=function(e){if(!Object.prototype.hasOwnProperty.bind(this)("parent")&&this.parent){const t=Object.getPrototypeOf(this);return t===e||t.subclassOf(e)}return this.parent===e||!(!this.parent||!this.parent.subclassOf)&&this.parent.subclassOf(e)},mee=function(){throw cee.Error("E0001")},fee=function(){};fee.inherit=function(e){const t=function(){if(!this||Q9(this)||"function"!=typeof this.constructor)throw cee.Error("E0003");const e=this,{ctor:t}=e,r=e.constructor._includedCtors,i=e.constructor._includedPostCtors;let n;for(n=0;n<r.length;n++)r[n].call(e);if(t){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];t.apply(e,a)}for(n=0;n<i.length;n++)i[n].call(e)};return t.prototype=function(e){const t=function(){};return t.prototype=e.prototype,new t}(this),Object.setPrototypeOf(t,this),t.inherit=this.inherit,t.abstract=mee,t.redefine=uee,t.include=pee,t.subclassOf=gee,t.parent=this,t._includedCtors=this._includedCtors?this._includedCtors.slice(0):[],t._includedPostCtors=this._includedPostCtors?this._includedPostCtors.slice(0):[],t.prototype.constructor=t,t.redefine(e),t},fee.abstract=mee;var bee=fee;const Cee=(e,t)=>{if(e){if("length"in e)for(let r=0;r<e.length&&!1!==t.call(e[r],r,e[r]);r++);else for(const r in e)if(!1===t.call(e[r],r,e[r]))break;return e}};var See=function(e){const t=bee.inherit(e);let r=t,i=new r(e);const n={},o=function(t,r){Cee(t,(function(t){$9(i[t])?!r&&e[t]||(e[t]=function(){return i[t].apply(e,arguments)}):(r&&(n[t]=e[t]),e[t]=i[t])}))};return o(e,!0),e.inject=function(e){r=r.inherit(e),i=new r,o(e)},e.resetInjection=function(){tee(e,n),r=t,i=new t},e};function Iee(e,t){for(;e.length<t;)e="0"+e;return e}const Pee={3:"abbreviated",4:"wide",5:"narrow"},wee={y:function(e,t,r){let i=e[r?"getUTCFullYear":"getFullYear"]();return 2===t&&(i%=100),Iee(i.toString(),t)},M:function(e,t,r,i){const n=e[r?"getUTCMonth":"getMonth"](),o=Pee[t];return o?i.getMonthNames(o,"format")[n]:Iee((n+1).toString(),Math.min(t,2))},L:function(e,t,r,i){const n=e[r?"getUTCMonth":"getMonth"](),o=Pee[t];return o?i.getMonthNames(o,"standalone")[n]:Iee((n+1).toString(),Math.min(t,2))},Q:function(e,t,r,i){const n=e[r?"getUTCMonth":"getMonth"](),o=Math.floor(n/3),a=Pee[t];return a?i.getQuarterNames(a)[o]:Iee((o+1).toString(),Math.min(t,2))},E:function(e,t,r,i){const n=e[r?"getUTCDay":"getDay"](),o=Pee[t<3?3:t];return i.getDayNames(o)[n]},a:function(e,t,r,i){const n=e[r?"getUTCHours":"getHours"]()<12?0:1,o=Pee[t];return i.getPeriodNames(o)[n]},d:function(e,t,r){return Iee(e[r?"getUTCDate":"getDate"]().toString(),Math.min(t,2))},H:function(e,t,r){return Iee(e[r?"getUTCHours":"getHours"]().toString(),Math.min(t,2))},h:function(e,t,r){return Iee((e[r?"getUTCHours":"getHours"]()%12||12).toString(),Math.min(t,2))},m:function(e,t,r){return Iee(e[r?"getUTCMinutes":"getMinutes"]().toString(),Math.min(t,2))},s:function(e,t,r){return Iee(e[r?"getUTCSeconds":"getSeconds"]().toString(),Math.min(t,2))},S:function(e,t,r){return Iee(e[r?"getUTCMilliseconds":"getMilliseconds"]().toString(),3).substr(0,t)},x:function(e,t,r){const i=r?0:e.getTimezoneOffset(),n=i>0?"-":"+",o=Math.abs(i),a=o%60,s=Iee(Math.floor(o/60).toString(),2),l=Iee(a.toString(),2);return n+s+(t>=3?":":"")+(t>1||a?l:"")},X:function(e,t,r){return r||!e.getTimezoneOffset()?"Z":wee.x(e,t,r)},Z:function(e,t,r){return wee.X(e,t>=5?3:2,r)}};const yee={rtlEnabled:!1,defaultCurrency:"USD",defaultUseCurrencyAccountingStyle:!0,oDataFilterToLower:!0,serverDecimalSeparator:".",decimalSeparator:".",thousandsSeparator:",",forceIsoDateParsing:!0,wrapActionsBeforeExecute:!0,useLegacyStoreResult:!1,useJQuery:void 0,editorStylingMode:void 0,useLegacyVisibleIndex:!1,floatingActionButtonConfig:{icon:"add",closeIcon:"close",label:"",position:{at:"right bottom",my:"right bottom",offset:{x:-16,y:-16}},maxSpeedDialActionCount:5,shading:!1,direction:"auto"},optionsParser:e=>{"{"!==e.trim().charAt(0)&&(e=`{${e}}`);try{return JSON.parse(e)}catch(t){try{return JSON.parse(xee(e))}catch(r){throw cee.Error("E3018",t,e)}}}},xee=e=>e.replace(/'/g,'"').replace(/,\s*([\]}])/g,"$1").replace(/([{,])\s*([^":\s]+)\s*:/g,'$1"$2":'),Tee=["decimalSeparator","thousandsSeparator"],vee=function(){if(!arguments.length)return yee;const e=arguments.length<=0?void 0:arguments[0];Tee.forEach((t=>{if(e[t]){const e=`Now, the ${t} is selected based on the specified locale.`;cee.log("W0003","config",t,"19.2",e)}})),tee(yee,e)};"undefined"!=typeof DevExpress&&DevExpress.config&&vee(DevExpress.config);var Mee=vee;bee.inherit({ctor:function(e){e&&(e=String(e)),this._value=this._normalize(e||this._generate())},_normalize:function(e){for(e=e.replace(/[^a-f0-9]/gi,"").toLowerCase();e.length<32;)e+="0";return[e.substr(0,8),e.substr(8,4),e.substr(12,4),e.substr(16,4),e.substr(20,12)].join("-")},_generate:function(){let e="";for(let t=0;t<32;t++)e+=Math.round(15*Math.random()).toString(16);return e},toString:function(){return this._value},valueOf:function(){return this._value},toJSON:function(){return this._value}});var Eee=Mee;var Dee=See({isWrapped:function(){return!1},isWritableWrapped:function(){return!1},wrap:function(e){return e},unwrap:function(e){return e},assign:function(){oee.error("Method 'assign' should not be used for not wrapped variables. Use 'isWrapped' method for ensuring.")}});(function(){function e(){}})(),Dee.unwrap;const{isWrapped:Fee}=Dee,{assign:Ree}=Dee;const Lee=function(e){this._options=e||{},this._list=[],this._queue=[],this._firing=!1,this._fired=!1,this._firingIndexes=[]};Lee.prototype._fireCore=function(e,t){const r=this._firingIndexes,i=this._list,{stopOnFalse:n}=this._options,o=r.length;for(r[o]=0;r[o]<i.length;r[o]++){if(!1===i[r[o]].apply(e,t)&&n)break}r.pop()},Lee.prototype.add=function(e){return"function"!=typeof e||this._options.unique&&this.has(e)||this._list.push(e),this},Lee.prototype.remove=function(e){const t=this._list,r=this._firingIndexes,i=t.indexOf(e);if(i>-1&&(t.splice(i,1),this._firing&&r.length))for(let e=0;e<r.length;e++)i<=r[e]&&r[e]--;return this},Lee.prototype.has=function(e){const t=this._list;return e?t.indexOf(e)>-1:!!t.length},Lee.prototype.empty=function(e){return this._list=[],this},Lee.prototype.fireWith=function(e,t){const r=this._queue;if(t=(t=t||[]).slice?t.slice():t,this._options.syncStrategy)this._firing=!0,this._fireCore(e,t);else{if(r.push([e,t]),this._firing)return;for(this._firing=!0;r.length;){const e=r.shift();this._fireCore(e[0],e[1])}}return this._firing=!1,this._fired=!0,this},Lee.prototype.fire=function(){this.fireWith(this,arguments)},Lee.prototype.fired=function(){return this._fired};const Bee=function(e){return new Lee(e)};var Aee=Bee;const Nee=[{method:"resolve",handler:"done",state:"resolved"},{method:"reject",handler:"fail",state:"rejected"},{method:"notify",handler:"progress"}];let kee=function(){const e=this;this._state="pending",this._promise={},Nee.forEach(function(t){const r=t.method;this[`${r}Callbacks`]=Aee(),this[r]=function(){return this[`${r}With`](this._promise,arguments)}.bind(this),this._promise[t.handler]=function(t){if(!t)return this;const i=e[`${r}Callbacks`];return i.fired()?t.apply(e[`${r}Context`],e[`${r}Args`]):i.add((function(e,r){t.apply(e,r)})),this}}.bind(this)),this._promise.always=function(e){return this.done(e).fail(e)},this._promise.catch=function(e){return this.then(null,e)},this._promise.then=function(e,t){const r=new kee;return["done","fail"].forEach(function(i){const n="done"===i?e:t;this[i]((function(){if(!n)return void r["done"===i?"resolve":"reject"].apply(this,arguments);const e=n&&n.apply(this,arguments);eee(e)?e.done(r.resolve).fail(r.reject):Z9(e)?e.then(r.resolve,r.reject):r.resolve.apply(this,q9(e)?[e]:arguments)}))}.bind(this)),r.promise()},this._promise.state=function(){return e._state},this._promise.promise=function(t){return t?tee(t,e._promise):e._promise},this._promise.promise(this)};Nee.forEach((function(e){const t=e.method,{state:r}=e;kee.prototype[`${t}With`]=function(e,i){const n=this[`${t}Callbacks`];return"pending"===this.state()&&(this[`${t}Args`]=i,this[`${t}Context`]=e,r&&(this._state=r),n.fire(e,i),"pending"!==r&&(this.resolveCallbacks.empty(),this.rejectCallbacks.empty())),this}}));const Oee=function(e){return e.replace(/[[\]{}\-()*+?.\\^$|\s]/g,"\\$&")};function _ee(e,t){const r=function(e){const t=e.toExponential().split("e"),r=parseFloat(t[0]);return{exponent:parseInt(t[1],10),mantissa:r}}(e);return parseFloat(`${r.mantissa}e${r.exponent+t}`)}function Uee(e){const t=function(e){return 0===e?0:e/Math.abs(e)}(e);return t*Math.round(Math.abs(e))}function Hee(e,t){const r=t||0,i=r>0?function(e,t){const r=Math.pow(10,t);return Uee(_ee(e,t))/r}(...arguments):e;return i.toFixed(r)}const Vee={thousandsSeparator:",",decimalSeparator:"."};function Wee(e){return e.toString().split("").reverse().join("")}function zee(e){return e.replace(/'.+'/g,"")}function jee(e){if(!e)return 0;const t=zee(e);return t.length-t.replace(/[#]/g,"").length}function Xee(e){if(!e)return 0;const t=zee(e);return t.length-t.replace(/[0]/g,"").length}function Gee(e,t,r){if(!e)return"";for(e.length>r&&(e=e.substr(0,r));e.length>t&&"0"===e.slice(-1);)e=e.substr(0,e.length-1);for(;e.length<t;)e+="0";return e}function Kee(e,t){return e.split("'").map((function(e,r){const i=r%2;return!e&&i?"'":i?e:e.replace(/[,#0]+/,t)})).join("")}function qee(e,t){return t=t||Vee,function(r){if("number"!=typeof r||isNaN(r))return"";const i=function(e){const t=e.split(";");return 1===t.length&&t.push("-"+t[0]),t}(e),n=r>0||1/r==1/0,o=i[n?0:1],a=function(e){let t=!1;for(let r=0;r<e.length;r++)if("'"===e[r]&&(t=!t),"."===e[r]&&!t)return r;return e.length}(o),s=[o.substr(0,a),o.substr(a+1)],l=Xee(s[1]),d=l+jee(s[1]);(function(e){return-1!==e.indexOf("%")&&!e.match(/'[^']*%[^']*'/g)})(o)&&(r=_ee(r,2)),n||(r=-r);const c=Xee(s[0]),h=jee(s[0])||t.unlimitedIntegerDigits?void 0:c,u=function(e,t,r){const i=!t&&0!==t,n=!r&&0!==r;return i&&(t=n?e:Math.min(e,r)),n&&(r=i?e:Math.max(e,t)),Math.min(Math.max(e,t),r)}(d,0,15-Math.floor(r).toString().length),p=(g=s[0],g.split(",").slice(1).map((function(e){let t=0;return e.split("").filter((function(e,r){return t+="'"===e,!("#"!==e&&"0"!==e||t%2)})).length}))).reverse();var g;const m=Hee(r,u<0?0:u).split(".");let f=Gee(Wee(m[0]),c,h);const b=Gee(m[1],l,d);f=function(e,t,r){if(!t.length)return e;const i=[];let n=0;for(;e;){const r=t[n];if(!r)break;i.push(e.slice(0,r)),e=e.slice(r),n<t.length-1&&n++}return i.join(r)}(f,p,t.thousandsSeparator);const C=Wee(Kee(Wee(s[0]),f)),S=d?Kee(s[1],b):"";return C+(S.match(/\d/)?t.decimalSeparator:"")+S}}var $ee={_formatNumberCore:function(e,t,r){if("currency"===t){r.precision=r.precision||0;let t=this.format(e,tee({},r,{type:"fixedpoint"}));const i=this.getCurrencySymbol().symbol.replace(/\$/g,"$$$$");return t=t.replace(/^(\D*)(\d.*)/,"$1"+i+"$2"),t}return this.callBase.apply(this,arguments)},getCurrencySymbol:function(){return{symbol:"$"}},getOpenXmlCurrencyFormat:function(){return"$#,##0{0}_);\\($#,##0{0}\\)"}},Jee={"en-150":"en-001","en-AG":"en-001","en-AI":"en-001","en-AU":"en-001","en-BB":"en-001","en-BM":"en-001","en-BS":"en-001","en-BW":"en-001","en-BZ":"en-001","en-CC":"en-001","en-CK":"en-001","en-CM":"en-001","en-CX":"en-001","en-CY":"en-001","en-DG":"en-001","en-DM":"en-001","en-ER":"en-001","en-FJ":"en-001","en-FK":"en-001","en-FM":"en-001","en-GB":"en-001","en-GD":"en-001","en-GG":"en-001","en-GH":"en-001","en-GI":"en-001","en-GM":"en-001","en-GY":"en-001","en-HK":"en-001","en-IE":"en-001","en-IL":"en-001","en-IM":"en-001","en-IN":"en-001","en-IO":"en-001","en-JE":"en-001","en-JM":"en-001","en-KE":"en-001","en-KI":"en-001","en-KN":"en-001","en-KY":"en-001","en-LC":"en-001","en-LR":"en-001","en-LS":"en-001","en-MG":"en-001","en-MO":"en-001","en-MS":"en-001","en-MT":"en-001","en-MU":"en-001","en-MV":"en-001","en-MW":"en-001","en-MY":"en-001","en-NA":"en-001","en-NF":"en-001","en-NG":"en-001","en-NR":"en-001","en-NU":"en-001","en-NZ":"en-001","en-PG":"en-001","en-PK":"en-001","en-PN":"en-001","en-PW":"en-001","en-RW":"en-001","en-SB":"en-001","en-SC":"en-001","en-SD":"en-001","en-SG":"en-001","en-SH":"en-001","en-SL":"en-001","en-SS":"en-001","en-SX":"en-001","en-SZ":"en-001","en-TC":"en-001","en-TK":"en-001","en-TO":"en-001","en-TT":"en-001","en-TV":"en-001","en-TZ":"en-001","en-UG":"en-001","en-VC":"en-001","en-VG":"en-001","en-VU":"en-001","en-WS":"en-001","en-ZA":"en-001","en-ZM":"en-001","en-ZW":"en-001","en-AT":"en-150","en-BE":"en-150","en-CH":"en-150","en-DE":"en-150","en-DK":"en-150","en-FI":"en-150","en-NL":"en-150","en-SE":"en-150","en-SI":"en-150","hi-Latn":"en-IN","es-AR":"es-419","es-BO":"es-419","es-BR":"es-419","es-BZ":"es-419","es-CL":"es-419","es-CO":"es-419","es-CR":"es-419","es-CU":"es-419","es-DO":"es-419","es-EC":"es-419","es-GT":"es-419","es-HN":"es-419","es-MX":"es-419","es-NI":"es-419","es-PA":"es-419","es-PE":"es-419","es-PR":"es-419","es-PY":"es-419","es-SV":"es-419","es-US":"es-419","es-UY":"es-419","es-VE":"es-419",nb:"no",nn:"no","pt-AO":"pt-PT","pt-CH":"pt-PT","pt-CV":"pt-PT","pt-FR":"pt-PT","pt-GQ":"pt-PT","pt-GW":"pt-PT","pt-LU":"pt-PT","pt-MO":"pt-PT","pt-MZ":"pt-PT","pt-ST":"pt-PT","pt-TL":"pt-PT","az-Arab":"und","az-Cyrl":"und","bal-Latn":"und","blt-Latn":"und","bm-Nkoo":"und","bs-Cyrl":"und","byn-Latn":"und","cu-Glag":"und","dje-Arab":"und","dyo-Arab":"und","en-Dsrt":"und","en-Shaw":"und","ff-Adlm":"und","ff-Arab":"und","ha-Arab":"und","iu-Latn":"und","kk-Arab":"und","ks-Deva":"und","ku-Arab":"und","ky-Arab":"und","ky-Latn":"und","ml-Arab":"und","mn-Mong":"und","mni-Mtei":"und","ms-Arab":"und","pa-Arab":"und","sat-Deva":"und","sd-Deva":"und","sd-Khoj":"und","sd-Sind":"und","shi-Latn":"und","so-Arab":"und","sr-Latn":"und","sw-Arab":"und","tg-Arab":"und","ug-Cyrl":"und","uz-Arab":"und","uz-Cyrl":"und","vai-Latn":"und","wo-Arab":"und","yo-Arab":"und","yue-Hans":"und","zh-Hant":"und","zh-Hant-MO":"zh-Hant-HK"};var Yee=(e,t)=>{const r=e[t];return r?"root"!==r&&r:t.substr(0,t.lastIndexOf("-"))};var Qee=See({locale:(()=>{let e="en";return t=>{if(!t)return e;e=t}})(),getValueByClosestLocale:function(e){let t,r=this.locale(),i=e(r);for(;!i&&!t;)r=Yee(Jee,r),r?i=e(r):t=!0;return void 0===i&&"en"!==r?e("en"):i}}),Zee={af:"¤#,##0.00;(¤#,##0.00)","af-NA":"¤#,##0.00;(¤#,##0.00)",agq:"#,##0.00¤",ak:"¤#,##0.00",am:"¤#,##0.00;(¤#,##0.00)",ar:"¤#,##0.00;(¤#,##0.00)","ar-AE":"¤#,##0.00;(¤#,##0.00)","ar-BH":"¤#,##0.00;(¤#,##0.00)","ar-DJ":"¤#,##0.00;(¤#,##0.00)","ar-DZ":"¤#,##0.00;(¤#,##0.00)","ar-EG":"¤#,##0.00;(¤#,##0.00)","ar-EH":"¤#,##0.00;(¤#,##0.00)","ar-ER":"¤#,##0.00;(¤#,##0.00)","ar-IL":"¤#,##0.00;(¤#,##0.00)","ar-IQ":"¤#,##0.00;(¤#,##0.00)","ar-JO":"¤#,##0.00;(¤#,##0.00)","ar-KM":"¤#,##0.00;(¤#,##0.00)","ar-KW":"¤#,##0.00;(¤#,##0.00)","ar-LB":"¤#,##0.00;(¤#,##0.00)","ar-LY":"¤#,##0.00;(¤#,##0.00)","ar-MA":"¤#,##0.00;(¤#,##0.00)","ar-MR":"¤#,##0.00;(¤#,##0.00)","ar-OM":"¤#,##0.00;(¤#,##0.00)","ar-PS":"¤#,##0.00;(¤#,##0.00)","ar-QA":"¤#,##0.00;(¤#,##0.00)","ar-SA":"¤#,##0.00;(¤#,##0.00)","ar-SD":"¤#,##0.00;(¤#,##0.00)","ar-SO":"¤#,##0.00;(¤#,##0.00)","ar-SS":"¤#,##0.00;(¤#,##0.00)","ar-SY":"¤#,##0.00;(¤#,##0.00)","ar-TD":"¤#,##0.00;(¤#,##0.00)","ar-TN":"¤#,##0.00;(¤#,##0.00)","ar-YE":"¤#,##0.00;(¤#,##0.00)",as:"¤ #,##,##0.00",asa:"#,##0.00 ¤",ast:"#,##0.00 ¤",az:"#,##0.00 ¤","az-Cyrl":"#,##0.00 ¤","az-Latn":"#,##0.00 ¤",bas:"#,##0.00 ¤",be:"#,##0.00 ¤","be-tarask":"#,##0.00 ¤",bem:"¤#,##0.00;(¤#,##0.00)",bez:"#,##0.00¤",bg:"0.00 ¤;(0.00 ¤)",bm:"¤#,##0.00;(¤#,##0.00)",bn:"#,##,##0.00¤;(#,##,##0.00¤)","bn-IN":"#,##,##0.00¤;(#,##,##0.00¤)",bo:"¤ #,##0.00","bo-IN":"¤ #,##0.00",br:"#,##0.00 ¤",brx:"¤ #,##,##0.00",bs:"#,##0.00 ¤","bs-Cyrl":"#,##0.00 ¤","bs-Latn":"#,##0.00 ¤",ca:"#,##0.00 ¤;(#,##0.00 ¤)","ca-AD":"#,##0.00 ¤;(#,##0.00 ¤)","ca-ES-valencia":"#,##0.00 ¤;(#,##0.00 ¤)","ca-FR":"#,##0.00 ¤;(#,##0.00 ¤)","ca-IT":"#,##0.00 ¤;(#,##0.00 ¤)",ccp:"#,##,##0.00¤;(#,##,##0.00¤)","ccp-IN":"#,##,##0.00¤;(#,##,##0.00¤)",ce:"#,##0.00 ¤",ceb:"¤#,##0.00;(¤#,##0.00)",cgg:"¤#,##0.00",chr:"¤#,##0.00;(¤#,##0.00)",ckb:"¤ #,##0.00","ckb-IR":"¤ #,##0.00",cs:"#,##0.00 ¤",cy:"¤#,##0.00;(¤#,##0.00)",da:"#,##0.00 ¤","da-GL":"#,##0.00 ¤",dav:"¤#,##0.00;(¤#,##0.00)",de:"#,##0.00 ¤","de-AT":"#,##0.00 ¤","de-BE":"#,##0.00 ¤","de-CH":"#,##0.00 ¤","de-IT":"#,##0.00 ¤","de-LI":"#,##0.00 ¤","de-LU":"#,##0.00 ¤",dje:"#,##0.00¤",doi:"¤#,##0.00",dsb:"#,##0.00 ¤",dua:"#,##0.00 ¤",dyo:"#,##0.00 ¤",dz:"¤#,##,##0.00",ebu:"¤#,##0.00;(¤#,##0.00)",ee:"¤#,##0.00;(¤#,##0.00)","ee-TG":"¤#,##0.00;(¤#,##0.00)",el:"#,##0.00 ¤","el-CY":"#,##0.00 ¤",en:"¤#,##0.00;(¤#,##0.00)","en-001":"¤#,##0.00;(¤#,##0.00)","en-150":"#,##0.00 ¤","en-AE":"¤#,##0.00;(¤#,##0.00)","en-AG":"¤#,##0.00;(¤#,##0.00)","en-AI":"¤#,##0.00;(¤#,##0.00)","en-AS":"¤#,##0.00;(¤#,##0.00)","en-AT":"¤ #,##0.00","en-AU":"¤#,##0.00;(¤#,##0.00)","en-BB":"¤#,##0.00;(¤#,##0.00)","en-BE":"#,##0.00 ¤","en-BI":"¤#,##0.00;(¤#,##0.00)","en-BM":"¤#,##0.00;(¤#,##0.00)","en-BS":"¤#,##0.00;(¤#,##0.00)","en-BW":"¤#,##0.00;(¤#,##0.00)","en-BZ":"¤#,##0.00;(¤#,##0.00)","en-CA":"¤#,##0.00;(¤#,##0.00)","en-CC":"¤#,##0.00;(¤#,##0.00)","en-CH":"¤ #,##0.00;¤-#,##0.00","en-CK":"¤#,##0.00;(¤#,##0.00)","en-CM":"¤#,##0.00;(¤#,##0.00)","en-CX":"¤#,##0.00;(¤#,##0.00)","en-CY":"¤#,##0.00;(¤#,##0.00)","en-DE":"#,##0.00 ¤","en-DG":"¤#,##0.00;(¤#,##0.00)","en-DK":"#,##0.00 ¤","en-DM":"¤#,##0.00;(¤#,##0.00)","en-ER":"¤#,##0.00;(¤#,##0.00)","en-FI":"#,##0.00 ¤","en-FJ":"¤#,##0.00;(¤#,##0.00)","en-FK":"¤#,##0.00;(¤#,##0.00)","en-FM":"¤#,##0.00;(¤#,##0.00)","en-GB":"¤#,##0.00;(¤#,##0.00)","en-GD":"¤#,##0.00;(¤#,##0.00)","en-GG":"¤#,##0.00;(¤#,##0.00)","en-GH":"¤#,##0.00;(¤#,##0.00)","en-GI":"¤#,##0.00;(¤#,##0.00)","en-GM":"¤#,##0.00;(¤#,##0.00)","en-GU":"¤#,##0.00;(¤#,##0.00)","en-GY":"¤#,##0.00;(¤#,##0.00)","en-HK":"¤#,##0.00;(¤#,##0.00)","en-IE":"¤#,##0.00;(¤#,##0.00)","en-IL":"¤#,##0.00;(¤#,##0.00)","en-IM":"¤#,##0.00;(¤#,##0.00)","en-IN":"¤#,##0.00;(¤#,##0.00)","en-IO":"¤#,##0.00;(¤#,##0.00)","en-JE":"¤#,##0.00;(¤#,##0.00)","en-JM":"¤#,##0.00;(¤#,##0.00)","en-KE":"¤#,##0.00;(¤#,##0.00)","en-KI":"¤#,##0.00;(¤#,##0.00)","en-KN":"¤#,##0.00;(¤#,##0.00)","en-KY":"¤#,##0.00;(¤#,##0.00)","en-LC":"¤#,##0.00;(¤#,##0.00)","en-LR":"¤#,##0.00;(¤#,##0.00)","en-LS":"¤#,##0.00;(¤#,##0.00)","en-MG":"¤#,##0.00;(¤#,##0.00)","en-MH":"¤#,##0.00;(¤#,##0.00)","en-MO":"¤#,##0.00;(¤#,##0.00)","en-MP":"¤#,##0.00;(¤#,##0.00)","en-MS":"¤#,##0.00;(¤#,##0.00)","en-MT":"¤#,##0.00;(¤#,##0.00)","en-MU":"¤#,##0.00;(¤#,##0.00)","en-MV":"¤ #,##0.00","en-MW":"¤#,##0.00;(¤#,##0.00)","en-MY":"¤#,##0.00;(¤#,##0.00)","en-NA":"¤#,##0.00;(¤#,##0.00)","en-NF":"¤#,##0.00;(¤#,##0.00)","en-NG":"¤#,##0.00;(¤#,##0.00)","en-NL":"¤ #,##0.00;(¤ #,##0.00)","en-NR":"¤#,##0.00;(¤#,##0.00)","en-NU":"¤#,##0.00;(¤#,##0.00)","en-NZ":"¤#,##0.00;(¤#,##0.00)","en-PG":"¤#,##0.00;(¤#,##0.00)","en-PH":"¤#,##0.00;(¤#,##0.00)","en-PK":"¤#,##0.00;(¤#,##0.00)","en-PN":"¤#,##0.00;(¤#,##0.00)","en-PR":"¤#,##0.00;(¤#,##0.00)","en-PW":"¤#,##0.00;(¤#,##0.00)","en-RW":"¤#,##0.00;(¤#,##0.00)","en-SB":"¤#,##0.00;(¤#,##0.00)","en-SC":"¤#,##0.00;(¤#,##0.00)","en-SD":"¤#,##0.00;(¤#,##0.00)","en-SE":"#,##0.00 ¤","en-SG":"¤#,##0.00;(¤#,##0.00)","en-SH":"¤#,##0.00;(¤#,##0.00)","en-SI":"#,##0.00 ¤;(#,##0.00 ¤)","en-SL":"¤#,##0.00;(¤#,##0.00)","en-SS":"¤#,##0.00;(¤#,##0.00)","en-SX":"¤#,##0.00;(¤#,##0.00)","en-SZ":"¤#,##0.00;(¤#,##0.00)","en-TC":"¤#,##0.00;(¤#,##0.00)","en-TK":"¤#,##0.00;(¤#,##0.00)","en-TO":"¤#,##0.00;(¤#,##0.00)","en-TT":"¤#,##0.00;(¤#,##0.00)","en-TV":"¤#,##0.00;(¤#,##0.00)","en-TZ":"¤#,##0.00;(¤#,##0.00)","en-UG":"¤#,##0.00;(¤#,##0.00)","en-UM":"¤#,##0.00;(¤#,##0.00)","en-VC":"¤#,##0.00;(¤#,##0.00)","en-VG":"¤#,##0.00;(¤#,##0.00)","en-VI":"¤#,##0.00;(¤#,##0.00)","en-VU":"¤#,##0.00;(¤#,##0.00)","en-WS":"¤#,##0.00;(¤#,##0.00)","en-ZA":"¤#,##0.00;(¤#,##0.00)","en-ZM":"¤#,##0.00;(¤#,##0.00)","en-ZW":"¤#,##0.00;(¤#,##0.00)",eo:"¤ #,##0.00",es:"#,##0.00 ¤","es-419":"¤#,##0.00","es-AR":"¤ #,##0.00;(¤ #,##0.00)","es-BO":"¤#,##0.00","es-BR":"¤#,##0.00","es-BZ":"¤#,##0.00","es-CL":"¤#,##0.00","es-CO":"¤#,##0.00","es-CR":"¤#,##0.00","es-CU":"¤#,##0.00","es-DO":"¤#,##0.00;(¤#,##0.00)","es-EA":"#,##0.00 ¤","es-EC":"¤#,##0.00","es-GQ":"#,##0.00 ¤","es-GT":"¤#,##0.00","es-HN":"¤#,##0.00","es-IC":"#,##0.00 ¤","es-MX":"¤#,##0.00","es-NI":"¤#,##0.00","es-PA":"¤#,##0.00","es-PE":"¤#,##0.00","es-PH":"#,##0.00 ¤","es-PR":"¤#,##0.00","es-PY":"¤#,##0.00","es-SV":"¤#,##0.00","es-US":"¤#,##0.00","es-UY":"¤ #,##0.00;(¤ #,##0.00)","es-VE":"¤#,##0.00",et:"#,##0.00 ¤;(#,##0.00 ¤)",eu:"#,##0.00 ¤;(#,##0.00 ¤)",ewo:"#,##0.00 ¤",fa:"‎¤ #,##0.00;‎(¤ #,##0.00)","fa-AF":"¤ #,##0.00;‎(¤ #,##0.00)",ff:"#,##0.00 ¤","ff-Adlm":"¤ #,##0.00","ff-Adlm-BF":"¤ #,##0.00","ff-Adlm-CM":"¤ #,##0.00","ff-Adlm-GH":"¤ #,##0.00","ff-Adlm-GM":"¤ #,##0.00","ff-Adlm-GW":"¤ #,##0.00","ff-Adlm-LR":"¤ #,##0.00","ff-Adlm-MR":"¤ #,##0.00","ff-Adlm-NE":"¤ #,##0.00","ff-Adlm-NG":"¤ #,##0.00","ff-Adlm-SL":"¤ #,##0.00","ff-Adlm-SN":"¤ #,##0.00","ff-Latn":"#,##0.00 ¤","ff-Latn-BF":"#,##0.00 ¤","ff-Latn-CM":"#,##0.00 ¤","ff-Latn-GH":"#,##0.00 ¤","ff-Latn-GM":"#,##0.00 ¤","ff-Latn-GN":"#,##0.00 ¤","ff-Latn-GW":"#,##0.00 ¤","ff-Latn-LR":"#,##0.00 ¤","ff-Latn-MR":"#,##0.00 ¤","ff-Latn-NE":"#,##0.00 ¤","ff-Latn-NG":"#,##0.00 ¤","ff-Latn-SL":"#,##0.00 ¤",fi:"#,##0.00 ¤",fil:"¤#,##0.00;(¤#,##0.00)",fo:"#,##0.00 ¤;(#,##0.00 ¤)","fo-DK":"#,##0.00 ¤;(#,##0.00 ¤)",fr:"#,##0.00 ¤;(#,##0.00 ¤)","fr-BE":"#,##0.00 ¤;(#,##0.00 ¤)","fr-BF":"#,##0.00 ¤;(#,##0.00 ¤)","fr-BI":"#,##0.00 ¤;(#,##0.00 ¤)","fr-BJ":"#,##0.00 ¤;(#,##0.00 ¤)","fr-BL":"#,##0.00 ¤;(#,##0.00 ¤)","fr-CA":"#,##0.00 ¤;(#,##0.00 ¤)","fr-CD":"#,##0.00 ¤;(#,##0.00 ¤)","fr-CF":"#,##0.00 ¤;(#,##0.00 ¤)","fr-CG":"#,##0.00 ¤;(#,##0.00 ¤)","fr-CH":"#,##0.00 ¤;(#,##0.00 ¤)","fr-CI":"#,##0.00 ¤;(#,##0.00 ¤)","fr-CM":"#,##0.00 ¤;(#,##0.00 ¤)","fr-DJ":"#,##0.00 ¤;(#,##0.00 ¤)","fr-DZ":"#,##0.00 ¤;(#,##0.00 ¤)","fr-GA":"#,##0.00 ¤;(#,##0.00 ¤)","fr-GF":"#,##0.00 ¤;(#,##0.00 ¤)","fr-GN":"#,##0.00 ¤;(#,##0.00 ¤)","fr-GP":"#,##0.00 ¤;(#,##0.00 ¤)","fr-GQ":"#,##0.00 ¤;(#,##0.00 ¤)","fr-HT":"#,##0.00 ¤;(#,##0.00 ¤)","fr-KM":"#,##0.00 ¤;(#,##0.00 ¤)","fr-LU":"#,##0.00 ¤;(#,##0.00 ¤)","fr-MA":"#,##0.00 ¤;(#,##0.00 ¤)","fr-MC":"#,##0.00 ¤;(#,##0.00 ¤)","fr-MF":"#,##0.00 ¤;(#,##0.00 ¤)","fr-MG":"#,##0.00 ¤;(#,##0.00 ¤)","fr-ML":"#,##0.00 ¤;(#,##0.00 ¤)","fr-MQ":"#,##0.00 ¤;(#,##0.00 ¤)","fr-MR":"#,##0.00 ¤;(#,##0.00 ¤)","fr-MU":"#,##0.00 ¤;(#,##0.00 ¤)","fr-NC":"#,##0.00 ¤;(#,##0.00 ¤)","fr-NE":"#,##0.00 ¤;(#,##0.00 ¤)","fr-PF":"#,##0.00 ¤;(#,##0.00 ¤)","fr-PM":"#,##0.00 ¤;(#,##0.00 ¤)","fr-RE":"#,##0.00 ¤;(#,##0.00 ¤)","fr-RW":"#,##0.00 ¤;(#,##0.00 ¤)","fr-SC":"#,##0.00 ¤;(#,##0.00 ¤)","fr-SN":"#,##0.00 ¤;(#,##0.00 ¤)","fr-SY":"#,##0.00 ¤;(#,##0.00 ¤)","fr-TD":"#,##0.00 ¤;(#,##0.00 ¤)","fr-TG":"#,##0.00 ¤;(#,##0.00 ¤)","fr-TN":"#,##0.00 ¤;(#,##0.00 ¤)","fr-VU":"#,##0.00 ¤;(#,##0.00 ¤)","fr-WF":"#,##0.00 ¤;(#,##0.00 ¤)","fr-YT":"#,##0.00 ¤;(#,##0.00 ¤)",fur:"¤ #,##0.00",fy:"¤ #,##0.00;(¤ #,##0.00)",ga:"¤#,##0.00;(¤#,##0.00)","ga-GB":"¤#,##0.00;(¤#,##0.00)",gd:"¤#,##0.00;(¤#,##0.00)",gl:"#,##0.00 ¤",gsw:"#,##0.00 ¤","gsw-FR":"#,##0.00 ¤","gsw-LI":"#,##0.00 ¤",gu:"¤#,##,##0.00;(¤#,##,##0.00)",guz:"¤#,##0.00;(¤#,##0.00)",gv:"¤#,##0.00",ha:"¤ #,##0.00","ha-GH":"¤ #,##0.00","ha-NE":"¤ #,##0.00",haw:"¤#,##0.00;(¤#,##0.00)",he:"#,##0.00 ¤",hi:"¤#,##,##0.00","hi-Latn":"¤#,##,##0.00",hr:"#,##0.00 ¤","hr-BA":"#,##0.00 ¤",hsb:"#,##0.00 ¤",hu:"#,##0.00 ¤",hy:"#,##0.00 ¤",ia:"¤ #,##0.00;(¤ #,##0.00)",id:"¤#,##0.00",ig:"¤#,##0.00;(¤#,##0.00)",ii:"¤ #,##0.00",is:"#,##0.00 ¤",it:"#,##0.00 ¤","it-CH":"#,##0.00 ¤","it-SM":"#,##0.00 ¤","it-VA":"#,##0.00 ¤",ja:"¤#,##0.00;(¤#,##0.00)",jgo:"¤ #,##0.00",jmc:"¤#,##0.00",jv:"¤ #,##0.00",ka:"#,##0.00 ¤",kab:"#,##0.00¤",kam:"¤#,##0.00;(¤#,##0.00)",kde:"¤#,##0.00;(¤#,##0.00)",kea:"#,##0.00 ¤;(#,##0.00 ¤)",kgp:"¤ #,##0.00",khq:"#,##0.00¤",ki:"¤#,##0.00;(¤#,##0.00)",kk:"#,##0.00 ¤",kkj:"¤ #,##0.00",kl:"¤#,##0.00;¤-#,##0.00",kln:"¤#,##0.00;(¤#,##0.00)",km:"#,##0.00¤;(#,##0.00¤)",kn:"¤#,##0.00;(¤#,##0.00)",ko:"¤#,##0.00;(¤#,##0.00)","ko-KP":"¤#,##0.00;(¤#,##0.00)",kok:"¤#,##0.00;(¤#,##0.00)",ks:"¤#,##0.00","ks-Arab":"¤#,##0.00","ks-Deva":"¤ #,##0.00",ksb:"#,##0.00¤",ksf:"#,##0.00 ¤",ksh:"#,##0.00 ¤",ku:"#,##0.00 ¤;(#,##0.00 ¤)",kw:"¤#,##0.00",ky:"#,##0.00 ¤",lag:"¤ #,##0.00",lb:"#,##0.00 ¤",lg:"#,##0.00¤",lkt:"¤ #,##0.00",ln:"#,##0.00 ¤","ln-AO":"#,##0.00 ¤","ln-CF":"#,##0.00 ¤","ln-CG":"#,##0.00 ¤",lo:"¤#,##0.00;¤-#,##0.00",lrc:"¤ #,##0.00","lrc-IQ":"¤ #,##0.00",lt:"#,##0.00 ¤",lu:"#,##0.00¤",luo:"#,##0.00¤",luy:"¤#,##0.00;¤- #,##0.00",lv:"#,##0.00 ¤",mai:"¤ #,##0.00",mas:"¤#,##0.00;(¤#,##0.00)","mas-TZ":"¤#,##0.00;(¤#,##0.00)",mer:"¤#,##0.00;(¤#,##0.00)",mfe:"¤ #,##0.00",mg:"¤#,##0.00",mgh:"¤ #,##0.00",mgo:"¤ #,##0.00",mi:"¤ #,##0.00",mk:"#,##0.00 ¤",ml:"¤#,##0.00;(¤#,##0.00)",mn:"¤ #,##0.00",mni:"¤ #,##0.00","mni-Beng":"¤ #,##0.00",mr:"¤#,##0.00;(¤#,##0.00)",ms:"¤#,##0.00;(¤#,##0.00)","ms-BN":"¤#,##0.00;(¤#,##0.00)","ms-ID":"¤#,##0.00","ms-SG":"¤#,##0.00;(¤#,##0.00)",mt:"¤#,##0.00",mua:"¤#,##0.00;(¤#,##0.00)",my:"¤ #,##0.00",mzn:"¤ #,##0.00",naq:"¤#,##0.00",nb:"¤ #,##0.00;(¤ #,##0.00)","nb-SJ":"¤ #,##0.00;(¤ #,##0.00)",nd:"¤#,##0.00;(¤#,##0.00)",nds:"¤ #,##0.00","nds-NL":"¤ #,##0.00",ne:"¤ #,##,##0.00","ne-IN":"¤ #,##,##0.00",nl:"¤ #,##0.00;(¤ #,##0.00)","nl-AW":"¤ #,##0.00;(¤ #,##0.00)","nl-BE":"¤ #,##0.00;(¤ #,##0.00)","nl-BQ":"¤ #,##0.00;(¤ #,##0.00)","nl-CW":"¤ #,##0.00;(¤ #,##0.00)","nl-SR":"¤ #,##0.00;(¤ #,##0.00)","nl-SX":"¤ #,##0.00;(¤ #,##0.00)",nmg:"#,##0.00 ¤",nn:"#,##0.00 ¤",nnh:"¤ #,##0.00",no:"¤ #,##0.00;(¤ #,##0.00)",nus:"¤#,##0.00;(¤#,##0.00)",nyn:"¤#,##0.00",om:"¤#,##0.00","om-KE":"¤#,##0.00",or:"¤#,##0.00;(¤#,##0.00)",os:"¤ #,##0.00","os-RU":"¤ #,##0.00",pa:"¤ #,##0.00","pa-Arab":"¤ #,##0.00","pa-Guru":"¤ #,##0.00",pcm:"¤#,##0.00",pl:"#,##0.00 ¤;(#,##0.00 ¤)",ps:"¤#,##0.00;(¤#,##0.00)","ps-PK":"¤#,##0.00;(¤#,##0.00)",pt:"¤ #,##0.00","pt-AO":"#,##0.00 ¤;(#,##0.00 ¤)","pt-CH":"#,##0.00 ¤;(#,##0.00 ¤)","pt-CV":"#,##0.00 ¤;(#,##0.00 ¤)","pt-GQ":"#,##0.00 ¤;(#,##0.00 ¤)","pt-GW":"#,##0.00 ¤;(#,##0.00 ¤)","pt-LU":"#,##0.00 ¤;(#,##0.00 ¤)","pt-MO":"#,##0.00 ¤;(#,##0.00 ¤)","pt-MZ":"#,##0.00 ¤;(#,##0.00 ¤)","pt-PT":"#,##0.00 ¤;(#,##0.00 ¤)","pt-ST":"#,##0.00 ¤;(#,##0.00 ¤)","pt-TL":"#,##0.00 ¤;(#,##0.00 ¤)",qu:"¤ #,##0.00","qu-BO":"¤ #,##0.00","qu-EC":"¤ #,##0.00",rm:"#,##0.00 ¤",rn:"#,##0.00¤",ro:"#,##0.00 ¤;(#,##0.00 ¤)","ro-MD":"#,##0.00 ¤;(#,##0.00 ¤)",rof:"¤#,##0.00",ru:"#,##0.00 ¤","ru-BY":"#,##0.00 ¤","ru-KG":"#,##0.00 ¤","ru-KZ":"#,##0.00 ¤","ru-MD":"#,##0.00 ¤","ru-UA":"#,##0.00 ¤",rw:"¤ #,##0.00",rwk:"#,##0.00¤",sa:"¤ #,##0.00",sah:"#,##0.00 ¤",saq:"¤#,##0.00;(¤#,##0.00)",sat:"¤ #,##0.00","sat-Olck":"¤ #,##0.00",sbp:"#,##0.00¤",sc:"#,##0.00 ¤",sd:"¤ #,##0.00","sd-Arab":"¤ #,##0.00","sd-Deva":"¤ #,##0.00",se:"#,##0.00 ¤","se-FI":"#,##0.00 ¤","se-SE":"#,##0.00 ¤",seh:"#,##0.00¤",ses:"#,##0.00¤",sg:"¤#,##0.00;¤-#,##0.00",shi:"#,##0.00¤","shi-Latn":"#,##0.00¤","shi-Tfng":"#,##0.00¤",si:"¤#,##0.00;(¤#,##0.00)",sk:"#,##0.00 ¤;(#,##0.00 ¤)",sl:"#,##0.00 ¤;(#,##0.00 ¤)",smn:"#,##0.00 ¤",sn:"¤#,##0.00;(¤#,##0.00)",so:"¤#,##0.00;(¤#,##0.00)","so-DJ":"¤#,##0.00;(¤#,##0.00)","so-ET":"¤#,##0.00;(¤#,##0.00)","so-KE":"¤#,##0.00;(¤#,##0.00)",sq:"#,##0.00 ¤;(#,##0.00 ¤)","sq-MK":"#,##0.00 ¤;(#,##0.00 ¤)","sq-XK":"#,##0.00 ¤;(#,##0.00 ¤)",sr:"#,##0.00 ¤;(#,##0.00 ¤)","sr-Cyrl":"#,##0.00 ¤;(#,##0.00 ¤)","sr-Cyrl-BA":"#,##0.00 ¤;(#,##0.00 ¤)","sr-Cyrl-ME":"#,##0.00 ¤;(#,##0.00 ¤)","sr-Cyrl-XK":"#,##0.00 ¤;(#,##0.00 ¤)","sr-Latn":"#,##0.00 ¤;(#,##0.00 ¤)","sr-Latn-BA":"#,##0.00 ¤;(#,##0.00 ¤)","sr-Latn-ME":"#,##0.00 ¤;(#,##0.00 ¤)","sr-Latn-XK":"#,##0.00 ¤;(#,##0.00 ¤)",su:"¤#,##0.00","su-Latn":"¤#,##0.00",sv:"#,##0.00 ¤","sv-AX":"#,##0.00 ¤","sv-FI":"#,##0.00 ¤",sw:"¤ #,##0.00","sw-CD":"¤ #,##0.00","sw-KE":"¤ #,##0.00","sw-UG":"¤ #,##0.00",ta:"¤#,##0.00;(¤#,##0.00)","ta-LK":"¤#,##0.00;(¤#,##0.00)","ta-MY":"¤#,##0.00;(¤#,##0.00)","ta-SG":"¤#,##0.00;(¤#,##0.00)",te:"¤#,##0.00;(¤#,##0.00)",teo:"¤#,##0.00;(¤#,##0.00)","teo-KE":"¤#,##0.00;(¤#,##0.00)",tg:"#,##0.00 ¤",th:"¤#,##0.00;(¤#,##0.00)",ti:"¤#,##0.00","ti-ER":"¤#,##0.00",tk:"#,##0.00 ¤",to:"¤ #,##0.00",tr:"¤#,##0.00;(¤#,##0.00)","tr-CY":"¤#,##0.00;(¤#,##0.00)",tt:"#,##0.00 ¤",twq:"#,##0.00¤",tzm:"#,##0.00 ¤",ug:"¤#,##0.00;(¤#,##0.00)",uk:"#,##0.00 ¤",und:"¤ #,##0.00",ur:"¤#,##0.00;(¤#,##0.00)","ur-IN":"¤#,##0.00;(¤#,##0.00)",uz:"#,##0.00 ¤","uz-Arab":"¤ #,##0.00","uz-Cyrl":"#,##0.00 ¤","uz-Latn":"#,##0.00 ¤",vai:"¤#,##0.00;(¤#,##0.00)","vai-Latn":"¤#,##0.00;(¤#,##0.00)","vai-Vaii":"¤#,##0.00;(¤#,##0.00)",vi:"#,##0.00 ¤",vun:"¤#,##0.00",wae:"¤ #,##0.00",wo:"¤ #,##0.00",xh:"¤#,##0.00",xog:"#,##0.00 ¤",yav:"#,##0.00 ¤;(#,##0.00 ¤)",yi:"¤ #,##0.00",yo:"¤#,##0.00;(¤#,##0.00)","yo-BJ":"¤#,##0.00;(¤#,##0.00)",yrl:"¤ #,##0.00","yrl-CO":"¤ #,##0.00","yrl-VE":"¤ #,##0.00",yue:"¤#,##0.00;(¤#,##0.00)","yue-Hans":"¤#,##0.00;(¤#,##0.00)","yue-Hant":"¤#,##0.00;(¤#,##0.00)",zgh:"#,##0.00¤",zh:"¤#,##0.00;(¤#,##0.00)","zh-Hans":"¤#,##0.00;(¤#,##0.00)","zh-Hans-HK":"¤#,##0.00;(¤#,##0.00)","zh-Hans-MO":"¤#,##0.00;(¤#,##0.00)","zh-Hans-SG":"¤#,##0.00;(¤#,##0.00)","zh-Hant":"¤#,##0.00;(¤#,##0.00)","zh-Hant-HK":"¤#,##0.00;(¤#,##0.00)","zh-Hant-MO":"¤#,##0.00;(¤#,##0.00)",zu:"¤#,##0.00;(¤#,##0.00)"};const ete=["standard","accounting"],tte=/([^\s0]+)?(\s*)0*[.,]*0*(\s*)([^\s0]+)?/,rte={},ite=e=>{const t=Qee.locale()+"/"+JSON.stringify(e);return rte[t]||(rte[t]=new Intl.NumberFormat(Qee.locale(),e).format),rte[t]};var nte={engine:function(){return"intl"},_formatNumberCore:function(e,t,r){return"exponential"===t?this.callBase.apply(this,arguments):ite(this._normalizeFormatConfig(t,r,e))(e)},_normalizeFormatConfig:function(e,t,r){let i;if("decimal"===e){const e=String(r).split(".")[1];i={minimumIntegerDigits:t.precision||void 0,useGrouping:!1,maximumFractionDigits:e&&e.length,round:r<0?"ceil":"floor"}}else i=this._getPrecisionConfig(t.precision);if("percent"===e)i.style="percent";else if("currency"===e){const e=t.useCurrencyAccountingStyle??Mee().defaultUseCurrencyAccountingStyle;i.style="currency",i.currency=t.currency||Mee().defaultCurrency,i.currencySign=ete[+e]}return i},_getPrecisionConfig:function(e){let t;return t=null===e?{minimumFractionDigits:0,maximumFractionDigits:20}:{minimumFractionDigits:e||0,maximumFractionDigits:e||0},t},format:function(e,t){return"number"!=typeof e?e:("default"===(t=this._normalizeFormat(t)).currency&&(t.currency=Mee().defaultCurrency),t&&("function"==typeof t||t.type||t.formatter)?this.callBase.apply(this,arguments):ite(t)(e))},_getCurrencySymbolInfo:function(e){const t=(e=>new Intl.NumberFormat(Qee.locale(),{style:"currency",currency:e}))(e);return this._extractCurrencySymbolInfo(t.format(0))},_extractCurrencySymbolInfo:function(e){const t=tte.exec(e)||[];return{position:t[1]?"before":"after",symbol:t[1]||t[4]||"",delimiter:t[2]||t[3]||""}},getCurrencySymbol:function(e){e||(e=Mee().defaultCurrency);return{symbol:this._getCurrencySymbolInfo(e).symbol}},getOpenXmlCurrencyFormat:function(e){const t=e||Mee().defaultCurrency;return((e,t)=>{if(!t)return;let r=e;if("string"==typeof e){r="";for(let t=0;t<e.length;t++)"$"!==e[t]&&(r+="\\"),r+=e[t]}const i={".00":"{0}","'":"\\'","\\(":"\\(","\\)":"\\)"," ":"\\ ",'"':"&quot;","\\¤":r},n=t.split(";");for(let e=0;e<n.length;e++)for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[e]=n[e].replace(new RegExp(t,"g"),i[t]));return 2===n.length?n[0]+"_);"+n[1]:n[0]})(this._getCurrencySymbolInfo(t).symbol,Qee.getValueByClosestLocale((e=>Zee[e])))}};const ote="undefined"!=typeof Intl,ate=["currency","fixedpoint","exponential","percent","decimal"],ste={1:"K",2:"M",3:"B",4:"T"},lte={largenumber:"auto",thousands:1,millions:2,billions:3,trillions:4},dte=See({engine:function(){return"base"},numericFormats:ate,defaultLargeNumberFormatPostfixes:ste,_parseNumberFormatString:function(e){const t={};if(!e||"string"!=typeof e)return;const r=e.toLowerCase().split(" ");return Cee(r,((e,r)=>{ate.includes(r)?t.formatType=r:r in lte&&(t.power=lte[r])})),t.power&&!t.formatType&&(t.formatType="fixedpoint"),t.formatType?t:void 0},_calculateNumberPower:function(e,t,r,i){let n=Math.abs(e),o=0;if(n>1)for(;n&&n>=t&&(void 0===i||o<i);)o++,n/=t;else if(n>0&&n<1)for(;n<1&&(void 0===r||o>r);)o--,n*=t;return o},_getNumberByPower:function(e,t,r){let i=e;for(;t>0;)i/=r,t--;for(;t<0;)i*=r,t++;return i},_formatNumber:function(e,t,r){"auto"===t.power&&(t.power=this._calculateNumberPower(e,1e3,0,4)),t.power&&(e=this._getNumberByPower(e,t.power,1e3));const i=this.defaultLargeNumberFormatPostfixes[t.power]||"";let n=this._formatNumberCore(e,t.formatType,r);return n=n.replace(/(\d|.$)(\D*)$/,"$1"+i+"$2"),n},_formatNumberExponential:function(e,t){let r=this._calculateNumberPower(e,10),i=this._getNumberByPower(e,r,10);void 0===t.precision&&(t.precision=1),i.toFixed(t.precision||0)>=10&&(r++,i/=10);const n=(r>=0?"+":"")+r.toString();return this._formatNumberCore(i,"fixedpoint",t)+"E"+n},_addZeroes:function(e,t){const r=Math.pow(10,t),i=e<0?"-":"";let n=(e=(Math.abs(e)*r>>>0)/r).toString();for(;n.length<t;)n="0"+n;return i+n},_addGroupSeparators:function(e){const t=e.toString().split(".");return t[0].replace(/\B(?=(\d{3})+(?!\d))/g,Eee().thousandsSeparator)+(t[1]?Eee().decimalSeparator+t[1]:"")},_formatNumberCore:function(e,t,r){return"exponential"===t?this._formatNumberExponential(e,r):("decimal"!==t&&null!==r.precision&&(r.precision=r.precision||0),"percent"===t&&(e*=100),void 0!==r.precision&&(e="decimal"===t?this._addZeroes(e,r.precision):null===r.precision?e.toPrecision():Hee(e,r.precision)),e="decimal"!==t?this._addGroupSeparators(e):e.toString().replace(".",Eee().decimalSeparator),"percent"===t&&(e+="%"),e)},_normalizeFormat:function(e){return e?("function"==typeof e||Y9(e)||(e={type:e}),e):{}},_getSeparators:function(){return{decimalSeparator:this.getDecimalSeparator(),thousandsSeparator:this.getThousandsSeparator()}},getThousandsSeparator:function(){return this.format(1e4,"fixedPoint")[2]},getDecimalSeparator:function(){return this.format(1.2,{type:"fixedPoint",precision:1})[1]},convertDigits:function(e,t){const r=this.format(90,"decimal");if("string"!=typeof e||"0"===r[1])return e;const i=t?r[1]:"0",n=t?"0":r[1],o=t?r[0]:"9",a=new RegExp("["+i+"-"+o+"]","g");return e.replace(a,(e=>String.fromCharCode(e.charCodeAt(0)+(n.charCodeAt(0)-i.charCodeAt(0)))))},getNegativeEtalonRegExp:function(e){const t=this._getSeparators(),r=new RegExp("[0-9"+Oee(t.decimalSeparator+t.thousandsSeparator)+"]+","g");let i=this.format(-1,e).replace(r,"1");return["\\","(",")","[","]","*","+","$","^","?","|","{","}"].forEach((e=>{i=i.replace(new RegExp(`\\${e}`,"g"),`\\${e}`)})),i=i.replace(/ /g,"\\s"),i=i.replace(/1/g,".*"),new RegExp(i,"g")},getSign:function(e,t){if(!t)return"-"===e.replace(/[^0-9-]/g,"").charAt(0)?-1:1;const r=this.getNegativeEtalonRegExp(t);return e.match(r)?-1:1},format:function(e,t){if("number"!=typeof e)return e;if("number"==typeof t)return e;if("function"==typeof(t=t&&t.formatter||t))return t(e);(t=this._normalizeFormat(t)).type||(t.type="decimal");const r=this._parseNumberFormatString(t.type);if(!r){const r=this._getSeparators();return r.unlimitedIntegerDigits=t.unlimitedIntegerDigits,this.convertDigits(qee(t.type,r)(e))}return this._formatNumber(e,r,t)},parse:function(e,t){if(!e)return;if(t&&t.parser)return t.parser(e);e=this.convertDigits(e,!0),t&&"string"!=typeof t&&cee.log("W0011");const r=this.getDecimalSeparator(),i=new RegExp("[^0-9"+Oee(r)+"]","g"),n=e.replace(i,"").replace(r,".").replace(/\.$/g,"");if("."===n||""===n)return null;if(this._calcSignificantDigits(n)>15)return NaN;let o=+n*this.getSign(e,t);t=this._normalizeFormat(t);const a=this._parseNumberFormatString(t.type);let s=null==a?void 0:a.power;if(s){if("auto"===s){const t=e.match(/\d(K|M|B|T)/);t&&(s=Object.keys(ste).find((e=>ste[e]===t[1])))}o*=Math.pow(10,3*s)}return"percent"===(null==a?void 0:a.formatType)&&(o/=100),o},_calcSignificantDigits:function(e){const[t,r]=e.split("."),i=e=>{let t=-1;for(let r=0;r<e.length;r++)if("0"!==e[r]){t=r;break}return t>-1?e.length-t:0};let n=0;return t&&(n+=i(t.split(""))),r&&(n+=i(r.split("").reverse())),n}});dte.inject($ee),ote&&dte.inject(nte);var cte=dte;const hte=" .,:;/\\<>()-[]،",ute=function(e){const t=e&&cte.convertDigits(e,!1).charCodeAt(0),r=cte.convertDigits("0",!1).charCodeAt(0);return r<=t&&t<r+10},pte=function(e,t,r,i){const n=e[r],o=e[r+1];if(!i){if("."===n||" "===n&&". m."===e.slice(r-1,r+3))return!0;if("-"===n&&!ute(o))return!0}const a=i&&t.some((t=>e[r]!==t[r]));return hte.indexOf(n)<0&&i===ute(n)&&(!i||a)},gte=function(e,t){if(!ute(e[t]))for(;t>0&&!ute(e[t-1])&&("."===e[t-1]||hte.indexOf(e[t-1])<0);)t--;return t},mte=function(e,t){return Array.isArray(e)?e.map((function(e){return(t(e)||"").toString()})):(t(e)||"").toString()},fte=/[a-zA-Z]/g,bte=function(e){const t=[],r=mte(new Date(2009,8,8,6,5,4),e),i=r.split("").map((function(e,t){return t}));let n=r;const o={},a=[{date:new Date(2009,8,8,6,5,4,111),pattern:"S"},{date:new Date(2009,8,8,6,5,2),pattern:"s"},{date:new Date(2009,8,8,6,2,4),pattern:"m"},{date:new Date(2009,8,8,18,5,4),pattern:"H",isDigit:!0},{date:new Date(2009,8,8,2,5,4),pattern:"h",isDigit:!0},{date:new Date(2009,8,8,18,5,4),pattern:"a",isDigit:!1},{date:new Date(2009,8,1,6,5,4),pattern:"d"},{date:[new Date(2009,8,2,6,5,4),new Date(2009,8,3,6,5,4),new Date(2009,8,4,6,5,4)],pattern:"E"},{date:new Date(2009,9,6,6,5,4),pattern:"M"},{date:new Date(1998,8,8,6,5,4),pattern:"y"}];if(n)return a.forEach((function(a){const s=function(e,t,r,i){let n=0;const o=[],a=function(t){return e[n]!==t[n]&&(void 0===i||ute(e[n])===i)};for(Array.isArray(t)||(t=[t]),n=0;n<e.length;n++)if(r.indexOf(n)<0&&t.filter(a).length){n=gte(e,n);do{if(i=ute(e[n]),!o.length&&!i&&ute(t[0][n]))break;o.push(n),r.unshift(n),n++}while(e[n]&&pte(e,t,n,i));break}return 1!==o.length||"0"!==e[r[0]-1]&&"٠"!==e[r[0]-1]||r.unshift(r[0]-1),o}(r,mte(a.date,e),t,a.isDigit),l="M"!==a.pattern||o.d?a.pattern:"L";n=function(e,t,r,i){let n,o,a;if(!ute(e[t[0]]||"0")){const s=Math.max(t.length<=3?3:4,r.length);for(;t.length>s;){for(o=t.pop(),a=i[o],i[o]=-1,n=o+1;n<i.length;n++)i[n]--;e=e.substr(0,a)+e.substr(a+1)}for(o=t[t.length-1]+1,a=o<i.length?i[o]:o;t.length<s;){for(t.push(t[t.length-1]+1),n=o;n<i.length;n++)i[n]++;e=e.substr(0,a)+" "+e.substr(a)}}return e=function(e,t,r,i){const n=t[0],o=n<i.length?i[n]:n;return t.forEach((function(t,i){e=e.substr(0,o+i)+(r.length>1?r[i]:r)+e.substr(o+i+1)})),1===t.length&&(e=(e=e.replace("0"+r,r+r)).replace("٠"+r,r+r)),e}(e,t,r,i),e}(n,s,l,i),o[l]=s.length})),n=function(e,t,r,i){const n=t.split("").map((function(e,t){return r.indexOf(t)<0&&(e.match(fte)||"'"===e)?i[t]:-1}));return e.split("").map((function(e,t){let r=e;const i=n.indexOf(t)>=0,o=t>0&&n.indexOf(t-1)>=0,a=n.indexOf(t+1)>=0;return i&&(o||(r="'"+r),a||(r+="'")),r})).join("")}(n,r,t,i),t.length?n:void 0},Cte={3:"abbreviated",4:"wide",5:"narrow"},Ste=function(e,t){return e>2?Object.keys(Cte).map((function(e){return["format","standalone"].map((function(r){return t.getMonthNames(Cte[e],r).join("|")})).join("|")})).join("|"):2===e?"1[012]|0?[1-9]":"0??[1-9]|1[012]"},Ite={":":function(e,t){const r=e>1?`{${e}}`:"";let i=Oee(t.getTimeSeparator());return":"!==i&&(i=`${i}|:`),`${i}${r}`},y:function(e){return 2===e?`[0-9]{${e}}`:"[0-9]+?"},M:Ste,L:Ste,Q:function(e,t){return e>2?t.getQuarterNames(Cte[e],"format").join("|"):"0?[1-4]"},E:function(e,t){return"\\D*"},a:function(e,t){return t.getPeriodNames(Cte[e<3?3:e],"format").join("|")},d:function(e){return 2===e?"3[01]|[12][0-9]|0?[1-9]":"0??[1-9]|[12][0-9]|3[01]"},H:function(e){return 2===e?"2[0-3]|1[0-9]|0?[0-9]":"0??[0-9]|1[0-9]|2[0-3]"},h:function(e){return 2===e?"1[012]|0?[1-9]":"0??[1-9]|1[012]"},m:function(e){return 2===e?"[1-5][0-9]|0?[0-9]":"0??[0-9]|[1-5][0-9]"},s:function(e){return 2===e?"[1-5][0-9]|0?[0-9]":"0??[0-9]|[1-5][0-9]"},S:function(e){return`[0-9]{1,${e}}`},w:function(e){return 2===e?"[1-5][0-9]|0?[0-9]":"0??[0-9]|[1-5][0-9]"},x:function(e){return 3===e?"[+-](?:2[0-3]|[01][0-9]):(?:[0-5][0-9])|Z":"[+-](?:2[0-3]|[01][0-9])(?:[0-5][0-9])|Z"}},Pte=Number,wte=function(e,t){return e.map((e=>e.toLowerCase())).indexOf(t.toLowerCase())},yte=function(e,t,r){return t>2?["format","standalone"].map((function(t){return Object.keys(Cte).map((function(i){const n=r.getMonthNames(Cte[i],t);return wte(n,e)}))})).reduce((function(e,t){return e.concat(t)})).filter((function(e){return e>=0}))[0]:Pte(e)-1},xte={y:function(e,t){const r=Pte(e);return 2===t?r<30?2e3+r:1900+r:r},M:yte,L:yte,Q:function(e,t,r){return t>2?r.getQuarterNames(Cte[t],"format").indexOf(e):Pte(e)-1},E:function(e,t,r){const i=r.getDayNames(Cte[t<3?3:t],"format");return wte(i,e)},a:function(e,t,r){const i=r.getPeriodNames(Cte[t<3?3:t],"format");return wte(i,e)},d:Pte,H:Pte,h:Pte,m:Pte,s:Pte,S:function(e,t){for(t=Math.max(t,3),e=e.slice(0,3);t<3;)e+="0",t++;return Pte(e)}},Tte=["y","M","d","h","m","s","S"],vte={y:"setFullYear",M:"setMonth",L:"setMonth",a:function(e,t,r){let i=e.getHours();const n=r.h;void 0!==n&&n!==i&&i--,t||12!==i?t&&12!==i&&(i+=12):i=0,e.setHours(i)},d:"setDate",H:"setHours",h:"setHours",m:"setMinutes",s:"setSeconds",S:"setMilliseconds"},Mte=function(e,t){const r=e[t];if(!r)return 0;let i=0;do{t++,i++}while(e[t]===r);return i},Ete=function(e,t){let r="";for(let i=0;i<t;i++)r+=e;return r},Dte=["d","H","h","m","s","w","M","L","Q"],Fte=function(e){const t=e=>{if(!e)return!1;const t=e[0];return["y","S"].includes(t)||Dte.includes(t)&&e.length<3};let r=!0,i=0;return e.every(((e,n,o)=>(t(e)&&((e=>"S"!==e[0]&&2!==e.length)(e)&&(r=++i<2),t(o[n+1])||(i=0)),r)))},Rte=function(e,t){const r=function(e,t){let r,i="",n="";const o=[],a=function(){n&&(o.push(`'${n}'`),i+=`${Oee(n)})`,n="")};for(let s=0;s<e.length;s++){const l=e[s],d=Ite[l];if("'"!==l||(r=!r,"'"===e[s-1]))if(d&&!r){const r=Mte(e,s),n=Ete(l,r);a(),o.push(n),i+=`(${d(r,t)})`,s+=r-1}else n||(i+="("),n+=l}return a(),Fte(o)||oee.warn(`The following format may be parsed incorrectly: ${e}.`),{patterns:o,regexp:new RegExp(`^${i}$`,"i")}}(e,t);return function(e){const i=r.regexp.exec(e);if(i){const e=new Date,n=new Date(e.getFullYear(),0,1),o=r.patterns.map((function(e){return"'"===e[0]?"":"H"===e[0]?"h":e[0]})),a=function(e){const t=e.map((function(e){return Tte.indexOf(e)}));return Math.max.apply(Math,t)}(o),s=function(e){const t=e.filter((function(e){return Tte.indexOf(e)<0}));return Tte.concat(t)}(o),l={};return s.forEach((function(s,d){if(!s||d<Tte.length&&d>a)return;const c=o.indexOf(s);if(c>=0){const e=r.patterns[c],o=i[c+1];!function(e,t,r,i,n){const o=t[0],a=vte[o],s=xte[o];if(a&&s){const o=s(r,t.length,i);n[t]=o,e[a]?e[a](o):a(e,o,n)}}(n,e,o,t,l)}else!function(e,t,r){const i=vte[t],n=r["g"+i.substr(1)]();e[i](n)}(n,s,e)})),n}return null}},Lte=["January","February","March","April","May","June","July","August","September","October","November","December"],Bte=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ate=["AM","PM"],Nte=["Q1","Q2","Q3","Q4"],kte=(e,t)=>{const r={abbreviated:3,short:2,narrow:1};return((e,t)=>{if(Array.isArray(e))return e.map(t);const r=[];for(const i in e)r.push(t(e[i],i));return r})(e,(e=>e.substr(0,r[t])))};var Ote=function(e){return kte(Lte,e)},_te=function(e){return kte(Bte,e)},Ute=function(e){return Nte},Hte=function(e){return Ate},Vte={"af-NA":1,agq:1,ak:1,ar:6,"ar-EH":1,"ar-ER":1,"ar-KM":1,"ar-LB":1,"ar-MA":1,"ar-MR":1,"ar-PS":1,"ar-SO":1,"ar-SS":1,"ar-TD":1,"ar-TN":1,asa:1,ast:1,az:1,"az-Cyrl":1,bas:1,be:1,bem:1,bez:1,bg:1,bm:1,br:1,bs:1,"bs-Cyrl":1,ca:1,ce:1,cgg:1,ckb:6,cs:1,cy:1,da:1,de:1,dje:1,dsb:1,dua:1,dyo:1,ee:1,el:1,"en-001":1,"en-AE":6,"en-BI":1,"en-MP":1,"en-MV":5,"en-SD":6,eo:1,es:1,et:1,eu:1,ewo:1,fa:6,ff:1,"ff-Adlm":1,fi:1,fo:1,fr:1,"fr-DJ":6,"fr-DZ":6,"fr-SY":6,fur:1,fy:1,ga:1,gd:1,gl:1,gsw:1,gv:1,ha:1,hr:1,hsb:1,hu:1,hy:1,ia:1,ig:1,is:1,it:1,jgo:1,jmc:1,ka:1,kab:6,kde:1,kea:1,khq:1,kk:1,kkj:1,kl:1,"ko-KP":1,ksb:1,ksf:1,ksh:1,ku:1,kw:1,ky:1,lag:1,lb:1,lg:1,ln:1,lrc:6,lt:1,lu:1,lv:1,"mas-TZ":1,mfe:1,mg:1,mgo:1,mi:1,mk:1,mn:1,ms:1,mua:1,mzn:6,naq:1,nds:1,nl:1,nmg:1,nnh:1,no:1,nus:1,nyn:1,os:1,pcm:1,pl:1,ps:6,"pt-AO":1,"pt-CH":1,"pt-CV":1,"pt-GQ":1,"pt-GW":1,"pt-LU":1,"pt-ST":1,"pt-TL":1,"qu-BO":1,"qu-EC":1,rm:1,rn:1,ro:1,rof:1,ru:1,rw:1,rwk:1,sah:1,sbp:1,sc:1,se:1,ses:1,sg:1,shi:1,"shi-Latn":1,si:1,sk:1,sl:1,smn:1,so:1,"so-DJ":6,sq:1,sr:1,"sr-Latn":1,sv:1,sw:1,"ta-LK":1,"ta-MY":1,teo:1,tg:1,"ti-ER":1,tk:1,to:1,tr:1,tt:1,twq:1,tzm:1,uk:1,uz:1,"uz-Arab":6,"uz-Cyrl":1,vai:1,"vai-Latn":1,vi:1,vun:1,wae:1,wo:1,xog:1,yav:1,yi:1,yo:1,zgh:1};const Wte=/[\u200E\u200F]/g,zte=/[\u202F]/g,jte=e=>t=>{if(!e.timeZoneName){const r=t.getFullYear(),i=String(r).length<3,n=i?r+400:r,o=new Date(Date.UTC(n,t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));i&&o.setFullYear(r);return Kte(o,tee({timeZone:"UTC"},e))}return Kte(t,e)},Xte={},Gte=e=>{const t=Qee.locale()+"/"+JSON.stringify(e);return Xte[t]||(Xte[t]=new Intl.DateTimeFormat(Qee.locale(),e).format),Xte[t]};function Kte(e,t){return Gte(t)(e).replace(Wte,"").replace(zte," ")}const qte=e=>new Intl.NumberFormat(Qee.locale()).format(e),$te=(()=>{const e={};return t=>{if(!(t in e)){if("0"===qte(0))return e[t]=!1,!1;e[t]={};for(let r=0;r<10;++r)e[t][qte(r)]=r}return e[t]}})(),Jte=e=>{const t=$te(Qee.locale());return t?e.split("").map((e=>e in t?String(t[e]):e)).join(""):e},Yte=e=>e.replace(/(\D)0+(\d)/g,"$1$2"),Qte=e=>e.replace("d’","de "),Zte={day:{day:"numeric"},date:{year:"numeric",month:"long",day:"numeric"},dayofweek:{weekday:"long"},longdate:{weekday:"long",year:"numeric",month:"long",day:"numeric"},longdatelongtime:{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},longtime:{hour:"numeric",minute:"numeric",second:"numeric"},month:{month:"long"},monthandday:{month:"long",day:"numeric"},monthandyear:{year:"numeric",month:"long"},shortdate:{},shorttime:{hour:"numeric",minute:"numeric"},shortyear:{year:"2-digit"},year:{year:"numeric"}};Object.defineProperty(Zte,"shortdateshorttime",{get:function(){const e=Intl.DateTimeFormat(Qee.locale()).resolvedOptions();return{year:e.year,month:e.month,day:e.day,hour:"numeric",minute:"numeric"}}});const ere={standalone:function(e,t){const r=new Date(1999,e,13,1);return jte({month:t})(r)},format:function(e,t){const r=new Date(0,e,13,1),i=Qte(jte({day:"numeric",month:t})(r)).split(" ").filter((e=>e.indexOf("13")<0));return 1===i.length?i[0]:2===i.length?i[0].length>i[1].length?i[0]:i[1]:ere.standalone(e,t)}};var tre={engine:function(){return"intl"},getMonthNames:function(e,t){const r={wide:"long",abbreviated:"short",narrow:"narrow"}[e||"wide"];return t="format"===t?t:"standalone",Array.apply(null,new Array(12)).map(((e,i)=>ere[t](i,r)))},getDayNames:function(e){const t=(e=>Array.apply(null,new Array(7)).map(((t,r)=>jte({weekday:e})(new Date(0,0,r)))))({wide:"long",abbreviated:"short",short:"narrow",narrow:"narrow"}[e||"wide"]);return t},getPeriodNames:function(){const e=jte({hour:"numeric",hour12:!0});return[1,13].map((t=>{const r=qte(1),i=e(new Date(0,0,1,t)).split(r);if(2!==i.length)return"";return(i[0].length>i[1].length?i[0]:i[1]).trim()}))},format:function(e,t){if(!e)return;if(!t)return e;"function"==typeof t||t.formatter||(t=t.type||t);const r=(e=>"string"==typeof e&&Zte[e.toLowerCase()])(t);if(r)return jte(r)(e);const i=typeof t;return t.formatter||"function"===i||"string"===i?this.callBase.apply(this,arguments):jte(t)(e)},parse:function(e,t){let r;return t&&!t.parser&&"string"==typeof e&&(e=Qte(e),r=e=>Qte(this.format(e,t))),this.callBase(e,r||t)},_parseDateBySimpleFormat:function(e,t){e=Jte(e);const r=this.getFormatParts(t),i=e.split(/\D+/).filter((e=>e.length>0));if(r.length!==i.length)return;const n=this._generateDateArgs(r,i),o=r=>{const i=((e,t)=>{const r=t?12:0;return new Date(e.year,e.month,e.day,(e.hours+r)%24,e.minutes,e.seconds)})(n,r);if(o=Jte(this.format(i,t)),a=e,Yte(o)===Yte(a))return i;var o,a};return o(!1)||o(!0)},_generateDateArgs:function(e,t){const r=new Date,i={year:r.getFullYear(),month:r.getMonth(),day:r.getDate(),hours:0,minutes:0,seconds:0};return e.forEach(((e,r)=>{const n=t[r];let o=parseInt(n,10);"month"===e&&(o-=1),i[e]=o})),i},formatUsesMonthName:function(e){return"object"!=typeof e||e.type||e.format?this.callBase.apply(this,arguments):"long"===e.month},formatUsesDayName:function(e){return"object"!=typeof e||e.type||e.format?this.callBase.apply(this,arguments):"long"===e.weekday},getTimeSeparator:function(){return Jte(Kte(new Date(2001,1,1,11,11),{hour:"numeric",minute:"numeric",hour12:!1})).replace(/\d/g,"")},getFormatParts:function(e){if("string"==typeof e)return this.callBase(e);const t=tee({},Zte[e.toLowerCase()]),r=new Date(2001,2,4,5,6,7);let i=jte(t)(r);return i=Jte(i),[{name:"year",value:1},{name:"month",value:3},{name:"day",value:4},{name:"hours",value:5},{name:"minutes",value:6},{name:"seconds",value:7}].map((e=>({name:e.name,index:i.indexOf(e.value)}))).filter((e=>e.index>-1)).sort(((e,t)=>e.index-t.index)).map((e=>e.name))}};const rre="undefined"!=typeof Intl,ire={shortdate:"M/d/y",shorttime:"h:mm a",longdate:"EEEE, MMMM d, y",longtime:"h:mm:ss a",monthandday:"MMMM d",monthandyear:"MMMM y",quarterandyear:"QQQ y",day:"d",year:"y",shortdateshorttime:"M/d/y, h:mm a",longdatelongtime:"EEEE, MMMM d, y, h:mm:ss a",month:"LLLL",shortyear:"yy",dayofweek:"EEEE",quarter:"QQQ",hour:"HH",minute:"mm",second:"ss",millisecond:"SSS","datetime-local":"yyyy-MM-ddTHH':'mm':'ss"},nre={year:["y","yy","yyyy"],day:["d","dd"],month:["M","MM","MMM","MMMM"],hours:["H","HH","h","hh","ah"],minutes:["m","mm"],seconds:["s","ss"],milliseconds:["S","SS","SSS"]},ore=See({engine:function(){return"base"},_getPatternByFormat:function(e){return ire[e.toLowerCase()]},_expandPattern:function(e){return this._getPatternByFormat(e)||e},formatUsesMonthName:function(e){return-1!==this._expandPattern(e).indexOf("MMMM")},formatUsesDayName:function(e){return-1!==this._expandPattern(e).indexOf("EEEE")},getFormatParts:function(e){const t=this._getPatternByFormat(e)||e,r=[];return Cee(t.split(/\W+/),((e,t)=>{Cee(nre,((e,i)=>{i.includes(t)&&r.push(e)}))})),r},getMonthNames:function(e){return Ote(e)},getDayNames:function(e){return _te(e)},getQuarterNames:function(e){return Ute(e)},getPeriodNames:function(e){return Hte(e)},getTimeSeparator:function(){return":"},is24HourFormat:function(e){const t=new Date(2017,0,20,11,0,0,0),r=new Date(2017,0,20,23,0,0,0),i=this.format(t,e),n=this.format(r,e);for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!isNaN(parseInt(i[e]))},format:function(e,t){if(!e)return;if(!t)return e;let r;if("function"==typeof t)r=t;else if(t.formatter)r=t.formatter;else if(t=t.type||t,J9(t))return t=ire[t.toLowerCase()]||t,cte.convertDigits(function(e,t){return function(r){let i,n,o,a,s=0,l=!1,d="";if(!r)return null;if(!e)return r;const c="Z"===e[e.length-1]||"'Z'"===e.slice(-3);for(i=0;i<e.length;i++)o=e[i],n=wee[o],a=o===e[i+1],s++,a||(n&&!l&&(d+=n(r,s,c,t)),s=0),"'"!==o||a?!l&&n||(d+=o):l=!l,"'"===o&&a&&i++;return d}}(t,this)(e));return r?r(e):void 0},parse:function(e,t){const r=this;let i,n;if(!e)return;if(!t)return this.parse(e,"shortdate");if(t.parser)return t.parser(e);if("string"!=typeof t||ire[t.toLowerCase()]){n=e=>{const i=r.format(e,t);return cte.convertDigits(i,!0)};try{i=bte(n)}catch(e){}}else i=t;if(i)return e=cte.convertDigits(e,!0),Rte(i,this)(e);cee.log("W0012");const o=new Date(e);return o&&!isNaN(o.getTime())?o:void 0},firstDayOfWeekIndex:function(){const e=Qee.getValueByClosestLocale((e=>Vte[e]));return void 0===e?0:e}});rre&&ore.inject(tre);var are=ore;class sre{get locDate(){var e;return null!==(e=are)&&void 0!==e?e:r}get locNumber(){var e;return null!==(e=cte)&&void 0!==e?e:t}get twoDigitYearMax(){return 2029}get ts(){return this.locDate.getTimeSeparator()}get ds(){return"/"}get am(){return this.locDate.getPeriodNames()[0]}get pm(){return this.locDate.getPeriodNames()[1]}get monthNames(){return this.locDate.getMonthNames()}get genMonthNames(){return this.locDate.getMonthNames(void 0,"format")}get abbrMonthNames(){return this.locDate.getMonthNames("abbreviated")}get abbrDayNames(){return this.locDate.getDayNames("abbreviated")}get dayNames(){return this.locDate.getDayNames()}get shortTime(){return`h${this.ts}mm tt`}get longTime(){return`h${this.ts}mm${this.ts}ss tt`}get shortDate(){return`M${this.ds}d${this.ds}yyyy`}get longDate(){return"dddd, MMMM d, yyyy"}get monthDay(){return"MMMM d"}get yearMonth(){return"MMMM yyyy"}get numDecimalPoint(){return this.locNumber.getDecimalSeparator()}get numPrec(){return 2}get numGroupSeparator(){return this.locNumber.getThousandsSeparator()}get numGroups(){return[3]}get numNegPattern(){return 1}get numPosInf(){return"Infinity"}get numNegInf(){return"-Infinity"}get numNan(){return"NaN"}get currency(){return"$"}get currDecimalPoint(){return this.locNumber.getDecimalSeparator()}get currPrec(){return 2}get currGroupSeparator(){return this.locNumber.getThousandsSeparator()}get currGroups(){return[3]}get currPosPattern(){return 0}get currNegPattern(){return 0}get percentPattern(){return 0}clone(){return new sre}}class lre{constructor(){this.watchers=[],lre.evtHandlersHolder.addListenerToWindow("beforeunload",this.onWindowBeforeUnload.bind(this))}static get instance(){return lre._instance||(lre._instance=new this),lre._instance}add(e){this.watchers.push(e)}remove(e){const t=this.watchers.indexOf(e);t>=0&&this.watchers.splice(t,1)}onWindowBeforeUnload(e){const t=this.getConfirmMessage();if(t)return e.returnValue=!!t,t}getConfirmMessage(){const e=this.getModifiedWatchers();return e.length>0?e[0].getConfirmMessage():""}getModifiedWatchers(){return this.watchers.filter((e=>e.hasChanges()))}}lre.evtHandlersHolder=new rX.$;class dre{constructor(e,t){this.hasChangesCallback=e,this.confirmMessage=t,lre.instance.add(this)}hasChanges(){return this.hasChangesCallback()}getConfirmMessage(){return this.confirmMessage}confirm(){return!this.hasChanges()||confirm(this.confirmMessage)}dispose(){this.hasChangesCallback=null,lre.instance.remove(this)}}class cre{constructor(){this.selectionChanged=new TY,this.documentLoaded=new vY,this.documentFormatted=new EY,this.documentChanged=new MY,this.activeSubDocumentChanged=new DY,this.gotFocus=new FY,this.lostFocus=new RY,this.hyperlinkClick=new LY,this.pointerDown=new BY,this.pointerUp=new AY,this.keyDown=new NY,this.keyUp=new kY,this.calculateDocumentVariable=new OY,this.contentInserted=new _Y,this.contentRemoved=new UY,this.characterPropertiesChanged=new HY,this.paragraphPropertiesChanged=new VY,this.autoCorrect=new WY,this.saving=new zY,this.saved=new jY,this.customCommandExecuted=new GY,this.pdfExporting=new KY,this.pdfExported=new qY,this.commandStateChanged=new $Y,this.calculateDocumentVariableAsync=new YY,this.contextMenuShowing=new JY,this.horizontalRulerVisibleChanged=new XY}clear(){this.selectionChanged.clearHandlers(),this.documentLoaded.clearHandlers(),this.documentFormatted.clearHandlers(),this.documentChanged.clearHandlers(),this.activeSubDocumentChanged.clearHandlers(),this.gotFocus.clearHandlers(),this.lostFocus.clearHandlers(),this.hyperlinkClick.clearHandlers(),this.pointerDown.clearHandlers(),this.pointerUp.clearHandlers(),this.keyDown.clearHandlers(),this.keyUp.clearHandlers(),this.calculateDocumentVariable.clearHandlers(),this.contentInserted.clearHandlers(),this.contentRemoved.clearHandlers(),this.characterPropertiesChanged.clearHandlers(),this.paragraphPropertiesChanged.clearHandlers(),this.autoCorrect.clearHandlers(),this.saving.clearHandlers(),this.saved.clearHandlers(),this.customCommandExecuted.clearHandlers(),this.pdfExporting.clearHandlers(),this.pdfExported.clearHandlers(),this.commandStateChanged.clearHandlers(),this.contextMenuShowing.clearHandlers(),this.calculateDocumentVariableAsync.clearHandlers(),this.horizontalRulerVisibleChanged.clearHandlers()}}class hre{constructor(){this.enabled=!0}}class ure{constructor(){this.width="100%",this.height="500px",this.readOnly=!1,this.unit=KM.Inch,this.exportUrl="",this.dataSource=null,this.rawDataSource=null,this.autoCorrect=new CJ,this.bookmarks=new BW,this.documentProtection=new fo,this.fields=new IJ,this.mailMerge=new xJ,this.printing=new vJ,this.ribbon=new iZ,this.view=new Rj,this.pdf=new TJ,this.search=new MJ,this.fonts=new yJ,this.spellCheck=new EJ,this.confirmOnLosingChanges=new pre,this.contextMenuSettings=new hre}static parse(e,t){const r=new ure;return e||(e={}),this.parseCommonSettings(e,r),this.parseAutoCorrectSettings(e,r),this.parseBookmarksSettings(e,r),this.parseDocumentProtectionSettings(e,r),this.parseFieldsSettings(e,r),this.parsePrintingSettings(e,r),this.parseRibbonSettings(e,r),this.parseViewsSettings(e,r),this.parsePdfSettings(e,r),r.fonts.init(e.fonts),this.parseConfirmOnLosingChangesSettings(e,r),this.parseMailMergeSettings(e,r),this.parseSpellCheckSettings(e,r),this.parseEventHandlers(e.events,r),this.parseContextMenuSettings(e,r),this.parseSearchSettings(e,r,t),r.onSaved&&""===r.exportUrl&&console.log("The Saved event does nothing. To learn more, follow https://docs.devexpress.com/AspNetCore/400972/office-inspired-controls/controls/rich-edit/document-management#save-a-document"),r}static parseCommonSettings(e,t){(0,S.isDefined)(e.width)&&(t.width=e.width),(0,S.isDefined)(e.height)&&(t.height=e.height),(0,S.isDefined)(e.readOnly)&&(t.readOnly=e.readOnly),(0,S.isDefined)(e.unit)&&(t.unit=e.unit),(0,S.isDefined)(e.exportUrl)&&(t.exportUrl=e.exportUrl),(0,S.isDefined)(e.nonce)&&(t.nonce=e.nonce)}static parseAutoCorrectSettings(e,t){const r=e.autoCorrect;if((0,S.isDefined)(r)&&((0,S.isDefined)(r.correctTwoInitialCapitals)&&(t.autoCorrect.correctTwoInitialCapitals=r.correctTwoInitialCapitals),(0,S.isDefined)(r.detectUrls)&&(t.autoCorrect.detectUrls=r.detectUrls),(0,S.isDefined)(r.enableAutomaticNumbering)&&(t.autoCorrect.enableAutomaticNumbering=r.enableAutomaticNumbering),(0,S.isDefined)(r.replaceTextAsYouType)&&(t.autoCorrect.replaceTextAsYouType=r.replaceTextAsYouType),(0,S.isDefined)(r.caseSensitiveReplacement)&&(t.autoCorrect.caseSensitiveReplacement=r.caseSensitiveReplacement),(0,S.isDefined)(r.replaceInfoCollection)&&Array.isArray(r.replaceInfoCollection)))for(let e of r.replaceInfoCollection)(0,S.isDefined)(e.replace)&&(0,S.isDefined)(e.with)&&t.autoCorrect.replaceInfoCollection.push(new SJ(e.replace,e.with))}static parseBookmarksSettings(e,t){(0,S.isDefined)(e.bookmarks)&&((0,S.isDefined)(e.bookmarks.color)&&(t.bookmarks.color=e.bookmarks.color),(0,S.isDefined)(e.bookmarks.visibility)&&(t.bookmarks.visibility=e.bookmarks.visibility?MV.Visible:MV.Hidden))}static parseDocumentProtectionSettings(e,t){const r=e.authentication;(0,S.isDefined)(r)&&((0,S.isDefined)(r.userName)&&(t.documentProtection.authenticationUserName=r.userName),(0,S.isDefined)(r.group)&&(t.documentProtection.authenticationGroup=r.group));const i=e.rangePermissions;(0,S.isDefined)(i)&&((0,S.isDefined)(i.bracketsColor)&&(t.documentProtection.rangeHighlightBracketsColor=i.bracketsColor),(0,S.isDefined)(i.highlightColor)&&(t.documentProtection.rangeHighlightColor=i.highlightColor),(0,S.isDefined)(i.highlightRanges)&&(t.documentProtection.highlightRanges=i.highlightRanges),(0,S.isDefined)(i.showBrackets)&&(t.documentProtection.showBrackets=i.showBrackets))}static parseFieldsSettings(e,t){(0,S.isDefined)(e.fields)&&((0,S.isDefined)(e.fields.updateFieldsBeforePrint)&&(t.fields.updateFieldsBeforePrint=e.fields.updateFieldsBeforePrint),(0,S.isDefined)(e.fields.updateFieldsOnPaste)&&(t.fields.updateFieldsOnPaste=e.fields.updateFieldsOnPaste),(0,S.isDefined)(e.fields.defaultTimeFormat)&&(t.fields.defaultTimeFormat=e.fields.defaultTimeFormat),(0,S.isDefined)(e.fields.defaultDateFormat)&&(t.fields.defaultDateFormat=e.fields.defaultDateFormat),(0,S.isDefined)(e.fields.openHyperlinkOnClick)&&(t.fields.openHyperlinkOnClick=e.fields.openHyperlinkOnClick),(0,S.isDefined)(e.fields.createHyperlinkTooltip)&&(t.fields.createHyperlinkTooltip=this.parseEventHandler(e.fields.createHyperlinkTooltip)),(0,S.isDefined)(e.fields.keepHyperlinkResultForInvalidReference)&&(t.fields.keepHyperlinkResultForInvalidReference=e.fields.keepHyperlinkResultForInvalidReference),(0,S.isDefined)(e.fields.allowedHyperlinkUriSchemes)&&(t.fields.allowedHyperlinkUriSchemes=e.fields.allowedHyperlinkUriSchemes))}static parsePrintingSettings(e,t){var r,i,n,o;t.printing.mode=null!==(i=null===(r=null==e?void 0:e.printing)||void 0===r?void 0:r.mode)&&void 0!==i?i:Yre.Html,t.printing.closePrintDialogWithHtmlPreview=null===(o=null===(n=null==e?void 0:e.printing)||void 0===n?void 0:n.closePrintDialogWithHtmlPreview)||void 0===o||o}static parseRibbonSettings(e,t){if((0,S.isDefined)(e.ribbon))if(e.ribbon instanceof iZ)t.ribbon=e.ribbon;else{const r=e.ribbon,i=t.ribbon=new iZ;(0,S.isDefined)(r.visible)&&(i.visible=e.ribbon.visible),(0,S.isDefined)(r.activeTabIndex)&&(i.activeTabIndex=e.ribbon.activeTabIndex),(0,S.isDefined)(r.tabs)&&aZ(i,r.tabs),(0,S.isDefined)(r.contextTabCategories)&&sZ(i,r.contextTabCategories),(0,S.isDefined)(r.tabs)&&r.tabs.length||(0,S.isDefined)(r.contextTabCategories)&&r.tabs.length||(i.visible=!1)}else t.ribbon.visible=!1}static parseViewsSettings(e,t){if((0,S.isDefined)(e.view)){if((0,S.isDefined)(e.view.viewType)&&(t.view.viewType=e.view.viewType),(0,S.isDefined)(e.view.simpleViewSettings)){const r=e.view.simpleViewSettings.paddings;(0,S.isDefined)(r)&&((0,S.isDefined)(r.left)&&(t.view.paddings.left=r.left),(0,S.isDefined)(r.right)&&(t.view.paddings.right=r.right),(0,S.isDefined)(r.top)&&(t.view.paddings.top=r.top),(0,S.isDefined)(r.bottom)&&(t.view.paddings.bottom=r.bottom));const i=e.view.simpleViewSettings.fixedWidth;(0,S.isDefined)(i)&&(t.view.fixedWidth=i)}const r=e.view.printLayoutViewSettings;(0,S.isDefined)(r)&&(0,S.isDefined)(r.showHorizontalRuler)&&(t.view.showHorizontalRuler=r.showHorizontalRuler)}}static parsePdfSettings(e,t){(0,S.isDefined)(e.pdf)&&((0,S.isDefined)(e.pdf.pdfDocument)&&(t.pdf.pdfDocument=this.parseEventHandler(e.pdf.pdfDocument)),(0,S.isDefined)(e.pdf.blobStream)&&(t.pdf.blobStream=this.parseEventHandler(e.pdf.blobStream)),(0,S.isDefined)(e.pdf.exportUrl)&&(t.pdf.exportUrl=e.pdf.exportUrl),(0,S.isDefined)(e.pdf.pdfKitScriptUrl)&&(t.pdf.pdfKitScriptUrl=e.pdf.pdfKitScriptUrl),e.pdf.convertImageToCompatibleFormat&&(t.pdf.convertImageToCompatibleFormat=(0,yd.tm)(e.pdf.convertImageToCompatibleFormat)))}static parseSearchSettings(e,t,r){if((0,S.isDefined)(e.search)&&e.search.filterInterval){const i=(0,yd.tm)(e.search.filterInterval);t.search.filterInterval=(e,t)=>i(r(e),new xb(t.start,t.length))}}static parseConfirmOnLosingChangesSettings(e,t){(0,S.isDefined)(e.confirmOnLosingChanges)&&((0,S.isDefined)(e.confirmOnLosingChanges.enabled)&&(t.confirmOnLosingChanges.enabled=e.confirmOnLosingChanges.enabled),(0,S.isDefined)(e.confirmOnLosingChanges.message)&&(t.confirmOnLosingChanges.message=e.confirmOnLosingChanges.message))}static parseContextMenuSettings(e,t){(0,S.isDefined)(e.contextMenu)&&((0,S.isDefined)(e.contextMenu.enabled)&&(t.contextMenuSettings.enabled=e.contextMenu.enabled),(0,S.isDefined)(e.contextMenu.items)&&(t.contextMenuSettings.items=e.contextMenu.items))}static parseMailMergeSettings(e,t){if((0,S.isDefined)(e.mailMerge)&&((0,S.isDefined)(e.mailMerge.viewMergedData)&&(t.mailMerge.viewMergedData=e.mailMerge.viewMergedData),(0,S.isDefined)(e.mailMerge.activeRecord)&&(t.mailMerge.activeRecordIndex=e.mailMerge.activeRecord),(0,S.isDefined)(e.mailMerge.dataSource))){const r=u9.getDxDataSource(e.mailMerge.dataSource);t.rawDataSource=e.mailMerge.dataSource,t.dataSource=r,r.paginate(!1),r.requireTotalCount(!0),r.load().then((()=>{t.mailMerge.isEnabled=!0,t.mailMerge.allowInsertFields=!0,t.mailMerge.recordCount=t.dataSource.totalCount()})).catch((e=>{console.error(e.message)}))}}static parseSpellCheckSettings(e,t){(0,S.isDefined)(e.spellCheck)&&((0,S.isDefined)(e.spellCheck.enabled)&&(t.spellCheck.isEnabled=e.spellCheck.enabled),(0,S.isDefined)(e.spellCheck.suggestionCount)&&(t.spellCheck.suggestionCount=e.spellCheck.suggestionCount),(0,S.isDefined)(e.spellCheck.checkWordSpelling)&&(t.spellCheck.checkWordSpelling=this.parseEventHandler(e.spellCheck.checkWordSpelling)),(0,S.isDefined)(e.spellCheck.addWordToDictionary)?(t.spellCheck.addWordToDictionary=this.parseEventHandler(e.spellCheck.addWordToDictionary),t.spellCheck.canAddWord=!0):t.spellCheck.canAddWord=!1)}static parseEventHandlers(e,t){e&&(e.selectionChanged&&(t.onSelectionChanged=this.parseEventHandler(e.selectionChanged)),e.documentLoaded&&(t.onDocumentLoaded=this.parseEventHandler(e.documentLoaded)),e.documentFormatted&&(t.onDocumentFormatted=this.parseEventHandler(e.documentFormatted)),e.documentChanged&&(t.onDocumentChanged=this.parseEventHandler(e.documentChanged)),e.activeSubDocumentChanged&&(t.onActiveSubDocumentChanged=this.parseEventHandler(e.activeSubDocumentChanged)),e.gotFocus&&(t.onGotFocus=this.parseEventHandler(e.gotFocus)),e.lostFocus&&(t.onLostFocus=this.parseEventHandler(e.lostFocus)),e.hyperlinkClick&&(t.onHyperlinkClick=this.parseEventHandler(e.hyperlinkClick)),e.pointerDown&&(t.onPointerDown=this.parseEventHandler(e.pointerDown)),e.pointerUp&&(t.onPointerUp=this.parseEventHandler(e.pointerUp)),e.keyDown&&(t.onKeyDown=this.parseEventHandler(e.keyDown)),e.keyUp&&(t.onKeyUp=this.parseEventHandler(e.keyUp)),e.calculateDocumentVariable&&(t.onCalculateDocumentVariable=this.parseEventHandler(e.calculateDocumentVariable)),e.contentInserted&&(t.onContentInserted=this.parseEventHandler(e.contentInserted)),e.contentRemoved&&(t.onContentRemoved=this.parseEventHandler(e.contentRemoved)),e.characterPropertiesChanged&&(t.onCharacterPropertiesChanged=this.parseEventHandler(e.characterPropertiesChanged)),e.paragraphPropertiesChanged&&(t.onParagraphPropertiesChanged=this.parseEventHandler(e.paragraphPropertiesChanged)),e.autoCorrect&&(t.onAutoCorrect=this.parseEventHandler(e.autoCorrect)),e.saving&&(t.onSaving=this.parseEventHandler(e.saving)),e.saved&&(t.onSaved=this.parseEventHandler(e.saved)),e.customCommandExecuted&&(t.onCustomCommandExecuted=this.parseEventHandler(e.customCommandExecuted)),e.pdfExported&&(t.onPdfExported=this.parseEventHandler(e.pdfExported)),e.pdfExporting&&(t.onPdfExporting=this.parseEventHandler(e.pdfExporting)),e.commandStateChanged&&(t.onCommandStateChanged=this.parseEventHandler(e.commandStateChanged)),e.calculateDocumentVariableAsync&&(t.onCalculateDocumentVariableAsync=this.parseEventHandler(e.calculateDocumentVariableAsync)),e.contextMenuShowing&&(t.onContextMenuShowing=this.parseEventHandler(e.contextMenuShowing)))}static parseEventHandler(e){return(0,yd.tm)(e)}}class pre{constructor(){this.enabled=!0,this.message=(0,OV.formatMessage)("ASPxRichEditStringId.ConfirmOnLosingChanges")}}class gre{get core(){return this.owner.core}constructor(e,t){this.owner=e,this.searchManager=t,this.initialize()}dispose(){this.isVisible()&&this.onClose(!0),fn.DomUtils.hideNode(this.resultLabel),this.owner=null,this.searchManager=null,clearTimeout(this.timerId),fn.DomUtils.hideNode(this.searchField)}initialize(){this.createElements(),this.timerId=null,this.height=fn.DomUtils.getClearClientHeight(this.getQuickSearchPanelWrapper()),this.attachEvents(),this.initializeFields()}initializeFields(){this.searchManager.whatFind&&(this.getSearchField().value=this.searchManager.whatFind,this.searchManager.foundIntervals.length?this.updateSearchInfo(-1):this.findAll())}createElements(){}attachEvents(){const e=this.getSearchField(),t=this.getPrevButton(),r=this.getNextButton(),i=this.getCollapseButton(),n=this.getCloseButton(),o=this;n.onclick=function(){o.hide(!0)},i.onclick=function(){o.showFindReplaceDialog()},t.onclick=function(){o.searchManager.foundIntervals.length?o.findPrev():o.findAll()},r.onclick=function(){o.searchManager.foundIntervals.length?o.findNext():o.findAll()},e.onkeydown=function(e){var t=KU.LN.getEventKeyCode(e);if(t===KU.VD.Esc)o.hide(!0);else if(t===KU.VD.Enter)o.searchManager.foundIntervals.length?e.shiftKey?o.findPrev():o.findNext():o.findAll(),tX.g.preventEvent(e);else{var r=KU.LN.getShortcutCodeByEvent(e);r!==gre.shortcuts.showDialog&&r!==gre.shortcuts.showPanel||(tX.g.preventEvent(e),r===gre.shortcuts.showDialog&&o.showFindReplaceDialog())}},e.onkeyup=function(e){if(clearTimeout(o.timerId),KU.LN.getEventKeyCode(e)!==KU.VD.Enter)return o.getSearchField().value?void(o.timerId=setTimeout((function(){o.findAll()}),700)):(o.clearResult(),void o.searchManager.resetSearch())}}findNext(){var e=this.searchManager.findNextIntervalIndex();null!==e&&(this.searchManager.selectIntervalByIndex(e),this.searchManager.scrollToIntervalByIndex(e),this.updateSearchInfo(e))}findPrev(){var e=this.searchManager.findPrevIntervalIndex();null!==e&&(this.searchManager.selectIntervalByIndex(e),this.searchManager.scrollToIntervalByIndex(e),this.updateSearchInfo(e))}findAll(){var e=this.getSearchField().value;if(e){this.searchManager.findAll(e,!1),this.updateSearchInfo(-1);var t=this.searchManager.findNextIntervalIndex();null!==t&&this.searchManager.scrollToIntervalByIndex(t)}}updateSearchInfo(e){if(this.searchManager.foundIntervals.length){var t=e>=0?`${e+1} ${this.core.stringResources.quickSearchPanel.of} ${this.searchManager.foundIntervals.length}`:this.core.stringResources.quickSearchPanel.items+": "+this.searchManager.foundIntervals.length;this.setResult(t)}else this.setResult(this.core.stringResources.quickSearchPanel.noMatches)}setResult(e){this.getResultLabel().innerHTML=e}clearResult(){this.getResultLabel().innerHTML=""}getQuickSearchPanelWrapper(){return this.owner.getChildElement(gre.wrapperPostfix)}getSearchField(){if(!this.searchField){const e=this.owner.getChildElement(gre.wrapperPostfix).getElementsByTagName("INPUT");for(let t,r=0;t=e[r];r++)if("text"===t.type.toLowerCase()){this.searchField=t;break}}return this.searchField}getPrevButton(){return this.owner.getChildElement(gre.prevBtnPostfix)}getNextButton(){return this.owner.getChildElement(gre.nextBtnPostfix)}getCollapseButton(){return this.owner.getChildElement(gre.collapseBtnPostfix)}getCloseButton(){return this.owner.getChildElement(gre.closeBtnPostfix)}getResultLabel(){if(!this.resultLabel){var e=this.getSearchField().parentElement;const t=document.createElement("SPAN");t.classList.add("dxreSearchResult"),e.appendChild(t),t.style.lineHeight=`${e.offsetHeight}px`,this.resultLabel=t}return this.resultLabel}NotifySearchReset(){this.clearResult()}showFindReplaceDialog(){this.core.commandManager.getCommand(FF.Replace).execute(this.core.commandManager.isPublicApiCall)}show(){if(!this.isVisible()&&!this.owner.hasActiveDialog()){var e=this.getQuickSearchPanelWrapper();e.style.visibility="visible",e.style.height=this.height+"px",this.searchManager.onChanged.add(this),this.initializeFields()}fn.DomUtils.setFocus(this.getSearchField()),this.getSearchField().select()}hide(e){if(this.isVisible()){var t=this.getQuickSearchPanelWrapper();t.style.height="0px",t.style.visibility="hidden",this.onClose(e)}}onClose(e){e&&this.searchManager.resetSearch(),this.searchManager.onChanged.remove(this),this.getSearchField().value="",this.clearResult(),this.core.focusManager.captureFocus()}isVisible(){return"hidden"!==fn.DomUtils.getCurrentStyle(this.getQuickSearchPanelWrapper()).visibility}}gre.shortcuts={showPanel:KU.LN.parseShortcutString(yH.Browser.MacOSPlatform?"CMD+F":"CTRL+F"),showDialog:KU.LN.parseShortcutString(yH.Browser.MacOSPlatform?"CMD+H":"CTRL+H")},gre.containerPostfix="_QS",gre.wrapperPostfix="_QSPW",gre.prevBtnPostfix="_QSPPrevBtn",gre.nextBtnPostfix="_QSPNextBtn",gre.collapseBtnPostfix="_QSPCollapseBtn",gre.closeBtnPostfix="_QSPCloseBtn";class mre extends gre{initialize(){super.initialize(),this.getQuickSearchPanelWrapper().parentElement.style.display="none"}show(){this.getQuickSearchPanelWrapper().parentElement.style.display="block",super.show()}hide(e){super.hide(e),this.getQuickSearchPanelWrapper().parentElement.style.display="none"}dispose(){super.dispose(),this.searchTextBox.dispose(),this.searchTextBox=null,this.resultButton=null,fn.DomUtils.hideNode(this.searchTextBoxField),this.searchTextBoxField=null}createElements(){const e=this.createQuickSearchContainer(),t=this.createWrapper();e.appendChild(t);const r=this.createQuickSearchPanel();t.appendChild(r);const i=document.createElement("div");r.appendChild(i),new(SQ())(i,{items:this.createToolbarItems()})}getSearchField(){if(!this.searchTextBoxField){const e=this.searchTextBox.element(),t=e.querySelector?e:e[0];this.searchTextBoxField=t.querySelector("input")}return this.searchTextBoxField}setResult(e){this.resultButton.option({text:e,visible:!0})}clearResult(){this.resultButton.option("visible",!1)}createQuickSearchContainer(){const e=this.owner.getMainElement(),t=document.createElement("DIV");return t.id=this.owner.name+gre.containerPostfix,fn.DomUtils.addClassName(t,"dxreQuickSearch"),e.insertBefore(t,e.childNodes[2]),t}createWrapper(){var e=document.createElement("DIV");return e.id=this.owner.name+gre.wrapperPostfix,fn.DomUtils.addClassName(e,"dxreQuickSearchPanelWrapper"),e}createQuickSearchPanel(){const e=document.createElement("DIV");return fn.DomUtils.addClassName(e,"dxreQuickSearchPanel"),fn.DomUtils.addClassName(e,iJ.BorderColor),fn.DomUtils.addClassName(e,iJ.BackgroundColor),e}getButtonId(e){return this.owner.name+e}createToolbarItems(){return[this.createToolbarTextBoxTemplate(),this.createToolbarButtonTemplate(gre.prevBtnPostfix,"dxre-icon-Prev"),this.createToolbarButtonTemplate(gre.nextBtnPostfix,"dxre-icon-Next"),this.createToolbarButtonTemplate(gre.collapseBtnPostfix,"dxre-icon-ViewMergedData"),this.createToolbarButtonTemplate(gre.closeBtnPostfix,"dxre-icon-ClearHeaderAndFooter")]}createToolbarTextBoxTemplate(){return{widget:"dxTextBox",options:{onInitialized:e=>this.searchTextBox=e.component,stylingMode:"filled",width:"250px",buttons:[{name:"result",location:"after",options:{stylingMode:"text",focusStateEnabled:!1,hoverStateEnabled:!1,activeStateEnabled:!1,visible:!1,elementAttr:{class:"dxreSearchResult"},onInitialized:e=>{this.resultButton=e.component;(e.element.addEventListener?e.element:e.element[0]).addEventListener("mousedown",(e=>{e.stopPropagation(),e.preventDefault(),this.searchTextBox.focus()}))}}}]}}}createToolbarButtonTemplate(e,t){return{widget:"dxButton",options:{stylingMode:"text",icon:pY.correctIconName(t),elementAttr:{id:this.getButtonId(e)}}}}}class fre{static changeElementStyleAttribute(e,t,r){sE.F.saveStyleAttributeInElement(e,t),fre.setStyleAttribute(e.style,t,r)}static setStyleAttribute(e,t,r){e.setAttribute?sE.F.setElementAttribute(e,t,r):sE.F.setStyleAttribute(e,t,r)}}class bre{constructor(e){this.fullScreenTempVars={},this.zIndex="1001",this.element=e}get shouldChangeNativeFullscreen(){return window.self!==window.top}prepareFullScreenMode(){const e=this.getMainElement();fre.changeElementStyleAttribute(e,yH.Browser.IE?"borderTopWidth":"border-top-width","0px"),fre.changeElementStyleAttribute(e,yH.Browser.IE?"borderLeftWidth":"border-left-width","0px"),fre.changeElementStyleAttribute(e,yH.Browser.IE?"borderRightWidth":"border-right-width","0px"),fre.changeElementStyleAttribute(e,yH.Browser.IE?"borderBottomWidth":"border-bottom-width","0px"),this.fullScreenTempVars.scrollTop=fn.DomUtils.getDocumentScrollTop(),this.fullScreenTempVars.scrollLeft=fn.DomUtils.getDocumentScrollLeft(),fre.changeElementStyleAttribute(e,"position","fixed"),fre.changeElementStyleAttribute(e,"top","0px"),fre.changeElementStyleAttribute(e,"left","0px"),fre.changeElementStyleAttribute(e,yH.Browser.IE?"zIndex":"z-index",this.zIndex),fre.changeElementStyleAttribute(document.documentElement,"position","static"),fre.changeElementStyleAttribute(document.documentElement,"overflow","hidden"),this.fullScreenTempVars.bodyMargin=document.body.style.margin,document.body.style.margin="0",this.fullScreenTempVars.width=e.style.width,this.fullScreenTempVars.height=e.style.height,this.shouldChangeNativeFullscreen&&this.requestFullScreen(document.body)}setNormalMode(){this.shouldChangeNativeFullscreen&&this.cancelFullScreen(document);var e=this.getMainElement();sE.F.restoreElementStyleAttribute(e,"left"),sE.F.restoreElementStyleAttribute(e,"top"),sE.F.restoreElementStyleAttribute(document.documentElement,"overflow"),sE.F.restoreElementStyleAttribute(document.documentElement,"position"),sE.F.restoreElementStyleAttribute(e,yH.Browser.IE?"zIndex":"z-index"),document.body.style.margin=this.fullScreenTempVars.bodyMargin,sE.F.restoreElementStyleAttribute(e,"position"),sE.F.restoreElementStyleAttribute(e,yH.Browser.IE?"borderTopWidth":"border-top-width"),sE.F.restoreElementStyleAttribute(e,yH.Browser.IE?"borderLeftWidth":"border-left-width"),sE.F.restoreElementStyleAttribute(e,yH.Browser.IE?"borderRightWidth":"border-right-width"),sE.F.restoreElementStyleAttribute(e,yH.Browser.IE?"borderBottomWidth":"border-bottom-width"),this.setHeight(this.fullScreenTempVars.height),this.setWidth(this.fullScreenTempVars.width),document.documentElement.scrollTop=this.fullScreenTempVars.scrollTop,document.documentElement.scrollLeft=this.fullScreenTempVars.scrollLeft}getMainElement(){return this.element}setWidth(e){const t=this.getMainElement(),r=!isNaN(parseFloat(e))&&isFinite(e);t.style.width=r?e+"px":e}setHeight(e){const t=this.getMainElement(),r=!isNaN(parseFloat(e))&&isFinite(e);t.style.height=r?e+"px":e}requestFullScreen(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}cancelFullScreen(e){e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen?e.msExitFullscreen():e.exitFullscreen&&e.exitFullscreen()}}var Cre=DevExpress.config,Sre=__webpack_require__.n(Cre);class Ire{get clientQuickSearchPanel(){return this._clientQuickSearchPanel||(this._clientQuickSearchPanel=new mre(this,this.core.searchManager)),this._clientQuickSearchPanel}getPublicRichEdit(){return this.publicRichEdit}constructor(e,t,r){var i;this.evtHandlersHolder=new rX.$,this.isInitialized=!1,this.isInFullScreenMode=!1,this.hasWorkDirectory=!1,this.allowDocumentLoadedEventCall=!0,GQ(),this.internalApi=t.internalApi,this.internalApi||(this.internalApi={});const n=ure.parse(t,(e=>r.document.subDocuments.getById(e)));this.rulerSettings=this.getRulerSettings(n.view),this.name=e.id,this.publicRichEdit=r,this.exportUrl=n.exportUrl,this.dataSource=n.dataSource,this.rawDataSource=n.rawDataSource,this.contextMenuSettings=n.contextMenuSettings,this.fullScreenHelper=new bre(e),Sre()(JSON.parse(atob("eyJsaWNlbnNlS2V5IjoiZXdvZ0lDSm1iM0p0WVhRaU9pQXhMQW9nSUNKcGJuUmxjbTVoYkZWellXZGxTV1FpT2lBaVZITk1NM3AyT1dkeE1EWk5lVlEyYXpCT1NIazNaeUlLZlE9PS52MHVNYVVSVFFNRWg3SEFEV1dZUnBXY2tsSTZiZC82Uis3VGpHa0lESDZ2aVY2Q2pieFI5L2ZZOERxQmdPQ0tVVld4Wnh0Z0p0blhxSXBqNnhnZFVRaEJQbHFHbm9WYUhWdTYxb0FjRnVWRUJlR0lDMERQN0pnaXBYZkgrd3VReFZZdGxrQT09In0="))),this.prepareElement(e,n),this.initDefaultFontsAndStyles(),this.initBars(n.ribbon,n.fonts),this.initEvents(n),this.createCore(n),this.initCore(),this.initDialogManager(),this.initLosingChangesWatcher(n.confirmOnLosingChanges),this.attachEvents(),this.adjustControl(),this.onInit=null===(i=t.events)||void 0===i?void 0:i.init,this.document=t.document}getRulerSettings(e){const t=kJ.ruler;return t.visibility=e.showHorizontalRuler?Oq.Visible:Oq.Hidden,t}disposeDataSource(){this.dataSource&&this.dataSource.dispose(),this.dataSource=null,this.rawDataSource=null}dispose(){this.evtHandlersHolder.removeAllListeners(),this.barHolder.dispose(),this.dialogManager.dispose(),this._clientQuickSearchPanel&&this._clientQuickSearchPanel.dispose(),this.events.clear(),this.disposeDataSource(),this.core.dispose(),fn.DomUtils.clearInnerHtml(this.element),this.losingChangesWatcher.dispose(),this.publicRichEdit=null,fn.DomUtils.hideNode(this.element),this.core=null,this.barHolder=null,this.dialogManager=null,this._clientQuickSearchPanel=null,this.publicRichEdit=null,this.losingChangesWatcher=null,this.evtHandlersHolder=null}setNewRawDataSource(e,t){if(this.disposeDataSource(),this.core.modelManager.richOptions.mailMerge.isEnabled=!1,this.core.modelManager.richOptions.mailMerge.allowInsertFields=!1,this.rawDataSource=e,null==e)return this.core.barHolder.updateItemsState(),this.core.horizontalRulerControl.update(),void t(!0);this.dataSource=u9.getDxDataSource(e),this.dataSource.paginate(!1),this.dataSource.requireTotalCount(!0),this.core.loadingPanelManager.loadingPanel.setVisible(!0),this.dataSource.load().then((()=>{const e=this.core.modelManager.richOptions.mailMerge;e.isEnabled=!0,e.allowInsertFields=!0,e.recordCount=this.dataSource.totalCount(),e.activeRecordIndex=0,this.core.modelManager.richOptions.mailMerge.viewMergedData&&this.core.commandManager.getCommand(FF.GoToDataRecord).execute(!0,e.activeRecordIndex),this.core.loadingPanelManager.loadingPanel.setVisible(!1),this.core.barHolder.updateItemsState(),this.core.horizontalRulerControl.update(),t(!0)})).catch((e=>{console.error(e.message),this.core.loadingPanelManager.loadingPanel.setVisible(!1),t(!1)}))}prepareElement(e,t){this.element=e,this.element.style.width=t.width,this.element.style.height=t.height,"block"!=getComputedStyle(this.element).display&&(this.element.style.display="block"),this.element.classList.add("dxreControl"),this.element.classList.add(iJ.BorderColor),this.element.classList.add((0,_V.currentTheme)())}createCore(e){const t=new DJ(new sre);t.bookmarks=e.bookmarks,t.fields=e.fields,t.mailMerge=e.mailMerge,t.autoCorrect=e.autoCorrect,t.documentProtection=e.documentProtection,t.printing=e.printing,t.pdf=e.pdf,t.search=e.search,t.fonts=e.fonts,t.spellChecker=e.spellCheck,t.nonce=e.nonce,this.core=new d9(this,this.name,this.element,Math.random().toString(),e.readOnly,this.barHolder,e.unit,this.rulerSettings,t,e.view,this.getStringResources())}initCore(){const e=new bJ("",!1);this.core.initialize("",e,1)}initEvents(e){this.events=new cre,e.onSelectionChanged&&this.events.selectionChanged.addHandler(e.onSelectionChanged,this.publicRichEdit),e.onDocumentLoaded&&this.events.documentLoaded.addHandler(e.onDocumentLoaded,this.publicRichEdit),e.onDocumentFormatted&&this.events.documentFormatted.addHandler(e.onDocumentFormatted,this.publicRichEdit),e.onDocumentChanged&&this.events.documentChanged.addHandler(e.onDocumentChanged,this.publicRichEdit),e.onActiveSubDocumentChanged&&this.events.activeSubDocumentChanged.addHandler(e.onActiveSubDocumentChanged,this.publicRichEdit),e.onGotFocus&&this.events.gotFocus.addHandler(e.onGotFocus,this.publicRichEdit),e.onLostFocus&&this.events.lostFocus.addHandler(e.onLostFocus,this.publicRichEdit),e.onHyperlinkClick&&this.events.hyperlinkClick.addHandler(e.onHyperlinkClick,this.publicRichEdit),e.onPointerDown&&this.events.pointerDown.addHandler(e.onPointerDown,this.publicRichEdit),e.onPointerUp&&this.events.pointerUp.addHandler(e.onPointerUp,this.publicRichEdit),e.onKeyDown&&this.events.keyDown.addHandler(e.onKeyDown,this.publicRichEdit),e.onKeyUp&&this.events.keyUp.addHandler(e.onKeyUp,this.publicRichEdit),e.onCalculateDocumentVariable&&this.events.calculateDocumentVariable.addHandler(e.onCalculateDocumentVariable,this.publicRichEdit),e.onContentInserted&&this.events.contentInserted.addHandler(e.onContentInserted,this.publicRichEdit),e.onContentRemoved&&this.events.contentRemoved.addHandler(e.onContentRemoved,this.publicRichEdit),e.onCharacterPropertiesChanged&&this.events.characterPropertiesChanged.addHandler(e.onCharacterPropertiesChanged,this.publicRichEdit),e.onParagraphPropertiesChanged&&this.events.paragraphPropertiesChanged.addHandler(e.onParagraphPropertiesChanged,this.publicRichEdit),e.onAutoCorrect&&this.events.autoCorrect.addHandler(e.onAutoCorrect,this.publicRichEdit),e.onSaving&&this.events.saving.addHandler(e.onSaving,this.publicRichEdit),e.onSaved&&this.events.saved.addHandler(e.onSaved,this.publicRichEdit),e.onCustomCommandExecuted&&this.events.customCommandExecuted.addHandler(e.onCustomCommandExecuted,this.publicRichEdit),e.onPdfExporting&&this.events.pdfExporting.addHandler(e.onPdfExporting,this.publicRichEdit),e.onPdfExported&&this.events.pdfExported.addHandler(e.onPdfExported,this.publicRichEdit),e.onCommandStateChanged&&this.events.commandStateChanged.addHandler(e.onCommandStateChanged,this.publicRichEdit),e.onCalculateDocumentVariableAsync&&this.events.calculateDocumentVariableAsync.addHandler(e.onCalculateDocumentVariableAsync,this.publicRichEdit),e.onContextMenuShowing&&this.events.contextMenuShowing.addHandler(e.onContextMenuShowing,this.publicRichEdit)}initDefaultFontsAndStyles(){Wh.populatePresetStyles(kJ.getLocalizedDefaultPresetStyles())}initBars(e,t){this.barHolder=new KJ(void 0,new gQ(this,this.element,this.contextMenuSettings.items),(e=>this.raiseCommandStateChanged(e))),this.initRibbon(e,t)}initRibbon(e,t){if(this.core&&(this.core.modelManager.modelManipulator.removeModelListener(this.barHolder.ribbon),this.core.selection.onChanged.remove(this.barHolder.ribbon)),this.lastRibbonSettings=e,this.barHolder.removeRibbonBar(),e.visible){const r=new hZ(this,this.element,e,t);this.barHolder.ribbon=r,this.core&&(this.core.modelManager.modelManipulator.modelListeners.push(this.barHolder.ribbon),this.core.selection.onChanged.add(this.barHolder.ribbon),r.initialize(this.core))}this.activeContextTabManager||(this.activeContextTabManager=new XJ(this.barHolder)),this.activeContextTabManager.init(e),this.activeContextTabManager.forbidChangeActiveTabIndex=!0}initDialogManager(){this.dialogManager=new X9(this.element,this.core)}getStringResources(){const e=new FJ;return e.headerFooter.evenPageFooter=(0,OV.formatMessage)("XtraRichEditStringId.Caption_EvenPageFooter"),e.headerFooter.evenPageHeader=(0,OV.formatMessage)("XtraRichEditStringId.Caption_EvenPageHeader"),e.headerFooter.firstPageFooter=(0,OV.formatMessage)("XtraRichEditStringId.Caption_FirstPageFooter"),e.headerFooter.firstPageHeader=(0,OV.formatMessage)("XtraRichEditStringId.Caption_FirstPageHeader"),e.headerFooter.footer=(0,OV.formatMessage)("XtraRichEditStringId.Caption_PageFooter"),e.headerFooter.header=(0,OV.formatMessage)("XtraRichEditStringId.Caption_PageHeader"),e.headerFooter.oddPageFooter=(0,OV.formatMessage)("XtraRichEditStringId.Caption_OddPageFooter"),e.headerFooter.oddPageHeader=(0,OV.formatMessage)("XtraRichEditStringId.Caption_OddPageHeader"),e.headerFooter.sameAsPrevious=(0,OV.formatMessage)("XtraRichEditStringId.Caption_SameAsPrevious"),e.seqCaptionPrefixes.figurePrefix=(0,OV.formatMessage)("XtraRichEditStringId.Caption_CaptionPrefixFigure"),e.seqCaptionPrefixes.tablePrefix=(0,OV.formatMessage)("XtraRichEditStringId.Caption_CaptionPrefixTable"),e.seqCaptionPrefixes.equationPrefix=(0,OV.formatMessage)("XtraRichEditStringId.Caption_CaptionPrefixEquation"),e.commonLabels.noTocEntriesFound=(0,OV.formatMessage)("XtraRichEditStringId.Msg_NoTocEntriesFound"),e.commonLabels.clickToFollowHyperlink=(0,OV.formatMessage)("XtraRichEditStringId.Msg_ClickToFollowHyperlink"),e.commonLabels.currentDocumentHyperlinkTooltip=(0,OV.formatMessage)("XtraRichEditStringId.Caption_CurrentDocumentHyperlinkTooltip"),e.quickSearchPanel.of=(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Of"),e.quickSearchPanel.items=(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_Items"),e.quickSearchPanel.noMatches=(0,OV.formatMessage)("ASPxRichEditStringId.FindReplace_NoMatches"),e}initLosingChangesWatcher(e){this.losingChangesWatcher=new dre(e.enabled?()=>this.core.getModifiedState()==n.True:()=>!1,e.message)}attachEvents(){this.canUseResizeObserver()&&window.ResizeObserver?(this.resizeObserver=new ResizeObserver((e=>{for(let t of e)t.target!==this.element||this.isInFullScreenMode||this.adjustControl()})),this.resizeObserver.observe(this.element),this.evtHandlersHolder.addListenerToWindow("resize",(()=>{this.isInFullScreenMode&&this.adjustControlInFullScreenMode()}))):this.evtHandlersHolder.addListenerToWindow("resize",(()=>{this.isInFullScreenMode?this.adjustControlInFullScreenMode():this.adjustControl()})),this.evtHandlersHolder.addListenerToDocument("fullscreenchange",(()=>this.onFullScreenChange(document))),this.evtHandlersHolder.addListenerToDocument("webkitfullscreenchange",(()=>this.onFullScreenChange(document))),this.evtHandlersHolder.addListenerToDocument("mozfullscreenchange",(()=>this.onFullScreenChange(document))),this.evtHandlersHolder.addListenerToDocument("msfullscreenchange",(()=>this.onFullScreenChange(document)))}canUseResizeObserver(){return!yH.Browser.IE&&(yH.Browser.Chrome&&yH.Browser.Version>=64||yH.Browser.Edge&&yH.Browser.Version>=79||yH.Browser.Firefox&&(yH.Browser.AndroidMobilePlatform&&yH.Browser.Version>=79||!yH.Browser.AndroidMobilePlatform&&yH.Browser.Version>=69)||yH.Browser.Opera&&(yH.Browser.AndroidMobilePlatform&&yH.Browser.Version>=47||!yH.Browser.AndroidMobilePlatform&&yH.Browser.Version>=51)||yH.Browser.Safari&&(yH.Browser.MacOSMobilePlatform&&yH.Browser.Version>=13.4||!yH.Browser.MacOSMobilePlatform&&yH.Browser.Version>=13.1))}syncSessionGuid(e){}canCaptureFocus(){return!0}Focus(){this.core.focusManager.captureFocus()}adjustControl(){if(this.core){const e=this.barHolder.ribbon;let t=0;e&&(t=e.getHeight(),e.adjustControl()),this.core.horizontalRulerControl.adjust();const r=this.core.horizontalRulerControl.getHeight();this.core.viewManager.canvas.style.height="0",this.core.viewManager.canvas.style.height=gK.getClientHeight(this.element)-r-t+"px",this.core.viewManager.adjust(!0)}}toggleFullScreenMode(){this.isInFullScreenMode=!this.isInFullScreenMode,this.isInFullScreenMode?this.setFullScreenMode():this.setNormalMode();const e=this.barHolder.ribbon;e&&e.adjustControl()}confirmOnLosingChanges(){return this.losingChangesWatcher.confirm()}sendExportRequest(e,t,r,i){if(this.exportUrl){const n=`base64=${e=Tg.EncodeUtils.prepareTextForRequest(e)}&fileName=${t=Tg.EncodeUtils.prepareTextForRequest(t)}&format=${r}&reason=${i=Tg.EncodeUtils.prepareTextForRequest(i)}`;this.sendPostRequest(this.exportUrl,n,(()=>{this.documentSaved=!0,this.raiseSaved(!0,i)}),(()=>this.raiseSaved(!1,i)))}}get documentSaved(){return this.core.lastSavedHistoryItemId===this.core.modelManager.history.getCurrentItemId()}set documentSaved(e){e?(this.core.lastSavedHistoryItemId=this.core.modelManager.history.getCurrentItemId(),this.core.barHolder.updateItemsState({[FF.ExportDocument]:!0})):this.core.lastSavedHistoryItemId==this.core.modelManager.history.getCurrentItemId()&&(this.core.lastSavedHistoryItemId=this.core.modelManager.history.getCurrentItemId()-1,this.core.barHolder.updateItemsState({[FF.ExportDocument]:!0}))}sendExportPdfRequest(e,t,r){const i=`base64=${e=Tg.EncodeUtils.prepareTextForRequest(e)}&fileName=${t=Tg.EncodeUtils.prepareTextForRequest(t)}`;this.sendPostRequest(r,i,(()=>this.raisePdfExported(!0)),(()=>this.raisePdfExported(!1)))}sendPostRequest(e,t,r,i){const n=new XMLHttpRequest;n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),n.onreadystatechange=()=>{4==n.readyState&&(200==n.status?r():i())},n.onerror=i,n.send(t)}showDialog(e,t,r,i,n){const o=this.dialogManager.getDialog(e);null!=o?o.show(t,r,i,n):console.log(`Dialog '${e}' not found`)}raiseBeginSynchronization(){}raiseDocumentLoaded(){this.allowDocumentLoadedEventCall&&this.events.documentLoaded._fireEvent(this.publicRichEdit,new qU)}raiseDocumentChanged(){this.events.documentChanged._fireEvent(this.publicRichEdit,new qU)}raiseDocumentFormatted(e){this.events.documentFormatted._fireEvent(this.publicRichEdit,new dQ(e))}raiseActiveSubDocumentChanged(){this.events.activeSubDocumentChanged._fireEvent(this.publicRichEdit,new qU)}onCaptureFocus(){this.barHolder.ribbon&&this.barHolder.ribbon.closeActiveItem()}raiseGotFocus(){this.publicRichEdit.nusaSettings.registered&&window.NUSA_customContainerFocussed(this.element),this.events.gotFocus._fireEvent(this.publicRichEdit,new qU)}raiseLostFocus(){this.events.lostFocus._fireEvent(this.publicRichEdit,new qU)}raiseHyperlinkClick(e,t){let r=!1;const i=t.getHyperlinkInfo();if(i){const n=i.uri||i.anchor,o=this.getLinkType(i),a=new QY(e,r,n,o,new pU(this.core,this.core.selection.activeSubDocument,t));this.events.hyperlinkClick._fireEvent(this.publicRichEdit,a),r=a.handled}return r}raisePointerDown(e){let t=!1;if(!this.events.pointerDown.isEmpty()){const r=new ZY(e);this.events.pointerDown._fireEvent(this.publicRichEdit,r),t=r.handled}return t}raisePointerUp(e){let t=!1;if(!this.events.pointerUp.isEmpty()){const r=new ZY(e);this.events.pointerUp._fireEvent(this.publicRichEdit,r),t=r.handled}return t}raiseKeyDown(e){let t=!1;if(!this.events.keyDown.isEmpty()){const r=new eQ(e);this.events.keyDown._fireEvent(this.publicRichEdit,r),t=r.handled}return t}raiseKeyUp(e){const t=new eQ(e);this.events.keyUp._fireEvent(this.publicRichEdit,t)}raiseCalculateDocumentVariable(e){this.events.calculateDocumentVariable._fireEvent(this.publicRichEdit,e)}raiseContentInserted(e,t){const r=new tQ(e,new xb(t.start,t.length));this.events.contentInserted._fireEvent(this.publicRichEdit,r)}raiseContentRemoved(e,t,r){const i=new rQ(e,new xb(t.start,t.length),r);this.events.contentRemoved._fireEvent(this.publicRichEdit,i)}raiseCharacterPropertiesChanged(e,t){const r=new tQ(e,new xb(t.start,t.length));this.events.characterPropertiesChanged._fireEvent(this.publicRichEdit,r)}raiseParagraphPropertiesChanged(e,t){const r=new iQ(e,t);this.events.paragraphPropertiesChanged._fireEvent(this.publicRichEdit,r)}raiseAutoCorrect(e,t){let r=!1;if(!this.events.autoCorrect.isEmpty()){let i=new nQ(e,new xb(t.start,t.length));this.events.autoCorrect._fireEvent(this.publicRichEdit,i),r=i.handled}return r}raiseSelectionChanged(){this.events.selectionChanged._fireEvent(this.publicRichEdit,new qU)}raiseSaving(e,t,r,i){let n=!1;if(!this.events.saving.isEmpty()){const o=new oQ(e,t,r,i);this.events.saving._fireEvent(this.publicRichEdit,o),n=o.handled}return n&&(this.documentSaved=!0),n}raiseHorizontalRulerVisibleChanged(e){const t=new sQ(e);this.events.horizontalRulerVisibleChanged._fireEvent(this.publicRichEdit,t)}raiseSaved(e,t){const r=new aQ(e,t);this.events.saved._fireEvent(this.publicRichEdit,r)}raiseCustomCommandExecuted(e,t){const r=new lQ(e,t);this.events.customCommandExecuted._fireEvent(this.publicRichEdit,r)}raiseFloatingObjectMovedObject(e){}raisePdfExported(e){const t=new hQ(e);this.events.pdfExported._fireEvent(this.publicRichEdit,t)}raisePdfExporting(e,t,r,i){const n=new cQ(e,t,r,i);return this.events.pdfExporting._fireEvent(this.publicRichEdit,n),n.handled}raiseCommandStateChanged(e){const t=new uQ(e);this.events.commandStateChanged._fireEvent(this.publicRichEdit,t)}raiseCalculateDocumentVariableAsync(e){this.events.calculateDocumentVariableAsync._fireEvent(this.publicRichEdit,e)}useAsyncVersionOfCalculateDocvariable(){return!this.events.calculateDocumentVariableAsync.isEmpty()}raiseContextMenuShowing(e){this.events.contextMenuShowing._fireEvent(this.publicRichEdit,e)}showPopupMenu(e){this.barHolder.contextMenu.show(e)}hidePopupMenu(){this.barHolder.contextMenu.hide()}showQuickSearchPanel(){this.clientQuickSearchPanel.show()}hideQuickSearchPanel(){this.clientQuickSearchPanel.hide(!0)}isRibbon(e){const t=this.barHolder.ribbon;return!!t&&t.containsChild(e)}isTouchMode(){return!1}getChildElement(e){return"_"!==e.charAt(0)&&(e="_"+e),this.element.querySelector("#"+this.name+e)}getMainElement(){return this.element}hasActiveDialog(){return!1}getContextMenuBar(){return this.barHolder.contextMenu}getRibbonBar(){return this.barHolder.ribbon}getLinkType(e){return e.isMail()?sY.EmailAddress:e.isUri()?sY.Hyperlink:sY.Bookmark}setFullScreenMode(){this.fullScreenHelper.prepareFullScreenMode(),this.adjustControlInFullScreenMode()}setNormalMode(){this.fullScreenHelper.setNormalMode(),this.adjustControl()}onFullScreenChange(e){this.isInFullScreenMode&&this.documentIsNotFullScreen(e)&&this.core.commandManager.getCommand(FF.FullScreen).execute(this.core.commandManager.isPublicApiCall)}documentIsNotFullScreen(e){return!1===e.webkitIsFullScreen||!1===e.mozFullScreen||yH.Browser.IE&&!window.screenTop&&!window.screenY}adjustControlInFullScreenMode(){const e=0==document.documentElement.clientWidth?document.body.clientWidth:document.documentElement.clientWidth,t=0==document.documentElement.clientHeight?document.body.clientHeight:document.documentElement.clientHeight;this.fullScreenHelper.setWidth(e),this.fullScreenHelper.setHeight(t),this.adjustControl()}savingEventIsEmpty(){return this.events.saving.isEmpty()}}class Pre{get userName(){return this._native.core.modelManager.richOptions.documentProtection.authenticationUserName}set userName(e){this._native.core.modelManager.richOptions.documentProtection.authenticationUserName=e,this._native.core.modelManager.modelManipulator.documentProtectionProperties.raiseProtectionPropertiesChanged()}get group(){return this._native.core.modelManager.richOptions.documentProtection.authenticationGroup}set group(e){this._native.core.modelManager.richOptions.documentProtection.authenticationGroup=e,this._native.core.modelManager.modelManipulator.documentProtectionProperties.raiseProtectionPropertiesChanged()}constructor(e){this._native=e}}class wre{constructor(e){this._native=e}getDataSource(){return this._native.rawDataSource}setDataSource(e,t=()=>{}){this._native.setNewRawDataSource(e,t)}get activeRecordIndex(){return this._native.core.modelManager.richOptions.mailMerge.activeRecordIndex}set activeRecordIndex(e){this._native.core.modelManager.richOptions.mailMerge.activeRecordIndex=e,this._native.core.modelManager.richOptions.mailMerge.viewMergedData&&this._native.core.commandManager.getCommand(FF.GoToDataRecord).execute(!0,e)}get viewMergedData(){return this._native.core.modelManager.richOptions.mailMerge.viewMergedData}set viewMergedData(e){this._native.core.commandManager.getCommand(FF.ToggleViewMergedData).execute(!0,e)}}class yre{get highlightRanges(){return this._native.core.modelManager.richOptions.documentProtection.highlightRanges}set highlightRanges(e){this.highlightRanges!=e&&(this._native.core.modelManager.richOptions.documentProtection.highlightRanges=e,this._native.core.modelManager.modelManipulator.documentProtectionProperties.raiseRangePermissionPropertiesChanged())}get showBrackets(){return this._native.core.modelManager.richOptions.documentProtection.showBrackets}set showBrackets(e){this.showBrackets!=e&&(this._native.core.modelManager.richOptions.documentProtection.showBrackets=e,this._native.core.modelManager.modelManipulator.documentProtectionProperties.raiseProtectionPropertiesChanged())}get highlightColor(){return this._native.core.modelManager.richOptions.documentProtection.rangeHighlightColor}set highlightColor(e){this.highlightColor!=e&&(this._native.core.modelManager.richOptions.documentProtection.rangeHighlightColor=e,this._native.core.modelManager.modelManipulator.documentProtectionProperties.raiseRangePermissionPropertiesChanged())}get bracketsColor(){return this._native.core.modelManager.richOptions.documentProtection.rangeHighlightBracketsColor}set bracketsColor(e){this.bracketsColor!=e&&(this._native.core.modelManager.richOptions.documentProtection.rangeHighlightBracketsColor=e,this._native.core.modelManager.modelManipulator.documentProtectionProperties.raiseProtectionPropertiesChanged())}constructor(e){this._native=e}}class xre{constructor(e,t,r,i){this.top=e,this.right=t,this.bottom=r,this.left=i}}class Tre{constructor(e){this._native=e}get paddings(){const e=this._native.core.innerClientProperties.viewsSettings.paddings;return new xre(e.top,e.right,e.bottom,e.left)}get fixedWidth(){return this._native.core.innerClientProperties.viewsSettings.fixedWidth}set paddings(e){this._native.core.innerClientProperties.viewsSettings.paddings.equals(e)||(this._native.core.innerClientProperties.viewsSettings.paddings.copyFrom(e),this._native.core.layoutFormatterManager.invalidator.onChangedAllLayout())}set fixedWidth(e){this._native.core.innerClientProperties.viewsSettings.fixedWidth!==e&&(this._native.core.innerClientProperties.viewsSettings.fixedWidth=e,this._native.core.layoutFormatterManager.invalidator.onChangedAllLayout())}}class vre{constructor(e){this._control=e}get isEnabled(){return this._control.modelManager.richOptions.spellChecker.isEnabled}set isEnabled(e){e!=this.isEnabled&&(e||(this._control.modelManager.model.mainSubDocument.spellCheckerIntervalsManager.reset(),this._control.spellChecker.updateMisspelledBoxes()),this._control.modelManager.richOptions.spellChecker.isEnabled=e,e&&this._control.spellChecker.check())}}function Mre(e,t,r){const i=t,n=e.getCommand(i);if(!n)return!1;let o=!0;switch(t){case $J.CreateDocument:case $J.OpenDocument:case $J.ExportDocument:r=void 0;break;case $J.DownloadDocumentMenu:r=void 0,o=!1;break;case $J.DownloadDocx:case $J.DownloadRtf:case $J.DownloadTxt:case $J.DownloadHtml:case $J.PrintDocument:r=void 0;break;case JJ.ChangeCaseMenu:case JJ.AlignParagraphMenu:case JJ.LineSpacingMenu:r=void 0,o=!1;break;case JJ.Undo:case JJ.Redo:case JJ.Cut:case JJ.Copy:case JJ.Paste:r=void 0;break;case JJ.ChangeFontName:r=mm.check(r,2,!1,[mm.stringDescriptor("parameter",(e=>e),!1)]);break;case JJ.ChangeFontSize:r=mm.check(r,2,!1,[mm.numberDescriptor("parameter",(e=>e),0)]);break;case JJ.IncreaseFontSize:case JJ.DecreaseFontSize:r=void 0;break;case JJ.ChangeFontForeColor:r=mm.check(r,2,!1,Sm.colorDescriptors("parameter"));break;case JJ.ShowFontDialog:r=void 0;break;case JJ.ToggleFontBold:case JJ.ToggleFontItalic:case JJ.ToggleFontUnderline:case JJ.ToggleFontDoubleUnderline:case JJ.ToggleFontStrikeout:case JJ.ToggleFontSubscript:case JJ.ToggleFontSuperscript:case JJ.CapitalizationToggleCase:case JJ.ToggleBulletedList:case JJ.ToggleNumberedList:case JJ.ToggleMultilevelList:case JJ.ToggleParagraphAlignmentLeft:case JJ.ToggleParagraphAlignmentCenter:case JJ.ToggleParagraphAlignmentRight:case JJ.ToggleParagraphAlignmentJustify:case JJ.ToggleShowHiddenSymbols:r=function(e){return!e.getState().value}(n);break;case JJ.CapitalizationSentenceCase:case JJ.CapitalizationUpperCase:case JJ.CapitalizationLowerCase:case JJ.CapitalizeEachWordCase:case JJ.ClearFormatting:case JJ.SetSingleParagraphSpacing:case JJ.SetSesquialteralParagraphSpacing:case JJ.SetDoubleParagraphSpacing:case JJ.AddSpacingBeforeParagraph:case JJ.AddSpacingAfterParagraph:case JJ.RemoveSpacingBeforeParagraph:case JJ.RemoveSpacingAfterParagraph:r=void 0;break;case JJ.ChangeShading:r=mm.check(r,2,!1,Sm.colorDescriptors("parameter"));break;case JJ.ChangeStyle:r=mm.check(r,2,!1,[mm.stringDescriptor("parameter",(e=>e),!1)]);break;case JJ.Find:case JJ.Replace:r=void 0;break;case JJ.ChangeFontHighlightColor:r=mm.check(r,2,!1,Sm.colorDescriptors("parameter"));break;case YJ.ShowInsertTableDialog:case YJ.InsertPicture:case YJ.ShowBookmarkDialog:case YJ.ShowHyperlinkDialog:case YJ.InsertHeader:case YJ.InsertFooter:case YJ.InsertPageNumberField:case YJ.InsertPageCountField:case YJ.InsertFloatingTextBox:r=void 0;break;case QJ.MarginsMenu:case QJ.OrientationMenu:case QJ.SizeMenu:case QJ.ColumnsMenu:case QJ.BreaksMenu:r=void 0,o=!1;break;case QJ.SetSectionNormalPageMargins:case QJ.SetSectionNarrowPageMargins:case QJ.SetSectionModeratePageMargins:case QJ.SetSectionWidePageMargins:case QJ.ShowMarginsPageSetupDialog:case QJ.SetPortraitPageOrientation:case QJ.SetLandscapePageOrientation:case QJ.SetSectionLetterPaperSize:case QJ.SetSectionLegalPaperSize:case QJ.SetSectionFolioPaperSize:case QJ.SetSectionA4PaperSize:case QJ.SetSectionB5PaperSize:case QJ.SetSectionExecutivePaperSize:case QJ.SetSectionA5PaperSize:case QJ.SetSectionA6PaperSize:case QJ.ShowPageSetupDialog:case QJ.SetSectionOneColumn:case QJ.SetSectionTwoColumns:case QJ.SetSectionThreeColumns:case QJ.InsertPageBreak:case QJ.InsertColumnBreak:case QJ.InsertSectionBreakNextPage:case QJ.InsertSectionBreakEvenPage:case QJ.InsertSectionBreakOddPage:r=void 0;break;case QJ.ChangePageColor:r=mm.check(r,2,!1,Sm.colorDescriptors("parameter"));break;case ZJ.AddTextMenu:case ZJ.InsertCaptionMenu:case ZJ.InsertTableOfFiguresMenu:r=void 0,o=!1;break;case ZJ.InsertTableOfContents:case ZJ.SetParagraphBodyTextLevel:case ZJ.SetParagraphHeading1Level:case ZJ.SetParagraphHeading2Level:case ZJ.SetParagraphHeading3Level:case ZJ.SetParagraphHeading4Level:case ZJ.SetParagraphHeading5Level:case ZJ.SetParagraphHeading6Level:case ZJ.SetParagraphHeading7Level:case ZJ.SetParagraphHeading8Level:case ZJ.SetParagraphHeading9Level:case ZJ.CreateFigureCaptionField:case ZJ.CreateTableCaptionField:case ZJ.CreateEquationCaptionField:case ZJ.CreateTableOfFiguresField:case ZJ.CreateTableOfTablesField:case ZJ.CreateTableOfEquationsField:case ZJ.UpdateTableOfContents:r=void 0;break;case eY.CreateFieldMenu:r=void 0,o=!1;break;case eY.CreateField:case eY.CreateDateField:case eY.CreateTimeField:case eY.CreatePageField:case eY.CreateNumPagesField:case eY.CreateEmptyMergeField:case eY.CreateEmptyDocVariableField:case eY.CreateEmptyIfField:case eY.ShowInsertMergeFieldDialog:case eY.ToggleViewMergedData:case eY.ShowAllFieldCodes:case eY.ShowAllFieldResults:case eY.UpdateAllFields:case eY.GoToFirstDataRecord:case eY.GoToPreviousDataRecord:case eY.GoToNextDataRecord:case eY.GoToLastDataRecord:case eY.ShowMailMergeDialog:case tY.SwitchToSimpleView:case tY.SwitchToPrintLayout:case tY.ToggleShowHorizontalRuler:case tY.ToggleFullScreen:case rY.GoToPageHeader:case rY.GoToPageFooter:case rY.GoToPreviousPageHeaderFooter:case rY.GoToNextPageHeaderFooter:case rY.LinkHeaderFooterToPrevious:case rY.ToggleDifferentFirstPage:case rY.ToggleDifferentOddAndEvenPages:r=void 0;break;case rY.ChangeHeaderOffset:case rY.ChangeFooterOffset:r=Ere(r);break;case rY.CloseHeaderFooter:r=void 0;break;case iY.TableStyleOptionsMenu:case iY.BordersMenu:r=void 0,o=!1;break;case iY.ToggleFirstRow:case iY.ToggleLastRow:case iY.ToggleBandedRows:case iY.ToggleFirstColumn:case iY.ToggleLastColumn:case iY.ToggleBandedColumn:r=void 0;break;case iY.ChangeTableStyle:r=mm.check(r,2,!1,[mm.stringDescriptor("parameter",(e=>e),!1)]);break;case iY.ChangeTableRepositoryItemBorderStyle:switch(mm.check(r,2,!1,[mm.stringDescriptor("parameter",(e=>{switch(e=e.toLowerCase()){case"none":case"dashed":case"double":case"dotted":case"single":break;default:e="single"}return e}),!1)])){case"none":r=de.None;break;case"dashed":r=de.Dashed;break;case"double":r=de.Double;break;case"dotted":r=de.Dotted;break;default:r=de.Single}break;case iY.ChangeTableRepositoryItemBorderWidth:r=mm.check(r,2,!1,[mm.numberDescriptor("parameter",(e=>e),0)]);break;case iY.ChangeTableRepositoryItemBorderColor:r=mm.check(r,2,!1,Sm.colorDescriptors("parameter"));break;case iY.ToggleTableCellsBottomBorder:case iY.ToggleTableCellsTopBorder:case iY.ToggleTableCellsLeftBorder:case iY.ToggleTableCellsRightBorder:case iY.ToggleTableCellNoBorder:case iY.ToggleTableCellAllBorders:case iY.ToggleTableCellOutsideBorders:case iY.ToggleTableCellInsideBorders:case iY.ToggleTableCellInsideHorizontalBorders:case iY.ToggleTableCellInsideVerticalBorders:case iY.ToggleTableViewGridlines:r=void 0;break;case iY.ChangeTableCellShading:r=mm.check(r,2,!1,Sm.colorDescriptors("parameter"));break;case nY.SelectMenu:case nY.DeleteMenu:case nY.InsertMenu:case nY.AutoFitMenu:case nY.AlignmentMenu:r=void 0,o=!1;break;case nY.SelectTableCell:case nY.SelectTableColumn:case nY.SelectTableRow:case nY.SelectTable:case nY.ToggleShowTableGridLines:case nY.ShowDeleteCellsDialog:case nY.DeleteTableColumns:case nY.DeleteTableRows:case nY.DeleteTable:case nY.InsertTableRowAbove:case nY.InsertTableRowBelow:case nY.InsertTableColumnToTheLeft:case nY.InsertTableColumnToTheRight:case nY.MergeTableCells:case nY.ShowSplitCellsDialog:case nY.SetAutoFitContents:case nY.SetAutoFitWindow:case nY.SetFixedColumnWidth:case nY.TableCellAlignTopLeft:case nY.TableCellAlignTopCenter:case nY.TableCellAlignTopRight:case nY.TableCellAlignMiddleLeft:case nY.TableCellAlignMiddleCenter:case nY.TableCellAlignMiddleRight:case nY.TableCellAlignBottomLeft:case nY.TableCellAlignBottomCenter:case nY.TableCellAlignBottomRight:r=void 0;break;case oY.WrapTextMenu:case oY.PositionMenu:case oY.BringToFrontMenu:case oY.SendToBackMenu:r=void 0,o=!1;break;case oY.ChangeFloatingObjectFillColor:r=mm.check(r,2,!1,Sm.colorDescriptors("parameter"));break;case oY.ChangeFloatingObjectOutlineColor:r=mm.check(r,2,!1,Sm.colorDescriptors("parameter"));break;case oY.ChangeFloatingObjectOutlineWidth:r=mm.check(r,2,!1,[mm.numberDescriptor("parameter",(e=>e),0)]);break;case oY.SetFloatingObjectInlineTextWrapType:case oY.SetFloatingObjectSquareTextWrapType:case oY.SetFloatingObjectTightTextWrapType:case oY.SetFloatingObjectThroughTextWrapType:case oY.SetFloatingObjectTopAndBottomTextWrapType:case oY.SetFloatingObjectBehindTextWrapType:case oY.SetFloatingObjectInFrontOfTextWrapType:case oY.SetFloatingObjectTopLeftAlignment:case oY.SetFloatingObjectTopCenterAlignment:case oY.SetFloatingObjectTopRightAlignment:case oY.SetFloatingObjectMiddleLeftAlignment:case oY.SetFloatingObjectMiddleCenterAlignment:case oY.SetFloatingObjectMiddleRightAlignment:case oY.SetFloatingObjectBottomLeftAlignment:case oY.SetFloatingObjectBottomCenterAlignment:case oY.SetFloatingObjectBottomRightAlignment:case oY.FloatingObjectBringForward:case oY.FloatingObjectBringToFront:case oY.FloatingObjectBringInFrontOfText:case oY.FloatingObjectSendBackward:case oY.FloatingObjectSendToBack:case oY.FloatingObjectSendBehindText:r=void 0;break;case aY.ApplySpellingSuggestion:r=mm.check(r,2,!1,[mm.stringDescriptor("parameter",(e=>e),!0)]);break;case aY.NoSpellingSuggestions:case aY.IgnoreSpellingError:case aY.IgnoreAllSpellingErrors:case aY.AddWordToDictionary:case aY.OpenHyperlink:case aY.ShowEditHyperlinkDialog:case aY.RemoveHyperlink:case aY.UpdateField:case aY.ToggleFieldCodes:case aY.RestartNumberedList:case aY.ContinueNumberedList:case aY.Cut:case aY.Copy:case aY.Paste:r=void 0;break;case aY.TableMenu:r=void 0,o=!1;break;case aY.InsertTableColumnToTheLeft:case aY.InsertTableColumnToTheRight:case aY.InsertTableRowAbove:case aY.InsertTableRowBelow:case aY.ShowInsertTableCellsDialog:case aY.ShowDeleteTableCellsDialog:case aY.ShowSplitCellsDialog:case aY.MergeTableCells:case aY.DecreaseParagraphIndent:case aY.IncreaseParagraphIndent:case aY.ShowFontDialog:case aY.ShowParagraphDialog:case aY.ShowBookmarkDialog:case aY.ShowHyperlinkDialog:r=void 0;break;case aY.ChangeFloatingObjectTextWrapTypeMenu:r=void 0,o=!1;break;case aY.SetFloatingObjectInlineTextWrapType:case aY.SetFloatingObjectSquareTextWrapType:case aY.SetFloatingObjectTightTextWrapType:case aY.SetFloatingObjectThroughTextWrapType:case aY.SetFloatingObjectTopAndBottomTextWrapType:case aY.SetFloatingObjectBehindTextWrapType:case aY.SetFloatingObjectInFrontOfTextWrapType:r=void 0;break;case aY.FloatingObjectBringForwardMenu:r=void 0,o=!1;break;case aY.FloatingObjectBringForward:case aY.FloatingObjectBringToFront:case aY.FloatingObjectBringInFrontOfText:r=void 0;break;case aY.FloatingObjectSendBackwardMenu:r=void 0,o=!1;break;case aY.FloatingObjectSendBackward:case aY.FloatingObjectSendToBack:case aY.FloatingObjectSendBehindText:case aY.SelectAll:r=void 0;break;default:o=!1}return!(!o&&!function(e){return e==FF.ShowTabsForm||e==FF.ShowCreateHyperlinkForm}(i))&&n.execute(!1,r)}function Ere(e){return mm.check(e,2,!1,[mm.numberDescriptor("parameter",(e=>e))])}class Dre{constructor(e,t,r){this.visible=e,this.enabled=t,this.value=r}}class Fre{constructor(){this.pageIndex=-1}}class Rre{constructor(e,t,r,i,n){this.selection=new Fre,this.onCalculateDocumentVariable=null,this.measurer=new hM(""),this.modelManager=this.createModelManager(null,e),this.innerClientProperties=new Lj(new Rj),this.documentRenderer=t,this.uiUnitConverter=r,this.sessionGuid=i,this.clientGuid=n}dispose(){this.measurer.dispose(),this.layoutFormatterManager&&this.layoutFormatterManager.dispose()}openDocument(e,t,r){const i="string"==typeof e?lo.Base64Utils.getFileFromBase64(e):e;this.openDocumentInner(i,t,r)}openInnerDocument(e){this.createModel(e)}exportDocumentToBase64(e,t){SV(this.getExportModelOptions({documentFormat:t}),e)}exportDocumentToBlob(e,t){IV(this.getExportModelOptions({documentFormat:t}),e)}openDocumentInner(e,t,r){this.activeDocumentImporter?r(!1):(this.activeDocumentImporter=V_(t),this.activeDocumentImporter?this.activeDocumentImporter.importFromFile(e,this.modelManager.richOptions,((e,t)=>{this.activeDocumentImporter=null,this.createModel(e),this.importImages(t),r(!0)}),(e=>{this.activeDocumentImporter=null,r(!1)})):r(!1))}importImages(e){e.import(this.modelManager.modelManipulator)}createModel(e){this.modelManager=this.createModelManager(e,this.modelManager.richOptions);const t=new AD(new BD(e));t.pageColor=e.getActualPageBackgroundColor(),this.layoutFormatterManager=new xj(this.measurer,this.innerClientProperties,this.modelManager.model,t,{activeSubDocument:e.mainSubDocument},this.modelManager.richOptions.bookmarks,this.modelManager.richOptions.documentProtection,{getVisibleAreaHeight(e){return 500}},new FJ,[]),this.layoutFormatterManager.openDocument()}beginUpdate(){this.layoutFormatterManager.beginUpdate()}endUpdate(){this.layoutFormatterManager.endUpdate()}invalidateLayoutAfterFontsLoaded(){this.measurer&&this.layoutFormatterManager&&this.layoutFormatterManager.invalidator&&(this.measurer.clearCache(),this.layoutFormatterManager.invalidator.onChangedAllLayout())}getExportModelOptions(e={}){return{modelManager:(0,S.isDefined)(e.modelManager)?e.modelManager:this.modelManager,pictureRenderer:this.documentRenderer,uiUnitConverter:this.uiUnitConverter,sessionGuid:this.sessionGuid,clientGuid:this.clientGuid,documentFormat:(0,S.isDefined)(e.documentFormat)?e.documentFormat:Fu.OpenXml}}}class Lre extends Rre{createFieldRequestManager(){const e=new r9(null,(()=>!1),this.onCalculateDocumentVariable?this.onCalculateDocumentVariable:()=>{},(()=>{}));return new i9(e)}createModelManager(e,t){return new cP(e,t,this)}}class Bre extends CH{constructor(e,t,r,i,n){super(),this._processor=new Lre(e,t,r,i,n)}}const Are=500;function Nre(e,t){let r=0;const i=()=>{if(r++>10)return;window.NUSA_createCommandPlaceholder?(!function(e){const t=window.NUSA_createCommandPlaceholder,r=window.NUSA_setCommandPlaceholderValues;for(let i of e){t(i.id,i.description);const e=[],n=[];for(let t of i.values)Array.isArray(t)?(n.push(t[0]),e.push(t[1])):(n.push(t.spokenForm),e.push(t.value));r(i.id,e,n)}}(t),function(e){const t=window.NUSA_createCommandSet,r=window.NUSA_createCommand;for(const i of e){const e=t(i.title,i.description);for(let t of i.commands)r(e,t.commandId,t.phrase,t.title,t.description)}}(e),Ore()):setTimeout((()=>{i()}),Are)};i()}let kre=null;function Ore(){if(null!==kre)return;let e=0;const t=()=>{const r=window.NUSA_reinitializeVuiForm;if(e++>10)kre=null;else if(r){kre=null;try{r()}catch(e){}}else kre=setTimeout((()=>{t()}),Are)};t()}const _re="data-nusa-custom-control-type",Ure="data-nusa-custom-container-type",Hre="data-nusa-enabled",Vre="data-nusa-concept-name";function Wre(e,t){t.isContainerTypeRegistered(e)||(t.registerContainerType(e),function(e,t){let r=0;const i=()=>{if(r++>10)return;const n=window.NUSA_registerCustomContainerType;n?t(n(e)):setTimeout((()=>{i()}),Are)};i()}(e,(r=>{r.getFocussedElement=e=>e,r.setFocussedElement=e=>{t.getRichEditByElement(e).Focus()},t.registerContainerTypeObject(e,r)})))}class zre{}function jre(e,t){t.isControlTypeRegistered(e)||(t.registerControlType(e),function(e,t){let r=0;const i=()=>{if(r++>10)return;const n=window.NUSA_registerCustomControlType;n?t(n(e)):setTimeout((()=>{i()}),Are)};i()}(e,(r=>{r.newlineFormat=zre.LineBreak,r.paragraphFormat=zre.ParagraphBreak,r.replaceText=(e,r,i,n)=>{const o=t.getRichEditByElement(e),a=o.core.selection.activeSubDocument,s=o.core.selection.getState().activePostion;o.core.beginUpdate(),o.core.modelManager.history.beginTransaction(),n>0&&o.core.modelManager.modelManipulator.range.removeInterval(new gu(a,new on.FixedInterval(i,n)),!0,!0);const l=dU(i,r,a,o.core,{wrapIntoBeginUpdate:!1,inputPosition:o.core.inputPosition});s>=i&&s<i+n&&o.core.selection.changeState((e=>e.setPosition(l.end))),o.core.modelManager.history.endTransaction(),o.core.endUpdate()},r.getText=e=>t.getRichEditByElement(e).core.selection.activeSubDocument.getText(),r.getSelectionText=e=>{const r=t.getRichEditByElement(e);return r.core.selection.activeSubDocument.getText(r.core.selection.intervals[0])},r.getSelection=e=>t.getRichEditByElement(e).core.selection.intervals[0],r.setSelection=(e,r,i)=>{t.getRichEditByElement(e).core.selection.changeState((e=>e.setInterval(new on.FixedInterval(r,i))))},t.registerControlTypeObject(e,r)})))}zre.PageBreak=an.specialCharacters.PageBreak,zre.LineBreak=an.specialCharacters.LineBreak,zre.ParagraphBreak=an.specialCharacters.ParagraphMark;class Xre{getRichEditGlobalObject(){let e=window.DevExpress;e||(window.DevExpress=e={});let t=e.RichEdit;return t||(e.RichEdit=t={}),t}getRichs(){if(!this._richEdits){const e=this.getRichEditGlobalObject();this._richEdits=e.richEdits,this._richEdits||(this._richEdits=e.richEdits=[])}return this._richEdits}getRegisteredControlTypes(){if(!this._registeredControlTypes){const e=this.getRichEditGlobalObject();this._registeredControlTypes=e.controlTypes,this._registeredControlTypes||(this._registeredControlTypes=e.controlTypes={})}return this._registeredControlTypes}getRegisteredContainerTypes(){if(!this._registeredContainerTypes){const e=this.getRichEditGlobalObject();this._registeredContainerTypes=e.containerTypes,this._registeredContainerTypes||(this._registeredContainerTypes=e.containerTypes={})}return this._registeredContainerTypes}registerRichEdit(e){this.getRichs().push(e)}unregisterRichEdit(e){const t=this.getRichs(),r=f.ListUtils.indexBy(t,(t=>t===e));r>=0&&t.splice(r,1)}registerControlType(e){this.getRegisteredControlTypes()[e]=null}registerControlTypeObject(e,t){this.getRegisteredControlTypes()[e]=t}isControlTypeRegistered(e){return void 0!==this.getRegisteredControlTypes()[e]}getCustomControl(e){const t=this.getRegisteredControlTypes()[e];return t||null}registerContainerType(e){this.getRegisteredContainerTypes()[e]=null}registerContainerTypeObject(e,t){this.getRegisteredContainerTypes()[e]=t}isContainerTypeRegistered(e){return void 0!==this.getRegisteredContainerTypes()[e]}getCustomContainer(e){const t=this.getRegisteredContainerTypes()[e];return t||null}getRichEditByElement(e){const t=this.getRichs();return f.ListUtils.elementBy(t,(t=>t.element===e))}getFocusedRichEdit(){const e=this.getRichs();return f.ListUtils.elementBy(e,(e=>e.core.focusManager.isInFocus))}}class Gre{get registered(){return this._registered}constructor(e){this._richEditsHolder=new Xre,this._registered=!1,this._native=e}getFocusedRichEdit(){const e=this._richEditsHolder.getFocusedRichEdit();return e?e.getPublicRichEdit():null}registerCommands(e={}){e||(e={});const t=[{title:"Text formatting commands",description:"a set of formatting commands",commands:[{commandId:"DxReFontColor",phrase:"set <DxReColorName> font color",title:"set <DxReColorName> font color",description:"Set font color"},{commandId:"DxReFontSize",phrase:"font size <standard:cardinal0-100>",title:"Font size <standard:cardinal0-100>",description:"Change font size"}]}],r=[{id:"DxReColorName",description:"a color value",values:[{value:"red",spokenForm:"red"},{value:"green",spokenForm:"green"},{value:"blue",spokenForm:"blue"},{value:"black",spokenForm:"black"}]}];e.customizeCommands&&e.customizeCommands(t,r),Nre(t,r)}getCommandHandler(){return(e,t,r)=>{const i=e,n=this._richEditsHolder.getFocusedRichEdit();if(!n)return!1;switch(i){case"DxReFontColor":return n.getPublicRichEdit().executeCommand(JJ.ChangeFontForeColor,r[0]),!0;case"DxReFontSize":return n.getPublicRichEdit().executeCommand(JJ.ChangeFontSize,parseInt(r[0])),!0;default:return!1}}}getCustomControl(){return this._registered?this._richEditsHolder.getCustomControl(this._native.element.getAttribute(_re)):null}getCustomContainer(){return this._registered?this._richEditsHolder.getCustomContainer(this._native.element.getAttribute(Ure)):null}unregister(){this._registered&&(Kre(this._native.element,_re),Kre(this._native.element,Vre),Kre(this._native.element,Ure),this._richEditsHolder.unregisterRichEdit(this._native),this._registered=!1,Ore())}register(e){var t,r;if(this._registered)return;const i=null!==(t=null==e?void 0:e.customControlType)&&void 0!==t?t:"DevExpressRichEdit",n=null!==(r=null==e?void 0:e.customContainerType)&&void 0!==r?r:"DevExpressRichEditContainer",o=null==e?void 0:e.conceptName;qre(this._native.element,_re,i),qre(this._native.element,Ure,n),o&&qre(this._native.element,Vre,o),function(e){if(e){const t=e.ribbon.element.getElementsByTagName("input");for(let e=0;e<t.length;e++)t[e].setAttribute(Hre,"false")}}(this._native.barHolder.ribbon),this._richEditsHolder.registerRichEdit(this._native),this._registered=!0,jre(i,this._richEditsHolder),Wre(n,this._richEditsHolder),Ore()}}function Kre(e,t){null!==e.getAttribute(t)&&e.removeAttribute(t)}function qre(e,t,r){Kre(e,t),e.setAttribute(t,r)}var $re,Jre,Yre,Qre,Zre,eie,tie,rie,iie,nie,oie,aie,sie,lie,die=DevExpress.trial;__webpack_require__.n(die)().registerTrialPanelComponents();class cie{get events(){return this._native.events}constructor(e,t){this._native=new Ire(e,t,this),this.document=new BU(this._native.core),this.selection=new _U(this._native.core),this.layout=new kU(this._native.core),this.history=new AU(this._native.core),this.unitConverter=new ZU,this.mailMergeOptions=new wre(this._native),this.authenticationOptions=new Pre(this._native),this.simpleViewSettings=new Tre(this._native),this.contextMenu=new IY(this._native),this.rangePermissionOptions=new yre(this._native),this.nusaSettings=new Gre(this._native),this.spellCheckerOptions=new vre(this._native.core),this._native.allowDocumentLoadedEventCall=!1;const r=this._native.document,i=e=>{if(!this.isDisposed){if(this._native.onInit){((0,S.isString)(this._native.onInit)?(0,yd.tm)(this._native.onInit):this._native.onInit)(this,new qU)}e(),this._native.allowDocumentLoadedEventCall=!0,this._native.core.activeDocumentImporter||this._native.raiseDocumentLoaded(),this._native.activeContextTabManager.forbidChangeActiveTabIndex=!1}};if(r&&(0,S.isDefined)(r.content)){const e=(0,S.isDefined)(r.onLoaded)?(0,S.isString)(r.onLoaded)?(0,yd.tm)(r.onLoaded):r.onLoaded:()=>{};this.openDocument(r.content,r.name,r.format,(t=>{i((()=>e(t)))}))}else this.newDocument(),i((()=>{}))}exportToBase64(e,t){SV(this._native.core.getExportModelOptions({documentFormat:t}),e)}exportToBlob(e,t){IV(this._native.core.getExportModelOptions({documentFormat:t}),e)}exportToArrayBuffer(e,t){this.exportToBlob((t=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.readAsArrayBuffer(t)}),t)}exportToFile(e,t){const r=(0,S.isDefined)(t)?t:this._native.core.getExportDocumentFormat();let i="";switch(r){case Fu.Rtf:i=Ru.RtfMimeType;break;case Fu.OpenXml:i=Ru.OpenXmlMimeType;break;case Fu.PlainText:i=Ru.PlainTextMimeType;break;case Fu.Html:i=Ru.HtmlMimeType}const n=U7.getFileNameWithoutExtension(this._native.core.documentInfo.fileName),o=ZQ.documentFormatToExtension(r);IV(this._native.core.getExportModelOptions({documentFormat:r}),(t=>e(GU.FileUtils.createFile([t],n+o,{type:i}))))}exportToPdf(e,t){const r=this._native.core;fH(r,((t,i)=>{lo.Base64Utils.fromBlobAsArrayBuffer(t,(n=>{const o=this._native.raisePdfExporting(n,t,i,!1),a=r.modelManager.richOptions.pdf.exportUrl;!o&&a&&this._native.sendExportPdfRequest(n,this._native.core.documentInfo.getFileNameForDownload(e),a)}))}),t)}downloadPdf(e,t){bH(this._native.core,this._native.core.documentInfo.getFileNameForDownload(e),t)}adjust(){this._native.adjustControl()}get isDocumentImported(){return!this._native.core.activeDocumentImporter}get fullScreen(){return this._native.isInFullScreenMode}set fullScreen(e){this._native.core.commandManager.getCommand(FF.FullScreen).execute(!0,e)}get viewType(){return this._native.core.innerClientProperties.viewsSettings.viewType}set viewType(e){this._native.core.commandManager.getCommand(FF.ChangeViewType).execute(!0,e)}get readOnly(){return this._native.core.readOnly==RF.Persistent}set readOnly(e){if(this.readOnly!=e){this._native.core.readOnly=e?RF.Persistent:RF.None,this._native.core.barHolder.updateItemsState(),this._native.core.horizontalRulerControl.update(),this._native.core.beginUpdate();const t=this._native.core.innerClientProperties.showHiddenSymbols,r=this._native.core.commandManager.getCommand(FF.ToggleShowWhitespace);r.execute(this._native.core.commandManager.isPublicApiCall,!t),r.execute(this._native.core.commandManager.isPublicApiCall,t),this._native.core.endUpdate()}}get isDisposed(){return!this._native.core}get showHorizontalRuler(){return this._native.core.horizontalRulerControl.getVisible()}set showHorizontalRuler(e){this._native.core.commandManager.getCommand(FF.ToggleShowHorizontalRuler).execute(!0,e)}focus(){this._native.core.focusManager.captureFocus()}get fileName(){return this._native.core.documentInfo.fileName}set fileName(e){this._native.core.documentInfo.fileName=e}get documentSaveFormat(){return this._native.core.saveDocumentFormat}set documentSaveFormat(e){this._native.core.saveDocumentFormat=e}get documentName(){return this._native.core.documentInfo.fileName}set documentName(e){this._native.core.documentInfo.fileName=e}get documentFormat(){return this._native.core.documentInfo.documentFormat}set documentFormat(e){this._native.core.documentInfo.documentFormat=e}get documentExtension(){return ZQ.documentFormatToExtension(this._native.core.documentInfo.documentFormat)}set documentExtension(e){const t=ZQ.getDocumentFormat(e);null===t?console.warn(`Error: unknown extension. richEdit.documentExtension = "${e}"`):this._native.core.documentInfo.documentFormat=t}get hasUnsavedChanges(){return!this._native.documentSaved}set hasUnsavedChanges(e){this._native.documentSaved=!e}newDocument(){this._native.core.commandManager.getCommand(FF.CreateNewDocumentLocally).execute(!0)}openDocument(e,t,r,i){const n=(0,S.isDefined)(e)?new H7(i?(e,t)=>i(e):null,e,t,r):null;this._native.core.commandManager.getCommand(FF.OpenDocumentLocally).execute(!0,n)}saveDocument(e,t,r){const i=this._native.core.readOnly;this._native.core.readOnly=RF.None,this._native.core.commandManager.getCommand(FF.ExportDocument).execute(!0,new F7(e,t,r)),this._native.core.readOnly=i}mailMerge(e,t=Jre.NewParagraph,r=aH.OpenXml,i,n){if(!this._native.rawDataSource)return void console.warn("No data source");const o=new A7(e,t,r,i,n);this._native.core.commandManager.getCommand(FF.MailMergeOnClient).execute(!0,o)}downloadDocument(e=aH.OpenXml,t){this._native.core.commandManager.getCommand(FF.DownloadDocumentLocally).execute(!0,new D7(e,t))}printDocument(e){this._native.core.commandManager.getCommand(FF.PrintDocumentOnClient).execute(!0,e)}assignShortcut(e,t){this._native.core.commandManager.getCommand(FF.AssignShortcut).execute(!0,new jU(this._native.core,KU.LN.getShortcutCode(e.keyCode,e.ctrl,e.shift,e.alt,e.meta),t))}get printMode(){return this._native.core.modelManager.richOptions.printing.mode}set printMode(e){this._native.core.modelManager.richOptions.printing.mode=e}updateRibbon(e){const t=this._native.lastRibbonSettings,r=this._native.barHolder.ribbon;r&&(t.activeTabIndex=r.getActiveTabIndex()),e(t),this._native.core.beginUpdate(),this._native.initRibbon(t,this._native.core.modelManager.richOptions.fonts),this.adjust(),this._native.core.endUpdate(),this._native.core.barHolder.updateItemsState()}beginUpdate(){this._native.core.beginUpdate()}endUpdate(){this._native.core.endUpdate()}get loadingPanel(){return new OU(this._native.core)}createDocumentProcessor(e={}){const t=this._native.core.modelManager,r=t.richOptions.clone();r.spellChecker.isEnabled=!1;const{viewManager:i,uiUnitConverter:n}=this._native.core,{sguid:o,cguid:a}=this._native.core.getGuidParams(),s=new Bre(r,i.renderer,n,o,a);return e.cloneCurrentModel?s._importInnerDocument(t.model.clone()):s._initByEmptyModel(),s}dispose(){this._native.dispose(),this.nusaSettings.unregister()}executeCommand(e,t){return function(e,t,r){return Mre(e,t,r)}(this._native.core.commandManager,e,t)}getCommandState(e){var t;return null!==(t=function(e,t){var r;const i=e.getCommand(t);if(!i)return null;const n=i.getState();let o=n.value;switch(t){case JJ.ChangeFontName:o=null===(r=n.value)||void 0===r?void 0:r.name;break;case JJ.ChangeFontForeColor:case JJ.ChangeShading:o=bm.internalColorToApiColor(n.value);break;case iY.ChangeTableStyle:o="string"==typeof n.value?n.value:void 0;break;case iY.ChangeTableRepositoryItemBorderStyle:switch(o){case de.None:o="None";break;case de.Dashed:o="Dashed";break;case de.Double:o="Double";break;case de.Dotted:o="Dotted";break;case de.Single:o="Single";break;default:o=de.Single}break;case iY.ChangeTableCellShading:case JJ.ChangeFontHighlightColor:o=bm.internalColorToApiColor(n.value)}return new Dre(n.visible,n.enabled,o)}(this._native.core.commandManager,e))&&void 0!==t?t:new Dre(!1,!1)}setCommandEnabled(e,t){const r=e;this._native.core.commandManager.setCommandEnabled(r,t),this._native.core.barHolder.forceUpdate()}}function hie(){return{ribbon:oZ(),events:{},pdf:{},search:{},printing:{closePrintDialogWithHtmlPreview:!0},fields:{},confirmOnLosingChanges:{},mailMerge:{},fonts:{fonts:[],mappings:{rules:[]}},autoCorrect:{replaceInfoCollection:[]},bookmarks:{visibility:!1},contextMenu:new PY,authentication:{},rangePermissions:{highlightRanges:!0,showBrackets:!0},view:{simpleViewSettings:{paddings:{left:15,right:15,top:15,bottom:15}},printLayoutViewSettings:{showHorizontalRuler:!0}},spellCheck:{enabled:!1},document:{}}}function uie(e,t){return new cie(e,t)}!function(e){e[e.Simple=0]="Simple",e[e.PrintLayout=1]="PrintLayout"}($re||($re={})),function(e){e[e.NewParagraph=0]="NewParagraph",e[e.NewSection=1]="NewSection"}(Jre||(Jre={})),function(e){e[e.Html=1]="Html",e[e.Pdf=2]="Pdf"}(Yre||(Yre={})),function(e){e[e.CreateNewDocument=412]="CreateNewDocument",e[e.OpenDocument=410]="OpenDocument",e[e.ExportDocument=413]="ExportDocument",e[e.Download=414]="Download",e[e.DownloadDocx=418]="DownloadDocx",e[e.DownloadRtf=419]="DownloadRtf",e[e.DownloadTxt=420]="DownloadTxt",e[e.DownloadHtml=421]="DownloadHtml",e[e.PrintDocument=416]="PrintDocument"}(Qre||(Qre={})),function(e){e[e.ChangeCaseMenu=431]="ChangeCaseMenu",e[e.AlignParagraphMenu=432]="AlignParagraphMenu",e[e.LineSpacingMenu=433]="LineSpacingMenu",e[e.Undo=6]="Undo",e[e.Redo=7]="Redo",e[e.Cut=10]="Cut",e[e.Copy=9]="Copy",e[e.Paste=8]="Paste",e[e.ChangeFontName=11]="ChangeFontName",e[e.ChangeFontSize=13]="ChangeFontSize",e[e.IncreaseFontSize=14]="IncreaseFontSize",e[e.DecreaseFontSize=15]="DecreaseFontSize",e[e.ChangeFontForeColor=28]="ChangeFontForeColor",e[e.ChangeFontHighlightColor=29]="ChangeFontHighlightColor",e[e.ShowFontDialog=52]="ShowFontDialog",e[e.ToggleFontBold=20]="ToggleFontBold",e[e.ToggleFontItalic=21]="ToggleFontItalic",e[e.ToggleFontUnderline=22]="ToggleFontUnderline",e[e.ToggleFontDoubleUnderline=23]="ToggleFontDoubleUnderline",e[e.ToggleFontStrikeout=24]="ToggleFontStrikeout",e[e.ToggleFontSubscript=27]="ToggleFontSubscript",e[e.ToggleFontSuperscript=26]="ToggleFontSuperscript",e[e.CapitalizationSentenceCase=207]="CapitalizationSentenceCase",e[e.CapitalizationUpperCase=16]="CapitalizationUpperCase",e[e.CapitalizationLowerCase=17]="CapitalizationLowerCase",e[e.CapitalizeEachWordTextCase=18]="CapitalizeEachWordTextCase",e[e.CapitalizationToggleCase=19]="CapitalizationToggleCase",e[e.ClearFormatting=30]="ClearFormatting",e[e.ToggleBulletedList=31]="ToggleBulletedList",e[e.ToggleNumberedList=32]="ToggleNumberedList",e[e.ToggleMultilevelList=33]="ToggleMultilevelList",e[e.ToggleParagraphAlignmentLeft=37]="ToggleParagraphAlignmentLeft",e[e.ToggleParagraphAlignmentCenter=38]="ToggleParagraphAlignmentCenter",e[e.ToggleParagraphAlignmentRight=39]="ToggleParagraphAlignmentRight",e[e.ToggleParagraphAlignmentJustify=40]="ToggleParagraphAlignmentJustify",e[e.ToggleShowHiddenSymbols=36]="ToggleShowHiddenSymbols",e[e.SetSingleParagraphSpacing=41]="SetSingleParagraphSpacing",e[e.SetSesquialteralParagraphSpacing=42]="SetSesquialteralParagraphSpacing",e[e.SetDoubleParagraphSpacing=43]="SetDoubleParagraphSpacing",e[e.AddSpacingBeforeParagraph=45]="AddSpacingBeforeParagraph",e[e.AddSpacingAfterParagraph=46]="AddSpacingAfterParagraph",e[e.RemoveSpacingBeforeParagraph=47]="RemoveSpacingBeforeParagraph",e[e.RemoveSpacingAfterParagraph=48]="RemoveSpacingAfterParagraph",e[e.ChangeParagraphBackColor=49]="ChangeParagraphBackColor",e[e.ChangeStyle=12]="ChangeStyle",e[e.Find=50]="Find",e[e.Replace=51]="Replace"}(Zre||(Zre={})),function(e){e[e.ShowInsertTableDialog=55]="ShowInsertTableDialog",e[e.InsertPictureLocally=411]="InsertPictureLocally",e[e.ShowBookmarkDialog=58]="ShowBookmarkDialog",e[e.ShowHyperlinkDialog=59]="ShowHyperlinkDialog",e[e.InsertHeader=220]="InsertHeader",e[e.InsertFooter=221]="InsertFooter",e[e.InsertPageNumberField=235]="InsertPageNumberField",e[e.InsertPageCountField=236]="InsertPageCountField",e[e.InsertFloatingTextBox=368]="InsertFloatingTextBox"}(eie||(eie={})),function(e){e[e.MarginsMenu=434]="MarginsMenu",e[e.OrientationMenu=435]="OrientationMenu",e[e.SizeMenu=436]="SizeMenu",e[e.ColumnsMenu=437]="ColumnsMenu",e[e.BreaksMenu=438]="BreaksMenu",e[e.SetNormalSectionPageMargins=66]="SetNormalSectionPageMargins",e[e.SetNarrowSectionPageMargins=67]="SetNarrowSectionPageMargins",e[e.SetModerateSectionPageMargins=68]="SetModerateSectionPageMargins",e[e.SetWideSectionPageMargins=69]="SetWideSectionPageMargins",e[e.ShowMarginsPageSetupDialog=70]="ShowMarginsPageSetupDialog",e[e.SetPortraitPageOrientation=71]="SetPortraitPageOrientation",e[e.SetLandscapePageOrientation=72]="SetLandscapePageOrientation",e[e.SetSectionLetterPaperSize=162]="SetSectionLetterPaperSize",e[e.SetSectionLegalPaperSize=99]="SetSectionLegalPaperSize",e[e.SetSectionFolioPaperSize=100]="SetSectionFolioPaperSize",e[e.SetSectionA4PaperSize=101]="SetSectionA4PaperSize",e[e.SetSectionB5PaperSize=104]="SetSectionB5PaperSize",e[e.SetSectionExecutivePaperSize=105]="SetSectionExecutivePaperSize",e[e.SetSectionA5PaperSize=102]="SetSectionA5PaperSize",e[e.SetSectionA6PaperSize=103]="SetSectionA6PaperSize",e[e.ShowPaperPageSetupDialog=73]="ShowPaperPageSetupDialog",e[e.SetSectionOneColumn=74]="SetSectionOneColumn",e[e.SetSectionTwoColumns=75]="SetSectionTwoColumns",e[e.SetSectionThreeColumns=76]="SetSectionThreeColumns",e[e.InsertPageBreak=54]="InsertPageBreak",e[e.InsertColumnBreak=79]="InsertColumnBreak",e[e.InsertSectionBreakNextPage=80]="InsertSectionBreakNextPage",e[e.InsertSectionBreakEvenPage=81]="InsertSectionBreakEvenPage",e[e.InsertSectionBreakOddPage=82]="InsertSectionBreakOddPage",e[e.ChangePageColor=90]="ChangePageColor"}(tie||(tie={})),function(e){e[e.AddTextMenu=439]="AddTextMenu",e[e.InsertCaptionMenu=440]="InsertCaptionMenu",e[e.InsertTableOfFiguresMenu=441]="InsertTableOfFiguresMenu",e[e.InsertTableOfContents=377]="InsertTableOfContents",e[e.SetParagraphBodyTextLevel=385]="SetParagraphBodyTextLevel",e[e.SetParagraphHeading1Level=386]="SetParagraphHeading1Level",e[e.SetParagraphHeading2Level=387]="SetParagraphHeading2Level",e[e.SetParagraphHeading3Level=388]="SetParagraphHeading3Level",e[e.SetParagraphHeading4Level=389]="SetParagraphHeading4Level",e[e.SetParagraphHeading5Level=390]="SetParagraphHeading5Level",e[e.SetParagraphHeading6Level=391]="SetParagraphHeading6Level",e[e.SetParagraphHeading7Level=392]="SetParagraphHeading7Level",e[e.SetParagraphHeading8Level=393]="SetParagraphHeading8Level",e[e.SetParagraphHeading9Level=394]="SetParagraphHeading9Level",e[e.CreateFigureCaptionField=382]="CreateFigureCaptionField",e[e.CreateTableCaptionField=383]="CreateTableCaptionField",e[e.CreateEquationCaptionField=381]="CreateEquationCaptionField",e[e.CreateTableOfFiguresField=379]="CreateTableOfFiguresField",e[e.CreateTableOfTablesField=380]="CreateTableOfTablesField",e[e.CreateTableOfEquationsField=378]="CreateTableOfEquationsField",e[e.UpdateTableOfContents=384]="UpdateTableOfContents"}(rie||(rie={})),function(e){e[e.CreateFieldMenu=442]="CreateFieldMenu",e[e.CreateField=178]="CreateField",e[e.CreateDateField=203]="CreateDateField",e[e.CreateTimeField=204]="CreateTimeField",e[e.CreatePageField=205]="CreatePageField",e[e.CreateNumPagesField=236]="CreateNumPagesField",e[e.CreateEmptyMergeField=372]="CreateEmptyMergeField",e[e.CreateEmptyDocVariableField=373]="CreateEmptyDocVariableField",e[e.CreateEmptyIfField=459]="CreateEmptyIfField",e[e.ShowInsertMergeFieldDialog=214]="ShowInsertMergeFieldDialog",e[e.ToggleViewMergedData=213]="ToggleViewMergedData",e[e.ShowAllFieldCodes=186]="ShowAllFieldCodes",e[e.ShowAllFieldResults=187]="ShowAllFieldResults",e[e.UpdateAllFields=200]="UpdateAllFields",e[e.GoToFirstDataRecord=209]="GoToFirstDataRecord",e[e.GoToPreviousDataRecord=210]="GoToPreviousDataRecord",e[e.GoToNextDataRecord=211]="GoToNextDataRecord",e[e.GoToLastDataRecord=212]="GoToLastDataRecord",e[e.ShowMailMergeDialog=216]="ShowMailMergeDialog"}(iie||(iie={})),function(e){e[e.SwitchToSimpleView=405]="SwitchToSimpleView",e[e.SwitchToPrintLayout=406]="SwitchToPrintLayout",e[e.ToggleShowHorizontalRuler=94]="ToggleShowHorizontalRuler",e[e.ToggleFullScreen=98]="ToggleFullScreen"}(nie||(nie={})),function(e){e[e.GoToPageHeader=227]="GoToPageHeader",e[e.GoToPageFooter=228]="GoToPageFooter",e[e.GoToPreviousPageHeaderFooter=230]="GoToPreviousPageHeaderFooter",e[e.GoToNextPageHeaderFooter=229]="GoToNextPageHeaderFooter",e[e.LinkHeaderFooterToPrevious=222]="LinkHeaderFooterToPrevious",e[e.ToggleDifferentFirstPage=231]="ToggleDifferentFirstPage",e[e.ToggleDifferentOddAndEvenPages=232]="ToggleDifferentOddAndEvenPages",e[e.ChangeHeaderOffset=330]="ChangeHeaderOffset",e[e.ChangeFooterOffset=331]="ChangeFooterOffset",e[e.ClosePageHeaderFooter=233]="ClosePageHeaderFooter"}(oie||(oie={})),function(e){e[e.TableStyleOptionsMenu=443]="TableStyleOptionsMenu",e[e.BordersMenu=444]="BordersMenu",e[e.ToggleFirstRow=280]="ToggleFirstRow",e[e.ToggleLastRow=281]="ToggleLastRow",e[e.ToggleBandedRows=284]="ToggleBandedRows",e[e.ToggleFirstColumn=282]="ToggleFirstColumn",e[e.ToggleLastColumn=283]="ToggleLastColumn",e[e.ToggleBandedColumn=285]="ToggleBandedColumn",e[e.ApplyTableStyle=269]="ApplyTableStyle",e[e.ChangeTableBorderStyleRepositoryItem=292]="ChangeTableBorderStyleRepositoryItem",e[e.ChangeTableBorderWidthRepositoryItem=291]="ChangeTableBorderWidthRepositoryItem",e[e.ChangeTableBorderColorRepositoryItem=290]="ChangeTableBorderColorRepositoryItem",e[e.ToggleTableCellsBottomBorder=272]="ToggleTableCellsBottomBorder",e[e.ToggleTableCellsTopBorder=270]="ToggleTableCellsTopBorder",e[e.ToggleTableCellsLeftBorder=273]="ToggleTableCellsLeftBorder",e[e.ToggleTableCellsRightBorder=271]="ToggleTableCellsRightBorder",e[e.ToggleTableCellNoBorder=274]="ToggleTableCellNoBorder",e[e.ToggleTableCellAllBorders=275]="ToggleTableCellAllBorders",e[e.ToggleTableCellOutsideBorders=279]="ToggleTableCellOutsideBorders",e[e.ToggleTableCellInsideBorders=276]="ToggleTableCellInsideBorders",e[e.ToggleTableCellInsideHorizontalBorders=277]="ToggleTableCellInsideHorizontalBorders",e[e.ToggleTableCellInsideVerticalBorders=278]="ToggleTableCellInsideVerticalBorders",e[e.ToggleShowTableGridLines=295]="ToggleShowTableGridLines",e[e.ChangeTableCellShading=294]="ChangeTableCellShading"}(aie||(aie={})),function(e){e[e.SelectMenu=445]="SelectMenu",e[e.DeleteMenu=446]="DeleteMenu",e[e.InsertMenu=447]="InsertMenu",e[e.AutoFitMenu=448]="AutoFitMenu",e[e.AlignmentMenu=449]="AlignmentMenu",e[e.SelectTableCell=286]="SelectTableCell",e[e.SelectTableColumn=287]="SelectTableColumn",e[e.SelectTableRow=288]="SelectTableRow",e[e.SelectTable=289]="SelectTable",e[e.ToggleShowTableGridLines=295]="ToggleShowTableGridLines",e[e.ShowDeleteTableCellsDialog=253]="ShowDeleteTableCellsDialog",e[e.DeleteTableColumns=248]="DeleteTableColumns",e[e.DeleteTableRows=247]="DeleteTableRows",e[e.DeleteTable=251]="DeleteTable",e[e.InsertTableRowAbove=246]="InsertTableRowAbove",e[e.InsertTableRowBelow=245]="InsertTableRowBelow",e[e.InsertTableColumnToTheLeft=243]="InsertTableColumnToTheLeft",e[e.InsertTableColumnToTheRight=244]="InsertTableColumnToTheRight",e[e.MergeTableCells=254]="MergeTableCells",e[e.ShowSplitTableCellsDialog=255]="ShowSplitTableCellsDialog",e[e.SetAutoFitContents=399]="SetAutoFitContents",e[e.SetAutoFitWindow=400]="SetAutoFitWindow",e[e.SetFixedColumnWidth=401]="SetFixedColumnWidth",e[e.TableCellAlignTopLeft=260]="TableCellAlignTopLeft",e[e.TableCellAlignTopCenter=261]="TableCellAlignTopCenter",e[e.TableCellAlignTopRight=262]="TableCellAlignTopRight",e[e.TableCellAlignMiddleLeft=263]="TableCellAlignMiddleLeft",e[e.TableCellAlignMiddleCenter=264]="TableCellAlignMiddleCenter",e[e.TableCellAlignMiddleRight=265]="TableCellAlignMiddleRight",e[e.TableCellAlignBottomLeft=266]="TableCellAlignBottomLeft",e[e.TableCellAlignBottomCenter=267]="TableCellAlignBottomCenter",e[e.TableCellAlignBottomRight=268]="TableCellAlignBottomRight"}(sie||(sie={})),function(e){e[e.WrapTextMenu=450]="WrapTextMenu",e[e.PositionMenu=451]="PositionMenu",e[e.BringForwardMenu=452]="BringForwardMenu",e[e.SendBackwardMenu=453]="SendBackwardMenu",e[e.ChangeFloatingObjectFillColor=343]="ChangeFloatingObjectFillColor",e[e.ChangeFloatingObjectOutlineColor=344]="ChangeFloatingObjectOutlineColor",e[e.ChangeFloatingObjectOutlineWidth=345]="ChangeFloatingObjectOutlineWidth",e[e.SetFloatingObjectInlineTextWrapType=374]="SetFloatingObjectInlineTextWrapType",e[e.SetFloatingObjectSquareTextWrapType=346]="SetFloatingObjectSquareTextWrapType",e[e.SetFloatingObjectTightTextWrapType=347]="SetFloatingObjectTightTextWrapType",e[e.SetFloatingObjectThroughTextWrapType=348]="SetFloatingObjectThroughTextWrapType",e[e.SetFloatingObjectTopAndBottomTextWrapType=349]="SetFloatingObjectTopAndBottomTextWrapType",e[e.SetFloatingObjectBehindTextWrapType=350]="SetFloatingObjectBehindTextWrapType",e[e.SetFloatingObjectInFrontOfTextWrapType=351]="SetFloatingObjectInFrontOfTextWrapType",e[e.SetFloatingObjectTopLeftAlignment=352]="SetFloatingObjectTopLeftAlignment",e[e.SetFloatingObjectTopCenterAlignment=353]="SetFloatingObjectTopCenterAlignment",e[e.SetFloatingObjectTopRightAlignment=354]="SetFloatingObjectTopRightAlignment",e[e.SetFloatingObjectMiddleLeftAlignment=355]="SetFloatingObjectMiddleLeftAlignment",e[e.SetFloatingObjectMiddleCenterAlignment=356]="SetFloatingObjectMiddleCenterAlignment",e[e.SetFloatingObjectMiddleRightAlignment=357]="SetFloatingObjectMiddleRightAlignment",e[e.SetFloatingObjectBottomLeftAlignment=358]="SetFloatingObjectBottomLeftAlignment",e[e.SetFloatingObjectBottomCenterAlignment=359]="SetFloatingObjectBottomCenterAlignment",e[e.SetFloatingObjectBottomRightAlignment=360]="SetFloatingObjectBottomRightAlignment",e[e.FloatingObjectBringForward=361]="FloatingObjectBringForward",e[e.FloatingObjectBringToFront=362]="FloatingObjectBringToFront",e[e.FloatingObjectBringInFrontOfText=363]="FloatingObjectBringInFrontOfText",e[e.FloatingObjectSendBackward=364]="FloatingObjectSendBackward",e[e.FloatingObjectSendToBack=365]="FloatingObjectSendToBack",e[e.FloatingObjectSendBehindText=366]="FloatingObjectSendBehindText"}(lie||(lie={}));(window.DevExpress=window.DevExpress||{}).RichEdit=Object.assign(Object.assign(Object.assign({},i),e),p)}()})();